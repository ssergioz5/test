(self.webpackChunkOpenProject=self.webpackChunkOpenProject||[]).push([["main"],{44442:(e,t,n)=>{"use strict";n.d(t,{m:()=>ActiveWindowService});var i=n(60316),o=n(75797),r=n(36819),s=n(68559);class ActiveWindowService{constructor(e){this.activeState$=new o.t(!0),e.addEventListener("visibilitychange",(()=>{e.visibilityState&&((0,r.cY)(`Browser window has visibility state changed to ${e.visibilityState}`),this.activeState$.next("visible"===e.visibilityState))}))}get isActive(){return this.activeState$.value}get active$(){return this.activeState$.asObservable()}static{this.ɵfac=function ActiveWindowService_Factory(e){return new(e||ActiveWindowService)(s.KVO(i.qQ))}}static{this.ɵprov=s.jDH({token:ActiveWindowService,factory:ActiveWindowService.ɵfac,providedIn:"root"})}}},14593:(e,t,n)=>{"use strict";n.d(t,{n:()=>ApiV3Service});var i=n(86561),o=n(73014),r=n(73588);class ApiV3GridPaths extends i.Sq{constructor(){super(...arguments),this.form=this.subResource("form",r.i)}patch(e,t=null){const n=this.form.extractPayload(e,t);return this.halResourceService.patch(this.path,n)}delete(){return this.halResourceService.delete(this.path)}}var s=n(98435);class ApiV3GridsPaths extends i.K2{constructor(e,t){super(e,t,"grids",ApiV3GridPaths),this.apiRoot=e,this.basePath=t,this.form=this.subResource("form",r.i)}list(e){return this.halResourceService.get(this.path+(0,s.Y)(e))}post(e,t=null){return this.halResourceService.post(this.path,this.form.extractPayload(e,t))}}var a=n(24398),l=n(1758),c=n(13432),p=n(23513),d=n(59452),u=n(64334),h=n(86301),m=n(36647),g=n(87378),f=n(98764),b=n(44674);class ApiV3Resource extends i.Sq{constructor(){super(...arguments),this.cache=this.createCache()}requireAndStream(e=!1){const t=this.id.toString();if(this.cache.stale(t)||e){const e=this.load().pipe((0,u.s)(1),(0,h.t)(1));return this.cache.clearAndLoad(t,e),(0,p.x)(e,this.cache.state(t).values$())}return this.cache.state(t).values$()}observe(){return this.cache.observe(this.id.toString())}get(){return this.requireAndStream(!1).pipe((0,u.s)(1))}refresh(){return this.requireAndStream(!0).pipe((0,u.s)(1)).toPromise()}load(){return this.halResourceService.get(this.path).pipe((0,m.n)((e=>e.$links.schema?this.schemaCache.requireAndStream(e.$links.schema.href).pipe((0,u.s)(1),(0,g.u)(e)):(0,d.of)(e))))}touch(e){this.cache.updateFor(e)}cacheResponse(){return e=>e.pipe((0,f.M)((e=>this.touch(e))))}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",c.D)],ApiV3Resource.prototype,"states",void 0),(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",b.D)],ApiV3Resource.prototype,"schemaCache",void 0);var k=n(46603),v=n(20001),C=n(27514);class ApiV3TimeEntryPaths extends ApiV3Resource{constructor(){super(...arguments),this.form=this.subResource("form",k.c)}patch(e,t=null){return this.halResourceService.patch(this.path,this.extractPayload(e,t)).pipe((0,f.M)((e=>this.touch(e))))}delete(){return this.halResourceService.delete(this.path).pipe((0,f.M)((()=>this.cache.clearSome(this.id.toString()))))}createCache(){return this.parent.cache}extractPayload(e,t=null){return e instanceof C.q&&t?v.y.extractPayloadFromSchema(e,t):e instanceof C.q?{}:e}}var y=n(23863);class ApiV3Collection extends i.K2{constructor(){super(...arguments),this.cache=this.createCache()}observeAll(){return this.cache.observeAll()}cacheResponse(){return e=>e.pipe((0,f.M)((e=>{e instanceof y.L?e.elements?.forEach(this.touch.bind(this)):e instanceof C.q&&this.touch(e)})))}touch(e){this.cache.updateFor(e)}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",c.D)],ApiV3Collection.prototype,"states",void 0);var w=n(42410);class TimeEntryCacheService extends w.l{constructor(e,t){super(t),this.injector=e}updateValue(e,t){return this.schemaCache.ensureLoaded(t).then((()=>(this.putValue(e,t),t)))}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",c.D)],TimeEntryCacheService.prototype,"states",void 0),(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",b.D)],TimeEntryCacheService.prototype,"schemaCache",void 0);class ApiV3TimeEntriesPaths extends ApiV3Collection{constructor(e,t){super(e,t,"time_entries",ApiV3TimeEntryPaths),this.apiRoot=e,this.basePath=t,this.form=this.subResource("form",k.c),this.schema=this.subResource("schema")}list(e){return this.halResourceService.get(this.path+(0,s.Y)(e)).pipe(this.cacheResponse())}post(e){return this.halResourceService.post(this.path,e).pipe(this.cacheResponse())}createCache(){return new TimeEntryCacheService(this.injector,this.states.timeEntries)}}class ApiV3CapabilityPaths extends i.Sq{}class ApiV3CapabilitiesPaths extends i.K2{constructor(e,t){super(e,t,"capabilities",ApiV3CapabilityPaths),this.apiRoot=e,this.basePath=t}}var T=n(70271),S=n(89282);class ApiV3AvailableProjectsPaths extends i.Sq{list(e){return this.halResourceService.get(this.path+(0,s.Y)(e))}exists(e){return this.halResourceService.get(this.path,{filters:(0,S.K7)("id","=",[e]).toJson()}).pipe((0,T.T)((e=>e.count>0)))}}class ApiV3MembershipsForm extends k.c{static extractPayload(e){return{_links:{project:{href:e.project.href},principal:{href:e.principal.href},roles:e.roles.map((e=>({href:e.href})))},_meta:{notificationMessage:{raw:e.notificationMessage.raw}}}}extractPayload(e){return ApiV3MembershipsForm.extractPayload(e)}}class ApiV3MembershipsPaths extends i.K2{constructor(e,t){super(e,t,"memberships"),this.apiRoot=e,this.basePath=t,this.form=this.subResource("form",ApiV3MembershipsForm),this.available_projects=this.subResource("available_projects",ApiV3AvailableProjectsPaths)}list(e){return this.halResourceService.get(this.path+(0,s.Y)(e))}post(e){const t=this.form.extractPayload(e);return this.halResourceService.post(this.path,t)}}var j=n(30501);class ApiV3UserPreferencesPaths extends i.pp{get(){return this.http.get(this.path)}patch(e){return this.http.patch(this.path,e,{withCredentials:!0,responseType:"json"})}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",j.Qq)],ApiV3UserPreferencesPaths.prototype,"http",void 0);class ApiV3UserPaths extends ApiV3Resource{constructor(){super(...arguments),this.avatar=this.subResource("avatar"),this.preferences=this.subResource("preferences",ApiV3UserPreferencesPaths)}createCache(){return new w.l(this.states.users)}}class ApiV3UsersPaths extends i.K2{constructor(e,t){super(e,t,"users",ApiV3UserPaths),this.apiRoot=e,this.basePath=t,this.me=this.subResource("me",ApiV3UserPaths),this.form=this.subResource("form",k.c)}post(e){return this.halResourceService.post(this.path,e)}}class ApiV3TypePaths extends ApiV3Resource{createCache(){return this.parent.cache}}class ApiV3TypesPaths extends ApiV3Collection{constructor(e,t){super(e,t,"types",ApiV3TypePaths),this.apiRoot=e,this.basePath=t}createCache(){return new w.l(this.states.types)}}var P=n(20045),I=n(67704);class ApiV3QueryOrder extends I.B{constructor(e,t,n){super(t,n),this.injector=e,this.basePath=t,this.id=n}get(){return this.http.get(this.path).toPromise().then((e=>e||{}))}update(e){return this.http.patch(this.path,{delta:e},{withCredentials:!0}).toPromise().then((e=>e.t))}delete(e,...t){const n={};return t.forEach((e=>n[e]=-1)),this.update(n)}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",j.Qq)],ApiV3QueryOrder.prototype,"http",void 0);var x=n(45261),R=n(49741);class ApiV3QueryForm extends k.c{load(e){const t={name:e.name||"!!!__O__o__O__!!!"};e.project&&(t._links={project:{href:e.project.href}});const{path:n}=this.apiRoot.queries.withOptionalId(e.id).form;return this.halResourceService.post(n,t).pipe((0,f.M)((e=>this.queryFilters.setSchemas(e.$embedded.schema.$embedded.filtersSchemas))),(0,T.T)((e=>[e,this.buildQueryResource(e)])))}loadWithParams(e,t,n,i={}){t||i.name||(i.name="!!!__O__o__O__!!!"),n&&(i._links=i._links||{},i._links.project={href:this.apiRoot.projects.id(n).toString()});const{path:o}=this.apiRoot.queries.withOptionalId(t).form,r=x(o).search(e).toString();return this.halResourceService.post(r,i).pipe((0,f.M)((e=>this.queryFilters.setSchemas(e.$embedded.schema.$embedded.filtersSchemas))),(0,T.T)((e=>[e,this.buildQueryResource(e)])))}buildQueryResource(e){return this.halResourceService.createHalResourceOfType("Query",e.payload)}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",R.r)],ApiV3QueryForm.prototype,"queryFilters",void 0);class ApiV3QueryPaths extends i.Sq{constructor(){super(...arguments),this.form=this.subResource("form",ApiV3QueryForm),this.order=new ApiV3QueryOrder(this.injector,this.path,"order")}parameterised(e){return this.halResourceService.get(this.path,e)}patch(e,t){return e instanceof P.X&&t&&(this.queryFilters.mapSchemasIntoFilters(e,t),e=v.y.extractPayloadFromSchema(e,t.schema)),this.halResourceService.patch(this.path,e)}delete(){return this.halResourceService.delete(this.path)}paginated(e){return this.parameterised(e)}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",R.r)],ApiV3QueryPaths.prototype,"queryFilters",void 0);class ApiV3QueriesPaths extends i.K2{constructor(e,t){super(e,t,"queries",ApiV3QueryPaths),this.apiRoot=e,this.basePath=t,this.form=this.subResource("form",ApiV3QueryForm),this.default=this.subResource("default"),this.filter_instance_schemas=new i.K2(this.apiRoot,this.path,"filter_instance_schemas")}list(e){return this.halResourceService.get(this.path+(0,s.Y)(e))}find(e,t,n){let i;return i=t?this.apiRoot.queries.id(t).toString():this.apiRoot.withOptionalProject(n).queries.default.toString(),this.halResourceService.get(i,e)}parameterised(e){return this.halResourceService.get(this.default.path,e)}post(e,t){return e instanceof P.X&&t&&(this.queryFilters.mapSchemasIntoFilters(e,t),e=v.y.extractPayloadFromSchema(e,t.schema)),this.halResourceService.post(this.apiRoot.queries.path,e)}toggleStarred(e){return e.starred?e.unstar():e.star()}getIcalUrl(e,t){return e.icalUrl({token_name:t})}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",R.r)],ApiV3QueriesPaths.prototype,"queryFilters",void 0);var F=n(61873),M=n(14600);class ApiV3RelationsPaths extends i.K2{constructor(e,t){super(e,t,"relations"),this.apiRoot=e,this.basePath=t}get(){return this.halResourceService.get(this.path)}loadInvolved(e){if(e.length>100){const t=_.chunk(e,100);return(0,F.p)(t.map((e=>this.loadInvolved(e)))).pipe((0,T.T)((e=>_.flatten(e))))}const t=_.filter(e,(e=>/\d+/.test(e)));return 0===t.length?(0,M.H)([]):this.filtered((0,S.K7)("involved","=",t)).getPaginatedResults()}}class ApiV3WorkPackageForm extends k.c{forTypePayload(e){e._links.type&&e._links.type;return this.post(e)}forPayload(e){return this.post(e)}}class ApiV3WorkPackagePaths extends ApiV3Resource{constructor(){super(...arguments),this.relations=this.subResource("relations",ApiV3RelationsPaths),this.revisions=this.subResource("revisions"),this.activities=this.subResource("activities"),this.available_watchers=this.subResource("available_watchers"),this.reminders=this.subResource("reminders"),this.available_projects=this.subResource("available_projects"),this.github_pull_requests=this.subResource("github_pull_requests"),this.form=this.subResource("form",ApiV3WorkPackageForm)}createCache(){return this.parent.cache}}var O=n(47418),D=n(36819),G=n(97366),E=n(68559);class WorkPackageCache extends w.l{constructor(e,t){super(t),this.injector=e}updateValue(e,t){return this.schemaCacheService.ensureLoaded(t).then((()=>(this.putValue(e,t),t)))}updateWorkPackage(e,t=!1){return t||(0,G.A)(e)?super.updateValue(e.id,e):this.updateValue(e.id,e)}updateWorkPackageList(e,t=!0){e.forEach((e=>{const n=e,i=n.id,o=this.multiState.get(i);(0,G.A)(n)?o.putValue(n):this.schemaCacheService.ensureLoaded(n).then((()=>{t&&o.hasValue()&&_.isEqual(o.value.$source,n.$source)?(0,D.cY)("Skipping identical work package from updating"):o.putValue(n)}))}))}static{this.ɵfac=function WorkPackageCache_Factory(e){return new(e||WorkPackageCache)(E.KVO(E.zZn),E.KVO(O.bq))}}static{this.ɵprov=E.jDH({token:WorkPackageCache,factory:WorkPackageCache.ɵfac})}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",b.D)],WorkPackageCache.prototype,"schemaCacheService",void 0);class ApiV3WorkPackageCachedSubresource extends i.Sq{get(){return this.halResourceService.get(this.path).pipe((0,f.M)((e=>e.schemas&&this.updateSchemas(e.schemas))),(0,f.M)((e=>this.cache.updateWorkPackageList(e.elements))),(0,u.s)(1))}get cache(){return this.parent.cache}updateSchemas(e){e.elements.forEach((e=>{this.states.schemas.get(e.href).putValue(e)}))}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",c.D)],ApiV3WorkPackageCachedSubresource.prototype,"states",void 0);class ApiV3WorkPackagesPaths extends ApiV3Collection{constructor(e,t){super(e,t,"work_packages",ApiV3WorkPackagePaths),this.apiRoot=e,this.basePath=t,this.form=this.subResource("form",ApiV3WorkPackageForm),this.available_projects=this.subResource("available_projects")}requireAll(e){return 0===e.length?Promise.resolve():new Promise(((t,n)=>{this.loadCollectionsFor(_.uniq(e)).then((e=>{_.each(e,(e=>{e.schemas&&_.each(e.schemas.elements,(e=>{this.states.schemas.get(e.href).putValue(e)})),e.elements&&this.cache.updateWorkPackageList(e.elements)})),t(void 0)}),n)}))}post(e){return this.halResourceService.post(this.path,e).pipe(this.cacheResponse())}filtered(e,t={}){return super.filtered(e,t,ApiV3WorkPackageCachedSubresource)}filterByTypeaheadOrId(e,t=!1,n={}){const i=new S.hG;t?i.add("id","=",[e]):i.add("typeahead","**",[e]);const o={sortBy:'[["updatedAt","desc"]]',offset:"1",pageSize:"10",...n};return this.filtered(i,o)}filterUpdatedSince(e,t){const n=(new S.hG).add("id","=",e.filter((e=>e))).add("updatedAt","<>d",[t,""]);return this.filtered(n,{offset:"1",pageSize:"10"})}loadCollectionsFor(e){return this.halResourceService.getAllPaginated(this.path,{filters:(0,S.K7)("id","=",e).toJson(),valid_subset:!0}).toPromise()}createCache(){return new WorkPackageCache(this.injector,this.states.workPackages)}}class ApiV3VersionPaths extends ApiV3Resource{patch(e){return this.halResourceService.patch(this.path,e).pipe((0,f.M)((e=>this.touch(e))))}createCache(){return new w.l(this.states.versions)}}class ApiV3VersionsPaths extends i.K2{constructor(e,t){super(e,t,"versions",ApiV3VersionPaths),this.apiRoot=e,this.basePath=t,this.form=this.subResource("form",k.c),this.available_projects=this.subResource("available_projects",ApiV3AvailableProjectsPaths)}get(){return this.halResourceService.get(this.path)}post(e){return this.halResourceService.post(this.path,e)}}class ApiV3ProjectCopyPaths extends I.B{constructor(e,t){super(t,"copy"),this.apiRoot=e,this.basePath=t,this.form=new k.c(this.apiRoot,this.path,"form")}}class ApiV3ProjectPaths extends ApiV3Resource{constructor(){super(...arguments),this.available_assignees=this.subResource("available_assignees"),this.queries=new ApiV3QueriesPaths(this.apiRoot,this.path),this.types=new ApiV3TypesPaths(this.apiRoot,this.path),this.work_packages=new ApiV3WorkPackagesPaths(this.apiRoot,this.path),this.versions=new ApiV3VersionsPaths(this.apiRoot,this.path),this.copy=new ApiV3ProjectCopyPaths(this.apiRoot,this.path)}createCache(){return this.parent.cache}}class ProjectCache extends w.l{constructor(e,t){super(t),this.injector=e}updateValue(e,t){return this.schemaCacheService.ensureLoaded(t).then((()=>(this.putValue(e,t),t)))}static{this.ɵfac=function ProjectCache_Factory(e){return new(e||ProjectCache)(E.KVO(E.zZn),E.KVO(O.bq))}}static{this.ɵprov=E.jDH({token:ProjectCache,factory:ProjectCache.ɵfac})}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",b.D)],ProjectCache.prototype,"schemaCacheService",void 0);class ApiV3ProjectsPaths extends ApiV3Collection{constructor(e,t){super(e,t,"projects",ApiV3ProjectPaths),this.apiRoot=e,this.basePath=t,this.schema=this.subResource("schema")}list(e){return this.halResourceService.get(this.path+(0,s.Y)(e)).pipe(this.cacheResponse())}createCache(){return new ProjectCache(this.injector,this.states.projects)}}class ApiV3StatusPaths extends ApiV3Resource{createCache(){return new w.l(this.states.statuses)}}class ApiV3StatusesPaths extends i.K2{constructor(e,t){super(e,t,"statuses",ApiV3StatusPaths),this.apiRoot=e,this.basePath=t}get(){return this.halResourceService.get(this.path).pipe((0,f.M)((e=>{e.elements.forEach(((e,t)=>{this.id(e.id).cache.updateValue(e.id,e)}))})))}}class ApiV3RolePaths extends ApiV3Resource{createCache(){return new w.l(this.states.roles)}}class ApiV3RolesPaths extends i.K2{constructor(e,t){super(e,t,"roles",ApiV3RolePaths),this.apiRoot=e,this.basePath=t}get(){return this.halResourceService.get(this.path).pipe((0,f.M)((e=>{e.elements.forEach(((e,t)=>{this.id(e.id).cache.updateValue(e.id,e)}))})))}}class ApiV3NewsPaths extends i.K2{constructor(e,t){super(e,t,"news"),this.apiRoot=e,this.basePath=t}list(e){return this.halResourceService.get(this.path+(0,s.Y)(e))}}class ApiV3HelpTextsPaths extends i.K2{constructor(e,t){super(e,t,"help_texts"),this.apiRoot=e,this.basePath=t}get(){return this.halResourceService.get(this.path)}}class ApiV3ConfigurationPath extends i.Sq{constructor(e,t){super(e,t,"configuration"),this.apiRoot=e,this.basePath=t}get(){return this.$configuration?this.$configuration:this.$configuration=this.halResourceService.get(this.path).pipe((0,h.t)())}}class Board{constructor(e){this.grid=e}get id(){return this.grid.id}get name(){return this.grid.name}get editable(){return!!this.grid.updateImmediately}get isFree(){return!this.isAction}get isAction(){return"action"===this.grid.options.type}get actionAttribute(){if(!this.isFree)return this.grid.options.attribute}set highlightingMode(e){this.grid.options.highlightingMode=e}get highlightingMode(){return this.grid.options.highlightingMode||"none"}set name(e){this.grid.name=e}addQuery(e){e.isNewWidget=!0,this.grid.widgets.push(e)}removeQuery(e){this.grid.widgets=this.grid.widgets.filter((t=>t.options.queryId!==e.options.queryId))}get queries(){return this.grid.widgets}get createdAt(){return this.grid.createdAt}get filters(){return this.grid.options.filters||[]}set filters(e){this.grid.options.filters=e}sortWidgets(){this.grid.widgets=this.grid.widgets.sort(((e,t)=>e.startColumn-t.startColumn))}showStatusButton(){return"status"!==this.actionAttribute}}var A=n(67820);class ApiV3BoardPath extends ApiV3Resource{load(){return this.apiRoot.grids.id(this.id).get().pipe((0,T.T)((e=>{const t=new Board(e);return t.sortWidgets(),t})))}save(e){return this.fetchSchema(e).pipe((0,m.n)((t=>this.apiRoot.grids.id(e.grid).patch(e.grid,t))),(0,T.T)((t=>(e.grid=t,e.sortWidgets(),e))),this.cacheResponse())}delete(){return this.apiRoot.grids.id(this.id).delete().pipe((0,f.M)((()=>this.cache.clearSome(this.id.toString()))))}fetchSchema(e){return this.apiRoot.grids.id(e.grid).form.post({}).pipe((0,T.T)((e=>e.schema)))}createCache(){return this.parent.cache}}var V=n(96027);class ApiV3BoardsPaths extends ApiV3Collection{constructor(e,t){super(e,t,"grids",ApiV3BoardPath),this.apiRoot=e,this.basePath=t}list(e){return this.halResourceService.get(this.path+(0,s.Y)(e)).pipe((0,f.M)((e=>this.authorisationService.initModelAuth("boards",e.$links))),(0,T.T)((e=>e.elements.map((e=>{const t=new Board(e);return t.sortWidgets(),this.touch(t),t})))))}allInScope(e){const t=this.boardPath(e);return this.list({filters:[["scope","=",[t]]],pageSize:V.yZ})}create(e,t,n,i){const o=this.boardPath(n);return this.createGrid(e,t,o,i).pipe((0,T.T)((e=>new Board(e))))}boardPath(e){return this.PathHelper.boardsPath(e)}createCache(){const e=this.states.forType("boards");return new w.l(e)}createGrid(e,t,n,i){const o=_.set({name:t},"_links.scope.href",n);return o.options={type:e},i&&(o.options.attribute=i),this.apiRoot.grids.form.post(o).pipe((0,m.n)((e=>this.apiRoot.grids.post(e.payload.$source))))}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",A._)],ApiV3BoardsPaths.prototype,"authorisationService",void 0),(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",o.B)],ApiV3BoardsPaths.prototype,"PathHelper",void 0);class ApiV3PlaceholderUserPaths extends i.Sq{patch(e){return this.halResourceService.patch(this.path,{name:e.name})}delete(){return this.halResourceService.delete(this.path)}}class ApiV3PlaceholderUsersPaths extends i.K2{constructor(e,t){super(e,t,"placeholder_users",ApiV3PlaceholderUserPaths),this.apiRoot=e,this.basePath=t}list(e){return this.halResourceService.get(this.path+(0,s.Y)(e))}post(e){return this.halResourceService.post(this.path,e)}}class ApiV3GroupPaths extends i.Sq{patch(e){return this.halResourceService.patch(this.path,{name:e.name})}delete(){return this.halResourceService.delete(this.path)}}class ApiV3GroupsPaths extends i.K2{constructor(e,t){super(e,t,"groups",ApiV3GroupPaths),this.apiRoot=e,this.basePath=t}list(e){return this.halResourceService.get(this.path+(0,s.Y)(e))}post(e){return this.halResourceService.post(this.path,e)}}class ApiV3NotificationPaths extends i.Sq{markRead(){return this.http.post(`${this.path}/read_ian`,{},{withCredentials:!0,responseType:"json"})}markUnread(){return this.http.post(`${this.path}/unread_ian`,{},{withCredentials:!0,responseType:"json"})}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",j.Qq)],ApiV3NotificationPaths.prototype,"http",void 0);class ApiV3NotificationsPaths extends i.K2{constructor(e,t){super(e,t,"notifications",ApiV3NotificationPaths),this.apiRoot=e,this.basePath=t}facet(e,t){return"unread"===e?this.unread(t):this.list(t)}list(e){return this.http.get(this.path+(0,s.Y)(e))}listPath(e){return this.path+(0,s.Y)(e)}unread(e){const t=[...e?.filters?e.filters:[],["readIAN","=",!1]],n={...e,filters:t};return this.list(n)}markAsReadByIds(e){return this.http.post(`${this.path}/read_ian${(0,s.Y)({filters:[["id","=",e.map((e=>e.toString()))]]})}`,{},{withCredentials:!0,responseType:"json"})}markAsReadByFilter(e){return this.http.post(`${this.path}/read_ian${(0,s.Y)({filters:e.map((e=>[e[0],e[1],e[2]]))})}`,{},{withCredentials:!0,responseType:"json"})}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",j.Qq)],ApiV3NotificationsPaths.prototype,"http",void 0);class ApiV3ViewsPaths extends i.K2{constructor(e,t){super(e,t,"views"),this.apiRoot=e,this.basePath=t}post(e,t){return this.http.post(`${this.path}/${t}`,e,{withCredentials:!0,responseType:"json"}).pipe((0,T.T)((e=>e)))}}(0,a.Cg)([(0,l.O)(),(0,a.Sn)("design:type",j.Qq)],ApiV3ViewsPaths.prototype,"http",void 0);class Apiv3BackupsPath extends i.Sq{constructor(e,t){super(e,t,"backups"),this.apiRoot=e,this.basePath=t}post(e,t){return this.halResourceService.post(this.path,{backupToken:e,attachments:t})}}class ApiV3DayPaths extends i.Sq{}class ApiV3DaysPaths extends i.K2{constructor(e,t){super(e,t,"days",ApiV3DayPaths),this.apiRoot=e,this.basePath=t,this.week=new i.K2(this.apiRoot,this.path,"week"),this.nonWorkingDays=new i.K2(this.apiRoot,this.path,"non_working")}}class ApiV3StoragesPaths extends i.K2{constructor(e,t){super(e,t,"storages"),this.apiRoot=e,this.basePath=t,this.files=this.subResource("files")}}class ApiV3ProjectStoragesPaths extends i.K2{constructor(e,t){super(e,t,"project_storages"),this.apiRoot=e,this.basePath=t}}class ApiV3Service{constructor(e,t){this.injector=e,this.pathHelper=t,this.attachments=this.apiV3CollectionEndpoint("attachments"),this.backups=this.apiV3CustomEndpoint(Apiv3BackupsPath),this.configuration=this.apiV3CustomEndpoint(ApiV3ConfigurationPath),this.days=this.apiV3CustomEndpoint(ApiV3DaysPaths),this.documents=this.apiV3CollectionEndpoint("documents"),this.file_links=this.apiV3CollectionEndpoint("file_links"),this.notifications=this.apiV3CustomEndpoint(ApiV3NotificationsPaths),this.github_pull_requests=this.apiV3CollectionEndpoint("github_pull_requests"),this.grids=this.apiV3CustomEndpoint(ApiV3GridsPaths),this.principals=this.apiV3CollectionEndpoint("principals"),this.root=this.apiV3SingularEndpoint(""),this.shares=this.apiV3CollectionEndpoint("shares"),this.statuses=this.apiV3CustomEndpoint(ApiV3StatusesPaths),this.relations=this.apiV3CustomEndpoint(ApiV3RelationsPaths),this.priorities=this.apiV3CollectionEndpoint("priorities"),this.time_entries=this.apiV3CustomEndpoint(ApiV3TimeEntriesPaths),this.actions=this.apiV3CollectionEndpoint("actions"),this.capabilities=this.apiV3CustomEndpoint(ApiV3CapabilitiesPaths),this.meetings=this.apiV3CollectionEndpoint("meetings"),this.memberships=this.apiV3CustomEndpoint(ApiV3MembershipsPaths),this.news=this.apiV3CustomEndpoint(ApiV3NewsPaths),this.storages=this.apiV3CustomEndpoint(ApiV3StoragesPaths),this.projectStorages=this.apiV3CustomEndpoint(ApiV3ProjectStoragesPaths),this.types=this.apiV3CustomEndpoint(ApiV3TypesPaths),this.versions=this.apiV3CustomEndpoint(ApiV3VersionsPaths),this.work_packages=this.apiV3CustomEndpoint(ApiV3WorkPackagesPaths),this.queries=this.apiV3CustomEndpoint(ApiV3QueriesPaths),this.projects=this.apiV3CustomEndpoint(ApiV3ProjectsPaths),this.users=this.apiV3CustomEndpoint(ApiV3UsersPaths),this.placeholder_users=this.apiV3CustomEndpoint(ApiV3PlaceholderUsersPaths),this.groups=this.apiV3CustomEndpoint(ApiV3GroupsPaths),this.roles=this.apiV3CustomEndpoint(ApiV3RolesPaths),this.help_texts=this.apiV3CustomEndpoint(ApiV3HelpTextsPaths),this.job_statuses=this.apiV3CollectionEndpoint("job_statuses"),this.views=this.apiV3CustomEndpoint(ApiV3ViewsPaths),this.boards=this.apiV3CustomEndpoint(ApiV3BoardsPaths)}withOptionalProject(e){return _.isNil(e)?this:this.projects.id(e)}collectionFromString(e){const t=e.replace(`${this.pathHelper.api.v3.apiV3Base}/`,"");return this.apiV3CollectionEndpoint(t)}apiV3CollectionEndpoint(e,t){return new i.K2(this,this.pathHelper.api.v3.apiV3Base,e,t)}apiV3CustomEndpoint(e){return new e(this,this.pathHelper.api.v3.apiV3Base)}apiV3SingularEndpoint(e){return new i.Sq(this,this.pathHelper.api.v3.apiV3Base,e)}static{this.ɵfac=function ApiV3Service_Factory(e){return new(e||ApiV3Service)(E.KVO(E.zZn),E.KVO(o.B))}}static{this.ɵprov=E.jDH({token:ApiV3Service,factory:ApiV3Service.ɵfac,providedIn:"root"})}}},42410:(e,t,n)=>{"use strict";n.d(t,{l:()=>StateCacheService});var i=n(56196),o=n(19999),r=n(64334),s=n(71870),a=n(63037),l=n(67535),c=n(70271);class StateCacheService{constructor(e,t=3600){this.multiState=e,this.cacheDurationInMs=1e3*t}state(e){return this.multiState.get(e)}touch(e){const t=this.multiState.get(e);t.putValue(t.value,"Touching the state")}current(e,t){return this.state(e).getValueOr(t)}clearAndLoad(e,t){const n=t.pipe((0,r.s)(1),(0,s.u)());return this.multiState.get(e).clearAndPutFromPromise((0,i._)(n)),n}updateValue(e,t){return this.putValue(e,t),Promise.resolve(t)}updateFor(e){return this.updateValue(e.id,e)}observe(e){return this.state(e).values$()}changes$(e){return this.state(e).changes$()}observeAll(){return this.multiState.observeChange().pipe((0,a.Z)([]),(0,l.Z)(250),(0,c.T)((()=>{const e=[];return _.each(this.multiState.getValueOr({}),(t=>{t.value&&e.push(t.value)})),e})))}observeSome(e){return(0,o.z)(e.map((e=>this.observe(e).pipe((0,a.Z)(null))))).pipe((0,c.T)((e=>e.filter((e=>!!e)))))}clearSome(...e){e.forEach((e=>this.multiState.get(e).clear()))}stale(e){const t=this.multiState.get(e);return!t.hasActivePromiseRequest()&&(t.isPristine()||t.isValueOlderThan(this.cacheDurationInMs))}putValue(e,t){this.multiState.get(e).putValue(t)}}},73588:(e,t,n)=>{"use strict";n.d(t,{i:()=>ApiV3GridForm});var i=n(46603),o=n(20001),r=n(27514);class ApiV3GridForm extends i.c{static extractPayload(e,t=null){if(e instanceof r.q&&t){const n=e,i=o.y.extractPayloadFromSchema(n,t);return i.widgets&&(i.widgets=n.widgets.map((e=>({id:e.id,startRow:e.startRow,endRow:e.endRow,startColumn:e.startColumn,endColumn:e.endColumn,identifier:e.identifier,options:e.options})))),i}return e||{}}extractPayload(e,t=null){return ApiV3GridForm.extractPayload(e,t)}}},46603:(e,t,n)=>{"use strict";n.d(t,{c:()=>ApiV3FormResource});var i=n(86561),o=n(20001);class ApiV3FormResource extends i.pp{post(e={},t=null){return this.halResourceService.post(this.path,this.extractPayload(e,t))}extractPayload(e,t=null){return o.y.extractPayload(e,t)}}},68365:(e,t,n)=>{"use strict";function addFiltersToPath(e,t,n={}){const i=new URL(e,window.location.origin);if(i.searchParams.has("filters")){const e=JSON.parse(i.searchParams.get("filters"));i.searchParams.set("filters",JSON.stringify(e.concat(t.filters)))}else i.searchParams.set("filters",t.toJson());return Object.keys(n).forEach((e=>{i.searchParams.set(e,n[e])})),i}n.d(t,{R:()=>addFiltersToPath})},96027:(e,t,n)=>{"use strict";n.d(t,{eS:()=>getPaginatedResults,gu:()=>c,ro:()=>getPaginatedCollections,yZ:()=>l});var i=n(1365),o=n(70271),r=n(61873),s=n(59452),a=n(27514);const l=-1,c=100;function getPaginatedCollections(e,t=l){return e({pageSize:t,offset:1}).pipe((0,i.Z)((t=>{const n=t.pageSize;if(t.total>t.count){const i=t.total-t.count,s=Math.ceil(i/n),a=new Array(s).fill(null).map(((t,i)=>e({pageSize:n,offset:i+2})));return(0,r.p)(...a).pipe((0,o.T)((e=>[t,...e])))}return(0,s.of)([t])})))}function getPaginatedResults(e,t=l){return getPaginatedCollections(e,t).pipe((0,o.T)((e=>e.reduce(((e,t)=>e.concat(function extractCollectionElements(e){return e instanceof a.q?e.elements||[]:e._embedded?.elements||[]}(t))),[]))))}},98435:(e,t,n)=>{"use strict";n.d(t,{Y:()=>listParamsString});var i=n(89282);function listParamsString(e){const t=[];if(e&&e.sortBy&&t.push(`sortBy=${JSON.stringify(e.sortBy)}`),e&&e.groupBy&&t.push(`groupBy=${e.groupBy}`),e&&void 0!==e.pageSize&&t.push(`pageSize=${e.pageSize}`),e&&void 0!==e.offset&&t.push(`offset=${e.offset}`),e&&void 0!==e.select&&t.push(`select=${e.select.join(",")}`),e&&e.filters){const n=new i.hG;e.filters.forEach((e=>{n.add(...e)})),t.push(n.toParams())}let n="";return t.length&&(n=`?${t.join("&")}`),n}},86561:(e,t,n)=>{"use strict";n.d(t,{K2:()=>ApiV3ResourceCollection,Sq:()=>ApiV3GettableResource,pp:()=>ApiV3ResourcePath});var i=n(24398),o=n(30501),r=n(67704),s=n(1758),a=n(36178),l=n(96027),c=n(68365);class ApiV3ResourcePath extends r.B{constructor(e,t,n,i){super(t,n),this.apiRoot=e,this.basePath=t,this.id=n,this.parent=i,this.injector=this.apiRoot.injector}subResource(e,t=ApiV3GettableResource){return new t(this.apiRoot,this.path,e,this)}}(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",a.t)],ApiV3ResourcePath.prototype,"halResourceService",void 0);class ApiV3GettableResource extends ApiV3ResourcePath{get(){return this.halResourceService.get(this.path)}}class ApiV3GettableResourceCollection extends ApiV3GettableResource{getPaginatedResults(){return(0,l.eS)((e=>this.halResourceService.request("get",this.path,e)),-1)}}class ApiV3ResourceCollection extends r.Z{constructor(e,t,n,i){super(t,n,i),this.apiRoot=e,this.basePath=t,this.resource=i,this.injector=this.apiRoot.injector}id(e){let t;return t="string"==typeof e||"number"==typeof e?e.toString():e.id,new(this.resource||ApiV3GettableResource)(this.apiRoot,this.path,t,this)}withOptionalId(e){return _.isNil(e)?this:this.id(e)}toString(){return this.path}toPath(){return this.path}filtered(e,t={},n){const i=(0,c.R)(this.path,e,t);return new(n||ApiV3GettableResourceCollection)(this.apiRoot,i.pathname,i.search,this)}signalled(e,t,n={}){const i=(0,c.R)(this.path,e,{...n,select:t.join(",")});return this.http.get(i.toString())}subResource(e,t=ApiV3GettableResource){return new t(this.apiRoot,this.path,e,this)}}(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",o.Qq)],ApiV3ResourceCollection.prototype,"http",void 0),(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",a.t)],ApiV3ResourceCollection.prototype,"halResourceService",void 0)},67704:(e,t,n)=>{"use strict";n.d(t,{B:()=>SimpleResource,Z:()=>SimpleResourceCollection});class SimpleResourceCollection{constructor(e,t,n){this.basePath=e,this.segment=t,this.resource=n,this.path=`${this.basePath}/${t}`}id(e){return new(this.resource||SimpleResource)(this.path,e)}withOptionalId(e){return _.isNil(e)?this:this.id(e)}toString(){return this.path}toPath(){return this.path}}class SimpleResource{constructor(e,t){this.basePath=e,this.segment=t;const n=t.toString().startsWith("?")?"":"/";this.path=`${this.basePath}${n}${t}`}toString(){return this.path}toPath(){return this.path}}},75275:(e,t,n)=>{"use strict";n.d(t,{l:()=>BrowserDetector});var i=n(60316),o=n(68559);class BrowserDetector{constructor(e){this.documentElement=e}get isMobile(){return this.hasBodyClass("-browser-mobile")}get isEdge(){return this.hasBodyClass("-browser-edge")}hasBodyClass(e){return this.documentElement.body.classList.contains(e)}static{this.ɵfac=function BrowserDetector_Factory(e){return new(e||BrowserDetector)(o.KVO(i.qQ))}}static{this.ɵprov=o.jDH({token:BrowserDetector,factory:BrowserDetector.ɵfac,providedIn:"root"})}}},36652:(e,t,n)=>{"use strict";n.d(t,{g:()=>DeviceService});var i=n(68559);class DeviceService{constructor(){this.mobileWidthThreshold=544,this.smallDesktopWidthThreshold=1012}get isMobile(){return window.innerWidth<this.mobileWidthThreshold}get isSmallDesktop(){return window.innerWidth<this.smallDesktopWidthThreshold}static{this.ɵfac=function DeviceService_Factory(e){return new(e||DeviceService)}}static{this.ɵprov=i.jDH({token:DeviceService,factory:DeviceService.ɵfac,providedIn:"root"})}}},72688:(e,t,n)=>{"use strict";n.d(t,{s:()=>ConfigurationService});var i=n(39545),o=n(14593),r=n(68559);class ConfigurationService{constructor(e){this.apiV3Service=e}initialize(){return this.loadConfiguration()}commentsSortedInDescendingOrder(){return this.userPreference("commentSortDescending")}warnOnLeavingUnsaved(){return this.userPreference("warnOnLeavingUnsaved")}autoHidePopups(){return this.userPreference("autoHidePopups")}isTimezoneSet(){return!!this.timezone()}isDefaultTimezoneSet(){return!!this.defaultTimezone()}timezone(){return this.userPreference("timeZone")}isDirectUploads(){return!!this.prepareAttachmentURL}get prepareAttachmentURL(){return _.get(this.configuration,["prepareAttachment","href"])}get maximumAttachmentFileSize(){return this.systemPreference("maximumAttachmentFileSize")}get perPageOptions(){return this.systemPreference("perPageOptions")}dateFormatPresent(){return!!this.systemPreference("dateFormat")}dateFormat(){return this.systemPreference("dateFormat")}durationFormat(){return this.systemPreference("durationFormat")}hoursPerDay(){return this.systemPreference("hoursPerDay")}hoursPerWeek(){return this.systemPreference("hoursPerWeek")}daysPerMonth(){return this.systemPreference("daysPerMonth")}timeFormatPresent(){return!!this.systemPreference("timeFormat")}timeFormat(){return this.systemPreference("timeFormat")}defaultTimezone(){return this.systemPreference("userDefaultTimezone")}startOfWeekPresent(){return!!this.systemPreference("startOfWeek")}startOfWeek(){return this.startOfWeekPresent()?this.systemPreference("startOfWeek"):i.localeData(I18n.locale).firstDayOfWeek()}get hostName(){return this.systemPreference("hostName")}get activeFeatureFlags(){return this.systemPreference("activeFeatureFlags")}loadConfiguration(){return this.apiV3Service.configuration.get().toPromise().then((e=>{this.configuration=e}))}userPreference(e){return _.get(this.configuration,["userPreferences",e])}systemPreference(e){return _.get(this.configuration,e)}static{this.ɵfac=function ConfigurationService_Factory(e){return new(e||ConfigurationService)(r.KVO(o.n))}}static{this.ɵprov=r.jDH({token:ConfigurationService,factory:ConfigurationService.ɵfac,providedIn:"root"})}}},86866:(e,t,n)=>{"use strict";n.d(t,{c:()=>CurrentProjectService});var i=n(73014),o=n(14593),r=n(68559);class CurrentProjectService{constructor(e,t){this.PathHelper=e,this.apiV3Service=t,this.currentId=null,this.currentName=null,this.currentIdentifier=null,this.detect()}get inProjectContext(){return null!==this.currentId}get path(){return this.currentIdentifier?this.PathHelper.projectPath(this.currentIdentifier):null}get apiv3Path(){return this.currentId?this.apiV3Service.projects.id(this.currentId).toString():null}get id(){return this.currentId}get name(){return this.currentName}get identifier(){return this.currentIdentifier}detect(){const e=document.querySelector("meta[name=current_project]");e?(this.currentId=e.dataset.projectId,this.currentName=e.dataset.projectName,this.currentIdentifier=e.dataset.projectIdentifier):(this.currentId=null,this.currentName=null,this.currentIdentifier=null)}static{this.ɵfac=function CurrentProjectService_Factory(e){return new(e||CurrentProjectService)(r.KVO(i.B),r.KVO(o.n))}}static{this.ɵprov=r.jDH({token:CurrentProjectService,factory:CurrentProjectService.ɵfac,providedIn:"root"})}}},1845:(e,t,n)=>{"use strict";n.d(t,{l:()=>CurrentUserModule});var i=n(63894),o=n(70164),r=n(63241),s=n(56196),a=n(68559);function loadUserMetadata(e){const t=document.querySelectorAll("meta[name=current_user]")[0];e.setUser({id:t?.dataset.id||null,name:t?.dataset.name||null,loggedIn:"true"===t?.dataset.loggedIn})}class CurrentUserModule{constructor(e){!function bootstrapModule(e){const t=e.get(i.K);window.ErrorReporter.addHook((()=>(0,s._)(t.user$).then((({id:e})=>({user:e||"anon"}))))),loadUserMetadata(t),document.addEventListener("turbo:load",(()=>loadUserMetadata(t)))}(e)}static{this.ɵfac=function CurrentUserModule_Factory(e){return new(e||CurrentUserModule)(a.KVO(a.zZn))}}static{this.ɵmod=a.$C({type:CurrentUserModule})}static{this.ɵinj=a.G2t({providers:[i.K,o.y,r.V]})}}},63241:(e,t,n)=>{"use strict";n.d(t,{V:()=>CurrentUserQuery});var i=n(57678),o=n(70164),r=n(68559);class CurrentUserQuery extends i.XK{constructor(e){super(e),this.store=e,this.isLoggedIn$=this.select((e=>!!e.loggedIn)),this.user$=this.select((e=>e))}static{this.ɵfac=function CurrentUserQuery_Factory(e){return new(e||CurrentUserQuery)(r.KVO(o.y))}}static{this.ɵprov=r.jDH({token:CurrentUserQuery,factory:CurrentUserQuery.ɵfac})}}},63894:(e,t,n)=>{"use strict";n.d(t,{K:()=>CurrentUserService});var i=n(14593),o=n(51280),r=n(19999),s=n(70271),a=n(36647),l=n(91817),c=n(64334),p=n(63241),d=n(70164),u=n(68559);class CurrentUserService{constructor(e,t,n,i){this.apiV3Service=e,this.currentUserStore=t,this.currentUserQuery=n,this.capabilitiesService=i,this.isLoggedIn$=this.currentUserQuery.isLoggedIn$,this.user$=this.currentUserQuery.user$,this._isLoggedIn=!1,this._user={id:null,name:null,loggedIn:!1},this.setupLegacyDataListeners()}setUser(e){this.currentUserStore.update((t=>({...t,...e})))}isLoggedInAndHasCapabalities$(e,t){return(0,r.z)([this.isLoggedIn$,this.hasCapabilities$(e,t)]).pipe((0,s.T)((([e,t])=>e&&t)))}capabilities$(e=[],t){return this.principalFilter$().pipe((0,s.T)((n=>{const i=_.compact([n]);return t&&i.push(["context","=",["global"===t||"projects"===t?"g":`p${t}`]]),e.length>0&&i.push(["action","=",e]),{filters:i,pageSize:-1}})),(0,a.n)((e=>this.capabilitiesService.requireCollection(e))))}hasCapabilities$(e,t){const n=_.castArray(e);return this.capabilities$(n,t).pipe((0,s.T)((e=>n.reduce(((t,n)=>t&&!!e.find((e=>e._links.action.href.endsWith(`/api/v3/actions/${n}`)))),e.length>0))),(0,l.F)())}hasAnyCapabilityOf$(e,t){const n=_.castArray(e);return this.capabilities$(n,t).pipe((0,s.T)((e=>e.reduce(((e,t)=>e||!!n.find((e=>t._links.action.href.endsWith(`/api/v3/actions/${e}`)))),!1))),(0,l.F)())}principalFilter$(){return this.user$.pipe((0,c.s)(1),(0,s.T)((e=>null===e.id?null:["principal","=",[e.id]])))}setupLegacyDataListeners(){this.currentUserQuery.user$.subscribe((e=>this._user=e)),this.currentUserQuery.isLoggedIn$.subscribe((e=>this._isLoggedIn=e))}get isLoggedIn(){return this._isLoggedIn}get userId(){return this._user.id||""}get name(){return this._user.name||""}get href(){return`/api/v3/users/${this.userId}`}get language(){return I18n.locale||"en"}static{this.ɵfac=function CurrentUserService_Factory(e){return new(e||CurrentUserService)(u.KVO(i.n),u.KVO(d.y),u.KVO(p.V),u.KVO(o.W))}}static{this.ɵprov=u.jDH({token:CurrentUserService,factory:CurrentUserService.ɵfac,providedIn:"root"})}}},70164:(e,t,n)=>{"use strict";n.d(t,{y:()=>s});var i=n(24398),o=n(57678),r=n(68559);let s=class CurrentUserStore extends o.il{constructor(){super({id:null,name:null,loggedIn:null})}static{this.ɵfac=function CurrentUserStore_Factory(e){return new(e||CurrentUserStore)}}static{this.ɵprov=r.jDH({token:CurrentUserStore,factory:CurrentUserStore.ɵfac})}};s=(0,i.Cg)([(0,o.g7)({name:"current-user"}),(0,i.Sn)("design:paramtypes",[])],s)},32420:(e,t,n)=>{"use strict";n.d(t,{D:()=>TimezoneService});var i=n(72688),o=n(61816),r=n(6923),s=n(58327),a=n(68559);class TimezoneService{constructor(e,t){this.configurationService=e,this.I18n=t}userTimezone(){return this.configurationService.isTimezoneSet()?this.configurationService.timezone():r.tz.guess()}parseDatetime(e,t){return r.utc(e,t).tz(this.userTimezone())}parseDate(e,t){return r(e,t)}parseISODatetime(e){return this.parseDatetime(e,"YYYY-MM-DDTHH:mm:ssZ")}parseISODate(e){return this.parseDate(e,"YYYY-MM-DD")}formattedDate(e,t=this.getDateFormat()){return this.parseDate(e).format(t)}daysFromToday(e){const t=this.parseDate(e),n=r().startOf("day");return t.diff(n,"days")}formattedTime(e,t){return this.parseDatetime(e).format(t||this.getTimeFormat())}formattedDatetime(e){const t=this.formattedDatetimeComponents(e);return`${t[0]} ${t[1]}`}formattedRelativeDateTime(e){return this.parseDatetime(e).fromNow()}formattedDatetimeComponents(e){const t=this.parseDatetime(e);return[t.format(this.getDateFormat()),t.format(this.getTimeFormat())]}toSeconds(e){return Number(r.duration(e).asSeconds().toFixed(2))}toHours(e){return Number(r.duration(e).asHours().toFixed(2))}toDays(e){return Number(r.duration(e).asDays().toFixed(2))}toISODuration(e,t){return r.duration(e,t).toISOString()}formattedDuration(e,t="hour"){switch(t){case"hour":return this.I18n.t("js.units.hour",{count:this.toHours(e)});case"days":return this.I18n.t("js.units.day",{count:this.toDays(e)});default:return""}}formattedChronicDuration(e,t={format:this.configurationService.durationFormat(),hoursPerDay:this.configurationService.hoursPerDay(),daysPerMonth:this.configurationService.daysPerMonth()}){const n=this.toSeconds(e);return(0,s.YU)(n,t)||"0h"}formattedISODate(e){return this.parseDate(e).format("YYYY-MM-DD")}formattedISODateTime(e){return e.format()}isValidISODate(e){return this.isValid(e,"YYYY-MM-DD")}isValidISODateTime(e){return this.isValid(e,"YYYY-MM-DDTHH:mm:ssZ")}isValid(e,t){const n=t||this.getDateFormat();return r(e,[n],!0).isValid()}getDateFormat(){return this.configurationService.dateFormatPresent()?this.configurationService.dateFormat():"L"}getTimeFormat(){return this.configurationService.timeFormatPresent()?this.configurationService.timeFormat():"LT"}static{this.ɵfac=function TimezoneService_Factory(e){return new(e||TimezoneService)(a.KVO(i.s),a.KVO(o.W))}}static{this.ɵprov=a.jDH({token:TimezoneService,factory:TimezoneService.ɵfac,providedIn:"root"})}}},74037:(e,t,n)=>{"use strict";n.d(t,{I:()=>WeekdayService});var i=n(24398),o=n(39545),r=n(64334),s=n(98764),a=n(1758),l=n(48940),c=n(59452),p=n(68559);class WeekdayService{constructor(e){this.injector=e}isNonWorkingDay(e){const t="number"==typeof e?e:o(e).isoWeekday();return!!(this.weekdays||[]).find((e=>e.day===t&&!e.working))}get nonWorkingDays(){return this.weekdays.filter((e=>!e.working))}loadWeekdays(){return this.weekdays?(0,c.of)(this.weekdays):this.weekdaysService.requireCollection().pipe((0,r.s)(1),(0,s.M)((e=>{this.weekdays=e})))}static{this.ɵfac=function WeekdayService_Factory(e){return new(e||WeekdayService)(p.KVO(p.zZn))}}static{this.ɵprov=p.jDH({token:WeekdayService,factory:WeekdayService.ɵfac,providedIn:"root"})}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",l.c)],WeekdayService.prototype,"weekdaysService",void 0)},99972:(e,t,n)=>{"use strict";n.d(t,{b:()=>BannersService});var i=n(60316),o=n(38941),r=n(68559);class BannersService{constructor(e){this.documentElement=e,this._banners=!0,this._banners=e.body.classList.contains("ee-banners-visible")}get eeShowBanners(){return this._banners}getEnterPriseEditionUrl({referrer:e,hash:t}={}){const n=new URL(o.Px);return e&&n.searchParams.set("op_referrer",e),t&&(n.hash=t),n.toString()}conditional(e,t){this._banners?this.callMaybe(e):this.callMaybe(t)}callMaybe(e){e&&e()}static{this.ɵfac=function BannersService_Factory(e){return new(e||BannersService)(r.KVO(i.qQ))}}static{this.ɵprov=r.jDH({token:BannersService,factory:BannersService.ɵfac,providedIn:"root"})}}},51730:(e,t,n)=>{"use strict";n.d(t,{m:()=>GonService});var i=n(68559);class GonService{get(...e){return _.get(window.gon,e,null)}get gon(){return window.gon}static{this.ɵfac=function GonService_Factory(e){return new(e||GonService)}}static{this.ɵprov=i.jDH({token:GonService,factory:GonService.ɵfac,providedIn:"root"})}}},48707:(e,t,n)=>{"use strict";n.d(t,{P:()=>OpTitleService});var i=n(68559),o=n(80436);const r=" | ";class OpTitleService{constructor(e){this.titleService=e}get current(){return this.titleService.getTitle()}get base(){return document.querySelector("meta[name=app_title]").content}get titleParts(){return this.current.split(r)}setFirstPart(e){if(this.current.includes(this.base)&&this.current.includes(r)){const t=this.titleParts;t[0]=e,this.titleService.setTitle(t.join(r))}else{const t=[e,this.base].join(r);this.titleService.setTitle(t)}}static{this.ɵfac=function OpTitleService_Factory(e){return new(e||OpTitleService)(i.KVO(o.hE))}}static{this.ɵprov=i.jDH({token:OpTitleService,factory:OpTitleService.ɵfac,providedIn:"root"})}}},61816:(e,t,n)=>{"use strict";n.d(t,{W:()=>I18nService});var i=n(68559),o=n(62223);class I18nService{constructor(e){this.config=e,this.i18n=window.I18n,this.toTime=this.i18n.toTime.bind(this.i18n);const t=document.querySelector("meta[name=openproject_initializer]");this.instanceLocale=t?.dataset.instancelocale||"en",this.config.addTagText=this.t("js.autocomplete_ng_select.add_tag"),this.config.clearAllText=this.t("js.autocomplete_ng_select.clear_all"),this.config.loadingText=this.t("js.autocomplete_ng_select.loading"),this.config.notFoundText=this.t("js.autocomplete_ng_select.not_found"),this.config.typeToSearchText=this.t("js.autocomplete_ng_select.type_to_search")}get locale(){return this.i18n.locale}t(e,t={}){return this.i18n.t(e,t)}instance_locale_translate(e,t={}){const n=this.i18n.locale;try{return this.i18n.locale=this.instanceLocale,this.t(e,t)}finally{this.i18n.locale=n}}toNumber(e,t){return this.i18n.localize("number",e,t)}static{this.ɵfac=function I18nService_Factory(e){return new(e||I18nService)(i.KVO(o.Ci))}}static{this.ɵprov=i.jDH({token:I18nService,factory:I18nService.ɵfac,providedIn:"root"})}}},80366:(e,t,n)=>{"use strict";n.d(t,{FX:()=>LoadingIndicatorService,kz:()=>withLoadingIndicator});var i=n(98764),o=n(68559);function withLoadingIndicator(e,t){return n=>(e.start(),n.pipe((0,i.M)((()=>e.delayedStop(t)),(()=>e.stop()),(()=>e.stop()))))}class LoadingIndicator{constructor(e){this.indicator=e,this.indicatorTemplate='<div class="loading-indicator--background">\n        <div class="op-loading-indicator">\n           <div></div><div></div>\n        </div>\n      </div>\n   '}set promise(e){this.start();const stopper=()=>this.delayedStop();e.then(stopper).catch(stopper)}start(){this.stop(),this.indicator.prepend(this.indicatorTemplate)}delayedStop(e=25){setTimeout((()=>this.stop()),e)}stop(){this.indicator.find(".loading-indicator--background").remove()}}class LoadingIndicatorService{get table(){return this.indicator("table")}get wpDetails(){return this.indicator("wpDetails")}get modal(){return this.indicator("modal")}getter(e){return this.indicator.bind(this,e)}indicator(e){return"string"==typeof e&&(e=this.getIndicatorAt(e)),new LoadingIndicator(e)}getIndicatorAt(e){return jQuery(".loading-indicator--location").filter(`[data-indicator-name="${e}"]`)}static{this.ɵfac=function LoadingIndicatorService_Factory(e){return new(e||LoadingIndicatorService)}}static{this.ɵprov=o.jDH({token:LoadingIndicatorService,factory:LoadingIndicatorService.ɵfac,providedIn:"root"})}}},2237:(e,t,n)=>{"use strict";n.d(t,{S:()=>MainMenuToggleService});var i=n(24398),o=n(75797),r=n(61816),s=n(86866),a=n(36652),l=n(1758),c=n(68559);class MainMenuToggleService{constructor(e,t,n){this.I18n=e,this.injector=t,this.deviceService=n,this.elementMinWidth=11,this.defaultWidth=230,this.localStorageKey="openProject-mainMenuWidth",this.localStorageStateKey="openProject-mainMenuCollapsed",this.global=window,this.htmlNode=document.getElementsByTagName("html")[0],this.mainMenu=jQuery("#main-menu")[0],this.hideElements=jQuery(".can-hide-navigation"),this.titleData=new o.t(""),this.titleData$=this.titleData.asObservable(),this.changeData=new o.t({}),this.changeData$=this.changeData.asObservable(),this.wasHiddenDueToResize=!1,this.wasCollapsedByUser=!1,this.initializeMenu(),window.addEventListener("resize",this.onWindowResize.bind(this))}initializeMenu(){if(!this.mainMenu)return;this.elementWidth=parseInt(window.OpenProject.guardedLocalStorage(this.localStorageKey));const e="true"===window.OpenProject.guardedLocalStorage(this.localStorageStateKey);this.wasCollapsedByUser=e,this.elementWidth?e?this.closeMenu():this.setWidth():this.saveWidth(this.mainMenu.offsetWidth),this.adjustMenuVisibility()}onWindowResize(){this.adjustMenuVisibility()}adjustMenuVisibility(){window.innerWidth>=1012?this.wasHiddenDueToResize&&!this.wasCollapsedByUser&&(this.setWidth(this.defaultWidth),this.wasHiddenDueToResize=!1):this.showNavigation&&(this.closeMenu(),this.wasHiddenDueToResize=!0)}toggleNavigation(e){e&&(e.stopPropagation(),e.preventDefault()),this.wasCollapsedByUser=this.showNavigation,this.wasHiddenDueToResize=!1,this.showNavigation?this.closeMenu():this.openMenu(),window.OpenProject.guardedLocalStorage(this.localStorageStateKey,String(!this.showNavigation)),setTimeout((()=>{jQuery('#main-menu [class*="-menu-item"]:visible').first().focus()}),500)}closeMenu(){this.setWidth(0),jQuery(".searchable-menu--search-input").blur()}openMenu(){this.setWidth(this.defaultWidth)}setWidth(e){void 0!==e&&(this.elementWidth=e),this.mainMenu.style.width=`${this.elementWidth}px`,this.htmlNode.style.setProperty("--main-menu-width",`${this.elementWidth}px`),this.toggleClassHidden(),this.snapBack(),this.setToggleTitle(),this.elementWidth>0&&window.OpenProject.guardedLocalStorage(this.localStorageKey,String(this.elementWidth))}saveWidth(e){this.setWidth(e),window.OpenProject.guardedLocalStorage(this.localStorageKey,String(this.elementWidth)),window.OpenProject.guardedLocalStorage(this.localStorageStateKey,String(0===this.elementWidth))}get showNavigation(){return this.elementWidth>=this.elementMinWidth}snapBack(){this.elementWidth<this.elementMinWidth&&(this.elementWidth=0)}setToggleTitle(){this.showNavigation?this.toggleTitle=this.I18n.t("js.label_hide_project_menu"):this.toggleTitle=this.I18n.t("js.label_expand_project_menu"),this.titleData.next(this.toggleTitle)}toggleClassHidden(){const e=this.elementWidth<this.elementMinWidth;this.hideElements.toggleClass("hidden-navigation",e)}static{this.ɵfac=function MainMenuToggleService_Factory(e){return new(e||MainMenuToggleService)(c.KVO(r.W),c.KVO(c.zZn),c.KVO(a.g))}}static{this.ɵprov=c.jDH({token:MainMenuToggleService,factory:MainMenuToggleService.ɵfac,providedIn:"root"})}}(0,i.Cg)([(0,l.O)(),(0,i.Sn)("design:type",s.c)],MainMenuToggleService.prototype,"currentProject",void 0)},99700:(e,t,n)=>{"use strict";n.d(t,{Z:()=>SubmenuService});var i=n(83093),o=n(68559);class SubmenuService{constructor(e){this.$state=e}reloadSubmenu(e){const t=this.$state.current.data.sideMenuOptions?.sidemenuId;if(t){const n=document.getElementById(t),i=this.$state.$current.data?.sideMenuOptions,o=n.getAttribute("src");if(o&&n){const t=new URL(o),r=i.defaultQuery;e&&(t.search=r?`?id=${e}`:`?query_id=${e}`),n.setAttribute("src",t.href)}}}static{this.ɵfac=function SubmenuService_Factory(e){return new(e||SubmenuService)(o.KVO(i.dw))}}static{this.ɵprov=o.jDH({token:SubmenuService,factory:SubmenuService.ɵfac,providedIn:"root"})}}},67820:(e,t,n)=>{"use strict";n.d(t,{_:()=>AuthorisationService});var i=n(47418),o=n(33900),r=n(68559);class AuthorisationService{constructor(){this.links=(0,i.hF)({})}initModelAuth(e,t){this.links.doModify((n=>{const i={...n};return i[e]=t,i}))}observeUntil(e){return this.links.values$().pipe((0,o.Q)(e))}can(e,t){const n=this.links.getValueOr({});return n[e]&&t in n[e]}cannot(e,t){return!this.can(e,t)}static{this.ɵfac=function AuthorisationService_Factory(e){return new(e||AuthorisationService)}}static{this.ɵprov=r.jDH({token:AuthorisationService,factory:AuthorisationService.ɵfac,providedIn:"root"})}}},98522:(e,t,n)=>{"use strict";n.d(t,{Z:()=>UrlParamsService});var i=n(63037),o=n(70271),r=n(86301),s=n(84205),a=n(68559);class NavigationService{constructor(){this._currentURL=document.location.href,this._urlChanged$=new s.B,this.urlChanged$=this._urlChanged$.asObservable(),"navigation"in window?window.navigation.addEventListener("navigate",(e=>{this.handleURLChange(e.destination.url)})):setInterval((()=>this.handleURLChange(document.location.href)),250)}handleURLChange(e){e!==this._currentURL&&(this._urlChanged$.next(e),this._currentURL=e)}static{this.ɵfac=function NavigationService_Factory(e){return new(e||NavigationService)}}static{this.ɵprov=a.jDH({token:NavigationService,factory:NavigationService.ɵfac,providedIn:"root"})}}class UrlParamsService{constructor(e){this.navigation=e}get(e){return this.searchParams.get(e)}pathMatching(e,t=window.location.pathname){return t.match(e)?.[1]||null}pathMatching$(e){return this.navigation.urlChanged$.pipe((0,i.Z)(document.location.href),(0,o.T)((t=>this.pathMatching(e,t))),(0,r.t)(1))}has(e){return this.searchParams.has(e)}get searchParams(){return new URLSearchParams(window.location.search)}static{this.ɵfac=function UrlParamsService_Factory(e){return new(e||UrlParamsService)(a.KVO(NavigationService))}}static{this.ɵprov=a.jDH({token:UrlParamsService,factory:UrlParamsService.ɵfac,providedIn:"root"})}}},73014:(e,t,n)=>{"use strict";n.d(t,{B:()=>PathHelperService});var i=n(89282);class ApiV3Paths{constructor(e){this.apiV3Base=`${e}/api/v3`}get openApiSpecPath(){return`${this.apiV3Base}/spec.json`}previewMarkup(e){const t=`${this.apiV3Base}/render/markdown`;return e?`${t}?context=${e}`:t}principals(e,t){const n=new i.hG;return n.add("status","!",["3"]),e.id&&"new"!==e.id?n.add("mentionable_on_work_package","=",[e.id.toString()]):n.add("member","=",[e.project.id]),n.add("type","=",["User","Group"]),t&&t.length>0&&n.add("name","~",[t]),`${this.apiV3Base}/principals?${n.toParams({sortBy:'[["name","asc"]]',offset:"1",pageSize:"10"})}`}}var o=n(68559);class PathHelperService{constructor(){this.appBasePath=window.appBasePath||"",this.api={v3:new ApiV3Paths(this.appBasePath)}}get staticBase(){return this.appBasePath}attachmentDownloadPath(e,t){const n=`${this.staticBase}/attachments/${e}`;return t?`${n}/${t}`:n}attachmentContentPath(e){return`${this.staticBase}/attachments/${e}/content`}fileLinksPath(){return`${this.api.v3.apiV3Base}/file_links`}ifcModelsPath(e){return`${this.staticBase}/projects/${e}/ifc_models`}ifcModelsNewPath(e){return`${this.ifcModelsPath(e)}/new`}ifcModelsEditPath(e,t){return`${this.ifcModelsPath(e)}/${t}/edit`}ifcModelsDeletePath(e,t){return`${this.ifcModelsPath(e)}/${t}`}bimDetailsPath(e,t,n=null){let i=`${this.projectPath(e)}/bcf/details/${t}`;return null!==n&&(i+=`?query_props=%7B"t"%3A"id%3Adesc"%2C"dr"%3A"splitCards"%7D&viewpoint=${n}`),i}highlightingCssPath(){return`${this.staticBase}/highlighting/styles`}forumPath(e,t){return`${this.projectForumPath(e)}/${t}`}keyboardShortcutsHelpPath(){return`${this.staticBase}/help/keyboard_shortcuts`}messagePath(e){return`${this.staticBase}/topics/${e}`}meetingPath(e){return`${this.staticBase}/meetings/${e}`}myPagePath(){return`${this.staticBase}/my/page`}myNotificationsSettingsPath(){return`${this.staticBase}/my/notifications`}newsPath(e){return`${this.staticBase}/news/${e}`}notificationsPath(){return`${this.staticBase}/notifications`}notificationsDetailsPath(e,t){return`${this.notificationsPath()}/details/${e}${t?`/${t}`:""}`}loginPath(){return`${this.staticBase}/login`}projectsPath(){return`${this.staticBase}/projects`}projectsNewPath(){return`${this.staticBase}/projects/new`}projectPath(e){return`${this.projectsPath()}/${e}`}projectActivityPath(e){return`${this.projectPath(e)}/activity`}projectForumPath(e){return`${this.projectPath(e)}/forums`}projectCalendarPath(e){return`${this.projectPath(e)}/calendars`}projectMembershipsPath(e){return`${this.projectPath(e)}/members`}projectNewsPath(e){return`${this.projectPath(e)}/news`}projectTimeEntriesPath(e){return`${this.projectPath(e)}/cost_reports`}projectWikiPath(e){return`${this.projectPath(e)}/wiki`}projectWorkPackagePath(e,t){return`${this.projectWorkPackagesPath(e)}/${t}`}projectWorkPackagesPath(e){return`${this.projectPath(e)}/work_packages`}projectWorkPackageNewPath(e){return`${this.projectWorkPackagesPath(e)}/new`}boardsPath(e){return e?`${this.projectPath(e)}/boards`:`${this.staticBase}/boards`}newBoardsPath(e){return`${this.boardsPath(e)}/new`}projectDashboardsPath(e){return`${this.projectPath(e)}/dashboards`}timeEntriesPath(e){const t="/time_entries";return e?this.workPackagePath(e)+t:this.staticBase+t}usersPath(){return`${this.staticBase}/users`}groupsPath(){return`${this.staticBase}/groups`}placeholderUsersPath(){return`${this.staticBase}/placeholder_users`}userPath(e){return`${this.usersPath()}/${e}`}userHoverCardPath(e){return`${this.usersPath()}/${e}/hover_card`}placeholderUserPath(e){return`${this.placeholderUsersPath()}/${e}`}groupPath(e){return`${this.groupsPath()}/${e}`}rolesPath(){return`${this.staticBase}/roles`}rolePath(e){return`${this.rolesPath()}/${e}`}versionsPath(){return`${this.staticBase}/versions`}versionEditPath(e){return`${this.staticBase}/versions/${e}/edit`}versionShowPath(e){return`${this.staticBase}/versions/${e}`}workPackagesPath(){return`${this.staticBase}/work_packages`}workPackagePath(e){return`${this.staticBase}/work_packages/${e}`}workPackageShortPath(e){return`${this.staticBase}/wp/${e}`}workPackageCopyPath(e){return`${this.workPackagePath(e)}/copy`}workPackageDetailsPath(e,t,n){return n?`${this.projectWorkPackagePath(e,t)}/details/${n}`:`${this.projectWorkPackagesPath(e)}/details/${t}`}workPackageDetailsCopyPath(e,t){return this.workPackageDetailsPath(e,t,"copy")}workPackageReminderModalBodyPath(e){return`${this.workPackagePath(e)}/reminders/modal_body`}workPackageSharePath(e){return`${this.workPackagePath(e)}/shares`}workPackageHoverCardPath(e){return`${this.workPackagePath(e)}/hover_card`}workPackageProgressModalPath(e){return"new"===e?`${this.workPackagePath(e)}/progress/new`:`${this.workPackagePath(e)}/progress/edit`}workPackageUpdateCounterPath(e,t){return`${this.workPackagePath(e)}/split_view/update_counter?counter=${t}`}workPackagesBulkEditPath(){return`${this.workPackagesPath()}/bulk/edit`}workPackagesBulkMovePath(){return`${this.workPackagesPath()}/move/new`}workPackagesBulkCopyPath(){return`${this.workPackagesBulkMovePath()}?copy=true`}workPackagesBulkDeletePath(){return`${this.workPackagesPath()}/bulk`}textFormattingHelp(){return`${this.staticBase}/help/text_formatting`}jobStatusModalPath(e){return`${this.staticBase}/job_statuses/${e}/dialog`}static{this.ɵfac=function PathHelperService_Factory(e){return new(e||PathHelperService)}}static{this.ɵprov=o.jDH({token:PathHelperService,factory:PathHelperService.ɵfac,providedIn:"root"})}}},7749:(e,t,n)=>{"use strict";n.d(t,{D:()=>RecentItemsService});var i=n(75797),o=n(68559);class RecentItemsService{constructor(){this.recentItems$=new i.t(this.getAll())}add(e){let t=this.getAll().filter((t=>t!==e));t.unshift(e),t.length>5&&(t=t.slice(0,5)),window.localStorage.setItem("recent",JSON.stringify(t)),this.recentItems$.next(t)}getAll(){return JSON.parse(window.OpenProject.guardedLocalStorage("recent")||"[]")}static{this.ɵfac=function RecentItemsService_Factory(e){return new(e||RecentItemsService)}}static{this.ɵprov=o.jDH({token:RecentItemsService,factory:RecentItemsService.ɵfac})}}},72097:(e,t,n)=>{"use strict";n.d(t,{H:()=>FirstRouteService});var i=n(68559);class FirstRouteService{constructor(){}get isEmpty(){return!this.name}setIfFirst(e,t){this.isEmpty&&e&&(this.name=e,this.params=t)}static{this.ɵfac=function FirstRouteService_Factory(e){return new(e||FirstRouteService)}}static{this.ɵprov=i.jDH({token:FirstRouteService,factory:FirstRouteService.ɵfac})}}},44674:(e,t,n)=>{"use strict";n.d(t,{D:()=>SchemaCacheService});var i=n(42410),o=n(56196),r=n(64334),s=n(13432),a=n(61039),l=n(36178),c=n(34760),p=n(27514),d=n(60490),u=n(68559);const h="__fallback";class SchemaCacheService extends i.l{constructor(e,t){super(e.schemas),this.states=e,this.halResourceService=t,this.fallbackSchema=this.halResourceService.createHalResourceOfClass(d.Y,{},!0),this.putValue(h,this.fallbackSchema)}state(e){return super.state(this.stateKey(e))}of(e){const t=this.state(e).value;return this.proxied(e,t)}proxied(e,t){return"WorkPackage"===e._type?c.T.create(t,e):a.K.create(t,e)}getSchemaHref(e){return e.$links.schema?.href}ensureLoaded(e){const t=e instanceof p.q?this.getSchemaHref(e):e;return(0,o._)(this.requireAndStream(t||h))}requireAndStream(e,t=!1){return(this.stale(e)||t)&&this.clearAndLoad(e,this.load(e)),this.state(e).values$()}load(e){return this.halResourceService.get(e).pipe((0,r.s)(1))}loadAll(e){return Promise.all(e.map((e=>this.load(e))))}update(e,t){this.multiState.get(this.stateKey(e)).putValue(t)}stateKey(e){return e instanceof p.q?this.getSchemaHref(e)||h:e}static{this.ɵfac=function SchemaCacheService_Factory(e){return new(e||SchemaCacheService)(u.KVO(s.D),u.KVO(l.t))}}static{this.ɵprov=u.jDH({token:SchemaCacheService,factory:SchemaCacheService.ɵfac})}}},38941:(e,t,n)=>{"use strict";n.d(t,{Px:()=>i,_K:()=>o,at:()=>r,y$:()=>s});const i="https://www.openproject.org/enterprise-edition/?op_edition=community-edition",o={en:"https://www.openproject.org/contact/",de:"https://www.openproject.org/de/kontakt/"},r="https://www.openproject.org/pricing",s={website:"https://www.openproject.org/enterprise-edition/",boards:"https://www.openproject.org/docs/user-guide/agile-boards/#action-boards-enterprise-add-on",tableHighlighting:"https://www.openproject.org/docs/user-guide/work-packages/work-package-table-configuration/#attribute-highlighting-enterprise-add-on",graphWidgets:"https://www.openproject.org/docs/user-guide/project-overview/#work-package-graph-widgets-enterprise-add-on"}},66899:(e,t,n)=>{"use strict";n.d(t,{f:()=>installMenuLogic});var i=n(91066);function closeMenu(e){const t=jQuery(e.data.menu);e.target!==t.find(" > li.drop-down.open > ul").get(0)&&(t.find(" > li.drop-down.open").removeClass("open").find("> ul").slideUp(i.V),jQuery("html").off("click",closeMenu))}function installMenuLogic(e){e.find(" > li.drop-down").on("click",(t=>{!function openMenu(e){const t=e.find(" > li.drop-down");t.hasClass("open")||(t.find("> ul").slideDown(i.V,(()=>{t.find("li > a:first").focus(),jQuery("html").on("click",{menu:e.get(0)},closeMenu)})),t.addClass("open"))}(e);const n=jQuery(t.target);(n.is(".drop-down")||n.closest("li, ul").is(".drop-down"))&&t.preventDefault()}))}},94876:(e,t,n)=>{"use strict";function setupServerResponse(){jQuery(document).ajaxComplete(activateFlashNotice),jQuery(document).ajaxComplete(activateFlashError),jQuery(document).ajaxSend(((e,t)=>{jQuery(e.target.activeElement).closest("[ajax-indicated]").length&&jQuery("ajax-indicator")&&jQuery("#ajax-indicator").show();const n=jQuery("meta[name=csrf-token]");if(n){const e="X-CSRF-Token",i=n.attr("content");t.setRequestHeader(e,i)}t.setRequestHeader("X-Authentication-Scheme","Session")})),jQuery(document).ajaxStop((()=>{jQuery("#ajax-indicator")&&jQuery("#ajax-indicator").hide(),addClickEventToAllErrorMessages()})),jQuery(".attachments h4").click((function(){jQuery(this).toggleClass("closed").next().slideToggle(100)}));let e=null;jQuery(window).on("resize",(()=>{e&&clearTimeout(e),e=setTimeout((()=>{jQuery(window).trigger("resizeEnd")}),200)})),jQuery("#nav-login-content").click((e=>{e.stopPropagation()}));const t=jQuery("a.afocus").first(),n=jQuery(".autofocus").first();void 0!==t?t.focus():void 0!==n&&(n.focus(),"INPUT"===n[0].tagName&&n.select()),addClickEventToAllErrorMessages(),jQuery(document.body).on("click",".formatting-help-link-button",(()=>(window.open(`${window.appBasePath}/help/wiki_syntax`,"","resizable=yes, location=no, width=600, height=640, menubar=no, status=no, scrollbars=yes"),!1)))}function addClickEventToAllErrorMessages(){jQuery("a.afocus").each((function(){const e=jQuery(this);e.click((t=>{let n=jQuery(`#${e.attr("href").substr(1)}`);return null===n&&(n=jQuery(`#${e.attr("href").substr(1).concat("_id")}`)),e.unbind(t),!1}))}))}function initMainMenuExpandStatus(){const e=jQuery("#wrapper"),t=jQuery("ul.menu_root.closed li.open a.arrow-left-to-project");1===t.length&&e.hasClass("hidden-navigation")&&t.trigger("click")}function activateFlash(e){jQuery(e).each(((e,t)=>{jQuery(t).show()}))}function activateFlashNotice(){activateFlash('.op-toast[role="alert"]')}function activateFlashError(){activateFlash('.errorExplanation[role="alert"]')}function focusFirstErroneousField(){jQuery("span.errorSpan").first().find("*").filter(":input").trigger("focus")}n.d(t,{VU:()=>focusFirstErroneousField,e4:()=>activateFlashError,ex:()=>activateFlashNotice,iX:()=>setupServerResponse,p3:()=>initMainMenuExpandStatus})},52202:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i,x:()=>waitForElement});const i="openProject-onboardingTour";function matchingFilter(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return e[n];return null}function waitForElement(e,t,n,i=(()=>!0)){const o=document.querySelector(t),r=matchingFilter(o.querySelectorAll(e),i);if(r)return void n(r);new MutationObserver(((t,r)=>{const s=matchingFilter(o.querySelectorAll(e),i);s&&(n(s),r.disconnect())})).observe(o,{childList:!0,subtree:!0})}},9594:(e,t,n)=>{"use strict";n(85684);var i=n(47418);class GlobalHelpers{checkAll(e,t){document.querySelectorAll(`#${e} input[type="checkbox"]:not([disabled])`).forEach((e=>e.checked=t))}toggleCheckboxesBySelector(e){const t=jQuery(e);let n=!0;for(let e=0;e<t.length;e++)!1===t[e].checked&&(n=!1);for(let e=0;e<t.length;e++)t[e].checked=!n}}var o=n(56196);window.OpenProject=new class OpenProject{constructor(){this.pluginContext=(0,i.hF)(),this.helpers=new GlobalHelpers,this.pageWasEdited=!1,this.pageIsSubmitted=!1}getPluginContext(){return(0,o._)(this.pluginContext.values$())}get urlRoot(){return jQuery("meta[name=app_base_path]").attr("content")||""}get environment(){return jQuery("meta[name=openproject_initializer]").data("environment")}get edition(){return jQuery("meta[name=openproject_initializer]").data("edition")}get isStandardEdition(){return"standard"===this.edition}get isBimEdition(){return"bim"===this.edition}guardedLocalStorage(e,t){try{if(void 0===t){const t=window.localStorage.getItem(e);return null===t?void 0:t}window.localStorage.setItem(e,t)}catch(e){console.error("Failed to access your browsers local storage. Is your local database corrupted?")}}}},15532:(e,t,n)=>{n(51206),n(63434),n(22978),n(74019),n(5088),n(88955),n(54088),n(19956),n(91424),n(57641),n(29421),n(91418),n(29197),n(11489),n(53615),n(38856),n(2477),n(61657),n(66446),n(56819),n(22307)},94564:(e,t,n)=>{"use strict";n.d(t,{d:()=>ActionsService});var i=n(84205),o=n(54768),r=n(36819),s=n(68559);class ActionsService{constructor(){this.actions=new i.B,this.actions$=this.actions.asObservable()}ofType(e){return this.actions$.pipe((0,o.g)(e))}dispatch(e){(0,r.cY)("Dispatching action: %O",e.type),this.actions.next(e)}static{this.ɵfac=function ActionsService_Factory(e){return new(e||ActionsService)}}static{this.ɵprov=s.jDH({token:ActionsService,factory:ActionsService.ɵfac,providedIn:"root"})}}},73962:(e,t,n)=>{"use strict";n.d(t,{_:()=>AttachmentsResourceService});var i=n(24398),o=n(30501),r=n(57678),s=n(98764),a=n(61318),l=n(70271),c=n(61816),p=n(72688),d=n(51132);let u=class AttachmentsStore extends r.D_{constructor(){super((0,d.gB)())}};u=(0,i.Cg)([(0,r.g7)({name:"attachments"}),(0,i.Sn)("design:paramtypes",[])],u);var h=n(72650),m=n(39626),g=n(94529),_=n(1758),f=n(97366),b=n(3901),k=n(57436),v=n(68559);class AttachmentsResourceService extends g.L{removeAttachment(e,t){const n=new o.Lr({"Content-Type":"application/json"});return this.http.delete(t._links.delete.href,{withCredentials:!0,headers:n}).pipe((0,s.M)((()=>(0,d.G8)(this.store,t.id,e))),(0,a.W)((e=>{throw this.toastService.addError(e),new Error(e.message)})))}attachFiles(e,t){const n=AttachmentsResourceService.getAttachmentsSelfLink(e)||f.g,i=this.getUploadTarget(e),o=t.map((e=>({file:e})));return this.addAttachments(n,i,o)}addAttachments(e,t,n){return this.uploadAttachments(t,n).pipe((0,s.M)((t=>{(0,r.hO)((()=>{this.store.add(t),this.store.update((({collections:n})=>({collections:{...n,[e]:{...n[e],ids:(n[e]?.ids||[]).concat(t.map((e=>e.id)))}}})))}))})))}uploadAttachments(e,t){const n=this.uploadService.upload(e,t),i=t.map(((e,t)=>[e.file,n[t]]));return this.toastService.addUpload(this.I18n.t("js.label_upload_notification"),i),(0,b.A)(n).pipe((0,l.T)((e=>e.map((e=>e.body)).filter(k.A))))}getUploadTarget(e){return this.getDirectUploadLink(e)||AttachmentsResourceService.getAddAttachmentsLink(e)||this.apiV3Service.attachments.path}getDirectUploadLink(e){const t=e.$links;return t.prepareAttachment?t.prepareAttachment.href:(0,f.A)(e)?this.configurationService.prepareAttachmentURL:null}static getAttachmentsSelfLink(e){if((0,f.A)(e))return null;const t=e.attachments;return t?.href||null}static getAddAttachmentsLink(e){if((0,f.A)(e))return null;const t=e.addAttachment;return t?.href||null}createStore(){return new u}basePath(){return this.apiV3Service.attachments.path}static{this.ɵfac=(()=>{let e;return function AttachmentsResourceService_Factory(t){return(e||(e=v.xGo(AttachmentsResourceService)))(t||AttachmentsResourceService)}})()}static{this.ɵprov=v.jDH({token:AttachmentsResourceService,factory:AttachmentsResourceService.ɵfac})}}(0,i.Cg)([(0,_.O)(),(0,i.Sn)("design:type",c.W)],AttachmentsResourceService.prototype,"I18n",void 0),(0,i.Cg)([(0,_.O)(),(0,i.Sn)("design:type",m.u)],AttachmentsResourceService.prototype,"uploadService",void 0),(0,i.Cg)([(0,_.O)(),(0,i.Sn)("design:type",p.s)],AttachmentsResourceService.prototype,"configurationService",void 0),(0,i.Cg)([(0,_.O)(),(0,i.Sn)("design:type",h.fw)],AttachmentsResourceService.prototype,"toastService",void 0)},51280:(e,t,n)=>{"use strict";n.d(t,{W:()=>CapabilitiesResourceService});var i=n(24398),o=n(70271),r=n(61318),s=n(72650),a=n(57678),l=n(51132);let c=class CapabilitiesStore extends a.D_{constructor(){super((0,l.gB)())}};c=(0,i.Cg)([(0,a.g7)({name:"capabilities"}),(0,i.Sn)("design:paramtypes",[])],c);var p=n(94529),d=n(1758),u=n(68559);class CapabilitiesResourceService extends p.L{loadedCapabilities$(e){return this.query.selectAll().pipe((0,o.T)((t=>t.filter((t=>t._links.context.href.endsWith(`/${e}`))))))}fetchCapabilities(e){return this.fetchCollection(e).pipe((0,r.W)((e=>{throw this.toastService.addError(e),e})))}createStore(){return new c}basePath(){return this.apiV3Service.capabilities.path}static{this.ɵfac=(()=>{let e;return function CapabilitiesResourceService_Factory(t){return(e||(e=u.xGo(CapabilitiesResourceService)))(t||CapabilitiesResourceService)}})()}static{this.ɵprov=u.jDH({token:CapabilitiesResourceService,factory:CapabilitiesResourceService.ɵfac})}}(0,i.Cg)([(0,d.O)(),(0,i.Sn)("design:type",s.fw)],CapabilitiesResourceService.prototype,"toastService",void 0)},42032:(e,t,n)=>{"use strict";n.d(t,{o:()=>DayResourceService});var i=n(70271),o=n(56196),r=n(24398),s=n(57678),a=n(51132);let l=class DayStore extends s.D_{constructor(){super((0,a.gB)())}};l=(0,r.Cg)([(0,s.g7)({name:"days"}),(0,r.Sn)("design:paramtypes",[])],l);var c=n(94529),p=n(6923),d=n(68559);class DayResourceService extends c.L{basePath(){return this.apiV3Service.days.nonWorkingDays.path}isNonWorkingDay$(e){const t=p(e).format("YYYY-MM-DD");return(0,o._)(this.requireNonWorkingYear$(e).pipe((0,i.T)((e=>-1!==e.findIndex((e=>e.date===t))))))}requireNonWorkingYear$(e){const t=[["date","<>d",[p(e).startOf("year").format("YYYY-MM-DD"),p(e).endOf("year").format("YYYY-MM-DD")]]];return this.requireCollection({filters:t})}requireNonWorkingYears$(e,t){const n=[["date","<>d",[p(e).startOf("year").format("YYYY-MM-DD"),p(t).endOf("year").format("YYYY-MM-DD")]]];return this.requireCollection({filters:n})}createStore(){return new l}static{this.ɵfac=(()=>{let e;return function DayResourceService_Factory(t){return(e||(e=d.xGo(DayResourceService)))(t||DayResourceService)}})()}static{this.ɵprov=d.jDH({token:DayResourceService,factory:DayResourceService.ɵfac})}}},48940:(e,t,n)=>{"use strict";n.d(t,{c:()=>WeekdayResourceService});var i=n(36647),o=n(70271),r=n(98764),s=n(59400),a=n(51132),l=n(24398),c=n(57678);let p=class WeekdayStore extends c.D_{constructor(){super((0,a.gB)())}};p=(0,l.Cg)([(0,c.g7)({name:"weekdays"}),(0,l.Sn)("design:paramtypes",[])],p);var d=n(94529),u=n(68559);class WeekdayResourceService extends d.L{requireCollection(){return this.query.selectHasCache().pipe((0,i.n)((e=>e?s.w:this.fetchWeekdays())),(0,i.n)((()=>this.query.selectAll())))}fetchWeekdays(){return this.http.get(this.basePath()).pipe((0,o.T)((e=>(0,a.dW)(e))),(0,r.M)((e=>(0,a.Zv)(this.store,e,"all"))))}createStore(){return new p}basePath(){return this.apiV3Service.days.week.path}static{this.ɵfac=(()=>{let e;return function WeekdayResourceService_Factory(t){return(e||(e=u.xGo(WeekdayResourceService)))(t||WeekdayResourceService)}})()}static{this.ɵprov=u.jDH({token:WeekdayResourceService,factory:WeekdayResourceService.ɵfac})}}},86748:(e,t,n)=>{"use strict";n.d(t,{fE:()=>registerEffectCallbacks,qm:()=>EffectHandler,xP:()=>EffectCallback});n(99585);var i=n(36819),o=n(11249);const r=Symbol("EffectHandlers");function registerEffectCallbacks(e,t){const n=e[r];n&&n.forEach(((n,o)=>{(0,i.cY)(`[${e.constructor.name}] Subscribing to effect ${o}`),e.actions$.ofType(n.action).pipe(t).subscribe((t=>{try{n.callback.call(e,t)}catch(e){console.error(`Error thrown in effect callback ${o}: ${e}`)}}))}))}function EffectHandler(e){return class extends e{constructor(...e){super(...e),this.serviceDestroyed=!1,registerEffectCallbacks(this,(0,o.v)((()=>!this.serviceDestroyed)))}ngOnDestroy(){this.serviceDestroyed=!0,super.ngOnDestroy&&super.ngOnDestroy()}}}function EffectCallback(e){return(t,n,i)=>{const o=t;o[r]||(o[r]=new Map),o[r].set(n,{action:e,callback:i.value})}}},77159:(e,t,n)=>{"use strict";n.d(t,{T:()=>FileLinksResourceService});var i=n(57678),o=n(30501),r=n(14600),s=n(59452),a=n(98764),l=n(36647),c=n(78615),p=n(1365),d=n(76882),u=n(24398),h=n(51132);let m=class FileLinksStore extends i.D_{constructor(){super((0,h.gB)())}};m=(0,u.Cg)([(0,i.g7)({name:"file_links"}),(0,u.Sn)("design:paramtypes",[])],m);var g=n(94529),_=n(12313),f=n(68559);class FileLinksResourceService extends g.L{createStore(){return new m}basePath(){return this.apiV3Service.file_links.path}updateCollectionsForWorkPackage(e){return this.http.get(e).pipe((0,a.M)((t=>(0,h.Zv)(this.store,t,e))),(0,l.n)((e=>(0,r.H)(e._embedded.elements))),(0,c.$)((e=>e._links.storage.href),(e=>e)),(0,p.Z)((e=>{const t={storage:e.key,fileLinks:[]};return e.pipe((0,d.T)(((e,t)=>(e.fileLinks=[...e.fileLinks,t],e)),t))})),(0,a.M)((t=>{const n=(0,_.A)(t.storage),i=`${e}?pageSize=-1&filters=[{"storage":{"operator":"=","values":["${n}"]}}]`,o={_embedded:{elements:t.fileLinks}};(0,h.Zv)(this.store,o,i)})),(0,d.T)(((e,t)=>e.concat(t.fileLinks)),[]))}updateCollection(e){return this.http.get(e).pipe((0,a.M)((t=>(0,h.Zv)(this.store,t,e))))}remove(e,t){if(!t._links.delete)return(0,s.of)();const n=new o.Lr({"Content-Type":"application/json"});return this.http.delete(t._links.delete.href,{withCredentials:!0,headers:n}).pipe((0,a.M)((()=>(0,h.G8)(this.store,t.id,e))))}addFileLinks(e,t,n,o){const r=o.map((e=>({originData:{...e},_links:{storage:n}})));return this.http.post(t,{_type:"Collection",_embedded:{elements:r}}).pipe((0,a.M)((t=>{(0,i.hO)((()=>{const n=t._embedded.elements;this.store.add(n),this.store.update((({collections:t})=>({collections:{...t,[e]:{...t[e],ids:(t[e]?.ids||[]).concat(n.map((e=>e.id)))}}})))}))})))}static{this.ɵfac=(()=>{let e;return function FileLinksResourceService_Factory(t){return(e||(e=f.xGo(FileLinksResourceService)))(t||FileLinksResourceService)}})()}static{this.ɵprov=f.jDH({token:FileLinksResourceService,factory:FileLinksResourceService.ɵfac})}}},15999:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});const i=100},17270:(e,t,n)=>{"use strict";n.d(t,{$s:()=>l,NB:()=>c,Q1:()=>o,Z9:()=>a,jo:()=>s,or:()=>r});var i=n(83755);const o=(0,i.XI)("[IAN] Mark notifications as read",(0,i.xk)()),r=(0,i.XI)("[IAN] Mark notifications as read by filter",(0,i.xk)()),s=(0,i.XI)("[IAN] Notifications were marked as read",(0,i.xk)()),a=(0,i.XI)("[IAN] The backend sent a notification count that was higher than the last known",(0,i.xk)()),l=(0,i.XI)("[IAN] The backend sent a notification count that was different to the last known",(0,i.xk)()),c=(0,i.XI)("[IAN] The notification center updated the notification list without a full page refresh",(0,i.xk)())},21567:(e,t,n)=>{"use strict";n.d(t,{u:()=>m});var i=n(24398),o=n(98764),r=n(17270),s=n(86748),a=n(94564),l=n(57678),c=n(51132);let p=class InAppNotificationsStore extends l.D_{constructor(){super((0,c.gB)())}};p=(0,i.Cg)([(0,l.g7)({name:"in-app-notifications"}),(0,i.Sn)("design:paramtypes",[])],p);var d=n(94529),u=n(1758),h=n(68559);let m=class InAppNotificationsResourceService extends d.L{update(e,t){this.store.update(e,t)}markAsRead(e){return this.apiV3Service.notifications.markAsReadByIds(e).pipe((0,o.M)((()=>{this.store.update(e,{readIAN:!0})})))}markNotificationsAsRead(e){this.markAsRead(e.notifications).subscribe((()=>this.actions$.dispatch((0,r.jo)({...e,all:!1}))))}markNotificationsAsReadByFilters(e){return this.apiV3Service.notifications.markAsReadByFilter(e.filters).subscribe((()=>{this.actions$.dispatch((0,r.jo)({origin:e.origin,notifications:[],all:!0}))}))}createStore(){return new p}basePath(){return this.apiV3Service.notifications.path}static{this.ɵfac=(()=>{let e;return function InAppNotificationsResourceService_Factory(t){return(e||(e=h.xGo(InAppNotificationsResourceService)))(t||InAppNotificationsResourceService)}})()}static{this.ɵprov=h.jDH({token:InAppNotificationsResourceService,factory:InAppNotificationsResourceService.ɵfac})}};(0,i.Cg)([(0,u.O)(),(0,i.Sn)("design:type",a.d)],m.prototype,"actions$",void 0),(0,i.Cg)([(0,s.xP)(r.Q1),(0,i.Sn)("design:type",Function),(0,i.Sn)("design:paramtypes",[void 0]),(0,i.Sn)("design:returntype",void 0)],m.prototype,"markNotificationsAsRead",null),(0,i.Cg)([(0,s.xP)(r.or),(0,i.Sn)("design:type",Function),(0,i.Sn)("design:paramtypes",[void 0]),(0,i.Sn)("design:returntype",void 0)],m.prototype,"markNotificationsAsReadByFilters",null),m=(0,i.Cg)([s.qm],m)},32622:(e,t,n)=>{"use strict";function isDefinedEntity(e){return void 0!==e}n.d(t,{A:()=>isDefinedEntity})},57436:(e,t,n)=>{"use strict";function isNotNull(e){return null!==e}n.d(t,{A:()=>isNotNull})},24443:(e,t,n)=>{"use strict";n.d(t,{V:()=>h});var i=n(24398),o=n(72650),r=n(86748),s=n(94564),a=n(57678),l=n(51132);let c=class PrincipalsStore extends a.D_{constructor(){super((0,l.gB)())}};c=(0,i.Cg)([(0,a.g7)({name:"principals"}),(0,i.Sn)("design:paramtypes",[])],c);var p=n(94529),d=n(1758),u=n(68559);let h=class PrincipalsResourceService extends p.L{createStore(){return new c}basePath(){return this.apiV3Service.principals.path}static{this.ɵfac=(()=>{let e;return function PrincipalsResourceService_Factory(t){return(e||(e=u.xGo(PrincipalsResourceService)))(t||PrincipalsResourceService)}})()}static{this.ɵprov=u.jDH({token:PrincipalsResourceService,factory:PrincipalsResourceService.ɵfac})}};(0,i.Cg)([(0,d.O)(),(0,i.Sn)("design:type",s.d)],h.prototype,"actions$",void 0),(0,i.Cg)([(0,d.O)(),(0,i.Sn)("design:type",o.fw)],h.prototype,"toastService",void 0),h=(0,i.Cg)([r.qm],h)},66042:(e,t,n)=>{"use strict";n.d(t,{z:()=>ProjectStoragesResourceService});var i=n(24398),o=n(57678),r=n(51132);let s=class ProjectStoragesStore extends o.D_{constructor(){super((0,r.gB)())}};s=(0,i.Cg)([(0,o.g7)({name:"project-storages"}),(0,i.Sn)("design:paramtypes",[])],s);var a=n(94529),l=n(68559);class ProjectStoragesResourceService extends a.L{createStore(){return new s}basePath(){return this.apiV3Service.projectStorages.path}static{this.ɵfac=(()=>{let e;return function ProjectStoragesResourceService_Factory(t){return(e||(e=l.xGo(ProjectStoragesResourceService)))(t||ProjectStoragesResourceService)}})()}static{this.ɵprov=l.jDH({token:ProjectStoragesResourceService,factory:ProjectStoragesResourceService.ɵfac})}}},75716:(e,t,n)=>{"use strict";n.d(t,{s:()=>ProjectsResourceService});var i=n(94529),o=n(24398),r=n(57678),s=n(51132);let a=class ProjectsStore extends r.D_{constructor(){super((0,s.gB)())}};a=(0,o.Cg)([(0,r.g7)({name:"projects"}),(0,o.Sn)("design:paramtypes",[])],a);var l=n(68559);class ProjectsResourceService extends i.L{createStore(){return new a}basePath(){return this.apiV3Service.projects.path}static{this.ɵfac=(()=>{let e;return function ProjectsResourceService_Factory(t){return(e||(e=l.xGo(ProjectsResourceService)))(t||ProjectsResourceService)}})()}static{this.ɵprov=l.jDH({token:ProjectsResourceService,factory:ProjectsResourceService.ɵfac})}}},94529:(e,t,n)=>{"use strict";n.d(t,{L:()=>ResourceStoreService});var i=n(57678),o=n(36647),r=n(51567),s=n(70271),a=n(98764),l=n(89475),c=n(61318),p=n(86301),d=n(51132),u=n(46227),h=n(32622),m=n(98435),g=n(14593),_=n(72650),f=n(12313),b=n(68559),k=n(30501);class ResourceStoreService{constructor(e,t,n,o){this.injector=e,this.http=t,this.apiV3Service=n,this.toastService=o,this.store=this.createStore(),this.query=new i.qU(this.store)}requireCollection(e){const t=this.buildResourceLink(e);return this.collectionExists(t)||this.resourceLoading(t)?this.loadedCollection(t):this.fetchCollection(t).pipe((0,o.n)((()=>this.loadedCollection(t))))}requireEntity(e){const t=(0,f.A)(e);return this.query.hasEntity(t)||this.resourceLoading(e)?this.lookup(t):this.fetchEntity(e)}collection(e){const t=this.buildResourceLink(e);return this.collectionState(t).pipe((0,o.n)((e=>this.query.selectMany(e?.ids||[]))))}loadedCollection(e){const t=this.buildResourceLink(e);return this.collectionState(t).pipe((0,r.p)(h.A),(0,o.n)((e=>this.query.selectMany(e.ids))))}collectionState(e){const t=this.buildResourceLink(e);return this.query.select().pipe((0,s.T)((e=>e.collections[t])))}lookup(e){return this.query.selectEntity(e).pipe((0,r.p)(h.A))}lookupMany(e){return this.query.selectMany(e)}exists(e){return this.query.hasEntity(e)}collectionExists(e){const t=this.buildResourceLink(e);return!!this.query.getValue().collections[t]}resourceLoading(e){const t=this.buildResourceLink(e);return!0===this.query.getValue().loadingResources[t]}clear(e){const t=this.buildResourceLink(e);this.store.update((({collections:e})=>({collections:(0,u.omit)(e,t)})))}update(e,t){this.store.update(e,t)}fetchResults(e){return this.fetchCollection(e).pipe((0,s.T)((e=>e._embedded.elements)))}fetchCollection(e,t={handleErrors:!0}){const n=this.buildResourceLink(e);return(0,d.V2)(this.store,n),this.http.get(n).pipe((0,a.M)((e=>(0,d.Zv)(this.store,e,n))),(0,l.j)((()=>(0,d.lB)(this.store,n))),(0,c.W)((e=>{throw t.handleErrors&&this.handleResourceLoadingError(e,n),e})),(0,p.t)(1))}fetchEntity(e,t={handleErrors:!0}){return(0,d.V2)(this.store,e),this.http.get(e).pipe((0,a.M)((e=>this.store.add(e))),(0,l.j)((()=>(0,d.lB)(this.store,e))),(0,c.W)((n=>{throw t.handleErrors&&this.handleResourceLoadingError(n,e),n})),(0,p.t)(1))}buildResourceLink(e){return"string"==typeof e?e:this.basePath()+(0,m.Y)(e)}handleResourceLoadingError(e,t){this.toastService.addError(e)}static{this.ɵfac=function ResourceStoreService_Factory(e){return new(e||ResourceStoreService)(b.KVO(b.zZn),b.KVO(k.Qq),b.KVO(g.n),b.KVO(_.fw))}}static{this.ɵprov=b.jDH({token:ResourceStoreService,factory:ResourceStoreService.ɵfac})}}},51132:(e,t,n)=>{"use strict";n.d(t,{G8:()=>removeEntityFromCollectionAndState,V2:()=>setResourceLoading,Zv:()=>insertCollectionIntoState,dW:()=>extendCollectionElementsWithId,gB:()=>createInitialResourceState,lB:()=>removeResourceLoading,uL:()=>mapHALCollectionToIDCollection});var i=n(57678),o=n(12313),r=n(46227);function mapHALCollectionToIDCollection(e){return{ids:e._embedded.elements.map((e=>e.id))}}function createInitialResourceState(){return{collections:{},loadingResources:{}}}function setResourceLoading(e,t){e.update((({loadingResources:e})=>({loadingResources:{...e,[t]:!0}})))}function removeResourceLoading(e,t){e.update((({loadingResources:e})=>({loadingResources:(0,r.filter)(e,((e,n)=>n!==t))})))}function insertCollectionIntoState(e,t,n){const{elements:o}=t._embedded,r=o?.map((e=>e.id))||[];(0,i.hO)((()=>{o&&o.length>0&&e.upsertMany(o),e.update((({collections:e})=>({collections:{...e,[n]:{ids:r}}})))}))}function removeEntityFromCollectionAndState(e,t,n){(0,i.hO)((()=>{e.remove(t),e.update((({collections:e})=>({collections:{...e,[n]:{...e[n],ids:(e[n]?.ids||[]).filter((e=>e!==t))}}})))}))}function extendCollectionElementsWithId(e){const t=e._embedded.elements.map((e=>({...e,id:(0,o.A)(e._links.self.href)})));return{...e,_embedded:{...e._embedded,elements:t}}}},36023:(e,t,n)=>{"use strict";n.d(t,{u:()=>StorageFilesResourceService});var i=n(19999),o=n(70271),r=n(64334),s=n(98764),a=n(51567),l=n(24398),c=n(57678);let p=class StorageFilesStore extends c.D_{constructor(){super({files:{}})}};p=(0,l.Cg)([(0,c.g7)({name:"storage-files",resettable:!0}),(0,l.Sn)("design:paramtypes",[])],p);var d=n(32622),u=n(14593),h=n(68559),m=n(30501);class StorageFilesResourceService{constructor(e,t){this.httpClient=e,this.apiV3Service=t,this.store=new p,this.query=new c.qU(this.store)}files(e){const t=this.store.getValue().files[e.href];return void 0!==t?(0,i.z)([this.lookupMany(t.files),this.lookup(t.parent),this.lookupMany(t.ancestors)]).pipe((0,o.T)((([t,n,i])=>({files:t,parent:n,ancestors:i,_type:"StorageFiles",_links:{self:e}}))),(0,r.s)(1)):this.httpClient.get(e.href).pipe((0,s.M)((t=>this.insert(t,e.href))))}file(e){return this.httpClient.get(e)}uploadLink(e){return this.httpClient.request(e.method,e.href,{body:e.payload})}createFolder(e,t){return this.httpClient.post(e,t)}reset(){this.store.reset()}lookup(e){return this.query.selectEntity(e).pipe((0,a.p)(d.A))}lookupMany(e){return this.query.selectMany(e)}insert(e,t){this.store.upsertMany([...e.files,e.parent,...e.ancestors]);const n=e.files.map((e=>e.id)),i=e.parent.id,o=e.ancestors.map((e=>e.id));this.store.update((({files:e})=>({files:{...e,[t]:{files:n,parent:i,ancestors:o}}})))}static{this.ɵfac=function StorageFilesResourceService_Factory(e){return new(e||StorageFilesResourceService)(h.KVO(m.Qq),h.KVO(u.n))}}static{this.ɵprov=h.jDH({token:StorageFilesResourceService,factory:StorageFilesResourceService.ɵfac})}}},26109:(e,t,n)=>{"use strict";n.d(t,{m:()=>StoragesResourceService});var i=n(98764),o=n(61873),r=n(24398),s=n(57678),a=n(51132);let l=class StoragesStore extends s.D_{constructor(){super((0,a.gB)())}};l=(0,r.Cg)([(0,s.g7)({name:"storages"}),(0,r.Sn)("design:paramtypes",[])],l);var c=n(94529),p=n(68559);class StoragesResourceService extends c.L{updateCollection(e,t){return(0,o.p)(t.map((e=>this.http.get(e.href)))).pipe((0,i.M)((t=>{const n={_embedded:{elements:t}};(0,a.Zv)(this.store,n,e)})))}createStore(){return new l}basePath(){return this.apiV3Service.storages.path}static{this.ɵfac=(()=>{let e;return function StoragesResourceService_Factory(t){return(e||(e=p.xGo(StoragesResourceService)))(t||StoragesResourceService)}})()}static{this.ɵprov=p.jDH({token:StoragesResourceService,factory:StoragesResourceService.ɵfac})}}},13432:(e,t,n)=>{"use strict";n.d(t,{D:()=>States});var i=n(47418),o=n(84205);class States extends i.Iq{constructor(){super(...arguments),this.name="MainStore",this.projects=(0,i.Iy)(),this.workPackages=(0,i.Iy)(),this.posts=(0,i.Iy)(),this.schemas=(0,i.Iy)(),this.types=(0,i.Iy)(),this.statuses=(0,i.Iy)(),this.timeEntries=(0,i.Iy)(),this.versions=(0,i.Iy)(),this.users=(0,i.Iy)(),this.placeholderUsers=(0,i.Iy)(),this.roles=(0,i.Iy)(),this.changes={queries:new o.B},this.additional={}}forType(e){let t=this[e]||this.additional[e];return t||(t=this.additional[e]=(0,i.Iy)()),t}forResource(e){const t=`${_.camelCase(e._type)}s`,n=this.forType(t);return n&&n.get(e.id)}add(e,t){this.additional[e]=t}}},91066:(e,t,n)=>{"use strict";n.d(t,{V:()=>a,k:()=>TopMenuService});var i=n(64),o=n(60316),r=n(75797),s=n(68559);const a=100;class TopMenuService{constructor(e){this.document=e,this.hover=!1,this.menuIsOpen=!1,this.active$=new r.t(null)}register(){this.menuContainer=this.document.querySelector(".op-app-header"),this.setupDropdownClick(),this.closeOnBodyClick(),this.accessibility(),this.skipContentClickListener()}activeDropdown$(){return this.active$.asObservable()}close(){this.stopHover(),this.closeAllItems(),this.menuIsOpen=!1,this.active$.next(null)}skipContentClickListener(){const e=this.document.querySelector("#skip-navigation--content");e?.addEventListener("click",(()=>{const e=jQuery(".first-breadcrumb-element a, .toolbar-container a:first-of-type, #content a:first-of-type").not(":hidden").first();e.length&&e.trigger("focus")}))}accessibility(){this.document.querySelectorAll(".op-app-menu--dropdown").forEach((e=>e.setAttribute("aria-expanded","false")))}toggleClick(e){this.menuIsOpen?this.isOpen(e)?this.close():this.openDropdown(e):(this.opening(),this.openDropdown(e))}opening(){this.startHover(),this.menuIsOpen=!0}stopHover(){this.hover=!1,this.menuContainer?.classList.remove("hover")}startHover(){this.hover=!0,this.menuContainer?.classList.add("hover")}closeAllItems(){this.openDropdowns().forEach((e=>this.closeDropdown(e)))}closeOnBodyClick(){const e=document.getElementById("wrapper");e&&e.addEventListener("click",(e=>{this.menuIsOpen&&!this.openDropdowns()[0]?.contains(e.target)&&this.close()}),!0)}openDropdowns(){const e=this.menuContainer?.querySelectorAll(".op-app-menu--item_dropdown-open");return e?Array.from(e):[]}dropdowns(){const e=this.menuContainer?.querySelectorAll(".op-app-menu--item_has-dropdown");return e?Array.from(e):[]}setupDropdownClick(){this.dropdowns().forEach((e=>{const t=e.querySelector(".op-app-menu--item-action");t?.addEventListener("click",(t=>{this.toggleClick(e),t.preventDefault()}))}))}isOpen(e){return e.classList.contains(".op-app-menu--item_dropdown-open")}isClosed(e){return!this.isOpen(e)}openDropdown(e){this.closeOtherItems(e),this.slideAndFocus(e,(()=>{this.active$.next(e)}))}closeDropdown(e,t){this.slideUp(e,!!t),this.active$.next(null)}closeOtherItems(e){this.openDropdowns().forEach((t=>{t!==e&&this.closeDropdown(t,!0)}))}slideAndFocus(e,t){this.slideDown(e,t),setTimeout((()=>this.focusFirstInputOrLink(e)),a)}slideDown(e,t){const n=this.getDropdownContainer(e);n.setAttribute("aria-expanded","true"),e.classList.add("op-app-menu--item_dropdown-open"),jQuery(n).slideDown(a,t).attr("aria-expanded","true")}slideUp(e,t){const n=this.getDropdownContainer(e);n.removeAttribute("aria-expanded"),e.classList.remove("op-app-menu--item_dropdown-open"),t?n.style.display="none":jQuery(n).slideUp(a)}focusFirstInputOrLink(e){const t=this.getDropdownContainer(e),n=(0,i.R)(t)[0];n&&(n.blur(),setTimeout((()=>{n.focus()}),10))}getDropdownContainer(e){return e.querySelector(".op-app-menu--dropdown")}static{this.ɵfac=function TopMenuService_Factory(e){return new(e||TopMenuService)(s.KVO(o.qQ))}}static{this.ɵprov=s.jDH({token:TopMenuService,factory:TopMenuService.ɵfac,providedIn:"root"})}}},88535:(e,t,n)=>{"use strict";n.d(t,{W:()=>TurboRequestsService});var i=n(31749),o=n(72650),r=n(68559);class TurboRequestsService{constructor(e){this.toast=e}request(e,t={},n=!1){return fetch(e,t).then((e=>e.text().then((t=>({html:t,headers:e.headers,response:e}))))).then((e=>{if((0,i.aM)(e.html),e.response.ok)return{html:e.html,headers:e.headers};throw new Error(e.response.statusText)})).catch((e=>{throw n?console.error(e):this.toast.addError(e),e}))}requestStream(e){return this.request(e,{method:"GET",headers:{Accept:"text/vnd.turbo-stream.html"},credentials:"same-origin"})}static{this.ɵfac=function TurboRequestsService_Factory(e){return new(e||TurboRequestsService)(r.KVO(o.fw))}}static{this.ɵprov=r.jDH({token:TurboRequestsService,factory:TurboRequestsService.ɵfac,providedIn:"root"})}}},32203:(e,t,n)=>{"use strict";n.d(t,{A:()=>isHttpResponse});var i=n(30501);function isHttpResponse(e){return e.type===i.hv.Response}},39626:(e,t,n)=>{"use strict";n.d(t,{u:()=>OpUploadService});class OpUploadService{}},3901:(e,t,n)=>{"use strict";n.d(t,{A:()=>waitForUploadsFinished});var i=n(61873),o=n(51567),r=n(32203);function waitForUploadsFinished(e){return(0,i.p)(e.map((e=>e.pipe((0,o.p)(r.A)))))}},91468:(e,t,n)=>{"use strict";n.d(t,{X:()=>BcfApiService});var i=n(67704);class BcfResourcePath extends i.B{constructor(e,t,n){super(t,n),this.injector=e,this.id=n}}class BcfResourceCollectionPath extends i.Z{constructor(e,t,n,i){super(t,n,i),this.injector=e,this.basePath=t,this.resource=i}id(e){return new(this.resource||BcfResourcePath)(this.injector,this.path,e)}}var o=n(24398),r=n(30501),s=n(47472),a=n(77919),l=n(70271),c=n(61318),p=n(1758),d=n(50248);class BcfApiRequestService{constructor(e,t){this.injector=e,this.resourceClass=t}get(e,t,n={}){const i={headers:n,params:new r.Nl({encoder:new d.Y,fromObject:t}),withCredentials:!0,responseType:"json"};return this._request("get",e,i)}request(e,t,n={},i={}){if("get"===e)return this.get(t,n,i);const o={body:n||{},headers:i,withCredentials:!0,responseType:"json"};return this._request(e,t,o)}_request(e,t,n){return this.http.request(e,t,n).pipe((0,l.T)((e=>this.deserialize(e))),(0,c.W)((n=>(console.error(`Failed to ${e} ${t}: ${n.name}`),(0,a.$)(n)))))}deserialize(e){if(this.resourceClass){return new s.n1(this.resourceClass).parse(e)}return e}}(0,o.Cg)([(0,p.O)(),(0,o.Sn)("design:type",r.Qq)],BcfApiRequestService.prototype,"http",void 0);var u=n(490),h=n(76847);let m=class BcfProjectResource{};(0,o.Cg)([u.Z,(0,o.Sn)("design:type",Number)],m.prototype,"project_id",void 0),(0,o.Cg)([u.Z,(0,o.Sn)("design:type",String)],m.prototype,"name",void 0),m=(0,o.Cg)([h.o],m);var g=n(36774),_=n(39545);let f=class BcfTopicAuthorizationMap{};(0,o.Cg)([(0,g.e)(String),(0,o.Sn)("design:type",Array)],f.prototype,"topic_actions",void 0),(0,o.Cg)([(0,g.e)(String),(0,o.Sn)("design:type",Array)],f.prototype,"topic_status",void 0),f=(0,o.Cg)([h.o],f);let b=class BcfTopicResource{};(0,o.Cg)([u.Z,(0,o.Sn)("design:type",String)],b.prototype,"guid",void 0),(0,o.Cg)([u.Z,(0,o.Sn)("design:type",String)],b.prototype,"topic_type",void 0),(0,o.Cg)([u.Z,(0,o.Sn)("design:type",String)],b.prototype,"topic_status",void 0),(0,o.Cg)([u.Z,(0,o.Sn)("design:type",String)],b.prototype,"priority",void 0),(0,o.Cg)([(0,g.e)(String),(0,o.Sn)("design:type",Array)],b.prototype,"reference_links",void 0),(0,o.Cg)([u.Z,(0,o.Sn)("design:type",String)],b.prototype,"title",void 0),(0,o.Cg)([(0,u.Z)({preserveNull:!0}),(0,o.Sn)("design:type",Object)],b.prototype,"index",void 0),(0,o.Cg)([(0,g.e)(String),(0,o.Sn)("design:type",Array)],b.prototype,"labels",void 0),(0,o.Cg)([(0,u.Z)({deserializer:e=>_(e),serializer:e=>e.toISOString()}),(0,o.Sn)("design:type",Object)],b.prototype,"creation_date",void 0),(0,o.Cg)([u.Z,(0,o.Sn)("design:type",String)],b.prototype,"creation_author",void 0),(0,o.Cg)([(0,u.Z)({deserializer:e=>_(e),serializer:e=>e.toISOString()}),(0,o.Sn)("design:type",Object)],b.prototype,"modified_date",void 0),(0,o.Cg)([(0,u.Z)({preserveNull:!0}),(0,o.Sn)("design:type",Object)],b.prototype,"modified_author",void 0),(0,o.Cg)([u.Z,(0,o.Sn)("design:type",String)],b.prototype,"assigned_to",void 0),(0,o.Cg)([(0,u.Z)({preserveNull:!0}),(0,o.Sn)("design:type",Object)],b.prototype,"stage",void 0),(0,o.Cg)([u.Z,(0,o.Sn)("design:type",String)],b.prototype,"description",void 0),(0,o.Cg)([(0,u.Z)({deserializer:e=>_(e),serializer:e=>e.format("YYYY-MM-DD")}),(0,o.Sn)("design:type",Object)],b.prototype,"due_date",void 0),(0,o.Cg)([u.Z,(0,o.Sn)("design:type",f)],b.prototype,"authorization",void 0),b=(0,o.Cg)([h.o],b);class BcfViewpointSelectionPath extends BcfResourcePath{constructor(){super(...arguments),this.bcfViewpointsService=new BcfApiRequestService(this.injector)}get(e={},t={}){return this.bcfViewpointsService.get(this.toPath(),e,t)}}class BcfViewpointVisibilityPaths extends BcfResourcePath{constructor(){super(...arguments),this.bcfViewpointsService=new BcfApiRequestService(this.injector)}get(e={},t={}){return this.bcfViewpointsService.get(this.toPath(),e,t)}}class BcfViewpointPaths extends BcfResourcePath{constructor(){super(...arguments),this.bcfViewpointsService=new BcfApiRequestService(this.injector),this.selection=new BcfViewpointSelectionPath(this.injector,this.path,"selection"),this.visibility=new BcfViewpointVisibilityPaths(this.injector,this.path,"visibility")}get(e={},t={}){return this.bcfViewpointsService.get(this.toPath(),e,t)}delete(e={}){return this.bcfViewpointsService.request("delete",this.toPath(),{},e).pipe((0,l.T)((()=>{})))}}class BcfViewpointCollectionPath extends BcfResourceCollectionPath{constructor(){super(...arguments),this.bcfViewpointService=new BcfApiRequestService(this.injector)}post(e){return this.bcfViewpointService.request("post",this.toPath(),e)}}class BcfTopicPaths extends BcfResourcePath{constructor(){super(...arguments),this.bcfTopicService=new BcfApiRequestService(this.injector,b),this.comments=new BcfResourceCollectionPath(this.injector,this.path,"comments"),this.viewpoints=new BcfViewpointCollectionPath(this.injector,this.path,"viewpoints",BcfViewpointPaths)}get(e={},t={}){return this.bcfTopicService.get(this.toPath(),e,t)}}class BcfTopicCollectionPath extends BcfResourceCollectionPath{constructor(e,t,n){super(e,t,n,BcfTopicPaths),this.injector=e,this.basePath=t,this.bcfTopicService=new BcfApiRequestService(this.injector,b)}get(e={},t={}){throw new Error("Not implemented")}post(e){return this.bcfTopicService.request("post",this.toPath(),e)}}let k=class BcfExtensionResource{};(0,o.Cg)([(0,g.e)(String),(0,o.Sn)("design:type",Array)],k.prototype,"topic_actions",void 0),(0,o.Cg)([(0,g.e)(String),(0,o.Sn)("design:type",Array)],k.prototype,"project_actions",void 0),(0,o.Cg)([(0,g.e)(String),(0,o.Sn)("design:type",Array)],k.prototype,"comment_actions",void 0),k=(0,o.Cg)([h.o],k);class BcfExtensionPaths extends BcfResourcePath{constructor(){super(...arguments),this.bcfExtensionService=new BcfApiRequestService(this.injector,k)}get(e={},t={}){return this.bcfExtensionService.get(this.toPath(),e,t)}}class BcfProjectPaths extends BcfResourcePath{constructor(){super(...arguments),this.bcfProjectService=new BcfApiRequestService(this.injector,m),this.topics=new BcfTopicCollectionPath(this.injector,this.path,"topics"),this.extensions=new BcfExtensionPaths(this.injector,this.path,"extensions")}get(e={},t={}){return this.bcfProjectService.get(this.toPath(),e,t)}}var v=n(68559);class BcfApiService{constructor(e){this.injector=e,this.bcfApiVersion="2.1",this.appBasePath=window.appBasePath||"",this.bcfApiBase=`${this.appBasePath}/api/bcf/${this.bcfApiVersion}`,this.projects=new BcfResourceCollectionPath(this.injector,this.bcfApiBase,"projects",BcfProjectPaths)}parse(e){if(!e.startsWith(this.bcfApiBase))throw new Error(`Cannot parse ${e} into BCF resource.`);const t=e.replace(`${this.bcfApiBase}/`,"").split("/");let n=this;for(let e=0;e<t.length;e++){const i=t[e];if(i in n)n=n[i];else{if(!(n instanceof BcfResourceCollectionPath))break;n=n.id(i)}}return n===this?void 0:n}static{this.ɵfac=function BcfApiService_Factory(e){return new(e||BcfApiService)(v.KVO(v.zZn))}}static{this.ɵprov=v.jDH({token:BcfApiService,factory:BcfApiService.ɵfac,providedIn:"root"})}}},29671:(e,t,n)=>{"use strict";n.d(t,{X:()=>ViewerBridgeService});var i=n(24398),o=n(1758),r=n(83093),s=n(68559);class ViewerBridgeService{constructor(e){this.injector=e}static{this.ɵfac=function ViewerBridgeService_Factory(e){return new(e||ViewerBridgeService)(s.KVO(s.zZn))}}static{this.ɵprov=s.jDH({token:ViewerBridgeService,factory:ViewerBridgeService.ɵfac})}}(0,i.Cg)([(0,o.O)(),(0,i.Sn)("design:type",r.dw)],ViewerBridgeService.prototype,"state",void 0)},86973:(e,t,n)=>{"use strict";n.d(t,{I:()=>BcfPathHelperService});var i=n(73014),o=n(68559);class BcfPathHelperService{constructor(e){this.pathHelper=e}projectImportIssuePath(e){return`${this.pathHelper.projectPath(e)}/issues/upload`}projectExportIssuesPath(e,t){return t?`${this.pathHelper.projectPath(e)}/work_packages.bcf?filters=${t}`:`${this.pathHelper.projectPath(e)}/work_packages.bcf`}snapshotPath(e){return`${e.href}/snapshot`}static{this.ɵfac=function BcfPathHelperService_Factory(e){return new(e||BcfPathHelperService)(o.KVO(i.B))}}static{this.ɵprov=o.jDH({token:BcfPathHelperService,factory:BcfPathHelperService.ɵfac})}}},12165:(e,t,n)=>{"use strict";n.d(t,{o:()=>ViewpointsService});var i=n(24398),o=n(1758),r=n(91468),s=n(29671),a=n(70271),l=n(98764),c=n(36647),p=n(61873),d=n(59452),u=n(14593),h=n(12313),m=n(68559);class ViewpointsService{constructor(e){this.injector=e,this.topicUUID=null}getViewPointResource(e,t){const n=e.bcfViewpoints[t].href;return this.bcfApi.parse(n)}getViewPoint$(e,t){const n=this.getViewPointResource(e,t);return(0,p.p)({viewpoint:n.get(),selection:n.selection.get(),visibility:n.visibility.get()}).pipe((0,a.T)((({viewpoint:e,selection:t,visibility:n})=>{const i=e;return i.components={coloring:[],selection:t.selection,visibility:n.visibility},i})))}deleteViewPoint$(e,t){return this.getViewPointResource(e,t).delete().pipe((0,l.M)((()=>this.apiV3Service.work_packages.id(e).requireAndStream(!0))))}saveViewpoint$(e,t){const n=e.project.href,i=(0,h.A)(n),o=this.setBcfTopic$(e),r=t?(0,d.of)(t):this.viewerBridge.getViewpoint$();return(0,p.p)({topicUUID:o,viewpoint:r}).pipe((0,c.n)((e=>this.bcfApi.projects.id(i).topics.id(e.topicUUID).viewpoints.post(e.viewpoint))),(0,l.M)((()=>this.apiV3Service.work_packages.id(e).requireAndStream(!0))))}resetBcfTopic(){this.topicUUID=null}setBcfTopic$(e){if(null!==this.topicUUID)return(0,d.of)(this.topicUUID);const t=e.bcfTopic?.href;return(t?(0,d.of)(this.bcfApi.parse(t).id):this.createBcfTopic$(e)).pipe((0,a.T)((e=>(this.topicUUID=e,this.topicUUID))))}createBcfTopic$(e){const t=(0,h.A)(e.project.href),n=e.convertBCF.payload;return this.bcfApi.projects.id(t).topics.post(n).pipe((0,a.T)((e=>(this.topicUUID=e.guid,this.topicUUID))))}static{this.ɵfac=function ViewpointsService_Factory(e){return new(e||ViewpointsService)(m.KVO(m.zZn))}}static{this.ɵprov=m.jDH({token:ViewpointsService,factory:ViewpointsService.ɵfac})}}(0,i.Cg)([(0,o.O)(),(0,i.Sn)("design:type",r.X)],ViewpointsService.prototype,"bcfApi",void 0),(0,i.Cg)([(0,o.O)(),(0,i.Sn)("design:type",s.X)],ViewpointsService.prototype,"viewerBridge",void 0),(0,i.Cg)([(0,o.O)(),(0,i.Sn)("design:type",u.n)],ViewpointsService.prototype,"apiV3Service",void 0)},39739:(e,t,n)=>{"use strict";n.d(t,{r:()=>OpenprojectBcfModule});var i=n(68559),o=n(34802),r=n(88707),s=n(39356),a=n(24398),l=n(11621),c=n(1758),p=n(86973);class BcfThumbnailDisplayField extends l.p{render(e,t){const n=this.resource.bcfViewpoints;if(n&&n.length>0){const t=n[0];e.innerHTML=`\n        <img src="${this.bcfPathHelper.snapshotPath(t)}" class="thumbnail">\n      `}else e.innerHTML=""}}(0,a.Cg)([(0,c.O)(),(0,a.Sn)("design:type",p.I)],BcfThumbnailDisplayField.prototype,"bcfPathHelper",void 0);var d=n(60316);class BcfDetectorService{constructor(e){this.documentElement=e}get isBcfActivated(){return this.hasBodyClass("bcf-activated")}hasBodyClass(e){return this.documentElement.body.classList.contains(e)}static{this.ɵfac=function BcfDetectorService_Factory(e){return new(e||BcfDetectorService)(i.KVO(d.qQ))}}static{this.ɵprov=i.jDH({token:BcfDetectorService,factory:BcfDetectorService.ɵfac})}}var u=n(12165),h=n(38087),m=n(36278),g=n(28009),_=n(29671),f=n(65046),b=n(89204),k=n(83093),v=(n(68643),n(12313)),C=n(61816),y=n(99496),w=n(72650),T=n(68267),S=n(47418),j=n(91468),P=n(56196),I=n(70271);class BcfAuthorizationService{constructor(e){this.bcfApi=e,this.authorizationMap=(0,S.Iy)()}authorized$(e,t,n){const i=this.authorizationMap.get(e);return i.putFromPromiseIfPristine((()=>(0,P._)(this.bcfApi.projects.id(e).extensions.get()))),i.values$().pipe((0,I.T)((e=>e[t]&&e[t].includes(n))))}isAllowedTo(e,t,n){return(0,P._)(this.authorized$(e,t,n)).catch((()=>!1))}static{this.ɵfac=function BcfAuthorizationService_Factory(e){return new(e||BcfAuthorizationService)(i.KVO(j.X))}}static{this.ɵprov=i.jDH({token:BcfAuthorizationService,factory:BcfAuthorizationService.ɵfac,providedIn:"root"})}}var x=n(14593),R=n(74565),F=n(51567),M=n(64334),O=n(46765);function BcfWpAttributeGroupComponent_ng_container_0_div_5_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",7)(1,"ngx-gallery",8),i.bIt("change",(function BcfWpAttributeGroupComponent_ng_container_0_div_5_Template_ngx_gallery_change_1_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.onGalleryChanged(t))}))("imagesReady",(function BcfWpAttributeGroupComponent_ng_container_0_div_5_Template_ngx_gallery_imagesReady_1_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.selectViewpointInGallery())}))("previewOpen",(function BcfWpAttributeGroupComponent_ng_container_0_div_5_Template_ngx_gallery_previewOpen_1_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.galleryPreviewOpen())}))("previewClose",(function BcfWpAttributeGroupComponent_ng_container_0_div_5_Template_ngx_gallery_previewClose_1_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.galleryPreviewClose())})),i.k0s()()}if(2&e){const e=i.XpG(2);i.R7$(),i.Y8G("options",e.galleryOptions)("images",e.galleryImages)}}function BcfWpAttributeGroupComponent_ng_container_0_a_6_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"a",9),i.bIt("click",(function BcfWpAttributeGroupComponent_ng_container_0_a_6_Template_a_click_0_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.saveViewpoint(t.workPackage))})),i.nrm(1,"op-icon",10),i.j41(2,"span",11),i.EFF(3),i.k0s()()}if(2&e){const e=i.XpG(2);i.Y8G("title",e.text.add_viewpoint),i.R7$(3),i.SpI(" ",e.text.viewpoint," ")}}function BcfWpAttributeGroupComponent_ng_container_0_Template(e,t){if(1&e&&(i.qex(0),i.j41(1,"div",1)(2,"div",2)(3,"div",3),i.nrm(4,"h3",4),i.k0s()(),i.DNE(5,BcfWpAttributeGroupComponent_ng_container_0_div_5_Template,2,2,"div",5)(6,BcfWpAttributeGroupComponent_ng_container_0_a_6_Template,4,2,"a",6),i.k0s(),i.bVm()),2&e){const e=i.XpG();i.R7$(4),i.Y8G("textContent",e.text.bcf),i.R7$(),i.Y8G("ngIf",e.galleryImages.length>0),i.R7$(),i.Y8G("ngIf",e.viewerVisible&&e.createAllowed)}}class BcfWpAttributeGroupComponent extends y.p{constructor(e,t,n,i,o,r,s,a,l,c){super(),this.state=e,this.bcfAuthorization=t,this.viewerBridge=n,this.apiV3Service=i,this.wpCreate=o,this.toastService=r,this.bcfViewer=s,this.cdRef=a,this.I18n=l,this.viewpointsService=c,this.text={bcf:this.I18n.t("js.bcf.label_bcf"),viewpoint:this.I18n.t("js.bcf.viewpoint"),add_viewpoint:this.I18n.t("js.bcf.add_viewpoint"),show_viewpoint:this.I18n.t("js.bcf.show_viewpoint"),delete_viewpoint:this.I18n.t("js.bcf.delete_viewpoint"),text_are_you_sure:this.I18n.t("js.text_are_you_sure"),notice_successful_create:this.I18n.t("js.notice_successful_create"),notice_successful_delete:this.I18n.t("js.notice_successful_delete")},this.galleryOptions=[{width:"100%",height:"400px",startIndex:0,image:!1,thumbnailsColumns:1,thumbnailsAutoHide:!1,thumbnailSize:"contain",imageAnimation:"",previewAnimation:!1,previewCloseOnEsc:!0,previewKeyboardNavigation:!0,imageSize:"contain",imageArrowsAutoHide:!0,thumbnailsMargin:5,thumbnailMargin:5,previewDownload:!0,previewCloseOnClick:!0,arrowPrevIcon:"icon-arrow-left2",arrowNextIcon:"icon-arrow-right2",closeIcon:"icon-close",downloadIcon:"icon-download",thumbnailActions:this.actions(),actions:this.actions()},{breakpoint:800,width:"100%",height:"400px",imagePercent:80,thumbnailsPercent:20,thumbnailsMargin:5,thumbnailMargin:5},{breakpoint:680,height:"200px",thumbnailsColumns:3,thumbnailsMargin:5,thumbnailMargin:5}],this.viewpoints=[],this.galleryImages=[],this.viewAllowed=!1,this.createAllowed=!1,this.viewerVisible=!1}ngAfterViewInit(){this.observeChanges()}ngOnInit(){this.viewerBridge.viewerVisible$.subscribe((e=>{this.viewerVisible=!!e,this.cdRef.detectChanges()}))}observeChanges(){var e=this;this.apiV3Service.work_packages.id(this.workPackage).requireAndStream().pipe(this.untilDestroyed()).subscribe(function(){var t=(0,b.A)((function*(t){e.workPackage=t,e.projectId||(yield e.initialize(e.workPackage)),t.bcfViewpoints&&e.refreshViewpoints(t.bcfViewpoints)}));return function(e){return t.apply(this,arguments)}}())}initialize(e){var t=this;return(0,b.A)((function*(){t.projectId=(0,v.A)(e.project.href),t.viewAllowed=yield t.bcfAuthorization.isAllowedTo(t.projectId,"project_actions","viewTopic"),t.createAllowed=yield t.bcfAuthorization.isAllowedTo(t.projectId,"topic_actions","createViewpoint"),t.loadViewpointFromRoute(e),t.cdRef.detectChanges()}))()}refreshViewpoints(e){this.viewpoints=e.map((e=>({href:e.href,snapshotURL:`${e.href}/snapshot`}))),this.setViewpointsOnGallery(this.viewpoints)}showViewpoint(e,t){if(this.bcfViewer&&this.viewerBridge.shouldShowViewer){switch(this.bcfViewer.currentViewerState()){case"table":this.bcfViewer.update("splitTable");break;case"cards":this.bcfViewer.update("splitCards")}this.viewerBridge.viewerVisible$.pipe((0,F.p)((e=>e)),(0,M.s)(1)).subscribe((()=>this.viewerBridge.showViewpoint(e,t)))}else this.viewerBridge.showViewpoint(e,t)}deleteViewpoint(e,t){window.confirm(this.text.text_are_you_sure)&&this.viewpointsService.deleteViewPoint$(e,t).subscribe((()=>{this.toastService.addSuccess(this.text.notice_successful_delete),this.gallery.preview.close()}))}saveViewpoint(e){this.viewpointsService.saveViewpoint$(e).subscribe((()=>{this.toastService.addSuccess(this.text.notice_successful_create),this.showIndex=this.viewpoints.length}))}loadViewpointFromRoute(e){if("number"==typeof this.state.params.viewpoint){const t=this.state.params.viewpoint;this.showViewpoint(e,t),this.showIndex=t,this.selectViewpointInGallery(),this.state.go(".",{...this.state.params,viewpoint:void 0},{reload:!1})}}shouldShowGroup(){return this.viewAllowed&&(this.viewpoints.length>0||this.createAllowed&&this.viewerVisible)}actions(){return[{icon:"icon-view-model",onClick:(e,t)=>{this.showViewpoint(this.workPackage,t),this.gallery.preview.close()},titleText:this.text.show_viewpoint},{icon:"icon-delete",onClick:(e,t)=>this.deleteViewpoint(this.workPackage,t),titleText:this.text.delete_viewpoint}]}galleryPreviewOpen(){jQuery(".op-app-header").addClass("-no-z-index")}galleryPreviewClose(){jQuery(".op-app-header").removeClass("-no-z-index")}selectViewpointInGallery(){setTimeout((()=>this.gallery?.show(this.showIndex)),250)}onGalleryChanged(e){this.showIndex=e.index}set showIndex(e){const t=[...this.galleryOptions];t[0].startIndex=e,this.galleryOptions=t}get showIndex(){return this.galleryOptions[0].startIndex}setViewpointsOnGallery(e){const{length:t}=e;this.setThumbnailProperties(t),this.showIndex<0||t<1?this.showIndex=0:this.showIndex>=t&&(this.showIndex=t-1),this.galleryImages=e.map((e=>({small:e.snapshotURL,medium:e.snapshotURL,big:e.snapshotURL}))),this.cdRef.detectChanges()}setThumbnailProperties(e){const t=[...this.galleryOptions];t[0].thumbnailsColumns=e<5?e:4,t[1].thumbnailsColumns=e<5?e:4,t[2].thumbnailsColumns=e<4?e:3,t[0].height=`${this.dynamicThumbnailHeight(e)}px`,t[1].height=`${this.dynamicThumbnailHeight(e)}px`,t[2].height=`${this.dynamicThumbnailHeight(e)}px`,this.galleryOptions=t}dynamicThumbnailHeight(e){return Math.max(Math.round(300/e),120)}static{this.ɵfac=function BcfWpAttributeGroupComponent_Factory(e){return new(e||BcfWpAttributeGroupComponent)(i.rXU(k.dw),i.rXU(BcfAuthorizationService),i.rXU(_.X),i.rXU(x.n),i.rXU(T.d),i.rXU(w.fw),i.rXU(R.Ih,8),i.rXU(i.gRc),i.rXU(C.W),i.rXU(u.o))}}static{this.ɵcmp=i.VBU({type:BcfWpAttributeGroupComponent,selectors:[["ng-component"]],viewQuery:function BcfWpAttributeGroupComponent_Query(e,t){if(1&e&&i.GBs(r.Fv,5),2&e){let e;i.mGM(e=i.lsd())&&(t.gallery=e.first)}},inputs:{workPackage:"workPackage"},features:[i.Jv_([u.o]),i.Vt3],decls:1,vars:1,consts:[[4,"ngIf"],[1,"attributes-group","description-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],["class","bcf--viewpoints",4,"ngIf"],["class","button",3,"title","click",4,"ngIf"],[1,"bcf--viewpoints"],[3,"change","imagesReady","previewOpen","previewClose","options","images"],[1,"button",3,"click","title"],["icon-classes","button--icon icon-add"],[1,"button--text"]],template:function BcfWpAttributeGroupComponent_Template(e,t){1&e&&i.DNE(0,BcfWpAttributeGroupComponent_ng_container_0_Template,7,3,"ng-container",0),2&e&&i.Y8G("ngIf",t.shouldShowGroup())},dependencies:[d.bT,O.i,r.Fv],styles:[".bcf--viewpoints[_ngcontent-%COMP%]{clear:both}ngx-gallery[_ngcontent-%COMP%]{display:inline-block}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-thumbnails .ngx-gallery-arrow{color:var(--accent-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-arrow.ngx-gallery-disabled{display:none}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper{background:#ffffff80;padding:5px}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper .ngx-gallery-icon{margin-top:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper ngx-gallery-action:last-of-type .ngx-gallery-icon{margin-right:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail.ngx-gallery-clickable .ngx-gallery-icon{font-size:1.25rem;color:var(--accent-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-active, ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{border:1px solid var(--borderColor-default)!important}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-preview-img{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview{background:#000c!important}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview a:hover{color:#fff}"],changeDetection:0})}}var D=n(36647),G=n(61873),E=n(97366);function BcfNewWpAttributeGroupComponent_ng_container_0_div_5_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",7)(1,"ngx-gallery",8),i.bIt("change",(function BcfNewWpAttributeGroupComponent_ng_container_0_div_5_Template_ngx_gallery_change_1_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.onGalleryChanged(t))}))("imagesReady",(function BcfNewWpAttributeGroupComponent_ng_container_0_div_5_Template_ngx_gallery_imagesReady_1_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.selectViewpointInGallery())}))("previewOpen",(function BcfNewWpAttributeGroupComponent_ng_container_0_div_5_Template_ngx_gallery_previewOpen_1_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.galleryPreviewOpen())}))("previewClose",(function BcfNewWpAttributeGroupComponent_ng_container_0_div_5_Template_ngx_gallery_previewClose_1_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.galleryPreviewClose())})),i.k0s()()}if(2&e){const e=i.XpG(2);i.R7$(),i.Y8G("options",e.galleryOptions)("images",e.galleryImages)}}function BcfNewWpAttributeGroupComponent_ng_container_0_a_6_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"a",9),i.bIt("click",(function BcfNewWpAttributeGroupComponent_ng_container_0_a_6_Template_a_click_0_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.saveViewpoint(t.workPackage))})),i.nrm(1,"op-icon",10),i.j41(2,"span",11),i.EFF(3),i.k0s()()}if(2&e){const e=i.XpG(2);i.Y8G("title",e.text.add_viewpoint),i.R7$(3),i.SpI(" ",e.text.viewpoint," ")}}function BcfNewWpAttributeGroupComponent_ng_container_0_Template(e,t){if(1&e&&(i.qex(0),i.j41(1,"div",1)(2,"div",2)(3,"div",3),i.nrm(4,"h3",4),i.k0s()(),i.DNE(5,BcfNewWpAttributeGroupComponent_ng_container_0_div_5_Template,2,2,"div",5)(6,BcfNewWpAttributeGroupComponent_ng_container_0_a_6_Template,4,2,"a",6),i.k0s(),i.bVm()),2&e){const e=i.XpG();i.R7$(4),i.Y8G("textContent",e.text.bcf),i.R7$(),i.Y8G("ngIf",e.galleryImages.length>0),i.R7$(),i.Y8G("ngIf",e.viewerVisible&&e.createAllowed)}}class BcfNewWpAttributeGroupComponent extends BcfWpAttributeGroupComponent{constructor(){super(...arguments),this.galleryViewpoints=[]}ngAfterViewInit(){this.viewerVisible&&(super.ngAfterViewInit(),(0,E.A)(this.workPackage)&&this.observeCreation())}observeCreation(){this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed(),(0,M.s)(1),(0,D.n)((e=>this.viewpointsService.setBcfTopic$(e)),(e=>e)),(0,D.n)((e=>{this.workPackage=e;const t=this.galleryViewpoints.filter((e=>!e.href&&e.viewpoint)).map((e=>this.viewpointsService.saveViewpoint$(this.workPackage,e.viewpoint)));return(0,G.p)(t)}))).subscribe((()=>{this.viewpointsService.resetBcfTopic(),this.showIndex=this.galleryViewpoints.length-1}))}showViewpoint(e,t){}deleteViewpoint(e,t){this.galleryViewpoints=this.galleryViewpoints.filter(((e,n)=>n!==t)),this.setViewpointsOnGallery(this.galleryViewpoints)}saveViewpoint(){this.viewerBridge.getViewpoint$().subscribe((e=>{const t={snapshotURL:e.snapshot.snapshot_data,viewpoint:e};this.galleryViewpoints=[...this.galleryViewpoints,t],this.setViewpointsOnGallery(this.galleryViewpoints),this.showIndex=this.galleryViewpoints.length-1,this.selectViewpointInGallery()}))}shouldShowGroup(){return this.createAllowed&&this.viewerVisible}actions(){return super.actions().filter((e=>"icon-delete"===e.icon))}static{this.ɵfac=(()=>{let e;return function BcfNewWpAttributeGroupComponent_Factory(t){return(e||(e=i.xGo(BcfNewWpAttributeGroupComponent)))(t||BcfNewWpAttributeGroupComponent)}})()}static{this.ɵcmp=i.VBU({type:BcfNewWpAttributeGroupComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:1,vars:1,consts:[[4,"ngIf"],[1,"attributes-group","description-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],["class","bcf--viewpoints",4,"ngIf"],["class","button",3,"title","click",4,"ngIf"],[1,"bcf--viewpoints"],[3,"change","imagesReady","previewOpen","previewClose","options","images"],[1,"button",3,"click","title"],["icon-classes","button--icon icon-add"],[1,"button--text"]],template:function BcfNewWpAttributeGroupComponent_Template(e,t){1&e&&i.DNE(0,BcfNewWpAttributeGroupComponent_ng_container_0_Template,7,3,"ng-container",0),2&e&&i.Y8G("ngIf",t.shouldShowGroup())},dependencies:[d.bT,O.i,r.Fv],styles:[".bcf--viewpoints[_ngcontent-%COMP%]{clear:both}ngx-gallery[_ngcontent-%COMP%]{display:inline-block}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-thumbnails .ngx-gallery-arrow{color:var(--accent-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-arrow.ngx-gallery-disabled{display:none}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper{background:#ffffff80;padding:5px}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper .ngx-gallery-icon{margin-top:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper ngx-gallery-action:last-of-type .ngx-gallery-icon{margin-right:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail.ngx-gallery-clickable .ngx-gallery-icon{font-size:1.25rem;color:var(--accent-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-active, ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{border:1px solid var(--borderColor-default)!important}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-preview-img{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview{background:#000c!important}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview a:hover{color:#fff}"],changeDetection:0})}}var A=n(75797),V=n(84205),$=n(91817),B=n(32037);class RevitBridgeService extends _.X{constructor(e){super(e),this.injector=e,this.shouldShowViewer=!1,this.viewerVisible$=new A.t(!1),this.revitMessageReceivedSource=new V.B,this.trackingIdNumber=0,this.revitMessageReceived$=this.revitMessageReceivedSource.asObservable(),window.RevitBridge?this.hookUpRevitListener():window.addEventListener("revit.plugin.ready",(()=>{this.hookUpRevitListener()}),{once:!0})}viewerVisible(){return this.viewerVisible$.getValue()}getViewpoint$(){const e=this.newTrackingId();return this.sendMessageToRevit("ViewpointGenerationRequest",e,""),this.revitMessageReceived$.pipe((0,$.F)(),(0,F.p)((t=>"ViewpointData"===t.messageType&&t.trackingId===e)),(0,B.$)(),(0,I.T)((e=>{const t=e.messagePayload;return t.snapshot.hasOwnProperty("snapshot_type")&&t.snapshot.hasOwnProperty("snapshot_data")||(t.snapshot={snapshot_type:"png",snapshot_data:t.snapshot}),t})))}showViewpoint(e,t){this.viewpointsService.getViewPoint$(e,t).subscribe((e=>this.sendMessageToRevit("ShowViewpoint",this.newTrackingId(),JSON.stringify(e))))}sendMessageToRevit(e,t,n){this.viewerVisible()&&window.RevitBridge.sendMessageToRevit(e,t,n)}hookUpRevitListener(){window.RevitBridge.sendMessageToOpenProject=e=>{const{messageType:t,trackingId:n,messagePayload:i}=JSON.parse(e);this.revitMessageReceivedSource.next({messageType:t,trackingId:n,messagePayload:JSON.parse(i)})},this.viewerVisible$.next(!0)}newTrackingId(){return this.trackingIdNumber+=1,String(this.trackingIdNumber)}static{this.ɵfac=function RevitBridgeService_Factory(e){return new(e||RevitBridgeService)(i.KVO(i.zZn))}}static{this.ɵprov=i.jDH({token:RevitBridgeService,factory:RevitBridgeService.ɵfac})}}(0,a.Cg)([(0,c.O)(),(0,a.Sn)("design:type",u.o)],RevitBridgeService.prototype,"viewpointsService",void 0);var W=n(59833);const viewerBridgeServiceFactory=e=>window.navigator.userAgent.search("Revit")>-1?new RevitBridgeService(e):e.get(g.q,new g.q(e));class OpenprojectBcfModule{static{this.bootstrapCalled=!1}constructor(e){OpenprojectBcfModule.bootstrap(e)}static bootstrap(e){if(this.bootstrapCalled)return;this.bootstrapCalled=!0;e.get(s.w).addFieldType(BcfThumbnailDisplayField,"bcfThumbnail",["BCF Thumbnail"]);e.get(f.R).register("prependedAttributeGroups",(e=>{if(window.OpenProject.isBimEdition)return(0,E.A)(e)?BcfNewWpAttributeGroupComponent:BcfWpAttributeGroupComponent}))}static{this.ɵfac=function OpenprojectBcfModule_Factory(e){return new(e||OpenprojectBcfModule)(i.KVO(i.zZn))}}static{this.ɵmod=i.$C({type:OpenprojectBcfModule})}static{this.ɵinj=i.G2t({providers:[{provide:_.X,useFactory:viewerBridgeServiceFactory,deps:[i.zZn]},BcfDetectorService,p.I,u.o],imports:[o.d,r.cz]})}}("undefined"==typeof ngJitMode||ngJitMode)&&i.Obh(OpenprojectBcfModule,{declarations:[BcfWpAttributeGroupComponent,BcfNewWpAttributeGroupComponent,h.O,m.h,W.H],imports:[o.d,r.cz],exports:[h.O,m.h,W.H]})},28009:(e,t,n)=>{"use strict";n.d(t,{q:()=>IFCViewerService});var i=n(24398),o=n(50284);class XeokitServer{constructor(e){this.pathHelper=e,this.ifcModels=window.gon.ifc_models}getProjects(e,t){e({projects:this.ifcModels.projects})}getProject(e,t,n){const i=this.ifcModels.projects.find((t=>t.id===e));if(void 0===i)throw new Error(`unknown project id '${e}'`);t({id:i.id,name:i.name,models:this.ifcModels.models,viewerContent:{modelsLoaded:this.ifcModels.shown_models},viewerConfigs:{}})}getGeometry(e,t,n,i){const r=this.ifcModels.xkt_attachment_ids[t];console.log(`Loading model geometry for: ${r}`),o.WpD.loadArraybuffer(this.pathHelper.attachmentContentPath(r),n,i)}}var r=n(29671),s=n(75797),a=n(59452),l=n(73014),c=n(91468),p=n(1758),d=n(12165),u=n(86866),h=n(30501),m=n(80739),g=n(12313),_=n(68559);class IFCViewerService extends r.X{constructor(e){super(e),this.injector=e,this.shouldShowViewer=!0,this.viewerVisible$=new s.t(!1),this.inspectorVisible$=new s.t(!1)}newViewer(e,t){const n=new XeokitServer(this.pathHelper),i=new m.ho(n,e);i.on("modelLoaded",(()=>this.viewerVisible$.next(!0))),i.loadProject(t[0].id),i.on("addModel",(()=>{window.location.href=this.pathHelper.ifcModelsNewPath(this.currentProjectService.identifier)})),i.on("openInspector",(()=>{this.inspectorVisible$.next(!0)})),i.on("editModel",(e=>{window.location.href=this.pathHelper.ifcModelsEditPath(this.currentProjectService.identifier,e.modelId)})),i.on("deleteModel",(e=>{const t=new FormData;t.append("authenticity_token",jQuery("meta[name=csrf-token]").attr("content")),t.append("_method","delete"),this.httpClient.post(this.pathHelper.ifcModelsDeletePath(this.currentProjectService.identifier,e.modelId),t).subscribe().add((()=>{window.location.reload()}))})),this.viewer=i}destroy(){this.viewerVisible$.next(!1),this.viewer&&(this.viewer.destroy(),this.viewer=void 0)}get viewer(){return this.xeokitViewer}set viewer(e){this.xeokitViewer=e}setKeyboardEnabled(e){this.viewer?.setKeyboardEnabled(e)}getViewpoint$(){if(!this.viewer)return(0,a.of)();const e=this.viewer.saveBCFViewpoint({spacesVisible:!0,reverseClippingPlanes:!0}),t={bitmaps:null,clipping_planes:e.clipping_planes,index:e.index,guid:e.guid,components:{selection:e.components.selection,coloring:e.components.coloring,visibility:{default_visibility:e.components.visibility.default_visibility,exceptions:e.components.visibility.exceptions,view_setup_hints:{openings_visible:e.components.visibility.view_setup_hints?.openings_visible||!1,space_boundaries_visible:e.components.visibility.view_setup_hints?.space_boundaries_visible||!1,spaces_visible:e.components.visibility.view_setup_hints?.spaces_visible||!1}}},lines:e.lines,orthogonal_camera:e.orthogonal_camera,perspective_camera:e.perspective_camera,snapshot:e.snapshot};return(0,a.of)(t)}showViewpoint(e,t){if(this.viewerVisible()){const n={updateCompositeObjects:!0,reverseClippingPlanes:!0};this.viewpointsService.getViewPoint$(e,t).subscribe((e=>{this.viewer?.loadBCFViewpoint(e,n)}))}else window.location.href=this.pathHelper.bimDetailsPath((0,g.A)(e.project.href),e.id||"",t)}viewerVisible(){return!!this.viewer}static{this.ɵfac=function IFCViewerService_Factory(e){return new(e||IFCViewerService)(_.KVO(_.zZn))}}static{this.ɵprov=_.jDH({token:IFCViewerService,factory:IFCViewerService.ɵfac})}}(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",l.B)],IFCViewerService.prototype,"pathHelper",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",c.X)],IFCViewerService.prototype,"bcfApi",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",d.o)],IFCViewerService.prototype,"viewpointsService",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",u.c)],IFCViewerService.prototype,"currentProjectService",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",h.Qq)],IFCViewerService.prototype,"httpClient",void 0)},74565:(e,t,n)=>{"use strict";n.d(t,{HL:()=>l,Ih:()=>BcfViewService,Nr:()=>d,k$:()=>c,kw:()=>u,qU:()=>p});var i=n(61816),o=n(10548),r=n(11048),s=n(29671),a=n(68559);const l="cards",c="viewer",p="splitTable",d="splitCards",u="table";class BcfViewService extends o.O{constructor(e,t,n){super(n),this.I18n=e,this.viewerBridgeService=t,this.querySpace=n,this.text={cards:this.I18n.t("js.views.card"),viewer:this.I18n.t("js.ifc_models.views.viewer"),splitTable:this.I18n.t("js.ifc_models.views.split"),splitCards:this.I18n.t("js.ifc_models.views.split_cards"),table:this.I18n.t("js.views.list")},this.icon={cards:"icon-view-card",viewer:"icon-view-model",splitTable:"icon-view-split-viewer-table",splitCards:"icon-view-split2",table:"icon-view-list"}}hasChanged(e){return this.current!==e.displayRepresentation}applyToQuery(e){return e.displayRepresentation=this.current,!0}valueFromQuery(e){const t=e.displayRepresentation;switch(t){case"splitCards":case"splitTable":case"cards":case"table":case"viewer":return t;default:return this.viewerBridgeService.shouldShowViewer?"splitCards":"cards"}}currentViewerState(){return this.current}static{this.ɵfac=function BcfViewService_Factory(e){return new(e||BcfViewService)(a.KVO(i.W),a.KVO(s.X),a.KVO(r.i))}}static{this.ɵprov=a.jDH({token:BcfViewService,factory:BcfViewService.ɵfac})}}},36278:(e,t,n)=>{"use strict";n.d(t,{h:()=>BcfExportButtonComponent});var i=n(61816),o=n(86866),r=n(86973),s=n(11048),a=n(85247),l=n(83093),c=n(99496),p=n(72650),d=n(56008),u=n(68559),h=n(30501),m=n(46765);class BcfExportButtonComponent extends c.p{constructor(e,t,n,i,o,r,s,a,l,c){super(),this.I18n=e,this.currentProject=t,this.bcfPathHelper=n,this.querySpace=i,this.queryUrlParamsHelper=o,this.jobStatusModalService=r,this.httpClient=s,this.injector=a,this.toastService=l,this.state=c,this.text={export:this.I18n.t("js.bcf.export"),export_hover:this.I18n.t("js.bcf.export_bcf_xml_file")}}ngOnInit(){this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe((e=>{this.query=e;const t=this.currentProject.identifier,n=this.queryUrlParamsHelper.buildV3GetFilters(this.query.filters);this.exportLink=this.bcfPathHelper.projectExportIssuesPath(t,JSON.stringify(n))}))}showDelayedExport(e){this.requestExport(this.exportLink),e.preventDefault()}requestExport(e){this.httpClient.get(e,{observe:"body",responseType:"json"}).subscribe((e=>this.jobStatusModalService.show(e.job_id)),(e=>this.handleError(e)))}handleError(e){this.toastService.addError(e.message||this.I18n.t("js.error.internal"))}static{this.ɵfac=function BcfExportButtonComponent_Factory(e){return new(e||BcfExportButtonComponent)(u.rXU(i.W),u.rXU(o.c),u.rXU(r.I),u.rXU(s.i),u.rXU(a.j),u.rXU(d._),u.rXU(h.Qq),u.rXU(u.zZn),u.rXU(p.fw),u.rXU(l.dw))}}static{this.ɵcmp=u.VBU({type:BcfExportButtonComponent,selectors:[["bcf-export-button"]],features:[u.Vt3],decls:4,vars:3,consts:[[1,"button","export-bcf-button",3,"click","title"],["icon-classes","button--icon icon-export"],[1,"button--text"]],template:function BcfExportButtonComponent_Template(e,t){1&e&&(u.j41(0,"a",0),u.bIt("click",(function BcfExportButtonComponent_Template_a_click_0_listener(e){return t.showDelayedExport(e)})),u.nrm(1,"op-icon",1),u.j41(2,"span",2),u.EFF(3),u.k0s()()),2&e&&(u.Y8G("title",t.text.export_hover),u.BMQ("href",t.exportLink,u.B4B),u.R7$(3),u.SpI(" ",t.text.export," "))},dependencies:[m.i],encapsulation:2})}}},38087:(e,t,n)=>{"use strict";n.d(t,{O:()=>BcfImportButtonComponent});var i=n(61816),o=n(86866),r=n(86973),s=n(68559),a=n(46765);class BcfImportButtonComponent{constructor(e,t,n){this.I18n=e,this.currentProject=t,this.bcfPathHelper=n,this.text={import:this.I18n.t("js.bcf.import"),import_hover:this.I18n.t("js.bcf.import_bcf_xml_file")}}handleClick(){const e=this.currentProject.identifier;if(e){const t=this.bcfPathHelper.projectImportIssuePath(e);window.location.href=t}}static{this.ɵfac=function BcfImportButtonComponent_Factory(e){return new(e||BcfImportButtonComponent)(s.rXU(i.W),s.rXU(o.c),s.rXU(r.I))}}static{this.ɵcmp=s.VBU({type:BcfImportButtonComponent,selectors:[["bcf-import-button"]],decls:4,vars:2,consts:[[1,"button","import-bcf-button",3,"click","title"],["icon-classes","button--icon icon-import"],[1,"button--text"]],template:function BcfImportButtonComponent_Template(e,t){1&e&&(s.j41(0,"a",0),s.bIt("click",(function BcfImportButtonComponent_Template_a_click_0_listener(){return t.handleClick()})),s.nrm(1,"op-icon",1),s.j41(2,"span",2),s.EFF(3),s.k0s()()),2&e&&(s.Y8G("title",t.text.import_hover),s.R7$(3),s.SpI(" ",t.text.import," "))},dependencies:[a.i],encapsulation:2})}}},59833:(e,t,n)=>{"use strict";n.d(t,{H:()=>RefreshButtonComponent});var i=n(61816),o=n(83093),r=n(68559),s=n(46765);class RefreshButtonComponent{constructor(e,t){this.I18n=e,this.state=t,this.text={refresh:this.I18n.t("js.bcf.refresh"),refresh_hover:this.I18n.t("js.bcf.refresh_work_package")}}refresh(){this.state.go(".",{},{reload:!0})}static{this.ɵfac=function RefreshButtonComponent_Factory(e){return new(e||RefreshButtonComponent)(r.rXU(i.W),r.rXU(o.dw))}}static{this.ɵcmp=r.VBU({type:RefreshButtonComponent,selectors:[["op-refresh-button"]],decls:2,vars:1,consts:[[1,"button","refresh-button",3,"click","title"],["icon-classes","button--icon icon-workflow"]],template:function RefreshButtonComponent_Template(e,t){1&e&&(r.j41(0,"a",0),r.bIt("click",(function RefreshButtonComponent_Template_a_click_0_listener(){return t.refresh()})),r.nrm(1,"op-icon",1),r.k0s()),2&e&&r.Y8G("title",t.text.refresh_hover)},dependencies:[s.i],encapsulation:2,changeDetection:0})}}},99763:(e,t,n)=>{"use strict";n.d(t,{p:()=>CausedUpdatesService});var i=n(68559);class CausedUpdatesService{constructor(){this.causedUpdates=[]}includes(e){return this.causedUpdates.includes(this.cacheValue(e))}add(e){this.causedUpdates.length>100&&this.causedUpdates.splice(0,90),this.causedUpdates.push(this.cacheValue(e))}cacheValue(e){return e.updatedAt+e.href}static{this.ɵfac=function CausedUpdatesService_Factory(e){return new(e||CausedUpdatesService)}}static{this.ɵprov=i.jDH({token:CausedUpdatesService,factory:CausedUpdatesService.ɵfac})}}},41584:(e,t,n)=>{"use strict";n.d(t,{d:()=>o});var i=n(83755);const o=(0,i.XI)("[Calendar] Refresh calendar page due to external param changes",(0,i.xk)())},99206:(e,t,n)=>{"use strict";n.d(t,{h:()=>OpCalendarService});var i=n(84205),o=n(99496),r=n(74037),s=n(42032),a=n(6923),l=n(68559);class OpCalendarService extends o.p{constructor(e,t){super(),this.weekdayService=e,this.dayService=t,this.resize$=new i.B}resizeObserver(e){e&&(this.resizeObs||(this.resizeObs=new ResizeObserver((()=>this.resize$.next()))),this.resizeObs.observe(e.nativeElement))}applyNonWorkingDay({date:e},t){const n=a(e).utc(),i=n.format("YYYY-MM-DD");return e&&(this.weekdayService.isNonWorkingDay(n)||t.find((e=>e.date===i)))?["fc-non-working-day"]:[]}static{this.ɵfac=function OpCalendarService_Factory(e){return new(e||OpCalendarService)(l.KVO(r.I),l.KVO(s.o))}}static{this.ɵprov=l.jDH({token:OpCalendarService,factory:OpCalendarService.ɵfac})}}},2850:(e,t,n)=>{"use strict";n.d(t,{R:()=>OpWorkPackagesCalendarService});var i=n(89204),o=n(61816),r=n(72688),s=n(44674),a=n(69728),l=n(72650),c=n(56196),p=n(34120),d=n(95445),u=n(11048),h=n(99496),m=n(64334),g=n(36178),_=n(85247),f=n(14593),b=n(83093),k=n(32420),v=n(44663),C=n(51339),y=n(39545),w=n(29925),T=n(2183),S=n(79421),j=n(36819),P=n(56439),I=n(67369),x=n(99206),R=n(74037),F=n(42032),M=n(1042),O=n(68559),D=n(80436);class OpWorkPackagesCalendarService extends h.p{static{this.MAX_DISPLAYED=500}constructor(e,t,n,i,o,r,s,a,l,c,p,d,u,h,g,_,f,b,k,v,C,y){super(),this.I18n=e,this.configuration=t,this.sanitizer=n,this.$state=i,this.injector=o,this.schemaCache=r,this.toastService=s,this.wpTableFilters=a,this.wpListService=l,this.wpListChecksumService=c,this.urlParamsHelper=p,this.querySpace=d,this.apiV3Service=u,this.halResourceService=h,this.uiRouterGlobals=g,this.timezoneService=_,this.halEditing=f,this.wpTableSelection=b,this.contextMenuService=k,this.calendarService=v,this.weekdayService=C,this.dayService=y,this.nonWorkingDays=[],this.currentWorkPackages$=this.querySpace.results.values$().pipe((0,m.s)(1))}calendarOptions(e){return{...this.defaultOptions(),...e}}eventDate(e,t){return this.isMilestone(e)?e.date:e[`${t}Date`]}isMilestone(e){return this.schemaCache.of(e).isMilestone}warnOnTooManyResults(e,t=!1){e.count<e.total?this.tooManyResultsText=this.I18n.t("js.calendar.too_many",{count:e.total,max:OpWorkPackagesCalendarService.MAX_DISPLAYED}):this.tooManyResultsText=null,this.tooManyResultsText&&!t&&this.toastService.addNotice(this.tooManyResultsText)}requireNonWorkingDays(e,t){var n=this;return(0,i.A)((function*(){n.nonWorkingDays=yield(0,c._)(n.dayService.requireNonWorkingYears$(e,t))}))()}isNonWorkingDay(e){const t=y(e).format("YYYY-MM-DD");return-1!==this.nonWorkingDays.findIndex((e=>e.date===t))}updateTimeframe(e,t){var n=this;return(0,i.A)((function*(){if(yield n.requireNonWorkingDays(e.start,e.end),n.areFiltersEmpty&&n.querySpace.query.value)return Promise.resolve();const i=y(e.start).format("YYYY-MM-DD"),o=y(e.end).format("YYYY-MM-DD");let r,s=null;if(n.urlParams.query_id&&(s=n.urlParams.query_id),n.initializingWithQuery){const e=yield(0,c._)(n.apiV3Service.queries.find({pageSize:0},s));r=n.generateQueryProps(e,i,o)}else if(n.initializingWithQueryProps)if(n.urlParams.query_props){const e=JSON.parse(n.urlParams.query_props),t={...e,f:[...e.f.filter((e=>"datesInterval"!==e.n)),OpWorkPackagesCalendarService.dateFilter(i,o)],pp:OpWorkPackagesCalendarService.MAX_DISPLAYED,pa:1};r=JSON.stringify(t)}else r=OpWorkPackagesCalendarService.defaultQueryProps(i,o);else r=n.generateQueryProps(n.querySpace.query.value,i,o),n.wpListChecksumService.set(s,r);return Promise.all([n.wpListService.fromQueryParams({query_id:s,query_props:r},t||void 0).toPromise()])}))()}generateQueryProps(e,t,n){return this.urlParamsHelper.encodeQueryJsonParams(e,(e=>({...e,pp:OpWorkPackagesCalendarService.MAX_DISPLAYED,pa:1,f:[...e.f.filter((e=>"datesInterval"!==e.n)),OpWorkPackagesCalendarService.dateFilter(t,n)]})))}get initialView(){return this.urlParams.cview}dateEditable(e){const t=this.schemaCache.of(e),n=t.isAttributeEditable("startDate")&&t.isAttributeEditable("dueDate");return(e.isLeaf||e.scheduleManually)&&n}eventDurationEditable(e){return this.dateEditable(e)&&!this.isMilestone(e)}getEndDateFromTimestamp(e){return y(e).subtract(1,"d").format("YYYY-MM-DD")}openSplitView(e,t=!1){this.wpTableSelection.setSelection(e,-1),t&&!this.$state.includes("**.details.*")||this.$state.go(`${(0,a.N)(this.$state)}.tabs`,{workPackageId:e,tabIdentifier:"overview"})}openFullView(e){this.wpTableSelection.setSelection(e,-1),this.$state.go("work-packages.show",{workPackageId:e})}onCardClicked({workPackageId:e,event:t}){(0,T.R)(t)||this.openSplitView(e,!0)}onCardDblClicked({workPackageId:e,event:t}){(0,T.R)(t)||this.openFullView(e)}showEventContextMenu({workPackageId:e,event:t}){if((0,T.R)(t))return;if(t.target.closest(`.${S.qk}`))return void(0,j.cY)("Allowing original context menu on state link");this.wpTableSelection.setSelection(e,-1),t.preventDefault();const n=new P.L(this.injector,e,jQuery(t.target));this.contextMenuService.show(n,t)}defaultOptions(){return{editable:!1,locales:M.A,locale:this.I18n.locale,fixedWeekCount:!1,firstDay:this.configuration.startOfWeek(),timeZone:this.configuration.isTimezoneSet()?this.configuration.timezone():"local",height:"auto",headerToolbar:{left:"prev,next today",center:"title",right:""},initialDate:this.initialDate,initialView:this.initialView,datesSet:e=>this.updateDateParam(e),dayHeaderClassNames:e=>this.calendarService.applyNonWorkingDay(e,this.nonWorkingDays),dayCellClassNames:e=>this.calendarService.applyNonWorkingDay(e,this.nonWorkingDays),dayGridClassNames:e=>this.calendarService.applyNonWorkingDay(e,this.nonWorkingDays),slotLaneClassNames:e=>this.calendarService.applyNonWorkingDay(e,this.nonWorkingDays),slotLabelClassNames:e=>this.calendarService.applyNonWorkingDay(e,this.nonWorkingDays)}}static defaultQueryProps(e,t){const n={c:["id"],t:"id:asc",f:[{n:"status",o:"*",v:[]},this.dateFilter(e,t)],dr:"cards",hi:!1,pp:OpWorkPackagesCalendarService.MAX_DISPLAYED,pa:1};return JSON.stringify(n)}static dateFilter(e,t){return{n:"datesInterval",o:"<>d",v:[e,t]}}get initializingWithQueryProps(){return this.areFiltersEmpty||this.urlParams.query_props}get initializingWithQuery(){return this.areFiltersEmpty&&!!this.urlParams.query_id&&!this.urlParams.query_props}get urlParams(){return this.uiRouterGlobals.params}get areFiltersEmpty(){return this.wpTableFilters.isEmpty}get initialDate(){const e=this.urlParams.cdate;if(e)return this.timezoneService.formattedISODate(e)}updateDateParam(e){this.$state.go(".",{cdate:this.timezoneService.formattedISODate(e.view.calendar.getDate()),cview:e.view.type},{custom:{notify:!1}})}updateDates(e,t){const n=e.event.extendedProps.workPackage,i=this.halEditing.edit(n);if(!n.ignoreNonWorkingDays&&n.duration&&t)i.setValue("duration",n.duration);else{const t=y(e.event.endStr).subtract(1,"day").format("YYYY-MM-DD");i.setValue("dueDate",t)}return i.setValue("startDate",e.event.startStr),i}static{this.ɵfac=function OpWorkPackagesCalendarService_Factory(e){return new(e||OpWorkPackagesCalendarService)(O.KVO(o.W),O.KVO(r.s),O.KVO(D.up),O.KVO(b.dw),O.KVO(O.zZn),O.KVO(s.D),O.KVO(l.fw),O.KVO(p.N),O.KVO(d.E),O.KVO(v.T),O.KVO(_.j),O.KVO(u.i),O.KVO(f.n),O.KVO(g.t),O.KVO(b.ok),O.KVO(k.D),O.KVO(C.p),O.KVO(w.a),O.KVO(I.V),O.KVO(x.h),O.KVO(R.I),O.KVO(F.o))}}static{this.ɵprov=O.jDH({token:OpWorkPackagesCalendarService,factory:OpWorkPackagesCalendarService.ɵfac})}}},57654:(e,t,n)=>{"use strict";n.r(t),n.d(t,{OpenprojectCalendarModule:()=>OpenprojectCalendarModule});var i=n(34802),o=n(34456),r=n(87997),s=n(22685),a=n(53156),l=n(88955),c=n(43329),p=n(74785),d=n(91812),u=n(24398),h=n(99569),m=n(35245),g=n(81805),_=n(58397),f=n(15615),b=n(68118),k=n(89075),v=n(41584),C=n(94564),y=n(1758),w=n(68559),T=n(60316),S=n(24557),j=n(25827),P=n(92103);function WorkPackagesCalendarPageComponent_op_back_button_3_Template(e,t){if(1&e&&w.nrm(0,"op-back-button",11),2&e){const e=w.XpG();w.Y8G("customBackMethod",e.backButtonCallback)}}function WorkPackagesCalendarPageComponent_ul_5_ng_container_1_li_1_Template(e,t){if(1&e&&(w.j41(0,"li",15),w.nrm(1,"ndc-dynamic",16),w.k0s()),2&e){const e=w.XpG().$implicit,t=w.XpG(2);w.Y8G("ngClass",e.containerClasses),w.R7$(),w.Y8G("ndcDynamicComponent",e.component)("ndcDynamicInputs",e.inputs)("ndcDynamicInjector",t.injector)("ndcDynamicOutputs",e.outputs)}}function WorkPackagesCalendarPageComponent_ul_5_ng_container_1_Template(e,t){if(1&e&&(w.qex(0),w.DNE(1,WorkPackagesCalendarPageComponent_ul_5_ng_container_1_li_1_Template,2,5,"li",14),w.bVm()),2&e){const e=t.$implicit;w.R7$(),w.Y8G("ngIf",!e.show||e.show())}}function WorkPackagesCalendarPageComponent_ul_5_Template(e,t){if(1&e&&(w.j41(0,"ul",12),w.DNE(1,WorkPackagesCalendarPageComponent_ul_5_ng_container_1_Template,2,1,"ng-container",13),w.k0s()),2&e){const e=w.XpG();w.R7$(),w.Y8G("ngForOf",e.toolbarButtonComponents)}}function WorkPackagesCalendarPageComponent_ndc_dynamic_7_Template(e,t){if(1&e&&w.nrm(0,"ndc-dynamic",17),2&e){const e=w.XpG();w.Y8G("ndcDynamicComponent",e.filterContainerDefinition.component)("ndcDynamicInputs",e.filterContainerDefinition.inputs)("ndcDynamicOutputs",e.filterContainerDefinition.outputs)("ndcDynamicInjector",e.injector)}}class WorkPackagesCalendarPageComponent extends h.U{constructor(){super(...arguments),this.text={title:this.I18n.t("js.calendar.title"),unsaved_title:this.I18n.t("js.calendar.unsaved_title")},this.selectedTitle=this.text.unsaved_title,this.filterContainerDefinition={component:m.c},this.currentPartition="-split",this.showToolbar=!0,this.titleEditingEnabled=!1,this.showToolbarSaveButton=!0,this.toolbarDisabled=!1,this.toolbarButtonComponents=[{component:k.c},{component:g.f},{component:_.y},{component:f.K,containerClasses:"hidden-for-tablet",inputs:{hideTableOptions:!0,showCalendarSharingOption:!0}}]}setPartition(e){this.currentPartition=e.data?.partition||"-split"}staticQueryName(e){return this.text.unsaved_title}loadInitialQuery(){}refresh(e=!1,t=!1){this.actions$.dispatch((0,v.d)({showLoading:e}))}static{this.ɵfac=(()=>{let e;return function WorkPackagesCalendarPageComponent_Factory(t){return(e||(e=w.xGo(WorkPackagesCalendarPageComponent)))(t||WorkPackagesCalendarPageComponent)}})()}static{this.ɵcmp=w.VBU({type:WorkPackagesCalendarPageComponent,selectors:[["ng-component"]],viewQuery:function WorkPackagesCalendarPageComponent_Query(e,t){if(1&e&&w.GBs(s.E,7),2&e){let e;w.mGM(e=w.lsd())&&(t.calendarElement=e.first)}},features:[w.Jv_([b.x]),w.Vt3],decls:11,vars:8,consts:[[1,"work-packages-partitioned-query-space--container",3,"ngClass"],[1,"toolbar-container","-editable"],[1,"toolbar"],["class","op-back-button","linkClass","op-back-button_mobile-limited-width",3,"customBackMethod",4,"ngIf"],[3,"onSave","onEmptySubmit","title","inFlight","showSaveCondition","editable"],["class","toolbar-items hide-when-print",4,"ngIf"],[1,"work-packages-partitioned-query-space--filter-area"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector",4,"ngIf"],[1,"work-packages-partitioned-page--content-container"],["data-indicator-name","table","ui-view","content-left",1,"work-packages-partitioned-page--content-left","loading-indicator--location"],["ui-view","content-right",1,"work-packages-partitioned-page--content-right"],["linkClass","op-back-button_mobile-limited-width",1,"op-back-button",3,"customBackMethod"],[1,"toolbar-items","hide-when-print"],[4,"ngFor","ngForOf"],["class","toolbar-item",3,"ngClass",4,"ngIf"],[1,"toolbar-item",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicInjector","ndcDynamicOutputs"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector"]],template:function WorkPackagesCalendarPageComponent_Template(e,t){1&e&&(w.j41(0,"div",0)(1,"div",1)(2,"div",2),w.DNE(3,WorkPackagesCalendarPageComponent_op_back_button_3_Template,1,1,"op-back-button",3),w.j41(4,"editable-toolbar-title",4),w.bIt("onSave",(function WorkPackagesCalendarPageComponent_Template_editable_toolbar_title_onSave_4_listener(e){return t.changeChangesFromTitle(e)}))("onEmptySubmit",(function WorkPackagesCalendarPageComponent_Template_editable_toolbar_title_onEmptySubmit_4_listener(){return t.updateTitleName("")})),w.k0s(),w.DNE(5,WorkPackagesCalendarPageComponent_ul_5_Template,2,1,"ul",5),w.k0s()(),w.j41(6,"div",6),w.DNE(7,WorkPackagesCalendarPageComponent_ndc_dynamic_7_Template,1,4,"ndc-dynamic",7),w.k0s(),w.j41(8,"div",8),w.nrm(9,"div",9)(10,"div",10),w.k0s()()),2&e&&(w.Y8G("ngClass",t.currentPartition),w.R7$(3),w.Y8G("ngIf",t.backButtonCallback),w.R7$(),w.Y8G("title",t.selectedTitle)("inFlight",t.toolbarDisabled)("showSaveCondition",t.showToolbarSaveButton)("editable",t.titleEditingEnabled),w.R7$(),w.Y8G("ngIf",t.showToolbar),w.R7$(2),w.Y8G("ngIf",t.filterContainerDefinition))},dependencies:[l.UIView,T.YU,T.Sq,T.bT,S.JS,j.Bf,j.dE,P.X],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;display:grid;grid-template-columns:1fr;grid-template-rows:auto auto minmax(200px,1fr);margin-left:-10px;padding-left:10px;width:calc(100% + 10px)}.work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{flex-grow:1}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{overflow:auto}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   wp-resizer[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]{display:flex;overflow:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{position:relative}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{flex:1}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .title-container_editable[_ngcontent-%COMP%]{margin-left:-7px}@media only screen and (max-width: 543px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{min-width:initial;max-width:100vw;max-height:100%}}@media only screen and (max-width: 767px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto;grid-template-rows:auto auto;justify-items:start}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .op-back-button[_ngcontent-%COMP%]{grid-column:1/3;grid-row:1/2}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]{grid-column:1/2;grid-row:2/3;overflow:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-items[_ngcontent-%COMP%]{grid-column:2/3;grid-row:2/3}}"],changeDetection:0})}}(0,u.Cg)([(0,y.O)(C.d),(0,u.Sn)("design:type",C.d)],WorkPackagesCalendarPageComponent.prototype,"actions$",void 0);var I=n(72870),x=n(60129);const R={sidemenuId:"calendar_sidemenu",hardReloadOnBaseRoute:!0,defaultQuery:"new"},F=[{name:"calendar",parent:"optional_project",url:"/calendars/:query_id?&query_props&cdate&cview",redirectTo:"calendar.page",views:{"!$default":{component:n(27973).F}},params:{query_id:{type:"opQueryId",dynamic:!0},cdate:{type:"string",dynamic:!0},cview:{type:"string",dynamic:!0},query_props:{type:"opQueryString"}}},{name:"calendar.page",component:WorkPackagesCalendarPageComponent,redirectTo:"calendar.page.show",data:{bodyClasses:"router--calendar",sideMenuOptions:R}},{name:"calendar.page.show",data:{baseRoute:"calendar.page.show",sideMenuOptions:R},views:{"content-left":{component:s.E}}},...(0,I.M)("calendar.page.show",void 0,x.w)];var M=n(46635);class OpenprojectCalendarModule{static{this.ɵfac=function OpenprojectCalendarModule_Factory(e){return new(e||OpenprojectCalendarModule)}}static{this.ɵmod=w.$C({type:OpenprojectCalendarModule})}static{this.ɵinj=w.G2t({imports:[i.d,l.UIRouterModule.forChild({states:F}),a.W,d.d,p.X,r.E,o.X1]})}}("undefined"==typeof ngJitMode||ngJitMode)&&w.Obh(OpenprojectCalendarModule,{declarations:[WorkPackagesCalendarPageComponent,s.E,c.n,M.Z],imports:[i.d,l.UIRouterModule,a.W,d.d,p.X,r.E,o.X1],exports:[s.E,c.n]})},43329:(e,t,n)=>{"use strict";n.d(t,{n:()=>TimeEntryCalendarComponent});var i=n(89204),o=n(68559),r=n(87997),s=n(13432),a=n(39545),l=n(83093),c=n(61816),p=n(60483),d=n(72688),u=n(19426),h=n(51339),m=n(22842),g=n(85254),_=n(55939),f=n(75275),b=n(14593),k=n(44674),v=n(32420),C=n(40358),y=n(12313),w=n(99206),T=n(84205),S=n(56196),j=n(74037),P=n(42032),I=n(1042),x=n(80436),R=n(60316),F=n(46765);function TimeEntryCalendarComponent_button_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"button",4),o.bIt("click",(function TimeEntryCalendarComponent_button_1_Template_button_click_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.addEventToday())})),o.nrm(1,"op-icon",5)(2,"span",6),o.k0s()}if(2&e){const e=o.XpG();o.BMQ("aria-label",e.text.logTime),o.R7$(2),o.Y8G("textContent",e.text.logTime)}}function TimeEntryCalendarComponent_ng_container_2_full_calendar_1_Template(e,t){if(1&e&&o.nrm(0,"full-calendar",8,0),2&e){const e=o.XpG().ngIf;o.Y8G("options",e)}}function TimeEntryCalendarComponent_ng_container_2_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,TimeEntryCalendarComponent_ng_container_2_full_calendar_1_Template,2,1,"full-calendar",7),o.bVm()),2&e){const e=t.ngIf;o.R7$(),o.Y8G("ngIf",e)}}const M="te-calendar--time-entry",O="te-calendar--add-entry",D="-prohibited";class TimeEntryCalendarComponent{set displayedDays(e){this.initializeCalendar(e)}initializeCalendar(e){var t=this;this.weekdayService.loadWeekdays().toPromise().then((0,i.A)((function*(){const n=a().startOf("week").format("YYYY-MM-DD"),i=a().endOf("week").format("YYYY-MM-DD");yield t.requireNonWorkingDays(n,i),t.additionalOptions.hiddenDays=t.setHiddenDays(e),t.calendarOptions$.next(t.additionalOptions)})))}constructor(e,t,n,i,r,s,a,l,c,d,h,m,g,_,f,b,k,v){this.states=e,this.apiV3Service=t,this.$state=n,this.element=i,this.i18n=r,this.injector=s,this.notifications=a,this.sanitizer=l,this.configuration=c,this.timezone=d,this.timeEntryEdit=h,this.timeEntryCreate=m,this.schemaCache=g,this.colors=_,this.browserDetector=f,this.calendar=b,this.weekdayService=k,this.dayService=v,this.static=!1,this.entries=new o.bkB,this.minHour=1,this.maxHour=12,this.labelIntervalHours=2,this.scaleRatio=1,this.memoizedCreateAllowed=!1,this.text={logTime:this.i18n.t("js.button_log_time"),today:this.i18n.t("js.team_planner.today")},this.calendarOptions$=new T.B,this.nonWorkingDays=[],this.additionalOptions={editable:!1,locales:I.A,locale:this.i18n.locale,fixedWeekCount:!1,headerToolbar:{right:"",center:"title",left:"prev,next today"},buttonText:{today:this.text.today},initialView:"timeGridWeek",firstDay:this.configuration.startOfWeek(),timeZone:this.configuration.isTimezoneSet()?this.configuration.timezone():"local",hiddenDays:[],contentHeight:550,slotEventOverlap:!1,slotLabelInterval:`${this.labelIntervalHours}:00:00`,slotLabelFormat:e=>((this.maxHour-e.date.hour)/this.scaleRatio).toString(),allDaySlot:!1,displayEventTime:!1,slotMinTime:this.minHour-1+":00:00",slotMaxTime:`${this.maxHour}:00:00`,events:this.calendarEventsFunction.bind(this),eventOverlap:e=>!e.classNames.includes(M),plugins:[p.A,u.Ay],eventDidMount:this.alterEventEntry.bind(this),eventWillUnmount:this.beforeEventRemove.bind(this),eventClick:this.dispatchEventClick.bind(this),eventDrop:this.moveEvent.bind(this),dayHeaderClassNames:e=>this.calendar.applyNonWorkingDay(e,this.nonWorkingDays),dayCellClassNames:e=>this.calendar.applyNonWorkingDay(e,this.nonWorkingDays),dayGridClassNames:e=>this.calendar.applyNonWorkingDay(e,this.nonWorkingDays),slotLaneClassNames:e=>this.calendar.applyNonWorkingDay(e,this.nonWorkingDays),slotLabelClassNames:e=>this.calendar.applyNonWorkingDay(e,this.nonWorkingDays)}}requireNonWorkingDays(e,t){var n=this;return(0,i.A)((function*(){n.nonWorkingDays=yield(0,S._)(n.dayService.requireNonWorkingYears$(e,t))}))()}calendarEventsFunction(e,t,n){var o=this;const r=a(e.startStr),s=a(e.endStr);this.fetchTimeEntries(r,s).then(function(){var n=(0,i.A)((function*(n){o.entries.emit(n),t(yield o.buildEntries(n.elements,e))}));return function(e){return n.apply(this,arguments)}}()).catch(n)}fetchTimeEntries(e,t){if(!this.memoizedTimeEntries||this.memoizedTimeEntries.start.valueOf()!==e.valueOf()||this.memoizedTimeEntries.end.valueOf()!==t.valueOf()){const n=(0,S._)(this.apiV3Service.time_entries.list({filters:this.dmFilters(e,t),pageSize:500})).then((e=>(this.memoizedCreateAllowed=!!e.createTimeEntry,e)));this.memoizedTimeEntries={start:e,end:t,entries:n}}return this.memoizedTimeEntries.entries}buildEntries(e,t){var n=this;return(0,i.A)((function*(){return n.setRatio(e),yield n.requireNonWorkingDays(t.start,t.end),n.buildTimeEntryEntries(e).concat(n.buildAuxEntries(e,t))}))()}setRatio(e){const t=this.calculateDateSums(e),n=Math.max(...Object.values(t),0),i=this.scaleRatio;n>this.maxHour-this.minHour?this.scaleRatio=this.smallerSuitableRatio((this.maxHour-this.minHour)/n):this.scaleRatio=1,i!==this.scaleRatio&&this.ucCalendar.getApi().setOption("slotLabelFormat",(e=>((this.maxHour-e.date.hour)/this.scaleRatio).toString()))}buildTimeEntryEntries(e){const t={};return e.map((e=>{let n,i;const o=this.timezone.toHours(e.hours)*this.scaleRatio,r=e.spentOn;return t[r]?(n=t[r].clone().subtract(o,"h"),i=t[r].clone()):(n=a(r).add(this.maxHour-o,"h"),i=a(r).add(this.maxHour,"h")),t[r]=n,this.timeEntry(e,o,n,i)}))}buildAuxEntries(e,t){const n=this.calculateDateSums(e),i=[];for(let e=a(this.timezone.formattedISODate(t.start));e.diff(t.end,"days")<=0;e.add(1,"days")){const t=n[e.format("YYYY-MM-DD")]||0;i.push(this.sumEntry(e,t)),this.memoizedCreateAllowed&&i.push(this.addEntry(e,t))}return i}calculateDateSums(e){const t={};return e.forEach((e=>{const n=this.timezone.toHours(e.hours),i=e.spentOn;t[i]?t[i]+=n:t[i]=n})),t}timeEntry(e,t,n,i){const o=this.colors.toHsl(this.entryName(e)),r=[M],s=i.diff(n,"m");return s<40&&r.push("-no-fadeout"),{title:s<20?"":this.entryName(e),startEditable:!!e.update,start:n.format(),end:i.format(),backgroundColor:o,borderColor:o,classNames:r,entry:e}}sumEntry(e,t){return{start:e.clone().add(this.maxHour-Math.min(t*this.scaleRatio,this.maxHour-.5)-.5,"h").format(),end:e.clone().add(this.maxHour-Math.min((t+.05)*this.scaleRatio,this.maxHour-.5),"h").format(),classNames:"te-calendar--day-sum",rendering:"background",startEditable:!1,sum:this.i18n.t("js.units.hour",{count:t})}}addEntry(e,t){const n=[O];return t>=24&&n.push(D),{start:e.clone().format(),end:e.clone().add(this.maxHour-Math.min(t*this.scaleRatio,this.maxHour-1)-.5,"h").format(),rendering:"background",classNames:n}}dmFilters(e,t){return[["spentOn","<>d",[e.format("YYYY-MM-DD"),t.subtract(1,"d").format("YYYY-MM-DD")]],["user_id","=",["me"]]]}dispatchEventClick(e){e.event.extendedProps.entry?this.editEvent(e.event.extendedProps.entry):e.el.classList.contains(O)&&!e.el.classList.contains(D)&&this.addEvent(a(e.event.startStr))}editEvent(e){this.timeEntryEdit.edit(e,{showUserField:!1}).then((e=>{this.updateEventSet(e.entry,e.action)})).catch((()=>{}))}moveEvent(e){const t=e.event.extendedProps.entry;t.spentOn=a(e.event.endStr).format("YYYY-MM-DD"),this.schemaCache.ensureLoaded(t).then((n=>{this.apiV3Service.time_entries.id(t).patch(t,n).subscribe((e=>this.updateEventSet(e,"update")),(t=>{this.notifications.handleRawError(t),e.revert()}))}))}addEventToday(){this.addEvent(a(new Date))}addEvent(e){this.memoizedCreateAllowed&&this.timeEntryCreate.create(e,void 0,{showUserField:!1}).then((e=>{this.updateEventSet(e.entry,e.action)})).catch((()=>{}))}updateEventSet(e,t){this.memoizedTimeEntries.entries.then((n=>{const i=n.elements.findIndex((t=>t.id===e.id));switch(t){case"update":case"unchanged":n.elements[i]=e;break;case"destroy":n.elements.splice(i,1);break;case"create":this.apiV3Service.time_entries.cache.updateFor(e),n.elements.push(e);break;default:throw new Error("Invalid action")}this.ucCalendar.getApi().refetchEvents()}))}alterEventEntry(e){this.appendAddIcon(e),this.appendSum(e),e.event.extendedProps.entry&&(this.addTooltip(e),this.prependDuration(e),this.appendFadeout(e))}appendAddIcon(e){if(!e.el.classList.contains(O))return;const t=document.createElement("div");t.classList.add("te-calendar--add-icon"),t.innerText="+",e.el.append(t)}appendSum(e){e.event.extendedProps.sum&&(e.el.innerHTML=e.event.extendedProps.sum)}addTooltip(e){var t=this;return(0,i.A)((function*(){if(t.browserDetector.isMobile)return;const{entry:n}=e.event.extendedProps,i=yield t.schemaCache.ensureLoaded(n);jQuery(e.el).tooltip({content:t.tooltipContentString(e.event.extendedProps.entry,i),items:".fc-event",close(){jQuery(".ui-helper-hidden-accessible").remove()},track:!0})}))()}removeTooltip(e){jQuery(e.el).tooltip("instance")&&jQuery(e.el).tooltip("disable")}prependDuration(e){const t=e.event.extendedProps.entry;if(this.timezone.toHours(t.hours)<.5)return;const n=this.timezone.formattedDuration(t.hours);jQuery(e.el).find(".fc-event-title").prepend(`<div class="fc-duration">${n}</div>`)}appendFadeout(e){const t=e.event.extendedProps.entry;if(this.timezone.toHours(t.hours)<.5)return;const n=jQuery(e.el),i=jQuery('<div class="fc-fadeout"></div>'),o=this.colors.toHsla(this.entryName(t),0),r=this.colors.toHsla(this.entryName(t),100);i.css("background",`-webkit-linear-gradient(${o} 0%, ${r} 100%`),["-moz-linear-gradient","-o-linear-gradient","linear-gradient","-ms-linear-gradient"].forEach((e=>{i.css("background-image",`${e}(${o} 0%, ${r} 100%`)})),n.append(i)}beforeEventRemove(e){e.event.extendedProps.entry&&this.removeTooltip(e)}entryName(e){let{name:t}=e.project;return e.workPackage&&(t+=` - ${this.workPackageName(e)}`),t||"-"}workPackageName(e){const t=e.workPackage;return`#${(0,y.A)(t.href)}: ${t.name}`}tooltipContentString(e,t){return`\n        <ul class="tooltip--map">\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${t.project.name}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(e.project.name)}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${t.workPackage.name}:</span>\n            <span class="tooltip--map--value">${e.workPackage?this.sanitizedValue(this.workPackageName(e)):this.i18n.t("js.placeholders.default")}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${t.activity.name}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(e.activity.name)}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${t.hours.name}:</span>\n            <span class="tooltip--map--value">${this.timezone.formattedDuration(e.hours)}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${t.comment.name}:</span>\n            <span class="tooltip--map--value">${e.comment.raw||this.i18n.t("js.placeholders.default")}</span>\n          </li>\n        `}sanitizedValue(e){return this.sanitizer.sanitize(o.WPN.HTML,e)||""}formatNumber(e){return this.i18n.toNumber(e,{precision:2})}smallerSuitableRatio(e){for(let t=this.labelIntervalHours+1;t<100;t++){const n=this.labelIntervalHours/t;if(e>=n)return n}return 1}setHiddenDays(e){return Array.from(e,((e,t)=>e?null:(t+1)%7)).filter((e=>null!==e))}static{this.ɵfac=function TimeEntryCalendarComponent_Factory(e){return new(e||TimeEntryCalendarComponent)(o.rXU(s.D),o.rXU(b.n),o.rXU(l.dw),o.rXU(o.aKT),o.rXU(c.W),o.rXU(o.zZn),o.rXU(C.Y),o.rXU(x.up),o.rXU(d.s),o.rXU(v.D),o.rXU(m.r),o.rXU(g.h),o.rXU(k.D),o.rXU(_.e),o.rXU(f.l),o.rXU(w.h),o.rXU(j.I),o.rXU(P.o))}}static{this.ɵcmp=o.VBU({type:TimeEntryCalendarComponent,selectors:[["op-time-entries-calendar"]],viewQuery:function TimeEntryCalendarComponent_Query(e,t){if(1&e&&o.GBs(r.x,5),2&e){let e;o.mGM(e=o.lsd())&&(t.ucCalendar=e.first)}},inputs:{projectIdentifier:"projectIdentifier",static:"static",displayedDays:"displayedDays"},outputs:{entries:"entries"},features:[o.Jv_([w.h,m.r,g.h,h.p])],decls:4,vars:5,consts:[["ucCalendar",""],[1,"te-calendar--container","loading-indicator--location",2,"position","relative"],["class","button te-calendar--create-button",3,"click",4,"ngIf"],[4,"ngIf"],[1,"button","te-calendar--create-button",3,"click"],["icon-classes","button--icon icon-log_time"],["aria-hidden","true",1,"button--text",3,"textContent"],[3,"options",4,"ngIf"],[3,"options"]],template:function TimeEntryCalendarComponent_Template(e,t){1&e&&(o.j41(0,"div",1),o.DNE(1,TimeEntryCalendarComponent_button_1_Template,3,2,"button",2)(2,TimeEntryCalendarComponent_ng_container_2_Template,2,1,"ng-container",3),o.nI1(3,"async"),o.k0s()),2&e&&(o.BMQ("data-indicator-name","table"),o.R7$(),o.Y8G("ngIf",t.memoizedCreateAllowed),o.R7$(),o.Y8G("ngIf",o.bMT(3,3,t.calendarOptions$)))},dependencies:[R.bT,F.i,r.x,R.Jj],styles:["@media screen and (max-width: 543px){op-time-entries-calendar .fc-toolbar-chunk:empty{display:none}}@media screen and (min-width: 680px){op-time-entries-calendar .te-calendar--create-button{position:absolute;right:0;top:0;margin-right:0}op-time-entries-calendar .fc-toolbar-chunk:last-child{flex-basis:165px;flex-shrink:0}}op-time-entries-calendar full-calendar{overflow-x:auto}op-time-entries-calendar full-calendar .fc-view{min-width:800px}op-time-entries-calendar full-calendar thead{display:table-footer-group}op-time-entries-calendar full-calendar th.fc-day,op-time-entries-calendar full-calendar th.fc-timegrid-axis{border-bottom:none}op-time-entries-calendar full-calendar table.fc-scrollgrid.fc-scrollgrid-liquid{border-left:none}.-browser-firefox op-time-entries-calendar full-calendar .fc-col-header-cell-cushion{padding:2px 4px!important}op-time-entries-calendar full-calendar .fc-event,op-time-entries-calendar full-calendar .fc-bgevent{border-radius:0;margin-right:8px;margin-left:8px}op-time-entries-calendar full-calendar .fc-head-container{border-color:#fff}op-time-entries-calendar full-calendar .fc-day-header{padding-top:5px}op-time-entries-calendar full-calendar .fc-widget-content{border-left-color:#fff}op-time-entries-calendar full-calendar .fc-widget-content .fc-day{border-left:0;border-right:0}op-time-entries-calendar full-calendar .fc-timeGrid-view .fc-day-grid .fc-row{min-height:1em}op-time-entries-calendar full-calendar .fc-timeGrid-view .fc-day-grid .fc-row .fc-content-skeleton{padding-bottom:0}op-time-entries-calendar full-calendar .fc-timegrid-event-harness .fc-timegrid-event{box-shadow:none}op-time-entries-calendar full-calendar .fc-timegrid-slot.fc-timegrid-slot-minor{border-top:0}op-time-entries-calendar full-calendar .te-calendar--day-sum{border:none;background-color:initial;color:var(--body-font-color);text-align:center;font-size:.875em;font-weight:var(--base-text-weight-bold);line-height:22px;opacity:1;cursor:default}op-time-entries-calendar full-calendar .te-calendar--add-entry{text-align:center;font-weight:var(--base-text-weight-bold);opacity:0;background:none;border:none;display:flex;align-items:center}op-time-entries-calendar full-calendar .te-calendar--add-entry:hover{opacity:1;transition:opacity 1s ease;background:#eaeaea;border:1px solid var(--fgColor-muted)}op-time-entries-calendar full-calendar .te-calendar--add-entry .te-calendar--add-icon{color:#000;width:100%;font-weight:400;font-size:1.5rem}op-time-entries-calendar full-calendar .te-calendar--add-entry.-prohibited{cursor:not-allowed}op-time-entries-calendar full-calendar .te-calendar--add-entry.-prohibited .te-calendar--add-icon{display:none}op-time-entries-calendar full-calendar .te-calendar--add-entry .fc-event-title-container{margin:0!important}op-time-entries-calendar full-calendar .te-calendar--time-entry{color:#fff}op-time-entries-calendar full-calendar .te-calendar--time-entry .fc-content{height:100%}op-time-entries-calendar full-calendar .te-calendar--time-entry .fc-fadeout{position:relative;bottom:2em;height:2em;z-index:5}op-time-entries-calendar full-calendar .te-calendar--time-entry.-no-fadeout .fc-fadeout{display:none}op-time-entries-calendar full-calendar .te-calendar--time-entry .fc-event-title-container{margin:0 4px!important;line-height:14px!important}op-time-entries-calendar full-calendar .fc-duration{display:inline-block;margin-right:5px;padding-right:5px;font-weight:var(--base-text-weight-bold)}\n"],encapsulation:2,changeDetection:0})}}},22685:(e,t,n)=>{"use strict";n.d(t,{E:()=>WorkPackagesCalendarComponent});var i=n(89204),o=n(24398),r=n(68559),s=n(87997),a=n(75660),l=n(39545),c=n(84205),p=n(52575),d=n(13432),u=n(11048),h=n(34120),m=n(95445),g=n(83093),_=n(61816),f=n(72650),b=n(72688),k=n(99496),v=n(44674),C=n(86866),y=n(19426),w=n(51339),T=n(40358),S=n(69728),j=n(2850),P=n(99206),I=n(74037),x=n(42032),R=n(86748),F=n(41584),M=n(94564),O=n(86995),D=n(14593),G=n(89282),E=n(1042),A=n(73014),V=n(32420),$=n(80436),B=n(60316);const W=["ucCalendar"];function WorkPackagesCalendarComponent_ng_container_1_full_calendar_1_Template(e,t){if(1&e&&r.nrm(0,"full-calendar",5,0),2&e){const e=r.XpG().ngIf;r.Y8G("options",e)}}function WorkPackagesCalendarComponent_ng_container_1_Template(e,t){if(1&e&&(r.qex(0),r.DNE(1,WorkPackagesCalendarComponent_ng_container_1_full_calendar_1_Template,2,1,"full-calendar",4),r.bVm()),2&e){const e=t.ngIf;r.R7$(),r.Y8G("ngIf",e)}}function WorkPackagesCalendarComponent_div_3_Template(e,t){if(1&e&&r.nrm(0,"div",6),2&e){const e=r.XpG();r.Y8G("textContent",e.workPackagesCalendar.tooManyResultsText)}}class WorkPackagesCalendarComponent extends k.p{set ucCalendarElement(e){this.calendar.resizeObserver(e)}constructor(e,t,n,i,o,r,s,a,l,p,d,u,h,m,g,_,f,b,k,v,C,y,w){super(),this.actions$=e,this.states=t,this.$state=n,this.wpTableFilters=i,this.wpListService=o,this.querySpace=r,this.schemaCache=s,this.element=a,this.i18n=l,this.toastService=p,this.sanitizer=d,this.I18n=u,this.configuration=h,this.calendar=m,this.workPackagesCalendar=g,this.currentProject=_,this.halEditing=f,this.halNotification=b,this.weekdayService=k,this.dayService=v,this.apiV3Service=C,this.pathHelper=y,this.timezoneService=w,this.static=!1,this.showMeetings=!1,this.calendarOptions$=new c.B,this.alreadyLoaded=!1,this.text={cannot_drag_to_non_working_day:this.I18n.t("js.team_planner.cannot_drag_to_non_working_day"),today:this.I18n.t("js.team_planner.today")}}ngOnInit(){(0,R.fE)(this,this.untilDestroyed()),this.wpTableFilters.hidden.push("project"),this.calendar.resize$.pipe(this.untilDestroyed(),(0,p.B)(50)).subscribe((()=>{this.ucCalendar.getApi().updateSize()})),this.querySpace.stopAllSubscriptions.next(),this.initializeCalendar()}calendarEventsFunction(e,t){var n=this;return(0,i.A)((function*(){if(yield n.workPackagesCalendar.updateTimeframe(e,n.currentProject.identifier||void 0),n.alreadyLoaded){n.alreadyLoaded=!1;const e=n.updateResults(n.querySpace.results.value);t(e)}else n.workPackagesCalendar.currentWorkPackages$.subscribe((e=>{const i=n.updateResults(e);t(i)}))}))()}calendarMeetingsFunction(e,t){if(!this.showMeetings)return void t([]);const n=l(e.start).format("YYYY-MM-DD"),i=l(e.end).format("YYYY-MM-DD"),o=new G.hG;o.add("datesInterval","<>d",[n,i]),this.currentProject.id&&o.add("project","=",[this.currentProject.id]),this.apiV3Service.meetings.filtered(o,{pageSize:"-1"}).get().subscribe((e=>{const n=e.elements.map((e=>({title:this.currentProject.id===e.project.id?e.title:`${e.project.name}: ${e.title}`,start:this.timezoneService.parseDatetime(e.startTime).format(),end:this.timezoneService.parseDatetime(e.endTime).format(),editable:!1,durationEditable:!1,allDay:!1,className:"fc-event-clickable op-wp-calendar--meeting-resource",meeting:e})));t(n)}))}ngOnDestroy(){super.ngOnDestroy(),this.calendar.resizeObs?.disconnect()}initializeCalendar(){const e={locales:E.A,locale:this.I18n.locale,height:"100%",headerToolbar:this.buildHeader(),eventSources:[{id:"work_packages",events:this.calendarEventsFunction.bind(this)},{id:"meetings",events:this.calendarMeetingsFunction.bind(this),eventDisplay:"block"},{events:[],id:"background",color:"red",background:"red",textColor:"white",display:"background",editable:!1}],plugins:[a.A,y.Ay],selectable:!0,select:this.handleDateClicked.bind(this),eventResizableFromStart:!0,editable:!0,displayEventTime:!0,displayEventEnd:!0,eventTimeFormat:{hour:"numeric",minute:"2-digit",meridiem:"short"},eventDidMount:e=>{const{el:t,event:n}=e;if("work_packages"!==n.source?.id)return;const i=n.extendedProps.workPackage;t.dataset.workPackageId=i.id},eventResize:e=>{const t=l(e.event.endStr).subtract(1,"day").toDate(),n=l(e.event.startStr).toDate();if(!e.event.extendedProps.workPackage.ignoreNonWorkingDays&&(this.weekdayService.isNonWorkingDay(n)||this.weekdayService.isNonWorkingDay(t)||this.workPackagesCalendar.isNonWorkingDay(n)||this.workPackagesCalendar.isNonWorkingDay(t)))return this.toastService.addError(this.text.cannot_drag_to_non_working_day),void e?.revert();this.updateEvent(e,!1)},eventDrop:e=>{const t=l(e.event.startStr).toDate();if(!e.event.extendedProps.workPackage.ignoreNonWorkingDays&&(this.weekdayService.isNonWorkingDay(t)||this.workPackagesCalendar.isNonWorkingDay(t)))return this.toastService.addError(this.text.cannot_drag_to_non_working_day),void e?.revert();this.updateEvent(e,!0)},eventResizeStart:e=>{e.event.extendedProps.workPackage.ignoreNonWorkingDays||this.addBackgroundEventsForNonWorkingDays()},eventResizeStop:()=>(0,O.QB)(this.ucCalendar.getApi()),eventDragStart:e=>{e.event.extendedProps.workPackage.ignoreNonWorkingDays||this.addBackgroundEventsForNonWorkingDays()},eventDragStop:e=>{const{el:t}=e;t.style.removeProperty("pointer-events"),(0,O.QB)(this.ucCalendar.getApi())},eventClick:e=>{if(e.event.extendedProps.meeting){const t=e.event.extendedProps.meeting;window.location.href=this.pathHelper.meetingPath(t.id)}if(e.event.extendedProps.workPackage){const t=e.event.extendedProps.workPackage.id;this.$state.includes("calendar")?this.workPackagesCalendar.openSplitView(t):this.$state.go("work-packages.show",{workPackageId:t})}}};this.static&&(e.initialView="dayGridWeek"),this.weekdayService.loadWeekdays().toPromise().then((()=>{this.calendarOptions$.next(this.workPackagesCalendar.calendarOptions(e))}))}buildHeader(){return!this.static&&{right:"dayGridMonth,dayGridWeek",center:"title",left:"prev,next today"}}openContextMenu(e){const t=e.target.closest(".fc-event");if(!t)return;const n=t.dataset.workPackageId;this.workPackagesCalendar.showEventContextMenu({workPackageId:n,event:e})}updateResults(e){return this.workPackagesCalendar.warnOnTooManyResults(e,this.static),this.mapToCalendarEvents(e.elements)}mapToCalendarEvents(e){return e.map((e=>{const t=this.workPackagesCalendar.eventDate(e,"start"),n=this.workPackagesCalendar.eventDate(e,"due"),i=l(n).add(1,"days").format("YYYY-MM-DD");return{title:e.subject,start:t,editable:this.workPackagesCalendar.dateEditable(e),durationEditable:this.workPackagesCalendar.eventDurationEditable(e),end:i,allDay:!0,className:`fc-event-clickable __hl_background_type_${e.type.id||""}`,workPackage:e}}))}updateEvent(e,t){var n=this;return(0,i.A)((function*(){const i=n.workPackagesCalendar.updateDates(e,t);try{const e=yield n.halEditing.save(i);n.halNotification.showSave(e.resource,e.wasNew),n.reloadOnRefreshRequest()}catch(t){n.halNotification.handleRawError(t,i.projectedResource),e.revert()}}))()}handleDateClicked(e){const t=l(e.endStr).subtract(1,"day").toDate(),n=this.weekdayService.isNonWorkingDay(e.start)||this.weekdayService.isNonWorkingDay(t)||this.workPackagesCalendar.isNonWorkingDay(e.start)||this.workPackagesCalendar.isNonWorkingDay(t),i={startDate:e.startStr,dueDate:this.workPackagesCalendar.getEndDateFromTimestamp(e.endStr),ignoreNonWorkingDays:n};this.$state.go((0,S.N)(this.$state,"new"),{defaults:i,tabIdentifier:"overview"})}reloadOnRefreshRequest(){this.ucCalendar.getApi().refetchEvents()}addBackgroundEventsForNonWorkingDays(){(0,O.R8)(this.ucCalendar.getApi(),(e=>this.weekdayService.isNonWorkingDay(e)||this.workPackagesCalendar.isNonWorkingDay(e)))}static{this.ɵfac=function WorkPackagesCalendarComponent_Factory(e){return new(e||WorkPackagesCalendarComponent)(r.rXU(M.d),r.rXU(d.D),r.rXU(g.dw),r.rXU(h.N),r.rXU(m.E),r.rXU(u.i),r.rXU(v.D),r.rXU(r.aKT),r.rXU(_.W),r.rXU(f.fw),r.rXU($.up),r.rXU(_.W),r.rXU(b.s),r.rXU(P.h),r.rXU(j.R),r.rXU(C.c),r.rXU(w.p),r.rXU(T.Y),r.rXU(I.I),r.rXU(x.o),r.rXU(D.n),r.rXU(A.B),r.rXU(V.D))}}static{this.ɵcmp=r.VBU({type:WorkPackagesCalendarComponent,selectors:[["op-wp-calendar"]],viewQuery:function WorkPackagesCalendarComponent_Query(e,t){if(1&e&&(r.GBs(s.x,5),r.GBs(W,5,r.aKT)),2&e){let e;r.mGM(e=r.lsd())&&(t.ucCalendar=e.first),r.mGM(e=r.lsd())&&(t.ucCalendarElement=e.first)}},inputs:{static:"static",showMeetings:"showMeetings"},features:[r.Jv_([j.R,P.h]),r.Vt3],decls:4,vars:5,consts:[["ucCalendar",""],["data-test-selector","op-wp-calendar",1,"op-wp-calendar",3,"contextmenu"],[4,"ngIf"],["class","op-wp-calendar--notification",3,"textContent",4,"ngIf"],[3,"options",4,"ngIf"],[3,"options"],[1,"op-wp-calendar--notification",3,"textContent"]],template:function WorkPackagesCalendarComponent_Template(e,t){1&e&&(r.j41(0,"div",1),r.bIt("contextmenu",(function WorkPackagesCalendarComponent_Template_div_contextmenu_0_listener(e){return t.openContextMenu(e)})),r.DNE(1,WorkPackagesCalendarComponent_ng_container_1_Template,2,1,"ng-container",2),r.nI1(2,"async"),r.DNE(3,WorkPackagesCalendarComponent_div_3_Template,1,1,"div",3),r.k0s()),2&e&&(r.BMQ("data-indicator-name","table"),r.R7$(),r.Y8G("ngIf",r.bMT(2,3,t.calendarOptions$)),r.R7$(2),r.Y8G("ngIf",t.static))},dependencies:[B.bT,s.x,B.Jj],styles:[".op-wp-calendar{--fc-border-color: var(--borderColor-default);min-height:200px;height:100%}.op-wp-calendar--notification{font-style:italic;margin-top:.5rem}.op-wp-calendar .fc-event-clickable{cursor:pointer}.op-wp-calendar--meeting-resource{padding-left:5px;display:flex;flex-direction:column;align-items:start;white-space:normal;word-break:break-all}.op-wp-calendar--meeting-resource .fc-daygrid-event-dot{display:none}\n"],encapsulation:2,changeDetection:0})}}(0,o.Cg)([(0,R.xP)(F.d),(0,o.Sn)("design:type",Function),(0,o.Sn)("design:paramtypes",[]),(0,o.Sn)("design:returntype",void 0)],WorkPackagesCalendarComponent.prototype,"reloadOnRefreshRequest",null)},52843:(e,t,n)=>{"use strict";n.d(t,{E:()=>EEActiveTrialBase});var i=n(99496);class EEActiveTrialBase extends i.p{constructor(e){super(),this.I18n=e,this.text={label_email:this.I18n.t("js.label_email"),label_expires_at:this.I18n.t("js.admin.enterprise.trial.form.label_expires_at"),label_maximum_users:this.I18n.t("js.admin.enterprise.trial.form.label_maximum_users"),label_company:this.I18n.t("js.admin.enterprise.trial.form.label_company"),label_domain:this.I18n.t("js.admin.enterprise.trial.form.label_domain"),label_starts_at:this.I18n.t("js.admin.enterprise.trial.form.label_starts_at"),label_subscriber:this.I18n.t("js.admin.enterprise.trial.form.label_subscriber"),text_expired:this.I18n.t("js.admin.enterprise.text_expired"),text_reprieve_days_left:e=>this.I18n.t("js.admin.enterprise.text_reprieve_days_left",{days:e})}}}},57907:(e,t,n)=>{"use strict";n.d(t,{c:()=>EEActiveTrialComponent});var i=n(91817),o=n(61816),r=n(91141),s=n(52843),a=n(51730),l=n(10304),c=n(68559),p=n(30501),d=n(60316);function EEActiveTrialComponent_div_13_Template(e,t){if(1&e&&(c.j41(0,"div",3),c.nrm(1,"div",4),c.j41(2,"div",5)(3,"div",6),c.nrm(4,"span",7),c.k0s()()()),2&e){const e=c.XpG();c.R7$(),c.Y8G("textContent",e.text.label_company),c.R7$(3),c.Y8G("textContent",e.company)}}function EEActiveTrialComponent_div_14_Template(e,t){if(1&e&&(c.j41(0,"div",3),c.nrm(1,"div",4),c.j41(2,"div",10)(3,"div",6),c.nrm(4,"span",7),c.k0s()()()),2&e){const e=c.XpG();c.R7$(),c.Y8G("textContent",e.text.label_domain),c.R7$(3),c.Y8G("textContent",e.domain)}}function EEActiveTrialComponent_div_15_Template(e,t){if(1&e&&(c.j41(0,"div",3),c.nrm(1,"div",4),c.j41(2,"div",5)(3,"div",6),c.nrm(4,"span",7),c.k0s()()()),2&e){const e=c.XpG();c.R7$(),c.Y8G("textContent",e.text.label_maximum_users),c.R7$(3),c.Y8G("textContent",e.userCount)}}function EEActiveTrialComponent_div_16_Template(e,t){if(1&e&&(c.j41(0,"div",3),c.nrm(1,"div",4),c.j41(2,"div",5)(3,"div",6),c.nrm(4,"span",7),c.k0s()()()),2&e){const e=c.XpG();c.R7$(),c.Y8G("textContent",e.text.label_starts_at),c.R7$(3),c.Y8G("textContent",e.startsAt)}}function EEActiveTrialComponent_div_17_span_5_Template(e,t){if(1&e&&c.nrm(0,"span",12),2&e){const e=c.XpG(2);c.Y8G("textContent",e.expiredWarningText)}}function EEActiveTrialComponent_div_17_Template(e,t){if(1&e&&(c.j41(0,"div",3),c.nrm(1,"div",4),c.j41(2,"div",5)(3,"div",6),c.nrm(4,"span",7),c.DNE(5,EEActiveTrialComponent_div_17_span_5_Template,1,1,"span",11),c.k0s()()()),2&e){const e=c.XpG();c.R7$(),c.Y8G("textContent",e.text.label_expires_at),c.R7$(3),c.Y8G("textContent",e.expiresAt),c.R7$(),c.Y8G("ngIf",e.isExpired)}}class EEActiveTrialComponent extends s.E{constructor(e,t,n,i,o,r){super(n),this.elementRef=e,this.cdRef=t,this.I18n=n,this.http=i,this.Gon=o,this.eeTrialService=r}ngOnInit(){this.subscriber||(this.eeTrialService.userData$.pipe((0,i.F)(),this.untilDestroyed()).subscribe((e=>{this.formatUserData(e),this.cdRef.detectChanges()})),this.initialize())}initialize(){const e=this.Gon.get("ee_trial_key"),{data:t}=this.eeTrialService.current;if(e&&!t){const t=`${this.eeTrialService.baseUrlAugur}/public/v1/trials/${e.value}`;this.eeTrialService.store.update({trialLink:t}),this.getUserDataFromAugur(t)}}getUserDataFromAugur(e){this.http.get(`${e}/details`,{headers:{[l.e]:"true"}}).toPromise().then((e=>{this.eeTrialService.store.update({data:e}),this.eeTrialService.retryConfirmation()})).catch((()=>{this.eeTrialService.getToken()}))}formatUserData(e){this.subscriber=`${e.first_name} ${e.last_name}`,this.email=e.email,this.company=e.company,this.domain=e.domain}static{this.ɵfac=function EEActiveTrialComponent_Factory(e){return new(e||EEActiveTrialComponent)(c.rXU(c.aKT),c.rXU(c.gRc),c.rXU(o.W),c.rXU(p.Qq),c.rXU(a.m),c.rXU(r.d))}}static{this.ɵcmp=c.VBU({type:EEActiveTrialComponent,selectors:[["enterprise-active-trial"]],features:[c.Vt3],decls:18,vars:9,consts:[["data-test-selector","op-enterprise--active-token",1,"op-enterprise--active-token"],[1,"attributes-group"],[1,"attributes-group--attributes"],[1,"attributes-key-value"],[1,"attributes-key-value--key",3,"textContent"],[1,"attributes-key-value--value-container"],[1,"attributes-key-value--value","-text"],[3,"textContent"],["data-test-selector","ee-active-trial-email",1,"attributes-key-value--value-container"],["class","attributes-key-value",4,"ngIf"],["data-test-selector","ee-active-trial-domain",1,"attributes-key-value--value-container"],["class","expired-warning",3,"textContent",4,"ngIf"],[1,"expired-warning",3,"textContent"]],template:function EEActiveTrialComponent_Template(e,t){1&e&&(c.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),c.nrm(4,"div",4),c.j41(5,"div",5)(6,"div",6),c.nrm(7,"span",7),c.k0s()()(),c.j41(8,"div",3),c.nrm(9,"div",4),c.j41(10,"div",8)(11,"div",6),c.nrm(12,"span",7),c.k0s()()(),c.DNE(13,EEActiveTrialComponent_div_13_Template,5,2,"div",9)(14,EEActiveTrialComponent_div_14_Template,5,2,"div",9)(15,EEActiveTrialComponent_div_15_Template,5,2,"div",9)(16,EEActiveTrialComponent_div_16_Template,5,2,"div",9)(17,EEActiveTrialComponent_div_17_Template,6,3,"div",9),c.k0s()()()),2&e&&(c.R7$(4),c.Y8G("textContent",t.text.label_subscriber),c.R7$(3),c.Y8G("textContent",t.subscriber),c.R7$(2),c.Y8G("textContent",t.text.label_email),c.R7$(3),c.Y8G("textContent",t.email),c.R7$(),c.Y8G("ngIf",t.company),c.R7$(),c.Y8G("ngIf",t.domain),c.R7$(),c.Y8G("ngIf",t.userCount),c.R7$(),c.Y8G("ngIf",t.startsAt),c.R7$(),c.Y8G("ngIf",t.expiresAt))},dependencies:[d.bT],styles:[".op-enterprise--active-token[_ngcontent-%COMP%]   .attributes-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.op-enterprise--active-token[_ngcontent-%COMP%]   .expired-warning[_ngcontent-%COMP%]{margin-left:.4rem;color:red;font-weight:var(--base-text-weight-bold)}"]})}}},68235:(e,t,n)=>{"use strict";n.d(t,{s:()=>EETrialFormComponent});var i=n(34456),o=n(61816),r=n(91141),s=n(63894);function localizeLink(e){const{locale:t}=I18n;return e[t]||e.en}var a=n(72688),l=n(68559),c=n(60316);const _c0=e=>({emailError:e}),_c1=e=>({domainError:e}),_c2=e=>({"-required-highlighting":e});function EETrialFormComponent_div_19_div_6_Template(e,t){if(1&e&&l.nrm(0,"div",24),2&e){const e=l.XpG().ngIf;l.Y8G("textContent",e.emailError)}}function EETrialFormComponent_div_19_Template(e,t){if(1&e){const e=l.RV6();l.j41(0,"div",1)(1,"label",20),l.EFF(2),l.k0s(),l.j41(3,"div",3)(4,"div",21)(5,"input",22),l.bIt("blur",(function EETrialFormComponent_div_19_Template_input_blur_5_listener(){l.eBV(e);const t=l.XpG();return l.Njj(t.checkMailField())})),l.k0s()()(),l.DNE(6,EETrialFormComponent_div_19_div_6_Template,1,1,"div",23),l.k0s()}if(2&e){const e=t.ngIf,n=l.XpG();l.R7$(2),l.JRh(n.text.label_email),l.R7$(2),l.Y8G("ngClass",l.eq3(3,_c2,e.emailError)),l.R7$(2),l.Y8G("ngIf",e.emailError)}}function EETrialFormComponent_div_21_p_7_Template(e,t){if(1&e&&l.nrm(0,"p",29),2&e){const e=l.XpG(2);l.Y8G("textContent",e.text.domain_mismatch)}}function EETrialFormComponent_div_21_p_8_Template(e,t){if(1&e&&l.nrm(0,"p",29),2&e){const e=l.XpG().ngIf;l.Y8G("textContent",e.domainError)}}function EETrialFormComponent_div_21_Template(e,t){if(1&e&&(l.j41(0,"div",1)(1,"label",25),l.EFF(2),l.k0s(),l.j41(3,"div",3)(4,"div",21),l.nrm(5,"input",26),l.k0s()(),l.j41(6,"div",27),l.DNE(7,EETrialFormComponent_div_21_p_7_Template,1,1,"p",28)(8,EETrialFormComponent_div_21_p_8_Template,1,1,"p",28),l.k0s()()),2&e){const e=t.ngIf,n=l.XpG();l.R7$(2),l.JRh(n.text.label_domain),l.R7$(2),l.Y8G("ngClass",l.eq3(4,_c2,e.domainError)),l.R7$(3),l.Y8G("ngIf",n.requestHost!==n.configuredHost),l.R7$(),l.Y8G("ngIf",e.domainError)}}class EETrialFormComponent{constructor(e,t,n,o,r,s){this.elementRef=e,this.I18n=t,this.formBuilder=n,this.currentUserService=o,this.configurationService=r,this.eeTrialService=s,this.userData=this.eeTrialService.current.data||{},this.requestHost=window.location.host,this.configuredHost=this.configurationService.hostName,this.trialForm=this.formBuilder.group({company:[this.userData.company,i.k0.required],first_name:[this.userData.first_name,i.k0.required],last_name:[this.userData.last_name,i.k0.required],email:["",[i.k0.required,i.k0.email]],domain:[this.userData.domain||this.configuredHost,i.k0.required],general_consent:[null,i.k0.required],newsletter_consent:null,language:this.currentUserService.language}),this.text={general_consent:this.I18n.t("js.admin.enterprise.trial.form.general_consent",{link_terms:localizeLink({en:"https://www.openproject.org/terms-of-service/",de:"https://www.openproject.org/de/nutzungsbedingungen/"}),link_privacy:localizeLink({en:"https://www.openproject.org/data-privacy-and-security/",de:"https://www.openproject.org/de/datenschutz/"})}),label_test_ee:this.I18n.t("js.admin.enterprise.trial.form.test_ee"),label_company:this.I18n.t("js.admin.enterprise.trial.form.label_company"),label_first_name:this.I18n.t("js.admin.enterprise.trial.form.label_first_name"),label_last_name:this.I18n.t("js.admin.enterprise.trial.form.label_last_name"),label_email:this.I18n.t("js.label_email"),label_domain:this.I18n.t("js.admin.enterprise.trial.form.label_domain"),domain_mismatch:this.I18n.t("js.admin.enterprise.trial.form.domain_mismatch"),privacy_policy:this.I18n.t("js.admin.enterprise.trial.form.privacy_policy"),receive_newsletter:this.I18n.t("js.admin.enterprise.trial.form.receive_newsletter",{link:"https://www.openproject.org/newsletter/"}),terms_of_service:this.I18n.t("js.admin.enterprise.trial.form.terms_of_service")}}checkMailField(){""!==this.trialForm.value.email&&this.trialForm.controls.email.errors?this.eeTrialService.store.update({emailInvalid:!0}):this.eeTrialService.store.update({emailInvalid:!1,error:void 0})}static{this.ɵfac=function EETrialFormComponent_Factory(e){return new(e||EETrialFormComponent)(l.rXU(l.aKT),l.rXU(o.W),l.rXU(i.ze),l.rXU(s.K),l.rXU(a.s),l.rXU(r.d))}}static{this.ɵcmp=l.VBU({type:EETrialFormComponent,selectors:[["enterprise-trial-form"]],decls:35,vars:16,consts:[["id","enterprise-trial-form",1,"form",3,"formGroup"],[1,"form--field","-wide-label","-required"],["for","trial-company-name",1,"form--label"],[1,"form--field-container"],[1,"form--text-field-container"],["type","text","id","trial-company-name","formControlName","company",1,"form--text-field"],["for","trial-first-name",1,"form--label"],["type","text","id","trial-first-name","formControlName","first_name",1,"form--text-field"],["for","trial-last-name",1,"form--label"],["type","text","id","trial-last-name","formControlName","last_name",1,"form--text-field"],["class","form--field -wide-label -required",4,"ngIf"],[1,"form--field","-required"],["for","trial-general-consent",1,"form--label-with-check-box","-no-ellipsis"],[1,"form--check-box-container"],["type","checkbox","id","trial-general-consent","formControlName","general_consent","required","",1,"form--check-box"],[3,"innerHTML"],[1,"form--field"],["for","trial-newsletter-consent",1,"form--label-with-check-box","-no-ellipsis"],["type","checkbox","id","trial-newsletter-consent","formControlName","newsletter_consent",1,"form--check-box"],[3,"innerHtml"],["for","trial-email",1,"form--label"],[1,"form--text-field-container",3,"ngClass"],["type","email","id","trial-email","formControlName","email",1,"form--text-field",3,"blur"],["class","form--field-instructions op-ee-trial-email-error",3,"textContent",4,"ngIf"],[1,"form--field-instructions","op-ee-trial-email-error",3,"textContent"],["for","trial-domain-name",1,"form--label"],["type","text","id","trial-domain-name","formControlName","domain","disabled","",1,"form--text-field"],[1,"form--field-instructions"],[3,"textContent",4,"ngIf"],[3,"textContent"]],template:function EETrialFormComponent_Template(e,t){1&e&&(l.j41(0,"form",0)(1,"div",1)(2,"label",2),l.EFF(3),l.k0s(),l.j41(4,"div",3)(5,"div",4),l.nrm(6,"input",5),l.k0s()()(),l.j41(7,"div",1)(8,"label",6),l.EFF(9),l.k0s(),l.j41(10,"div",3)(11,"div",4),l.nrm(12,"input",7),l.k0s()()(),l.j41(13,"div",1)(14,"label",8),l.EFF(15),l.k0s(),l.j41(16,"div",3)(17,"div",4),l.nrm(18,"input",9),l.k0s()()(),l.DNE(19,EETrialFormComponent_div_19_Template,7,5,"div",10),l.nI1(20,"async"),l.DNE(21,EETrialFormComponent_div_21_Template,9,6,"div",10),l.nI1(22,"async"),l.j41(23,"div",11)(24,"div",3)(25,"label",12)(26,"div",13),l.nrm(27,"input",14),l.k0s(),l.nrm(28,"span",15),l.k0s()()(),l.j41(29,"div",16)(30,"div",3)(31,"label",17)(32,"div",13),l.nrm(33,"input",18),l.k0s(),l.nrm(34,"span",19),l.k0s()()()()),2&e&&(l.Y8G("formGroup",t.trialForm),l.R7$(3),l.JRh(t.text.label_company),l.R7$(6),l.JRh(t.text.label_first_name),l.R7$(6),l.JRh(t.text.label_last_name),l.R7$(4),l.Y8G("ngIf",l.eq3(12,_c0,l.bMT(20,8,t.eeTrialService.emailError$))),l.R7$(2),l.Y8G("ngIf",l.eq3(14,_c1,l.bMT(22,10,t.eeTrialService.domainTaken$))),l.R7$(7),l.Y8G("innerHTML",t.text.general_consent,l.npT),l.R7$(6),l.Y8G("innerHtml",t.text.receive_newsletter,l.npT))},dependencies:[c.YU,c.bT,i.qT,i.me,i.Zm,i.BC,i.cb,i.xq,i.j4,i.JD,c.Jj],styles:[".op-ee-trial-email-error[_ngcontent-%COMP%]{width:min-content}"],changeDetection:0})}}},61623:(e,t,n)=>{"use strict";n.d(t,{_:()=>EnterpriseTrialModalComponent});var i=n(34456),o=n(69081),r=n(51133),s=n(61816),a=n(68235),l=n(91141),c=n(70271),p=n(68559),d=n(80436),u=n(60316),h=n(36987);const _c0=(e,t,n)=>({status:e,cancelled:t,confirmed:n});function EnterpriseTrialModalComponent_div_6_Template(e,t){1&e&&(p.j41(0,"div"),p.nrm(1,"enterprise-trial-form"),p.k0s())}function EnterpriseTrialModalComponent_div_7_Template(e,t){1&e&&(p.j41(0,"div"),p.nrm(1,"enterprise-trial-waiting"),p.k0s())}function EnterpriseTrialModalComponent_div_8_Template(e,t){if(1&e&&(p.j41(0,"div")(1,"div",7)(2,"div",8)(3,"span"),p.EFF(4),p.k0s()(),p.j41(5,"div",9),p.nrm(6,"iframe",10),p.k0s()()()),2&e){const e=p.XpG();p.R7$(4),p.JRh(e.text.quick_overview),p.R7$(2),p.Y8G("src",e.trustedEEVideoURL,p.f$h)}}function EnterpriseTrialModalComponent_div_9_div_2_Template(e,t){if(1&e){const e=p.RV6();p.j41(0,"div",12)(1,"button",14),p.bIt("click",(function EnterpriseTrialModalComponent_div_9_div_2_Template_button_click_1_listener(t){p.eBV(e);const n=p.XpG(2);return p.Njj(n.closeModal(t))})),p.k0s(),p.j41(2,"button",15),p.bIt("click",(function EnterpriseTrialModalComponent_div_9_div_2_Template_button_click_2_listener(){p.eBV(e);const t=p.XpG(2);return p.Njj(t.onSubmit())})),p.k0s()()}if(2&e){const e=p.XpG().ngIf,t=p.XpG();p.R7$(),p.Y8G("textContent",t.text.button_cancel),p.BMQ("title",t.text.button_cancel),p.R7$(),p.Y8G("disabled",!t.trialForm||t.trialForm.invalid)("textContent",t.text.button_submit)("hidden","mailSubmitted"===e.status&&!e.cancelled),p.BMQ("title",t.text.button_submit)}}function EnterpriseTrialModalComponent_div_9_ng_template_3_button_2_Template(e,t){if(1&e){const e=p.RV6();p.j41(0,"button",18),p.bIt("click",(function EnterpriseTrialModalComponent_div_9_ng_template_3_button_2_Template_button_click_0_listener(t){p.eBV(e);const n=p.XpG(3);return p.Njj(n.closeModal(t))})),p.k0s()}if(2&e){const e=p.XpG(3);p.Y8G("textContent",e.text.button_continue),p.BMQ("title",e.text.button_continue)}}function EnterpriseTrialModalComponent_div_9_ng_template_3_Template(e,t){if(1&e){const e=p.RV6();p.j41(0,"div",12)(1,"button",16),p.bIt("click",(function EnterpriseTrialModalComponent_div_9_ng_template_3_Template_button_click_1_listener(){p.eBV(e);const t=p.XpG(2);return p.Njj(t.startEnterpriseTrial())})),p.k0s(),p.DNE(2,EnterpriseTrialModalComponent_div_9_ng_template_3_button_2_Template,1,2,"button",17),p.k0s()}if(2&e){const e=p.XpG().ngIf,t=p.XpG();p.R7$(),p.Y8G("textContent",t.text.button_continue)("disabled",!e.confirmed)("hidden","startTrial"===e.status),p.BMQ("title",t.text.button_continue),p.R7$(),p.Y8G("ngIf","startTrial"===e.status)}}function EnterpriseTrialModalComponent_div_9_Template(e,t){if(1&e&&(p.j41(0,"div",11)(1,"div",12),p.DNE(2,EnterpriseTrialModalComponent_div_9_div_2_Template,3,6,"div",13)(3,EnterpriseTrialModalComponent_div_9_ng_template_3_Template,3,5,"ng-template",null,0,p.C5r),p.k0s()()),2&e){const e=t.ngIf,n=p.sdS(4);p.R7$(2),p.Y8G("ngIf",!e.status||e.cancelled)("ngIfElse",n)}}class EnterpriseTrialModalComponent extends o.a{constructor(e,t,n,i,o,r){super(t,n,e),this.elementRef=e,this.locals=t,this.cdRef=n,this.I18n=i,this.domSanitizer=o,this.eeTrialService=r,this.text={button_submit:this.I18n.t("js.modals.button_submit"),button_cancel:this.I18n.t("js.modals.button_cancel"),button_continue:this.I18n.t("js.button_continue"),close_popup:this.I18n.t("js.close_popup_title"),heading_confirmation:this.I18n.t("js.admin.enterprise.trial.confirmation"),heading_next_steps:this.I18n.t("js.admin.enterprise.trial.next_steps"),heading_test_ee:this.I18n.t("js.admin.enterprise.trial.test_ee"),quick_overview:this.I18n.t("js.admin.enterprise.trial.quick_overview")},this.headerText$=this.eeTrialService.observe$.pipe((0,c.T)((({status:e})=>"mailSubmitted"===e?this.text.heading_confirmation:"startTrial"===e?this.text.heading_next_steps:this.text.heading_test_ee))),this.showState$=this.eeTrialService.observe$.pipe((0,c.T)((({status:e,cancelled:t})=>!e||t?"trial-form":"mailSubmitted"!==e||t?"overview":"trial-waiting"))),this.trustedEEVideoURL=this.trustedURL("https://www.youtube.com/embed/zLMSydhFSkw?autoplay=1")}ngAfterViewInit(){this.trialForm=this.formComponent.trialForm}onSubmit(){this.trialForm.valid&&(this.trialForm.addControl("_type",new i.hs("enterprise-trial")),this.eeTrialService.sendForm(this.trialForm))}startEnterpriseTrial(){this.eeTrialService.setStartTrialStatus()}closeModal(e){this.closeMe(e);const{status:t,confirmed:n}=this.eeTrialService.current;if("startTrial"===t||n)window.location.reload();else if("mailSubmitted"===t)return void window.location.reload();this.eeTrialService.store.update({modalOpen:!1})}trustedURL(e){return this.domSanitizer.bypassSecurityTrustResourceUrl(e)}static{this.ɵfac=function EnterpriseTrialModalComponent_Factory(e){return new(e||EnterpriseTrialModalComponent)(p.rXU(p.aKT),p.rXU(r.Y),p.rXU(p.gRc),p.rXU(s.W),p.rXU(d.up),p.rXU(l.d))}}static{this.ɵcmp=p.VBU({type:EnterpriseTrialModalComponent,selectors:[["enterprise-trial-modal"]],viewQuery:function EnterpriseTrialModalComponent_Query(e,t){if(1&e&&p.GBs(a.s,5),2&e){let e;p.mGM(e=p.lsd())&&(t.formComponent=e.first)}},inputs:{opReferrer:"opReferrer"},features:[p.Vt3],decls:13,vars:20,consts:[["mailSubmitted",""],[1,"spot-modal","op-enterprise-modal"],["id","spotModalTitle",1,"spot-modal--header",3,"textContent"],[1,"spot-divider"],[1,"spot-modal--body","spot-container",3,"ngSwitch"],[4,"ngSwitchCase"],["class","spot-action-bar",4,"ngIf"],[1,"onboarding--video-block"],[1,"onboarding--video-text"],[1,"onboarding--video","iframe-target-wrapper"],["frameborder","0","height","400","width","100%","allowfullscreen","",3,"src"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["class","spot-action-bar--right",4,"ngIf","ngIfElse"],["data-test-selector","confirmation-modal--cancel",1,"button","button_no-margin","spot-action-bar--action","spot-modal--cancel-button",3,"click","textContent"],["data-test-selector","confirmation-modal--confirmed",1,"button","button_no-margin","-primary","spot-action-bar--action",3,"click","disabled","textContent","hidden"],["data-test-selector","confirmation-modal--confirmed",1,"button","button_no-margin","-primary","spot-action-bar--action",3,"click","textContent","disabled","hidden"],["class","button button_no-margin -primary spot-action-bar--action","data-test-selector","confirmation-modal--confirmed",3,"textContent","click",4,"ngIf"],["data-test-selector","confirmation-modal--confirmed",1,"button","button_no-margin","-primary","spot-action-bar--action",3,"click","textContent"]],template:function EnterpriseTrialModalComponent_Template(e,t){1&e&&(p.j41(0,"div",1),p.nrm(1,"div",2),p.nI1(2,"async"),p.nrm(3,"div",3),p.j41(4,"div",4),p.nI1(5,"async"),p.DNE(6,EnterpriseTrialModalComponent_div_6_Template,2,0,"div",5)(7,EnterpriseTrialModalComponent_div_7_Template,2,0,"div",5)(8,EnterpriseTrialModalComponent_div_8_Template,7,2,"div",5),p.k0s(),p.DNE(9,EnterpriseTrialModalComponent_div_9_Template,5,2,"div",6),p.nI1(10,"async"),p.nI1(11,"async"),p.nI1(12,"async"),p.k0s()),2&e&&(p.R7$(),p.Y8G("textContent",p.bMT(2,6,t.headerText$)),p.R7$(3),p.Y8G("ngSwitch",p.bMT(5,8,t.showState$)),p.R7$(2),p.Y8G("ngSwitchCase","trial-form"),p.R7$(),p.Y8G("ngSwitchCase","trial-waiting"),p.R7$(),p.Y8G("ngSwitchCase","overview"),p.R7$(),p.Y8G("ngIf",p.sMw(16,_c0,p.bMT(10,10,t.eeTrialService.status$),p.bMT(11,12,t.eeTrialService.cancelled$),p.bMT(12,14,t.eeTrialService.confirmed$))))},dependencies:[u.bT,u.ux,u.e1,a.s,h.Z,u.Jj],styles:[".op-enterprise-modal[_ngcontent-%COMP%]   .onboarding--video-text[_ngcontent-%COMP%]{margin-bottom:1.25rem}"],changeDetection:0})}}},36987:(e,t,n)=>{"use strict";n.d(t,{Z:()=>EETrialWaitingComponent});var i=n(61816),o=n(91141),r=n(72650),s=n(91817),a=n(32420),l=n(10304),c=n(68559),p=n(30501),d=n(60316),u=n(57907);const _c0=(e,t)=>({confirmed:e,cancelled:t});function EETrialWaitingComponent_div_0_span_7_Template(e,t){if(1&e){const e=c.RV6();c.j41(0,"span",5),c.EFF(1),c.j41(2,"button",6),c.bIt("click",(function EETrialWaitingComponent_div_0_span_7_Template_button_click_2_listener(){c.eBV(e);const t=c.XpG(2);return c.Njj(t.resendMail())})),c.EFF(3),c.k0s()()}if(2&e){const e=c.XpG(2);c.R7$(),c.SpI(" ",e.text.status_waiting," "),c.R7$(2),c.SpI(" ",e.text.resend,"")}}function EETrialWaitingComponent_div_0_span_8_Template(e,t){if(1&e&&(c.j41(0,"span"),c.EFF(1),c.k0s()),2&e){const e=c.XpG(2);c.R7$(),c.JRh(e.text.session_timeout)}}function EETrialWaitingComponent_div_0_ng_template_9_Template(e,t){if(1&e&&(c.j41(0,"span",7),c.EFF(1),c.k0s()),2&e){const e=c.XpG(2);c.R7$(),c.SpI(" ",e.text.status_confirmed," ")}}function EETrialWaitingComponent_div_0_Template(e,t){if(1&e&&(c.j41(0,"div",2),c.nrm(1,"enterprise-active-trial"),c.j41(2,"p"),c.EFF(3),c.k0s(),c.j41(4,"p")(5,"span"),c.EFF(6),c.k0s(),c.DNE(7,EETrialWaitingComponent_div_0_span_7_Template,4,2,"span",3)(8,EETrialWaitingComponent_div_0_span_8_Template,2,1,"span",4)(9,EETrialWaitingComponent_div_0_ng_template_9_Template,2,1,"ng-template",null,0,c.C5r),c.k0s()()),2&e){const e=t.ngIf,n=c.sdS(10),i=c.XpG();c.R7$(3),c.JRh(i.text.confirmation_info(i.created,i.email)),c.R7$(3),c.SpI("",i.text.status_label," "),c.R7$(),c.Y8G("ngIf",!e.confirmed)("ngIfElse",n),c.R7$(),c.Y8G("ngIf",e.cancelled)}}class EETrialWaitingComponent{constructor(e,t,n,i,o,r){this.elementRef=e,this.I18n=t,this.http=n,this.toastService=i,this.eeTrialService=o,this.timezoneService=r,this.created=this.timezoneService.formattedDate((new Date).toString()),this.email="",this.text={confirmation_info:(e,t)=>this.I18n.t("js.admin.enterprise.trial.confirmation_info",{date:e,email:t}),resend:this.I18n.t("js.admin.enterprise.trial.resend_link"),resend_success:this.I18n.t("js.admin.enterprise.trial.resend_success"),resend_warning:this.I18n.t("js.admin.enterprise.trial.resend_warning"),session_timeout:this.I18n.t("js.admin.enterprise.trial.session_timeout"),status_confirmed:this.I18n.t("js.admin.enterprise.trial.status_confirmed"),status_label:this.I18n.t("js.admin.enterprise.trial.status_label"),status_waiting:this.I18n.t("js.admin.enterprise.trial.status_waiting")}}ngOnInit(){const e=window.gon.ee_trial_key;if(e){const t=e.created.split(" ")[0];this.created=this.timezoneService.formattedDate(t)}this.eeTrialService.userData$.pipe((0,s.F)()).subscribe((e=>{this.email=e.email}))}resendMail(){const{resendLink:e}=this.eeTrialService.store.getValue();e&&(this.eeTrialService.store.update({cancelled:!1}),this.http.post(e,{},{headers:{[l.e]:"true"}}).toPromise().then((()=>{this.toastService.addSuccess(this.text.resend_success),this.eeTrialService.retryConfirmation()})).catch((()=>{const{trialLink:e}=this.eeTrialService.store.getValue();e?this.eeTrialService.getToken():this.toastService.addError(this.text.resend_warning)})))}static{this.ɵfac=function EETrialWaitingComponent_Factory(e){return new(e||EETrialWaitingComponent)(c.rXU(c.aKT),c.rXU(i.W),c.rXU(p.Qq),c.rXU(r.fw),c.rXU(o.d),c.rXU(a.D))}}static{this.ɵcmp=c.VBU({type:EETrialWaitingComponent,selectors:[["enterprise-trial-waiting"]],decls:3,vars:8,consts:[["confirmedStatus",""],["class","op-ee-trial-waiting",4,"ngIf"],[1,"op-ee-trial-waiting"],["class","op-ee-trial-waiting-status--waiting","data-test-selector","op-ee-trial-waiting-status--waiting",4,"ngIf","ngIfElse"],[4,"ngIf"],["data-test-selector","op-ee-trial-waiting-status--waiting",1,"op-ee-trial-waiting-status--waiting"],["data-test-selector","op-ee-trial-waiting-resend-link",1,"spot-link","op-ee-trial-waiting-resend-link",3,"click"],["data-test-selector","op-ee-trial-waiting-status--confirmed",1,"op-ee-trial-waiting-status--confirmed","icon-yes"]],template:function EETrialWaitingComponent_Template(e,t){1&e&&(c.DNE(0,EETrialWaitingComponent_div_0_Template,11,5,"div",1),c.nI1(1,"async"),c.nI1(2,"async")),2&e&&c.Y8G("ngIf",c.l_i(5,_c0,c.bMT(1,1,t.eeTrialService.confirmed$),c.bMT(2,3,t.eeTrialService.cancelled$)))},dependencies:[d.bT,u.c,d.Jj],styles:[".op-ee-trial-waiting-status--confirmed[_ngcontent-%COMP%]{color:var(--button--primary-background-color)}.op-ee-trial-waiting-status--waiting[_ngcontent-%COMP%]{color:orange}"]})}}},91141:(e,t,n)=>{"use strict";n.d(t,{d:()=>EnterpriseTrialService});var i=n(89204),o=n(57678),r=n(51567),s=n(70271),a=n(86301),l=n(61816),c=n(73014),p=n(72650),d=n(10304),u=n(24398);let h=class EnterpriseTrialStore extends o.il{constructor(){super({modalOpen:!1,confirmed:!1,cancelled:!1,emailInvalid:!1})}};h=(0,u.Cg)([(0,o.g7)({name:"enterprise-trial"}),(0,u.Sn)("design:paramtypes",[])],h);var m=n(51730),g=n(32622),_=n(68559),f=n(30501);class EnterpriseTrialService{constructor(e,t,n,i,l){this.I18n=e,this.http=t,this.pathHelper=n,this.toastService=i,this.Gon=l,this.store=new h,this.query=new o.XK(this.store),this.confirmed$=this.query.select("confirmed"),this.cancelled$=this.query.select("cancelled"),this.status$=this.query.select("status"),this.observe$=this.query.select(),this.userData$=this.query.select("data").pipe((0,r.p)(g.A)),this.emailError$=this.query.select().pipe((0,s.T)((({error:e,emailInvalid:t})=>{if(t)return this.text.invalid_email;const n=e?.error;return e&&"user_already_created_trial"===n.identifier?this.text.taken_email:null})),(0,a.t)(1)),this.domainTaken$=this.query.select().pipe((0,s.T)((({error:e})=>{const t=e?.error;return e&&"domain_taken"===t.identifier?this.text.taken_domain:null})),(0,a.t)(1)),this.text={invalid_email:this.I18n.t("js.admin.enterprise.trial.form.invalid_email"),taken_email:this.I18n.t("js.admin.enterprise.trial.form.taken_email"),taken_domain:this.I18n.t("js.admin.enterprise.trial.form.taken_domain")},this.baseUrlAugur=this.Gon.get("augur_url"),this.tokenVersion=this.Gon.get("token_version"),this.Gon.get("ee_trial_key")&&this.setMailSubmittedStatus()}sendForm(e){const t={...e.value,token_version:this.tokenVersion};return this.http.post(`${this.baseUrlAugur}/public/v1/trials`,t,{headers:{[d.e]:"true"}}).toPromise().then((t=>{const n=t._links.self.href,i=e.value;this.store.update({trialLink:n,data:i,cancelled:!1}),this.saveTrialKey(n),this.retryConfirmation()})).catch((e=>{if(422===e.status||400===e.status)this.store.update({error:e});else{const t=e.error.description;this.toastService.addWarning(t||I18n.t("js.error.internal"))}}))}getToken(){var e=this;this.http.get(this.store.getValue().trialLink,{headers:{[d.e]:"true"}}).toPromise().then(function(){var t=(0,i.A)((function*(t){e.store.update({confirmed:!0}),t.token_retrieved||(yield e.saveToken(t.token))}));return function(e){return t.apply(this,arguments)}}()).catch((e=>{const t=e.error;if(422===e.status&&"waiting_for_email_verification"===t.identifier){const e=t._links.resend.href;this.store.update({resendLink:e});const{status:n,cancelled:i}=this.store.getValue();n&&!i||this.saveTrialKey(e),this.setMailSubmittedStatus(),this.store.update({confirmed:!1})}else t?.message?this.toastService.addError(t.message):this.toastService.addError(e.error||I18n.t("js.error.internal"))}))}saveTrialKey(e){const t=e.split("/")[6];return this.http.post(`${this.pathHelper.appBasePath}/admin/enterprise/save_trial_key`,{trial_key:t},{withCredentials:!0}).toPromise().catch((e=>{const t=e.error;this.toastService.addError(t.message||e.message||e)}))}saveToken(e){return this.http.post(`${this.pathHelper.appBasePath}/admin/enterprise`,{enterprise_token:{encoded_token:e}},{withCredentials:!0}).toPromise().then((()=>{const{modalOpen:e}=this.store.getValue();e||setTimeout((()=>{window.location.reload()}),500)})).catch((e=>{this.http.delete(`${this.pathHelper.api.v3.apiV3Base}/admin/enterprise/delete_trial_key`,{withCredentials:!0}).toPromise();const t=e.error;this.toastService.addError(t.description||I18n.t("js.error.internal"))}))}retryConfirmation(e=5e3,t=60){const{cancelled:n,confirmed:i}=this.store.getValue();n||i||(0===t?this.store.update({cancelled:!0}):(this.getToken(),setTimeout((()=>{this.retryConfirmation(e,t-1)}),e)))}setStartTrialStatus(){this.store.update({status:"startTrial"})}setMailSubmittedStatus(){this.store.update({status:"mailSubmitted"})}get current(){return this.store.getValue()}static{this.ɵfac=function EnterpriseTrialService_Factory(e){return new(e||EnterpriseTrialService)(_.KVO(l.W),_.KVO(f.Qq),_.KVO(c.B),_.KVO(p.fw),_.KVO(m.m))}}static{this.ɵprov=_.jDH({token:EnterpriseTrialService,factory:EnterpriseTrialService.ɵfac})}}},74356:(e,t,n)=>{"use strict";n.d(t,{E:()=>FreeTrialButtonComponent});var i=n(61816),o=n(61623),r=n(51133),s=n(91141),a=n(32420),l=n(91817),c=n(51730),p=n(68559),d=n(30501),u=n(60316);const _c0=e=>({"tooltip--top":e});class FreeTrialButtonComponent{constructor(e,t,n,i,o,r,s,a){this.I18n=e,this.opModalService=t,this.injector=n,this.http=i,this.cdRef=o,this.Gon=r,this.eeTrialService=s,this.timezoneService=a,this.created=this.timezoneService.formattedDate((new Date).toString()),this.email="",this.text={button_trial:this.I18n.t("js.admin.enterprise.upsale.button_start_trial"),confirmation_info:(e,t)=>this.I18n.t("js.admin.enterprise.trial.confirmation_info",{date:e,email:t})}}ngOnInit(){this.eeTrialService.userData$.pipe((0,l.F)()).subscribe((e=>{this.email=e.email,this.cdRef.detectChanges()})),this.initialize()}initialize(){const e=this.Gon.get("ee_trial_key");if(e){const t=e.created.split(" ")[0];this.created=this.timezoneService.formattedDate(t);const{data:n}=this.eeTrialService.store.getValue();if(n){const t=`${this.eeTrialService.baseUrlAugur}/public/v1/trials/${e.value}`;this.eeTrialService.store.update({trialLink:t}),this.getUserDataFromAugur(t)}}}getUserDataFromAugur(e){this.http.get(`${e}/details`).toPromise().then((e=>{this.eeTrialService.store.update({data:e}),this.eeTrialService.retryConfirmation()})).catch((()=>{this.eeTrialService.getToken()}))}openTrialModal(){this.eeTrialService.store.update({cancelled:!0,modalOpen:!0}),this.opModalService.show(o._,this.injector)}get trialRequested(){return!!this.Gon.get("ee_trial_key")}static{this.ɵfac=function FreeTrialButtonComponent_Factory(e){return new(e||FreeTrialButtonComponent)(p.rXU(i.W),p.rXU(r.a),p.rXU(p.zZn),p.rXU(d.Qq),p.rXU(p.gRc),p.rXU(c.m),p.rXU(s.d),p.rXU(a.D))}}static{this.ɵcmp=p.VBU({type:FreeTrialButtonComponent,selectors:[["opce-free-trial-button"]],decls:3,vars:6,consts:[[3,"ngClass"],["type","button",1,"button","-primary",3,"click","disabled"]],template:function FreeTrialButtonComponent_Template(e,t){1&e&&(p.j41(0,"div",0)(1,"button",1),p.bIt("click",(function FreeTrialButtonComponent_Template_button_click_1_listener(){return t.openTrialModal()})),p.EFF(2),p.k0s()()),2&e&&(p.Y8G("ngClass",p.eq3(4,_c0,t.trialRequested)),p.BMQ("data-tooltip",t.trialRequested?t.text.confirmation_info(t.created,t.email):""),p.R7$(),p.Y8G("disabled",t.trialRequested),p.R7$(),p.SpI(" ",t.text.button_trial," "))},dependencies:[u.YU],encapsulation:2,changeDetection:0})}}},62046:(e,t,n)=>{"use strict";n.d(t,{J:()=>ShareUpsaleComponent});var i=n(61816),o=n(915),r=n(68559),s=n(95393);class ShareUpsaleComponent{constructor(e){this.I18n=e,this.video=(0,o.J)("sharing/share-work-package.mp4"),this.text={title:this.I18n.t("js.work_packages.sharing.title"),description:this.I18n.t("js.work_packages.sharing.upsale.description")}}static{this.ɵfac=function ShareUpsaleComponent_Factory(e){return new(e||ShareUpsaleComponent)(r.rXU(i.W))}}static{this.ɵcmp=r.VBU({type:ShareUpsaleComponent,selectors:[["op-share-upsale"]],decls:1,vars:4,consts:[[3,"feature_video","feature_title","feature_description","hide_breadcrumb"]],template:function ShareUpsaleComponent_Template(e,t){1&e&&r.nrm(0,"op-enterprise-page",0),2&e&&r.Y8G("feature_video",t.video)("feature_title",t.text.title)("feature_description",t.text.description)("hide_breadcrumb",!0)},dependencies:[s.U],encapsulation:2,changeDetection:0})}}},31635:(e,t,n)=>{"use strict";n.d(t,{I:()=>HalLink});var i=n(56196);class HalLink{constructor(e,t=null,n="",i="get",o=!1,r,s="application/json",a){this.requestMethod=e,this.href=t,this.title=n,this.method=i,this.templated=o,this.payload=r,this.type=s,this.identifier=a}static fromObject(e,t){return new HalLink(((t,n,o,r)=>(0,i._)(e.request(t,n,o,r))),t.href,t.title,t.method,t.templated,t.payload,t.type,t.identifier)}$fetch(...e){const[t,n]=e;return this.requestMethod(this.method,this.href,t,n)}$prepare(e){if(!this.templated)throw new Error(`The link ${this.href} is not templated.`);let t=_.clone(this.href)||"";return _.each(e,((e,n)=>{const i=new RegExp(`{${n}}`);t=t.replace(i,e)})),new HalLink(this.requestMethod,t,this.title,this.method,!1,this.payload,this.type,this.identifier).$callable()}$callable(){const linkFunc=(...e)=>this.$fetch(...e);return _.extend(linkFunc,{$link:this,href:this.href,title:this.title,method:this.method,templated:this.templated,payload:this.payload,type:this.type,identifier:this.identifier}),linkFunc}}},10267:(e,t,n)=>{"use strict";n.d(t,{P_:()=>cloneHalResource,Zp:()=>cloneHalResourceCollection,zh:()=>initializeHalProperties});var i,o=n(5464),r=n(31635);function cloneHalResourceCollection(e){return _.isNil(e)?[]:e.map((e=>e.$copy()))}function cloneHalResource(e){return _.isNil(e)?e:e.$copy()}function initializeHalProperties(e,t){function asHalResource(t,n=!0){return _.isNil(t)?t:t._links||t._embedded||t._type?e.createHalResource(t,n):t}function setupProperty(e,n){const o=`$${e}`,r=`_${e}`,s=t.$source[r];_.isObject(s)&&Object.keys(s).forEach((e=>{i.lazy(t[o],e,(()=>n(s[e])))}))}function setter(e,n){const i=Array.isArray(e);if(e)if(i)t.$source._links[n]=e.map((e=>({href:e.href})));else if(e.hasOwnProperty("$link")){const i=e.$link;i.href&&(t.$source._links[n]=i)}else"href"in e&&(t.$source._links[n]={href:e.href});else t.$source._links[n]={href:null};return t.$embedded&&t.$embedded[n]&&(t.$embedded[n]=e,t.$source._embedded[n]=i?e.map((e=>e.$source)):_.get(e,"$source",e)),e}!function setSource(){t.$source._links||(t.$source._links={});t.$source._links.self||(t.$source._links.self={href:null})}(),function setupLinks(){setupProperty("links",(t=>Array.isArray(t)?t.map((t=>r.I.fromObject(e,t).$callable())):r.I.fromObject(e,t).$callable()))}(),function setupEmbedded(){setupProperty("embedded",(e=>Array.isArray(e)?e.map((e=>asHalResource(e,!0))):(_.isObject(e)&&_.each(e,((t,n)=>{t&&(t._embedded||t._links)&&i.lazy(e,n,(()=>asHalResource(t,!0)))})),asHalResource(e,!0))))}(),function proxyProperties(){t.$embeddableKeys().forEach((e=>{Object.defineProperty(t,e,{get:()=>asHalResource(t.$source[e],!0),set(n){t.$source[e]=n},enumerable:!0,configurable:!0})}))}(),function setLinksAsProperties(){t.$linkableKeys().forEach((n=>{i.lazy(t,n,(()=>{const i=t.$links[n].$link||t.$links[n];if(Array.isArray(i)){const r=i.map((i=>e.createLinkedResource(t,n,i.$link)));var s=new o(...r).on("change",(()=>{s.forEach((e=>{e.$link||s.splice(s.indexOf(e),1)})),t.$source._links[n]=s.map((e=>e.$link))}));return s}return i.href?"get"!==i.method?r.I.fromObject(e,i).$callable():e.createLinkedResource(t,n,i):null}),(e=>setter(e,n)))}))}(),function setEmbeddedAsProperties(){if(!t.$source._embedded)return;Object.keys(t.$source._embedded).forEach((e=>{i.lazy(t,e,(()=>t.$embedded[e]),(t=>setter(t,e)))}))}()}!function(e){e.lazy=function lazy(e,t,n,i){if(_.isObject(e)){let o,r=!1;const s={get:()=>(r||(o=n(),r=!0),o),set:()=>{},configurable:!0,enumerable:!0};i&&(s.set=e=>{o=i(e),r=!0}),Object.defineProperty(e,t,s)}}}(i||(i={}))},12313:(e,t,n)=>{"use strict";function idFromLink(e){const t=(e||"").split("/").pop().split("?")[0];return decodeURIComponent(t)}n.d(t,{A:()=>idFromLink})},97366:(e,t,n)=>{"use strict";n.d(t,{A:()=>isNewResource,g:()=>i});const i="new";function isNewResource(e){return!e.id||e.id===i}},32147:(e,t,n)=>{"use strict";function isPersistedResource(e){return!(!e.id||"new"===e.id)}n.d(t,{A:()=>isPersistedResource})},10304:(e,t,n)=>{"use strict";n.d(t,{S:()=>OpenProjectHeaderInterceptor,e:()=>o});var i=n(68559);const o="X-External-Request";class OpenProjectHeaderInterceptor{intercept(e,t){return"true"!==e.headers.get(o)?this.handleAuthenticatedRequest(e,t):this.handleExternalRequest(e,t)}handleExternalRequest(e,t){const n=e.clone({withCredentials:!1,headers:e.headers.delete(o)});return t.handle(n)}handleAuthenticatedRequest(e,t){const n=jQuery("meta[name=csrf-token]").attr("content");let i=e.headers.set("X-Authentication-Scheme","Session").set("X-Requested-With","XMLHttpRequest");n&&(i=i.set("X-CSRF-TOKEN",n));const o=e.clone({withCredentials:!0,headers:i});return t.handle(o)}static{this.ɵfac=function OpenProjectHeaderInterceptor_Factory(e){return new(e||OpenProjectHeaderInterceptor)}}static{this.ɵprov=i.jDH({token:OpenProjectHeaderInterceptor,factory:OpenProjectHeaderInterceptor.ɵfac})}}},7014:(e,t,n)=>{"use strict";n.d(t,{$:()=>OpenprojectHalModule});var i=n(68559),o=n(60316),r=n(61816),s=n(27514),a=n(57223),l=n(16169),c=n(30501);class HalAwareErrorHandler extends i.zcH{constructor(e){super(),this.I18n=e,this.text={internal_error:this.I18n.t("js.error.internal")}}handleError(e){let t=this.text.internal_error;e?.rejection instanceof l.i?this.handleError(e.rejection):(e instanceof l.i?(console.error("Returned HTTP HAL error resource %O",e.message),t=e.httpError?.status>=500?`${t} ${e.message}`:e.message,HalAwareErrorHandler.captureError(e.httpError)):e instanceof a.DX?(console.error("Returned error resource %O",e),t+=` ${e.errorMessages.join("\n")}`):e instanceof s.q?(console.error("Returned hal resource %O",e),t+=`Resource returned ${e.name}`):e instanceof Error?window.ErrorReporter.captureException(e):e instanceof c.yz?(HalAwareErrorHandler.captureError(e),t=e.message):"string"==typeof e&&(window.ErrorReporter.captureMessage(e),t=e),super.handleError(t))}static captureError(e){window.ErrorReporter.captureException(e)}static{this.ɵfac=function HalAwareErrorHandler_Factory(e){return new(e||HalAwareErrorHandler)(i.KVO(r.W))}}static{this.ɵprov=i.jDH({token:HalAwareErrorHandler,factory:HalAwareErrorHandler.ɵfac})}}var p=n(68643),d=n(6758),u=n(23863),h=n(20045),m=n(20009),g=n(71138);class WikiPageBaseResource extends s.q{}const f=(0,g.o)(WikiPageBaseResource);class MeetingContentBaseResource extends s.q{constructor(){super(...arguments),this.attachmentsBackend=!1}}const b=(0,g.o)(MeetingContentBaseResource);class PostBaseResource extends s.q{constructor(){super(...arguments),this.attachmentsBackend=!1}}const k=(0,g.o)(PostBaseResource);var v=n(48241),C=n(7017),y=n(81704),w=n(80923);class TimeEntryResource extends s.q{get state(){return this.states.timeEntries.get(this.id)}$linkableKeys(){return _.without(super.$linkableKeys(),"schema")}}class NewsResource extends s.q{}var T=n(65193);class MembershipResource extends s.q{}var S=n(74803),j=n(86198);class GroupResource extends s.q{}class RootResource extends s.q{}class TypeResource extends s.q{get state(){return this.states.types.get(this.href)}}var P=n(12313);class QueryOperatorResource extends s.q{get id(){return this.$source.id||(0,P.A)(this.href)}set id(e){this.$source.id=e}}var I=n(87636);class FormResource extends s.q{getErrors(){const e=_.values(this.validationErrors),t=e.length;if(0===t)return null;let n;return 1===t?n=new a.DX(this.injector,e[0],!0,this.halInitializer,"Error"):(n=new a.DX(this.injector,{},!0,this.halInitializer,"Error"),n.errorIdentifier=a.ys,n.errors=e),n.isValidationError=!0,n}}class HelpTextBaseResource extends s.q{}const x=(0,g.o)(HelpTextBaseResource);var R=n(60490);class SchemaDependencyResource extends s.q{forValue(e){return this.dependencies[e]}}class QueryFilterInstanceSchemaResource extends R.Y{constructor(){super(...arguments),this.type="QueryFilterInstanceSchema"}get availableOperators(){return this.operator.allowedValues}get allowedFilterValue(){return this.filter.allowedValues instanceof u.L?this.filter.allowedValues.elements[0]:this.filter.allowedValues[0]}$initialize(e){super.$initialize(e),e._dependencies&&(this.dependency=new SchemaDependencyResource(this.injector,e._dependencies[0],!0,this.halInitializer,"SchemaDependency"))}getFilter(){const e=this.operator.allowedValues[0],t=this.filter.allowedValues[0],n={name:t.name,_links:{filter:t.$source._links.self,schema:this.$source._links.self,operator:e.$source._links.self}};return this.definesAllowedValues()?n._links.values=[]:n.values=[],new I.Q(this.injector,n,!0,this.halInitializer,"QueryFilterInstance")}isValueRequired(){return!!this.values}isResourceValue(){return!(!this.values||!this.values.allowedValues)}loadedAllowedValues(){return Array.isArray(this.values?.allowedValues)}resultingSchema(e){const t=this.$source,n=this.dependency.forValue(e.href.toString()),i={};return _.merge(i,t,n),new QueryFilterInstanceSchemaResource(this.injector,i,!0,this.halInitializer,"QueryFilterInstanceSchema")}definesAllowedValues(){return _.some(this._dependencies[0].dependencies,(e=>e.values&&e.values._links&&e.values._links.allowedValues))}}class WorkPackageCollectionResource extends u.L{}var F=n(3575),M=n(97964);class MeetingBaseResource extends s.q{}const O=(0,g.o)(MeetingBaseResource),D={WorkPackage:{cls:p.Q,attrTypes:{parent:"WorkPackage",ancestors:"WorkPackage",children:"WorkPackage",relations:"Relation",schema:"Schema",status:"Status",type:"Type"}},Activity:{cls:s.q,attrTypes:{user:"User"}},"Activity::Comment":{cls:s.q,attrTypes:{user:"User"}},"Activity::Revision":{cls:s.q,attrTypes:{user:"User"}},Relation:{cls:F.H,attrTypes:{from:"WorkPackage",to:"WorkPackage"}},Schema:{cls:R.Y},Type:{cls:TypeResource},Status:{cls:v.b},SchemaDependency:{cls:SchemaDependencyResource},Error:{cls:a.DX},User:{cls:d.W},Group:{cls:GroupResource},Collection:{cls:u.L},WorkPackageCollection:{cls:WorkPackageCollectionResource},AttachmentCollection:{cls:C.U},Query:{cls:h.X,attrTypes:{filters:"QueryFilterInstance"}},Form:{cls:FormResource,attrTypes:{payload:"FormPayload"}},FormPayload:{cls:s.q,attrTypes:{attachments:"AttachmentsCollection"}},QueryFilterInstance:{cls:I.Q,attrTypes:{schema:"QueryFilterInstanceSchema",filter:"QueryFilter",operator:"QueryOperator"}},QueryFilterInstanceSchema:{cls:QueryFilterInstanceSchemaResource},QueryFilter:{cls:M.x},Root:{cls:RootResource},QueryOperator:{cls:QueryOperatorResource},HelpText:{cls:x},CustomAction:{cls:m.Q},WikiPage:{cls:f},Meeting:{cls:O},MeetingContent:{cls:b},Post:{cls:k},Project:{cls:j.i},Role:{cls:S.d},Grid:{cls:w.Z},GridWidget:{cls:y.$},TimeEntry:{cls:TimeEntryResource},Membership:{cls:MembershipResource},News:{cls:NewsResource},Version:{cls:T.b}};function initializeHalResourceConfig(e){return()=>{_.each(D,((t,n)=>e.registerResource(n,t)))}}var G=n(36178),E=n(40358);class OpenprojectHalModule{static{this.ɵfac=function OpenprojectHalModule_Factory(e){return new(e||OpenprojectHalModule)}}static{this.ɵmod=i.$C({type:OpenprojectHalModule})}static{this.ɵinj=i.G2t({providers:[{provide:i.zcH,useClass:HalAwareErrorHandler},{provide:i.hnV,useFactory:initializeHalResourceConfig,deps:[G.t],multi:!0},E.Y],imports:[o.MD]})}}("undefined"==typeof ngJitMode||ngJitMode)&&i.Obh(OpenprojectHalModule,{imports:[o.MD]})},7017:(e,t,n)=>{"use strict";n.d(t,{U:()=>AttachmentCollectionResource});var i=n(23863);class AttachmentCollectionResource extends i.L{$initialize(e){super.$initialize(e),this.elements=this.elements||[]}}},23863:(e,t,n)=>{"use strict";n.d(t,{L:()=>CollectionResource});var i=n(27514);class CollectionResource extends i.q{updateElements(){return this.href?this.$load().then((e=>this.elements=e.elements)):Promise.resolve()}}},20009:(e,t,n)=>{"use strict";n.d(t,{Q:()=>CustomActionResource});var i=n(27514);class CustomActionResource extends i.q{}},57223:(e,t,n)=>{"use strict";n.d(t,{DX:()=>ErrorResource,Rj:()=>s,XH:()=>r,cd:()=>isHalError,ys:()=>o});var i=n(27514);const o="urn:openproject-org:api:v3:errors:MultipleErrors",r="urn:openproject-org:api:v3:errors:OutboundRequest:Forbidden",s="urn:openproject-org:api:v3:errors:MissingEnterpriseToken";function isHalError(e){const hasOwn=t=>Object.prototype.hasOwnProperty.call(e,t);return!!e&&hasOwn("_type")&&hasOwn("message")&&hasOwn("errorIdentifier")}class ErrorResource extends i.q{constructor(){super(...arguments),this.isValidationError=!1}toString(){return`[ErrorResource ${this.message}]`}get errorMessages(){return this.isMultiErrorMessage()?this.errors.map((e=>e.message)):[this.message]}isMultiErrorMessage(){return this.errorIdentifier===o}getInvolvedAttributes(){let e=[];return this.details?e=[{details:this.details}]:this.errors&&(e=this.errors),_.flatten(e.map((e=>e.errorIdentifier===o?this.extractMultiError(e)[0]:e.details.attribute)))}getMessagesPerAttribute(){const e={};return this.details?e[this.details.attribute]=[this.message]:_.forEach(this.errors,(t=>{if(t.errorIdentifier===o){const[n,i]=this.extractMultiError(t),o=e[n]||[];e[n]=o.concat(i)}else e[t.details.attribute]?e[t.details.attribute].push(t.message):e[t.details.attribute]=[t.message]})),e}extractMultiError(e){const{attribute:t}=e.errors[0].details;return[t,e.errors.map((e=>e.message))]}}},80923:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(89204),o=n(27514),r=n(81704),s=n(71138);class GridBaseResource extends o.q{constructor(){super(...arguments),this.attachmentsBackend=!0}$initialize(e){super.$initialize(e),this.widgets=this.widgets.map((e=>{const t=new r.$(this.injector,e,!0,this.halInitializer,"GridWidget");return t.grid=this,t}))}updateAttachments(){var e=this;return(0,i.A)((function*(){return e.attachments.$update().then((()=>(e.states.forResource(e).putValue(e),e.attachments)))}))()}}const a=(0,s.o)(GridBaseResource)},81704:(e,t,n)=>{"use strict";n.d(t,{$:()=>GridWidgetResource});var i=n(24398),o=n(27514),r=n(1758),s=n(36178);class GridWidgetResource extends o.q{get height(){return this.endRow-this.startRow}get width(){return this.endColumn-this.startColumn}get schema(){return this.halResource.createHalResource({_type:"Schema"},!0)}}(0,i.Cg)([(0,r.O)(),(0,i.Sn)("design:type",s.t)],GridWidgetResource.prototype,"halResource",void 0)},27514:(e,t,n)=>{"use strict";n.d(t,{q:()=>HalResource});var i=n(24398),o=n(13432),r=n(61816),s=n(1758),a=n(12313),l=n(97366);class HalResource{constructor(e,t,n,i,o){this.injector=e,this.$source=t,this.$loaded=n,this.halInitializer=i,this.$links={},this.$embedded={},this.$halType=o,this.$initialize(t)}static getEmptyResource(e={href:null}){return{_links:{self:e}}}static matchFromLink(e,t){const n=new RegExp(`/api/v3/${t}/(\\d+)`).exec(e);return n&&n[1]}$initialize(e){this.$source=e.$source||e,this.halInitializer(this)}toString(){return this.href?`[HalResource href=${this.href}]`:`[HalResource id=${this.id}]`}get id(){if(this.$source.id)return this.$source.id.toString();const e=(0,a.A)(this.href);return/^\d+$/.exec(e)?e:null}set id(e){this.$source.id=e}retainFrom(e){this.__initialized_at=e.__initialized_at}$copy(e={}){return new(0,this.constructor)(this.injector,_.merge(this.$plain(),e),this.$loaded,this.halInitializer,this.$halType)}$plain(){return _.cloneDeep(this.$source)}get $isHal(){return!0}get $link(){return this.$links.self.$link}get name(){return this._name||this.$link.title||""}set name(e){this._name=e}get href(){return this.$link.href}get state(){return null}push(e){return this.state&&this.state.putValue(e),Promise.resolve()}previewPath(){if((0,l.A)(this)&&this.project)return this.project.href}getEditorContext(e){return{type:"constrained"}}$load(e=!1){if(!this.state)return this.$loadResource(e);const{state:t}=this;return e&&t.clear(),t.putFromPromiseIfPristine((()=>this.$loadResource(e))),t.valuesPromise().then((e=>(this.$initialize(e),this.$loaded=!0,this)))}$loadResource(e=!1){if(!e){if(this.$loaded)return Promise.resolve(this);if(!this.$loaded&&this.$self)return this.$self}return this.$loaded=!1,this.$self=this.$links.self({}).then((e=>(this.$loaded=!0,this.$initialize(e.$source),this))),this.$self}$update(){return this.$load(!0)}$embeddableKeys(){const e=Object.keys(this.$source);return _.without(e,"_links","_embedded","id")}$linkableKeys(){const e=Object.keys(this.$links);return _.without(e,"self")}}(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",o.D)],HalResource.prototype,"states",void 0),(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",r.W)],HalResource.prototype,"I18n",void 0)},71138:(e,t,n)=>{"use strict";n.d(t,{o:()=>Attachable});var i=n(7017),o=n(97366);function Attachable(e){return class extends e{get canAddAttachments(){return!!this.$links.addAttachment||(0,o.A)(this)}lookupDownloadLocationByName(e){if(!this.attachments||!this.attachments.elements)return null;const t=this.attachments.elements.find((t=>t.name===e));return t?t.staticDownloadLocation?.href:null}$initialize(e){super.$initialize(e);const t=this.attachments||{$source:{},elements:[]};this.attachments=new i.U(this.injector,t,!1,this.halInitializer,"HalResource")}}}},86198:(e,t,n)=>{"use strict";n.d(t,{i:()=>ProjectResource});var i=n(27514);class ProjectResource extends i.q{get state(){return this.states.projects.get(this.id)}getEditorContext(e){return-1!==["statusExplanation","description"].indexOf(e)?{type:"full",macros:"resource"}:{type:"constrained"}}$linkableKeys(){return _.without(super.$linkableKeys(),"schema")}}},87636:(e,t,n)=>{"use strict";n.d(t,{Q:()=>QueryFilterInstanceResource});var i=n(24398),o=n(1758),r=n(44674),s=n(73014),a=n(27514),l=n(12313);class QueryFilterInstanceResource extends a.q{constructor(){super(...arguments),this.memoizedCurrentSchemas={}}$initialize(e){super.$initialize(e),this.$links.schema={href:`${this.pathHelper.api.v3.apiV3Base}/queries/filter_instance_schemas/${(0,l.A)(this.filter.href)}`}}get id(){return this.filter.id}get name(){return this.filter.name}get currentSchema(){if(!this.operator)return null;const e=this.operator.href.toString();if(void 0===this.memoizedCurrentSchemas[e])try{this.memoizedCurrentSchemas[e]=this.schemaCache.of(this).resultingSchema(this.operator)}catch(e){console.error(`Failed to access filter schema${e}`)}return this.memoizedCurrentSchemas[e]}isCompletelyDefined(){return this.values.length||this.currentSchema&&!this.currentSchema.isValueRequired()}findOperator(e){return _.find(this.schemaCache.of(this).availableOperators,(t=>t.id===e))}isTemplated(){let e=!1;return this.values.find((t=>{const n=t?.href||t.toString()||"";e=n.includes("{id}")})),e}}(0,i.Cg)([(0,o.O)(r.D),(0,i.Sn)("design:type",r.D)],QueryFilterInstanceResource.prototype,"schemaCache",void 0),(0,i.Cg)([(0,o.O)(s.B),(0,i.Sn)("design:type",s.B)],QueryFilterInstanceResource.prototype,"pathHelper",void 0)},97964:(e,t,n)=>{"use strict";n.d(t,{x:()=>QueryFilterResource});var i=n(27514),o=n(12313);class QueryFilterResource extends i.q{get id(){return this.$source.id||(0,o.A)(this.href)}set id(e){this.$source.id=e}}},20045:(e,t,n)=>{"use strict";n.d(t,{X:()=>QueryResource});var i=n(27514),o=n(87636);class QueryResource extends i.q{setSortBy(e){this.sortBy=e}$initialize(e){super.$initialize(e),this.filters=this.filters.map((e=>new o.Q(this.injector,e,!0,this.halInitializer,"QueryFilterInstance")))}}},76008:(e,t,n)=>{"use strict";n.d(t,{cG:()=>i,yM:()=>o});n(27514);const i="urn:openproject-org:api:v3:queries:directions:asc",o="urn:openproject-org:api:v3:queries:directions:desc"},3575:(e,t,n)=>{"use strict";n.d(t,{H:()=>RelationResource});var i=n(27514),o=n(12313);class RelationResource extends i.q{static RELATION_TYPES(e=!0){const t=["relates","duplicates","duplicated","blocks","blocked","precedes","follows","includes","partof","requires","required"];return e&&t.push("parent","children"),t}static LOCALIZED_RELATION_TYPES(e=!0){return RelationResource.RELATION_TYPES(e).map((e=>({name:e,label:I18n.t(`js.relation_labels.${e}`)})))}static DEFAULT(){return"relates"}normalizedType(e){return this.denormalized(e).relationType}denormalized(e){const t=this.to.href===e.href?"from":"to";return{target:this[t],targetId:this[t].id,relationType:"from"===t?this.reverseType:this.type,reverseRelationType:"from"===t?this.type:this.reverseType}}isInvolved(e){return _.values(this.ids).indexOf(e.toString())>=0}get ids(){return{from:(0,o.A)(this.from.href),to:(0,o.A)(this.to.href)}}updateDescription(e){return this.$links.updateImmediately({description:e})}updateType(e){return this.$links.updateImmediately({type:e})}}},74803:(e,t,n)=>{"use strict";n.d(t,{d:()=>RoleResource});var i=n(27514);class RoleResource extends i.q{}},60490:(e,t,n)=>{"use strict";n.d(t,{Y:()=>SchemaResource});var i=n(27514);class SchemaResource extends i.q{get state(){return this.states.schemas.get(this.href)}get availableAttributes(){return _.keys(this.$source).filter((e=>0!==e.indexOf("_")))}attributeFromLocalizedName(e){let t=null;for(const n of this.availableAttributes){const i=this[n];if(i?.name===e){t=n;break}}return t}}},48241:(e,t,n)=>{"use strict";n.d(t,{b:()=>StatusResource});var i=n(27514);class StatusResource extends i.q{get state(){return this.states.statuses.get(this.href)}}},6758:(e,t,n)=>{"use strict";n.d(t,{W:()=>UserResource});var i=n(27514);class UserResource extends i.q{static get active_user_statuses(){return["active","registered"]}get state(){return this.states.users.get(this.href)}get showUserPath(){return this.showUser?this.showUser.$link.href:null}get isActive(){return UserResource.active_user_statuses.indexOf(this.status)>=0}}},65193:(e,t,n)=>{"use strict";n.d(t,{b:()=>VersionResource});var i=n(27514);class VersionResource extends i.q{isLocked(){return"locked"===this.status}isOpen(){return"open"===this.status}isClosed(){return"closed"===this.status}}},68643:(e,t,n)=>{"use strict";n.d(t,{Q:()=>f});var i=n(24398),o=n(61816),r=n(13432),s=n(73014),a=n(72650),l=n(17456),c=n(49349),p=n(1758),d=n(14593),u=n(7017),h=n(27514),m=n(71138),g=n(97366);class WorkPackageBaseResource extends h.q{constructor(){super(...arguments),this.attachmentsBackend=!0}getAncestors(){return this.ancestors||[]}get ancestorIds(){return this.getAncestors().map((e=>e.id.toString()))}subjectWithType(e=40){return`${this.type?`${this.type.name}: `:""}${this.subjectWithId(e)}`}subjectWithId(e=40){const t=(0,g.A)(this)?"":` (#${this.id||""})`;return`${e<=0?this.subject:_.truncate(this.subject,{length:e})}${t}`}get isLeaf(){const{children:e}=this.$links;return!(e&&e.length>0)}previewPath(){return(0,g.A)(this)?super.previewPath():this.apiV3Service.work_packages.id(this.id).path}getEditorContext(e){return{type:"description"===e?"full":"constrained",macros:!1,...e.startsWith("customField")&&{disabledMentions:["user"]}}}isParentOf(e){return e.parent?.$links.self.$link.href===this.$links.self.$link.href}updateLinkedResources(...e){const t={};e.forEach((e=>{const n=this[e];t[e]=n?n.$update():Promise.reject(void 0)}));const n=Promise.all(_.values(t));return n.then((()=>{this.wpCacheService.touch(this.id)})),n}$initialize(e){super.$initialize(e);const t=this.attachments||{$source:{},elements:[]};this.attachments=new u.U(this.injector,_.get(t,"$source",t),!1,this.halInitializer,"HalResource")}$linkableKeys(){return _.without(super.$linkableKeys(),"schema")}get state(){return this.states.workPackages.get(this.id)}push(e){return this.wpActivity.clear(e.id),e.parent&&this.apiV3Service.work_packages.id(e.parent).refresh(),this.apiV3Service.work_packages.cache.updateWorkPackage(e)}}(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",o.W)],WorkPackageBaseResource.prototype,"I18n",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",r.D)],WorkPackageBaseResource.prototype,"states",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",l.Z)],WorkPackageBaseResource.prototype,"wpActivity",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",d.n)],WorkPackageBaseResource.prototype,"apiV3Service",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",a.fw)],WorkPackageBaseResource.prototype,"ToastService",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",c.U)],WorkPackageBaseResource.prototype,"workPackageNotificationService",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",s.B)],WorkPackageBaseResource.prototype,"pathHelper",void 0);const f=(0,m.o)(WorkPackageBaseResource)},20001:(e,t,n)=>{"use strict";n.d(t,{y:()=>HalPayloadHelper});var i=n(27514);class HalPayloadHelper{static extractPayload(e,t=null){return e instanceof i.q&&t?this.extractPayloadFromSchema(e,t):!e||e instanceof i.q?{}:e}static extractPayloadFromSchema(e,t){const n={_links:{}},o=[];for(const i in t)t.hasOwnProperty(i)&&t[i]&&t[i].writable&&(e.$links[i]?Array.isArray(e[i])?n._links[i]=_.map(e[i],(e=>({href:e.href}))):n._links[i]={href:e[i]&&e[i].href}:o.push(i));return _.each(o,(t=>{(e.hasOwnProperty(t)||e[t])&&(Array.isArray(e[t])?n[t]=_.map(e[t],(e=>e instanceof i.q?this.extractPayloadFromSchema(e,e.currentSchema||e.schema):e)):n[t]=e[t])})),n}}},61039:(e,t,n)=>{"use strict";n.d(t,{K:()=>SchemaProxy});var i=n(97366);class SchemaProxy{constructor(e,t){this.schema=e,this.resource=t}static create(e,t){return new Proxy(e,new this(e,t))}get(e,t,n){switch(t){case"ofProperty":return this.proxyMethod(this.ofProperty);case"isAttributeEditable":return this.proxyMethod(this.isAttributeEditable);case"mappedName":return this.proxyMethod(this.mappedName);case"isEditable":return this.isEditable;default:return Reflect.get(e,t,n)}}ofProperty(e){const t=this.schema[this.mappedName(e)];return t?{...t,writable:this.isEditable&&t&&t.writable}:null}isAttributeEditable(e){const t=this.ofProperty(e);return!!t&&t.writable}get isEditable(){return(0,i.A)(this.resource)||!!this.resource.$links.update}mappedName(e){return e}proxyMethod(e){const t=this;return new Proxy(e,{apply:(n,i,o)=>e.apply(t,[o[0]])})}}},34760:(e,t,n)=>{"use strict";n.d(t,{T:()=>WorkPackageSchemaProxy});var i=n(61039);class WorkPackageSchemaProxy extends i.K{get(e,t,n){switch(t){case"isMilestone":return this.isMilestone;case"isReadonly":return this.isReadonly;default:return super.get(e,t,n)}}ofProperty(e){if("combinedDate"===e){const e=super.ofProperty("startDate");return e?(e.writable=e.writable||this.isAttributeEditable("dueDate")||this.isAttributeEditable("scheduleManually"),e):null}return super.ofProperty(e)}get isReadonly(){return this.resource.readonly||!!this.resource.status?.isReadonly}isAttributeEditable(e){return(!this.isReadonly||"status"===e)&&(["startDate","dueDate","date"].includes(e)&&this.resource.scheduleManually?super.isAttributeEditable("scheduleManually"):super.isAttributeEditable(e))}get isMilestone(){return this.schema.hasOwnProperty("date")}mappedName(e){return!this.isMilestone||"startDate"!==e&&"dueDate"!==e?e:"date"}}},16169:(e,t,n)=>{"use strict";n.d(t,{i:()=>HalError});class HalError extends Error{get message(){return this.resource?.message||this.httpError?.message||"Unknown error"}get errorIdentifier(){return this.resource?.errorIdentifier||"unknown"}constructor(e,t){super(),this.httpError=e,this.resource=t,this.name="HALError",Object.setPrototypeOf(this,HalError.prototype)}}},91691:(e,t,n)=>{"use strict";n.d(t,{o:()=>HalEventsService});var i=n(84205),o=n(51567),r=n(68799),s=n(52575),a=n(68559);class HalEventsService{constructor(){this._events=new i.B,this.events$=this._events.asObservable()}aggregated$(e,t=500){return this.events$.pipe((0,o.p)((t=>t.resourceType===e)),(0,r.r)(this.events$.pipe((0,s.B)(t))))}push(e,t){t.id=e.id,t.resourceType=e._type,this._events.next(t)}static{this.ɵfac=function HalEventsService_Factory(e){return new(e||HalEventsService)}}static{this.ɵprov=a.jDH({token:HalEventsService,factory:HalEventsService.ɵfac,providedIn:"root"})}}},40358:(e,t,n)=>{"use strict";n.d(t,{Y:()=>HalResourceNotificationService});var i=n(24398),o=n(83093),r=n(36178),s=n(80366),a=n(72650),l=n(61816),c=n(30501),p=n(27514),d=n(1758),u=n(44674),h=n(57223),m=n(16169),g=n(68559);class HalResourceNotificationService{constructor(e){this.injector=e}showSave(e,t=!1){const n={message:this.I18n.t("js.notice_successful_"+(t?"create":"update"))};this.ToastService.addSuccess(n)}handleRawError(e,t){if(console.error("Handling error message %O for work package %O",e,t),e instanceof m.i&&t)return this.handleErrorResponse(e.resource,t);const n=this.retrieveError(e);if(n instanceof p.q)return this.handleErrorResponse(n,t);"string"!=typeof e?e instanceof Error?this.ToastService.addError(e.message):this.showGeneralError(n||e):this.ToastService.addError(e)}retrieveErrorMessage(e){const t=this.retrieveError(e);return t instanceof h.DX||t instanceof m.i?t.message:"string"==typeof t?t:this.I18n.t("js.error.internal")}retrieveError(e){let t=e;return e instanceof c.yz&&(t=e.message||e.error),"Error"===_.get(e,"data._type")&&(t=e.data),t&&"Error"===t._type?this.halResourceService.createHalResourceOfClass(h.DX,t):t}handleErrorResponse(e,t){return e instanceof m.i&&t?this.showError(e.resource,t):e instanceof h.DX?t?this.showError(e,t):this.showApiErrorMessages(e):this.showGeneralError(e)}showError(e,t){this.showCustomError(e,t)||this.showApiErrorMessages(e)}showGeneralError(e){let t=this.I18n.t("js.error.internal");("string"==typeof e||_.has(e,"toString"))&&(t+=` ${e.toString()}`),this.ToastService.addError(t)}showEditingBlockedError(e){this.ToastService.addError(this.I18n.t("js.hal.error.edit_prohibited",{attribute:e}))}showCustomError(e,t){if("urn:openproject-org:api:v3:errors:PropertyFormatError"===e.errorIdentifier){const n=this.schemaCache.of(t).ofProperty(e.details.attribute),i=n.name,o=`js.hal.error.format.${n.type.toLowerCase()}`;return"[not found]"!==this.I18n.t(o,{default:"[not found]"})&&(this.ToastService.addError(this.I18n.t(o,{attribute:i})),!0)}return!1}showApiErrorMessages(e){const t=e.errorMessages;return t.length>1?this.ToastService.addError("",t):this.ToastService.addError(t[0]),!0}static{this.ɵfac=function HalResourceNotificationService_Factory(e){return new(e||HalResourceNotificationService)(g.KVO(g.zZn))}}static{this.ɵprov=g.jDH({token:HalResourceNotificationService,factory:HalResourceNotificationService.ɵfac})}}(0,i.Cg)([(0,d.O)(),(0,i.Sn)("design:type",l.W)],HalResourceNotificationService.prototype,"I18n",void 0),(0,i.Cg)([(0,d.O)(),(0,i.Sn)("design:type",o.dw)],HalResourceNotificationService.prototype,"$state",void 0),(0,i.Cg)([(0,d.O)(),(0,i.Sn)("design:type",r.t)],HalResourceNotificationService.prototype,"halResourceService",void 0),(0,i.Cg)([(0,d.O)(),(0,i.Sn)("design:type",a.fw)],HalResourceNotificationService.prototype,"ToastService",void 0),(0,i.Cg)([(0,d.O)(),(0,i.Sn)("design:type",s.FX)],HalResourceNotificationService.prototype,"loadingIndicator",void 0),(0,i.Cg)([(0,d.O)(),(0,i.Sn)("design:type",u.D)],HalResourceNotificationService.prototype,"schemaCache",void 0)},72355:(e,t,n)=>{"use strict";n.d(t,{X:()=>HalResourceSortingService});var i=n(68559);class HalResourceSortingService{constructor(){this.config={user:"name",project:"name"}}sort(e,t){if(0===e.length)return e;const n=t||e[0]._type;if(!n)return e;const i=this.sortingProperty(n);return i?_.sortBy(e,(e=>e[i].toLowerCase())):e}sortingProperty(e){return e=e.toLowerCase().replace(/^\[\]/,""),this.config[e]}hasSortingProperty(e){return void 0!==this.sortingProperty(e)}static{this.ɵfac=function HalResourceSortingService_Factory(e){return new(e||HalResourceSortingService)}}static{this.ɵprov=i.jDH({token:HalResourceSortingService,factory:HalResourceSortingService.ɵfac,providedIn:"root"})}}},36178:(e,t,n)=>{"use strict";n.d(t,{t:()=>HalResourceService});var i=n(30501),o=n(70271),r=n(61318),s=n(77919),a=n(41465),l=n(33398),c=n(36819),p=n(31635),d=n(50248),u=n(27514),h=n(10267),m=n(16169),g=n(96027),f=n(68559);class HalResourceService{constructor(e,t){this.injector=e,this.http=t,this.config={}}request(e,t,n,i={}){if("get"===e)return this.get(t,n,i);const o={body:n||{},headers:i,withCredentials:!0,responseType:"json"};return this.performRequest(e,t,o)}performRequest(e,t,n){return this.http.request(e,t,n).pipe((0,o.T)((e=>this.createHalResource(e))),(0,r.W)((n=>((0,c.bw)((()=>console.error(`Failed to ${e} ${t}: ${n.name}`))),this.createErrorObservable(n)))))}get(e,t,n){const o={headers:n,params:new i.Nl({encoder:new d.Y,fromObject:t}),withCredentials:!0,responseType:"json"};return this.performRequest("get",e,o)}getAllPaginated(e,t={},n={}){return(0,g.ro)((i=>{const o={...t,...i};return this.request("get",e,this.toEprops(o),n)}),t.pageSize||-1)}put(e,t,n){return this.request("put",e,t,n)}post(e,t,n){return this.request("post",e,t,n)}patch(e,t,n){return this.request("patch",e,t,n)}delete(e,t,n){return this.request("delete",e,t,n)}registerResource(e,t){this.config[e]=t}get defaultClass(){return u.q}createHalResource(e,t=!0){_.isNil(e)&&(e=u.q.getEmptyResource());const n=e._type||"HalResource";return this.createHalResourceOfType(n,e,t)}createHalResourceOfType(e,t,n=!1){return new(this.getResourceClassOfType(e))(this.injector,t,n,(e=>(0,h.zh)(this,e)),e)}createHalResourceOfClass(e,t,n=!1){const i=t._type||"HalResource";return new e(this.injector,t,n,(e=>(0,h.zh)(this,e)),i)}fromLink(e){const t=u.q.getEmptyResource(p.I.fromObject(this,e));return this.createHalResource(t,!1)}fromSelfLink(e){const t={_links:{self:{href:e}}};return this.createHalResource(t)}createLinkedResource(e,t,n){const i=u.q.getEmptyResource(),o=e.$halType,r=this.getResourceClassOfAttribute(o,t)||"HalResource";return i._links.self=n,this.createHalResourceOfType(r,i,!1)}getResourceClassOfType(e){const t=this.config[e];return t&&t.cls?t.cls:this.defaultClass}getResourceClassOfAttribute(e,t){const n=this.config[e];return(n&&n.attrTypes||{})[t]}toEprops(e){const t=a.Kc(JSON.stringify(e));return{eprops:l.if(t)}}createErrorObservable(e){let t=null;const n=e.error;return"object"==typeof n&&n?._type&&(t=this.createHalResource(e.error)),(0,s.$)(new m.i(e,t))}static{this.ɵfac=function HalResourceService_Factory(e){return new(e||HalResourceService)(f.KVO(f.zZn),f.KVO(i.Qq))}}static{this.ɵprov=f.jDH({token:HalResourceService,factory:HalResourceService.ɵfac,providedIn:"root"})}}},50248:(e,t,n)=>{"use strict";n.d(t,{Y:()=>URLParamsEncoder});class URLParamsEncoder{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}},98157:(e,t,n)=>{"use strict";n.d(t,{t:()=>HomescreenNewFeaturesBlockComponent});var i=n(61816),o=n(65277),r=n(68559),s=n(80436);const a="15_2",l=`${a}_features.svg`;class HomescreenNewFeaturesBlockComponent{constructor(e,t){this.i18n=e,this.domSanitizer=t,this.hasBimChanges=!1,this.new_features_image=(0,o.d)(l),this.text={newFeatures:this.i18n.t("js.label_new_features"),descriptionNewFeatures:this.i18n.t("js.homescreen.blocks.new_features.text_new_features"),learnAbout:this.i18n.t("js.homescreen.blocks.new_features.learn_about")},this.isStandardEdition=window.OpenProject.isStandardEdition}get teaserWebsiteUrl(){return this.domSanitizer.bypassSecurityTrustResourceUrl("https://www.openproject.org/docs/release-notes")}get currentNewFeatureHtml(){return this.translated("new_features_html")}get translatedEdition(){return this.hasBimChanges&&!this.isStandardEdition?"bim":"standard"}translated(e){return this.i18n.t(`js.homescreen.blocks.new_features.${a}.${this.translatedEdition}.${e}`,{list_styling_class:"widget-box--arrow-links",bcf_api_link:"https://github.com/opf/openproject/blob/dev/docs/api/bcf/bcf-rest-api.md"})}static{this.ɵfac=function HomescreenNewFeaturesBlockComponent_Factory(e){return new(e||HomescreenNewFeaturesBlockComponent)(r.rXU(i.W),r.rXU(s.up))}}static{this.ɵcmp=r.VBU({type:HomescreenNewFeaturesBlockComponent,selectors:[["opce-homescreen-new-features-block"]],decls:8,vars:5,consts:[[1,"op-new-features"],[1,"widget-box--additional-info"],[1,"widget-box--description"],[3,"innerHtml"],["role","presentation",1,"widget-box--teaser-image","op-new-features--teaser-image",3,"src"],["target","_blank",3,"href"]],template:function HomescreenNewFeaturesBlockComponent_Template(e,t){1&e&&(r.j41(0,"div",0)(1,"p",1),r.EFF(2),r.k0s(),r.j41(3,"div",2),r.nrm(4,"p",3)(5,"img",4),r.k0s(),r.j41(6,"a",5),r.EFF(7),r.k0s()()),2&e&&(r.R7$(2),r.SpI(" ",t.text.descriptionNewFeatures," "),r.R7$(2),r.Y8G("innerHtml",t.currentNewFeatureHtml,r.npT),r.R7$(),r.Y8G("src",t.new_features_image,r.B4B),r.R7$(),r.Y8G("href",t.teaserWebsiteUrl,r.B4B),r.R7$(),r.JRh(t.text.learnAbout))},styles:[".op-new-features--teaser-image[_ngcontent-%COMP%]{background-image:var(--new-feature-teaser-image);min-width:170px;background-size:contain;background-repeat:no-repeat;background-position-x:right}"],changeDetection:0})}}},15980:(e,t,n)=>{"use strict";n.d(t,{n:()=>k});var i=n(24398),o=n(47470),r=n(70271),s=n(98764),a=n(61318),l=n(59400),c=n(21567),p=n(87392),d=n(5057),u=n(51567),h=n(57678);class IanBellQuery extends h.XK{constructor(e){super(e),this.store=e,this.unread$=this.select("totalUnread"),this.unreadCountChanged$=this.unread$.pipe((0,d.J)(),(0,u.p)((([e,t])=>t!==e)),(0,r.T)((([,e])=>e))),this.unreadCountIncreased$=this.unread$.pipe((0,d.J)(),(0,u.p)((([e,t])=>t>e)),(0,r.T)((([,e])=>e)))}}var m=n(86748),g=n(17270),_=n(94564);let f=class IanBellStore extends h.il{constructor(){super({totalUnread:0})}};f=(0,i.Cg)([(0,h.g7)({name:"ian-bell"}),(0,i.Sn)("design:paramtypes",[])],f);var b=n(68559);let k=class IanBellService{constructor(e,t){this.actions$=e,this.resourceService=t,this.id="ian-bell",this.store=new f,this.query=new IanBellQuery(this.store),this.unread$=this.query.unread$,this.query.unreadCountChanged$.subscribe((e=>{this.actions$.dispatch((0,g.$s)({origin:this.id,count:e}))})),this.query.unreadCountIncreased$.pipe((0,o.i)(1)).subscribe((e=>{this.actions$.dispatch((0,g.Z9)({origin:this.id,count:e}))}))}fetchUnread(){return this.resourceService.fetchCollection({filters:p.Zp.unread,pageSize:0},{handleErrors:!1}).pipe((0,r.T)((e=>e.total)),(0,s.M)((e=>{this.store.update({totalUnread:e})}),(e=>{console.error("Failed to load notifications: %O",e),this.store.update({totalUnread:-1})})),(0,a.W)((()=>l.w)))}reloadOnNotificationRead(e){e.all?this.fetchUnread().subscribe():this.store.update((({totalUnread:t})=>({totalUnread:t-e.notifications.length})))}static{this.ɵfac=function IanBellService_Factory(e){return new(e||IanBellService)(b.KVO(_.d),b.KVO(c.u))}}static{this.ɵprov=b.jDH({token:IanBellService,factory:IanBellService.ɵfac,providedIn:"root"})}};(0,i.Cg)([(0,m.xP)(g.jo),(0,i.Sn)("design:type",Function),(0,i.Sn)("design:paramtypes",[void 0]),(0,i.Sn)("design:returntype",void 0)],k.prototype,"reloadOnNotificationRead",null),k=(0,i.Cg)([m.qm,(0,i.Sn)("design:paramtypes",[_.d,c.u])],k)},87392:(e,t,n)=>{"use strict";n.d(t,{Zp:()=>s,zY:()=>a});var i=n(24398),o=n(57678),r=n(15999);const s={unread:[["readIAN","=",!1]],all:[]};let a=class IanCenterStore extends o.il{constructor(){super(function createInitialState(){return{params:{pageSize:r.y,page:1},filters:{},activeCollection:{ids:[]},activeFacet:"unread",notLoaded:0}}())}};a=(0,i.Cg)([(0,o.g7)({name:"ian-center"}),(0,i.Sn)("design:paramtypes",[])],a)},28890:(e,t,n)=>{"use strict";n.d(t,{Y:()=>InviteUserButtonComponent});var i=n(63894),o=n(61816),r=n(86866),s=n(54182),a=n(46303),l=n(68559),c=n(60316),p=n(46765);function InviteUserButtonComponent_button_0_Template(e,t){if(1&e){const e=l.RV6();l.j41(0,"button",1),l.bIt("click",(function InviteUserButtonComponent_button_0_Template_button_click_0_listener(t){l.eBV(e);const n=l.XpG();return l.Njj(n.onAddNewClick(t))})),l.j41(1,"span",2),l.nrm(2,"op-icon",3),l.EFF(3),l.k0s()()}if(2&e){const e=l.XpG();l.R7$(3),l.SpI(" ",e.text.button," ")}}class InviteUserButtonComponent{constructor(e,t,n,i,o){this.I18n=e,this.opInviteUserModalService=t,this.currentProjectService=n,this.currentUserService=i,this.autocompleter=o,this.text={button:this.I18n.t("js.invite_user_modal.invite")}}ngOnInit(){this.projectId=this.projectId||this.currentProjectService.id,this.canInviteUsersToProject$=this.currentUserService.hasCapabilities$("memberships/create",this.projectId||null)}onAddNewClick(e){e.stopPropagation(),this.opInviteUserModalService.open(this.projectId),this.autocompleter.closeSelect()}static{this.ɵfac=function InviteUserButtonComponent_Factory(e){return new(e||InviteUserButtonComponent)(l.rXU(o.W),l.rXU(s.Q),l.rXU(r.c),l.rXU(i.K),l.rXU(a.T))}}static{this.ɵcmp=l.VBU({type:InviteUserButtonComponent,selectors:[["op-invite-user-button"]],inputs:{projectId:"projectId"},decls:2,vars:3,consts:[["class","op-select-footer--label","type","button",3,"click",4,"ngIf"],["type","button",1,"op-select-footer--label",3,"click"],[1,"icon-context"],["icon-classes","icon-user-plus icon-context"]],template:function InviteUserButtonComponent_Template(e,t){1&e&&(l.DNE(0,InviteUserButtonComponent_button_0_Template,4,1,"button",0),l.nI1(1,"async")),2&e&&l.Y8G("ngIf",l.bMT(1,1,t.canInviteUsersToProject$))},dependencies:[c.bT,p.i,c.Jj]})}}},98637:(e,t,n)=>{"use strict";n.d(t,{t:()=>InviteUserButtonModule});var i=n(60316),o=n(28890),r=n(17136),s=n(68559);class InviteUserButtonModule{static{this.ɵfac=function InviteUserButtonModule_Factory(e){return new(e||InviteUserButtonModule)}}static{this.ɵmod=s.$C({type:InviteUserButtonModule})}static{this.ɵinj=s.G2t({imports:[i.MD,r.o]})}}("undefined"==typeof ngJitMode||ngJitMode)&&s.Obh(InviteUserButtonModule,{declarations:[o.Y],imports:[i.MD,r.o],exports:[o.Y]})},54182:(e,t,n)=>{"use strict";n.d(t,{Q:()=>OpInviteUserModalService});var i=n(68559),o=n(86866),r=n(51133),s=n(8790);class OpInviteUserModalService{constructor(e,t){this.opModalService=e,this.currentProjectService=t,this.close=new i.bkB}open(e=this.currentProjectService.id){this.opModalService.show(s.X,"global",{projectId:e}).subscribe((e=>e.closingEvent.subscribe((e=>{this.close.emit(e.data)}))))}static{this.ɵfac=function OpInviteUserModalService_Factory(e){return new(e||OpInviteUserModalService)(i.KVO(r.a),i.KVO(o.c))}}static{this.ɵprov=i.jDH({token:OpInviteUserModalService,factory:OpInviteUserModalService.ɵfac})}}},8790:(e,t,n)=>{"use strict";n.d(t,{J:()=>o,X:()=>InviteUserModalComponent});var i,o,r=n(69081),s=n(51133),a=n(14593),l=n(68559);function InviteUserModalComponent_div_0_Template(e,t){1&e&&l.nrm(0,"div",5)}function InviteUserModalComponent_op_ium_project_selection_1_Template(e,t){if(1&e){const e=l.RV6();l.j41(0,"op-ium-project-selection",6),l.bIt("save",(function InviteUserModalComponent_op_ium_project_selection_1_Template_op_ium_project_selection_save_0_listener(t){l.eBV(e);const n=l.XpG();return l.Njj(n.onProjectSelectionSave(t))}))("close",(function InviteUserModalComponent_op_ium_project_selection_1_Template_op_ium_project_selection_close_0_listener(){l.eBV(e);const t=l.XpG();return l.Njj(t.closeMe())})),l.k0s()}if(2&e){const e=l.XpG();l.Y8G("project",e.project)("type",e.type)("cdkTrapFocusAutoCapture",!0)}}function InviteUserModalComponent_op_ium_principal_2_Template(e,t){if(1&e){const e=l.RV6();l.j41(0,"op-ium-principal",7),l.bIt("save",(function InviteUserModalComponent_op_ium_principal_2_Template_op_ium_principal_save_0_listener(t){l.eBV(e);const n=l.XpG();return l.Njj(n.onPrincipalSave(t))}))("back",(function InviteUserModalComponent_op_ium_principal_2_Template_op_ium_principal_back_0_listener(){l.eBV(e);const t=l.XpG();return l.Njj(t.goTo(t.Steps.ProjectSelection))}))("close",(function InviteUserModalComponent_op_ium_principal_2_Template_op_ium_principal_close_0_listener(){l.eBV(e);const t=l.XpG();return l.Njj(t.closeMe())})),l.k0s()}if(2&e){const e=l.XpG();l.Y8G("project",e.project)("roleData",e.role)("messageData",e.message)("principalData",e.principalData)("type",e.type)("cdkTrapFocusAutoCapture",!0)}}function InviteUserModalComponent_op_ium_summary_3_Template(e,t){if(1&e){const e=l.RV6();l.j41(0,"op-ium-summary",8),l.bIt("save",(function InviteUserModalComponent_op_ium_summary_3_Template_op_ium_summary_save_0_listener(t){l.eBV(e);const n=l.XpG();return l.Njj(n.onSuccessfulSubmission(t))}))("back",(function InviteUserModalComponent_op_ium_summary_3_Template_op_ium_summary_back_0_listener(){l.eBV(e);const t=l.XpG();return l.Njj(t.goTo(t.Steps.Principal))}))("close",(function InviteUserModalComponent_op_ium_summary_3_Template_op_ium_summary_close_0_listener(){l.eBV(e);const t=l.XpG();return l.Njj(t.closeMe())})),l.k0s()}if(2&e){const e=l.XpG();l.Y8G("project",e.project)("principalData",e.principalData)("type",e.type)("role",e.role)("message",e.message)("cdkTrapFocusAutoCapture",!0)}}function InviteUserModalComponent_op_ium_success_4_Template(e,t){if(1&e){const e=l.RV6();l.j41(0,"op-ium-success",9),l.bIt("close",(function InviteUserModalComponent_op_ium_success_4_Template_op_ium_success_close_0_listener(){l.eBV(e);const t=l.XpG();return l.Njj(t.closeWithPrincipal())})),l.k0s()}if(2&e){const e=l.XpG();l.Y8G("principal",e.principalData.principal)("project",e.project)("type",e.type)("createdNewPrincipal",e.createdNewPrincipal)("cdkTrapFocusAutoCapture",!0)}}!function(e){e[e.ProjectSelection=0]="ProjectSelection",e[e.Principal=1]="Principal",e[e.Summary=2]="Summary",e[e.Success=3]="Success"}(i||(i={})),function(e){e.User="User",e.Placeholder="PlaceholderUser",e.Group="Group"}(o||(o={}));class InviteUserModalComponent extends r.a{get loading(){return this.locals.projectId&&!this.project}constructor(e,t,n,o){super(e,t,n),this.locals=e,this.cdRef=t,this.elementRef=n,this.apiV3Service=o,this.Steps=i,this.step=i.ProjectSelection,this.data=null,this.type=null,this.project=null,this.principalData={principal:null,customFields:{}},this.role=null,this.message="",this.createdNewPrincipal=!1}ngOnInit(){super.ngOnInit(),this.locals.projectId&&this.apiV3Service.projects.id(this.locals.projectId).get().subscribe((e=>{this.project=e,this.cdRef.markForCheck()}),(()=>{this.locals.projectId=null,this.cdRef.markForCheck()}))}onProjectSelectionSave({type:e,project:t}){this.type=e,this.project=t,this.goTo(i.Principal)}onPrincipalSave({principalData:e,isAlreadyMember:t,role:n,message:o}){return this.principalData=e,this.role=n,this.message=o,t?this.closeWithPrincipal():this.goTo(i.Summary)}onSuccessfulSubmission(e){this.principalData.principal!==e.principal&&this.type===o.User&&(this.createdNewPrincipal=!0),this.principalData.principal=e.principal,this.goTo(i.Success)}goTo(e){this.step=e}closeWithPrincipal(){this.data=this.principalData.principal,this.closeMe()}static{this.ɵfac=function InviteUserModalComponent_Factory(e){return new(e||InviteUserModalComponent)(l.rXU(s.Y),l.rXU(l.gRc),l.rXU(l.aKT),l.rXU(a.n))}}static{this.ɵcmp=l.VBU({type:InviteUserModalComponent,selectors:[["ng-component"]],features:[l.Vt3],decls:5,vars:5,consts:[["class","spot-modal",4,"ngIf"],["tabindex","0","cdkFocusInitial","","cdkTrapFocus","",3,"project","type","cdkTrapFocusAutoCapture","save","close",4,"ngIf"],["tabindex","0","cdkFocusInitial","","cdkTrapFocus","",3,"project","roleData","messageData","principalData","type","cdkTrapFocusAutoCapture","save","back","close",4,"ngIf"],["tabindex","0","cdkFocusInitial","","cdkTrapFocus","",3,"project","principalData","type","role","message","cdkTrapFocusAutoCapture","save","back","close",4,"ngIf"],["class","spot-modal","tabindex","0","cdkFocusInitial","","cdkTrapFocus","",3,"principal","project","type","createdNewPrincipal","cdkTrapFocusAutoCapture","close",4,"ngIf"],[1,"spot-modal"],["tabindex","0","cdkFocusInitial","","cdkTrapFocus","",3,"save","close","project","type","cdkTrapFocusAutoCapture"],["tabindex","0","cdkFocusInitial","","cdkTrapFocus","",3,"save","back","close","project","roleData","messageData","principalData","type","cdkTrapFocusAutoCapture"],["tabindex","0","cdkFocusInitial","","cdkTrapFocus","",3,"save","back","close","project","principalData","type","role","message","cdkTrapFocusAutoCapture"],["tabindex","0","cdkFocusInitial","","cdkTrapFocus","",1,"spot-modal",3,"close","principal","project","type","createdNewPrincipal","cdkTrapFocusAutoCapture"]],template:function InviteUserModalComponent_Template(e,t){1&e&&l.DNE(0,InviteUserModalComponent_div_0_Template,1,0,"div",0)(1,InviteUserModalComponent_op_ium_project_selection_1_Template,1,3,"op-ium-project-selection",1)(2,InviteUserModalComponent_op_ium_principal_2_Template,1,6,"op-ium-principal",2)(3,InviteUserModalComponent_op_ium_summary_3_Template,1,6,"op-ium-summary",3)(4,InviteUserModalComponent_op_ium_success_4_Template,1,5,"op-ium-success",4),2&e&&(l.Y8G("ngIf",t.loading),l.R7$(),l.Y8G("ngIf",!t.loading&&t.step===t.Steps.ProjectSelection),l.R7$(),l.Y8G("ngIf",!t.loading&&t.step===t.Steps.Principal),l.R7$(),l.Y8G("ngIf",!t.loading&&t.step===t.Steps.Summary),l.R7$(),l.Y8G("ngIf",!t.loading&&t.step===t.Steps.Success))},styles:[".op-modal form{display:flex;flex-direction:column;height:100%;flex-grow:1}.op-modal .spot-form-field+.spot-form-field{margin-top:1rem}\n"],encapsulation:2,changeDetection:0})}}},56008:(e,t,n)=>{"use strict";n.d(t,{_:()=>JobStatusModalService});var i=n(88535),o=n(73014),r=n(68559);class JobStatusModalService{constructor(e,t){this.pathHelper=e,this.turboRequests=t}show(e){this.turboRequests.requestStream(this.jobModalUrl(e))}jobModalUrl(e){return this.pathHelper.jobStatusModalPath(e)}static{this.ɵfac=function JobStatusModalService_Factory(e){return new(e||JobStatusModalService)(r.KVO(o.B),r.KVO(i.W))}}static{this.ɵprov=r.jDH({token:JobStatusModalService,factory:JobStatusModalService.ɵfac,providedIn:"root"})}}},65046:(e,t,n)=>{"use strict";n.d(t,{R:()=>HookService});var i=n(68559);class HookService{constructor(){this.hooks={}}register(e,t){t&&(this.hooks[e]||(this.hooks[e]=[]),this.hooks[e].push(t))}call(e,...t){const n=[];if(this.hooks[e])for(let i=0;i<this.hooks[e].length;i++){const o=this.hooks[e][i](...t);o&&n.push(o)}return n}static{this.ɵfac=function HookService_Factory(e){return new(e||HookService)}}static{this.ɵprov=i.jDH({token:HookService,factory:HookService.ɵfac,providedIn:"root"})}}},43258:(e,t,n)=>{"use strict";n.d(t,{_:()=>CopyProjectComponent});var i=n(14593),o=n(61816),r=n(73014),s=n(99496),a=n(86866),l=n(56008),c=n(68559),p=n(46874);class CopyProjectComponent extends s.p{constructor(e,t,n,i,o){super(),this.apiV3Service=e,this.currentProjectService=t,this.pathHelperService=n,this.jobStatusModalService=i,this.I18n=o,this.dynamicFieldsSettingsPipe=this.fieldSettingsPipe.bind(this),this.hiddenFields=["createdAt","identifier","active"],this.text={advancedSettingsLabel:this.I18n.t("js.forms.advanced_settings"),copySettingsLabel:this.I18n.t("js.project.copy.copy_options")}}ngOnInit(){this.formUrl=this.apiV3Service.projects.id(this.currentProjectService.id).copy.form.path,this.fieldGroups=[{name:this.text.advancedSettingsLabel,fieldsFilter:e=>!this.isMeta(e.templateOptions?.property)&&!this.isPrimaryAttribute(e.templateOptions)},{name:this.text.copySettingsLabel,fieldsFilter:e=>this.isMeta(e.templateOptions?.property)}]}onSubmitted(e){this.jobStatusModalService.show(e.jobId)}isHiddenField(e){return!!e&&this.hiddenFields.includes(e)}fieldSettingsPipe(e){return this.sortedCopyFields(e).map((e=>({...e,hide:this.isHiddenField(e.key)})))}isPrimaryAttribute(e){return!!e&&(e.required&&!e.hasDefault&&null==e.payloadValue||"name"===e.property||"parent"===e.property)}isMeta(e){return!!e&&(e.startsWith("copy")||"sendNotifications"===e)}sortedCopyFields(e){const t=e.filter((e=>e.key&&e.key.startsWith("_meta.copy"))).sort(((e,t)=>e.templateOptions&&e.templateOptions.label&&t.templateOptions&&t.templateOptions.label?e.templateOptions.label.localeCompare(t.templateOptions.label):0)),n=e.filter((e=>!e.key||!e.key.startsWith("_meta.copy")));return t.concat(n)}static{this.ɵfac=function CopyProjectComponent_Factory(e){return new(e||CopyProjectComponent)(c.rXU(i.n),c.rXU(a.c),c.rXU(r.B),c.rXU(l._),c.rXU(o.W))}}static{this.ɵcmp=c.VBU({type:CopyProjectComponent,selectors:[["ng-component"]],features:[c.Vt3],decls:1,vars:3,consts:[["helpTextAttributeScope","Project",3,"submitted","formUrl","fieldsSettingsPipe","fieldGroups"]],template:function CopyProjectComponent_Template(e,t){1&e&&(c.j41(0,"op-dynamic-form",0),c.bIt("submitted",(function CopyProjectComponent_Template_op_dynamic_form_submitted_0_listener(e){return t.onSubmitted(e)})),c.k0s()),2&e&&c.Y8G("formUrl",t.formUrl)("fieldsSettingsPipe",t.dynamicFieldsSettingsPipe)("fieldGroups",t.fieldGroups)},dependencies:[p.f],encapsulation:2})}}},6522:(e,t,n)=>{"use strict";n.d(t,{x:()=>NewProjectComponent});var i=n(73014),o=n(61816),r=n(34456),s=n(14593),a=n(70271),l=n(46874),c=n(99496),p=n(89282),d=n(56008),u=n(68559),h=n(60316),m=n(88294),g=n(62223);const _c0=e=>({"op-highlighted-input":!0,"op-highlighted-input_active":e});class NewProjectComponent extends c.p{get templateControl(){return this.templateForm.get("template")}constructor(e,t,n,i){super(),this.apiV3Service=e,this.pathHelperService=t,this.jobStatusModalService=n,this.I18n=i,this.dynamicFieldsSettingsPipe=this.fieldSettingsPipe.bind(this),this.initialPayload={},this.text={use_template:this.I18n.t("js.project.use_template"),no_template_selected:this.I18n.t("js.project.no_template_selected"),advancedSettingsLabel:this.I18n.t("js.forms.advanced_settings"),copySettingsLabel:this.I18n.t("js.project.copy.copy_options")},this.hiddenFields=["identifier","active","createdAt"],this.copyableTemplateFilter=(new p.hG).add("user_action","=",["projects/copy"]).add("templated","=",!0),this.templateOptions$=this.apiV3Service.projects.filtered(this.copyableTemplateFilter,{pageSize:"-1",select:"elements/id, elements/name, elements/identifier, elements/self, elements/ancestors, total, count, pageSize"}).get().pipe((0,a.T)((e=>e.elements.map((e=>({href:e.href,name:e.name})))))),this.templateForm=new r.J3({template:new r.hs})}ngOnInit(){this.resourcePath=this.apiV3Service.projects.path,this.fieldGroups=[{name:this.text.advancedSettingsLabel,fieldsFilter:e=>!(["name","parent"].includes(e.templateOptions?.property)||this.isMeta(e.templateOptions?.property)||e.templateOptions?.required&&!e.templateOptions.hasDefault&&null==e.templateOptions.payloadValue)},{name:this.text.copySettingsLabel,fieldsFilter:e=>this.isMeta(e.templateOptions?.property)}];const e=new URLSearchParams(window.location.search);e.has("parent_id")&&this.setParentAsPayload(e.get("parent_id"))}onSubmitted(e){"JobStatus"===e._type?this.jobStatusModalService.show(e.jobId):window.location.href=this.pathHelperService.projectPath(e.identifier)}onTemplateSelected(e){this.initialPayload={...this.initialPayload,name:this.dynamicForm.model.name,_meta:{...this.initialPayload?._meta,sendNotifications:!1}},this.formUrl=e?.href?`${e.href}/copy`:null}isHiddenField(e){return"_meta.sendNotifications"!==e&&(!!e&&(this.hiddenFields.includes(e)||this.isMeta(e)))}isMeta(e){return!!e&&(e.startsWith("copy")||"sendNotifications"===e)}setParentAsPayload(e){const t=this.apiV3Service.projects.id(e).path;this.initialPayload={_links:{parent:{href:t}}}}fieldSettingsPipe(e){return e.map((e=>({...e,hide:this.isHiddenField(e.key)})))}static{this.ɵfac=function NewProjectComponent_Factory(e){return new(e||NewProjectComponent)(u.rXU(s.n),u.rXU(i.B),u.rXU(d._),u.rXU(o.W))}}static{this.ɵcmp=u.VBU({type:NewProjectComponent,selectors:[["ng-component"]],viewQuery:function NewProjectComponent_Query(e,t){if(1&e&&u.GBs(l.f,5),2&e){let e;u.mGM(e=u.lsd())&&(t.dynamicForm=e.first)}},features:[u.Vt3],decls:6,vars:15,consts:[[1,"op-form",3,"formGroup"],[3,"ngClass"],["data-qa-field-name","use_template",3,"label"],["bindLabel","name","slot","input",3,"ngModelChange","formControl","items","placeholder"],["helpTextAttributeScope","Project",3,"submitted","formUrl","resourcePath","initialPayload","fieldsSettingsPipe","fieldGroups"]],template:function NewProjectComponent_Template(e,t){1&e&&(u.j41(0,"form",0)(1,"div",1)(2,"spot-form-field",2)(3,"ng-select",3),u.nI1(4,"async"),u.bIt("ngModelChange",(function NewProjectComponent_Template_ng_select_ngModelChange_3_listener(e){return t.onTemplateSelected(e)})),u.k0s()()()(),u.j41(5,"op-dynamic-form",4),u.bIt("submitted",(function NewProjectComponent_Template_op_dynamic_form_submitted_5_listener(e){return t.onSubmitted(e)})),u.k0s()),2&e&&(u.Y8G("formGroup",t.templateForm),u.R7$(),u.Y8G("ngClass",u.eq3(13,_c0,!(null==t.templateControl||!t.templateControl.value))),u.R7$(),u.Y8G("label",t.text.use_template),u.R7$(),u.Y8G("formControl",t.templateControl)("items",u.bMT(4,11,t.templateOptions$))("placeholder",t.text.no_template_selected),u.R7$(2),u.Y8G("formUrl",t.formUrl)("resourcePath",t.resourcePath)("initialPayload",t.initialPayload)("fieldsSettingsPipe",t.dynamicFieldsSettingsPipe)("fieldGroups",t.fieldGroups))},dependencies:[h.YU,r.qT,r.BC,r.cb,m.U,r.l_,r.j4,g.vr,l.f,h.Jj],styles:[".op-form[_ngcontent-%COMP%]{margin-bottom:1rem}"]})}}},57940:(e,t,n)=>{"use strict";n.d(t,{E:()=>ProjectsComponent});var i=n(83093),o=n(99496),r=n(86866),s=n(73014),a=n(68559),l=n(46874);class ProjectsComponent extends o.p{constructor(e,t,n){super(),this._pathHelperService=e,this._$state=t,this._currentProjectService=n,this.formMethod="patch",this.hiddenFields=["identifier","active"]}ngOnInit(){this.projectsPath=this._currentProjectService.apiv3Path,this.dynamicFieldsSettingsPipe=e=>e.reduce(((e,t)=>(this.isFieldHidden(t.key)&&(t={...t,hide:!0}),[...e,t])),[])}isFieldHidden(e){return this.hiddenFields.includes(e||"")}static{this.ɵfac=function ProjectsComponent_Factory(e){return new(e||ProjectsComponent)(a.rXU(s.B),a.rXU(i.dw),a.rXU(r.c))}}static{this.ɵcmp=a.VBU({type:ProjectsComponent,selectors:[["ng-component"]],features:[a.Vt3],decls:1,vars:3,consts:[["helpTextAttributeScope","Project",3,"resourcePath","formHttpMethod","fieldsSettingsPipe"]],template:function ProjectsComponent_Template(e,t){1&e&&a.nrm(0,"op-dynamic-form",0),2&e&&a.Y8G("resourcePath",t.projectsPath)("formHttpMethod",t.formMethod)("fieldsSettingsPipe",t.dynamicFieldsSettingsPipe)},dependencies:[l.f]})}}},11856:(e,t,n)=>{"use strict";n.d(t,{K:()=>OpenprojectProjectsModule});var i=n(7014),o=n(74785),r=n(54767),s=n(6522),a=n(34456),l=n(34802),c=n(43258),p=n(57940),d=n(62223),u=n(68559);class OpenprojectProjectsModule{static{this.ɵfac=function OpenprojectProjectsModule_Factory(e){return new(e||OpenprojectProjectsModule)}}static{this.ɵmod=u.$C({type:OpenprojectProjectsModule})}static{this.ɵinj=u.G2t({imports:[l.d,a.X1,d.MQ,i.$,o.X,r.t]})}}("undefined"==typeof ngJitMode||ngJitMode)&&u.Obh(OpenprojectProjectsModule,{declarations:[p.E,s.x,c._],imports:[l.d,a.X1,d.MQ,i.$,o.X,r.t]})},86995:(e,t,n)=>{"use strict";n.d(t,{QB:()=>removeBackgroundEvents,R8:()=>addBackgroundEvents});var i=n(39545);function addBackgroundEvents(e,t){let n=e.view.activeStart;const o=e.view.activeEnd.getTime(),r=new Array;for(;n.getTime()<o;)t(n)&&r.push({start:i(n).format("YYYY-MM-DD"),end:i(n).add("1","day").format("YYYY-MM-DD")}),n=i(n).add("1","day").toDate();r.forEach((t=>{e.addEvent({...t},"background")}))}function removeBackgroundEvents(e){e.getEvents().filter((e=>"background"===e.source?.id)).forEach((e=>e.remove()))}},92103:(e,t,n)=>{"use strict";n.d(t,{X:()=>BackButtonComponent});var i=n(30327),o=n(61816),r=n(68559),s=n(60316),a=n(46765);class BackButtonComponent{constructor(e,t){this.backRoutingService=e,this.I18n=t,this.text={goBack:this.I18n.t("js.button_back")}}goBack(){this.customBackMethod?this.customBackMethod():this.backRoutingService.goBack()}static{this.ɵfac=function BackButtonComponent_Factory(e){return new(e||BackButtonComponent)(r.rXU(i.v),r.rXU(o.W))}}static{this.ɵcmp=r.VBU({type:BackButtonComponent,selectors:[["op-back-button"]],inputs:{linkClass:"linkClass",customBackMethod:"customBackMethod"},decls:2,vars:2,consts:[["data-test-selector","op-back-button",1,"op-back-button","button","hide-when-print",3,"click","ngClass","title"],["icon-classes","op-back-button--icon button--icon icon-back-up"]],template:function BackButtonComponent_Template(e,t){1&e&&(r.j41(0,"button",0),r.bIt("click",(function BackButtonComponent_Template_button_click_0_listener(){return t.goBack()})),r.nrm(1,"op-icon",1),r.k0s()),2&e&&r.Y8G("ngClass",t.linkClass)("title",t.text.goBack)},dependencies:[s.YU,a.i],styles:[".op-back-button[_ngcontent-%COMP%]{padding:0;line-height:32px;margin:0;width:75px;height:34px}.op-back-button--icon[_ngcontent-%COMP%]{font-size:1rem;line-height:22px}@media only screen and (max-width: 543px){.op-back-button_mobile-limited-width[_ngcontent-%COMP%]{width:64px}}"],changeDetection:0})}}},30327:(e,t,n)=>{"use strict";n.d(t,{v:()=>BackRoutingService});var i=n(24398),o=n(83093),r=n(66309),s=n(1758),a=n(68559);class BackRoutingService{constructor(e){this.injector=e}goToOtherState(e,t){return this.$state.go(e,t)}goBackToDetailsState(e,t){if(e)this.goToOtherState(t,this.backRoute.params);else{const e=`${t}.details.tabs`,n={...this.backRoute.params,tabIdentifier:this.keepTab.currentDetailsTab};this.goToOtherState(e,n)}}goBackNotToDetailsState(){this.backRoute.parent?this.goToOtherState(this.backRoute.name,this.backRoute.params).then((()=>{this.$state.reload()})):this.goToOtherState(this.backRoute.name,this.backRoute.params)}goBackToPreviousState(e,t){this.keepTab.isDetailsState(this.backRoute.parent)?this.goBackToDetailsState(e,t):this.goBackNotToDetailsState()}goBack(e=!1){const t=this.backRoute?.baseRoute||this.$state.current.data.baseRoute||"work-packages.partitioned.list";!this.backRoute&&t.includes("show")?this.$state.reload():!this.backRoute||this.backRoute.name.includes("new")?this.$state.go(t,this.$state.params):this.goBackToPreviousState(e,t)}goToBaseState(){const e=this.$state.current.data.baseRoute||"work-packages.partitioned.list";this.$state.go(e,this.$state.params)}sync(e){const t=e.from(),n=e.to();if(t.name&&t.data&&n.data&&t.data.parent!==n.data.parent){const n={...e.params("from")};this.backRoute={name:t.name,params:n,parent:t.data.parent,baseRoute:t.data.baseRoute}}}set backRoute(e){this._backRoute=e}get backRoute(){return this._backRoute}static{this.ɵfac=function BackRoutingService_Factory(e){return new(e||BackRoutingService)(a.KVO(a.zZn))}}static{this.ɵprov=a.jDH({token:BackRoutingService,factory:BackRoutingService.ɵfac,providedIn:"root"})}}(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",o.dw)],BackRoutingService.prototype,"$state",void 0),(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",r.S)],BackRoutingService.prototype,"keepTab",void 0)},82711:(e,t,n)=>{"use strict";n.d(t,{l:()=>WorkPackageEditActionsBarComponent});var i=n(68559),o=n(61816),r=n(34539),s=n(46765);class WorkPackageEditActionsBarComponent{constructor(e,t,n){this.I18n=e,this.editForm=t,this.cdRef=n,this.onSave=new i.bkB,this.onCancel=new i.bkB,this._saving=!1,this.text={save:this.I18n.t("js.button_save"),cancel:this.I18n.t("js.button_cancel")}}set saving(e){this._saving=e,this.cdRef.detectChanges()}get saving(){return this._saving}save(){this.saving||(this.saving=!0,this.editForm.submit().then((()=>{this.saving=!1,this.onSave.emit()})).catch((()=>{this.saving=!1})))}cancel(){this.editForm.cancel(),this.onCancel.emit()}static{this.ɵfac=function WorkPackageEditActionsBarComponent_Factory(e){return new(e||WorkPackageEditActionsBarComponent)(i.rXU(o.W),i.rXU(r.G),i.rXU(i.gRc))}}static{this.ɵcmp=i.VBU({type:WorkPackageEditActionsBarComponent,selectors:[["wp-edit-actions-bar"]],outputs:{onSave:"onSave",onCancel:"onCancel"},decls:7,vars:3,consts:[[1,"work-packages--edit-actions"],["id","work-packages--edit-actions-save","accesskey","3",1,"button","-primary",3,"click","disabled"],["icon-classes","button--icon icon-checkmark"],[1,"button--text",3,"textContent"],["id","work-packages--edit-actions-cancel","accesskey","7",1,"button",3,"click"],["icon-classes","button--icon icon-close"]],template:function WorkPackageEditActionsBarComponent_Template(e,t){1&e&&(i.j41(0,"div",0)(1,"button",1),i.bIt("click",(function WorkPackageEditActionsBarComponent_Template_button_click_1_listener(){return t.save()})),i.nrm(2,"op-icon",2)(3,"span",3),i.k0s(),i.j41(4,"button",4),i.bIt("click",(function WorkPackageEditActionsBarComponent_Template_button_click_4_listener(){return t.cancel()})),i.nrm(5,"op-icon",5)(6,"span",3),i.k0s()()),2&e&&(i.R7$(),i.Y8G("disabled",t.saving),i.R7$(2),i.Y8G("textContent",t.text.save),i.R7$(3),i.Y8G("textContent",t.text.cancel))},dependencies:[s.i],encapsulation:2,changeDetection:0})}}},52536:(e,t,n)=>{"use strict";n.d(t,{d:()=>AbstractDateTimeValueController});var i=n(61816),o=n(99496),r=n(32420),s=n(68559);class AbstractDateTimeValueController extends o.p{constructor(e,t){super(),this.I18n=e,this.timezoneService=t}ngOnInit(){_.remove(this.filter.values,(e=>!(""===e||this.timezoneService.isValidISODateTime(e))))}isoDateParser(e){if(!this.timezoneService.isValidISODate(e))return"";const t=this.timezoneService.parseISODatetime(e);return this.timezoneService.formattedISODateTime(t)}isoDateFormatter(e){if(!this.timezoneService.isValidISODateTime(e))return"";const t=this.timezoneService.parseISODatetime(e);return this.timezoneService.formattedISODate(t)}get isTimeZoneDifferent(){const e=this.lowerBoundary||this.upperBoundary;return!!e&&(0!==e.hours()||0!==e.minutes())}get timeZoneText(){return this.lowerBoundary&&this.upperBoundary?this.I18n.t("js.filter.time_zone_converted.two_values",{from:this.lowerBoundary.format("YYYY-MM-DD HH:mm"),to:this.upperBoundary.format("YYYY-MM-DD HH:mm")}):this.upperBoundary?this.I18n.t("js.filter.time_zone_converted.only_end",{to:this.upperBoundary.format("YYYY-MM-DD HH:mm")}):this.lowerBoundary?this.I18n.t("js.filter.time_zone_converted.only_start",{from:this.lowerBoundary.format("YYYY-MM-DD HH:mm")}):""}static{this.ɵfac=function AbstractDateTimeValueController_Factory(e){return new(e||AbstractDateTimeValueController)(s.rXU(i.W),s.rXU(r.D))}}static{this.ɵdir=s.FsC({type:AbstractDateTimeValueController,features:[s.Vt3]})}}},58197:(e,t,n)=>{"use strict";n.d(t,{X:()=>FilterBooleanValueComponent});var i=n(68559),o=n(61816),r=(n(87636),n(34456)),s=n(75636);class FilterBooleanValueComponent{constructor(e){this.I18n=e,this.shouldFocus=!1,this.filterChanged=new i.bkB}get value(){return 0===this.filter.values.length&&(this.filter.values[0]="t",this.filterChanged.emit(this.filter)),this.filter.values[0]}onFilterUpdated(e){this.filter.values[0]=e,this.filterChanged.emit(this.filter)}static{this.ɵfac=function FilterBooleanValueComponent_Factory(e){return new(e||FilterBooleanValueComponent)(i.rXU(o.W))}}static{this.ɵcmp=i.VBU({type:FilterBooleanValueComponent,selectors:[["op-filter-boolean-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},decls:2,vars:5,consts:[[3,"id"],[3,"ngModelChange","name","ngModel"]],template:function FilterBooleanValueComponent_Template(e,t){1&e&&(i.j41(0,"label",0)(1,"spot-switch",1),i.bIt("ngModelChange",(function FilterBooleanValueComponent_Template_spot_switch_ngModelChange_1_listener(e){return t.onFilterUpdated(e)})),i.k0s()()),2&e&&(i.Mz_("id","div-values-",t.filter.id,""),i.R7$(),i.Mz_("name","v[",t.filter.name,"]"),i.Y8G("ngModel",t.value))},dependencies:[r.BC,r.vS,s.c],encapsulation:2,changeDetection:0})}}},35245:(e,t,n)=>{"use strict";n.d(t,{c:()=>WorkPackageFilterContainerComponent});var i=n(34120),o=n(22387),r=n(63617),s=n(14600),a=n(99496),l=n(99664),c=n(12717),p=n(95445),d=n(68559),u=n(60316),h=n(37313);const _c0=e=>({"-loaded":e});function WorkPackageFilterContainerComponent_button_0_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"button",3),d.nI1(1,"async"),d.bIt("click",(function WorkPackageFilterContainerComponent_button_0_Template_button_click_0_listener(){d.eBV(e);const t=d.XpG();return d.Njj(t.wpFiltersService.toggleVisibility())})),d.nrm(2,"i",4)(3,"span",5),d.k0s()}if(2&e){const e=d.XpG();d.AVh("-active",d.bMT(1,3,e.visible$)),d.R7$(3),d.Y8G("textContent",e.filterButtonText)}}function WorkPackageFilterContainerComponent_div_2_op_query_filters_1_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"op-query-filters",8),d.bIt("filtersChanged",(function WorkPackageFilterContainerComponent_div_2_op_query_filters_1_Template_op_query_filters_filtersChanged_0_listener(t){d.eBV(e);const n=d.XpG(2);return d.Njj(n.replaceIfComplete(t))})),d.k0s()}if(2&e){const e=d.XpG(2);d.Y8G("filters",e.filters)("showCloseFilter",!0)}}function WorkPackageFilterContainerComponent_div_2_Template(e,t){if(1&e&&(d.j41(0,"div",6),d.DNE(1,WorkPackageFilterContainerComponent_div_2_op_query_filters_1_Template,1,2,"op-query-filters",7),d.k0s()),2&e){const e=d.XpG();d.R7$(),d.Y8G("ngIf",!!e.filters)}}class WorkPackageFilterContainerComponent extends a.p{constructor(e,t,n,i){super(),this.wpTableFilters=e,this.cdRef=t,this.wpFiltersService=n,this.wpListService=i,this.showFilterButton=!1,this.filterButtonText=I18n.t("js.button_filter"),this.filtersChanged=new o.E((0,l.pl)(this)),this.filters=this.wpTableFilters.current,this.loaded=!1,this.visible$=this.wpFiltersService.observeUntil((0,l.pl)(this))}ngOnInit(){(0,r.h)(this.wpTableFilters.pristine$(),(0,s.H)(this.wpListService.conditionallyLoadForm())).pipe(this.untilDestroyed()).subscribe((()=>{this.filters=this.wpTableFilters.current,this.loaded=!0,this.cdRef.detectChanges()}))}replaceIfComplete(e){const t=e.filter((e=>this.wpTableFilters.isAvailable(e)));this.wpTableFilters.replaceIfComplete(t),this.filtersChanged.emit(t)}static{this.ɵfac=function WorkPackageFilterContainerComponent_Factory(e){return new(e||WorkPackageFilterContainerComponent)(d.rXU(i.N),d.rXU(d.gRc),d.rXU(c.a),d.rXU(p.E))}}static{this.ɵcmp=d.VBU({type:WorkPackageFilterContainerComponent,selectors:[["op-filter-container"]],inputs:{showFilterButton:"showFilterButton",filterButtonText:"filterButtonText"},outputs:{filtersChanged:"filtersChanged"},features:[d.Vt3],decls:4,vars:7,consts:[["class","button -small advanced-filters--toggle",3,"-active","click",4,"ngIf"],[1,"work-packages--filters-optional-container",3,"ngClass"],["id","query_form_content","class","hide-when-print",4,"ngIf"],[1,"button","-small","advanced-filters--toggle",3,"click"],[1,"button--icon","icon-filter"],[1,"button--text",3,"textContent"],["id","query_form_content",1,"hide-when-print"],[3,"filters","showCloseFilter","filtersChanged",4,"ngIf"],[3,"filtersChanged","filters","showCloseFilter"]],template:function WorkPackageFilterContainerComponent_Template(e,t){1&e&&(d.DNE(0,WorkPackageFilterContainerComponent_button_0_Template,4,5,"button",0),d.j41(1,"div",1),d.DNE(2,WorkPackageFilterContainerComponent_div_2_Template,2,1,"div",2),d.nI1(3,"async"),d.k0s()),2&e&&(d.Y8G("ngIf",t.showFilterButton),d.R7$(),d.Y8G("ngClass",d.eq3(5,_c0,t.loaded)),d.R7$(),d.Y8G("ngIf",d.bMT(3,3,t.visible$)))},dependencies:[u.YU,u.bT,h.l,u.Jj],encapsulation:2,changeDetection:0})}}},63045:(e,t,n)=>{"use strict";n.d(t,{y:()=>FilterDateTimeValueComponent});var i=n(61816),o=n(22387),r=n(99664),s=n(32420),a=(n(87636),n(52536)),l=n(68559),c=n(60316),p=n(58192),d=n(2768);function FilterDateTimeValueComponent_span_1_Template(e,t){if(1&e&&(l.j41(0,"span",2),l.nrm(1,"span",3),l.k0s()),2&e){const e=l.XpG();l.BMQ("data-tooltip",e.timeZoneText)}}class FilterDateTimeValueComponent extends a.d{get id(){return`div-values-${this.filter.id}`}constructor(e,t){super(e,t),this.I18n=e,this.timezoneService=t,this.className=!0,this.shouldFocus=!1,this.filterChanged=new o.E((0,r.pl)(this))}get value(){return this.filter.values[0]}get valueString(){return this.filter.values[0].toString()}set value(e){this.filter.values=[e],this.filterChanged.emit(this.filter)}get lowerBoundary(){return this.value&&this.timezoneService.isValidISODateTime(this.valueString)?this.timezoneService.parseDatetime(this.valueString):null}get upperBoundary(){return this.value&&this.timezoneService.isValidISODateTime(this.valueString)?this.timezoneService.parseDatetime(this.valueString).add(24,"hours"):null}static{this.ɵfac=function FilterDateTimeValueComponent_Factory(e){return new(e||FilterDateTimeValueComponent)(l.rXU(i.W),l.rXU(s.D))}}static{this.ɵcmp=l.VBU({type:FilterDateTimeValueComponent,selectors:[["op-filter-date-time-value"]],hostVars:3,hostBindings:function FilterDateTimeValueComponent_HostBindings(e,t){2&e&&(l.Mr5("id",t.id),l.AVh("inline-label",t.className))},inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[l.Vt3],decls:2,vars:5,consts:[["required","true",1,"advanced-filters--date-field",3,"valueChange","id","name","value","opAutofocus"],["class","advanced-filters--tooltip-trigger -multiline",4,"ngIf"],[1,"advanced-filters--tooltip-trigger","-multiline"],[1,"spot-icon","spot-icon_warning"]],template:function FilterDateTimeValueComponent_Template(e,t){1&e&&(l.j41(0,"op-basic-single-date-picker",0),l.bIt("valueChange",(function FilterDateTimeValueComponent_Template_op_basic_single_date_picker_valueChange_0_listener(e){return t.value=t.isoDateParser(e)})),l.k0s(),l.DNE(1,FilterDateTimeValueComponent_span_1_Template,2,1,"span",1)),2&e&&(l.Y8G("id","values-"+t.filter.id)("name","v["+t.filter.id+"]")("value",t.isoDateFormatter(t.value))("opAutofocus",t.shouldFocus),l.R7$(),l.Y8G("ngIf",t.isTimeZoneDifferent))},dependencies:[c.bT,p.r,d.B],encapsulation:2})}}},45709:(e,t,n)=>{"use strict";n.d(t,{$:()=>FilterDateTimesValueComponent});var i=n(61816),o=n(22387),r=n(99664),s=n(32420),a=(n(87636),n(52536)),l=n(9585),c=n(68559),p=n(60316),d=n(58192),u=n(2768);function FilterDateTimesValueComponent_span_3_Template(e,t){if(1&e&&(c.j41(0,"span",4),c.nrm(1,"span",5),c.k0s()),2&e){const e=c.XpG();c.BMQ("data-tooltip",e.timeZoneText)}}class FilterDateTimesValueComponent extends a.d{get id(){return`div-values-${this.filter.id}`}constructor(e,t){super(e,t),this.I18n=e,this.timezoneService=t,this.className=!0,this.shouldFocus=!1,this.filterChanged=new o.E((0,r.pl)(this)),this.text={spacer:this.I18n.t("js.filter.value_spacer")}}get begin(){return this.filter.values[0]||""}set begin(e){this.filter.values[0]=e||"",this.filterChanged.emit(this.filter)}get end(){return this.filter.values[1]||""}set end(e){this.filter.values=[this.begin,e||""],this.filterChanged.emit(this.filter)}get lowerBoundary(){return this.begin&&this.timezoneService.isValidISODateTime(this.begin.toString())?this.timezoneService.parseDatetime(this.begin.toString()):null}get upperBoundary(){return this.end&&this.timezoneService.isValidISODateTime(this.end.toString())?this.timezoneService.parseDatetime(this.end.toString()):null}parseBegin(e){if(null!==e&&(0,l.BY)(e))if(""===e)this.begin=e;else{const t=this.timezoneService.parseISODatetime(e).startOf("day").utc();this.begin=this.timezoneService.formattedISODateTime(t)}}parseEnd(e){if(null!==e&&(0,l.BY)(e))if(""===e)this.end=e;else{const t=this.timezoneService.parseISODatetime(e).endOf("day").utc();this.end=this.timezoneService.formattedISODateTime(t)}}formatter(e){return e.map((e=>this.isoDateFormatter(e)))}static{this.ɵfac=function FilterDateTimesValueComponent_Factory(e){return new(e||FilterDateTimesValueComponent)(c.rXU(i.W),c.rXU(s.D))}}static{this.ɵcmp=c.VBU({type:FilterDateTimesValueComponent,selectors:[["op-filter-date-times-value"]],hostVars:3,hostBindings:function FilterDateTimesValueComponent_HostBindings(e,t){2&e&&(c.Mr5("id",t.id),c.AVh("inline-label",t.className))},inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[c.Vt3],decls:4,vars:9,consts:[["required","true","classes","advanced-filters--date-field",3,"valueChange","value","opAutofocus","id","name"],[1,"advanced-filters--affix",3,"textContent"],["classes","advanced-filters--date-field",3,"valueChange","value","id","name"],["class","advanced-filters--tooltip-trigger -multiline",4,"ngIf"],[1,"advanced-filters--tooltip-trigger","-multiline"],[1,"spot-icon","spot-icon_warning"]],template:function FilterDateTimesValueComponent_Template(e,t){1&e&&(c.j41(0,"op-basic-single-date-picker",0),c.bIt("valueChange",(function FilterDateTimesValueComponent_Template_op_basic_single_date_picker_valueChange_0_listener(e){return t.parseBegin(e)})),c.k0s(),c.nrm(1,"span",1),c.j41(2,"op-basic-single-date-picker",2),c.bIt("valueChange",(function FilterDateTimesValueComponent_Template_op_basic_single_date_picker_valueChange_2_listener(e){return t.parseEnd(e)})),c.k0s(),c.DNE(3,FilterDateTimesValueComponent_span_3_Template,2,1,"span",3)),2&e&&(c.Y8G("value",t.isoDateFormatter(t.begin))("opAutofocus",t.shouldFocus)("id","values-"+t.filter.id+"-begin")("name","v["+t.filter.id+"]-begin"),c.R7$(),c.Y8G("textContent",t.text.spacer),c.R7$(),c.Y8G("value",t.isoDateFormatter(t.end))("id","values-"+t.filter.id+"-end")("name","v["+t.filter.id+"]-end"),c.R7$(),c.Y8G("ngIf",t.isTimeZoneDifferent))},dependencies:[p.bT,d.r,u.B],encapsulation:2})}}},43161:(e,t,n)=>{"use strict";n.d(t,{P:()=>FilterDateValueComponent});var i=n(61816),o=n(22387),r=n(99496),s=n(99664),a=n(32420),l=(n(87636),n(6923)),c=n(68559),p=n(58192),d=n(2768);class FilterDateValueComponent extends r.p{get id(){return`div-values-${this.filter.id}`}constructor(e,t){super(),this.timezoneService=e,this.I18n=t,this.shouldFocus=!1,this.filterChanged=new o.E((0,s.pl)(this))}get value(){return this.filter.values[0]}set value(e){this.filter.values=[e],this.filterChanged.emit(this.filter)}valueChanged(e){this.parser(e)&&(this.value=e)}parser(e){return l(e,"YYYY-MM-DD",!0).isValid()?e:null}formatter(e){if(l(e,"YYYY-MM-DD",!0).isValid()){const t=this.timezoneService.parseDate(e);return this.timezoneService.formattedISODate(t)}return null}static{this.ɵfac=function FilterDateValueComponent_Factory(e){return new(e||FilterDateValueComponent)(c.rXU(a.D),c.rXU(i.W))}}static{this.ɵcmp=c.VBU({type:FilterDateValueComponent,selectors:[["op-filter-date-value"]],hostVars:1,hostBindings:function FilterDateValueComponent_HostBindings(e,t){2&e&&c.Mr5("id",t.id)},inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[c.Vt3],decls:1,vars:5,consts:[[1,"advanced-filters--date-field",3,"valueChange","id","name","opAutofocus","value","required"]],template:function FilterDateValueComponent_Template(e,t){1&e&&(c.j41(0,"op-basic-single-date-picker",0),c.bIt("valueChange",(function FilterDateValueComponent_Template_op_basic_single_date_picker_valueChange_0_listener(e){return t.valueChanged(e)})),c.k0s()),2&e&&c.Y8G("id","values-"+t.filter.id)("name","v["+t.filter.id+"]")("opAutofocus",t.shouldFocus)("value",t.formatter(t.value))("required",!0)},dependencies:[p.r,d.B],encapsulation:2})}}},43727:(e,t,n)=>{"use strict";n.d(t,{I:()=>FilterDatesValueComponent});var i=n(61816),o=n(22387),r=n(39545),s=n(99496),a=n(99664),l=n(32420),c=(n(87636),n(68559)),p=n(17564),d=n(2768);class FilterDatesValueComponent extends s.p{get id(){return`div-values-${this.filter.id}`}constructor(e,t){super(),this.timezoneService=e,this.I18n=t,this.className=!0,this.shouldFocus=!1,this.filterChanged=new o.E((0,a.pl)(this)),this.text={spacer:this.I18n.t("js.filter.value_spacer")}}get value(){return this.filter.values||[]}set value(e){this.filter.values=e,this.filterChanged.emit(this.filter)}get begin(){return this.filter.values[0]||""}get end(){return this.filter.values[1]||""}parser(e){return r(e,"YYYY-MM-DD",!0).isValid()?e:null}formatter(e){if(r(e,"YYYY-MM-DD",!0).isValid()){const t=this.timezoneService.parseDate(e);return this.timezoneService.formattedISODate(t)}return null}static{this.ɵfac=function FilterDatesValueComponent_Factory(e){return new(e||FilterDatesValueComponent)(c.rXU(l.D),c.rXU(i.W))}}static{this.ɵcmp=c.VBU({type:FilterDatesValueComponent,selectors:[["op-filter-dates-value"]],hostVars:3,hostBindings:function FilterDatesValueComponent_HostBindings(e,t){2&e&&(c.Mr5("id",t.id),c.AVh("inline-label",t.className))},inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[c.Vt3],decls:1,vars:4,consts:[[1,"advanced-filters--date-field",3,"valueChange","id","name","value","opAutofocus"]],template:function FilterDatesValueComponent_Template(e,t){1&e&&(c.j41(0,"op-basic-range-date-picker",0),c.bIt("valueChange",(function FilterDatesValueComponent_Template_op_basic_range_date_picker_valueChange_0_listener(e){return t.value=e})),c.k0s()),2&e&&c.Y8G("id","values-"+t.filter.id)("name","v["+t.filter.id+"]")("value",t.value)("opAutofocus",t.shouldFocus)},dependencies:[p.s,d.B],encapsulation:2})}}},29417:(e,t,n)=>{"use strict";n.d(t,{V:()=>FilterIntegerValueComponent});var i=n(61816),o=n(22387),r=n(99496),s=n(99664),a=n(44674),l=(n(87636),n(68559)),c=n(34456),p=n(2768);class FilterIntegerValueComponent extends r.p{constructor(e,t){super(),this.I18n=e,this.schemaCache=t,this.shouldFocus=!1,this.filterChanged=new o.E((0,s.pl)(this))}get value(){return parseInt(this.filter.values[0])}set value(e){this.filter.values="number"==typeof e?[e.toString()]:[],this.filterChanged.emit(this.filter)}get unit(){switch(this.schema.filter.allowedValues[0].id){case"startDate":case"dueDate":case"updatedAt":case"createdAt":return this.I18n.t("js.work_packages.time_relative.days");default:return""}}get schema(){return this.schemaCache.of(this.filter)}static{this.ɵfac=function FilterIntegerValueComponent_Factory(e){return new(e||FilterIntegerValueComponent)(l.rXU(i.W),l.rXU(a.D))}}static{this.ɵcmp=l.VBU({type:FilterIntegerValueComponent,selectors:[["op-filter-integer-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[l.Vt3],decls:3,vars:11,consts:[[1,"inline-label",3,"id"],["required","","type","number",1,"advanced-filters--number-field",3,"ngModelChange","ngModel","opAutofocus","id","name"],[1,"advanced-filters--affix",3,"for","textContent"]],template:function FilterIntegerValueComponent_Template(e,t){1&e&&(l.j41(0,"div",0)(1,"input",1),l.mxI("ngModelChange",(function FilterIntegerValueComponent_Template_input_ngModelChange_1_listener(e){return l.DH7(t.value,e)||(t.value=e),e})),l.k0s(),l.nrm(2,"label",2),l.k0s()),2&e&&(l.Mz_("id","div-values-",t.filter.id,""),l.R7$(),l.Mz_("id","values-",t.filter.id,""),l.Mz_("name","v[",t.filter.id,"]"),l.R50("ngModel",t.value),l.Y8G("opAutofocus",t.shouldFocus),l.R7$(),l.Mz_("for","values-",t.filter.id,""),l.Y8G("textContent",t.unit))},dependencies:[c.me,c.Q0,c.BC,c.YS,c.vS,p.B],encapsulation:2})}}},6211:(e,t,n)=>{"use strict";n.d(t,{B:()=>FilterProjectComponent});var i=n(89204),o=n(61816),r=n(22387),s=n(99496),a=n(99664),l=(n(87636),n(14593)),c=n(86866),p=n(56196),d=n(68559),u=n(51196);class FilterProjectComponent extends s.p{constructor(e,t,n){super(),this.I18n=e,this.apiV3Service=t,this.currentProjectService=n,this.shouldFocus=!1,this.filterChanged=new r.E((0,a.pl)(this),0),this.additionalProjectApiFilters=[]}ngOnInit(){const e=this.currentProjectService.id;this.additionalProjectApiFilters.push({name:"active",operator:"=",values:["t"]}),!e||"subprojectId"!==this.filter.id&&"onlySubproject"!==this.filter.id||this.additionalProjectApiFilters.push({name:"ancestor",operator:"=",values:[e]})}onChange(e){var t=this;return(0,i.A)((function*(){if(e===t.filter.values||void 0===e)return;if(!e||e&&0===e.length)return t.filter.values.length=0,void t.filterChanged.emit(t.filter);const n=yield(0,p._)(t.apiV3Service.projects.list({filters:[["id","=",e.map((e=>String(e.id)||""))]]}));t.filter.values=n.elements,t.filterChanged.emit(t.filter)}))()}static{this.ɵfac=function FilterProjectComponent_Factory(e){return new(e||FilterProjectComponent)(d.rXU(o.W),d.rXU(l.n),d.rXU(c.c))}}static{this.ɵcmp=d.VBU({type:FilterProjectComponent,selectors:[["op-filter-project"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[d.Vt3],decls:2,vars:8,consts:[[1,"inline-label","ng-select-container",3,"id"],[1,"advanced-filters--ng-select","-multi-select",3,"change","model","focusDirectly","multiple","appendTo","id","filters"]],template:function FilterProjectComponent_Template(e,t){1&e&&(d.j41(0,"div",0)(1,"op-project-autocompleter",1),d.bIt("change",(function FilterProjectComponent_Template_op_project_autocompleter_change_1_listener(e){return t.onChange(e)})),d.k0s()()),2&e&&(d.Mz_("id","div-values-",t.filter.id,""),d.R7$(),d.Y8G("model",t.filter.values)("focusDirectly",t.shouldFocus)("multiple",!0)("appendTo","body")("id","values-"+t.filter.id)("filters",t.additionalProjectApiFilters))},dependencies:[u.j],encapsulation:2,changeDetection:0})}}},45425:(e,t,n)=>{"use strict";n.d(t,{a:()=>FilterSearchableMultiselectValueComponent});var i=n(59452),o=n(86301),r=n(36647),s=n(15842),a=n(70271),l=n(64334),c=n(68559),p=n(14593),d=n(89282),u=n(86866),h=n(99496),m=(n(87636),n(36178)),g=n(40358),f=n(61816),b=n(63894),k=n(55596),v=n(96027),C=n(46303);const y=["ngSelectInstance"],_c1=e=>({"-required-highlighting":e});class FilterSearchableMultiselectValueComponent extends h.p{get value(){return this.filter.values}constructor(e,t,n,i,o,r,s){super(),this.halResourceService=e,this.apiV3Service=t,this.cdRef=n,this.I18n=i,this.currentProject=o,this.currentUser=r,this.halNotification=s,this.shouldFocus=!1,this.filterChanged=new c.bkB,this.meValue=this.halResourceService.createHalResource({_links:{self:{href:this.apiV3Service.users.me.path,title:this.I18n.t("js.label_me")}}},!0),this.autocompleterFn=e=>this.autocomplete(e),this.itemTracker=e=>e.href||e.id||e.name,this.compareByHref=k.Mz,this.resourceType=null,this.text={placeholder:this.I18n.t("js.placeholders.selection")}}ngOnInit(){"id"===this.filter.id&&(this.resourceType="work_packages"),this.initialRequest$=this.loadCollection("").pipe((0,o.t)(1))}autocomplete(e){return this.initialRequest$.pipe((0,r.n)((t=>t.count===t.total?this.matchingItems(this.filterEmptyElements(t.elements),e):this.loadCollection(e).pipe((0,r.n)((t=>this.withMeValue(e,this.filterEmptyElements(t.elements))))))))}filterEmptyElements(e){return e.filter((e=>0!==e.name.trim().length))}matchingItems(e,t){let n;if(""!==t&&t){const i=t.toLowerCase();n=e.filter((e=>e.id.includes(i)||e.name.toLowerCase().includes(i)))}else n=e;return this.withMeValue(t,n)}loadCollection(e){const t=this.createFilters(e);return this.apiV3Service.collectionFromString(this.allowedValuesLink).filtered(t,{pageSize:`${v.gu}`}).get()}createFilters(e){const t=new d.hG;return e&&t.add("typeahead","**",[e]),t}setValues(e){let t;t="string"==typeof e?e.length>0?[e]:[]:Array.isArray(e)?e:[e],this.filter.values=t,this.filterChanged.emit(this.filter),this.cdRef.detectChanges()}get allowedValuesLink(){const{href:e}=this.filter.currentSchema.values.allowedValues;return e}withMeValue(e,t){return!this.isUserResource||e&&"me"!==e?(0,i.of)(t):this.currentUser.isLoggedIn$.pipe((0,l.s)(1),(0,s.E)(this.currentUser.user$),(0,a.T)((([e,n])=>e&&n?[this.meValue].concat(t):t)))}get isUserResource(){const e=_.get(this.filter.currentSchema,"values.type",null);return e&&e.indexOf("User")>0}static{this.ɵfac=function FilterSearchableMultiselectValueComponent_Factory(e){return new(e||FilterSearchableMultiselectValueComponent)(c.rXU(m.t),c.rXU(p.n),c.rXU(c.gRc),c.rXU(f.W),c.rXU(u.c),c.rXU(b.K),c.rXU(g.Y))}}static{this.ɵcmp=c.VBU({type:FilterSearchableMultiselectValueComponent,selectors:[["op-filter-searchable-multiselect-value"]],viewQuery:function FilterSearchableMultiselectValueComponent_Query(e,t){if(1&e&&c.GBs(y,7),2&e){let e;c.mGM(e=c.lsd())&&(t.ngSelectInstance=e.first)}},inputs:{filter:"filter",shouldFocus:"shouldFocus"},outputs:{filterChanged:"filterChanged"},features:[c.Vt3],decls:2,vars:17,consts:[[1,"inline-label","ng-select-container",3,"id"],["appendTo","body",1,"advanced-filters--ng-select","-multi-select",3,"change","id","getOptionsFn","classes","virtualScroll","closeOnSelect","placeholder","hideSelected","multiple","fetchDataDirectly","focusDirectly","model","resource","compareWith","trackByFn"]],template:function FilterSearchableMultiselectValueComponent_Template(e,t){1&e&&(c.j41(0,"div",0)(1,"op-autocompleter",1),c.bIt("change",(function FilterSearchableMultiselectValueComponent_Template_op_autocompleter_change_1_listener(e){return t.setValues(e)})),c.k0s()()),2&e&&(c.Mz_("id","div-values-",t.filter.id,""),c.R7$(),c.Y8G("id","values-"+t.filter.id)("getOptionsFn",t.autocompleterFn)("classes",c.eq3(15,_c1,0===t.value.length))("closeOnSelect",!1)("placeholder",t.text.placeholder)("hideSelected",!0)("multiple",!0)("fetchDataDirectly",!0)("focusDirectly",t.shouldFocus)("model",t.value)("resource",t.resourceType)("compareWith",t.compareByHref)("trackByFn",t.itemTracker))},dependencies:[C.T],encapsulation:2,changeDetection:0})}}},62417:(e,t,n)=>{"use strict";n.d(t,{s:()=>FilterStringValueComponent});var i=n(61816),o=n(22387),r=n(99496),s=n(99664),a=(n(87636),n(68559)),l=n(34456),c=n(2768);class FilterStringValueComponent extends r.p{constructor(e){super(),this.I18n=e,this.shouldFocus=!1,this.filterChanged=new o.E((0,s.pl)(this)),this.text={enter_text:this.I18n.t("js.work_packages.description_enter_text")}}get value(){return this.filter.values[0]}set value(e){e.length?this.filter.values[0]=e:this.filter.values.length=0,this.filterChanged.emit(this.filter)}static{this.ɵfac=function FilterStringValueComponent_Factory(e){return new(e||FilterStringValueComponent)(a.rXU(i.W))}}static{this.ɵcmp=a.VBU({type:FilterStringValueComponent,selectors:[["op-filter-string-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[a.Vt3],decls:3,vars:11,consts:[[3,"id"],["required","true","type","text",1,"advanced-filters--text-field",3,"ngModelChange","ngModel","opAutofocus","id","name"],[1,"hidden-for-sighted",3,"for","textContent"]],template:function FilterStringValueComponent_Template(e,t){1&e&&(a.j41(0,"div",0)(1,"input",1),a.mxI("ngModelChange",(function FilterStringValueComponent_Template_input_ngModelChange_1_listener(e){return a.DH7(t.value,e)||(t.value=e),e})),a.k0s(),a.nrm(2,"label",2),a.k0s()),2&e&&(a.Mz_("id","div-values-",t.filter.name,""),a.R7$(),a.Mz_("id","values-",t.filter.name,""),a.Mz_("name","v[",t.filter.name,"]"),a.R50("ngModel",t.value),a.Y8G("opAutofocus",t.shouldFocus),a.R7$(),a.Mz_("for","values-",t.filter.name,""),a.Y8G("textContent",t.text.enter_text))},dependencies:[l.me,l.BC,l.YS,l.vS,c.B],encapsulation:2})}}},28445:(e,t,n)=>{"use strict";n.d(t,{A:()=>FilterToggledMultiselectValueComponent});var i=n(68559),o=n(61816),r=n(72355),s=n(73014),a=n(14593),l=n(63894),c=(n(87636),n(36178)),p=n(55596),d=n(46303);const u=["ngSelectInstance"],_c1=e=>({"-required-highlighting":e});class FilterToggledMultiselectValueComponent{constructor(e,t,n,o,r,s,a){this.halResourceService=e,this.halSorting=t,this.PathHelper=n,this.apiV3Service=o,this.currentUser=r,this.cdRef=s,this.I18n=a,this.shouldFocus=!1,this.filterChanged=new i.bkB,this.availableOptions=[],this.itemTracker=e=>e.href||e.id||e.name,this.compareByHref=p.Mz,this.text={placeholder:this.I18n.t("js.placeholders.selection")}}ngOnInit(){const e=this.filter.currentSchema.values.allowedValues;this.availableOptions=this.halSorting.sort(e)}ngAfterViewInit(){this.ngSelectInstance&&this.shouldFocus&&this.ngSelectInstance.focus()}get value(){return this.filter.values}setValues(e){this.filter.values=_.castArray(e),this.filterChanged.emit(this.filter),this.cdRef.detectChanges()}static{this.ɵfac=function FilterToggledMultiselectValueComponent_Factory(e){return new(e||FilterToggledMultiselectValueComponent)(i.rXU(c.t),i.rXU(r.X),i.rXU(s.B),i.rXU(a.n),i.rXU(l.K),i.rXU(i.gRc),i.rXU(o.W))}}static{this.ɵcmp=i.VBU({type:FilterToggledMultiselectValueComponent,selectors:[["op-filter-toggled-multiselect-value"]],viewQuery:function FilterToggledMultiselectValueComponent_Query(e,t){if(1&e&&i.GBs(u,7),2&e){let e;i.mGM(e=i.lsd())&&(t.ngSelectInstance=e.first)}},inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},decls:2,vars:14,consts:[[1,"inline-label","ng-select-container",3,"id"],["appendTo","body","bindLabel","name",1,"advanced-filters--ng-select","-multi-select",3,"change","id","items","classes","virtualScroll","closeOnSelect","placeholder","hideSelected","multiple","model","compareWith","trackByFn"]],template:function FilterToggledMultiselectValueComponent_Template(e,t){1&e&&(i.j41(0,"div",0)(1,"op-autocompleter",1),i.bIt("change",(function FilterToggledMultiselectValueComponent_Template_op_autocompleter_change_1_listener(e){return t.setValues(e)})),i.k0s()()),2&e&&(i.Mz_("id","div-values-",t.filter.id,""),i.R7$(),i.Y8G("id","values-"+t.filter.id)("items",t.availableOptions)("classes",i.eq3(12,_c1,0===t.value.length))("closeOnSelect",!1)("placeholder",t.text.placeholder)("hideSelected",!0)("multiple",!0)("model",t.value)("compareWith",t.compareByHref)("trackByFn",t.itemTracker))},dependencies:[d.T],encapsulation:2,changeDetection:0})}}},33157:(e,t,n)=>{"use strict";n.d(t,{Q:()=>QueryFilterComponent});var i=n(68559),o=n(61816),r=n(55596),s=n(99972),a=n(34120),l=n(44674),c=n(86866),p=(n(87636),n(58154)),d=n(60316),u=n(34456),h=n(46765),m=n(58197),g=n(43161),_=n(43727),f=n(63045),b=n(45709),k=n(29417),v=n(62417),C=n(6211),y=n(28445),w=n(45425);const T=["query-filter",""];function QueryFilterComponent_span_3_Template(e,t){if(1&e&&i.nrm(0,"span",12),2&e){const e=i.XpG();i.Y8G("title",e.text.incompatible_filter)}}function QueryFilterComponent_select_7_option_1_Template(e,t){if(1&e&&i.nrm(0,"option",15),2&e){const e=t.$implicit;i.Y8G("textContent",e.name)("ngValue",e)}}function QueryFilterComponent_select_7_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"select",13),i.mxI("ngModelChange",(function QueryFilterComponent_select_7_Template_select_ngModelChange_0_listener(t){i.eBV(e);const n=i.XpG();return i.DH7(n.filter.operator,t)||(n.filter.operator=t),i.Njj(t)})),i.bIt("ngModelChange",(function QueryFilterComponent_select_7_Template_select_ngModelChange_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.onFilterUpdated(t.filter))})),i.DNE(1,QueryFilterComponent_select_7_option_1_Template,1,2,"option",14),i.k0s()}if(2&e){const e=i.XpG();i.Mz_("id","operators-",e.filter.id,""),i.Mz_("name","op[",e.filter.id,"]"),i.R50("ngModel",e.filter.operator),i.Y8G("compareWith",e.compareByHref),i.R7$(),i.Y8G("ngForOf",e.availableOperators)}}function QueryFilterComponent_op_filter_boolean_value_8_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-filter-boolean-value",16),i.bIt("filterChanged",(function QueryFilterComponent_op_filter_boolean_value_8_Template_op_filter_boolean_value_filterChanged_0_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.onFilterUpdated(t))})),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("shouldFocus",e.shouldFocus)("filter",e.filter)}}function QueryFilterComponent_ng_container_9_op_filter_integer_value_2_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-filter-integer-value",16),i.bIt("filterChanged",(function QueryFilterComponent_ng_container_9_op_filter_integer_value_2_Template_op_filter_integer_value_filterChanged_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.onFilterUpdated(t))})),i.k0s()}if(2&e){const e=i.XpG(2);i.Y8G("shouldFocus",e.shouldFocus)("filter",e.filter)}}function QueryFilterComponent_ng_container_9_op_filter_date_value_3_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-filter-date-value",16),i.bIt("filterChanged",(function QueryFilterComponent_ng_container_9_op_filter_date_value_3_Template_op_filter_date_value_filterChanged_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.onFilterUpdated(t))})),i.k0s()}if(2&e){const e=i.XpG(2);i.Y8G("shouldFocus",e.shouldFocus)("filter",e.filter)}}function QueryFilterComponent_ng_container_9_op_filter_dates_value_4_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-filter-dates-value",16),i.bIt("filterChanged",(function QueryFilterComponent_ng_container_9_op_filter_dates_value_4_Template_op_filter_dates_value_filterChanged_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.onFilterUpdated(t))})),i.k0s()}if(2&e){const e=i.XpG(2);i.Y8G("shouldFocus",e.shouldFocus)("filter",e.filter)}}function QueryFilterComponent_ng_container_9_op_filter_date_time_value_5_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-filter-date-time-value",16),i.bIt("filterChanged",(function QueryFilterComponent_ng_container_9_op_filter_date_time_value_5_Template_op_filter_date_time_value_filterChanged_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.onFilterUpdated(t))})),i.k0s()}if(2&e){const e=i.XpG(2);i.Y8G("shouldFocus",e.shouldFocus)("filter",e.filter)}}function QueryFilterComponent_ng_container_9_op_filter_date_times_value_6_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-filter-date-times-value",16),i.bIt("filterChanged",(function QueryFilterComponent_ng_container_9_op_filter_date_times_value_6_Template_op_filter_date_times_value_filterChanged_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.onFilterUpdated(t))})),i.k0s()}if(2&e){const e=i.XpG(2);i.Y8G("shouldFocus",e.shouldFocus)("filter",e.filter)}}function QueryFilterComponent_ng_container_9_op_filter_string_value_7_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-filter-string-value",16),i.bIt("filterChanged",(function QueryFilterComponent_ng_container_9_op_filter_string_value_7_Template_op_filter_string_value_filterChanged_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.onFilterUpdated(t))})),i.k0s()}if(2&e){const e=i.XpG(2);i.Y8G("shouldFocus",e.shouldFocus)("filter",e.filter)}}function QueryFilterComponent_ng_container_9_op_filter_string_value_8_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-filter-string-value",16),i.bIt("filterChanged",(function QueryFilterComponent_ng_container_9_op_filter_string_value_8_Template_op_filter_string_value_filterChanged_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.onFilterUpdated(t))})),i.k0s()}if(2&e){const e=i.XpG(2);i.Y8G("shouldFocus",e.shouldFocus)("filter",e.filter)}}function QueryFilterComponent_ng_container_9_op_filter_project_9_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-filter-project",16),i.bIt("filterChanged",(function QueryFilterComponent_ng_container_9_op_filter_project_9_Template_op_filter_project_filterChanged_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.onFilterUpdated(t))})),i.k0s()}if(2&e){const e=i.XpG(2);i.Y8G("shouldFocus",e.shouldFocus)("filter",e.filter)}}function QueryFilterComponent_ng_container_9_ng_container_10_op_filter_toggled_multiselect_value_1_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-filter-toggled-multiselect-value",16),i.bIt("filterChanged",(function QueryFilterComponent_ng_container_9_ng_container_10_op_filter_toggled_multiselect_value_1_Template_op_filter_toggled_multiselect_value_filterChanged_0_listener(t){i.eBV(e);const n=i.XpG(3);return i.Njj(n.onFilterUpdated(t))})),i.k0s()}if(2&e){const e=i.XpG(3);i.Y8G("shouldFocus",e.shouldFocus)("filter",e.filter)}}function QueryFilterComponent_ng_container_9_ng_container_10_op_filter_searchable_multiselect_value_2_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-filter-searchable-multiselect-value",16),i.bIt("filterChanged",(function QueryFilterComponent_ng_container_9_ng_container_10_op_filter_searchable_multiselect_value_2_Template_op_filter_searchable_multiselect_value_filterChanged_0_listener(t){i.eBV(e);const n=i.XpG(3);return i.Njj(n.onFilterUpdated(t))})),i.k0s()}if(2&e){const e=i.XpG(3);i.Y8G("shouldFocus",e.shouldFocus)("filter",e.filter)}}function QueryFilterComponent_ng_container_9_ng_container_10_Template(e,t){if(1&e&&(i.qex(0),i.DNE(1,QueryFilterComponent_ng_container_9_ng_container_10_op_filter_toggled_multiselect_value_1_Template,1,2,"op-filter-toggled-multiselect-value",6)(2,QueryFilterComponent_ng_container_9_ng_container_10_op_filter_searchable_multiselect_value_2_Template,1,2,"op-filter-searchable-multiselect-value",6),i.bVm()),2&e){const e=i.XpG(2);i.R7$(),i.Y8G("ngIf",e.filter.currentSchema.loadedAllowedValues()),i.R7$(),i.Y8G("ngIf",!e.filter.currentSchema.loadedAllowedValues())}}function QueryFilterComponent_ng_container_9_Template(e,t){if(1&e&&(i.qex(0),i.j41(1,"div",17),i.DNE(2,QueryFilterComponent_ng_container_9_op_filter_integer_value_2_Template,1,2,"op-filter-integer-value",18)(3,QueryFilterComponent_ng_container_9_op_filter_date_value_3_Template,1,2,"op-filter-date-value",18)(4,QueryFilterComponent_ng_container_9_op_filter_dates_value_4_Template,1,2,"op-filter-dates-value",18)(5,QueryFilterComponent_ng_container_9_op_filter_date_time_value_5_Template,1,2,"op-filter-date-time-value",18)(6,QueryFilterComponent_ng_container_9_op_filter_date_times_value_6_Template,1,2,"op-filter-date-times-value",18)(7,QueryFilterComponent_ng_container_9_op_filter_string_value_7_Template,1,2,"op-filter-string-value",18)(8,QueryFilterComponent_ng_container_9_op_filter_string_value_8_Template,1,2,"op-filter-string-value",18)(9,QueryFilterComponent_ng_container_9_op_filter_project_9_Template,1,2,"op-filter-project",18)(10,QueryFilterComponent_ng_container_9_ng_container_10_Template,3,2,"ng-container",19),i.k0s(),i.bVm()),2&e){const e=i.XpG();i.R7$(),i.Y8G("ngSwitch",e.valueType),i.R7$(),i.Y8G("ngSwitchCase","[1]Integer"),i.R7$(),i.Y8G("ngSwitchCase","[1]Date"),i.R7$(),i.Y8G("ngSwitchCase","[2]Date"),i.R7$(),i.Y8G("ngSwitchCase","[1]DateTime"),i.R7$(),i.Y8G("ngSwitchCase","[2]DateTime"),i.R7$(),i.Y8G("ngSwitchCase","[1]String"),i.R7$(),i.Y8G("ngSwitchCase","[1]Float"),i.R7$(),i.Y8G("ngSwitchCase","[]Project")}}function QueryFilterComponent_div_10_Template(e,t){1&e&&i.nrm(0,"div",20)}class QueryFilterComponent{constructor(e,t,n,o,s,a){this.wpTableFilters=e,this.wpTableBaseline=t,this.schemaCache=n,this.I18n=o,this.currentProject=s,this.bannerService=a,this.className=!0,this.shouldFocus=!1,this.filterChanged=new i.bkB,this.deactivateFilter=new i.bkB,this.showValuesInput=!1,this.eeShowBanners=!1,this.baselineIncompatibleFilter=!1,this.trackByHref=r.lV,this.compareByHref=r.Mz,this.text={open_filter:this.I18n.t("js.filter.description.text_open_filter"),close_filter:this.I18n.t("js.filter.description.text_close_filter"),label_filter_add:this.I18n.t("js.work_packages.label_filter_add"),upsale_for_more:this.I18n.t("js.filter.upsale_for_more"),upsale_link:this.I18n.t("js.filter.upsale_link"),button_delete:this.I18n.t("js.button_delete"),incompatible_filter:this.I18n.t("js.work_packages.filters.baseline_incompatible")}}onFilterUpdated(e){this.filter=e,this.showValuesInput=this.showValues(),this.filterChanged.emit()}removeThisFilter(){this.deactivateFilter.emit(this.filter)}get valueType(){if(this.filter.currentSchema&&this.filter.currentSchema.values)return this.filter.currentSchema.values.type}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners,this.availableOperators=this.schemaCache.of(this.filter).availableOperators,this.showValuesInput=this.showValues(),this.baselineIncompatibleFilter=this.wpTableBaseline.isActive()&&this.wpTableBaseline.isIncompatibleFilter(this.filter.id)}showValues(){return this.filter.currentSchema.isValueRequired()&&"[1]Boolean"!==this.filter.currentSchema.values.type}static{this.ɵfac=function QueryFilterComponent_Factory(e){return new(e||QueryFilterComponent)(i.rXU(a.N),i.rXU(p.b1),i.rXU(l.D),i.rXU(o.W),i.rXU(c.c),i.rXU(s.b))}}static{this.ɵcmp=i.VBU({type:QueryFilterComponent,selectors:[["","query-filter",""]],hostVars:2,hostBindings:function QueryFilterComponent_HostBindings(e,t){2&e&&i.AVh("op-query-filter",t.className)},inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged",deactivateFilter:"deactivateFilter"},attrs:T,decls:14,vars:16,consts:[[1,"advanced-filters--filter-name",3,"for"],[3,"textContent"],["data-test-selector","query-filter-baseline-incompatible","class","spot-icon spot-icon_warning",3,"title",4,"ngIf"],[1,"advanced-filters--filter-operator"],[1,"hidden-for-sighted",3,"for"],["required","","class","advanced-filters--select","style","vertical-align: top;",3,"id","name","ngModel","compareWith","ngModelChange",4,"ngIf"],[3,"shouldFocus","filter","filterChanged",4,"ngIf"],[4,"ngIf"],["class","advanced-filters--filter-value",4,"ngIf"],[1,"advanced-filters--remove-filter"],["type","button",1,"spot-link",3,"click","title"],["icon-classes","icon-close advanced-filters--remove-filter-icon"],["data-test-selector","query-filter-baseline-incompatible",1,"spot-icon","spot-icon_warning",3,"title"],["required","",1,"advanced-filters--select",2,"vertical-align","top",3,"ngModelChange","id","name","ngModel","compareWith"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],[3,"textContent","ngValue"],[3,"filterChanged","shouldFocus","filter"],[1,"advanced-filters--filter-value",3,"ngSwitch"],[3,"shouldFocus","filter","filterChanged",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"advanced-filters--filter-value"]],template:function QueryFilterComponent_Template(e,t){1&e&&(i.qex(0),i.j41(1,"label",0),i.nrm(2,"span",1),i.DNE(3,QueryFilterComponent_span_3_Template,1,1,"span",2),i.k0s(),i.j41(4,"div",3)(5,"label",4),i.EFF(6),i.k0s(),i.DNE(7,QueryFilterComponent_select_7_Template,2,7,"select",5)(8,QueryFilterComponent_op_filter_boolean_value_8_Template,1,2,"op-filter-boolean-value",6),i.k0s(),i.DNE(9,QueryFilterComponent_ng_container_9_Template,11,9,"ng-container",7)(10,QueryFilterComponent_div_10_Template,1,0,"div",8),i.j41(11,"div",9)(12,"button",10),i.bIt("click",(function QueryFilterComponent_Template_button_click_12_listener(){return t.removeThisFilter()})),i.nrm(13,"op-icon",11),i.k0s()(),i.bVm()),2&e&&(i.R7$(),i.AVh("op-query-filter--icon-label",t.baselineIncompatibleFilter),i.Mz_("for","operators-",t.filter.id,""),i.R7$(),i.Y8G("textContent",t.filter.name),i.BMQ("title",t.filter.name),i.R7$(),i.Y8G("ngIf",t.baselineIncompatibleFilter),i.R7$(2),i.Mz_("for","operators-",t.filter.id,""),i.R7$(),i.Lme(" ",t.filter.name," ",t.text.open_filter," "),i.R7$(),i.Y8G("ngIf","[1]Boolean"!==t.valueType),i.R7$(),i.Y8G("ngIf","[1]Boolean"===t.valueType),i.R7$(),i.Y8G("ngIf",t.showValuesInput&&t.valueType),i.R7$(),i.Y8G("ngIf",!t.showValuesInput),i.R7$(2),i.Y8G("title",t.text.button_delete))},dependencies:[d.Sq,d.bT,d.ux,d.e1,d.fG,u.xH,u.y7,u.wz,u.BC,u.YS,u.vS,h.i,m.X,g.P,_.I,f.y,b.$,k.V,v.s,C.B,y.A,w.a],styles:[".cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-query-filter--icon-label{display:flex;align-items:center;column-gap:.25rem}\n"],encapsulation:2})}}},37313:(e,t,n)=>{"use strict";n.d(t,{l:()=>QueryFiltersComponent});var i=n(61816),o=n(22387),r=n(55596),s=n(62223),a=n(34120),l=n(12717),c=n(99496),p=n(99664),d=n(58154),u=n(59719),h=n(11439),m=n(85058),g=n(68559),f=n(60316),b=n(46765),k=n(33157),v=n(7957);function QueryFiltersComponent_fieldset_0_a_2_Template(e,t){if(1&e){const e=g.RV6();g.j41(0,"a",20),g.bIt("click",(function QueryFiltersComponent_fieldset_0_a_2_Template_a_click_0_listener(){g.eBV(e);const t=g.XpG(2);return g.Njj(t.closeFilter())})),g.k0s()}if(2&e){const e=g.XpG(2);g.BMQ("title",e.text.close_form)}}function QueryFiltersComponent_fieldset_0_ng_container_9_li_1_Template(e,t){if(1&e){const e=g.RV6();g.j41(0,"li",22),g.bIt("deactivateFilter",(function QueryFiltersComponent_fieldset_0_ng_container_9_li_1_Template_li_deactivateFilter_0_listener(t){g.eBV(e);const n=g.XpG(3);return g.Njj(n.deactivateFilter(t))}))("filterChanged",(function QueryFiltersComponent_fieldset_0_ng_container_9_li_1_Template_li_filterChanged_0_listener(){g.eBV(e);const t=g.XpG(3);return g.Njj(t.filtersChanged.emit(t.filters))})),g.k0s()}if(2&e){const e=g.XpG(),t=e.$implicit,n=e.index,i=g.XpG(2);g.Mz_("id","filter_",t.id,""),g.Y8G("shouldFocus",n===i.focusElementIndex)("filter",t)}}function QueryFiltersComponent_fieldset_0_ng_container_9_Template(e,t){if(1&e&&(g.qex(0),g.DNE(1,QueryFiltersComponent_fieldset_0_ng_container_9_li_1_Template,1,4,"li",21),g.bVm()),2&e){const e=t.$implicit,n=g.XpG(2);g.R7$(),g.Y8G("ngIf",n.isFilterAvailable(e))}}function QueryFiltersComponent_fieldset_0_li_10_Template(e,t){1&e&&g.nrm(0,"li",10)}function QueryFiltersComponent_fieldset_0_div_20_Template(e,t){if(1&e&&(g.j41(0,"div",23)(1,"div",24),g.nrm(2,"p",3),g.k0s()()),2&e){const e=g.XpG(2);g.R7$(2),g.Y8G("textContent",e.text.baseline_warning)}}function QueryFiltersComponent_fieldset_0_Template(e,t){if(1&e){const e=g.RV6();g.j41(0,"fieldset",2),g.nrm(1,"legend",3),g.DNE(2,QueryFiltersComponent_fieldset_0_a_2_Template,1,1,"a",4),g.j41(3,"ul",5)(4,"li",6),g.nrm(5,"label",7),g.j41(6,"div",8)(7,"wp-filter-by-text-input",9),g.bIt("deactivateFilter",(function QueryFiltersComponent_fieldset_0_Template_wp_filter_by_text_input_deactivateFilter_7_listener(t){g.eBV(e);const n=g.XpG();return g.Njj(n.deactivateFilter(t))})),g.k0s()()(),g.nrm(8,"li",10),g.DNE(9,QueryFiltersComponent_fieldset_0_ng_container_9_Template,2,1,"ng-container",11)(10,QueryFiltersComponent_fieldset_0_li_10_Template,1,0,"li",12),g.j41(11,"li",13)(12,"label",14),g.nrm(13,"op-icon",15),g.EFF(14),g.k0s(),g.j41(15,"label",16),g.EFF(16),g.k0s(),g.j41(17,"div",17)(18,"ng-select",18,0),g.bIt("open",(function QueryFiltersComponent_fieldset_0_Template_ng_select_open_18_listener(){g.eBV(e);const t=g.XpG();return g.Njj(t.onOpen())}))("change",(function QueryFiltersComponent_fieldset_0_Template_ng_select_change_18_listener(t){g.eBV(e);const n=g.XpG();return g.Njj(n.onFilterAdded(t))})),g.k0s()()()(),g.DNE(20,QueryFiltersComponent_fieldset_0_div_20_Template,3,1,"div",19),g.k0s()}if(2&e){const e=g.XpG();g.R7$(),g.Y8G("textContent",e.text.selected_filter_list),g.R7$(),g.Y8G("ngIf",e.showCloseFilter),g.R7$(3),g.Y8G("textContent",e.text.filter_by_text),g.BMQ("title",e.text.filter_by_text),g.R7$(4),g.Y8G("ngForOf",e.filters)("ngForTrackBy",e.trackByName),g.R7$(),g.Y8G("ngIf",e.isSecondSpacerVisible),g.R7$(4),g.SpI(" ",e.text.label_filter_add,": "),g.R7$(2),g.E5c(" ",e.text.label_filter_add," ",e.text.open_filter," ",e.text.close_filter," "),g.R7$(2),g.Y8G("items",e.remainingFilters)("clearSearchOnAdd",!0)("multiple",!1)("clearable",!0)("clearOnBackspace",!0)("closeOnSelect",!0)("virtualScroll",!0)("placeholder",e.text.please_select)("searchFn",e.searchFunction),g.R7$(2),g.Y8G("ngIf",e.baselineIncompatibleFilters.length>0)}}class QueryFiltersComponent extends c.p{constructor(e,t,n,i,s,a){super(),this.wpTableFilters=e,this.wpTableBaseline=t,this.wpFiltersService=n,this.I18n=i,this.alternativeSearchService=s,this.cdRef=a,this.showCloseFilter=!1,this.filtersChanged=new o.E((0,p.pl)(this),500),this.remainingFilters=[],this.focusElementIndex=0,this.baselineIncompatibleFilters=[],this.trackByName=r.cg,this.text={open_filter:this.I18n.t("js.filter.description.text_open_filter"),label_filter_add:this.I18n.t("js.work_packages.label_filter_add"),close_filter:this.I18n.t("js.filter.description.text_close_filter"),close_form:this.I18n.t("js.close_form_title"),selected_filter_list:this.I18n.t("js.label_selected_filter_list"),button_delete:this.I18n.t("js.button_delete"),please_select:this.I18n.t("js.placeholders.selection"),filter_by_text:this.I18n.t("js.work_packages.label_filter_by_text"),baseline_warning:this.I18n.t("js.work_packages.filters.baseline_warning")},this.searchFunction=(e,t)=>this.alternativeSearchService.searchFunction(e,t)}ngOnInit(){this.wpTableFilters.live$().pipe((0,u.v)(this.wpTableBaseline.live$()),this.untilDestroyed()).subscribe((([e])=>{this.wpTableBaseline.isActive()?this.baselineIncompatibleFilters=this.wpTableBaseline.detectIncompatibleFilters(e):this.baselineIncompatibleFilters=[],this.cdRef.detectChanges()}))}ngOnChanges(){this.updateRemainingFilters()}onFilterAdded(e){if(e){const t=this.wpTableFilters.instantiate(e);this.filters.push(t);const n=this.currentFilterLength();this.updateFilterFocus(n),this.updateRemainingFilters(),this.filtersChanged.emit(this.filters),this.ngSelectComponent.clearItem(e)}}closeFilter(){this.wpFiltersService.toggleVisibility()}deactivateFilter(e){const t=this.filters.indexOf(e);_.remove(this.filters,(t=>t.id===e.id)),this.filtersChanged.emit(this.filters),this.updateFilterFocus(t),this.updateRemainingFilters()}get isSecondSpacerVisible(){const e=!!_.find(this.filters,(e=>"search"===e.id)),t=!!this.filters.find((e=>"search"!==e.id&&this.isFilterAvailable(e)));return e&&t}updateRemainingFilters(){this.remainingFilters=_.sortBy(this.wpTableFilters.remainingVisibleFilters(this.filters),"name")}updateFilterFocus(e){const t=this.currentFilterLength();if(0===t)this.focusElementIndex=-1;else{const n=e<t?e:t-1,i=this.currentFilterAt(n);this.focusElementIndex=this.filters.indexOf(i)}}currentFilterLength(){return this.filters.length}currentFilterAt(e){return this.filters[e]}isFilterAvailable(e){return this.wpTableFilters.availableFilters.some((t=>t.id===e.id))&&!(this.wpTableFilters.hidden.includes(e.id)||e.isTemplated())}onOpen(){(0,h.Z)(this.ngSelectComponent)}static{this.ɵfac=function QueryFiltersComponent_Factory(e){return new(e||QueryFiltersComponent)(g.rXU(a.N),g.rXU(d.b1),g.rXU(l.a),g.rXU(i.W),g.rXU(m.n),g.rXU(g.gRc))}}static{this.ɵcmp=g.VBU({type:QueryFiltersComponent,selectors:[["op-query-filters"]],viewQuery:function QueryFiltersComponent_Query(e,t){if(1&e&&g.GBs(s.vr,5),2&e){let e;g.mGM(e=g.lsd())&&(t.ngSelectComponent=e.first)}},inputs:{filters:"filters",showCloseFilter:"showCloseFilter"},outputs:{filtersChanged:"filtersChanged"},features:[g.Vt3,g.OA$],decls:1,vars:1,consts:[["ngSelectComponent",""],["id","filters","class","advanced-filters--container",4,"ngIf"],["id","filters",1,"advanced-filters--container"],[3,"textContent"],["class","advanced-filters--close icon-context icon-close",3,"click",4,"ngIf"],[1,"advanced-filters--filters"],["id","filter_search",1,"advanced-filters--filter","--without-operator"],["for","filter-by-text-input",1,"advanced-filters--filter-name",3,"textContent"],[1,"advanced-filters--filter-value"],[3,"deactivateFilter"],[1,"advanced-filters--spacer"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","advanced-filters--spacer",4,"ngIf"],[1,"advanced-filters--add-filter"],["for","add_filter_select","aria-hidden","true",1,"advanced-filters--add-filter-label"],["icon-classes","icon-add icon4"],["for","add_filter_select",1,"hidden-for-sighted"],[1,"advanced-filters--add-filter-value"],["id","add_filter_select","bindLabel","name","appendTo","body",3,"open","change","items","clearSearchOnAdd","multiple","clearable","clearOnBackspace","closeOnSelect","virtualScroll","placeholder","searchFn"],["class","op-toast -warning",4,"ngIf"],[1,"advanced-filters--close","icon-context","icon-close",3,"click"],["query-filter","","class","advanced-filters--filter",3,"id","shouldFocus","filter","deactivateFilter","filterChanged",4,"ngIf"],["query-filter","",1,"advanced-filters--filter",3,"deactivateFilter","filterChanged","id","shouldFocus","filter"],[1,"op-toast","-warning"],[1,"op-toast--content"]],template:function QueryFiltersComponent_Template(e,t){1&e&&g.DNE(0,QueryFiltersComponent_fieldset_0_Template,21,21,"fieldset",1),2&e&&g.Y8G("ngIf",t.filters)},dependencies:[f.Sq,f.bT,b.i,s.vr,k.Q,v.t],encapsulation:2,changeDetection:0})}}},7957:(e,t,n)=>{"use strict";n.d(t,{t:()=>WorkPackageFilterByTextInputComponent});var i=n(68559),o=n(61816),r=n(34120),s=n(84205),a=n(70271),l=n(91817),c=n(98764),p=n(52575),d=n(11048),u=n(47418),h=n(99496),m=n(34456),g=n(60316);class WorkPackageFilterByTextInputComponent extends h.p{constructor(e,t,n){super(),this.I18n=e,this.querySpace=t,this.wpTableFilters=n,this.deactivateFilter=new i.bkB,this.text={createWithDropdown:this.I18n.t("js.work_packages.create.button"),createButton:this.I18n.t("js.label_work_package"),explanation:this.I18n.t("js.label_create_work_package"),placeholder:this.I18n.t("js.work_packages.placeholder_filter_by_text")},this.searchTerm=(0,u.hF)(""),this.searchTermChanged=new s.B,this.wpTableFilters.pristine$().pipe(this.untilDestroyed(),(0,a.T)((()=>{const e=this.wpTableFilters.find("search");return e?e.values[0]:""}))).subscribe((e=>{this.searchTerm.value&&!this.searchTerm.isValueOlderThan(500)||this.searchTerm.putValue(e)})),this.searchTermChanged.pipe(this.untilDestroyed(),(0,l.F)(),(0,c.M)((e=>this.searchTerm.putValue(e))),(0,p.B)(500)).subscribe((e=>{if(e.length>0)this.wpTableFilters.replace("search",(t=>{t.operator=t.findOperator("**"),t.values=[e]}));else{const e=this.wpTableFilters.find("search");this.wpTableFilters.remove(e),this.deactivateFilter.emit(e)}}))}static{this.ɵfac=function WorkPackageFilterByTextInputComponent_Factory(e){return new(e||WorkPackageFilterByTextInputComponent)(i.rXU(o.W),i.rXU(d.i),i.rXU(r.N))}}static{this.ɵcmp=i.VBU({type:WorkPackageFilterByTextInputComponent,selectors:[["wp-filter-by-text-input"]],outputs:{deactivateFilter:"deactivateFilter"},features:[i.Vt3],decls:2,vars:4,consts:[["id","filter-by-text-input","type","text",3,"ngModelChange","placeholder","ngModel"]],template:function WorkPackageFilterByTextInputComponent_Template(e,t){1&e&&(i.j41(0,"input",0),i.nI1(1,"async"),i.bIt("ngModelChange",(function WorkPackageFilterByTextInputComponent_Template_input_ngModelChange_0_listener(e){return t.searchTermChanged.next(e)})),i.k0s()),2&e&&(i.FS9("placeholder",t.text.placeholder),i.Y8G("ngModel",i.bMT(1,2,t.searchTerm.values$())))},dependencies:[m.me,m.BC,m.vS,g.Jj],encapsulation:2})}}},12717:(e,t,n)=>{"use strict";n.d(t,{a:()=>WorkPackageFiltersService});var i=n(47418),o=n(33900),r=n(68559);class WorkPackageFiltersService{constructor(){this.state=(0,i.hF)(!1)}get visible(){return this.state.getValueOr(!1)}set visible(e){this.state.putValue(e)}observeUntil(e){return this.state.values$().pipe((0,o.Q)(e))}toggleVisibility(){this.state.doModify((e=>!e))}static{this.ɵfac=function WorkPackageFiltersService_Factory(e){return new(e||WorkPackageFiltersService)}}static{this.ɵprov=r.jDH({token:WorkPackageFiltersService,factory:WorkPackageFiltersService.ɵfac})}}},60402:(e,t,n)=>{"use strict";n.d(t,{B:()=>WorkPackageCommentFieldHandler});var i=n(41804),o=n(84205),r=n(30189),s=n(68559);class WorkPackageCommentFieldHandler extends i.L{constructor(e,t){super(),this.elementRef=e,this.injector=t,this.fieldName="comment",this.handler=this,this.active=!1,this.inEditMode=!1,this.inFlight=!1,this.onDestroy=new o.B}ngOnInit(){this.change=new r.C(this.workPackage)}reset(e=""){e.length>0&&(e+="\n"),this.change.setValue("comment",{raw:e})}get schema(){return{name:I18n.t("js.label_comment"),writable:!0,required:!1,type:"_comment",hasDefault:!1}}get rawComment(){return _.get(this.commentValue,"raw","")}get commentValue(){return this.change.value("comment")}handleUserCancel(){this.deactivate(!0)}activate(e){this.active=!0,this.reset(e)}deactivate(e){this.active=!1,this.onDestroy.next(),this.onDestroy.complete()}focus(){const e=this.elementRef.nativeElement.querySelector(".inplace-editing--trigger-container");e&&e.focus()}handleUserKeydown(e,t){}isChanged(){return!1}stopPropagation(e){return!1}static{this.ɵfac=function WorkPackageCommentFieldHandler_Factory(e){return new(e||WorkPackageCommentFieldHandler)(s.rXU(s.aKT),s.rXU(s.zZn))}}static{this.ɵdir=s.FsC({type:WorkPackageCommentFieldHandler,features:[s.Vt3]})}}},8871:(e,t,n)=>{"use strict";n.d(t,{_:()=>WorkPackageCommentComponent});var i=n(89204),o=n(80366),r=n(68559),s=n(72688),a=n(72650),l=n(61816),c=n(49349),p=n(14593),d=n(60402),u=n(39056),h=n(17456),m=(n(68643),n(16169)),g=n(73014),_=n(64334),f=n(51567),b=n(60316),k=n(46765),v=n(53689),C=n(43063);const y=["commentContainer"],_c1=e=>({"work-packages--activity--add-comment_top":e});function WorkPackageCommentComponent_div_0_Template(e,t){if(1&e&&(r.j41(0,"div",2)(1,"turbo-frame",3)(2,"op-content-loader",4),r.qSk(),r.nrm(3,"rect",5)(4,"rect",6)(5,"rect",7)(6,"rect",8),r.k0s()()()),2&e){const e=r.XpG();r.R7$(),r.Y8G("src",e.turboFrameSrc)}}function WorkPackageCommentComponent_div_1_ng_container_2_Template(e,t){if(1&e&&r.eu8(0,12),2&e){const e=r.XpG(2);r.Y8G("ngTemplateOutlet",e.template)}}function WorkPackageCommentComponent_div_1_div_3_edit_form_portal_3_Template(e,t){if(1&e&&r.nrm(0,"edit-form-portal",17),2&e){const e=r.XpG(3);r.Y8G("schemaInput",e.schema)("changeInput",e.change)("editFieldHandler",e.handler)}}function WorkPackageCommentComponent_div_1_div_3_div_4_Template(e,t){if(1&e){const e=r.RV6();r.j41(0,"div",18),r.bIt("dragover",(function WorkPackageCommentComponent_div_1_div_3_div_4_Template_div_dragover_0_listener(t){r.eBV(e);const n=r.XpG(3);return r.Njj(n.startDragOverActivation(t))}))("dragenter",(function WorkPackageCommentComponent_div_1_div_3_div_4_Template_div_dragenter_0_listener(t){r.eBV(e);const n=r.XpG(3);return r.Njj(n.startDragOverActivation(t))})),r.j41(1,"button",19),r.bIt("click",(function WorkPackageCommentComponent_div_1_div_3_div_4_Template_button_click_1_listener(){r.eBV(e);const t=r.XpG(3);return r.Njj(t.activate())})),r.nrm(2,"span",20)(3,"op-icon",21),r.k0s()()}if(2&e){const e=r.XpG(3);r.R7$(),r.Y8G("title",e.text.editTitle),r.R7$(),r.Y8G("textContent",e.text.placeholder),r.R7$(),r.Y8G("icon-title",e.text.editTitle)}}function WorkPackageCommentComponent_div_1_div_3_Template(e,t){if(1&e&&(r.j41(0,"div",13,0)(2,"div",14),r.DNE(3,WorkPackageCommentComponent_div_1_div_3_edit_form_portal_3_Template,1,3,"edit-form-portal",15)(4,WorkPackageCommentComponent_div_1_div_3_div_4_Template,4,3,"div",16),r.k0s()()),2&e){const e=r.XpG(2);r.Y8G("ngClass",r.eq3(3,_c1,e.showAbove)),r.R7$(3),r.Y8G("ngIf",e.active),r.R7$(),r.Y8G("ngIf",!e.active)}}function WorkPackageCommentComponent_div_1_ng_container_4_Template(e,t){if(1&e&&r.eu8(0,12),2&e){const e=r.XpG(2);r.Y8G("ngTemplateOutlet",e.template)}}function WorkPackageCommentComponent_div_1_Template(e,t){if(1&e&&(r.j41(0,"div",2)(1,"div",9),r.DNE(2,WorkPackageCommentComponent_div_1_ng_container_2_Template,1,1,"ng-container",10)(3,WorkPackageCommentComponent_div_1_div_3_Template,5,5,"div",11)(4,WorkPackageCommentComponent_div_1_ng_container_4_Template,1,1,"ng-container",10),r.k0s()()),2&e){const e=r.XpG();r.R7$(2),r.Y8G("ngIf",!e.showAbove),r.R7$(),r.Y8G("ngIf",e.canAddComment),r.R7$(),r.Y8G("ngIf",e.showAbove)}}class WorkPackageCommentComponent extends d.B{constructor(e,t,n,i,o,r,s,a,l,c,p,d){super(e,t),this.elementRef=e,this.injector=t,this.commentService=n,this.wpLinkedActivities=i,this.configurationService=o,this.loadingIndicator=r,this.apiV3Service=s,this.workPackageNotificationService=a,this.toastService=l,this.cdRef=c,this.I18n=p,this.PathHelper=d,this.text={editTitle:this.I18n.t("js.label_add_comment_title"),addComment:this.I18n.t("js.label_add_comment"),cancelTitle:this.I18n.t("js.label_cancel_comment"),placeholder:this.I18n.t("js.label_add_comment_title")},this.fieldLabel=this.text.editTitle,this.inFlight=!1,this.htmlId="wp-comment-field"}ngOnInit(){super.ngOnInit(),this.canAddComment=!!this.workPackage.addComment,this.showAbove=this.configurationService.commentsSortedInDescendingOrder(),this.primerizedActivitiesEnabled=this.configurationService.activeFeatureFlags.includes("primerizedWorkPackageActivities"),this.turboFrameSrc=`${this.PathHelper.staticBase}/work_packages/${this.workPackage.id}/activities`,this.commentService.draft$.pipe(this.untilDestroyed(),(0,_.s)(1),(0,f.p)((e=>!!e))).subscribe((e=>{this.activate(e)})),this.commentService.quoteEvents$.pipe(this.untilDestroyed()).subscribe((e=>{this.activate(e),this.commentContainer.nativeElement.scrollIntoView()}))}ngOnDestroy(){super.ngOnDestroy(),this.commentService.draft$.next(this.active?this.rawComment:null)}startDragOverActivation(e){return!!this.active||(this.activate(),e.preventDefault(),!1)}activate(e){super.activate(e),this.showAbove||this.scrollToBottom(),this.cdRef.detectChanges()}deactivate(e){e&&this.focus(),this.active=!1,this.cdRef.detectChanges()}handleUserSubmit(){var e=this;return(0,i.A)((function*(){if(e.inFlight||!e.rawComment)return Promise.resolve();e.inFlight=!0,yield e.onSubmit();const t=e.loadingIndicator.wpDetails;return t.promise=e.commentService.createComment(e.workPackage,e.commentValue).then((()=>{e.active=!1,e.toastService.addSuccess(e.I18n.t("js.work_packages.comment_added")),e.wpLinkedActivities.require(e.workPackage,!0),e.apiV3Service.work_packages.id(e.workPackage.id).refresh(),e.inFlight=!1,e.deactivate(!0)})).catch((t=>{e.inFlight=!1,t instanceof m.i?e.workPackageNotificationService.showError(t.resource,e.workPackage):e.toastService.addError(e.I18n.t("js.work_packages.comment_send_failed"))})),t.promise}))()}scrollToBottom(){const e=jQuery(this.elementRef.nativeElement).scrollParent()[0];e&&setTimeout((()=>{e.scrollTop=e.scrollHeight}),400)}setErrors(e){}static{this.ɵfac=function WorkPackageCommentComponent_Factory(e){return new(e||WorkPackageCommentComponent)(r.rXU(r.aKT),r.rXU(r.zZn),r.rXU(u.j),r.rXU(h.Z),r.rXU(s.s),r.rXU(o.FX),r.rXU(p.n),r.rXU(c.U),r.rXU(a.fw),r.rXU(r.gRc),r.rXU(l.W),r.rXU(g.B))}}static{this.ɵcmp=r.VBU({type:WorkPackageCommentComponent,selectors:[["work-package-comment"]],contentQueries:function WorkPackageCommentComponent_ContentQueries(e,t,n){if(1&e&&r.wni(n,r.C4Q,5),2&e){let e;r.mGM(e=r.lsd())&&(t.template=e.first)}},viewQuery:function WorkPackageCommentComponent_Query(e,t){if(1&e&&r.GBs(y,5),2&e){let e;r.mGM(e=r.lsd())&&(t.commentContainer=e.first)}},inputs:{workPackage:"workPackage"},features:[r.Vt3],decls:2,vars:2,consts:[["commentContainer",""],["id","work-package-activites-container",4,"ngIf"],["id","work-package-activites-container"],["id","work-package-activities-tab-content","loading","lazy",3,"src"],["viewBox","0 0 100 100"],["x","0","y","0","width","70","height","5","rx","1"],["x","75","y","0","width","25","height","5","rx","1"],["x","0","y","10","width","100","height","8","rx","1"],["x","0","y","25","width","100","height","12","rx","1"],["id","work-package-comment-container"],[3,"ngTemplateOutlet",4,"ngIf"],["class","work-package--details--long-field work-packages--activity--add-comment hide-when-print",3,"ngClass",4,"ngIf"],[3,"ngTemplateOutlet"],[1,"work-package--details--long-field","work-packages--activity--add-comment","hide-when-print",3,"ngClass"],[1,"inline-edit--container","inplace-edit"],[3,"schemaInput","changeInput","editFieldHandler",4,"ngIf"],[3,"dragover","dragenter",4,"ngIf"],[3,"schemaInput","changeInput","editFieldHandler"],[3,"dragover","dragenter"],[1,"work-package-comment","inline-edit--display-field",3,"click","title"],[1,"work-package-comment--text",3,"textContent"],["icon-classes","icon-edit",1,"work-package-comment--icon",3,"icon-title"]],template:function WorkPackageCommentComponent_Template(e,t){1&e&&r.DNE(0,WorkPackageCommentComponent_div_0_Template,7,1,"div",1)(1,WorkPackageCommentComponent_div_1_Template,5,3,"div",1),2&e&&(r.Y8G("ngIf",t.primerizedActivitiesEnabled),r.R7$(),r.Y8G("ngIf",!t.primerizedActivitiesEnabled))},dependencies:[b.YU,b.bT,b.T3,k.i,v.F,C.u],encapsulation:2,changeDetection:0})}}},96825:(e,t,n)=>{"use strict";n.d(t,{A:()=>WorkPackageCommentFieldComponent});var i=n(24398),o=n(72688),r=n(72159),s=n(1758),a=n(68559),l=n(60316),c=n(20832),p=n(15121);function WorkPackageCommentFieldComponent_edit_field_controls_3_Template(e,t){if(1&e){const e=a.RV6();a.j41(0,"edit-field-controls",4),a.bIt("onSave",(function WorkPackageCommentFieldComponent_edit_field_controls_3_Template_edit_field_controls_onSave_0_listener(){a.eBV(e);const t=a.XpG();return a.Njj(t.handleUserSubmit())}))("onCancel",(function WorkPackageCommentFieldComponent_edit_field_controls_3_Template_edit_field_controls_onCancel_0_listener(){a.eBV(e);const t=a.XpG();return a.Njj(t.handleUserCancel())})),a.k0s()}if(2&e){const e=a.XpG();a.Y8G("fieldController",e.field)("saveTitle",e.text.save)("cancelTitle",e.text.cancel)}}class WorkPackageCommentFieldComponent extends r.r{constructor(){super(...arguments),this.isBusy=!1,this.name="comment"}get required(){return!0}ngOnInit(){super.ngOnInit()}static{this.ɵfac=(()=>{let e;return function WorkPackageCommentFieldComponent_Factory(t){return(e||(e=a.xGo(WorkPackageCommentFieldComponent)))(t||WorkPackageCommentFieldComponent)}})()}static{this.ɵcmp=a.VBU({type:WorkPackageCommentFieldComponent,selectors:[["ng-component"]],features:[a.Vt3],decls:4,vars:3,consts:[[1,"textarea-wrapper"],[1,"op-ckeditor--wrapper","op-ckeditor-element"],[3,"contentChanged","initializationFailed","initializeDone","saveRequested","context","content"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel",4,"ngIf"],[3,"onSave","onCancel","fieldController","saveTitle","cancelTitle"]],template:function WorkPackageCommentFieldComponent_Template(e,t){1&e&&(a.j41(0,"div",0)(1,"div",1)(2,"op-ckeditor",2),a.bIt("contentChanged",(function WorkPackageCommentFieldComponent_Template_op_ckeditor_contentChanged_2_listener(e){return t.onContentChange(e)}))("initializationFailed",(function WorkPackageCommentFieldComponent_Template_op_ckeditor_initializationFailed_2_listener(){return t.initializationError=!0}))("initializeDone",(function WorkPackageCommentFieldComponent_Template_op_ckeditor_initializeDone_2_listener(e){return t.onCkeditorSetup(e)}))("saveRequested",(function WorkPackageCommentFieldComponent_Template_op_ckeditor_saveRequested_2_listener(){return t.handleUserSubmit()})),a.k0s()(),a.DNE(3,WorkPackageCommentFieldComponent_edit_field_controls_3_Template,1,3,"edit-field-controls",3),a.k0s()),2&e&&(a.R7$(2),a.Y8G("context",t.ckEditorContext)("content",t.initialContent),a.R7$(),a.Y8G("ngIf",!(t.handler.inEditMode||t.initializationError)))},dependencies:[l.bT,c.Y,p.C],encapsulation:2})}}(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",o.s)],WorkPackageCommentFieldComponent.prototype,"ConfigurationService",void 0)},66626:(e,t,n)=>{"use strict";n.d(t,{P:()=>ActivityEntryComponent});n(68643);var i=n(73014),o=n(61816),r=n(12313),s=n(68559),a=n(60316),l=n(43837),c=n(49341);function ActivityEntryComponent_revision_activity_1_Template(e,t){if(1&e&&s.nrm(0,"revision-activity",3),2&e){const e=s.XpG();s.Y8G("workPackage",e.workPackage)("activity",e.activity)("activityNo",e.activityNo)("hasUnreadNotification",e.hasUnreadNotification)}}function ActivityEntryComponent_user_activity_2_Template(e,t){if(1&e&&s.nrm(0,"user-activity",4),2&e){const e=s.XpG();s.Y8G("workPackage",e.workPackage)("activity",e.activity)("activityNo",e.activityNo)("isInitial",e.isInitial)("hasUnreadNotification",e.hasUnreadNotification)}}class ActivityEntryComponent{constructor(e,t){this.PathHelper=e,this.I18n=t}ngOnInit(){this.projectId=(0,r.A)(this.workPackage.project.href),this.activityType=this.activity._type}static{this.ɵfac=function ActivityEntryComponent_Factory(e){return new(e||ActivityEntryComponent)(s.rXU(i.B),s.rXU(o.W))}}static{this.ɵcmp=s.VBU({type:ActivityEntryComponent,selectors:[["activity-entry"]],inputs:{workPackage:"workPackage",activity:"activity",activityNo:"activityNo",isInitial:"isInitial",hasUnreadNotification:"hasUnreadNotification"},decls:3,vars:5,consts:[[3,"id","ngSwitch"],[3,"workPackage","activity","activityNo","hasUnreadNotification",4,"ngSwitchCase"],[3,"workPackage","activity","activityNo","isInitial","hasUnreadNotification",4,"ngSwitchDefault"],[3,"workPackage","activity","activityNo","hasUnreadNotification"],[3,"workPackage","activity","activityNo","isInitial","hasUnreadNotification"]],template:function ActivityEntryComponent_Template(e,t){1&e&&(s.j41(0,"div",0),s.DNE(1,ActivityEntryComponent_revision_activity_1_Template,1,4,"revision-activity",1)(2,ActivityEntryComponent_user_activity_2_Template,1,5,"user-activity",2),s.k0s()),2&e&&(s.Mz_("id","activity-",t.activityNo,""),s.Y8G("ngSwitch",t.activityType),s.BMQ("data-qa-activity-number",t.activityNo),s.R7$(),s.Y8G("ngSwitchCase","Revision"))},dependencies:[a.ux,a.e1,a.fG,l.c,c.U],encapsulation:2})}}},43570:(e,t,n)=>{"use strict";n.d(t,{d:()=>ActivityLinkComponent});n(68643);var i=n(68559),o=n(88955);const _c0=(e,t)=>({workPackageId:e,"#":t});class ActivityLinkComponent{ngOnInit(){this.activityHtmlId=`activity-${this.activityNo}`,this.activityLabel=`#${this.activityNo}`}static{this.ɵfac=function ActivityLinkComponent_Factory(e){return new(e||ActivityLinkComponent)}}static{this.ɵcmp=i.VBU({type:ActivityLinkComponent,selectors:[["activity-link"]],inputs:{workPackage:"workPackage",activityNo:"activityNo"},decls:1,vars:7,consts:[["uiSref","work-packages.show",3,"id","textContent","uiParams"]],template:function ActivityLinkComponent_Template(e,t){1&e&&i.nrm(0,"a",0),2&e&&(i.Mz_("id","",t.activityHtmlId,"-link"),i.Y8G("textContent",t.activityLabel)("uiParams",i.l_i(4,_c0,t.workPackage.id,t.activityHtmlId)))},dependencies:[o.UISref,o.AnchorUISref],encapsulation:2})}}},39056:(e,t,n)=>{"use strict";n.d(t,{j:()=>CommentService});var i=n(61816),o=n(72650),r=n(84205),s=n(75797),a=n(49349),l=n(68559);class CommentService{constructor(e,t,n){this.I18n=e,this.workPackageNotificationService=t,this.toastService=n,this.quoteEvents$=new r.B,this.draft$=new s.t(null)}createComment(e,t){return e.addComment({comment:t},{"Content-Type":"application/json; charset=UTF-8"}).catch((t=>this.errorAndReject(t,e)))}updateComment(e,t){JSON.stringify({comment:t});return e.update({comment:t},{"Content-Type":"application/json; charset=UTF-8"}).then((e=>(this.toastService.addSuccess(this.I18n.t("js.work_packages.comment_updated")),e))).catch((e=>this.errorAndReject(e)))}errorAndReject(e,t){return this.workPackageNotificationService.handleRawError(e,t),Promise.reject(e)}static{this.ɵfac=function CommentService_Factory(e){return new(e||CommentService)(l.KVO(i.W),l.KVO(a.U),l.KVO(o.fw))}}static{this.ɵprov=l.jDH({token:CommentService,factory:CommentService.ɵfac})}}},49341:(e,t,n)=>{"use strict";n.d(t,{U:()=>RevisionActivityComponent});var i=n(61816),o=n(14593),r=n(32420),s=(n(68643),n(12313)),a=n(68559),l=n(60316),c=n(48377),p=n(43570);const _c0=e=>({name:e});function RevisionActivityComponent_div_0_span_2_Template(e,t){1&e&&a.nrm(0,"span",11)}function RevisionActivityComponent_div_0_op_principal_4_Template(e,t){if(1&e&&a.nrm(0,"op-principal",12),2&e){const e=a.XpG(2);a.Y8G("principal",e.activity.author)("hideName",!0)}}function RevisionActivityComponent_div_0_op_principal_5_Template(e,t){if(1&e&&a.nrm(0,"op-principal",12),2&e){const e=a.XpG(2);a.Y8G("principal",a.eq3(2,_c0,e.userName))("hideName",!0)}}function RevisionActivityComponent_div_0_span_6_Template(e,t){if(1&e&&(a.j41(0,"span",13),a.nrm(1,"a",14),a.k0s()),2&e){const e=a.XpG(2);a.R7$(),a.Y8G("textContent",e.userName),a.BMQ("href",e.userPath,a.B4B)("aria-label",e.userLabel)}}function RevisionActivityComponent_div_0_span_7_Template(e,t){if(1&e&&a.nrm(0,"span",15),2&e){const e=a.XpG(2);a.Y8G("textContent",e.userName)}}function RevisionActivityComponent_div_0_Template(e,t){if(1&e&&(a.j41(0,"div",1)(1,"div",2),a.DNE(2,RevisionActivityComponent_div_0_span_2_Template,1,0,"span",3),a.nrm(3,"activity-link",4),a.k0s(),a.DNE(4,RevisionActivityComponent_div_0_op_principal_4_Template,1,2,"op-principal",5)(5,RevisionActivityComponent_div_0_op_principal_5_Template,1,4,"op-principal",5)(6,RevisionActivityComponent_div_0_span_6_Template,2,3,"span",6)(7,RevisionActivityComponent_div_0_span_7_Template,1,1,"span",7),a.EFF(8,"  "),a.nrm(9,"span",8),a.j41(10,"span",9),a.nrm(11,"span",10),a.k0s()()),2&e){const e=a.XpG();a.BMQ("data-notification-selector",e.hasUnreadNotification?"notification-activity":null),a.R7$(2),a.Y8G("ngIf",e.hasUnreadNotification),a.R7$(),a.Y8G("workPackage",e.workPackage)("activityNo",e.activityNo),a.R7$(),a.Y8G("ngIf",e.activity.author),a.R7$(),a.Y8G("ngIf",!e.activity.author&&e.userName),a.R7$(),a.Y8G("ngIf",e.userActive),a.R7$(),a.Y8G("ngIf",!e.userActive),a.R7$(2),a.Y8G("innerHtml",e.revisionLink,a.npT),a.R7$(2),a.Y8G("innerHtml",e.message,a.npT)}}class RevisionActivityComponent{constructor(e,t,n,i){this.I18n=e,this.timezoneService=t,this.cdRef=n,this.apiV3Service=i}ngOnInit(){this.loadAuthor(),this.project=this.workPackage.project,this.revision=this.activity.identifier,this.message=this.activity.message.html;const e=this.activity.showRevision.$link.href,t=this.activity.formattedIdentifier,n=document.createElement("a");n.href=e,n.title=this.revision,n.textContent=this.I18n.t("js.label_committed_link",{revision_identifier:t}),this.revisionLink=this.I18n.t("js.label_committed_at",{committed_revision_link:n.outerHTML,date:this.timezoneService.formattedDatetime(this.activity.createdAt)})}loadAuthor(){void 0===this.activity.author?this.userName=this.activity.authorName:this.apiV3Service.users.id((0,s.A)(this.activity.author.href)).get().subscribe((e=>{this.userId=e.id,this.userName=e.name,this.userActive=e.isActive,this.userAvatar=e.avatar,this.userPath=e.showUser.href,this.userLabel=this.I18n.t("js.label_author",{user:this.userName}),this.cdRef.detectChanges()}))}static{this.ɵfac=function RevisionActivityComponent_Factory(e){return new(e||RevisionActivityComponent)(a.rXU(i.W),a.rXU(r.D),a.rXU(a.gRc),a.rXU(o.n))}}static{this.ɵcmp=a.VBU({type:RevisionActivityComponent,selectors:[["revision-activity"]],inputs:{workPackage:"workPackage",activity:"activity",activityNo:"activityNo",hasUnreadNotification:"hasUnreadNotification"},decls:1,vars:1,consts:[["class","work-package-details-activities-activity-contents",4,"ngIf"],[1,"work-package-details-activities-activity-contents"],[1,"comments-number"],["class","comments-number--bubble op-bubble op-bubble_mini","data-test-selector","revision-activity-bubble",4,"ngIf"],[1,"comments-number--link",3,"workPackage","activityNo"],[3,"principal","hideName",4,"ngIf"],["class","user",4,"ngIf"],["class","user",3,"textContent",4,"ngIf"],[1,"revision-activity--revision-link","date",3,"innerHtml"],[1,"user-comment","wiki"],[1,"message",3,"innerHtml"],["data-test-selector","revision-activity-bubble",1,"comments-number--bubble","op-bubble","op-bubble_mini"],[3,"principal","hideName"],[1,"user"],[3,"textContent"],[1,"user",3,"textContent"]],template:function RevisionActivityComponent_Template(e,t){1&e&&a.DNE(0,RevisionActivityComponent_div_0_Template,12,10,"div",0),2&e&&a.Y8G("ngIf",t.workPackage)},dependencies:[l.bT,c.f,p.d],encapsulation:2,changeDetection:0})}}},43837:(e,t,n)=>{"use strict";n.d(t,{c:()=>UserActivityComponent});var i=n(89204),o=n(73014),r=n(72688),s=n(61816),a=n(14593),l=n(60402),c=n(17456),p=n(39056),d=(n(68643),n(27514),n(12313)),u=n(36652),h=n(68559),m=n(80436),g=n(60316),f=n(46765),b=n(48377),k=n(2731),v=n(43063),C=n(45085),y=n(43570);function UserActivityComponent_div_0_op_principal_2_Template(e,t){if(1&e&&h.nrm(0,"op-principal",18),2&e){const e=h.XpG(2);h.Y8G("principal",e.user)("hideName",!0)}}function UserActivityComponent_div_0_span_9_Template(e,t){1&e&&h.nrm(0,"span",19)}function UserActivityComponent_div_0_button_12_Template(e,t){if(1&e){const e=h.RV6();h.j41(0,"button",20),h.bIt("click",(function UserActivityComponent_div_0_button_12_Template_button_click_0_listener(){h.eBV(e);const t=h.XpG(2);return h.Njj(t.quoteComment())})),h.nrm(1,"op-icon",21),h.k0s()}if(2&e){const e=h.XpG(2);h.Y8G("title",e.text.quote_comment)}}function UserActivityComponent_div_0_button_13_Template(e,t){if(1&e){const e=h.RV6();h.j41(0,"button",22),h.bIt("click",(function UserActivityComponent_div_0_button_13_Template_button_click_0_listener(){h.eBV(e);const t=h.XpG(2);return h.Njj(t.activate())})),h.nrm(1,"op-icon",23),h.k0s()}if(2&e){const e=h.XpG(2);h.Y8G("ngClass","edit-activity--"+e.activityNo)("title",e.text.edit_comment)}}function UserActivityComponent_div_0_img_14_Template(e,t){if(1&e&&h.nrm(0,"img",24),2&e){const e=h.XpG(2);h.Y8G("src",e.bcfSnapshotUrl,h.B4B)}}function UserActivityComponent_div_0_div_16_Template(e,t){if(1&e&&(h.j41(0,"div",25)(1,"div",26),h.nrm(2,"edit-form-portal",27),h.k0s()()),2&e){const e=h.XpG(2);h.R7$(2),h.Y8G("changeInput",e.change)("schemaInput",e.schema)("editFieldHandler",e.handler)}}function UserActivityComponent_div_0_div_17_Template(e,t){if(1&e&&(h.j41(0,"div",28),h.nrm(1,"div",29),h.k0s()),2&e){const e=h.XpG(2);h.R7$(),h.Y8G("innerHtml",e.postedComment,h.npT)}}function UserActivityComponent_div_0_ul_18_li_1_Template(e,t){if(1&e&&(h.j41(0,"li"),h.nrm(1,"span",32),h.k0s()),2&e){const e=t.$implicit;h.R7$(),h.Y8G("innerHtml",e,h.npT)}}function UserActivityComponent_div_0_ul_18_Template(e,t){if(1&e&&(h.j41(0,"ul",30),h.DNE(1,UserActivityComponent_div_0_ul_18_li_1_Template,2,1,"li",31),h.k0s()),2&e){const e=h.XpG(2);h.R7$(),h.Y8G("ngForOf",e.details)}}function UserActivityComponent_div_0_Template(e,t){if(1&e){const e=h.RV6();h.j41(0,"div",1),h.bIt("mouseenter",(function UserActivityComponent_div_0_Template_div_mouseenter_0_listener(){h.eBV(e);const t=h.XpG();return h.Njj(t.focus())}))("mouseleave",(function UserActivityComponent_div_0_Template_div_mouseleave_0_listener(){h.eBV(e);const t=h.XpG();return h.Njj(t.blur())})),h.j41(1,"div",2),h.DNE(2,UserActivityComponent_div_0_op_principal_2_Template,1,2,"op-principal",3),h.j41(3,"div"),h.nrm(4,"op-user-link",4),h.j41(5,"span",5),h.EFF(6),h.nrm(7,"op-date-time",6),h.k0s()()(),h.j41(8,"div",7),h.DNE(9,UserActivityComponent_div_0_span_9_Template,1,0,"span",8),h.nrm(10,"activity-link",9),h.j41(11,"div",10),h.DNE(12,UserActivityComponent_div_0_button_12_Template,2,1,"button",11)(13,UserActivityComponent_div_0_button_13_Template,2,2,"button",12),h.k0s()(),h.DNE(14,UserActivityComponent_div_0_img_14_Template,1,1,"img",13),h.j41(15,"div",14),h.DNE(16,UserActivityComponent_div_0_div_16_Template,3,3,"div",15)(17,UserActivityComponent_div_0_div_17_Template,2,1,"div",16)(18,UserActivityComponent_div_0_ul_18_Template,2,1,"ul",17),h.k0s()()}if(2&e){const e=h.XpG();h.BMQ("data-notification-selector",e.hasUnreadNotification?"notification-activity":null),h.R7$(2),h.Y8G("ngIf",e.userName),h.R7$(2),h.Y8G("user",e.user),h.R7$(2),h.SpI(" ",e.isInitial?e.text.label_created_on:e.text.label_updated_on," "),h.R7$(),h.Y8G("dateTimeValue",e.activity.createdAt),h.R7$(2),h.Y8G("ngIf",e.hasUnreadNotification),h.R7$(),h.Y8G("workPackage",e.workPackage)("activityNo",e.activityNo),h.R7$(),h.Y8G("hidden",e.shouldHideIcons()),h.R7$(),h.Y8G("ngIf",e.userCanQuote),h.R7$(),h.Y8G("ngIf",e.userCanEdit),h.R7$(),h.Y8G("ngIf",e.bcfSnapshotUrl),h.R7$(2),h.Y8G("ngIf",e.active),h.R7$(),h.Y8G("ngIf",!e.active&&(e.isComment||e.isBcfComment)),h.R7$(),h.Y8G("ngIf",!e.isInitial)}}class UserActivityComponent extends l.B{constructor(e,t,n,i,o,r,s,a,l,c,p,d,u){super(e,t),this.elementRef=e,this.injector=t,this.sanitization=n,this.PathHelper=i,this.wpLinkedActivities=o,this.commentService=r,this.configurationService=s,this.apiV3Service=a,this.cdRef=l,this.I18n=c,this.ngZone=p,this.deviceService=d,this.appRef=u,this.additionalScrollMargin=200,this.userCanEdit=!1,this.userCanQuote=!1,this.details=[],this.focused=!1,this.text={label_created_on:this.I18n.t("js.label_created_on"),label_updated_on:this.I18n.t("js.label_updated_on"),quote_comment:this.I18n.t("js.label_quote_comment"),edit_comment:this.I18n.t("js.label_edit_comment")}}ngOnInit(){super.ngOnInit(),this.htmlId=`user_activity_edit_field_${this.activityNo}`,this.updateCommentText(),this.isComment="Activity::Comment"===this.activity._type,this.isBcfComment="Activity::BcfComment"===this.activity._type,this.$element=jQuery(this.elementRef.nativeElement),this.reset(),this.userCanEdit=!!this.activity.update,this.userCanQuote=!!this.workPackage.addComment,this.$element.bind("focusin",this.focus.bind(this)),this.$element.bind("focusout",this.blur.bind(this)),_.each(this.activity.details,(e=>{this.details.push(this.sanitization.bypassSecurityTrustHtml(e.html))})),this.apiV3Service.users.id((0,d.A)(this.activity.user.href)).get().subscribe((e=>{this.user=e,this.userId=e.id,this.userName=e.name,this.userAvatar=e.avatar,this.cdRef.detectChanges()})),window.location.hash===`#activity-${this.activityNo}`&&this.ngZone.runOutsideAngular((()=>{setTimeout((()=>{if(this.deviceService.isMobile)return void this.elementRef.nativeElement.scrollIntoView(!0);const e=document.querySelectorAll(`[data-qa-activity-number='${this.activityNo}']`)[0],t=document.querySelectorAll("[data-notification-selector='notification-scroll-container']")[0],n=e.offsetTop-t.offsetTop-this.additionalScrollMargin;t.scrollTop=n}))}))}shouldHideIcons(){return!((this.isComment||this.isBcfComment)&&this.focussing())}activate(){super.activate(this.activity.comment.raw),this.cdRef.detectChanges()}handleUserSubmit(){return this.inFlight||!this.rawComment?Promise.resolve():this.updateComment()}quoteComment(){this.commentService.quoteEvents$.next(this.quotedText(this.activity.comment.raw))}get bcfSnapshotUrl(){return _.get(this.activity,"bcfViewpoints[0]")?`${_.get(this.activity,"bcfViewpoints[0]").href}/snapshot`:null}updateComment(){var e=this;return(0,i.A)((function*(){return e.inFlight=!0,yield e.onSubmit(),e.commentService.updateComment(e.activity,e.rawComment||"").then((t=>{e.activity=t,e.updateCommentText(),e.wpLinkedActivities.require(e.workPackage,!0),e.apiV3Service.work_packages.cache.updateWorkPackage(e.workPackage)})).finally((()=>{e.deactivate(!0),e.inFlight=!1}))}))()}focusEditIcon(){jQuery(`.edit-activity--${this.activityNo} a`).focus()}focus(){this.focused=!0,this.cdRef.detectChanges()}blur(){this.focused=!1,this.cdRef.detectChanges()}focussing(){return this.focused}setErrors(e){}quotedText(e){const t=e.split("\n").map((e=>`\n> ${e}`)).join("");return`${this.I18n.instance_locale_translate("js.text_user_wrote",{value:this.userName})}\n${t}`}deactivate(e){super.deactivate(e),e&&this.focusEditIcon()}updateCommentText(){this.postedComment=this.sanitization.bypassSecurityTrustHtml(this.activity.comment.html)}static{this.ɵfac=function UserActivityComponent_Factory(e){return new(e||UserActivityComponent)(h.rXU(h.aKT),h.rXU(h.zZn),h.rXU(m.up),h.rXU(o.B),h.rXU(c.Z),h.rXU(p.j),h.rXU(r.s),h.rXU(a.n),h.rXU(h.gRc),h.rXU(s.W),h.rXU(h.SKi),h.rXU(u.g),h.rXU(h.o8S))}}static{this.ɵcmp=h.VBU({type:UserActivityComponent,selectors:[["user-activity"]],inputs:{workPackage:"workPackage",activity:"activity",activityNo:"activityNo",isInitial:"isInitial",hasUnreadNotification:"hasUnreadNotification"},features:[h.Vt3],decls:1,vars:1,consts:[["class","op-user-activity work-package-details-activities-activity-contents",3,"mouseenter","mouseleave",4,"ngIf"],[1,"op-user-activity","work-package-details-activities-activity-contents",3,"mouseenter","mouseleave"],[1,"op-user-activity--user-line"],["class","op-user-activity--avatar",3,"principal","hideName",4,"ngIf"],[1,"op-user-activity--user-name",3,"user"],[1,"op-user-activity--date"],[3,"dateTimeValue"],[1,"comments-number"],["class","comments-number--bubble op-bubble op-bubble_mini","data-test-selector","user-activity-bubble",4,"ngIf"],[1,"comments-number--link",3,"workPackage","activityNo"],[1,"comments-icons",3,"hidden"],["type","button","class","spot-link",3,"title","click",4,"ngIf"],["type","button","class","spot-link",3,"ngClass","title","click",4,"ngIf"],["class","activity-thumbnail",3,"src",4,"ngIf"],[1,"user-comment"],["class","inplace-edit",4,"ngIf"],["class","message",4,"ngIf"],["class","work-package-details-activities-messages",4,"ngIf"],[1,"op-user-activity--avatar",3,"principal","hideName"],["data-test-selector","user-activity-bubble",1,"comments-number--bubble","op-bubble","op-bubble_mini"],["type","button",1,"spot-link",3,"click","title"],["icon-classes","action-icon icon-quote"],["type","button",1,"spot-link",3,"click","ngClass","title"],["icon-classes","action-icon icon-edit"],[1,"activity-thumbnail",3,"src"],[1,"inplace-edit"],[1,"user-comment--form","inplace-edit--write-value"],[3,"changeInput","schemaInput","editFieldHandler"],[1,"message"],[1,"op-uc-container",3,"innerHtml"],[1,"work-package-details-activities-messages"],[4,"ngFor","ngForOf"],[1,"message",3,"innerHtml"]],template:function UserActivityComponent_Template(e,t){1&e&&h.DNE(0,UserActivityComponent_div_0_Template,19,15,"div",0),2&e&&h.Y8G("ngIf",t.workPackage)},dependencies:[g.YU,g.Sq,g.bT,f.i,b.f,k.U,v.u,C.F,y.d],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-user-activity--user-line[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:50px;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis}.op-user-activity--user-name[_ngcontent-%COMP%]{display:block;font-weight:var(--base-text-weight-bold);line-height:16px;margin-bottom:3px}.op-user-activity--date[_ngcontent-%COMP%]{display:block;font-size:.8rem;color:var(--fgColor-muted)}.op-user-activity--avatar[_ngcontent-%COMP%]{flex-shrink:0;margin-right:.5rem}"],changeDetection:0})}}},51002:(e,t,n)=>{"use strict";n.d(t,{JU:()=>getBaselineState,PL:()=>baselineFilterFromValue,hm:()=>getPartsFromTimestamp,s2:()=>offsetToUtcString});var i=n(58154),o=n(6923);const r=["oneDayAgo","lastWorkingDay","oneWeekAgo","oneMonthAgo","aSpecificDate","betweenTwoSpecificDates"];function baselineFilterFromValue(e){if(e.length<2)return null;const t=e[0].split("@")[0];return r.includes(t)?t:e[1]===i.R8?"aSpecificDate":"betweenTwoSpecificDates"}function getPartsFromTimestamp(e){if(e.includes("@")){const[t,n]=e.split(/[@]/),[i,o]=n.split(/(?=[+-])/);return{date:t,time:i,offset:o}}if("PT0S"!==e){const t=o.parseZone(e);return{date:t.format("YYYY-MM-DD"),time:t.format("HH:mm"),offset:t.format("Z")}}return null}function getBaselineState(e,t){let n="";const i=t.of(e),o=e.attributesByTimestamp||[];if(o.length>1){const e=o[0],t=o[1];!e._meta.exists&&t._meta.exists||!e._meta.matchesFilters&&t._meta.matchesFilters?n="added":e._meta.exists&&!t._meta.exists||e._meta.matchesFilters&&!t._meta.matchesFilters?n="removed":function attributeChanged(e,t){return!!t.availableAttributes.find((n=>{const i=t.mappedName(n);return Object.prototype.hasOwnProperty.call(e,i)||Object.prototype.hasOwnProperty.call(e.$links,i)}))}(e,i)&&(n="updated")}else n="";return n}function offsetToUtcString(e){return`UTC${e.replace(/^([+-])0/,"$1").replace(":00","").replace(":30",".5")}`}},76745:(e,t,n)=>{"use strict";n.d(t,{C:()=>OpBaselineLegendsComponent});var i=n(61816),o=n(58154),r=n(11048),s=n(44674),a=n(51002),l=n(32420),c=n(6923),p=n(72688),d=n(99496),u=n(51567),h=n(68559),m=n(60316);function OpBaselineLegendsComponent_span_3_Template(e,t){if(1&e&&h.nrm(0,"span",10),2&e){const e=h.XpG();h.FCK("title","",e.text.in_your_timezone," ",e.localDate,"")}}class OpBaselineLegendsComponent extends d.p{constructor(e,t,n,i,o,r,s){super(),this.I18n=e,this.wpTableBaseline=t,this.querySpace=n,this.schemaCache=i,this.timezoneService=o,this.configuration=r,this.cdRef=s,this.className=!0,this.numAdded=0,this.numRemoved=0,this.numUpdated=0,this.text={now_meets_filter_criteria:this.I18n.t("js.baseline.legends.now_meets_filter_criteria"),no_longer_meets_filter_criteria:this.I18n.t("js.baseline.legends.no_longer_meets_filter_criteria"),maintained_with_changes:this.I18n.t("js.baseline.legends.maintained_with_changes"),in_your_timezone:this.I18n.t("js.baseline.legends.in_your_timezone")}}ngOnInit(){this.wpTableBaseline.live$().pipe(this.untilDestroyed(),(0,u.p)((()=>this.wpTableBaseline.isActive()))).subscribe((e=>{this.userTimezone=this.timezoneService.userTimezone(),this.userOffset=c.tz(this.userTimezone).format("Z");const t=(0,a.hm)(e[0]);t&&(this.offset=t.offset),this.getBaselineDetails(),this.getFilterName(e),this.cdRef.detectChanges()}))}getFilterName(e){const t=e.map((e=>e.split(/[@T]/))),n=(0,a.PL)(this.wpTableBaseline.current),i=this.deriveChangesSinceOrBetween(n);let o="",r="",s="";switch(n){case"oneDayAgo":[r,s]=this.deriveSingleDate(this.wpTableBaseline.yesterdayDate(),t[0][1]),o=this.I18n.t("js.baseline.drop_down.yesterday"),o+=` (${r})`;break;case"lastWorkingDay":[r,s]=this.deriveSingleDate(this.wpTableBaseline.lastWorkingDate(),t[0][1]),o=this.I18n.t("js.baseline.drop_down.last_working_day"),o+=` (${r})`;break;case"oneWeekAgo":[r,s]=this.deriveSingleDate(this.wpTableBaseline.lastweekDate(),t[0][1]),o=this.I18n.t("js.baseline.drop_down.last_week"),o+=` (${r})`;break;case"oneMonthAgo":[r,s]=this.deriveSingleDate(this.wpTableBaseline.lastMonthDate(),t[0][1]),o=this.I18n.t("js.baseline.drop_down.last_month"),o+=` (${r})`;break;case"aSpecificDate":[r,s]=this.formatUpstreamAndLocal(c.parseZone(e[0])),o+=r;break;case"betweenTwoSpecificDates":[r,s]=this.deriveDateRange(c.parseZone(e[0]),c.parseZone(e[1])),o+=r}return o=`${i} ${o}`,this.legendDescription=o,this.localDate=s,o}deriveChangesSinceOrBetween(e){return"betweenTwoSpecificDates"===e?this.I18n.t("js.baseline.legends.changes_between"):this.I18n.t("js.baseline.legends.changes_since")}deriveSingleDate(e,t){const n=c.parseZone(`${e}T${t}`);return this.formatUpstreamAndLocal(n)}deriveDateRange(e,t){const n=this.formatUpstreamAndLocal(e),i=this.formatUpstreamAndLocal(t);return[`${n[0]} ${this.I18n.t("js.label_and")} ${i[0]}`,`${n[1]} - ${i[1]}`]}formatUpstreamAndLocal(e){return[this.formatDate(e),this.formatDate(e.tz(this.userTimezone))]}getBaselineDetails(){this.numAdded=0,this.numRemoved=0,this.numUpdated=0;let e="";const t=this.wpTableBaseline.isActive(),n=this.querySpace.results.value;t&&n&&n.elements.length>0&&(n.elements.forEach((t=>{e=(0,a.JU)(t,this.schemaCache),"added"===e?this.numAdded+=1:"removed"===e?this.numRemoved+=1:"updated"===e&&(this.numUpdated+=1)})),this.text.maintained_with_changes=`${this.I18n.t("js.baseline.legends.maintained_with_changes")} (${this.numUpdated})`,this.text.no_longer_meets_filter_criteria=`${this.I18n.t("js.baseline.legends.no_longer_meets_filter_criteria")} (${this.numRemoved})`,this.text.now_meets_filter_criteria=`${this.I18n.t("js.baseline.legends.now_meets_filter_criteria")} (${this.numAdded})`)}formatDate(e){return`${e.format(this.timezoneService.getDateFormat())} ${e.format(this.timezoneService.getTimeFormat())} ${(0,a.s2)(e.format("Z"))}`}static{this.ɵfac=function OpBaselineLegendsComponent_Factory(e){return new(e||OpBaselineLegendsComponent)(h.rXU(i.W),h.rXU(o.b1),h.rXU(r.i),h.rXU(s.D),h.rXU(l.D),h.rXU(p.s),h.rXU(h.gRc))}}static{this.ɵcmp=h.VBU({type:OpBaselineLegendsComponent,selectors:[["op-baseline-legends"]],hostVars:2,hostBindings:function OpBaselineLegendsComponent_HostBindings(e,t){2&e&&h.AVh("op-baseline-legends",t.className)},features:[h.Vt3],decls:14,vars:5,consts:[[1,"op-baseline-legends--filter"],[3,"textContent"],["data-test-selector","baseline-legend-time-offset","class","spot-icon spot-icon_1 spot-icon_info2",3,"title",4,"ngIf"],[1,"op-baseline-legends--details","hidden-for-mobile"],[1,"spot-icon","spot-icon_1","spot-icon_arrow-in","op-baseline-legends--details-icon-added"],[1,"op-baseline-legends--details-added"],[1,"spot-icon","spot-icon_1","spot-icon_arrow-out","op-baseline-legends--details-icon-removed"],[1,"op-baseline-legends--details-removed"],[1,"spot-icon","spot-icon_1","spot-icon_delta-triangle","op-baseline-legends--details-icon-changed"],[1,"op-baseline-legends--details-changed"],["data-test-selector","baseline-legend-time-offset",1,"spot-icon","spot-icon_1","spot-icon_info2",3,"title"]],template:function OpBaselineLegendsComponent_Template(e,t){1&e&&(h.j41(0,"span",0),h.nrm(1,"span",1),h.EFF(2," "),h.DNE(3,OpBaselineLegendsComponent_span_3_Template,1,3,"span",2),h.k0s(),h.j41(4,"div",3),h.nrm(5,"span",4),h.j41(6,"span",5),h.EFF(7),h.k0s(),h.nrm(8,"span",6),h.j41(9,"span",7),h.EFF(10),h.k0s(),h.nrm(11,"span",8),h.j41(12,"span",9),h.EFF(13),h.k0s()()),2&e&&(h.R7$(),h.Y8G("textContent",t.legendDescription),h.R7$(2),h.Y8G("ngIf",t.userOffset!==t.offset),h.R7$(4),h.JRh(t.text.now_meets_filter_criteria),h.R7$(3),h.JRh(t.text.no_longer_meets_filter_criteria),h.R7$(3),h.JRh(t.text.maintained_with_changes))},dependencies:[m.bT],styles:[".cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-baseline-legends{display:flex;flex-direction:row;align-items:center;padding:.75rem 1rem;border:1px solid rgb(204,204,204);margin-right:1rem;margin-bottom:.5rem;font-family:var(--body-font-family);font-size:.75rem;font-weight:400;font-style:normal;line-height:1rem}.op-baseline-legends--filter{display:flex;align-items:center;column-gap:.5rem}.op-baseline-legends--tooltip{width:max-content}.op-baseline-legends--details{display:flex;flex-direction:row;align-items:flex-start;justify-content:flex-end;gap:.25rem;margin-left:auto}.op-baseline-legends--details-added,.op-baseline-legends--details-removed{margin-right:.5rem}.op-baseline-legends--details-icon-added{color:#5f42e0}.op-baseline-legends--details--icon-removed{color:#555}.op-baseline-legends--details-icon-changed{color:#54afe0}@media screen and (max-width: 543px){.op-baseline-legends{margin-left:1rem}}\n"],encapsulation:2,changeDetection:0})}}},87297:(e,t,n)=>{"use strict";n.d(t,{I:()=>OpBaselineLoadingComponent});var i=n(68559),o=n(53689);class OpBaselineLoadingComponent{static{this.ɵfac=function OpBaselineLoadingComponent_Factory(e){return new(e||OpBaselineLoadingComponent)}}static{this.ɵcmp=i.VBU({type:OpBaselineLoadingComponent,selectors:[["op-baseline-loading"]],decls:4,vars:0,consts:[["viewBox","0 0 200 140"],["x","10","width","90%","height","45","rx","1"],["x","10","y","51","width","90%","height","45","rx","1"],["x","10","y","102","width","90%","height","30","rx","1"]],template:function OpBaselineLoadingComponent_Template(e,t){1&e&&(i.j41(0,"op-content-loader",0),i.qSk(),i.nrm(1,"rect",1)(2,"rect",2)(3,"rect",3),i.k0s())},dependencies:[o.F],encapsulation:2,changeDetection:0})}}},29039:(e,t,n)=>{"use strict";n.d(t,{f:()=>OpBaselineModalComponent});var i=n(61816),o=n(68559),r=n(93338),s=n(81711);class OpBaselineModalComponent{constructor(e){this.I18n=e,this.className=!0,this.opened=!1,this.text={toggle_title:this.I18n.t("js.baseline.toggle_title"),header_description:this.I18n.t("js.baseline.header_description"),clear:this.I18n.t("js.baseline.clear"),apply:this.I18n.t("js.baseline.apply")}}toggleOpen(){this.opened=!this.opened}static{this.ɵfac=function OpBaselineModalComponent_Factory(e){return new(e||OpBaselineModalComponent)(o.rXU(i.W))}}static{this.ɵcmp=o.VBU({type:OpBaselineModalComponent,selectors:[["op-baseline-modal"]],hostVars:2,hostBindings:function OpBaselineModalComponent_HostBindings(e,t){2&e&&o.AVh("op-baseline-modal",t.className)},decls:6,vars:7,consts:[[1,"op-baseline-modal",3,"closed","opened"],["slot","trigger","type","button","data-test-selector","baseline-button",1,"button",3,"click","title"],[1,"spot-icon","spot-icon_baseline"],[1,"spot-icon","spot-icon_dropdown"],["slot","body",3,"submitted","visible","showActionBar"]],template:function OpBaselineModalComponent_Template(e,t){1&e&&(o.j41(0,"spot-drop-modal",0),o.bIt("closed",(function OpBaselineModalComponent_Template_spot_drop_modal_closed_0_listener(){return t.opened=!1})),o.j41(1,"button",1),o.bIt("click",(function OpBaselineModalComponent_Template_button_click_1_listener(){return t.toggleOpen()})),o.nrm(2,"span",2),o.EFF(3),o.nrm(4,"span",3),o.k0s(),o.j41(5,"op-baseline",4),o.bIt("submitted",(function OpBaselineModalComponent_Template_op_baseline_submitted_5_listener(){return t.opened=!1})),o.k0s()()),2&e&&(o.Y8G("opened",t.opened),o.R7$(),o.AVh("-active",t.opened),o.Y8G("title",t.text.toggle_title),o.R7$(2),o.SpI(" ",t.text.toggle_title," "),o.R7$(2),o.Y8G("visible",t.opened)("showActionBar",!0))},dependencies:[r.m,s.Q],encapsulation:2,changeDetection:0})}}},81711:(e,t,n)=>{"use strict";n.d(t,{Q:()=>OpBaselineComponent});var i=n(68559),o=n(61816),r=n(99496),s=n(36178),a=n(11073),l=n(74037),c=n(42032),p=n(32420),d=n(72688),u=n(58154),h=n(9585),m=n(51002),g=n(6923),f=n(99972),b=n(38941),k=n(60316),v=n(34456),C=n(88294),y=n(45906),w=n(82028),T=n(87297);const _c0=e=>[e];function OpBaselineComponent_div_1_Template(e,t){if(1&e&&(i.j41(0,"div",6)(1,"span",7),i.EFF(2),i.k0s(),i.nrm(3,"span",8),i.k0s()),2&e){const e=i.XpG();i.R7$(2),i.JRh(e.text.baseline_comparison)}}function OpBaselineComponent_a_4_Template(e,t){if(1&e&&(i.j41(0,"a",9),i.EFF(1),i.nrm(2,"span",10),i.k0s()),2&e){const e=i.XpG();i.BMQ("href",e.text.moreInfoLink,i.B4B),i.R7$(),i.SpI(" ",e.text.more_info_text," ")}}function OpBaselineComponent_form_5_option_5_Template(e,t){if(1&e&&(i.j41(0,"option",23),i.EFF(1),i.k0s()),2&e){const e=t.$implicit,n=i.XpG(2);i.Y8G("value",e.value)("selected",e.value===n.selectedFilter)("disabled",n.eeShowBanners&&"oneDayAgo"!==e.value),i.R7$(),i.SpI(" ",e.title," ")}}function OpBaselineComponent_form_5_span_6_Template(e,t){if(1&e&&(i.j41(0,"span",24),i.EFF(1),i.k0s()),2&e){const e=i.XpG(2);i.R7$(),i.SpI(" ",e.mappedSelectedDate," ")}}function OpBaselineComponent_form_5_spot_form_field_7_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"spot-form-field",25)(1,"input",26),i.bIt("input",(function OpBaselineComponent_form_5_spot_form_field_7_Template_input_input_1_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.dateChange([t.target.value]))})),i.k0s()()}if(2&e){const e=i.XpG(2);i.Y8G("label",e.text.date),i.R7$(),i.Y8G("value",e.selectedDates[0]||"")}}function OpBaselineComponent_form_5_spot_form_field_8_span_3_Template(e,t){if(1&e&&i.nrm(0,"span",31),2&e){const e=i.XpG(3);i.Y8G("textContent",e.text.time_description(0))}}function OpBaselineComponent_form_5_spot_form_field_8_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"spot-form-field",27)(1,"input",28),i.bIt("change",(function OpBaselineComponent_form_5_spot_form_field_8_Template_input_change_1_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.timesChange([t.target.value]))})),i.k0s(),i.nrm(2,"span",29),i.DNE(3,OpBaselineComponent_form_5_spot_form_field_8_span_3_Template,1,1,"span",30),i.k0s()}if(2&e){const e=i.XpG(2);i.Y8G("label",e.text.time),i.R7$(),i.Y8G("value",e.selectedTimes[0]),i.R7$(),i.Y8G("textContent",e.mappedOffset(e.selectedOffsets[0])),i.BMQ("title",e.text.help_description),i.R7$(),i.Y8G("ngIf",e.userOffset!==e.selectedOffsets[0])}}function OpBaselineComponent_form_5_div_9_span_13_Template(e,t){if(1&e&&i.nrm(0,"span",31),2&e){const e=i.XpG(3);i.Y8G("textContent",e.text.time_description(0))}}function OpBaselineComponent_form_5_div_9_span_20_Template(e,t){if(1&e&&i.nrm(0,"span",31),2&e){const e=i.XpG(3);i.Y8G("textContent",e.text.time_description(1))}}function OpBaselineComponent_form_5_div_9_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",32)(1,"spot-form-field",33)(2,"input",34),i.bIt("input",(function OpBaselineComponent_form_5_div_9_Template_input_input_2_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.dateChange([t.target.value,n.selectedDates[1]||""]))})),i.k0s(),i.j41(3,"button",35),i.bIt("click",(function OpBaselineComponent_form_5_div_9_Template_button_click_3_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.setToday("from"))})),i.k0s()(),i.j41(4,"spot-form-field",25)(5,"input",36),i.bIt("input",(function OpBaselineComponent_form_5_div_9_Template_input_input_5_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.dateChange([n.selectedDates[0]||"",t.target.value]))})),i.k0s(),i.j41(6,"button",35),i.bIt("click",(function OpBaselineComponent_form_5_div_9_Template_button_click_6_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.setToday("to"))})),i.k0s()(),i.j41(7,"spot-form-field",37)(8,"input",38),i.bIt("change",(function OpBaselineComponent_form_5_div_9_Template_input_change_8_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.timesChange([t.target.value,n.selectedTimes[1]]))})),i.k0s(),i.j41(9,"spot-tooltip",39),i.nrm(10,"span",40),i.j41(11,"span",41),i.EFF(12),i.k0s()(),i.DNE(13,OpBaselineComponent_form_5_div_9_span_13_Template,1,1,"span",30),i.k0s(),i.j41(14,"spot-form-field",37)(15,"input",42),i.bIt("change",(function OpBaselineComponent_form_5_div_9_Template_input_change_15_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.timesChange([n.selectedTimes[0],t.target.value]))})),i.k0s(),i.j41(16,"spot-tooltip",39),i.nrm(17,"span",40),i.j41(18,"span",41),i.EFF(19),i.k0s()(),i.DNE(20,OpBaselineComponent_form_5_div_9_span_20_Template,1,1,"span",30),i.k0s()()}if(2&e){const e=i.XpG(2);i.R7$(),i.Y8G("label",e.text.from),i.R7$(),i.Y8G("value",e.selectedDates[0]||""),i.R7$(),i.Y8G("textContent",e.text.today),i.R7$(),i.Y8G("label",e.text.to),i.R7$(),i.Y8G("value",e.selectedDates[1]||""),i.R7$(),i.Y8G("textContent",e.text.today),i.R7$(2),i.Y8G("value",e.selectedTimes[0]||""),i.R7$(),i.Y8G("alignment",e.tooltipPosition)("disabled",!1)("light",!0),i.R7$(),i.Y8G("textContent",e.mappedOffset(e.selectedOffsets[0])),i.R7$(2),i.JRh(e.text.help_description),i.R7$(),i.Y8G("ngIf",e.userOffset!==e.selectedOffsets[0]),i.R7$(2),i.Y8G("value",e.selectedTimes[1]||""),i.R7$(),i.Y8G("alignment",e.tooltipPosition)("disabled",!1)("light",!0),i.R7$(),i.Y8G("textContent",e.mappedOffset(e.selectedOffsets[1])),i.R7$(2),i.JRh(e.text.help_description),i.R7$(),i.Y8G("ngIf",e.userOffset!==e.selectedOffsets[1])}}function OpBaselineComponent_form_5_op_datepicker_sheet_10_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-datepicker-sheet",43),i.bIt("datesSelected",(function OpBaselineComponent_form_5_op_datepicker_sheet_10_Template_op_datepicker_sheet_datesSelected_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.selectedDates=t)})),i.k0s()}if(2&e){const e=i.XpG(2);i.Y8G("dates","betweenTwoSpecificDates"===e.selectedFilter?e.selectedDates:i.eq3(3,_c0,e.selectedDates[0]))("mode","betweenTwoSpecificDates"===e.selectedFilter?"range":"single")("isDisabled",e.futureDateComparer())}}function OpBaselineComponent_form_5_div_11_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",44)(1,"div",45)(2,"button",46),i.bIt("click",(function OpBaselineComponent_form_5_div_11_Template_button_click_2_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.resetSelection())})),i.EFF(3),i.k0s(),i.j41(4,"button",47),i.EFF(5),i.k0s()()()}if(2&e){const e=i.XpG(2);i.R7$(2),i.Y8G("disabled",!e.selectedFilter),i.R7$(),i.SpI(" ",e.text.clear," "),i.R7$(2),i.SpI(" ",e.text.apply," ")}}function OpBaselineComponent_form_5_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"form",11),i.bIt("submit",(function OpBaselineComponent_form_5_Template_form_submit_0_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.onSubmit(t))})),i.j41(1,"spot-form-field",12)(2,"div",13)(3,"select",14),i.bIt("change",(function OpBaselineComponent_form_5_Template_select_change_3_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.filterChange(t.target.value))})),i.nrm(4,"option",15),i.DNE(5,OpBaselineComponent_form_5_option_5_Template,2,4,"option",16),i.k0s()(),i.DNE(6,OpBaselineComponent_form_5_span_6_Template,2,1,"span",17),i.k0s(),i.DNE(7,OpBaselineComponent_form_5_spot_form_field_7_Template,2,2,"spot-form-field",18)(8,OpBaselineComponent_form_5_spot_form_field_8_Template,4,5,"spot-form-field",19)(9,OpBaselineComponent_form_5_div_9_Template,21,20,"div",20)(10,OpBaselineComponent_form_5_op_datepicker_sheet_10_Template,1,5,"op-datepicker-sheet",21)(11,OpBaselineComponent_form_5_div_11_Template,6,3,"div",22),i.k0s()}if(2&e){const e=i.XpG();i.AVh("op-baseline--body_ranged","betweenTwoSpecificDates"===e.selectedFilter)("op-baseline_tab",!e.showActionBar),i.R7$(),i.Y8G("label",e.text.show_changes_since),i.R7$(3),i.Y8G("textContent",e.text.drop_down_none_option)("selected",!e.filterSelected)("value","-"),i.R7$(),i.Y8G("ngForOf",e.baselineAvailableValues),i.R7$(),i.Y8G("ngIf",e.mappedSelectedDate),i.R7$(),i.Y8G("ngIf","aSpecificDate"===e.selectedFilter),i.R7$(),i.Y8G("ngIf",e.selectedFilter&&"betweenTwoSpecificDates"!==e.selectedFilter),i.R7$(),i.Y8G("ngIf","betweenTwoSpecificDates"===e.selectedFilter),i.R7$(),i.Y8G("ngIf","aSpecificDate"===e.selectedFilter||"betweenTwoSpecificDates"===e.selectedFilter),i.R7$(),i.Y8G("ngIf",e.showActionBar)}}function OpBaselineComponent_ng_template_7_Template(e,t){1&e&&i.nrm(0,"op-baseline-loading")}const S="08:00";class OpBaselineComponent extends r.p{constructor(e,t,n,o,r,s,l,c){super(),this.I18n=e,this.wpTableBaseline=t,this.halResourceService=n,this.weekdaysService=o,this.daysService=r,this.timezoneService=s,this.configuration=l,this.Banner=c,this.className=!0,this.submitted=new i.bkB,this.showActionBar=!1,this.visible=!0,this.nonWorkingDays$=this.wpTableBaseline.nonWorkingDays$,this.tooltipPosition=a.A.TopRight,this.eeShowBanners=this.Banner.eeShowBanners,this.text={toggle_title:this.I18n.t("js.baseline.toggle_title"),drop_down_none_option:this.I18n.t("js.baseline.drop_down.none"),header_description:this.I18n.t("js.baseline.header_description"),enterprise_header_description:this.I18n.t("js.baseline.enterprise_header_description"),clear:this.I18n.t("js.baseline.clear"),apply:this.I18n.t("js.baseline.apply"),show_changes_since:this.I18n.t("js.baseline.show_changes_since"),from:this.I18n.t("js.baseline.from"),to:this.I18n.t("js.baseline.to"),date:this.I18n.t("js.label_date"),time:this.I18n.t("js.baseline.time"),today:this.I18n.t("js.label_today"),moreInfoLink:b.y$.website,more_info_text:this.I18n.t("js.admin.enterprise.upsale.more_info"),help_description:this.I18n.t("js.baseline.help_description"),baseline_comparison:this.I18n.t("js.baseline.baseline_comparison"),time_description:e=>{const t=this.selectedDates[e],n=this.selectedTimes[e],i=this.selectedOffsets[e];if(!t||!n)return"";const o=g(`${t}T${n}${i}`).tz(this.userTimezone),r=o.format(this.timezoneService.getDateFormat()),s=o.format(this.timezoneService.getTimeFormat());return this.I18n.t("js.baseline.time_description",{datetime:`${r} ${s}`})}},this.baselineAvailableValues=[{value:"oneDayAgo",title:this.I18n.t("js.baseline.drop_down.yesterday")},{value:"lastWorkingDay",title:this.I18n.t("js.baseline.drop_down.last_working_day")},{value:"oneWeekAgo",title:this.I18n.t("js.baseline.drop_down.last_week")},{value:"oneMonthAgo",title:this.I18n.t("js.baseline.drop_down.last_month")},{value:"aSpecificDate",title:this.I18n.t("js.baseline.drop_down.a_specific_date")},{value:"betweenTwoSpecificDates",title:this.I18n.t("js.baseline.drop_down.between_two_specific_dates")}]}ngOnInit(){this.userTimezone=this.timezoneService.userTimezone(),this.userOffset=g().tz(this.userTimezone).format("Z"),this.resetSelection(),this.wpTableBaseline.isActive()&&(this.filterChange((0,m.PL)(this.wpTableBaseline.current)),this.wpTableBaseline.current.forEach(((e,t)=>{const n=(0,m.hm)(e);n&&(this.selectedDates[t]=this.selectedDates[t]?this.selectedDates[t]:n.date,this.selectedTimes[t]=n.time,this.selectedOffsets[t]=n.offset)}))),this.wpTableBaseline.pristine$().subscribe((e=>{_.isEqual(e,[u.R8])&&(this.resetSelection(),this.wpTableBaseline.disable())}))}resetSelection(){this.selectedTimes=[S,S],this.selectedDates=["",""],this.selectedFilter=null,this.mappedSelectedDate=null,this.selectedOffsets=[this.userOffset,this.userOffset]}setToday(e){const t=g().format("YYYY-MM-DD"),n="from"===e?t:this.selectedDates[0],i=t;this.dateChange([n,i])}onSubmit(e){e.preventDefault(),this.onSave()}onSave(){this.wpTableBaseline.update(this.buildBaselineFilter()),this.submitted.emit()}mappedOffset(e){return(0,m.s2)(e)}timesChange(e){this.selectedTimes=e}dateChange(e){_.every(e,h.BY)&&(this.selectedDates=e)}filterChange(e){switch(this.resetSelection(),this.selectedFilter=e,e){case"oneDayAgo":this.updateDateValues(this.wpTableBaseline.yesterdayDate());break;case"lastWorkingDay":this.updateDateValues(this.wpTableBaseline.lastWorkingDate());break;case"oneWeekAgo":this.updateDateValues(this.wpTableBaseline.lastweekDate());break;case"oneMonthAgo":this.updateDateValues(this.wpTableBaseline.lastMonthDate());break;default:this.mappedSelectedDate=null}}futureDateComparer(){const e=g();return t=>g(t.dateObj).isAfter(e,"days")}updateDateValues(e){this.mappedSelectedDate=this.timezoneService.formattedDate(e),this.dateChange([e])}buildBaselineFilter(){switch(this.selectedFilter){case"oneDayAgo":case"oneWeekAgo":case"oneMonthAgo":case"lastWorkingDay":return[this.buildFilterString(0),u.R8];case"aSpecificDate":return[this.buildISOString(0),u.R8];case"betweenTwoSpecificDates":return[this.buildISOString(0),this.buildISOString(1)];default:return[u.R8]}}buildISOString(e){return`${this.selectedDates[e]}T${this.selectedTimes[e]}${this.selectedOffsets[e]}`}buildFilterString(e){const t=`${this.selectedTimes[e]}${this.selectedOffsets[e]}`;return`${this.selectedFilter}@${t}`}static{this.ɵfac=function OpBaselineComponent_Factory(e){return new(e||OpBaselineComponent)(i.rXU(o.W),i.rXU(u.b1),i.rXU(s.t),i.rXU(l.I),i.rXU(c.o),i.rXU(p.D),i.rXU(d.s),i.rXU(f.b))}}static{this.ɵcmp=i.VBU({type:OpBaselineComponent,selectors:[["op-baseline"]],hostVars:2,hostBindings:function OpBaselineComponent_HostBindings(e,t){2&e&&i.AVh("op-baseline",t.className)},inputs:{showActionBar:"showActionBar",visible:"visible"},outputs:{submitted:"submitted"},features:[i.Vt3],decls:9,vars:9,consts:[["loadingTemplate",""],[1,"op-baseline--header"],["class","op-baseline--enterprise-title",4,"ngIf"],[1,"spot-body-small"],["class","op-baseline--info-button spot-body-small","target","”_blank”",4,"ngIf"],["class","spot-container op-baseline--body",3,"op-baseline--body_ranged","op-baseline_tab","submit",4,"ngIf","ngIfElse"],[1,"op-baseline--enterprise-title"],[1,""],[1,"spot-icon","spot-icon_enterprise-addons"],["target","”_blank”",1,"op-baseline--info-button","spot-body-small"],[1,"spot-icon","spot-icon_external-link"],[1,"spot-container","op-baseline--body",3,"submit"],[3,"label"],["slot","input"],["name","op-baseline-filter",1,"op-baseline--filter",3,"change"],[3,"textContent","selected","value"],[3,"value","selected","disabled",4,"ngFor","ngForOf"],["slot","description",4,"ngIf"],["class","op-baseline--date",3,"label",4,"ngIf"],["class","op-baseline--time",3,"label",4,"ngIf"],["class","op-baseline--range-container",4,"ngIf"],["class","op-baseline--datepicker",3,"dates","mode","isDisabled","datesSelected",4,"ngIf"],["class","spot-action-bar",4,"ngIf"],[3,"value","selected","disabled"],["slot","description"],[1,"op-baseline--date",3,"label"],["slot","input","name","op-baseline-date","type","text",1,"op-baseline--date-input",3,"input","value"],[1,"op-baseline--time",3,"label"],["slot","input","name","op-baseline-time","type","time",1,"op-baseline--time-input",3,"change","value"],["slot","input",1,"op-baseline--time-help","spot-body-small",3,"textContent"],["slot","description",3,"textContent",4,"ngIf"],["slot","description",3,"textContent"],[1,"op-baseline--range-container"],[1,"op-baseline--from-date",3,"label"],["slot","input","name","op-baseline-from-date","type","text",1,"op-baseline--date-input",3,"input","value"],["slot","action","type","button",1,"spot-link",3,"click","textContent"],["slot","input","name","op-baseline-to-date","type","text",1,"op-baseline--date-input",3,"input","value"],[1,"op-baseline--time"],["slot","input","name","op-baseline-from-time","type","time",1,"op-baseline--time-input",3,"change","value"],["slot","input",1,"op-baseline--time-tooltip","op-baseline--time-help","spot-body-small",3,"alignment","disabled","light"],["slot","trigger",1,"op-baseline--time-zone",3,"textContent"],["slot","body",1,"spot-body-small","op-baseline--time-tooltip-body"],["slot","input","name","op-baseline-to-time","type","time",1,"op-baseline--time-input",3,"change","value"],[1,"op-baseline--datepicker",3,"datesSelected","dates","mode","isDisabled"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button",1,"button","spot-action-bar--action",3,"click","disabled"],[1,"button","-primary","spot-action-bar--action"]],template:function OpBaselineComponent_Template(e,t){if(1&e&&(i.j41(0,"div",1),i.DNE(1,OpBaselineComponent_div_1_Template,4,1,"div",2),i.j41(2,"span",3),i.EFF(3),i.k0s(),i.DNE(4,OpBaselineComponent_a_4_Template,3,2,"a",4),i.k0s(),i.DNE(5,OpBaselineComponent_form_5_Template,12,15,"form",5),i.nI1(6,"async"),i.DNE(7,OpBaselineComponent_ng_template_7_Template,1,0,"ng-template",null,0,i.C5r)),2&e){const e=i.sdS(8);i.AVh("op-baseline_tab",!t.showActionBar),i.R7$(),i.Y8G("ngIf",t.eeShowBanners),i.R7$(2),i.JRh(t.eeShowBanners?t.text.enterprise_header_description:t.text.header_description),i.R7$(),i.Y8G("ngIf",t.eeShowBanners),i.R7$(),i.Y8G("ngIf",t.visible&&i.bMT(6,7,t.nonWorkingDays$))("ngIfElse",e)}},dependencies:[k.Sq,k.bT,v.qT,v.xH,v.y7,v.cb,v.cV,C.U,y.H,w.U,T.I,k.Jj],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-baseline--header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;flex-direction:column;width:280px;margin:1rem 1rem 0;color:var(--fgColor-muted)}.op-baseline--header[_ngcontent-%COMP%]:has( + .op-baseline--body_ranged)[_ngcontent-%COMP%]{width:auto}.op-baseline--enterprise-title[_ngcontent-%COMP%]{color:#ef9e56;font-family:var(--body-font-family);font-size:.875rem;font-weight:700;font-style:normal;line-height:1.25rem;display:flex;flex-direction:row;align-items:center;gap:1rem .25rem}.op-baseline--info-button[_ngcontent-%COMP%]{display:flex;align-items:center}.op-baseline--body[_ngcontent-%COMP%]{flex-shrink:1;flex-basis:100%;overflow:auto;margin-top:0!important}@media screen and (min-width: 1000px) and (min-height: 500px){.op-baseline--body[_ngcontent-%COMP%]{width:316px;max-height:70vh}}.op-baseline--body_ranged[_ngcontent-%COMP%]{width:600px}.op-baseline--time-input[_ngcontent-%COMP%]{width:65%}.op-baseline--time-help[_ngcontent-%COMP%]{display:flex;align-items:flex-end;justify-content:center;background-color:var(--bgColor-neutral-muted);border:1px solid var(--borderColor-default);border-left:none!important;padding:.5rem .25rem;line-height:1rem}.op-baseline--time-tooltip-body[_ngcontent-%COMP%]{width:220px;display:block}.op-baseline--filter-description[_ngcontent-%COMP%]{font-size:.75rem;font-style:italic;line-height:1rem;color:#555}.op-baseline--range-container[_ngcontent-%COMP%]{margin:1rem;display:grid;grid-template-columns:1fr 1fr;grid-gap:1rem}.op-baseline--datepicker[_ngcontent-%COMP%]{margin:1rem}.op-baseline_tab.op-baseline--header[_ngcontent-%COMP%]{margin:0;width:auto!important}.op-baseline_tab[_ngcontent-%COMP%]   .spot-form-field[_ngcontent-%COMP%]{margin-right:0;margin-left:0}.op-baseline_tab[_ngcontent-%COMP%]   .op-baseline--range-container[_ngcontent-%COMP%]{margin:0}"],changeDetection:0})}}},92564:(e,t,n)=>{"use strict";n.d(t,{C:()=>WorkPackageBreadcrumbParentComponent});var i=n(68559),o=(n(68643),n(90941)),r=n(61816),s=n(49349),a=n(88955),l=n(60316),c=n(46765),p=n(63132);const _c0=e=>({workPackageId:e});function WorkPackageBreadcrumbParentComponent_ng_container_0_a_1_Template(e,t){if(1&e&&(i.j41(0,"a",5),i.nrm(1,"span",6),i.k0s()),2&e){const e=i.XpG(2);i.Y8G("uiParams",i.eq3(3,_c0,e.parent.id)),i.BMQ("title",e.parent.name),i.R7$(),i.Y8G("textContent",e.parent.name)}}function WorkPackageBreadcrumbParentComponent_ng_container_0_button_2_span_1_Template(e,t){if(1&e&&i.nrm(0,"span",6),2&e){const e=i.XpG(3);i.Y8G("textContent",e.text.set_parent)}}function WorkPackageBreadcrumbParentComponent_ng_container_0_button_2_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",7),i.bIt("click",(function WorkPackageBreadcrumbParentComponent_ng_container_0_button_2_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.open())})),i.DNE(1,WorkPackageBreadcrumbParentComponent_ng_container_0_button_2_span_1_Template,1,1,"span",8),i.nrm(2,"op-icon",9),i.k0s()}if(2&e){const e=i.XpG(2);i.Y8G("title",e.parent?e.text.edit_parent:e.text.set_parent),i.R7$(),i.Y8G("ngIf",!e.parent),i.R7$(),i.Mz_("icon-classes","icon-small ",e.parent?"icon-edit icon5 icon-no-color":"icon-add icon4","")}}function WorkPackageBreadcrumbParentComponent_ng_container_0_button_3_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",10),i.bIt("click",(function WorkPackageBreadcrumbParentComponent_ng_container_0_button_3_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.updateParent(null))})),i.nrm(1,"op-icon",11),i.k0s()}if(2&e){const e=i.XpG(2);i.Y8G("title",e.text.remove_parent)}}function WorkPackageBreadcrumbParentComponent_ng_container_0_Template(e,t){if(1&e&&(i.qex(0),i.DNE(1,WorkPackageBreadcrumbParentComponent_ng_container_0_a_1_Template,2,5,"a",2)(2,WorkPackageBreadcrumbParentComponent_ng_container_0_button_2_Template,3,4,"button",3)(3,WorkPackageBreadcrumbParentComponent_ng_container_0_button_3_Template,2,1,"button",4),i.bVm()),2&e){const e=i.XpG();i.R7$(),i.Y8G("ngIf",e.parent),i.R7$(),i.Y8G("ngIf",e.canModifyParent()),i.R7$(),i.Y8G("ngIf",e.canModifyParent()&&e.parent)}}function WorkPackageBreadcrumbParentComponent_wp_relations_autocomplete_1_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"wp-relations-autocomplete",12),i.bIt("cancel",(function WorkPackageBreadcrumbParentComponent_wp_relations_autocomplete_1_Template_wp_relations_autocomplete_cancel_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.close())}))("change",(function WorkPackageBreadcrumbParentComponent_wp_relations_autocomplete_1_Template_wp_relations_autocomplete_change_0_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.updateParent(t))})),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("placeholder",e.text.set_or_remove_parent)("workPackage",e.workPackage)}}class WorkPackageBreadcrumbParentComponent{constructor(e,t,n){this.I18n=e,this.wpRelationsHierarchy=t,this.notificationService=n,this.onSwitch=new i.bkB,this.isSaving=!1,this.text={edit_parent:this.I18n.t("js.relation_buttons.change_parent"),set_or_remove_parent:this.I18n.t("js.relations_autocomplete.parent_placeholder"),remove_parent:this.I18n.t("js.relation_buttons.remove_parent"),set_parent:this.I18n.t("js.relation_buttons.set_parent")}}canModifyParent(){return!!this.workPackage.changeParent}get parent(){return this.workPackage&&this.workPackage.parent}get active(){return this.editing}close(){this.toggle(!1)}open(){this.toggle(!0)}updateParent(e){this.close();const t=e?e.id:null;_.get(this.parent,"id",null)!==t&&(this.isSaving=!0,this.wpRelationsHierarchy.changeParent(this.workPackage,t).catch((e=>{this.notificationService.handleRawError(e,this.workPackage)})).then((()=>this.isSaving=!1)))}toggle(e){this.editing!==e&&(this.editing=e,this.onSwitch.emit(this.editing))}static{this.ɵfac=function WorkPackageBreadcrumbParentComponent_Factory(e){return new(e||WorkPackageBreadcrumbParentComponent)(i.rXU(r.W),i.rXU(o.F),i.rXU(s.U))}}static{this.ɵcmp=i.VBU({type:WorkPackageBreadcrumbParentComponent,selectors:[["wp-breadcrumb-parent"]],inputs:{workPackage:"workPackage"},outputs:{onSwitch:"onSwitch"},decls:2,vars:2,consts:[[4,"ngIf"],["data-test-selector","wp-relations-autocomplete","filterCandidatesFor","parent",3,"placeholder","workPackage","cancel","change",4,"ngIf"],["uiSref","work-packages.show","class","op-wp-breadcrumb-parent nocut","data-test-selector","op-wp-breadcrumb-parent",3,"uiParams",4,"ngIf"],["type","button","class","spot-link wp-relation--parent-change -no-decoration hide-when-print",3,"title","click",4,"ngIf"],["type","button","class","spot-link wp-relation--parent-remove hide-when-print -no-decoration",3,"title","click",4,"ngIf"],["uiSref","work-packages.show","data-test-selector","op-wp-breadcrumb-parent",1,"op-wp-breadcrumb-parent","nocut",3,"uiParams"],[3,"textContent"],["type","button",1,"spot-link","wp-relation--parent-change","-no-decoration","hide-when-print",3,"click","title"],[3,"textContent",4,"ngIf"],[3,"icon-classes"],["type","button",1,"spot-link","wp-relation--parent-remove","hide-when-print","-no-decoration",3,"click","title"],["icon-classes","icon-small icon-no-color icon-remove icon4"],["data-test-selector","wp-relations-autocomplete","filterCandidatesFor","parent",3,"cancel","change","placeholder","workPackage"]],template:function WorkPackageBreadcrumbParentComponent_Template(e,t){1&e&&i.DNE(0,WorkPackageBreadcrumbParentComponent_ng_container_0_Template,4,3,"ng-container",0)(1,WorkPackageBreadcrumbParentComponent_wp_relations_autocomplete_1_Template,1,2,"wp-relations-autocomplete",1),2&e&&(i.Y8G("ngIf",!t.active),i.R7$(),i.Y8G("ngIf",t.active))},dependencies:[a.UISref,a.AnchorUISref,l.bT,c.i,p.u],encapsulation:2})}}},25377:(e,t,n)=>{"use strict";n.d(t,{Q:()=>WorkPackageBreadcrumbComponent});var i=n(61816),o=(n(68643),n(68559)),r=n(88955),s=n(60316),a=n(92564);const _c0=(e,t)=>({"op-wp-breadcrumb--active-parent-select":e,"icon4 icon-small icon-arrow-right5":t}),_c1=e=>({"icon4 icon-small icon-arrow-right5":e}),_c2=e=>({workPackageId:e});function WorkPackageBreadcrumbComponent_div_0_ng_container_2_ng_container_4_li_1_Template(e,t){if(1&e&&(o.j41(0,"li",8),o.nrm(1,"a",9),o.k0s()),2&e){const e=o.XpG(),t=e.$implicit,n=e.first;o.Y8G("ngClass",o.eq3(4,_c1,!n)),o.R7$(),o.Y8G("textContent",t.name)("uiParams",o.eq3(6,_c2,t.id)),o.BMQ("title",t.name)}}function WorkPackageBreadcrumbComponent_div_0_ng_container_2_ng_container_4_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,WorkPackageBreadcrumbComponent_div_0_ng_container_2_ng_container_4_li_1_Template,2,8,"li",7),o.bVm()),2&e){const e=t.last;o.R7$(),o.Y8G("ngIf",!e)}}function WorkPackageBreadcrumbComponent_div_0_ng_container_2_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"li")(2,"span"),o.EFF(3),o.k0s()(),o.DNE(4,WorkPackageBreadcrumbComponent_div_0_ng_container_2_ng_container_4_Template,2,1,"ng-container",6),o.bVm()),2&e){const e=o.XpG(2);o.R7$(3),o.SpI("",e.hierarchyLabel,": "),o.R7$(),o.Y8G("ngForOf",e.workPackage.getAncestors())}}function WorkPackageBreadcrumbComponent_div_0_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",1)(1,"ul",2),o.DNE(2,WorkPackageBreadcrumbComponent_div_0_ng_container_2_Template,5,2,"ng-container",3),o.j41(3,"li",4)(4,"wp-breadcrumb-parent",5),o.bIt("onSwitch",(function WorkPackageBreadcrumbComponent_div_0_Template_wp_breadcrumb_parent_onSwitch_4_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.updateActiveInput(t))})),o.k0s()()()()}if(2&e){const e=o.XpG();o.R7$(2),o.Y8G("ngIf",!e.inputActive&&e.hierarchyCount>0),o.R7$(),o.Y8G("ngClass",o.l_i(3,_c0,e.inputActive,!e.inputActive&&e.hierarchyCount>1)),o.R7$(),o.Y8G("workPackage",e.workPackage)}}class WorkPackageBreadcrumbComponent{constructor(e){this.I18n=e,this.text={parent:this.I18n.t("js.relations_hierarchy.parent_headline"),hierarchy:this.I18n.t("js.relations_hierarchy.hierarchy_headline")},this.inputActive=!1}get hierarchyCount(){return this.workPackage.getAncestors().length}get hierarchyLabel(){return 1===this.hierarchyCount?this.text.parent:this.text.hierarchy}updateActiveInput(e){this.inputActive=e}static{this.ɵfac=function WorkPackageBreadcrumbComponent_Factory(e){return new(e||WorkPackageBreadcrumbComponent)(o.rXU(i.W))}}static{this.ɵcmp=o.VBU({type:WorkPackageBreadcrumbComponent,selectors:[["wp-breadcrumb"]],inputs:{workPackage:"workPackage"},decls:1,vars:1,consts:[["class","op-wp-breadcrumb -show","data-test-selector","op-wp-breadcrumb",4,"ngIf"],["data-test-selector","op-wp-breadcrumb",1,"op-wp-breadcrumb","-show"],["data-test-selector","op-breadcrumb",1,"op-breadcrumb"],[4,"ngIf"],[3,"ngClass"],[3,"onSwitch","workPackage"],[4,"ngFor","ngForOf"],["class","op-wp-breadcrumb--ellipsed",3,"ngClass",4,"ngIf"],[1,"op-wp-breadcrumb--ellipsed",3,"ngClass"],["uiSref","work-packages.show",1,"nocut",3,"textContent","uiParams"]],template:function WorkPackageBreadcrumbComponent_Template(e,t){1&e&&o.DNE(0,WorkPackageBreadcrumbComponent_div_0_Template,5,6,"div",0),2&e&&o.Y8G("ngIf",t.workPackage)},dependencies:[r.UISref,r.AnchorUISref,s.YU,s.Sq,s.bT,a.C],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-wp-breadcrumb[_ngcontent-%COMP%]{display:none;transition:all .1s ease-in-out 0s;overflow:hidden;width:auto;height:initial}.op-wp-breadcrumb[_ngcontent-%COMP%]   ul.op-breadcrumb[_ngcontent-%COMP%]{height:initial;margin:0;padding:0}.op-wp-breadcrumb[_ngcontent-%COMP%]   ul.op-breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:var(--breadcrumb-font-color);font-family:var(--body-font-family);font-size:var(--breadcrumb-font-size);font-weight:400;list-style-type:none;float:left;margin:0 5px 0 0;padding:0;line-height:20px;max-width:100%;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}.op-wp-breadcrumb.-show[_ngcontent-%COMP%]{display:block}.op-wp-breadcrumb--ellipsed[_ngcontent-%COMP%]{max-width:600px;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}.op-wp-breadcrumb--active-parent-select[_ngcontent-%COMP%]{width:500px}.op-wp-breadcrumb[_ngcontent-%COMP%]   ul.op-breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   wp-breadcrumb-parent[_ngcontent-%COMP%]{white-space:initial}.op-wp-breadcrumb[_ngcontent-%COMP%]   .ng-placeholder[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}"]})}}},65396:(e,t,n)=>{"use strict";n.d(t,{X:()=>AbstractWorkPackageButtonComponent});var i=n(99496);class AbstractWorkPackageButtonComponent extends i.p{constructor(e){super(),this.I18n=e,this.isActive=!1,this.text={activate:this.I18n.t("js.label_activate"),deactivate:this.I18n.t("js.label_deactivate"),label:this.labelKey?this.I18n.t(this.labelKey):"",buttonText:this.textKey?this.I18n.t(this.textKey):""}}get label(){return this.text.label}get buttonText(){return this.text.buttonText}get labelKey(){return""}get textKey(){return""}get activationPrefix(){return this.isActive?"":`${this.text.activate} `}get deactivationPrefix(){return this.isActive?`${this.text.deactivate} `:""}get prefix(){return this.activationPrefix||this.deactivationPrefix}isToggle(){return!1}}},49977:(e,t,n)=>{"use strict";n.d(t,{X:()=>WorkPackageCreateButtonComponent});var i=n(83093),o=n(61816),r=n(67820),s=n(99496),a=n(86866),l=n(64334),c=n(63894),p=n(68559),d=n(82633),u=n(60316);class WorkPackageCreateButtonComponent extends s.p{constructor(e,t,n,i,o,r,s){super(),this.$state=e,this.currentUser=t,this.currentProject=n,this.authorisationService=i,this.transition=o,this.I18n=r,this.cdRef=s,this.text={title:this.I18n.t("js.work_packages.create.title"),createWithDropdown:this.I18n.t("js.work_packages.create.button"),createButton:this.I18n.t("js.label_work_package"),explanation:this.I18n.t("js.label_create_work_package")}}ngOnInit(){this.projectIdentifier=this.currentProject.identifier,this.currentUser.hasCapabilities$("work_packages/create",this.currentProject.id).pipe((0,l.s)(1)).subscribe((e=>{this.allowed=e,this.updateDisabledState()})),this.transitionUnregisterFn=this.transition.onSuccess({},this.updateDisabledState.bind(this))}ngOnDestroy(){super.ngOnDestroy(),this.transitionUnregisterFn()}updateDisabledState(){this.disabled=!this.allowed||this.$state.includes("**.new"),this.cdRef.detectChanges()}static{this.ɵfac=function WorkPackageCreateButtonComponent_Factory(e){return new(e||WorkPackageCreateButtonComponent)(p.rXU(i.dw),p.rXU(c.K),p.rXU(a.c),p.rXU(r._),p.rXU(i.HN),p.rXU(o.W),p.rXU(p.gRc))}}static{this.ɵcmp=p.VBU({type:WorkPackageCreateButtonComponent,selectors:[["wp-create-button"]],inputs:{allowedWhen:[p.Mj6.None,"allowed","allowedWhen"],stateName$:"stateName$"},features:[p.Vt3],decls:6,vars:9,consts:[[1,"wp-create-button"],["opTypesCreateDropdown","",1,"button","-primary","add-work-package",3,"disabled","projectIdentifier","stateName","dropdownActive","title"],[1,"spot-icon","spot-icon_add"],["aria-hidden","true",1,"button--text",3,"textContent"],[1,"spot-icon","spot-icon_dropdown"]],template:function WorkPackageCreateButtonComponent_Template(e,t){1&e&&(p.j41(0,"div",0)(1,"button",1),p.nI1(2,"async"),p.nrm(3,"span",2)(4,"span",3)(5,"span",4),p.k0s()()),2&e&&(p.R7$(),p.Y8G("disabled",t.disabled)("projectIdentifier",t.projectIdentifier)("stateName",p.bMT(2,7,t.stateName$))("dropdownActive",t.allowed)("title",t.text.title),p.BMQ("aria-label",t.text.explanation),p.R7$(3),p.Y8G("textContent",t.text.createWithDropdown))},dependencies:[d.S,u.Jj],encapsulation:2,changeDetection:0})}}},47637:(e,t,n)=>{"use strict";n.d(t,{I:()=>WorkPackageDetailsViewButtonComponent});var i=n(79),o=n(83093),r=n(65396),s=n(61816),a=n(13432),l=n(66309),c=n(68559),p=n(46765);class WorkPackageDetailsViewButtonComponent extends r.X{constructor(e,t,n,i,o,r,s){super(t),this.$state=e,this.I18n=t,this.transitions=n,this.cdRef=i,this.states=o,this.wpTableFocus=r,this.keepTab=s,this.accessKey=8,this.activeState="work-packages.partitioned.list.details",this.listState="work-packages.partitioned.list",this.buttonId="work-packages-details-view-button",this.buttonClass="toolbar-icon",this.iconClass="icon-info2",this.activateLabel=t.t("js.button_open_details"),this.deactivateLabel=t.t("js.button_close_details"),this.transitionListener=this.transitions.onSuccess({},(()=>{this.isActive=this.$state.includes(this.activeState),this.cdRef.detectChanges()}))}ngOnDestroy(){super.ngOnDestroy(),this.transitionListener()}get label(){return this.isActive?this.deactivateLabel:this.activateLabel}isToggle(){return!0}performAction(e){this.isActive?this.$state.go(this.listState):this.openDetailsView()}openListView(){}openDetailsView(){const e={workPackageId:this.wpTableFocus.focusedWorkPackage};this.keepTab.goCurrentDetailsState(e)}static{this.ɵfac=function WorkPackageDetailsViewButtonComponent_Factory(e){return new(e||WorkPackageDetailsViewButtonComponent)(c.rXU(o.dw),c.rXU(s.W),c.rXU(o.HN),c.rXU(c.gRc),c.rXU(a.D),c.rXU(i.c),c.rXU(l.S))}}static{this.ɵcmp=c.VBU({type:WorkPackageDetailsViewButtonComponent,selectors:[["wp-details-view-button"]],features:[c.Vt3],decls:2,vars:11,consts:[["type","button",3,"click","disabled"],[3,"icon-classes"]],template:function WorkPackageDetailsViewButtonComponent_Template(e,t){1&e&&(c.j41(0,"button",0),c.bIt("click",(function WorkPackageDetailsViewButtonComponent_Template_button_click_0_listener(e){return t.performAction(e)})),c.nrm(1,"op-icon",1),c.k0s()),2&e&&(c.ZvI("button ",t.buttonClass,""),c.AVh("-active",t.isActive),c.Y8G("disabled",t.disabled||!t.isToggle()&&t.isActive),c.BMQ("id",t.buttonId)("title",t.label)("accesskey",t.accessKey),c.R7$(),c.Mz_("icon-classes","",t.iconClass," button--icon"))},dependencies:[p.i],encapsulation:2,changeDetection:0})}}},81805:(e,t,n)=>{"use strict";n.d(t,{f:()=>WorkPackageFilterButtonComponent});var i=n(65396),o=n(61816),r=n(34120),s=n(99664),a=n(12717),l=n(68559),c=n(60316),p=n(46765);const _c0=e=>({"-active":e});function WorkPackageFilterButtonComponent_span_4_Template(e,t){if(1&e&&l.nrm(0,"span",5),2&e){const e=l.XpG();l.Y8G("textContent",e.filterCount)}}class WorkPackageFilterButtonComponent extends i.X{constructor(e,t,n,i){super(e),this.I18n=e,this.cdRef=t,this.wpFiltersService=n,this.wpTableFilters=i,this.initialized=!1,this.buttonId="work-packages-filter-toggle-button",this.iconClass="icon-filter",this.title=this.I18n.t("js.work_packages.filters.title")}ngOnInit(){this.setupObserver()}get labelKey(){return"js.button_filter"}get textKey(){return"js.toolbar.filter"}get label(){return this.prefix+this.text.label}get filterCount(){return this.count}performAction(e){this.toggleVisibility()}toggleVisibility(){this.wpFiltersService.toggleVisibility()}setupObserver(){this.wpTableFilters.live$().pipe(this.untilDestroyed()).subscribe((()=>{this.count=this.wpTableFilters.currentlyVisibleFilters.length,this.initialized=!0,this.cdRef.detectChanges()})),this.wpFiltersService.observeUntil((0,s.pl)(this)).subscribe((()=>{this.isActive=this.wpFiltersService.visible,this.cdRef.detectChanges()}))}static{this.ɵfac=function WorkPackageFilterButtonComponent_Factory(e){return new(e||WorkPackageFilterButtonComponent)(l.rXU(o.W),l.rXU(l.gRc),l.rXU(a.a),l.rXU(r.N))}}static{this.ɵcmp=l.VBU({type:WorkPackageFilterButtonComponent,selectors:[["wp-filter-button"]],features:[l.Vt3],decls:6,vars:12,consts:[["data-test-selector","wp-filter-button",1,"button",3,"click","disabled","ngClass"],[3,"icon-classes"],[1,"button--text"],["class","badge -secondary",3,"textContent",4,"ngIf"],[1,"spot-icon","spot-icon_dropdown"],[1,"badge","-secondary",3,"textContent"]],template:function WorkPackageFilterButtonComponent_Template(e,t){1&e&&(l.j41(0,"button",0),l.bIt("click",(function WorkPackageFilterButtonComponent_Template_button_click_0_listener(e){return t.performAction(e)})),l.nrm(1,"op-icon",1),l.j41(2,"span",2),l.EFF(3),l.DNE(4,WorkPackageFilterButtonComponent_span_4_Template,1,1,"span",3),l.k0s(),l.nrm(5,"span",4),l.k0s()),2&e&&(l.Y8G("disabled",t.disabled)("ngClass",l.eq3(10,_c0,t.isActive)),l.BMQ("id",t.buttonId)("accesskey",t.accessKey)("title",t.title)("aria-label",t.label),l.R7$(),l.Mz_("icon-classes","",t.iconClass," button--icon"),l.R7$(2),l.SpI(" ",t.buttonText," "),l.R7$(),l.Y8G("ngIf",t.initialized))},dependencies:[c.YU,c.bT,p.i],encapsulation:2,changeDetection:0})}}},28549:(e,t,n)=>{"use strict";n.d(t,{a:()=>WorkPackageFoldToggleButtonComponent});var i=n(68559),o=n(46765),r=n(56912);class WorkPackageFoldToggleButtonComponent{static{this.ɵfac=function WorkPackageFoldToggleButtonComponent_Factory(e){return new(e||WorkPackageFoldToggleButtonComponent)}}static{this.ɵcmp=i.VBU({type:WorkPackageFoldToggleButtonComponent,selectors:[["wp-fold-toggle-view-button"]],decls:4,vars:0,consts:[["id","wp-fold-toggle-button","wpGroupToggleDropdown","",1,"button"],["icon-classes","button--icon icon-outline"],[1,"button--text"],["icon-classes","button--icon icon-small icon-pulldown"]],template:function WorkPackageFoldToggleButtonComponent_Template(e,t){1&e&&(i.j41(0,"button",0),i.nrm(1,"op-icon",1)(2,"span",2)(3,"op-icon",3),i.k0s())},dependencies:[o.i,r._],encapsulation:2,changeDetection:0})}}},21212:(e,t,n)=>{"use strict";n.d(t,{d:()=>WorkPackageMarkNotificationButtonComponent});var i=n(61816),o=(n(68643),n(96613)),r=n(68559),s=n(60316),a=n(46765);function WorkPackageMarkNotificationButtonComponent_span_2_Template(e,t){if(1&e&&r.nrm(0,"span",3),2&e){const e=r.XpG();r.Y8G("textContent",e.text.mark_as_read)}}class WorkPackageMarkNotificationButtonComponent{constructor(e,t){this.I18n=e,this.storeService=t,this.text={mark_as_read:this.I18n.t("js.notifications.center.mark_as_read")}}markAllBelongingNotificationsAsRead(){this.storeService.markAllAsRead(),document.dispatchEvent(new CustomEvent("work-package-notifications-updated"))}static{this.ɵfac=function WorkPackageMarkNotificationButtonComponent_Factory(e){return new(e||WorkPackageMarkNotificationButtonComponent)(r.rXU(i.W),r.rXU(o.e))}}static{this.ɵcmp=r.VBU({type:WorkPackageMarkNotificationButtonComponent,selectors:[["op-work-package-mark-notification-button"]],inputs:{workPackage:"workPackage",showWithText:"showWithText"},decls:3,vars:2,consts:[[1,"button",3,"click"],["icon-classes","button--icon icon-mark-read"],["class","button--text",3,"textContent",4,"ngIf"],[1,"button--text",3,"textContent"]],template:function WorkPackageMarkNotificationButtonComponent_Template(e,t){1&e&&(r.j41(0,"button",0),r.bIt("click",(function WorkPackageMarkNotificationButtonComponent_Template_button_click_0_listener(){return t.markAllBelongingNotificationsAsRead()})),r.nrm(1,"op-icon",1),r.DNE(2,WorkPackageMarkNotificationButtonComponent_span_2_Template,1,1,"span",2),r.k0s()),2&e&&(r.BMQ("title",t.text.mark_as_read),r.R7$(2),r.Y8G("ngIf",t.showWithText))},dependencies:[s.bT,a.i],encapsulation:2,changeDetection:0})}}},17709:(e,t,n)=>{"use strict";n.d(t,{l:()=>WorkPackageReminderButtonComponent});var i=n(14593),o=n(61816),r=n(94564),s=n(17270),a=(n(68643),n(15980)),l=n(19593),c=n(88467),p=n(51133),d=n(99496),u=n(63617),h=n(70271),m=n(51567),g=n(63037),_=n(36647),f=n(68559),b=n(60316),k=n(93855);function WorkPackageReminderButtonComponent_ng_container_1_Template(e,t){1&e&&(f.qex(0),f.qSk(),f.nrm(1,"svg",3),f.bVm())}function WorkPackageReminderButtonComponent_ng_template_3_Template(e,t){1&e&&(f.qSk(),f.nrm(0,"svg",4))}class WorkPackageReminderButtonComponent extends d.p{constructor(e,t,n,i,o,r){super(),this.I18n=e,this.opModalService=t,this.cdRef=n,this.apiV3Service=i,this.actions$=o,this.storeService=r,this.buttonTitle=this.I18n.t("js.work_packages.reminders.button_label")}ngOnInit(){const e=this.actions$.ofType(l.$).pipe((0,h.T)((e=>e.workPackageId)),(0,m.p)((e=>e===this.workPackage.id?.toString())),(0,g.Z)(null)),t=this.actions$.ofType(s.$s).pipe((0,h.T)((e=>e.count)));this.hasReminder$=(0,u.h)(t,e).pipe((0,_.n)((()=>this.countReminders())),(0,h.T)((e=>e>0)))}openModal(){this.opModalService.show(c.A,"global",{workPackage:this.workPackage},!1,!0)}countReminders(){return this.apiV3Service.work_packages.id(this.workPackage.id).reminders.get().pipe((0,h.T)((e=>e.total)))}static{this.ɵfac=function WorkPackageReminderButtonComponent_Factory(e){return new(e||WorkPackageReminderButtonComponent)(f.rXU(o.W),f.rXU(p.a),f.rXU(f.gRc),f.rXU(i.n),f.rXU(r.d),f.rXU(a.n))}}static{this.ɵcmp=f.VBU({type:WorkPackageReminderButtonComponent,selectors:[["wp-reminder-button"]],inputs:{workPackage:"workPackage"},features:[f.Vt3],decls:5,vars:5,consts:[["noReminder",""],["data-test-selector","op-wp-reminder-button",1,"button","toolbar-icon",3,"click"],[4,"ngIf","ngIfElse"],["op-alarm-set-icon","","size","small",1,"button--icon"],["op-alarm-icon","","size","small",1,"button--icon"]],template:function WorkPackageReminderButtonComponent_Template(e,t){if(1&e){const e=f.RV6();f.j41(0,"button",1),f.bIt("click",(function WorkPackageReminderButtonComponent_Template_button_click_0_listener(){return f.eBV(e),f.Njj(t.openModal())})),f.DNE(1,WorkPackageReminderButtonComponent_ng_container_1_Template,2,0,"ng-container",2),f.nI1(2,"async"),f.DNE(3,WorkPackageReminderButtonComponent_ng_template_3_Template,1,0,"ng-template",null,0,f.C5r),f.k0s()}if(2&e){const e=f.sdS(4);f.BMQ("title",t.buttonTitle),f.R7$(),f.Y8G("ngIf",f.bMT(2,3,t.hasReminder$))("ngIfElse",e)}},dependencies:[b.bT,k.JI9,k.VXk,b.Jj],encapsulation:2,changeDetection:0})}}},15615:(e,t,n)=>{"use strict";n.d(t,{K:()=>WorkPackageSettingsButtonComponent});var i=n(61816),o=n(68559),r=n(46765),s=n(67035);class WorkPackageSettingsButtonComponent{constructor(e){this.I18n=e,this.hideTableOptions=!1,this.showCalendarSharingOption=!1,this.text={more_actions:this.I18n.t("js.button_more_actions")}}static{this.ɵfac=function WorkPackageSettingsButtonComponent_Factory(e){return new(e||WorkPackageSettingsButtonComponent)(o.rXU(i.W))}}static{this.ɵcmp=o.VBU({type:WorkPackageSettingsButtonComponent,selectors:[["ng-component"]],inputs:{hideTableOptions:"hideTableOptions",showCalendarSharingOption:"showCalendarSharingOption"},decls:2,vars:3,consts:[["id","work-packages-settings-button","opSettingsContextMenu","","opSettingsContextMenu-query","query",1,"button","last","work-packages-settings-button","toolbar-icon",3,"title","hideTableOptions","showCalendarSharingOption"],["icon-classes","button--icon icon-show-more"]],template:function WorkPackageSettingsButtonComponent_Template(e,t){1&e&&(o.j41(0,"button",0),o.nrm(1,"op-icon",1),o.k0s()),2&e&&o.Y8G("title",t.text.more_actions)("hideTableOptions",t.hideTableOptions)("showCalendarSharingOption",t.showCalendarSharingOption)},dependencies:[r.i,s.p],encapsulation:2,changeDetection:0})}}},921:(e,t,n)=>{"use strict";n.d(t,{u:()=>WorkPackageShareButtonComponent});n(68643);var i=n(61816),o=n(99496),r=n(51133),s=n(20287),a=n(99972),l=n(89282),c=n(14593),p=n(70271),d=n(51567),u=n(63037),h=n(36647),m=n(94564),g=n(59048),_=n(68559),f=n(60316),b=n(93855);function WorkPackageShareButtonComponent_span_4_Template(e,t){if(1&e&&_.nrm(0,"span",5),2&e){const e=t.ngIf;_.Y8G("textContent",e)}}function WorkPackageShareButtonComponent__svg_svg_6_Template(e,t){1&e&&(_.qSk(),_.nrm(0,"svg",6))}class WorkPackageShareButtonComponent extends o.p{constructor(e,t,n,i,o,r){super(),this.I18n=e,this.opModalService=t,this.cdRef=n,this.bannersService=i,this.apiV3Service=o,this.actions$=r,this.showEnterpriseIcon=this.bannersService.eeShowBanners,this.text={share:this.I18n.t("js.sharing.share")}}ngOnInit(){this.shareCount$=this.actions$.ofType(g.q).pipe((0,p.T)((e=>e.workPackageId)),(0,d.p)((e=>e===this.workPackage.id?.toString())),(0,u.Z)(null),(0,h.n)((()=>this.countShares())))}openModal(){this.opModalService.show(s.Z,"global",{workPackage:this.workPackage},!1,!0)}countShares(){const e=(new l.hG).add("entityType","=",["WorkPackage"]).add("entityId","=",[this.workPackage.id]);return this.apiV3Service.shares.filtered(e,{pageSize:"0 "}).get().pipe((0,p.T)((e=>e.total)))}static{this.ɵfac=function WorkPackageShareButtonComponent_Factory(e){return new(e||WorkPackageShareButtonComponent)(_.rXU(i.W),_.rXU(r.a),_.rXU(_.gRc),_.rXU(a.b),_.rXU(c.n),_.rXU(m.d))}}static{this.ɵcmp=_.VBU({type:WorkPackageShareButtonComponent,selectors:[["wp-share-button"]],inputs:{workPackage:"workPackage"},features:[_.Vt3],decls:7,vars:5,consts:[["data-test-selector","op-wp-share-button",1,"button","toolbar-icon",3,"click"],["share-android-icon","","size","small",1,"button--icon"],[1,"button--text"],["class","badge -secondary",3,"textContent",4,"ngIf"],["op-enterprise-addons-icon","","class","button--icon upsale-colored","size","small",4,"ngIf"],[1,"badge","-secondary",3,"textContent"],["op-enterprise-addons-icon","","size","small",1,"button--icon","upsale-colored"]],template:function WorkPackageShareButtonComponent_Template(e,t){1&e&&(_.j41(0,"button",0),_.bIt("click",(function WorkPackageShareButtonComponent_Template_button_click_0_listener(){return t.openModal()})),_.qSk(),_.nrm(1,"svg",1),_.joV(),_.j41(2,"span",2),_.EFF(3),_.DNE(4,WorkPackageShareButtonComponent_span_4_Template,1,1,"span",3),_.nI1(5,"async"),_.k0s(),_.DNE(6,WorkPackageShareButtonComponent__svg_svg_6_Template,1,0,"svg",4),_.k0s()),2&e&&(_.R7$(3),_.SpI(" ",t.text.share," "),_.R7$(),_.Y8G("ngIf",_.bMT(5,3,t.shareCount$)),_.R7$(2),_.Y8G("ngIf",t.showEnterpriseIcon))},dependencies:[f.bT,b.CPx,b.dgQ,f.Jj],encapsulation:2,changeDetection:0})}}},66557:(e,t,n)=>{"use strict";n.d(t,{n:()=>WorkPackageStatusButtonComponent});n(68643);var i=n(51339),o=n(61816),r=n(46116),s=n(99496),a=n(44674),l=n(68559),c=n(60316),p=n(46765),d=n(57592);const _c0=e=>({"op-wp-status-button_small":e});function WorkPackageStatusButtonComponent_div_0_span_2_Template(e,t){1&e&&(l.j41(0,"span",6),l.nrm(1,"op-icon",7),l.k0s())}function WorkPackageStatusButtonComponent_div_0_Template(e,t){if(1&e&&(l.j41(0,"div",1)(1,"button",2),l.DNE(2,WorkPackageStatusButtonComponent_div_0_span_2_Template,2,0,"span",3),l.nrm(3,"span",4)(4,"op-icon",5),l.k0s()()),2&e){const e=l.XpG();l.Y8G("ngClass",l.eq3(9,_c0,e.small)),l.BMQ("title",e.buttonTitle),l.R7$(),l.Y8G("ngClass",e.statusHighlightClass)("disabled",!e.allowed)("title",e.status.name)("wpStatusDropdown-workPackage",e.workPackage),l.BMQ("aria-label",e.text.explanation),l.R7$(),l.Y8G("ngIf",e.isReadonly),l.R7$(),l.Y8G("textContent",e.status.name)}}class WorkPackageStatusButtonComponent extends s.p{constructor(e,t,n,i){super(),this.I18n=e,this.cdRef=t,this.schemaCache=n,this.halEditing=i,this.small=!1,this.text={explanation:this.I18n.t("js.label_edit_status"),workPackageReadOnly:this.I18n.t("js.work_packages.message_work_package_read_only"),workPackageStatusBlocked:this.I18n.t("js.work_packages.message_work_package_status_blocked")}}ngOnInit(){this.halEditing.temporaryEditResource(this.workPackage).values$().pipe(this.untilDestroyed()).subscribe((e=>{this.workPackage=e,this.workPackage.status&&this.workPackage.status.$load(),this.cdRef.detectChanges()}))}get buttonTitle(){return this.schema.isReadonly?this.text.workPackageReadOnly:this.schema.isEditable&&!this.allowed?this.text.workPackageStatusBlocked:""}get statusHighlightClass(){const{status:e}=this;if(e)return r.H.backgroundClass("status",e.id)}get status(){return this.workPackage.status}get isReadonly(){return this.schema.isReadonly}get allowed(){return this.schema.isAttributeEditable("status")}get schema(){return this.halEditing.typedState(this.workPackage).hasValue()?this.halEditing.typedState(this.workPackage).value.schema:this.schemaCache.of(this.workPackage)}static{this.ɵfac=function WorkPackageStatusButtonComponent_Factory(e){return new(e||WorkPackageStatusButtonComponent)(l.rXU(o.W),l.rXU(l.gRc),l.rXU(a.D),l.rXU(i.p))}}static{this.ɵcmp=l.VBU({type:WorkPackageStatusButtonComponent,selectors:[["wp-status-button"]],inputs:{workPackage:"workPackage",small:"small"},features:[l.Vt3],decls:1,vars:1,consts:[["class","op-wp-status-button","data-test-selector","op-wp-status-button",3,"ngClass",4,"ngIf"],["data-test-selector","op-wp-status-button",1,"op-wp-status-button",3,"ngClass"],["wpStatusDropdown","",1,"op-wp-status-button--button","button",3,"ngClass","disabled","title","wpStatusDropdown-workPackage"],["class","op-wp-status-button--text button--text",4,"ngIf"],["aria-hidden","true",1,"op-wp-status-button--text","button--text",3,"textContent"],["icon-classes","button--icon icon-small icon-pulldown"],[1,"op-wp-status-button--text","button--text"],["icon-classes","button--icon icon-locked"]],template:function WorkPackageStatusButtonComponent_Template(e,t){1&e&&l.DNE(0,WorkPackageStatusButtonComponent_div_0_Template,5,11,"div",0),2&e&&l.Y8G("ngIf",t.status)},dependencies:[c.YU,c.bT,p.i,d.K],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-wp-status-button--button[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;padding:5px;margin-bottom:0;background-color:var(--label-orange-bgColor-active);border:1px solid var(--label-orange-fgColor-rest);color:var(--body-font-color);max-width:100%;display:flex}.op-wp-status-button--text[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}.op-wp-status-button_small[_ngcontent-%COMP%]   .op-wp-status-button--button[_ngcontent-%COMP%]{line-height:16px;font-size:12px;height:16px;padding:0 5px;margin-right:0}"]})}}},43341:(e,t,n)=>{"use strict";n.d(t,{G:()=>WorkPackageTimelineButtonComponent});var i=n(61816),o=n(68222),r=n(65396),s=n(68559),a=n(60316),l=n(46765);function WorkPackageTimelineButtonComponent_li_1_Template(e,t){if(1&e){const e=s.RV6();s.j41(0,"li")(1,"button",2),s.bIt("click",(function WorkPackageTimelineButtonComponent_li_1_Template_button_click_1_listener(){s.eBV(e);const t=s.XpG();return s.Njj(t.enableAutoZoom())})),s.nrm(2,"op-icon",3),s.k0s()()}if(2&e){const e=s.XpG();s.R7$(),s.Y8G("ngClass",e.getAutoZoomToggleClass()),s.BMQ("title",e.text.zoomAuto)}}function WorkPackageTimelineButtonComponent_li_2_Template(e,t){if(1&e){const e=s.RV6();s.j41(0,"li")(1,"button",4),s.bIt("click",(function WorkPackageTimelineButtonComponent_li_2_Template_button_click_1_listener(){s.eBV(e);const t=s.XpG();return s.Njj(t.updateZoomWithDelta(1))})),s.nrm(2,"op-icon",5),s.k0s()()}if(2&e){const e=s.XpG();s.R7$(),s.Y8G("disabled",e.isMaxLevel),s.BMQ("title",e.text.zoomOut)}}function WorkPackageTimelineButtonComponent_li_3_Template(e,t){if(1&e){const e=s.RV6();s.j41(0,"li")(1,"button",6),s.bIt("click",(function WorkPackageTimelineButtonComponent_li_3_Template_button_click_1_listener(){s.eBV(e);const t=s.XpG();return s.Njj(t.updateZoomWithDelta(-1))})),s.nrm(2,"op-icon",7),s.k0s()()}if(2&e){const e=s.XpG();s.R7$(),s.Y8G("disabled",e.isMinLevel),s.BMQ("title",e.text.zoomIn)}}class WorkPackageTimelineButtonComponent extends r.X{constructor(e,t,n){super(e),this.I18n=e,this.cdRef=t,this.wpTableTimeline=n,this.buttonId="work-packages-timeline-toggle-button",this.iconClass="icon-view-timeline",this.minZoomLevel="days",this.maxZoomLevel="years",this.isAutoZoom=!1,this.isMaxLevel=!1,this.isMinLevel=!1,this.activateLabel=e.t("js.gantt_chart.button_activate"),this.deactivateLabel=e.t("js.gantt_chart.button_deactivate"),this.text.zoomIn=e.t("js.gantt_chart.zoom.in"),this.text.zoomOut=e.t("js.gantt_chart.zoom.out"),this.text.zoomAuto=e.t("js.gantt_chart.zoom.auto")}ngOnInit(){this.wpTableTimeline.live$().pipe(this.untilDestroyed()).subscribe((()=>{this.isAutoZoom=this.wpTableTimeline.isAutoZoom(),this.isActive=this.wpTableTimeline.isVisible,this.cdRef.detectChanges()})),this.wpTableTimeline.appliedZoomLevel$.values$().pipe(this.untilDestroyed()).subscribe((e=>{this.isMaxLevel=e===this.maxZoomLevel,this.isMinLevel=e===this.minZoomLevel,this.cdRef.detectChanges()}))}get label(){return this.isActive?this.deactivateLabel:this.activateLabel}isToggle(){return!0}updateZoomWithDelta(e){this.wpTableTimeline.updateZoomWithDelta(e)}performAction(e){this.toggleTimeline()}toggleTimeline(){this.wpTableTimeline.toggle()}enableAutoZoom(){this.wpTableTimeline.enableAutozoom()}getAutoZoomToggleClass(){return this.isAutoZoom?"-disabled":""}static{this.ɵfac=function WorkPackageTimelineButtonComponent_Factory(e){return new(e||WorkPackageTimelineButtonComponent)(s.rXU(i.W),s.rXU(s.gRc),s.rXU(o.X))}}static{this.ɵcmp=s.VBU({type:WorkPackageTimelineButtonComponent,selectors:[["wp-timeline-toggle-button"]],features:[s.Vt3],decls:4,vars:3,consts:[["id","work-packages-timeline-mode-selection",1,"toolbar-button-group","work-packages-timeline-toggle-button"],[4,"ngIf"],["id","work-packages-timeline-zoom-auto-button",1,"button","timeline-toolbar--button","toolbar-icon",3,"click","ngClass"],["icon-classes","icon-zoom-auto button--icon"],["id","work-packages-timeline-zoom-out-button",1,"button","timeline-toolbar--button","toolbar-icon",3,"click","disabled"],["icon-classes","icon-zoom-out button--icon"],["id","work-packages-timeline-zoom-in-button",1,"button","timeline-toolbar--button","toolbar-icon",3,"click","disabled"],["icon-classes","icon-zoom-in button--icon"]],template:function WorkPackageTimelineButtonComponent_Template(e,t){1&e&&(s.j41(0,"ul",0),s.DNE(1,WorkPackageTimelineButtonComponent_li_1_Template,3,2,"li",1)(2,WorkPackageTimelineButtonComponent_li_2_Template,3,2,"li",1)(3,WorkPackageTimelineButtonComponent_li_3_Template,3,2,"li",1),s.k0s()),2&e&&(s.R7$(),s.Y8G("ngIf",t.isActive),s.R7$(),s.Y8G("ngIf",t.isActive),s.R7$(),s.Y8G("ngIf",t.isActive))},dependencies:[a.YU,a.bT,l.i],styles:[".work-packages-timeline-toggle-button[_ngcontent-%COMP%]   .toolbar-button-group[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:last-child{margin-right:10px}"],changeDetection:0})}}},58397:(e,t,n)=>{"use strict";n.d(t,{y:()=>ZenModeButtonComponent});var i=n(61816),o=n(31456),r=n(65396),s=n(68559),a=n(46765);const l=o;class ZenModeButtonComponent extends r.X{static{this.inZenMode=!1}constructor(e,t){super(e),this.I18n=e,this.cdRef=t,this.buttonId="work-packages-zen-mode-toggle-button",this.buttonClass="toolbar-icon",this.iconClass="icon-zen-mode",this.activateLabel=e.t("js.zen_mode.button_activate"),this.deactivateLabel=e.t("js.zen_mode.button_deactivate");const n=this;l.enabled&&l.onchange((()=>{l.isFullscreen||n.deactivateZenMode()}))}get label(){return this.isActive?this.deactivateLabel:this.activateLabel}isToggle(){return!0}deactivateZenMode(){this.isActive=ZenModeButtonComponent.inZenMode=!1,jQuery("body").removeClass("zen-mode"),this.disabled=!1,l.enabled&&l.isFullscreen&&l.exit(),this.cdRef.detectChanges()}activateZenMode(){this.isActive=ZenModeButtonComponent.inZenMode=!0,jQuery("body").addClass("zen-mode"),l.enabled&&l.request(),this.cdRef.detectChanges()}performAction(e){return ZenModeButtonComponent.inZenMode?this.deactivateZenMode():this.activateZenMode(),e.preventDefault(),!1}static{this.ɵfac=function ZenModeButtonComponent_Factory(e){return new(e||ZenModeButtonComponent)(s.rXU(i.W),s.rXU(s.gRc))}}static{this.ɵcmp=s.VBU({type:ZenModeButtonComponent,selectors:[["opce-zen-mode-toggle-button"]],features:[s.Vt3],decls:2,vars:11,consts:[["type","button",3,"click","disabled"],[3,"icon-classes"]],template:function ZenModeButtonComponent_Template(e,t){1&e&&(s.j41(0,"button",0),s.bIt("click",(function ZenModeButtonComponent_Template_button_click_0_listener(e){return t.performAction(e)})),s.nrm(1,"op-icon",1),s.k0s()),2&e&&(s.ZvI("button ",t.buttonClass,""),s.AVh("-active",t.isActive),s.Y8G("disabled",t.disabled||!t.isToggle()&&t.isActive),s.BMQ("id",t.buttonId)("title",t.label)("accesskey",t.accessKey),s.R7$(),s.Mz_("icon-classes","",t.iconClass," button--icon"))},dependencies:[a.i],encapsulation:2,changeDetection:0})}}},17099:(e,t,n)=>{"use strict";n.d(t,{$:()=>CardViewHandlerRegistry});var i=n(24398),o=n(29925),r=n(79),s=n(51724),a=n(83093),l=n(36652),c=n(1758);class CardClickHandler{constructor(e,t){this.injector=e}get EVENT(){return"click.cardView.card"}get SELECTOR(){return'[data-test-selector="op-wp-single-card"]'}eventScope(e){return jQuery(e.container.nativeElement)}handleEvent(e,t){const n=jQuery(t.target);if(n.is("a")||n.parent().is("a"))return!0;const i=n.closest("wp-single-card"),o=i.data("workPackageId");return!o||(this.handleWorkPackage(e,o,i,t),!1)}handleWorkPackage(e,t,n,i){this.setSelection(e,t,n,i),e.itemClicked.emit({workPackageId:t,double:!1})}setSelection(e,t,n,i){const o=n.data("classIdentifier"),r=this.wpCardView.findRenderedCard(o);i.ctrlKey||i.metaKey||i.shiftKey||this.wpTableSelection.setSelection(t,r),i.shiftKey&&this.wpTableSelection.setMultiSelectionFrom(this.wpCardView.renderedCards,t,r),(i.ctrlKey||i.metaKey)&&this.wpTableSelection.toggleRow(t),e.selectionChanged.emit(this.wpTableSelection.getSelectedWorkPackageIds()),this.wpTableFocus.updateFocus(t)}}(0,i.Cg)([(0,c.O)(),(0,i.Sn)("design:type",l.g)],CardClickHandler.prototype,"deviceService",void 0),(0,i.Cg)([(0,c.O)(),(0,i.Sn)("design:type",a.dw)],CardClickHandler.prototype,"$state",void 0),(0,i.Cg)([(0,c.O)(),(0,i.Sn)("design:type",o.a)],CardClickHandler.prototype,"wpTableSelection",void 0),(0,i.Cg)([(0,c.O)(),(0,i.Sn)("design:type",r.c)],CardClickHandler.prototype,"wpTableFocus",void 0),(0,i.Cg)([(0,c.O)(),(0,i.Sn)("design:type",s.K)],CardClickHandler.prototype,"wpCardView",void 0);class CardDblClickHandler{constructor(e,t){this.injector=e}get EVENT(){return"dblclick.cardView.card"}get SELECTOR(){return'[data-test-selector="op-wp-single-card"]'}eventScope(e){return jQuery(e.container.nativeElement)}handleEvent(e,t){const n=jQuery(t.target);if(n.is("a")||n.parent().is("a"))return!0;const i=n.closest("wp-single-card").data("workPackageId");return!i||(e.itemClicked.emit({workPackageId:i,double:!0}),!1)}}(0,i.Cg)([(0,c.O)(),(0,i.Sn)("design:type",a.dw)],CardDblClickHandler.prototype,"$state",void 0),(0,i.Cg)([(0,c.O)(),(0,i.Sn)("design:type",o.a)],CardDblClickHandler.prototype,"wpTableSelection",void 0);var p=n(79421),d=n(36819),u=n(67369),h=n(56439);class CardRightClickHandler{constructor(e,t){this.injector=e}get EVENT(){return"contextmenu.cardView.rightclick"}get SELECTOR(){return'[data-test-selector="op-wp-single-card"]'}eventScope(e){return jQuery(e.container.nativeElement)}handleEvent(e,t){const n=jQuery(t.target);if(n.closest(`.${p.qk}`).length)return(0,d.cY)("Allowing original context menu on state link"),!0;t.preventDefault(),t.stopPropagation();const i=n.closest("wp-single-card"),o=i.data("workPackageId");if(!o)return!0;const r=i.data("classIdentifier"),s=this.wpCardView.findRenderedCard(r);this.wpTableSelection.isSelected(o)||this.wpTableSelection.setSelection(o,s);const a=new h.L(this.injector,o,jQuery(t.target),{},e.showInfoButton);return this.opContextMenu.show(a,t),!1}}(0,i.Cg)([(0,c.O)(),(0,i.Sn)("design:type",o.a)],CardRightClickHandler.prototype,"wpTableSelection",void 0),(0,i.Cg)([(0,c.O)(),(0,i.Sn)("design:type",s.K)],CardRightClickHandler.prototype,"wpCardView",void 0),(0,i.Cg)([(0,c.O)(),(0,i.Sn)("design:type",u.V)],CardRightClickHandler.prototype,"opContextMenu",void 0);var m=n(37339);class CardViewHandlerRegistry extends m.C{constructor(){super(...arguments),this.eventHandlers=[e=>new CardClickHandler(this.injector,e),e=>new CardDblClickHandler(this.injector,e),e=>new CardRightClickHandler(this.injector,e)]}}},42979:(e,t,n)=>{"use strict";n.d(t,{H:()=>WorkPackageCardDragAndDropService});var i=n(89204),o=n(51524),r=n(13432),s=n(68267),a=n(27871),l=n(21162),c=n(13344),p=n(14593),d=n(86866),u=n(49349),h=n(97366),m=n(56196),g=n(68559);class WorkPackageCardDragAndDropService{constructor(e,t,n,i,o,r,s,a,l){this.states=e,this.injector=t,this.reorderService=n,this.wpCreate=i,this.notificationService=o,this.apiV3Service=r,this.currentProject=s,this.dragService=a,this.wpInlineCreate=l}init(e){this.cardView=e}destroy(){null!==this.dragService&&this.dragService.remove(this.cardView.container.nativeElement)}registerDragAndDrop(){var e,t,n=this;null!==this.dragService&&this.dragService.register({dragContainer:this.cardView.container.nativeElement,scrollContainers:[this.cardView.container.nativeElement],moves:e=>{const t=e.dataset.workPackageId,n=this.states.workPackages.get(t).value;return!!n&&this.cardView.canDragOutOf(n)&&!e.dataset.isNew},accepts:()=>this.cardView.dragInto,onMoved:(t=(0,i.A)((function*(e){const t=e.dataset.workPackageId,i=(0,c.S)(e),o=yield n.reorderService.move(n.currentOrder,t,i);n.updateOrder(o),n.cardView.onMoved.emit()})),function onMoved(e){return t.apply(this,arguments)}),onRemoved:e=>{const t=e.dataset.workPackageId,n=this.reorderService.remove(this.currentOrder,t);this.updateOrder(n)},onAdded:(e=(0,i.A)((function*(e){const t=e.dataset.workPackageId,i=(0,c.S)(e),o=yield(0,m._)(n.apiV3Service.work_packages.id(t).get()),r=yield n.addWorkPackageToQuery(o,i);return e.parentElement&&e.parentElement.removeChild(e),r})),function onAdded(t){return e.apply(this,arguments)})})}get workPackages(){return this._workPackages}set workPackages(e){if(this.activeInlineCreateWp){const t=this._workPackages.find((e=>(0,h.A)(e)));if(t){const e=this._workPackages.indexOf(t);this._workPackages[e]=this.activeInlineCreateWp}else this._workPackages=[this.activeInlineCreateWp,...e]}else this._workPackages=[...e]}get currentOrder(){return this.workPackages.filter((e=>e&&!(0,h.A)(e))).map((e=>e.id))}updateOrder(e){e=_.uniq(e),Promise.all(e.map((e=>this.apiV3Service.work_packages.id(e).get().toPromise()))).then((e=>{this.workPackages=e,this.cardView.cdRef.detectChanges()}))}addNewCard(){this.wpCreate.createOrContinueWorkPackage(this.currentProject.identifier).then((e=>{this.activeInlineCreateWp=e.projectedResource,this.workPackages=this.workPackages,this.cardView.cdRef.detectChanges()}))}addWorkPackageToQuery(e,t=-1){var n=this;return(0,i.A)((function*(){try{yield n.cardView.workPackageAddedHandler(e);const i=yield n.reorderService.add(n.currentOrder,e.id,t);return n.updateOrder(i),!0}catch(t){n.notificationService.handleRawError(t,e)}return!1}))()}removeReferenceWorkPackageForm(){this.activeInlineCreateWp&&this.removeCard(this.activeInlineCreateWp)}removeCard(e){const t=this.workPackages.indexOf(e);if(this.workPackages.splice(t,1),this.activeInlineCreateWp=void 0,!(0,h.A)(e)){const t=this.reorderService.remove(this.currentOrder,e.id);this.updateOrder(t)}}onCardSaved(e){var t=this;return(0,i.A)((function*(){const n=t.workPackages.findIndex((e=>"new"===e.id));if(-1!==n){t.activeInlineCreateWp=void 0;const i=yield t.reorderService.add(t.currentOrder,e.id,n);t.updateOrder(i),t.wpInlineCreate.newInlineWorkPackageCreated.next(e.id)}}))()}static{this.ɵfac=function WorkPackageCardDragAndDropService_Factory(e){return new(e||WorkPackageCardDragAndDropService)(g.KVO(r.D),g.KVO(g.zZn),g.KVO(o.k),g.KVO(s.d),g.KVO(u.U),g.KVO(p.n),g.KVO(d.c),g.KVO(l.W,8),g.KVO(a.O))}}static{this.ɵprov=g.jDH({token:WorkPackageCardDragAndDropService,factory:WorkPackageCardDragAndDropService.ɵfac})}}},51724:(e,t,n)=>{"use strict";n.d(t,{K:()=>WorkPackageCardViewService});var i=n(11048),o=n(68559);class WorkPackageCardViewService{constructor(e){this.querySpace=e}classIdentifier(e){return`wp-row-${e.id}`}get renderedCards(){return this.querySpace.tableRendered.getValueOr([])}findRenderedCard(e){return _.findIndex(this.renderedCards,(t=>t.classIdentifier===e))}updateRenderedCardsValues(e){this.querySpace.tableRendered.putValue(e.map((e=>({classIdentifier:this.classIdentifier(e),workPackageId:e.id,hidden:!1}))))}static{this.ɵfac=function WorkPackageCardViewService_Factory(e){return new(e||WorkPackageCardViewService)(o.KVO(i.i))}}static{this.ɵprov=o.jDH({token:WorkPackageCardViewService,factory:WorkPackageCardViewService.ɵfac})}}},81067:(e,t,n)=>{"use strict";n.d(t,{A:()=>WorkPackageCardViewComponent});var i=n(89204),o=n(68559),r=n(11048),s=n(61816),a=n(27871),l=n(68267),c=n(55596),p=n(67820),d=n(83093),u=n(13432),h=n(51524),m=n(73014),g=n(70271),_=n(51567),f=n(15842),b=n(99763),k=n(29925),v=n(17099),C=n(51724),y=n(42979),w=n(49349),T=n(36652),S=n(37339),j=n(99496),P=n(91691),I=n(97366);const x=["container"];function WorkPackageCardViewComponent_div_2_Template(e,t){if(1&e&&(o.j41(0,"div",5),o.nrm(1,"ndc-dynamic",6),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.Y8G("ndcDynamicComponent",e.referenceClass)("ndcDynamicInjector",e.injector)("ndcDynamicOutputs",e.referenceOutputs)}}function WorkPackageCardViewComponent_ng_container_3_hr_2_Template(e,t){1&e&&o.nrm(0,"hr",9)}function WorkPackageCardViewComponent_ng_container_3_Template(e,t){if(1&e){const e=o.RV6();o.qex(0),o.j41(1,"wp-single-card",7),o.bIt("onRemove",(function WorkPackageCardViewComponent_ng_container_3_Template_wp_single_card_onRemove_1_listener(){const t=o.eBV(e).$implicit,n=o.XpG();return o.Njj(n.removeCard(t))}))("stateLinkClicked",(function WorkPackageCardViewComponent_ng_container_3_Template_wp_single_card_stateLinkClicked_1_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.stateLinkClicked.emit(t))})),o.k0s(),o.DNE(2,WorkPackageCardViewComponent_ng_container_3_hr_2_Template,1,0,"hr",8),o.bVm()}if(2&e){const e=t.$implicit,n=o.XpG();o.R7$(),o.Y8G("workPackage",e)("showInfoButton",n.showInfoButton)("showStatusButton",n.showStatusButton)("showRemoveButton",n.cardsRemovable)("highlightingMode",n.highlightingMode)("draggable",n.canDragOutOf(e))("orientation",n.orientation)("shrinkOnMobile",n.shrinkOnMobile),o.BMQ("data-is-new",n.isNewResource(e)||void 0)("data-work-package-id",e.id)("data-class-identifier",n.cardView.classIdentifier(e)),o.R7$(),o.Y8G("ngIf",n.shrinkOnMobile)}}function WorkPackageCardViewComponent_div_4_Template(e,t){if(1&e&&(o.j41(0,"div"),o.nrm(1,"op-no-results",10),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.Y8G("title",e.text.noResults.title)("description",e.text.noResults.description)}}class WorkPackageCardViewComponent extends j.p{constructor(e,t,n,i,r,s,a,l,p,d,u,h,m,g,_,f,b,k){super(),this.querySpace=e,this.states=t,this.injector=n,this.$state=i,this.I18n=r,this.wpCreate=s,this.wpInlineCreate=a,this.notificationService=l,this.halEvents=p,this.authorisationService=d,this.causedUpdates=u,this.cdRef=h,this.pathHelper=m,this.wpTableSelection=g,this.wpViewOrder=_,this.cardView=f,this.cardDragDrop=b,this.deviceService=k,this.showStatusButton=!0,this.showInfoButton=!1,this.orientation="vertical",this.cardsRemovable=!1,this.showEmptyResultsBox=!1,this.shrinkOnMobile=!1,this.onMoved=new o.bkB,this.selectionChanged=new o.bkB,this.itemClicked=new o.bkB,this.stateLinkClicked=new o.bkB,this.trackByHref=(0,c.kz)("lockVersion"),this.isResultEmpty=!1,this.text={removeCard:this.I18n.t("js.card.remove_from_list"),addNewCard:this.I18n.t("js.card.add_new"),noResults:{title:this.I18n.t("js.work_packages.no_results.title"),description:this.I18n.t("js.work_packages.no_results.description")}},this.inReference=!1,this.referenceClass=this.wpInlineCreate.referenceComponentClass,this.referenceOutputs={onCancel:()=>this.setReferenceMode(!1),onReferenced:e=>this.cardDragDrop.addWorkPackageToQuery(e,0)},this.isNewResource=I.A}ngOnInit(){this.registerCreationCallback(),this.halEvents.aggregated$("WorkPackage").pipe((0,g.T)((e=>e.filter((e=>"updated"===e.eventType)))),(0,_.p)((e=>{const t=this.workPackages.map((e=>e.id.toString()));return!!e.find((e=>-1!==t.indexOf(e.id)))}))).subscribe((()=>{this.workPackages=this.workPackages.map((e=>this.states.workPackages.get(e.id).getValueOr(e))),this.cdRef.detectChanges()})),this.querySpace.results.values$().pipe((0,f.E)(this.querySpace.query.values$()),this.untilDestroyed()).subscribe((([e,t])=>{this.query=t,this.workPackages=this.wpViewOrder.orderedWorkPackages(),this.cardView.updateRenderedCardsValues(this.workPackages),this.isResultEmpty=0===this.workPackages.length,this.cdRef.detectChanges()}))}ngAfterViewInit(){this.cardDragDrop.init(this),this.deviceService.isMobile||this.cardDragDrop.registerDragAndDrop();const e=this.injector.get(S.Q,v.$);e instanceof v.$?e.attachTo(this):new e(this.injector).attachTo(this),this.wpTableSelection.registerSelectAllListener((()=>this.cardView.renderedCards)),this.wpTableSelection.registerDeselectAllListener()}ngOnDestroy(){super.ngOnDestroy(),this.cardDragDrop.destroy()}get workPackages(){return this.cardDragDrop.workPackages}set workPackages(e){this.cardDragDrop.workPackages=e}setReferenceMode(e){this.inReference=e,this.cdRef.detectChanges()}addNewCard(){this.cardDragDrop.addNewCard()}removeCard(e){this.cardDragDrop.removeCard(e)}onCardSaved(e){var t=this;return(0,i.A)((function*(){yield t.cardDragDrop.onCardSaved(e)}))()}classes(){let e="wp-cards-container ";return e+=`-${this.orientation}`,e+=this.shrinkOnMobile?" -shrink":"",e}registerCreationCallback(){var e=this;this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed()).subscribe(function(){var t=(0,i.A)((function*(t){e.onCardSaved(t)}));return function(e){return t.apply(this,arguments)}}())}static{this.ɵfac=function WorkPackageCardViewComponent_Factory(e){return new(e||WorkPackageCardViewComponent)(o.rXU(r.i),o.rXU(u.D),o.rXU(o.zZn),o.rXU(d.dw),o.rXU(s.W),o.rXU(l.d),o.rXU(a.O),o.rXU(w.U),o.rXU(P.o),o.rXU(p._),o.rXU(b.p),o.rXU(o.gRc),o.rXU(m.B),o.rXU(k.a),o.rXU(h.k),o.rXU(C.K),o.rXU(y.H),o.rXU(T.g))}}static{this.ɵcmp=o.VBU({type:WorkPackageCardViewComponent,selectors:[["wp-card-view"]],viewQuery:function WorkPackageCardViewComponent_Query(e,t){if(1&e&&o.GBs(x,7),2&e){let e;o.mGM(e=o.lsd())&&(t.container=e.first)}},inputs:{canDragOutOf:[o.Mj6.None,"dragOutOfHandler","canDragOutOf"],dragInto:"dragInto",highlightingMode:"highlightingMode",workPackageAddedHandler:"workPackageAddedHandler",showStatusButton:"showStatusButton",showInfoButton:"showInfoButton",orientation:"orientation",cardsRemovable:"cardsRemovable",showEmptyResultsBox:"showEmptyResultsBox",shrinkOnMobile:"shrinkOnMobile"},outputs:{onMoved:"onMoved",selectionChanged:"selectionChanged",itemClicked:"itemClicked",stateLinkClicked:"stateLinkClicked"},features:[o.Vt3],decls:5,vars:5,consts:[["container",""],["data-test-selector","op-wp-card-view",3,"ngClass"],["class","wp-inline-create--reference-container",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"wp-inline-create--reference-container"],[3,"ndcDynamicComponent","ndcDynamicInjector","ndcDynamicOutputs"],[3,"onRemove","stateLinkClicked","workPackage","showInfoButton","showStatusButton","showRemoveButton","highlightingMode","draggable","orientation","shrinkOnMobile"],["class","form--separator hidden-for-desktop",4,"ngIf"],[1,"form--separator","hidden-for-desktop"],[3,"title","description"]],template:function WorkPackageCardViewComponent_Template(e,t){1&e&&(o.j41(0,"div",1,0),o.DNE(2,WorkPackageCardViewComponent_div_2_Template,2,3,"div",2)(3,WorkPackageCardViewComponent_ng_container_3_Template,3,12,"ng-container",3),o.k0s(),o.DNE(4,WorkPackageCardViewComponent_div_4_Template,2,2,"div",4)),2&e&&(o.Y8G("ngClass",t.classes()),o.R7$(2),o.Y8G("ngIf",t.inReference),o.R7$(),o.Y8G("ngForOf",t.workPackages)("ngForTrackBy",t.trackByHref),o.R7$(),o.Y8G("ngIf",t.showEmptyResultsBox&&t.isResultEmpty))},styles:[".wp-inline-create-button[_ngcontent-%COMP%]{font-size:.9rem;padding-top:1rem;text-align:center}.wp-inline-create--reference-container[_ngcontent-%COMP%]{margin-bottom:3rem;margin-top:10px}",".wp-cards-container.-horizontal[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));grid-column-gap:10px;grid-row-gap:10px;margin-right:5px}@media only screen and (max-width: 543px){.wp-cards-container.-horizontal.-shrink[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-row-gap:0;margin-right:0}.wp-cards-container.-horizontal.-shrink[_ngcontent-%COMP%]   .form--separator[_ngcontent-%COMP%]{margin-bottom:0}}",".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.wp-cards-container.-vertical[_ngcontent-%COMP%]{height:100%;padding:0 15px;border-radius:2px;overflow-y:scroll;scrollbar-color:transparent transparent;scrollbar-width:thin}.wp-cards-container.-vertical[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.wp-cards-container.-vertical[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.wp-cards-container.-vertical[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.wp-cards-container.-vertical[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.wp-cards-container.-vertical[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}"],changeDetection:0})}}},38424:(e,t,n)=>{"use strict";n.d(t,{V:()=>WorkPackageSingleCardComponent});var i=n(68559),o=n(79421),r=n(73014),s=n(46116),a=n(83093),l=n(29925),c=n(51724),p=n(61816),d=n(99496),u=n(79),h=(n(68643),n(2183)),m=n(97366),g=n(32420),_=n(19999),f=n(70271),b=n(44674),k=n(11073),v=n(51002),C=n(94896),y=n(60316),w=n(46765),T=n(48377),S=n(34539),j=n(8958),P=n(4930),I=n(66557);const _c0=e=>({"op-wp-single-card--content-project-name_hideable":e}),_c1=()=>({writable:!1,dateFormat:"MMM DD, YYYY",placeholder:""});function WorkPackageSingleCardComponent_button_4_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",9),i.bIt("click",(function WorkPackageSingleCardComponent_button_4_Template_button_click_0_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.emitStateLinkClicked(t,n.workPackage,!0))})),i.nrm(1,"op-icon",10),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("title",e.text.detailsView)}}function WorkPackageSingleCardComponent_button_5_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",11),i.bIt("click",(function WorkPackageSingleCardComponent_button_5_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.onRemoved(t.workPackage))})),i.nrm(1,"op-icon",12),i.k0s()}if(2&e){const e=i.XpG();i.AVh("-show",e.isNewResource(e.workPackage)),i.Y8G("title",e.text.removeCard)}}function WorkPackageSingleCardComponent_op_icon_6_Template(e,t){if(1&e&&i.nrm(0,"op-icon",13),2&e){const e=i.XpG();i.Y8G("ngClass","tooltip--"+e.disabledInfo.orientation),i.BMQ("data-tooltip",e.disabledInfo.text)}}function WorkPackageSingleCardComponent_edit_form_7_Template(e,t){if(1&e&&(i.j41(0,"edit-form",14)(1,"div",15),i.nrm(2,"op-editable-attribute-field",16)(3,"op-editable-attribute-field",17),i.k0s()()),2&e){const e=i.XpG();i.Y8G("resource",e.workPackage)("inEditMode",e.isNewResource(e.workPackage)),i.R7$(2),i.Y8G("resource",e.workPackage)("wrapperClasses","work-packages--type-selector")("fieldName","type"),i.R7$(),i.Y8G("resource",e.workPackage)}}function WorkPackageSingleCardComponent_div_8_span_6_Template(e,t){if(1&e&&(i.j41(0,"span",31),i.nrm(1,"display-field",32),i.EFF(2," - "),i.k0s()),2&e){const e=i.XpG(2);i.R7$(),i.Y8G("resource",e.workPackage)("displayFieldOptions",i.lJ4(2,_c1))}}function WorkPackageSingleCardComponent_div_8_span_7_Template(e,t){if(1&e&&i.nrm(0,"span",33),2&e){const e=i.XpG(2);i.Y8G("textContent",e.wpTypeAttribute(e.workPackage))("ngClass",e.typeHighlightingClass(e.workPackage))}}function WorkPackageSingleCardComponent_div_8_span_9_Template(e,t){if(1&e&&(i.j41(0,"span",31),i.EFF(1," - "),i.nrm(2,"display-field",34),i.k0s()),2&e){const e=i.XpG(2);i.R7$(2),i.Y8G("resource",e.workPackage)("displayFieldOptions",i.lJ4(2,_c1))}}function WorkPackageSingleCardComponent_div_8_img_10_Template(e,t){if(1&e&&i.nrm(0,"img",35),2&e){const e=i.XpG(2);i.Y8G("src",e.bcfSnapshotPath(e.workPackage),i.B4B)}}function WorkPackageSingleCardComponent_div_8_wp_status_button_12_Template(e,t){if(1&e&&i.nrm(0,"wp-status-button",36),2&e){const e=i.XpG(2);i.Y8G("workPackage",e.workPackage)("small",!0)}}function WorkPackageSingleCardComponent_div_8_span_13_Template(e,t){if(1&e&&i.nrm(0,"span",37),2&e){const e=i.XpG(2);i.FS9("title","added"===e.baselineMode?e.text.baseLineIconAdded:"removed"===e.baselineMode?e.text.baseLineIconRemoved:e.text.baseLineIconChanged),i.Y8G("ngClass","added"===e.baselineMode?"spot-icon_flex spot-icon_arrow-in op-table-baseline--icon-added":"removed"===e.baselineMode?"spot-icon_arrow-out op-table-baseline--icon-removed":"spot-icon_delta-triangle op-table-baseline--icon-changed")}}function WorkPackageSingleCardComponent_div_8_op_principal_14_Template(e,t){if(1&e&&i.nrm(0,"op-principal",38),2&e){const e=i.XpG(2);i.Y8G("principal",e.workPackage.assignee)("hideName",!0)("link",!1)}}function WorkPackageSingleCardComponent_div_8_display_field_15_Template(e,t){if(1&e&&i.nrm(0,"display-field",39),2&e){const e=i.XpG(2);i.Y8G("resource",e.workPackage)("displayFieldOptions",i.lJ4(3,_c1))("displayClass",e.combinedDateDisplayField)}}function WorkPackageSingleCardComponent_div_8_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",18)(1,"span",19),i.EFF(2),i.k0s(),i.j41(3,"a",20),i.bIt("click",(function WorkPackageSingleCardComponent_div_8_Template_a_click_3_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.emitStateLinkClicked(t,n.workPackage))})),i.EFF(4),i.k0s(),i.j41(5,"span",21),i.DNE(6,WorkPackageSingleCardComponent_div_8_span_6_Template,3,3,"span",22)(7,WorkPackageSingleCardComponent_div_8_span_7_Template,1,2,"span",23),i.nrm(8,"span",24),i.DNE(9,WorkPackageSingleCardComponent_div_8_span_9_Template,3,3,"span",22),i.k0s(),i.DNE(10,WorkPackageSingleCardComponent_div_8_img_10_Template,1,1,"img",25),i.j41(11,"div",26),i.DNE(12,WorkPackageSingleCardComponent_div_8_wp_status_button_12_Template,1,2,"wp-status-button",27)(13,WorkPackageSingleCardComponent_div_8_span_13_Template,1,2,"span",28),i.k0s(),i.DNE(14,WorkPackageSingleCardComponent_div_8_op_principal_14_Template,1,3,"op-principal",29)(15,WorkPackageSingleCardComponent_div_8_display_field_15_Template,1,4,"display-field",30),i.k0s()}if(2&e){const e=i.XpG();i.R7$(),i.Y8G("ngClass",i.eq3(14,_c0,e.showInfoButton||e.showRemoveButton)),i.R7$(),i.SpI(" - ",e.wpProjectName(e.workPackage)," "),i.R7$(),i.Y8G("href",e.fullWorkPackageLink(e.workPackage),i.B4B)("ngClass",e.uiStateLinkClass),i.R7$(),i.SpI(" #",e.workPackage.id," "),i.R7$(2),i.Y8G("ngIf",e.showAsInlineCard&&e.showStartDate),i.R7$(),i.Y8G("ngIf",!e.showAsInlineCard&&"type"!==e.highlightingMode),i.R7$(),i.Y8G("textContent",e.wpSubject(e.workPackage)),i.R7$(),i.Y8G("ngIf",e.showAsInlineCard&&e.showEndDate),i.R7$(),i.Y8G("ngIf",e.cardCoverImageShown(e.workPackage)&&!e.showAsInlineCard),i.R7$(2),i.Y8G("ngIf",e.showStatusButton),i.R7$(),i.Y8G("ngIf",""!==e.baselineIcon(e.workPackage)),i.R7$(),i.Y8G("ngIf",e.workPackage.assignee),i.R7$(),i.Y8G("ngIf",!e.showAsInlineCard)}}class WorkPackageSingleCardComponent extends d.p{constructor(e,t,n,r,s,a,l,c,p,d){super(),this.pathHelper=e,this.I18n=t,this.$state=n,this.uiRouterGlobals=r,this.wpTableSelection=s,this.wpTableFocus=a,this.cardView=l,this.cdRef=c,this.timezoneService=p,this.schemaCache=d,this.selectedWhenOpen=!1,this.showInfoButton=!1,this.showStatusButton=!0,this.showRemoveButton=!1,this.highlightingMode="inline",this.draggable=!1,this.orientation="vertical",this.shrinkOnMobile=!1,this.showAsInlineCard=!1,this.showStartDate=!0,this.showEndDate=!0,this.isClosed=!1,this.showAsGhost=!1,this.onRemove=new i.bkB,this.stateLinkClicked=new i.bkB,this.cardClicked=new i.bkB,this.cardDblClicked=new i.bkB,this.cardContextMenu=new i.bkB,this.uiStateLinkClass=o.qk,this.selected=!1,this.baselineMode="added",this.text={removeCard:this.I18n.t("js.card.remove_from_list"),detailsView:this.I18n.t("js.button_open_details"),baseLineIconAdded:this.I18n.t("js.baseline.icon_tooltip.added"),baseLineIconChanged:this.I18n.t("js.baseline.icon_tooltip.changed"),baseLineIconRemoved:this.I18n.t("js.baseline.icon_tooltip.removed")},this.isNewResource=m.A,this.tooltipPosition=k.A.BottomLeft,this.combinedDateDisplayField=C.A}ngOnInit(){(0,_.z)([this.wpTableSelection.live$(),this.uiRouterGlobals.params$]).pipe(this.untilDestroyed(),(0,f.T)((()=>this.selectedWhenOpen?this.uiRouterGlobals.params.workPackageId===this.workPackage.id:this.wpTableSelection.isSelected(this.workPackage.id)))).subscribe((e=>{this.selected=e,this.cdRef.detectChanges()}))}classIdentifier(e){return this.cardView.classIdentifier(e)}emitStateLinkClicked(e,t,n){if((0,h.R)(e))return;const i=this.classIdentifier(t),o=n?"split":"show";this.wpTableSelection.setSelection(t.id,this.cardView.findRenderedCard(i)),this.wpTableFocus.updateFocus(t.id),this.stateLinkClicked.emit({workPackageId:t.id,requestedState:o}),e.preventDefault()}cardClasses(){const e="op-wp-single-card";return{[`${e}_selected`]:this.selected,[`${e}_draggable`]:this.draggable,[`${e}_new`]:(0,m.A)(this.workPackage),[`${e}_shrink`]:this.shrinkOnMobile,[`${e}_inline`]:this.showAsInlineCard,[`${e}_closed`]:this.isClosed,[`${e}_ghosted`]:this.showAsGhost,[`${e}-${this.workPackage.id}`]:!!this.workPackage.id,[`${e}_${this.orientation}`]:!0}}cardTitle(){return`${this.workPackage.subject} (${this.workPackage.status.name})`}baselineIcon(e){return this.baselineMode=(0,v.JU)(e,this.schemaCache),this.baselineMode}wpTypeAttribute(e){return e.type.name}wpSubject(e){return e.subject}wpProjectName(e){return e.project?.name}fullWorkPackageLink(e){return this.$state.href("work-packages.show",{workPackageId:e.id})}cardHighlightingClass(e){return this.cardHighlighting(e)}typeHighlightingClass(e){return this.attributeHighlighting("type",e)}onRemoved(e){this.onRemove.emit(e)}cardCoverImageShown(e){return null!==this.bcfSnapshotPath(e)}bcfSnapshotPath(e){return e.bcfViewpoints&&e.bcfViewpoints.length>0?`${e.bcfViewpoints[0].href}/snapshot`:null}cardHighlighting(e){return["status","priority","type"].includes(this.highlightingMode)?s.H.backgroundClass(this.highlightingMode,e[this.highlightingMode].id):""}attributeHighlighting(e,t){return s.H.inlineClass(e,t.type.id)}static{this.ɵfac=function WorkPackageSingleCardComponent_Factory(e){return new(e||WorkPackageSingleCardComponent)(i.rXU(r.B),i.rXU(p.W),i.rXU(a.dw),i.rXU(a.ok),i.rXU(l.a),i.rXU(u.c),i.rXU(c.K),i.rXU(i.gRc),i.rXU(g.D),i.rXU(b.D))}}static{this.ɵcmp=i.VBU({type:WorkPackageSingleCardComponent,selectors:[["wp-single-card"]],inputs:{workPackage:"workPackage",selectedWhenOpen:"selectedWhenOpen",showInfoButton:"showInfoButton",showStatusButton:"showStatusButton",showRemoveButton:"showRemoveButton",highlightingMode:"highlightingMode",draggable:"draggable",orientation:"orientation",shrinkOnMobile:"shrinkOnMobile",disabledInfo:"disabledInfo",showAsInlineCard:"showAsInlineCard",showStartDate:"showStartDate",showEndDate:"showEndDate",isClosed:"isClosed",showAsGhost:"showAsGhost"},outputs:{onRemove:"onRemove",stateLinkClicked:"stateLinkClicked",cardClicked:"cardClicked",cardDblClicked:"cardDblClicked",cardContextMenu:"cardContextMenu"},features:[i.Vt3],decls:9,vars:10,consts:[["data-test-selector","op-wp-single-card","data-tour-selector","op-wp-single-card",1,"op-wp-single-card",3,"click","dblclick","contextmenu","ngClass","title"],[1,"op-wp-single-card--highlighting",3,"ngClass"],[1,"op-wp-single-card--card-actions"],["data-test-selector","op-wp-single-card--inline-buttons",1,"op-wp-single-card--inline-buttons","hidden-for-mobile"],["type","button","class","spot-link op-wp-single-card--details-button op-wp-single-card--card-action","data-test-selector","op-wp-single-card--details-button",3,"title","click",4,"ngIf"],["class","spot-link op-wp-single-card--inline-cancel-button op-wp-single-card--card-action","data-test-selector","op-wp-single-card--inline-cancel-button",3,"-show","title","click",4,"ngIf"],["class","-multiline op-wp-single-card--card-action op-wp-single-card--card-action_closed","icon-classes","icon-context icon-not-supported",3,"ngClass",4,"ngIf"],[3,"resource","inEditMode",4,"ngIf"],["class","op-wp-single-card--content",4,"ngIf"],["type","button","data-test-selector","op-wp-single-card--details-button",1,"spot-link","op-wp-single-card--details-button","op-wp-single-card--card-action",3,"click","title"],["icon-classes","icon3 icon-info2"],["data-test-selector","op-wp-single-card--inline-cancel-button",1,"spot-link","op-wp-single-card--inline-cancel-button","op-wp-single-card--card-action",3,"click","title"],["icon-classes","icon-context icon-close"],["icon-classes","icon-context icon-not-supported",1,"-multiline","op-wp-single-card--card-action","op-wp-single-card--card-action_closed",3,"ngClass"],[3,"resource","inEditMode"],[1,"op-wp-single-card-content","-new"],[1,"op-wp-single-card-content--type",3,"resource","wrapperClasses","fieldName"],["fieldName","subject",1,"op-wp-single-card-content--subject","-bold",3,"resource"],[1,"op-wp-single-card--content"],[1,"op-wp-single-card--content-project-name",3,"ngClass"],[1,"op-wp-single-card--content-id",3,"click","href","ngClass"],[1,"op-wp-single-card--content-subject-line"],["class","op-wp-single-card--content-inline-date",4,"ngIf"],["class","op-wp-single-card--content-type","data-test-selector","op-wp-single-card--content-type",3,"textContent","ngClass",4,"ngIf"],["data-test-selector","op-wp-single-card--content-subject",1,"op-wp-single-card--content-subject",3,"textContent"],["class","op-wp-single-card--content-cover-image",3,"src",4,"ngIf"],[1,"op-wp-single-card--content-status-baseline"],["class","op-wp-single-card--content-status",3,"workPackage","small",4,"ngIf"],["class","spot-icon spot-icon_1 spot-icon_flex op-wp-single-card--content-baseline",3,"ngClass","title",4,"ngIf"],["size","mini","class","op-wp-single-card--content-assignee","data-test-selector","op-wp-single-card--content-assignee",3,"principal","hideName","link",4,"ngIf"],["fieldName","dueDate","class","op-wp-single-card--content-dates","containerType","single-view",3,"resource","displayFieldOptions","displayClass",4,"ngIf"],[1,"op-wp-single-card--content-inline-date"],["fieldName","startDate","containerType","single-view",3,"resource","displayFieldOptions"],["data-test-selector","op-wp-single-card--content-type",1,"op-wp-single-card--content-type",3,"textContent","ngClass"],["fieldName","dueDate","containerType","single-view",3,"resource","displayFieldOptions"],[1,"op-wp-single-card--content-cover-image",3,"src"],[1,"op-wp-single-card--content-status",3,"workPackage","small"],[1,"spot-icon","spot-icon_1","spot-icon_flex","op-wp-single-card--content-baseline",3,"ngClass","title"],["size","mini","data-test-selector","op-wp-single-card--content-assignee",1,"op-wp-single-card--content-assignee",3,"principal","hideName","link"],["fieldName","dueDate","containerType","single-view",1,"op-wp-single-card--content-dates",3,"resource","displayFieldOptions","displayClass"]],template:function WorkPackageSingleCardComponent_Template(e,t){1&e&&(i.j41(0,"div",0),i.bIt("click",(function WorkPackageSingleCardComponent_Template_div_click_0_listener(e){return t.cardClicked.emit({workPackageId:t.workPackage.id,event:e})}))("dblclick",(function WorkPackageSingleCardComponent_Template_div_dblclick_0_listener(e){return t.cardDblClicked.emit({workPackageId:t.workPackage.id,event:e})}))("contextmenu",(function WorkPackageSingleCardComponent_Template_div_contextmenu_0_listener(e){return t.cardContextMenu.emit({workPackageId:t.workPackage.id,event:e})})),i.nrm(1,"div",1),i.j41(2,"div",2)(3,"div",3),i.DNE(4,WorkPackageSingleCardComponent_button_4_Template,2,1,"button",4)(5,WorkPackageSingleCardComponent_button_5_Template,2,3,"button",5)(6,WorkPackageSingleCardComponent_op_icon_6_Template,1,2,"op-icon",6),i.k0s()(),i.DNE(7,WorkPackageSingleCardComponent_edit_form_7_Template,4,6,"edit-form",7)(8,WorkPackageSingleCardComponent_div_8_Template,16,16,"div",8),i.k0s()),2&e&&(i.Y8G("ngClass",t.cardClasses())("title",t.cardTitle()),i.BMQ("data-qa-draggable",t.draggable||void 0)("data-qa-selected",t.selected||void 0),i.R7$(),i.Y8G("ngClass",t.cardHighlightingClass(t.workPackage)),i.R7$(3),i.Y8G("ngIf",!t.isNewResource(t.workPackage)&&t.showInfoButton),i.R7$(),i.Y8G("ngIf",t.isNewResource(t.workPackage)||t.showRemoveButton),i.R7$(),i.Y8G("ngIf",t.disabledInfo&&t.disabledInfo.text.length>0),i.R7$(),i.Y8G("ngIf",t.isNewResource(t.workPackage)),i.R7$(),i.Y8G("ngIf",!t.isNewResource(t.workPackage)))},dependencies:[y.YU,y.bT,w.i,T.f,S.G,j.c,P.W,I.n],styles:['.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-wp-single-card[_ngcontent-%COMP%]{display:flex;-webkit-user-select:none;user-select:none;width:calc(100% - 2px);border:1px solid var(--borderColor-default);border-radius:2px;padding:10px;position:relative;box-shadow:1px 1px 3px 0 var(--borderColor-default);background:var(--body-background);color:var(--body-font-color);font-size:var(--body-font-size)}.op-wp-single-card[_ngcontent-%COMP%]:hover   .op-wp-single-card--inline-buttons[_ngcontent-%COMP%]{opacity:1;z-index:2;box-shadow:-4px -4px 10px 4px var(--body-background)}.op-wp-single-card_new[_ngcontent-%COMP%]{padding-right:25px}.op-wp-single-card_ghosted[_ngcontent-%COMP%]{opacity:.5}.op-wp-single-card_selected[_ngcontent-%COMP%]{background-color:var(--selection-bgColor)}.op-wp-single-card_selected[_ngcontent-%COMP%]   .op-icon--wrapper[_ngcontent-%COMP%]{background:var(--selection-bgColor)}.op-wp-single-card_selected[_ngcontent-%COMP%]:hover   .op-wp-single-card--inline-buttons[_ngcontent-%COMP%]{box-shadow:none}.op-wp-single-card_closed[_ngcontent-%COMP%]:not(.op-wp-single-card_selected){background-color:var(--display-gray-bgColor-muted)}.op-wp-single-card_closed[_ngcontent-%COMP%]:not(.op-wp-single-card_selected)   .op-icon--wrapper[_ngcontent-%COMP%]{background:var(--display-gray-bgColor-muted)}.op-wp-single-card_closed[_ngcontent-%COMP%]:not(.op-wp-single-card_selected):hover   .op-wp-single-card--inline-buttons[_ngcontent-%COMP%]{box-shadow:-4px -4px 10px 4px var(--display-gray-bgColor-muted)}.op-wp-single-card_horizontal[_ngcontent-%COMP%]{height:100%}.op-wp-single-card_vertical[_ngcontent-%COMP%]{margin-top:10px}.op-wp-single-card_vertical[_ngcontent-%COMP%]:last-of-type{margin-bottom:5px}.op-wp-single-card_inline[_ngcontent-%COMP%]   .op-wp-single-card--content[_ngcontent-%COMP%]{grid-template-columns:max-content max-content auto auto 1fr;grid-template-rows:auto max-content;grid-template-areas:"status id project project project" "subject subject subject subject subject"}.op-wp-single-card_inline[_ngcontent-%COMP%]   .op-wp-single-card--content-assignee[_ngcontent-%COMP%]{display:none}.op-wp-single-card_inline[_ngcontent-%COMP%]   .op-wp-single-card--content-subject-line[_ngcontent-%COMP%]{display:flex}.op-wp-single-card_inline[_ngcontent-%COMP%]   .op-wp-single-card--content-subject[_ngcontent-%COMP%]{flex-grow:1;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}wp-single-card.gu-transit[_nghost-%COMP%]   .op-wp-single-card[_ngcontent-%COMP%]{border:1px dashed var(--accent-color);pointer-events:none}wp-single-card.gu-transit[_nghost-%COMP%]   .op-wp-single-card[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{visibility:hidden}.op-wp-single-card--content[_ngcontent-%COMP%]:not(.-new){display:grid;grid-template-columns:max-content max-content auto auto 1fr;grid-template-rows:auto 1fr max-content auto;grid-row-gap:5px;grid-column-gap:5px;grid-template-areas:"status id project project project" "subject subject subject subject subject" "image image image image image" "avatar avatar avatar dates dates";overflow:hidden;flex-grow:1;font-size:var(--body-font-size);line-height:16px}.op-wp-single-card--content-project-name[_ngcontent-%COMP%]{grid-area:project;font-style:italic;color:var(--fgColor-muted);font-size:12px;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}.op-wp-single-card--content-type[_ngcontent-%COMP%]{grid-area:type;margin-right:4px}.op-wp-single-card--content-subject-line[_ngcontent-%COMP%]{grid-area:subject;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis}.op-wp-single-card--content-assignee[_ngcontent-%COMP%]{margin-right:auto;grid-area:avatar;max-width:140px;color:var(--fgColor-muted);font-size:12px}.op-wp-single-card--content-id[_ngcontent-%COMP%]{grid-area:id;color:var(--fgColor-muted);font-size:12px}.op-wp-single-card--content-status-baseline[_ngcontent-%COMP%]{grid-area:status;margin-right:5px;max-width:6.5rem;display:flex}.op-wp-single-card--content-status[_ngcontent-%COMP%]{overflow:hidden}.op-wp-single-card--content-baseline[_ngcontent-%COMP%]{margin-left:.5rem}.op-wp-single-card--content-baseline-tooltip[_ngcontent-%COMP%]{width:6.5rem}.op-wp-single-card--content-cover-image[_ngcontent-%COMP%]{grid-area:image;max-height:350px;justify-self:center}@media screen and (max-width: 543px){.op-wp-single-card--content-cover-image[_ngcontent-%COMP%]{max-height:250px}}.op-wp-single-card--content-dates[_ngcontent-%COMP%]{grid-area:dates;place-self:center end;white-space:nowrap;color:var(--fgColor-muted);font-size:12px}.op-wp-single-card--content-inline-date[_ngcontent-%COMP%]{font-size:12px;color:var(--fgColor-muted);margin:0 8px;white-space:nowrap}.op-wp-single-card--highlighting[_ngcontent-%COMP%]{width:100%;height:2px;position:absolute;top:0;left:0;border-radius:2px 2px 0 0}.op-wp-single-card--card-actions[_ngcontent-%COMP%]{display:flex;position:absolute;top:9px;right:0}.op-wp-single-card--card-action[_ngcontent-%COMP%]{z-index:2}.op-wp-single-card--card-action_closed[_ngcontent-%COMP%]{color:#555}.op-wp-single-card--inline-buttons[_ngcontent-%COMP%]{opacity:0;padding-right:4px;white-space:nowrap}.op-wp-single-card_selected[_ngcontent-%COMP%]   .op-wp-single-card--inline-buttons[_ngcontent-%COMP%]{padding-left:15px}.op-icon--wrapper[_ngcontent-%COMP%]:not(.op-wp-single-card--inline-buttons_selected){background:var(--body-background)}.op-wp-single-card--inline-buttons.-show[_ngcontent-%COMP%]{opacity:1}.op-wp-single-card--inline-cancel-button[_ngcontent-%COMP%]{color:var(--warn)}@media only screen and (max-width: 543px){.op-wp-single-card_shrink[_ngcontent-%COMP%]{border:none;box-shadow:none;padding:15px}}'],changeDetection:0})}}},59933:(e,t,n)=>{"use strict";n.d(t,{K:()=>WorkPackageCopyFullViewComponent});var i=n(17840),o=n(68559),r=n(60316),s=n(58397),a=n(34539),l=n(46337),c=n(82711),p=n(99274),d=n(68899);const _c0=()=>["status","type"];function WorkPackageCopyFullViewComponent_div_0_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",1)(1,"edit-form",2),o.bIt("onSaved",(function WorkPackageCopyFullViewComponent_div_0_Template_edit_form_onSaved_1_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.onSaved(t))})),o.j41(2,"div",3)(3,"div",4),o.nrm(4,"wp-type-status",5),o.k0s(),o.j41(5,"ul",6)(6,"li",7),o.nrm(7,"opce-zen-mode-toggle-button"),o.k0s(),o.j41(8,"li",7)(9,"button",8),o.nrm(10,"i",9),o.k0s()()()(),o.nrm(11,"wp-single-view",10),o.j41(12,"wp-edit-actions-bar",11),o.bIt("onCancel",(function WorkPackageCopyFullViewComponent_div_0_Template_wp_edit_actions_bar_onCancel_12_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.cancelAndBackToList())})),o.k0s()()()}if(2&e){const e=o.XpG();o.R7$(),o.Y8G("resource",e.newWorkPackage)("skippedFields",o.lJ4(7,_c0))("inEditMode",!0),o.R7$(3),o.Y8G("workPackage",e.newWorkPackage),o.R7$(5),o.BMQ("title",e.text.button_settings),o.R7$(2),o.Y8G("workPackage",e.newWorkPackage)("showProject",e.copying)}}class WorkPackageCopyFullViewComponent extends i.r{constructor(){super(...arguments),this.successState="work-packages.show"}static{this.ɵfac=(()=>{let e;return function WorkPackageCopyFullViewComponent_Factory(t){return(e||(e=o.xGo(WorkPackageCopyFullViewComponent)))(t||WorkPackageCopyFullViewComponent)}})()}static{this.ɵcmp=o.VBU({type:WorkPackageCopyFullViewComponent,selectors:[["wp-copy-full-view"]],hostAttrs:[1,"work-packages-page--ui-view"],features:[o.Vt3],decls:1,vars:1,consts:[["class","work-package--new-state work-packages--new work-packages--show-view toolbar-container",4,"ngIf"],[1,"work-package--new-state","work-packages--new","work-packages--show-view","toolbar-container"],[3,"onSaved","resource","skippedFields","inEditMode"],[1,"toolbar"],[1,"title-container"],[3,"workPackage"],[1,"toolbar-items","hide-when-print"],[1,"toolbar-item","hidden-for-tablet"],["id","create-wp-menu-button","wpCreateSettingsMenu","",1,"button","last","work-packages-settings-button","toolbar-icon"],[1,"button--icon","icon-show-more"],[3,"workPackage","showProject"],[3,"onCancel"]],template:function WorkPackageCopyFullViewComponent_Template(e,t){1&e&&o.DNE(0,WorkPackageCopyFullViewComponent_div_0_Template,13,8,"div",0),2&e&&o.Y8G("ngIf",t.newWorkPackage)},dependencies:[r.bT,s.y,a.G,l.j,c.l,p.J,d.k],encapsulation:2,changeDetection:0})}}},95246:(e,t,n)=>{"use strict";n.d(t,{r:()=>WorkPackageCopySplitViewComponent});var i=n(17840),o=n(68559),r=n(60316),s=n(34539),a=n(46337),l=n(82711),c=n(2214),p=n(68899);const _c0=()=>["status","type"];function WorkPackageCopySplitViewComponent_div_0_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",1)(1,"edit-form",2),o.bIt("onSaved",(function WorkPackageCopySplitViewComponent_div_0_Template_edit_form_onSaved_1_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.onSaved(t))})),o.j41(2,"div",3)(3,"div",4),o.nrm(4,"wp-type-status",5),o.j41(5,"div",6)(6,"a",7),o.bIt("click",(function WorkPackageCopySplitViewComponent_div_0_Template_a_click_6_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.switchToFullscreen())})),o.nrm(7,"span",8),o.k0s()()(),o.nrm(8,"wp-single-view",9),o.k0s(),o.j41(9,"div",10)(10,"wp-edit-actions-bar",11),o.bIt("onCancel",(function WorkPackageCopySplitViewComponent_div_0_Template_wp_edit_actions_bar_onCancel_10_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.cancelAndBackToList())})),o.k0s()(),o.j41(11,"div",12),o.nrm(12,"wp-resizer",13),o.k0s()()()}if(2&e){const e=o.XpG();o.R7$(),o.Y8G("resource",e.newWorkPackage)("skippedFields",o.lJ4(8,_c0))("inEditMode",!0),o.R7$(3),o.Y8G("workPackage",e.newWorkPackage),o.R7$(4),o.Y8G("workPackage",e.newWorkPackage)("showProject",e.copying),o.R7$(4),o.Y8G("elementClass","work-packages-partitioned-page--content-right")("localStorageKey","openProject-splitViewFlexBasis")}}class WorkPackageCopySplitViewComponent extends i.r{static{this.ɵfac=(()=>{let e;return function WorkPackageCopySplitViewComponent_Factory(t){return(e||(e=o.xGo(WorkPackageCopySplitViewComponent)))(t||WorkPackageCopySplitViewComponent)}})()}static{this.ɵcmp=o.VBU({type:WorkPackageCopySplitViewComponent,selectors:[["wp-copy-split-view"]],features:[o.Vt3],decls:1,vars:1,consts:[["class","work-packages--details work-packages--new",4,"ngIf"],[1,"work-packages--details","work-packages--new"],[3,"onSaved","resource","skippedFields","inEditMode"],[1,"work-packages--details-content","-create-mode"],[1,"work-packages--new-details-header"],[3,"workPackage"],[1,"wp--details--switch-fullscreen-wrapper"],[1,"work-packages-show-view-button","wp--details--switch-fullscreen",3,"click"],[1,"icon-context","icon-to-fullscreen"],[3,"workPackage","showProject"],[1,"work-packages--details-toolbar-container"],[3,"onCancel"],[1,"work-packages--details--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"]],template:function WorkPackageCopySplitViewComponent_Template(e,t){1&e&&o.DNE(0,WorkPackageCopySplitViewComponent_div_0_Template,13,9,"div",0),2&e&&o.Y8G("ngIf",t.newWorkPackage)},dependencies:[r.bT,s.G,a.j,l.l,c.H,p.k],encapsulation:2,changeDetection:0})}}},17840:(e,t,n)=>{"use strict";n.d(t,{r:()=>WorkPackageCopyController});var i=n(24398),o=n(64334),r=n(29523),s=n(21861),a=n(51339),l=n(1758),c=n(68559);class WorkPackageCopyController extends r.D{constructor(){super(...arguments),this.copying=!0}ngOnInit(){super.ngOnInit(),this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed()).subscribe((e=>{e.__initialized_at===this.__initialized_at&&this.wpRelations.addCommonRelation(e.id,"relates",this.copiedWorkPackageId)}))}createdWorkPackage(){return this.copiedWorkPackageId=this.stateParams.copiedFromWorkPackageId,new Promise(((e,t)=>{this.apiV3Service.work_packages.id(this.copiedWorkPackageId).get().pipe((0,o.s)(1)).subscribe((n=>{this.createCopyFrom(n).then(e,t)}))}))}setTitle(){this.titleService.setFirstPart(this.I18n.t("js.work_packages.copy.title"))}createCopyFrom(e){const t=this.halEditing.changeFor(e);return this.wpCreate.copyWorkPackage(t).then((e=>(this.__initialized_at=e.pristineResource.__initialized_at,this.apiV3Service.work_packages.cache.updateWorkPackage(e.pristineResource,!0),this.halEditing.updateValue("new",e),e)))}static{this.ɵfac=(()=>{let e;return function WorkPackageCopyController_Factory(t){return(e||(e=c.xGo(WorkPackageCopyController)))(t||WorkPackageCopyController)}})()}static{this.ɵdir=c.FsC({type:WorkPackageCopyController,features:[c.Vt3]})}}(0,i.Cg)([(0,l.O)(),(0,i.Sn)("design:type",s.U)],WorkPackageCopyController.prototype,"wpRelations",void 0),(0,i.Cg)([(0,l.O)(),(0,i.Sn)("design:type",a.p)],WorkPackageCopyController.prototype,"halEditing",void 0)},5749:(e,t,n)=>{"use strict";n.d(t,{C:()=>CustomDateActionAdminComponent});var i=n(61816),o=n(68559),r=n(60316),s=n(34456),a=n(58192);function CustomDateActionAdminComponent_option_3_Template(e,t){if(1&e&&o.nrm(0,"option",6),2&e){const e=t.$implicit;o.Y8G("textContent",e.label)("ngValue",e)}}function CustomDateActionAdminComponent_span_4_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"span",7)(1,"op-basic-single-date-picker",8),o.bIt("valueChange",(function CustomDateActionAdminComponent_span_4_Template_op_basic_single_date_picker_valueChange_1_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.updateField(t))})),o.k0s()()}if(2&e){const e=o.XpG();o.R7$(),o.Y8G("id",e.fieldId+"_visible")("name",e.fieldId+"_input")("value",e.fieldValue)}}class CustomDateActionAdminComponent{constructor(e,t,n,i){this.elementRef=e,this.cdRef=t,this.appRef=n,this.I18n=i,this.valueVisible=!1,this.fieldName="",this.fieldValue="",this.visibleValue="",this.onKey="on",this.currentKey="current",this.currentFieldValue="%CURRENT_DATE%",this.operators=[{key:this.onKey,label:this.I18n.t("js.custom_actions.date.specific")},{key:this.currentKey,label:this.I18n.t("js.custom_actions.date.current_date")}]}ngOnInit(){const e=this.elementRef.nativeElement;this.fieldName=e.dataset.fieldName||"",this.fieldValue=e.dataset.fieldValue||"",this.fieldValue===this.currentFieldValue?this.selectedOperator=this.operators[1]:(this.selectedOperator=this.operators[0],this.visibleValue=this.fieldValue),this.toggleValueVisibility()}toggleValueVisibility(){this.valueVisible=this.selectedOperator.key===this.onKey,this.fieldValue===this.currentFieldValue&&(this.fieldValue=""),this.updateDbValue()}updateDbValue(){this.selectedOperator.key===this.currentKey&&(this.fieldValue=this.currentFieldValue)}get fieldId(){return this.fieldName.replace(/\[|\]/g,"_").replace("__","_").replace(/_$/,"")}updateField(e){this.fieldValue=e,this.cdRef.detectChanges()}static{this.ɵfac=function CustomDateActionAdminComponent_Factory(e){return new(e||CustomDateActionAdminComponent)(o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(o.o8S),o.rXU(i.W))}}static{this.ɵcmp=o.VBU({type:CustomDateActionAdminComponent,selectors:[["opce-custom-date-action-admin"]],decls:6,vars:6,consts:[[1,"form--field-container"],[1,"form--select-container"],[1,"form--select",3,"ngModelChange","change","ngModel"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],["class","form--text-field-container -slim",4,"ngIf"],["type","hidden",3,"name","value"],[3,"textContent","ngValue"],[1,"form--text-field-container","-slim"],["classes","form--text-field",3,"valueChange","id","name","value"]],template:function CustomDateActionAdminComponent_Template(e,t){1&e&&(o.j41(0,"div",0)(1,"span",1)(2,"select",2),o.mxI("ngModelChange",(function CustomDateActionAdminComponent_Template_select_ngModelChange_2_listener(e){return o.DH7(t.selectedOperator,e)||(t.selectedOperator=e),e})),o.bIt("change",(function CustomDateActionAdminComponent_Template_select_change_2_listener(){return t.toggleValueVisibility()})),o.DNE(3,CustomDateActionAdminComponent_option_3_Template,1,2,"option",3),o.k0s()(),o.DNE(4,CustomDateActionAdminComponent_span_4_Template,2,3,"span",4),o.nrm(5,"input",5),o.k0s()),2&e&&(o.R7$(2),o.R50("ngModel",t.selectedOperator),o.BMQ("id",t.fieldId),o.R7$(),o.Y8G("ngForOf",t.operators),o.R7$(),o.Y8G("ngIf",t.valueVisible),o.R7$(),o.Y8G("name",t.fieldName)("value",t.fieldValue))},dependencies:[r.Sq,r.bT,s.xH,s.y7,s.wz,s.BC,s.vS,a.r],encapsulation:2,changeDetection:0})}}},73217:(e,t,n)=>{"use strict";n.d(t,{p:()=>WpCustomActionsComponent});n(68643);var i=n(14593),o=n(99496),r=n(55596),s=n(99972),a=n(68559),l=n(60316),c=n(31616);function WpCustomActionsComponent_ng_container_0_wp_custom_action_1_Template(e,t){if(1&e&&a.nrm(0,"wp-custom-action",2),2&e){const e=t.$implicit,n=a.XpG(2);a.Y8G("workPackage",n.workPackage)("action",e)}}function WpCustomActionsComponent_ng_container_0_Template(e,t){if(1&e&&(a.qex(0),a.DNE(1,WpCustomActionsComponent_ng_container_0_wp_custom_action_1_Template,1,2,"wp-custom-action",1),a.bVm()),2&e){const e=a.XpG();a.R7$(),a.Y8G("ngForOf",e.actions)("ngForTrackBy",e.trackByHref)}}class WpCustomActionsComponent extends o.p{constructor(e,t,n){super(),this.apiV3Service=e,this.cdRef=t,this.bannersService=n,this.trackByHref=r.S0,this.actions=[]}ngOnInit(){this.apiV3Service.work_packages.id(this.workPackage.id).requireAndStream().pipe(this.untilDestroyed()).subscribe((e=>{this.actions=e.customActions,this.cdRef.detectChanges()}))}static{this.ɵfac=function WpCustomActionsComponent_Factory(e){return new(e||WpCustomActionsComponent)(a.rXU(i.n),a.rXU(a.gRc),a.rXU(s.b))}}static{this.ɵcmp=a.VBU({type:WpCustomActionsComponent,selectors:[["wp-custom-actions"]],inputs:{workPackage:"workPackage"},features:[a.Vt3],decls:1,vars:1,consts:[[4,"ngIf"],["class","custom-action",3,"workPackage","action",4,"ngFor","ngForOf","ngForTrackBy"],[1,"custom-action",3,"workPackage","action"]],template:function WpCustomActionsComponent_Template(e,t){1&e&&a.DNE(0,WpCustomActionsComponent_ng_container_0_Template,2,2,"ng-container",0),2&e&&a.Y8G("ngIf",!t.bannersService.eeShowBanners)},dependencies:[l.Sq,l.bT,c.o],encapsulation:2,changeDetection:0})}}},31616:(e,t,n)=>{"use strict";n.d(t,{o:()=>WpCustomActionComponent});var i=n(14593),o=(n(20009),n(91691)),r=n(51339),s=n(36178),a=n(49349),l=(n(68643),n(17456)),c=n(99496),p=n(68559);class WpCustomActionComponent extends c.p{constructor(e,t,n,i,o,r,s){super(),this.halResourceService=e,this.apiV3Service=t,this.wpActivity=n,this.notificationService=i,this.halEditing=o,this.halEvents=r,this.cdRef=s}ngOnInit(){this.halEvents.events$.pipe(this.untilDestroyed()).subscribe((()=>this.cdRef.detectChanges()))}fetchAction(){null!==this.action.href&&this.halResourceService.get(this.action.href).subscribe((e=>{this.action=e}))}get change(){return this.halEditing.changeFor(this.workPackage)}update(){if(null===this.action.href)return;const e={lockVersion:this.workPackage.lockVersion,_links:{workPackage:{href:this.workPackage.previewPath()}}};this.change.inFlight=!0,this.halResourceService.post(`${this.action.href}/execute`,e).subscribe((e=>{this.notificationService.showSave(e,!1),this.workPackage=e,this.wpActivity.clear(this.workPackage.id),this.apiV3Service.work_packages.cache.updateWorkPackage(e).then((()=>{this.halEditing.stopEditing(e),this.halEvents.push(e,{eventType:"updated"}),this.change.inFlight=!1,this.cdRef.detectChanges()}))}),(e=>{this.notificationService.handleRawError(e,this.workPackage),this.change.inFlight=!1,this.cdRef.detectChanges()}))}onMouseEnter(){this.fetchAction()}static{this.ɵfac=function WpCustomActionComponent_Factory(e){return new(e||WpCustomActionComponent)(p.rXU(s.t),p.rXU(i.n),p.rXU(l.Z),p.rXU(a.U),p.rXU(r.p),p.rXU(o.o),p.rXU(p.gRc))}}static{this.ɵcmp=p.VBU({type:WpCustomActionComponent,selectors:[["wp-custom-action"]],hostBindings:function WpCustomActionComponent_HostBindings(e,t){1&e&&p.bIt("mouseenter",(function WpCustomActionComponent_mouseenter_HostBindingHandler(){return t.onMouseEnter()}))},inputs:{workPackage:"workPackage",action:"action"},features:[p.Vt3],decls:2,vars:3,consts:[[1,"custom-action--button","button","-narrow","hide-when-print",3,"click","title","disabled"]],template:function WpCustomActionComponent_Template(e,t){1&e&&(p.j41(0,"button",0),p.bIt("click",(function WpCustomActionComponent_Template_button_click_0_listener(){return t.update()})),p.EFF(1),p.k0s()),2&e&&(p.FS9("title",t.action.description?t.action.description:t.action.name),p.Y8G("disabled",t.change.inFlight),p.R7$(),p.SpI(" ",t.action.name,"\n"))},encapsulation:2,changeDetection:0})}}},42793:(e,t,n)=>{"use strict";n.d(t,{B:()=>WorkPackageSplitViewToolbarComponent});var i=n(72688),o=n(63894),r=n(61816),s=(n(68643),n(51339)),a=n(59452),l=n(68559),c=n(60316),p=n(46765),d=n(61944),u=n(61933),h=n(17709),m=n(921),g=n(21212);function WorkPackageSplitViewToolbarComponent_op_work_package_mark_notification_button_2_Template(e,t){if(1&e&&l.nrm(0,"op-work-package-mark-notification-button",7),2&e){const e=l.XpG();l.Y8G("workPackage",e.workPackage)("showWithText",!0)}}function WorkPackageSplitViewToolbarComponent_wp_share_button_3_Template(e,t){if(1&e&&l.nrm(0,"wp-share-button",8),2&e){const e=l.XpG();l.Y8G("workPackage",e.workPackage)}}function WorkPackageSplitViewToolbarComponent_wp_reminder_button_5_Template(e,t){if(1&e&&l.nrm(0,"wp-reminder-button",8),2&e){const e=l.XpG();l.Y8G("workPackage",e.workPackage)}}class WorkPackageSplitViewToolbarComponent{constructor(e,t,n,i){this.I18n=e,this.halEditing=t,this.configurationService=n,this.currentUserService=i,this.displayShareButton$=!1,this.displayReminderButton$=(0,a.of)(!1),this.text={button_more:this.I18n.t("js.button_more")}}ngOnInit(){this.displayShareButton$=this.currentUserService.hasCapabilities$("work_package_shares/index",this.workPackage.project.id),this.displayReminderButton$=this.currentUserService.isLoggedInAndHasCapabalities$("work_packages/read",this.workPackage.project.id)}static{this.ɵfac=function WorkPackageSplitViewToolbarComponent_Factory(e){return new(e||WorkPackageSplitViewToolbarComponent)(l.rXU(r.W),l.rXU(s.p),l.rXU(i.s),l.rXU(o.K))}}static{this.ɵcmp=l.VBU({type:WorkPackageSplitViewToolbarComponent,selectors:[["wp-details-toolbar"]],inputs:{workPackage:"workPackage",displayNotificationsButton:"displayNotificationsButton"},decls:10,vars:12,consts:[[1,"work-packages--details-toolbar"],[3,"workPackage","showText"],["data-test-selector","mark-notification-read-button",3,"workPackage","showWithText",4,"ngIf"],[3,"workPackage",4,"ngIf"],["wpSingleContextMenu","",1,"button","dropdown-relative",3,"wpSingleContextMenu-workPackage"],[1,"button--text","button--text_without_icon",3,"textContent"],["icon-classes","button--dropdown-indicator"],["data-test-selector","mark-notification-read-button",3,"workPackage","showWithText"],[3,"workPackage"]],template:function WorkPackageSplitViewToolbarComponent_Template(e,t){1&e&&(l.j41(0,"div",0),l.nrm(1,"wp-watcher-button",1),l.DNE(2,WorkPackageSplitViewToolbarComponent_op_work_package_mark_notification_button_2_Template,1,2,"op-work-package-mark-notification-button",2)(3,WorkPackageSplitViewToolbarComponent_wp_share_button_3_Template,1,1,"wp-share-button",3),l.nI1(4,"async"),l.DNE(5,WorkPackageSplitViewToolbarComponent_wp_reminder_button_5_Template,1,1,"wp-reminder-button",3),l.nI1(6,"async"),l.j41(7,"button",4),l.nrm(8,"span",5)(9,"op-icon",6),l.k0s()()),2&e&&(l.R7$(),l.Y8G("workPackage",t.workPackage)("showText",!0),l.R7$(),l.Y8G("ngIf",t.displayNotificationsButton),l.R7$(),l.Y8G("ngIf",l.bMT(4,8,t.displayShareButton$)),l.R7$(2),l.Y8G("ngIf",l.bMT(6,10,t.displayReminderButton$)),l.R7$(2),l.Y8G("wpSingleContextMenu-workPackage",t.workPackage),l.BMQ("accesskey",7),l.R7$(),l.Y8G("textContent",t.text.button_more))},dependencies:[c.bT,p.i,d.T,u.d,h.l,m.u,g.d,c.Jj],encapsulation:2,changeDetection:0})}}},83145:(e,t,n)=>{"use strict";n.d(t,{Y:()=>WorkPackageFilterValues});var i=n(24398),o=n(27514),r=n(63894),s=n(36178),a=n(55596),l=n(30189),c=n(1758),p=n(86866);class WorkPackageFilterValues{constructor(e,t,n=[]){this.injector=e,this.filters=t,this.excluded=n,this.handlers={"=":this.applyFirstValue.bind(this),"!*":this.setToNull.bind(this)}}applyDefaultsFromFilters(e){_.each(this.filters,(t=>{if(-1!==this.excluded.indexOf(t.id))return;const n=t.operator.id;if("project"===t.id){if("="!==n)return;const i=_.find(t.values,(e=>(e instanceof o.q?e.href:e)===this.currentProject.apiv3Path));return void this.setValue(e,"project",i||t.values[0])}if("id"===t.id)return;const i=this.handlers[n];i?.call(this,e,t)}))}applyFirstValue(e,t){if(this.filterAlreadyApplied(e,t))return;const n=t.values[0];if(n){const i=this.mapFilterToAttribute(t);this.setValueFor(e,i,n)}}setToNull(e,t){const n=this.mapFilterToAttribute(t);this.setValue(e,n,{href:null})}setValueFor(e,t,n){const i=this.findSpecialValue(n,t)||n;i&&this.setValue(e,t,i)}setValue(e,t,n){e instanceof l.C?e.setValue(t,n):e[t]=n}findSpecialValue(e,t){return"parent"===t?e:e instanceof o.q&&"/api/v3/users/me"===e.href&&this.currentUser.isLoggedIn?this.halResourceService.fromSelfLink(`/api/v3/users/${this.currentUser.userId}`):void 0}filterAlreadyApplied(e,t){const n=e instanceof l.C?e.projectedResource[t.id]:e[t.id],i=_.castArray(n);for(let e=0;e<t.values.length;e++)for(let n=0;n<i.length;n++)if((0,a.K0)(i[n],t.values[e]))return!0;return!1}mapFilterToAttribute(e){return"onlySubproject"===e.id?"project":e.id}}(0,i.Cg)([(0,c.O)(),(0,i.Sn)("design:type",r.K)],WorkPackageFilterValues.prototype,"currentUser",void 0),(0,i.Cg)([(0,c.O)(),(0,i.Sn)("design:type",s.t)],WorkPackageFilterValues.prototype,"halResourceService",void 0),(0,i.Cg)([(0,c.O)(),(0,i.Sn)("design:type",p.c)],WorkPackageFilterValues.prototype,"currentProject",void 0)},30189:(e,t,n)=>{"use strict";n.d(t,{C:()=>WorkPackageChangeset});var i=n(38429),o=n(34760),r=n(97366);class WorkPackageChangeset extends i.b{setValue(e,t){super.setValue(e,t),"project"!==e&&"type"!==e||this.updateForm(),document.dispatchEvent(new CustomEvent("work-package-updated"))}applyChanges(e){return delete e.description,super.applyChanges(e)}setNewDefaultFor(e,t){"description"===e&&(0,r.A)(this.pristineResource)?this.pristineResource.description=t:super.setNewDefaultFor(e,t)}get schema(){return this.form$.hasValue()?o.T.create(super.schema,this.projectedResource):super.schema}}},72864:(e,t,n)=>{"use strict";n.d(t,{h:()=>WorkPackageReplacementLabelComponent});var i=n(34539),o=n(68559);const r=["*"];class WorkPackageReplacementLabelComponent{constructor(e,t){this.wpeditForm=e,this.elementRef=t}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement)}activate(e){if(jQuery(e.target).closest(".help-text--entry").length)return!0;const t=this.wpeditForm.fields[this.fieldName];return t&&t.handleUserActivate(null),!1}static{this.ɵfac=function WorkPackageReplacementLabelComponent_Factory(e){return new(e||WorkPackageReplacementLabelComponent)(o.rXU(i.G),o.rXU(o.aKT))}}static{this.ɵcmp=o.VBU({type:WorkPackageReplacementLabelComponent,selectors:[["wp-replacement-label"]],inputs:{fieldName:"fieldName"},ngContentSelectors:r,decls:2,vars:1,consts:[["tabindex","-1",1,"wp-replacement-label",3,"click"]],template:function WorkPackageReplacementLabelComponent_Template(e,t){1&e&&(o.NAR(),o.j41(0,"span",0),o.bIt("click",(function WorkPackageReplacementLabelComponent_Template_span_click_0_listener(e){return t.activate(e)})),o.SdG(1),o.k0s()),2&e&&o.BMQ("data-test-selector",t.fieldName)},encapsulation:2})}}},11262:(e,t,n)=>{"use strict";n.d(t,{IZ:()=>l,m_:()=>CellBuilder});var i=n(24398),o=n(60807),r=n(44674),s=n(1758),a=n(58154);const l="wp-table--cell-td",c="wp-table--cell-container";class CellBuilder{constructor(e){this.injector=e,this.fieldRenderer=new o.wJ(this.injector,"table")}build(e,t){const n=document.createElement("td"),i=t.id;n.classList.add(l,i),"subject"===i&&n.classList.add("-max"),["startDate","dueDate","duration"].includes(i)&&n.classList.add("-no-ellipsis"),["estimatedTime","remainingTime"].includes(i)&&n.classList.add("-min-200");const o=this.schemaCache.of(e).ofProperty(i);o&&"User"===o.type&&n.classList.add("-contains-avatar");const r=document.createElement("span");return n.appendChild(r),this.render(r,e,i),n}refresh(e,t,n){e.innerHTML="",this.render(e,t,n)}render(e,t,n){const i=this.schemaCache.of(t).mappedName(n),r="id"!==n&&this.wpTableBaseline.isChanged(t,i);e.classList.add(c,o.K1,n);const s=this.fieldRenderer.render(t,n,null);r&&(s.classList.add("op-table-baseline--field","op-table-baseline--new-field"),this.prependChanges(e,t,i)),e.appendChild(s)}prependChanges(e,t,n){const i=t.attributesByTimestamp[0];i.$links.schema=i.$links.schema||t.$links.schema;const o=this.fieldRenderer.render(i,n,null);o.classList.add("op-table-baseline--field","op-table-baseline--old-field"),e.classList.add("op-table-baseline--container"),e.parentElement.classList.add("op-table-baseline--cell"),e.classList.remove(c),e.appendChild(o)}}(0,i.Cg)([(0,s.O)(r.D),(0,i.Sn)("design:type",r.D)],CellBuilder.prototype,"schemaCache",void 0),(0,i.Cg)([(0,s.O)(a.b1),(0,i.Sn)("design:type",a.b1)],CellBuilder.prototype,"wpTableBaseline",void 0)},46116:(e,t,n)=>{"use strict";var i;n.d(t,{H:()=>i}),function(e){e.backgroundClass=function backgroundClass(e,t){return`__hl_background_${e}_${t}`},e.inlineClass=function inlineClass(e,t){return`__hl_inline_${e}_${t}`},e.colorClass=function colorClass(e,t){return e?`__hl_inline_color_${t}_text`:`__hl_inline_color_${t}_dot`},e.overdueDate=function overdueDate(e){return 0===e?"__hl_date_due_today":e<=-1?"__hl_date_overdue":"__hl_date_not_overdue"}}(i||(i={}))},13036:(e,t,n)=>{"use strict";n.d(t,{N8:()=>s,Pb:()=>r,ce:()=>i,uD:()=>o});const i={id:"__internal-sorthandle"},o={id:"__internal-contextMenu"},r={id:"__internal-baseline"},s={id:"sharedWithUsers"}},75930:(e,t,n)=>{"use strict";n.d(t,{x:()=>GroupSumsBuilder});var i=n(24398),o=n(1758),r=n(72407),s=n(11048),a=n(44674),l=n(39356),c=n(11762);class GroupSumsBuilder extends r.Kz{constructor(){super(...arguments),this.text={sum:this.I18n.t("js.label_sum")}}buildSumsRow(e){const t=document.createElement("tr");return t.classList.add("wp-table--sums-row","wp-table--row",(0,c.KD)(e.index)),this.renderColumns(e.sums,t),t}renderColumns(e,t){this.augmentedColumns.forEach(((n,i)=>{const o=document.createElement("td"),r=this.renderContent(e,n.id,this.sumsSchema[n.id]);0===i&&this.appendFirstLabel(r),o.appendChild(r),t.append(o)}))}appendFirstLabel(e){const t=document.createElement("span");t.textContent=`${this.text.sum}`,t.title=`${this.text.sum}`,e.prepend(t)}get sumsSchema(){const e=this.querySpace.results.value.sumsSchema.href;return this.schemaCache.state(e).value}renderContent(e,t,n){const i=document.createElement("div");if(i.classList.add("wp-table--sum-container",t),!n)return i;const o=this.displayFieldService.getField(e,t,n,{injector:this.injector,container:"table",options:{}});return o.isEmpty()||o.render(i,o.valueString),i}}(0,i.Cg)([(0,o.O)(),(0,i.Sn)("design:type",s.i)],GroupSumsBuilder.prototype,"querySpace",void 0),(0,i.Cg)([(0,o.O)(),(0,i.Sn)("design:type",a.D)],GroupSumsBuilder.prototype,"schemaCache",void 0),(0,i.Cg)([(0,o.O)(),(0,i.Sn)("design:type",l.w)],GroupSumsBuilder.prototype,"displayFieldService",void 0)},56368:(e,t,n)=>{"use strict";n.d(t,{A:()=>o,D:()=>i});const i="wp-table--group-header",o="-collapsed"},11762:(e,t,n)=>{"use strict";function groupIdentifier(e){let t=e.value||"nullValue";if(e.href)try{t+=e.href.map((e=>e.href)).join("-")}catch(t){console.error(`Failed to extract group identifier for ${e.value}`)}return t=t.toLowerCase().replace(/[^a-z0-9]+/g,"-"),`${groupByProperty(e)}-${t}`}function groupName(e){const{value:t}=e;return null===t?"-":t}function groupByProperty(e){return e._links.groupBy.href.split("/").pop()}function groupedRowClassName(e){return`__row-group-${e}`}function groupTypeFromIdentifier(e){return e.split("-")[0]}function groupIdFromIdentifier(e){return e.split("-").pop()}n.d(t,{$m:()=>groupTypeFromIdentifier,HA:()=>groupIdentifier,KD:()=>groupedRowClassName,QY:()=>groupIdFromIdentifier,WI:()=>groupByProperty,hv:()=>groupName})},75808:(e,t,n)=>{"use strict";n.d(t,{T5:()=>c,my:()=>p,rc:()=>SingleHierarchyRowBuilder});var i=n(24398),o=n(72407),r=n(13432),s=n(40659),a=n(94450),l=n(1758);const c="-hierarchy-collapsed",p="wp-table--hierarchy-aditional-row";class SingleHierarchyRowBuilder extends o.Kz{constructor(e,t){super(e,t),this.injector=e,this.workPackageTable=t,this.text={leaf:e=>this.I18n.t("js.work_packages.hierarchy.leaf",{level:e}),expanded:e=>this.I18n.t("js.work_packages.hierarchy.children_expanded",{level:e}),collapsed:e=>this.I18n.t("js.work_packages.hierarchy.children_collapsed",{level:e})}}refreshRow(e,t){const n=super.refreshRow(e,t);return n.find(".wp-table--hierarchy-span").remove(),this.appendHierarchyIndicator(e,n),n}buildEmpty(e){const[t,n]=super.buildEmpty(e),[i,o]=this.ancestorRowData(e);return t.classList.add(...i),this.appendHierarchyIndicator(e,jQuery(t)),[t,o]}ancestorRowData(e){const t=this.wpTableHierarchies.current,n=[];let i=!1;this.parentsWithVisibleChildren[e.id]&&n.push((0,s.GK)(e.id));const o=e.getAncestors();return _.isArray(o)&&o.forEach((e=>{n.push((0,s.LB)(e.id)),t.collapsed[e.id]&&(i=!0,n.push((0,s.Bj)(e.id)))})),[n,i]}buildAncestorRow(e,t,n){const i=this.states.workPackages.get(e.id).value,[o,r]=this.buildEmpty(i);return o.classList.add(p),[o,r]}appendHierarchyIndicator(e,t,n){const i=e.getAncestors(),o=void 0===n?i.length:n,r=this.buildHierarchyIndicator(e,t,o);t.find("td.subject").addClass("-with-hierarchy").prepend(r),t.find("td.subject").css("minWidth",125+20*o+"px"),t.find("td.subject .wp-table--cell-container").css("width",`calc(100% - 25px - ${20*o}px)`)}buildHierarchyIndicator(e,t,n){const i=document.createElement("span"),o=this.wpTableHierarchies.collapsed(e.id),r=25+20*n+"px";if(i.classList.add("wp-table--hierarchy-span"),i.style.width=r,i.dataset.indentation=r,this.parentsWithVisibleChildren[e.id]){const e=o?c:"";i.innerHTML=`\n            <a href tabindex="0" role="button" class="wp-table--hierarchy-indicator -hierarchy-collapsed ${e}">\n              <span class="wp-table--hierarchy-indicator-icon" aria-hidden="true"></span>\n              <span class="wp-table--hierarchy-indicator-expanded hidden-for-sighted">${this.text.expanded(n)}</span>\n              <span class="wp-table--hierarchy-indicator-collapsed hidden-for-sighted">${this.text.collapsed(n)}</span>\n            </a>\n        `}else i.innerHTML=`\n            <span tabindex="0" class="wp-table--leaf-indicator">\n              <span class="hidden-for-sighted">${this.text.leaf(n)}</span>\n            </span>\n        `;return i}}(0,i.Cg)([(0,l.O)(),(0,i.Sn)("design:type",a.j)],SingleHierarchyRowBuilder.prototype,"wpTableHierarchies",void 0),(0,i.Cg)([(0,l.O)(),(0,i.Sn)("design:type",r.D)],SingleHierarchyRowBuilder.prototype,"states",void 0)},82839:(e,t,n)=>{"use strict";n.d(t,{U$:()=>c,r7:()=>p,wv:()=>RelationCellbuilder});var i=n(24398),o=n(98755),r=n(1758),s=n(13432),a=n(21861),l=n(11262);const c="wp-table--relation-cell-td",p="wp-table--relation-indicator";class RelationCellbuilder{constructor(e){this.injector=e}build(e,t){const n=document.createElement("td");n.classList.add(l.IZ,c,t.id),n.dataset.columnId=t.id;const i=this.wpTableRelationColumns.getExpandFor(e.id)===t.id,o=this.wpRelations.state(e.id).value,r=this.wpTableRelationColumns.relationsForColumn(e,o,t),s=this.renderIndicator(),a=this.renderBadge(r);return i&&n.classList.add("-expanded"),r.length>0&&(n.appendChild(a),n.appendChild(s)),n}renderIndicator(){const e=document.createElement("span");return e.classList.add(p),e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex","0"),e}renderBadge(e){const t=document.createElement("span");return t.classList.add("wp-table--relation-count"),t.textContent=`${e.length}`,t.classList.add("badge","-border-only"),t}}(0,i.Cg)([(0,r.O)(),(0,i.Sn)("design:type",s.D)],RelationCellbuilder.prototype,"states",void 0),(0,i.Cg)([(0,r.O)(),(0,i.Sn)("design:type",a.U)],RelationCellbuilder.prototype,"wpRelations",void 0),(0,i.Cg)([(0,r.O)(),(0,i.Sn)("design:type",o.f)],RelationCellbuilder.prototype,"wpTableRelationColumns",void 0)},72407:(e,t,n)=>{"use strict";n.d(t,{Kz:()=>SingleRowBuilder,b:()=>P,Wc:()=>j});var i=n(24398),o=n(61816),r=n(28952),s=n(88352),a=n(1567),l=n(34522),c=n(13036),p=n(1758),d=n(11262);class TableActionRenderer{constructor(e){this.injector=e}build(e){const t=document.createElement("td");t.classList.add(d.IZ,l.GZ,c.uD.id,"hide-when-print");const n=document.createElement("span");return n.classList.add(l.Gj),this.tableActionsService.render(e).forEach((e=>{n.appendChild(e)})),t.appendChild(n),t}}(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",a.A)],TableActionRenderer.prototype,"tableActionsService",void 0);var u=n(29925),h=n(36819),m=n(79421),g=n(82839),_=n(95685),f=n(58154),b=n(13432),k=n(25073),v=n(44674),C=n(51002);class BaselineColumnBuilder{constructor(e){this.injector=e}build(e,t){const n=document.createElement("td");n.classList.add(d.IZ,"op-table-baseline--column-cell",t.id),n.dataset.columnId=t.id;if((e.attributesByTimestamp||[]).length<=1)return n;const i=this.changeIcon(e);return i&&n.appendChild(i),n}changeIcon(e){const t=(0,C.JU)(e,this.schemaCache);if("added"===t){const e=(0,k.N)("spot-icon","spot-icon_1","spot-icon_flex","spot-icon_arrow-in","op-table-baseline--icon-added");return e.title=this.I18n.t("js.work_packages.baseline.addition_label"),e}if("removed"===t){const e=(0,k.N)("spot-icon","spot-icon_1","spot-icon_flex","spot-icon_arrow-out","op-table-baseline--icon-removed");return e.title=this.I18n.t("js.work_packages.baseline.removal_label"),e}if("updated"===t){const e=(0,k.N)("spot-icon","spot-icon_1","spot-icon_flex","spot-icon_delta-triangle","op-table-baseline--icon-changed");return e.title=this.I18n.t("js.work_packages.baseline.modification_label"),e}return null}}(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",b.D)],BaselineColumnBuilder.prototype,"states",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",f.b1)],BaselineColumnBuilder.prototype,"wpTableBaseline",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",v.D)],BaselineColumnBuilder.prototype,"schemaCache",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",o.W)],BaselineColumnBuilder.prototype,"I18n",void 0);var y=n(11048),w=n(65896),T=n(20287),S=n(51133);class ShareCellbuilder{constructor(e){this.injector=e}build(e,t){const n=document.createElement("td");n.classList.add(d.IZ,t.id),n.dataset.columnId=t.id;const i=this.isolatedQuerySpace.workPackageSharesCache.get(e.id).getValueOr([]);return 0===i.length?n.innerHTML="-":(this.principalRenderer.renderAbbreviated(n,i.map((e=>e.principal))),n.setAttribute("title",this.I18n.t("js.work_packages.sharing.show_all_users"))),n.addEventListener("click",this.showShareModal.bind(this,e)),n}showShareModal(e){this.opModalService.show(T.Z,"global",{workPackage:e},!1,!0)}}(0,i.Cg)([(0,p.O)(y.i),(0,i.Sn)("design:type",y.i)],ShareCellbuilder.prototype,"isolatedQuerySpace",void 0),(0,i.Cg)([(0,p.O)(w.r),(0,i.Sn)("design:type",w.r)],ShareCellbuilder.prototype,"principalRenderer",void 0),(0,i.Cg)([(0,p.O)(S.a),(0,i.Sn)("design:type",S.a)],ShareCellbuilder.prototype,"opModalService",void 0),(0,i.Cg)([(0,p.O)(o.W),(0,i.Sn)("design:type",o.W)],ShareCellbuilder.prototype,"I18n",void 0);const j="wp-table--row",P="wp--row";class SingleRowBuilder{constructor(e,t){this.injector=e,this.workPackageTable=t,this.cellBuilder=new d.m_(this.injector),this.relationCellBuilder=new g.wv(this.injector),this.shareCellBuilder=new ShareCellbuilder(this.injector),this.contextLinkBuilder=new TableActionRenderer(this.injector),this.baselineColumnBuilder=new BaselineColumnBuilder(this.injector),this.augmentedColumns=this.buildAugmentedColumns()}get columns(){return this.wpTableColumns.getColumns()}buildAugmentedColumns(){const e=[...this.columns,c.uD];return this.wpTableBaseline.isActive()&&e.unshift(c.Pb),this.workPackageTable.configuration.dragAndDropEnabled&&e.unshift(c.ce),e}buildCell(e,t){if((0,_.t)(t))return this.relationCellBuilder.build(e,t);if(t.id===c.N8.id)return this.shareCellBuilder.build(e,t);switch(t.id){case c.uD.id:if(this.workPackageTable.configuration.actionsColumnEnabled)return this.contextLinkBuilder.build(e);if(this.workPackageTable.configuration.columnMenuEnabled){const e=document.createElement("td");return e.classList.add("hide-when-print"),e}return null;case c.Pb.id:return this.baselineColumnBuilder.build(e,t);default:return this.cellBuilder.build(e,t)}}buildEmpty(e){const t=this.createEmptyRow(e);return this.buildEmptyRow(e,t)}createEmptyRow(e){const t=this.classIdentifier(e),n=document.createElement("tr");return n.setAttribute("tabindex","0"),n.dataset.workPackageId=e.id,n.dataset.classIdentifier=t,n.classList.add(j,P,t,`${t}-table`,"issue"),n}get placeholderRow(){const e=document.createElement("tr"),t=document.createElement("td");return e.classList.add("wp--placeholder-row"),t.colSpan=this.augmentedColumns.length,e.appendChild(t),e}classIdentifier(e){return`wp-row-${e.id}`}refreshRow(e,t){const n=t.find(`.${d.IZ}`).detach(),i=[];return this.augmentedColumns.forEach((t=>{const o=n.filter(`td.${t.id}`);if((t.id.startsWith("__internal")||this.isColumnBeingEdited(e,t))&&o.length)return void i.push(o[0]);const r=this.buildCell(e,t);r&&i.push(r)})),t.prepend(i),t}isColumnBeingEdited(e,t){const n=this.workPackageTable.editing.forms[e.id];return n&&n.activeFields[t.id]}buildEmptyRow(e,t){const n=this.workPackageTable.editing.change(e),i={};if(n&&!n.isEmpty()){const t=(0,r.zt)(this.classIdentifier(e));n.changedAttributes.forEach((e=>{i[e]=t.find(`.${d.IZ}.${e}`)}))}return this.augmentedColumns.forEach((n=>{let o;const r=i[n.id];r&&r.length?((0,h.cY)(`Rendering previous open column ${n.id} on ${e.id}`),jQuery(t).append(r)):(o=this.buildCell(e,n),o&&t.appendChild(o))})),this.wpTableSelection.isSelected(e.id)&&t.classList.add(m.BE),[t,!1]}}(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",u.a)],SingleRowBuilder.prototype,"wpTableSelection",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",s.T)],SingleRowBuilder.prototype,"wpTableColumns",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",f.b1)],SingleRowBuilder.prototype,"wpTableBaseline",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",o.W)],SingleRowBuilder.prototype,"I18n",void 0)},78158:(e,t,n)=>{"use strict";n.d(t,{J:()=>TimelineRowBuilder,T:()=>l});var i=n(24398),o=n(13432),r=n(68222),s=n(1758),a=n(72407);const l="wp-timeline-cell";class TimelineRowBuilder{constructor(e,t){this.injector=e,this.workPackageTable=t}build(e){const t=document.createElement("div");return t.classList.add(l,a.b),e&&(t.dataset.workPackageId=e),t}insert(e,t,n=[]){const i=this.build(e);i.classList.add(...n),t.appendChild(i)}}(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",o.D)],TimelineRowBuilder.prototype,"states",void 0),(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",r.X)],TimelineRowBuilder.prototype,"wpTableTimeline",void 0)},79421:(e,t,n)=>{"use strict";n.d(t,{BE:()=>o,Xq:()=>UiStateLinkBuilder,qk:()=>i});const i="__ui-state-link",o="-checked";class UiStateLinkBuilder{constructor(e,t){this.$state=e,this.keepTab=t}linkToDetails(e,t,n){return this.build(e,"split",t,n)}linkToShow(e,t,n){return this.build(e,"show",t,n)}build(e,t,n,o){const r=document.createElement("a");let s,a;return"show"===t?(s="work-packages.show.tabs",a=this.keepTab.currentShowTab):(s="work-packages.partitioned.list.details.tabs",a=this.keepTab.currentDetailsTab),r.href=this.$state.href(s,{workPackageId:e,tabIdentifier:a}),r.classList.add(i),r.dataset.workPackageId=e,r.dataset.wpState=t,r.setAttribute("title",n),r.textContent=o,r}}},26655:(e,t,n)=>{"use strict";n.d(t,{c:()=>ClickOrEnterHandler,d:()=>onClickOrEnter});var i=n(41670);function onClickOrEnter(e,t){("click"===e.type||"keydown"===e.type&&e.which===i.c.ENTER)&&t()}class ClickOrEnterHandler{handleEvent(e,t){onClickOrEnter(t,(()=>this.processEvent(e.workPackageTable,t)))}}},40659:(e,t,n)=>{"use strict";function collapsedGroupClass(e=""){return`__collapsed-group-${e}`}function hierarchyGroupClass(e){return`__hierarchy-group-${e}`}function hierarchyRootClass(e){return`__hierarchy-root-${e}`}function ancestorClassIdentifier(e){return`wp-ancestor-row-${e}`}n.d(t,{Bj:()=>collapsedGroupClass,GK:()=>hierarchyRootClass,LB:()=>hierarchyGroupClass,PK:()=>ancestorClassIdentifier})},28952:(e,t,n)=>{"use strict";n.d(t,{LC:()=>locateTableRow,Y9:()=>locatePredecessorBySelector,bU:()=>scrollTableRowIntoView,fD:()=>relationRowClass,nT:()=>isInsideCollapsedGroup,un:()=>rowId,zt:()=>locateTableRowByIdentifier});var i=n(40659);function rowId(e){return`wp-row-${e}-table`}function relationRowClass(){return"wp-table--relations-aditional-row"}function locateTableRow(e){return jQuery(`.${rowId(e)}`)}function locateTableRowByIdentifier(e){return jQuery(`.${e}-table`)}function isInsideCollapsedGroup(e){return!!e&&null!=Array.from(e.classList).find((e=>e.includes((0,i.Bj)())))}function locatePredecessorBySelector(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}return null}function scrollTableRowIntoView(e){try{const t=locateTableRow(e),n=t.scrollParent(),i=n.scrollTop(),o=i+n.height(),r=t[0].offsetTop,s=r+t.height();r<i?n[0].scrollTop=r:s>o&&(n[0].scrollTop=s-n.height())}catch(e){console.warn(`Can't scroll row element into view: ${e}`)}}},3422:(e,t,n)=>{"use strict";n.d(t,{G:()=>WorkPackageTable});var i=n(24398),o=n(61816),r=n(11048),s=n(13432),a=n(1758),l=n(14593),c=n(59769),p=n(36819),d=n(56368),u=n(88352),h=n(72407);class RowsBuilder{constructor(e,t){this.injector=e,this.workPackageTable=t}isApplicable(e){return!0}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",s.D)],RowsBuilder.prototype,"states",void 0);var m=n(11762);function groupClassNameFor(e){return`group-${e.identifier}`}class GroupHeaderBuilder{constructor(e){this.injector=e,this.text={collapse:this.I18n.t("js.label_collapse"),expand:this.I18n.t("js.label_expand")}}buildGroupRow(e,t){const n=document.createElement("tr");let i,o;return e.collapsed?(o=this.text.expand,i="icon-plus"):(o=this.text.collapse,i="icon-minus2"),n.classList.add(d.D,groupClassNameFor(e)),n.id=`wp-table-rowgroup-${e.index}`,n.dataset.groupIndex=e.index.toString(),n.dataset.groupIdentifier=e.identifier,n.innerHTML=`\n      <td colspan="${t}" class="-no-highlighting">\n        <div class="expander icon-context ${i}">\n          <span class="hidden-for-sighted">${_.escape(o)}</span>\n        </div>\n        <div class="group--value" data-test-selector="op-group--value">\n          ${_.escape((0,m.hv)(e))}\n          <span class="count">\n            (${e.count})\n          </span>\n        </div>\n      </td>\n    `,n}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",o.W)],GroupHeaderBuilder.prototype,"I18n",void 0);var g=n(75930),f=n(51339),b=n(62665),k=n(46116);class HighlightingRenderPass{constructor(e,t,n){this.injector=e,this.table=t,this.tablePass=n}render(){if(!this.isApplicable)return;const e=this.wpTableHighlighting.current.mode;window.getComputedStyle(document.body);this.tablePass.renderedOrder.forEach(((t,n)=>{if(!t.workPackage)return;const i=t.workPackage[e];if(!i)return;const o=i.id;this.tablePass.tableBody.children[n].classList.add(k.H.backgroundClass(e,o))}))}get isApplicable(){return!(this.wpTableHighlighting.isInline||this.wpTableHighlighting.isDisabled)}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",b.I)],HighlightingRenderPass.prototype,"wpTableHighlighting",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",r.i)],HighlightingRenderPass.prototype,"querySpace",void 0);var v=n(11262),C=n(9845),y=n(13036);class DragDropHandleBuilder{constructor(e){this.injector=e;const t=this.injector.get(C._);this.actionService=t.get(e)}build(e,t){const n=document.createElement("td");if(n.classList.add(v.IZ,y.ce.id),!this.actionService.canPickup(e))return n;n.classList.add("wp-table--sort-td",y.ce.id,"hide-when-print");const i=document.createElement("span");return i.classList.add("wp-table--drag-and-drop-handle","icon-drag-handle"),n.appendChild(i),n}}var w=n(51524);class DragDropHandleRenderPass{constructor(e,t,n){this.injector=e,this.table=t,this.tablePass=n,this.dragDropHandleBuilder=new DragDropHandleBuilder(this.injector)}render(){this.table.configuration.dragAndDropEnabled&&this.wpTableOrder.withLoadedPositions().then((e=>{this.tablePass.renderedOrder.forEach(((t,n)=>{if(!t.workPackage||"relations"===t.renderType)return;const i=this.dragDropHandleBuilder.build(t.workPackage,e[t.workPackage.id]);i&&t.element.replaceChild(i,t.element.firstElementChild)}))}))}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",u.T)],DragDropHandleRenderPass.prototype,"wpTableColumns",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",w.k)],DragDropHandleRenderPass.prototype,"wpTableOrder",void 0);var T=n(78158);class TimelineRenderPass{constructor(e,t,n){this.injector=e,this.table=t,this.tablePass=n}render(){this.timelineBody=document.createDocumentFragment(),this.timelineBuilder=new T.J(this.injector,this.table),this.tablePass.renderedOrder.forEach((e=>{const t=e.workPackage?e.workPackage.id:null,n=this.timelineBuilder.build(t);n.classList.add(e.classIdentifier,`${e.classIdentifier}-timeline`,...e.additionalClasses),this.timelineBody.appendChild(n)}))}}var S=n(21861),j=n(98755),P=n(95685);function relationGroupClass(e){return`__relations-expanded-from-${e}`}const I="wp-table--relation-cell-td";class RelationRowBuilder extends h.Kz{constructor(e,t){super(e,t),this.injector=e,this.workPackageTable=t}buildCell(e,t){return(0,P.t)(t)?this.emptyRelationCell(t):super.buildCell(e,t)}buildEmptyRelationRow(e,t,n){const i=t.denormalized(e),o=this.states.workPackages.get(i.targetId).value,r=this.createEmptyRelationRow(e,o),[s,a]=super.buildEmptyRow(o,r);return[s,o]}createEmptyRelationRow(e,t){const n=this.relationClassIdentifier(e,t),i=document.createElement("tr");return i.dataset.workPackageId=t.id,i.dataset.classIdentifier=n,i.classList.add(h.b,h.Wc,"issue","wp-table--relations-aditional-row",n,`${n}-table`,relationGroupClass(e.id)),i}relationClassIdentifier(e,t){return function relationIdentifier(e,t){return`wp-relation-row-${t}-to-${e}`}(t.id,e.id)}appendRelationLabel(e,t,n,i,o){const r=n.denormalized(t);let s="";if("toType"===o&&(s=this.I18n.t(`js.relation_labels.${r.reverseRelationType}`)),"ofType"===o){s=this.states.workPackages.get(r.target.id).value.type.name}const a=document.createElement("span");a.classList.add("relation-row--type-label"),a.textContent=s;document.createTextNode(r.target.name);e.find(`.${I}`).empty(),e.find(`.${I}.${i}`).append(a)}emptyRelationCell(e){const t=document.createElement("td");return t.classList.add(I,v.IZ,e.id),t}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",s.D)],RelationRowBuilder.prototype,"states",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",o.W)],RelationRowBuilder.prototype,"I18n",void 0);class RelationsRenderPass{constructor(e,t,n){this.injector=e,this.table=t,this.tablePass=n,this.relationRowBuilder=new RelationRowBuilder(e,t)}render(){if(!this.isApplicable)return;_.clone(this.tablePass.renderedOrder).forEach(((e,t)=>{if(!e.workPackage)return;const{workPackage:n}=e,i=n.id,o=this.wpRelations.state(i);o.hasValue()&&0!==_.size(o.value)&&this.wpTableRelationColumns.relationsToExtendFor(n,o.value,((t,o,r)=>{const[s,a]=this.relationRowBuilder.buildEmptyRelationRow(n,t,r);s.classList.add(...e.additionalClasses),this.relationRowBuilder.appendRelationLabel(jQuery(s),n,t,o.id,r),this.tablePass.spliceRow(s,`.${this.relationRowBuilder.classIdentifier(n)},.${relationGroupClass(i)}`,{classIdentifier:this.relationRowBuilder.relationClassIdentifier(n,a),additionalClasses:e.additionalClasses.concat(["wp-table--relations-aditional-row"]),workPackage:a,belongsTo:n,renderType:"relations",hidden:e.hidden,data:{relation:t,columnId:o.id,relationType:r}})}))}))}refreshRelationRow(e,t,n){const i=this.relationRowBuilder.refreshRow(t,n);return this.relationRowBuilder.appendRelationLabel(i,e.belongsTo,e.data.relation,e.data.columnId,e.data.relationType),i}get isApplicable(){return this.wpTableColumns.hasRelationColumns()}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",S.U)],RelationsRenderPass.prototype,"wpRelations",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",u.T)],RelationsRenderPass.prototype,"wpTableColumns",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",j.f)],RelationsRenderPass.prototype,"wpTableRelationColumns",void 0);class PrimaryRenderPass{constructor(e,t,n){this.injector=e,this.workPackageTable=t,this.rowBuilder=n}render(){return(0,p.li)("Primary render pass",(()=>{this.prepare(),this.doRender(),this.postRender()})),this.highlighting.render(),(0,p.li)("Relations render pass",(()=>{this.relations.render()})),(0,p.li)("Drag handle render pass",(()=>{this.dragDropHandle.render()})),(0,p.li)("Timelines render pass",(()=>{this.timeline.render()})),this}refresh(e,t,n){const i=jQuery(n).find(`.${e.classIdentifier}`);let o=null;switch(e.renderType){case"primary":o=this.rowBuilder.refreshRow(t,i);break;case"relations":o=this.relations.refreshRelationRow(e,t,i)}null!==o&&i.length&&i.replaceWith(o)}get result(){return this.renderedOrder.map((e=>({classIdentifier:e.classIdentifier,workPackageId:e.workPackage?e.workPackage.id:null,hidden:e.hidden})))}spliceRow(e,t,n){const i=jQuery(this.tableBody).find(t).last();i.after(e);const o=i.index();this.renderedOrder.splice(o+1,0,n)}prepare(){this.timeline=new TimelineRenderPass(this.injector,this.workPackageTable,this),this.relations=new RelationsRenderPass(this.injector,this.workPackageTable,this),this.dragDropHandle=new DragDropHandleRenderPass(this.injector,this.workPackageTable,this),this.highlighting=new HighlightingRenderPass(this.injector,this.workPackageTable,this),this.tableBody=document.createDocumentFragment(),this.renderedOrder=[]}postRender(){0===this.renderedOrder.length&&this.workPackageTable.renderPlaceholderRow&&this.tableBody.appendChild(this.rowBuilder.placeholderRow)}appendRow(e,t,n=[],i=!1){this.tableBody.appendChild(t),this.renderedOrder.push({classIdentifier:this.rowBuilder.classIdentifier(e),additionalClasses:n,workPackage:e,renderType:"primary",element:t,hidden:i})}appendNonWorkPackageRow(e,t,n=[],i=!1){e.classList.add(t),this.tableBody.appendChild(e),this.renderedOrder.push({element:e,classIdentifier:t,additionalClasses:n,workPackage:null,renderType:"primary",hidden:i})}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",f.p)],PrimaryRenderPass.prototype,"halEditing",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",s.D)],PrimaryRenderPass.prototype,"states",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",o.W)],PrimaryRenderPass.prototype,"I18n",void 0);class PlainRenderPass extends PrimaryRenderPass{constructor(e,t,n){super(e,t,n),this.injector=e,this.workPackageTable=t,this.rowBuilder=n}doRender(){this.workPackageTable.originalRows.forEach((e=>{const t=this.workPackageTable.originalRowIndex[e],[n]=this.rowBuilder.buildEmpty(t.object);t.element=n,this.appendRow(t.object,n),this.tableBody.appendChild(n)}))}}class GroupedRenderPass extends PlainRenderPass{constructor(e,t,n,i,o){super(e,t,new h.Kz(e,t)),this.injector=e,this.workPackageTable=t,this.groups=n,this.headerBuilder=i,this.colspan=o,this.sumsBuilder=new g.x(this.injector,this.workPackageTable)}doRender(){let e=null;const{length:t}=this.workPackageTable.originalRows;this.workPackageTable.originalRows.forEach(((t,n)=>{const i=this.workPackageTable.originalRowIndex[t],o=this.matchingGroup(i.object),r=e!==o;if(e&&r&&this.renderSumsRow(e),o&&r){const t=groupClassNameFor(o),n=this.headerBuilder.buildGroupRow(o,this.colspan);this.appendNonWorkPackageRow(n,t,["-group-row"]),e=o}i.group=e,this.buildSingleRow(i)})),e&&this.renderSumsRow(e)}matchingGroup(e){return _.find(this.groups,(t=>{let n=e[(0,m.WI)(t)];if(void 0===n&&(n=null),_.isArray(n))return this.matchesMultiValue(n,t);if(n&&n.href)return!!_.find(t._links.valueLink,(e=>n.href===e.href));let i=""===t.value?null:t.value;return i&&"string"==typeof i&&(i=i.replace("%","")),i==n}))}matchesMultiValue(e,t){if(e.length!==t.href.length)return!1;const joinedOrderedHrefs=e=>_.map(e,(e=>e.href)).sort().join(", ");return _.isEqualWith(e,t.href,((e,t)=>joinedOrderedHrefs(e)===joinedOrderedHrefs(t)))}buildSingleRow(e){const{group:t}=e;t||console.warn("All rows should have a group, but this one doesn't %O",e);let n=!1;const i=[],[o,r]=this.rowBuilder.buildEmpty(e.object);t&&(i.push((0,m.KD)(t.index)),n=!!t.collapsed,n&&i.push(d.A)),e.element=o,o.classList.add(...i),this.appendRow(e.object,o,i,n)}renderSumsRow(e){if(!e.sums)return;const t=groupClassNameFor(e),n=this.sumsBuilder.buildSumsRow(e);this.appendNonWorkPackageRow(n,t)}}class GroupedRowsBuilder extends RowsBuilder{constructor(e,t){super(e,t),this.injector=e}isApplicable(e){return!_.isEmpty(this.groups)}get groups(){return this.querySpace.groups.value||[]}get collapsedGroups(){return this.querySpace.collapsedGroups.value||{}}buildRows(){const e=new GroupHeaderBuilder(this.injector);return new GroupedRenderPass(this.injector,this.workPackageTable,this.getGroupData(),e,this.workPackageTable.colspan).render()}refreshExpansionState(){const e=this.getGroupData(),t=this.querySpace.tableRendered.value,n=new GroupHeaderBuilder(this.injector);jQuery(this.workPackageTable.tableAndTimelineContainer).find(`.${d.D}`).each(((i,o)=>{const r=jQuery(o).data("groupIndex"),s=e[r],a=n.buildGroupRow(s,this.workPackageTable.colspan);o.parentNode&&o.parentNode.replaceChild(a,o);const l=jQuery(this.workPackageTable.tableAndTimelineContainer).find(`.${(0,m.KD)(r)}`);l.toggleClass(d.A,!!s.collapsed),l.filter(`.${h.Wc}`).each(((e,n)=>{const i=jQuery(n).index();t[i].hidden=!!s.collapsed}))})),this.querySpace.tableRendered.putValue(t,"Updated hidden state of rows after group change.")}getGroupData(){return this.groups.map(((e,t)=>(e.index=t,e._links&&e._links.valueLink&&(e.href=e._links.valueLink),e.identifier=(0,m.HA)(e),e.collapsed=this.collapsedGroups[e.identifier],e)))}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",r.i)],GroupedRowsBuilder.prototype,"querySpace",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",s.D)],GroupedRowsBuilder.prototype,"states",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",u.T)],GroupedRowsBuilder.prototype,"wpTableColumns",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",o.W)],GroupedRowsBuilder.prototype,"I18n",void 0);var x=n(94450),R=n(40659),F=n(75808);class HierarchyRenderPass extends PrimaryRenderPass{constructor(e,t,n){super(e,t,n),this.injector=e,this.workPackageTable=t,this.rowBuilder=n,this.rendered={},this.additionalParents={},this.deferred={},this.parentsWithVisibleChildren={}}prepare(){super.prepare(),this.hierarchies=this.wpTableHierarchies.current,_.each(this.workPackageTable.originalRowIndex,(e=>{e.object.getAncestors().forEach((e=>{this.parentsWithVisibleChildren[e.id]=!0}))})),this.rowBuilder.parentsWithVisibleChildren=this.parentsWithVisibleChildren}doRender(){this.workPackageTable.originalRows.forEach((e=>{const t=this.workPackageTable.originalRowIndex[e],n=t.object;if(!this.deferInsertion(n)){if(n.getAncestors().length)this.buildWithHierarchy(t);else{const[e,i]=this.rowBuilder.buildEmpty(n);t.element=e,this.tableBody.appendChild(e),this.markRendered(e,n,i)}this.renderAllDeferredChildren(n)}}))}deferInsertion(e){const t=e.getAncestors();if(0===t.length)return!1;const n=t.concat([e]);for(let e=n.length-2;e>=0;--e){const t=n[e],i=this.workPackageTable.originalRowIndex[t.id];if(this.rendered[t.id])return!1;if(i){let i=this.deferred[t.id]||[],o=n.slice(e+1,n.length);return o=o.map((e=>this.apiV3Service.work_packages.cache.state(e.id).value)),i=i.concat(o),this.deferred[t.id]=_.uniqBy(i,(e=>e.id)),!0}}return!1}renderAllDeferredChildren(e){const t=e.id;(this.deferred[t]||[]).forEach((t=>{this.insertUnderParent(this.getOrBuildRow(t),t.parent||e),this.renderAllDeferredChildren(t)}))}getOrBuildRow(e){let t=this.workPackageTable.originalRowIndex[e.id];return t||(t={object:e}),t}buildWithHierarchy(e){const t=e.object.getAncestors(),n=[];t.forEach(((e,i)=>{const o=this.states.workPackages.get(e.id).getValueOr(e);if(!this.rendered[o.id]){const[e,r]=this.rowBuilder.buildAncestorRow(o,n,i);if(0===i)this.tableBody.appendChild(e),this.markRendered(e,o,r,!0);else{const n=t[i-1];this.insertAtExistingHierarchy(o,e,n,r,!0)}this.additionalParents[o.id]=o}n.push((0,R.LB)(o.id)),t.slice(0,i).forEach((e=>{n.push((0,R.LB)(e.id))}))}));const i=_.last(t);this.insertUnderParent(e,i)}insertUnderParent(e,t){const[n,i]=this.rowBuilder.buildEmpty(e.object);e.element=n,this.insertAtExistingHierarchy(e.object,n,t,i,!1)}markRendered(e,t,n=!1,i=!1){this.rendered[t.id]=!0,this.renderedOrder.push(this.buildRenderInfo(e,t,n,i))}insertAtExistingHierarchy(e,t,n,i,o){const r=`.__hierarchy-root-${n.id}`,s=`.__hierarchy-group-${n.id}`;this.spliceRow(t,`${r},${s}`,this.buildRenderInfo(t,e,i,o)),this.rendered[e.id]=!0}buildRenderInfo(e,t,n,i){const o={element:e,classIdentifier:"",additionalClasses:[],workPackage:t,renderType:"primary",hidden:n},[r,s]=this.rowBuilder.ancestorRowData(t);return i?(o.additionalClasses=[F.my].concat(r),o.classIdentifier=(0,R.PK)(t.id)):(o.additionalClasses=r,o.classIdentifier=this.rowBuilder.classIdentifier(t)),o}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",r.i)],HierarchyRenderPass.prototype,"querySpace",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",s.D)],HierarchyRenderPass.prototype,"states",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",l.n)],HierarchyRenderPass.prototype,"apiV3Service",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",x.j)],HierarchyRenderPass.prototype,"wpTableHierarchies",void 0);class HierarchyRowsBuilder extends RowsBuilder{constructor(e,t){super(e,t),this.injector=e,this.workPackageTable=t}isApplicable(e){return this.wpTableHierarchies.isEnabled}buildRows(){const e=new F.rc(this.injector,this.workPackageTable);return new HierarchyRenderPass(this.injector,this.workPackageTable,e).render()}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",s.D)],HierarchyRowsBuilder.prototype,"states",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",u.T)],HierarchyRowsBuilder.prototype,"wpTableColumns",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",x.j)],HierarchyRowsBuilder.prototype,"wpTableHierarchies",void 0);class PlainRowsBuilder extends RowsBuilder{constructor(e,t){super(e,t),this.injector=e}buildRows(){const e=new h.Kz(this.injector,this.workPackageTable);return new PlainRenderPass(this.injector,this.workPackageTable,e).render()}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",o.W)],PlainRowsBuilder.prototype,"I18n",void 0);var M=n(87879),O=n(97501),D=n(51053),G=n(37248),E=n(60807),A=n(95445);class TableEditForm extends D.Rz{constructor(e,t,n,i){super(e),this.injector=e,this.table=t,this.workPackageId=n,this.classIdentifier=i,this.cellBuilder=new v.m_(this.injector),this.resourceSubscription=this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().subscribe((e=>this.resource=e))}destroy(){_.each(this.activeFields,(e=>{e.deactivate(!1)})),this.resourceSubscription.unsubscribe()}findContainer(e){return this.rowContainer.find(`.${v.IZ}.${e} .${E.K1}`).first()}findCell(e){return this.rowContainer.find(`.${v.IZ}.${e}`).first()}activateField(e,t,n,i){return this.waitForContainer(n).then((o=>{const r=this.findCell(n);r.addClass(G.Vu);let s=parseInt(r.css("width"));return s=s>150?s-10:150,r.css("max-width",`${s}px`),r.css("width",`${s}px`),this.editingPortalService.create(o,this.injector,e,t,n,i)}))}reset(e,t){const n=this.findContainer(e),i=this.findCell(e);n.length&&(this.findCell(e).css("width",""),this.findCell(e).css("max-width",""),this.cellBuilder.refresh(n[0],this.resource,e),i.removeClass(G.Vu),t&&this.FocusHelper.focus(n[0]))}requireVisible(e){return this.wpListService.conditionallyLoadForm().then((()=>(this.wpTableColumns.addColumn(e),this.waitForContainer(e))))}focusOnFirstError(){jQuery(this.table.tableAndTimelineContainer).find(".inline-edit--active-field.-error .inline-edit--field").first().trigger("focus")}loadFieldSchema(e,t=!1){return["startDate","dueDate","date"].includes(e)&&(e="combinedDate"),super.loadFieldSchema(e,t)}waitForContainer(e){return new Promise(((t,n)=>{const i=setInterval((()=>{const n=this.findContainer(e);n.length>0&&(clearInterval(i),t(n[0]))}),100)}))}get rowContainer(){return jQuery(this.table.tableAndTimelineContainer).find(`.${this.classIdentifier}-table`)}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",u.T)],TableEditForm.prototype,"wpTableColumns",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",l.n)],TableEditForm.prototype,"apiV3Service",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",s.D)],TableEditForm.prototype,"states",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",M.k)],TableEditForm.prototype,"FocusHelper",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",O.G)],TableEditForm.prototype,"editingPortalService",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",A.E)],TableEditForm.prototype,"wpListService",void 0);class WorkPackageTableEditingContext{constructor(e,t){this.table=e,this.injector=t,this.forms={}}reset(){_.each(this.forms,(e=>e.destroy())),this.forms={}}change(e){return this.halEditing.typedState(e).value}stopEditing(e){this.halEditing.stopEditing(e);const t=this.forms[e.id];t&&(t.destroy(),delete this.forms[e.id])}startEditing(e,t){const n=e.id,i=this.forms[n];return i||(this.forms[n]=new TableEditForm(this.injector,this.table,n,t))}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",f.p)],WorkPackageTableEditingContext.prototype,"halEditing",void 0);class WorkPackageTable{constructor(e,t,n,i,o,r,s){this.injector=e,this.tableAndTimelineContainer=t,this.scrollContainer=n,this.tbody=i,this.timelineBody=o,this.timelineController=r,this.configuration=s,this.originalRows=[],this.originalRowIndex={},this.hierarchyRowsBuilder=new HierarchyRowsBuilder(this.injector,this),this.groupedRowsBuilder=new GroupedRowsBuilder(this.injector,this),this.plainRowsBuilder=new PlainRowsBuilder(this.injector,this),this.builders=[this.hierarchyRowsBuilder,this.groupedRowsBuilder,this.plainRowsBuilder],this.lastRenderPass=null,this.editing=new WorkPackageTableEditingContext(this,this.injector)}get renderedRows(){return this.querySpace.tableRendered.getValueOr([])}findRenderedRow(e){const t=_.findIndex(this.renderedRows,(t=>t.classIdentifier===e));return[t,this.renderedRows[t]]}get rowBuilder(){return _.find(this.builders,(e=>e.isApplicable(this)))}buildIndex(e){this.originalRowIndex={},this.originalRows=e.map(((e,t)=>{const n=e.id;return e=this.apiV3Service.work_packages.cache.current(n,e),this.originalRowIndex[n]={object:e,workPackageId:n,position:t},n}))}initialSetup(e){this.buildIndex(e),this.redrawTableAndTimeline()}redrawTableAndTimeline(){const e=this.performRenderPass(!1);requestAnimationFrame((()=>{this.tbody.replaceChildren(),this.timelineBody.replaceChildren(),this.tbody.appendChild(e.tableBody),this.timelineBody.appendChild(e.timeline.timelineBody),setTimeout((()=>this.querySpace.tableRendered.putValue(e.result)))}))}redrawTable(){const e=this.performRenderPass();this.querySpace.tableRendered.putValue(e.result)}refreshRows(e){const t=this.lastRenderPass;t?_.each(t.renderedOrder,(n=>{n.workPackage&&n.workPackage.id===e.id&&((0,p.cY)(`Refreshing rendered row ${n.classIdentifier}`),n.workPackage=e,t.refresh(n,e,this.tbody))})):(0,p.cY)("Trying to refresh a singular row without a previous render pass.")}get renderPlaceholderRow(){return this.configuration.dragAndDropEnabled}performRenderPass(e=!0){this.editing.reset();const t=this.lastRenderPass=this.rowBuilder.buildRows();return e&&requestAnimationFrame((()=>{this.tbody.innerHTML="",this.tbody.appendChild(t.tableBody)})),t}setGroupsCollapseState(e){this.querySpace.collapsedGroups.putValue(e);const t=performance.now();this.groupedRowsBuilder.refreshExpansionState();const n=performance.now();(0,p.cY)(`Group redraw took ${n-t} milliseconds.`)}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",r.i)],WorkPackageTable.prototype,"querySpace",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",l.n)],WorkPackageTable.prototype,"apiV3Service",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",s.D)],WorkPackageTable.prototype,"states",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",o.W)],WorkPackageTable.prototype,"I18n",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",c.V)],WorkPackageTable.prototype,"workPackageViewCollapsedGroupsService",void 0)},28601:(e,t,n)=>{"use strict";n.d(t,{U:()=>WorkPackagesGridComponent});var i=n(68559),o=n(62665),r=n(1257),s=n(33900),a=n(91817),l=n(11048),c=n(21162),p=n(42979),d=n(95445),u=n(60316),h=n(2214),m=n(81067);function WorkPackagesGridComponent_div_1_Template(e,t){if(1&e&&(i.j41(0,"div",2),i.nrm(1,"wp-resizer",3),i.k0s()),2&e){const e=i.XpG();i.R7$(),i.Y8G("elementClass",e.resizerClass)("localStorageKey",e.resizerStorageKey)}}class WorkPackagesGridComponent{constructor(e,t,n,o,r){this.wpTableHighlight=e,this.wpTableSortBy=t,this.wpList=n,this.querySpace=o,this.cdRef=r,this.showResizer=!1,this.resizerClass="",this.resizerStorageKey="",this.selectionChanged=new i.bkB,this.itemClicked=new i.bkB,this.stateLinkClicked=new i.bkB,this.gridOrientation="horizontal",this.highlightingMode="none"}ngOnInit(){this.dragInto=this.configuration.dragAndDropEnabled,this.canDragOutOf=()=>this.configuration.dragAndDropEnabled,this.wpTableHighlight.onReady().then((()=>this.highlightingModeChanged())),this.wpTableHighlight.updates$().pipe((0,s.Q)(this.querySpace.stopAllSubscriptions),(0,a.F)()).subscribe((()=>this.highlightingModeChanged()))}switchToManualSorting(){const e=this.querySpace.query.value;e&&this.wpTableSortBy.switchToManualSorting(e)&&this.wpList.createOrSave(e)}highlightingModeChanged(){this.highlightingMode=this.wpTableHighlight.current.mode,this.cdRef.detectChanges()}static{this.ɵfac=function WorkPackagesGridComponent_Factory(e){return new(e||WorkPackagesGridComponent)(i.rXU(o.I),i.rXU(r.P),i.rXU(d.E),i.rXU(l.i),i.rXU(i.gRc))}}static{this.ɵcmp=i.VBU({type:WorkPackagesGridComponent,selectors:[["wp-grid"]],inputs:{configuration:"configuration",showResizer:"showResizer",resizerClass:"resizerClass",resizerStorageKey:"resizerStorageKey"},outputs:{selectionChanged:"selectionChanged",itemClicked:"itemClicked",stateLinkClicked:"stateLinkClicked"},features:[i.Jv_([c.W,p.H])],decls:2,vars:10,consts:[[3,"onMoved","selectionChanged","itemClicked","stateLinkClicked","dragOutOfHandler","dragInto","cardsRemovable","highlightingMode","showStatusButton","orientation","showEmptyResultsBox","showInfoButton","shrinkOnMobile"],["class","hidden-for-mobile hide-when-print",4,"ngIf"],[1,"hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"]],template:function WorkPackagesGridComponent_Template(e,t){1&e&&(i.j41(0,"wp-card-view",0),i.bIt("onMoved",(function WorkPackagesGridComponent_Template_wp_card_view_onMoved_0_listener(){return t.switchToManualSorting()}))("selectionChanged",(function WorkPackagesGridComponent_Template_wp_card_view_selectionChanged_0_listener(e){return t.selectionChanged.emit(e)}))("itemClicked",(function WorkPackagesGridComponent_Template_wp_card_view_itemClicked_0_listener(e){return t.itemClicked.emit(e)}))("stateLinkClicked",(function WorkPackagesGridComponent_Template_wp_card_view_stateLinkClicked_0_listener(e){return t.stateLinkClicked.emit(e)})),i.k0s(),i.DNE(1,WorkPackagesGridComponent_div_1_Template,2,2,"div",1)),2&e&&(i.Y8G("dragOutOfHandler",t.canDragOutOf)("dragInto",t.dragInto)("cardsRemovable",!1)("highlightingMode",t.highlightingMode)("showStatusButton",!0)("orientation",t.gridOrientation)("showEmptyResultsBox",!0)("showInfoButton",!0)("shrinkOnMobile",!0),i.R7$(),i.Y8G("ngIf",t.showResizer))},dependencies:[u.bT,h.H,m.A],encapsulation:2,changeDetection:0})}}},97975:(e,t,n)=>{"use strict";n.d(t,{Q:()=>WorkPackageInlineCreateComponent});var i=n(68559),o=n(67820),r=n(79),s=n(51567),a=n(11048),l=n(61816),c=n(27871),p=n(19999),d=n(88352),u=n(99496),h=n(44674),m=n(24398),g=n(13432),_=n(29925),f=n(11262),b=n(13036),k=n(1758),v=n(28952),C=n(72407);const y="wp-inline-create-row",w="wp-table--cancel-create-link";class InlineCreateRowBuilder extends C.Kz{constructor(e,t){super(e,t),this.injector=e,this.text={cancelButton:this.I18n.t("js.button_cancel")}}buildCell(e,t){return t.id===b.uD.id?this.buildCancelButton():super.buildCell(e,t)}buildNew(e,t){const[n,i]=this.buildEmpty(e);return[n,i]}createEmptyRow(e){const t=this.classIdentifier(e),n=document.createElement("tr");return n.id=(0,v.un)(e.id),n.dataset.workPackageId=e.id,n.dataset.classIdentifier=t,n.classList.add(y,C.b,C.Wc,"issue",t,`${t}-table`),n}buildCancelButton(){const e=document.createElement("td");return e.classList.add(f.IZ,"wp-table--cancel-create-td"),e.innerHTML=`\n    <a\n       href="#"\n       class="${w} icon icon-cancel"\n       aria-label="${this.text.cancelButton}">\n    </a>\n   `,e}}(0,m.Cg)([(0,k.O)(),(0,m.Sn)("design:type",g.D)],InlineCreateRowBuilder.prototype,"states",void 0),(0,m.Cg)([(0,k.O)(),(0,m.Sn)("design:type",_.a)],InlineCreateRowBuilder.prototype,"wpTableSelection",void 0),(0,m.Cg)([(0,k.O)(),(0,m.Sn)("design:type",d.T)],InlineCreateRowBuilder.prototype,"wpTableColumns",void 0),(0,m.Cg)([(0,k.O)(),(0,m.Sn)("design:type",l.W)],InlineCreateRowBuilder.prototype,"I18n",void 0);var T=n(68267),S=(n(3422),n(26655)),j=n(51339),P=n(60316),I=n(2768),x=n(25827);const R=["wpInlineCreate",""];function WorkPackageInlineCreateComponent_ng_container_0_tr_1_button_2_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",6),i.bIt("click",(function WorkPackageInlineCreateComponent_ng_container_0_tr_1_button_2_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG(3);return i.Njj(t.handleAddRowClick())})),i.nrm(1,"span",7)(2,"span",8),i.k0s()}if(2&e){const e=i.XpG(3);i.AVh("wp-inline-create--split-link",e.hasReferenceClass),i.Y8G("opAutofocus",e.focus),i.BMQ("aria-label",e.text.create),i.R7$(2),i.Y8G("textContent",e.text.create)}}function WorkPackageInlineCreateComponent_ng_container_0_tr_1_button_3_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",9),i.bIt("click",(function WorkPackageInlineCreateComponent_ng_container_0_tr_1_button_3_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG(3);return i.Njj(t.handleReferenceClick())})),i.nrm(1,"span",10)(2,"span",8),i.k0s()}if(2&e){const e=i.XpG(3);i.BMQ("aria-label",e.text.create),i.R7$(2),i.Y8G("textContent",e.text.reference)}}function WorkPackageInlineCreateComponent_ng_container_0_tr_1_Template(e,t){if(1&e&&(i.j41(0,"tr",2)(1,"td",3),i.DNE(2,WorkPackageInlineCreateComponent_ng_container_0_tr_1_button_2_Template,3,5,"button",4)(3,WorkPackageInlineCreateComponent_ng_container_0_tr_1_button_3_Template,3,2,"button",5),i.k0s()()),2&e){const e=i.XpG(2);i.R7$(),i.BMQ("colspan",e.colspan),i.R7$(),i.Y8G("ngIf",e.canAdd),i.R7$(),i.Y8G("ngIf",e.canReference)}}function WorkPackageInlineCreateComponent_ng_container_0_tr_2_ng_container_2_Template(e,t){1&e&&i.eu8(0)}function WorkPackageInlineCreateComponent_ng_container_0_tr_2_Template(e,t){if(1&e&&(i.j41(0,"tr",2)(1,"td",11),i.DNE(2,WorkPackageInlineCreateComponent_ng_container_0_tr_2_ng_container_2_Template,1,0,"ng-container",12),i.k0s()()),2&e){const e=i.XpG(2);i.R7$(),i.BMQ("colspan",e.colspan),i.R7$(),i.Y8G("ngComponentOutlet",e.referenceClass)("ngComponentOutletInjector",e.injector)}}function WorkPackageInlineCreateComponent_ng_container_0_Template(e,t){if(1&e&&(i.qex(0),i.DNE(1,WorkPackageInlineCreateComponent_ng_container_0_tr_1_Template,4,3,"tr",1)(2,WorkPackageInlineCreateComponent_ng_container_0_tr_2_Template,3,3,"tr",1),i.bVm()),2&e){const e=i.XpG();i.R7$(),i.Y8G("ngIf","inactive"===e.mode),i.R7$(),i.Y8G("ngIf",e.hasReferenceClass&&"reference"===e.mode)}}class WorkPackageInlineCreateComponent extends u.p{get isActive(){return"inactive"!==this.mode}constructor(e,t,n,o,r,s,a,l,c,p,d,u){super(),this.injector=e,this.elementRef=t,this.schemaCache=n,this.I18n=o,this.querySpace=r,this.cdRef=s,this.wpCreate=a,this.wpInlineCreate=l,this.wpTableColumns=c,this.wpTableFocus=p,this.halEditing=d,this.authorisationService=u,this.showing=new i.bkB,this.canAdd=!1,this.canReference=!1,this.mode="inactive",this.focus=!1,this.text=this.wpInlineCreate.buttonTexts}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement)}ngAfterViewInit(){(0,p.z)([this.wpInlineCreate.canAdd,this.wpInlineCreate.canReference]).pipe(this.untilDestroyed()).subscribe((([e,t])=>{this.canAdd=e,this.canReference=this.hasReferenceClass&&t,this.cdRef.detectChanges(),this.showing.emit(this.canAdd||this.canReference)})),this.registerCreationCallback(),this.refreshOnColumnChanges(),this.registerCancelHandler()}registerCancelHandler(){this.$element.on("click keydown",`.${w}`,(e=>((0,S.d)(e,(()=>{this.resetRow()})),e.stopImmediatePropagation(),!1)))}refreshOnColumnChanges(){this.wpTableColumns.updates$().pipe((0,s.p)((()=>this.isActive)),this.untilDestroyed()).subscribe((()=>this.refreshRow()))}registerCreationCallback(){this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed()).subscribe((e=>{this.currentWorkPackage&&this.currentWorkPackage.__initialized_at===e.__initialized_at?(this.resetRow(),this.table.configuration.isEmbedded||this.wpTableFocus.updateFocus(e.id),this.wpInlineCreate.newInlineWorkPackageCreated.next(e.id)):(this.wpCreate.cancelCreation(),this.removeWorkPackageRow(),this.showRow()),this.cdRef.detectChanges()}))}handleAddRowClick(){return this.addWorkPackageRow(),!1}handleReferenceClick(){return this.mode="reference",!1}get referenceClass(){return this.wpInlineCreate.referenceComponentClass}get hasReferenceClass(){return!!this.referenceClass}addWorkPackageRow(){this.wpCreate.createOrContinueWorkPackage(this.projectIdentifier).then((e=>{const t=this.currentWorkPackage=e.projectedResource;e.state?.values$().pipe((0,s.p)((()=>!!this.currentWorkPackage))).subscribe((e=>{this.isActive?(this.schemaCache.update(this.currentWorkPackage,e.schema),this.refreshRow()):this.insertRow(t)}))}))}insertRow(e){const t=this.workPackageEditForm=this.renderInlineCreateRow(e);setTimeout((()=>{t.activateMissingFields(),this.hideRow()}))}refreshRow(){const e=new InlineCreateRowBuilder(this.injector,this.table),t=this.$element.find(`.${y}`);t.length&&this.currentWorkPackage&&e.refreshRow(this.currentWorkPackage,t)}renderInlineCreateRow(e){const t=new InlineCreateRowBuilder(this.injector,this.table),n=this.table.editing.startEditing(e,t.classIdentifier(e)),[i]=t.buildNew(e,n);return this.$element.append(i),n}resetRow(){this.focus=!0,this.removeWorkPackageRow(),setTimeout((()=>{this.showRow(),this.cdRef.detectChanges()}),50)}removeWorkPackageRow(){this.wpCreate.cancelCreation(),this.currentWorkPackage=null,this.$element.find(".wp-row-new").remove(),this.editingSubscription&&this.editingSubscription.unsubscribe()}showRow(){this.mode="inactive",this.cdRef.detectChanges()}hideRow(){this.mode="create",this.cdRef.detectChanges()}static{this.ɵfac=function WorkPackageInlineCreateComponent_Factory(e){return new(e||WorkPackageInlineCreateComponent)(i.rXU(i.zZn),i.rXU(i.aKT),i.rXU(h.D),i.rXU(l.W),i.rXU(a.i),i.rXU(i.gRc),i.rXU(T.d),i.rXU(c.O),i.rXU(d.T),i.rXU(r.c),i.rXU(j.p),i.rXU(o._))}}static{this.ɵcmp=i.VBU({type:WorkPackageInlineCreateComponent,selectors:[["","wpInlineCreate",""]],hostBindings:function WorkPackageInlineCreateComponent_HostBindings(e,t){1&e&&i.bIt("keydown.escape",(function WorkPackageInlineCreateComponent_keydown_escape_HostBindingHandler(){return t.resetRow()}))},inputs:{colspan:"colspan",table:"table",projectIdentifier:"projectIdentifier"},outputs:{showing:"showing"},features:[i.Vt3],attrs:R,decls:1,vars:1,consts:[[4,"ngIf"],["class","wp-inline-create-button-row hide-when-print",4,"ngIf"],[1,"wp-inline-create-button-row","hide-when-print"],[1,"wp-inline-create-button-td"],["type","button","class","spot-link","aria-haspopup","true","data-test-selector","op-wp-inline-create",3,"wp-inline-create--split-link","opAutofocus","click",4,"ngIf"],["type","button","class","spot-link wp-inline-create--split-link","aria-haspopup","true","data-test-selector","op-wp-inline-create-reference",3,"click",4,"ngIf"],["type","button","aria-haspopup","true","data-test-selector","op-wp-inline-create",1,"spot-link",3,"click","opAutofocus"],[1,"spot-icon","spot-icon_add"],[3,"textContent"],["type","button","aria-haspopup","true","data-test-selector","op-wp-inline-create-reference",1,"spot-link","wp-inline-create--split-link",3,"click"],[1,"spot-icon","spot-icon_link"],[1,"wp-inline-reference-row-td","-no-highlighting"],[4,"ngComponentOutlet","ngComponentOutletInjector"]],template:function WorkPackageInlineCreateComponent_Template(e,t){1&e&&i.DNE(0,WorkPackageInlineCreateComponent_ng_container_0_Template,3,2,"ng-container",0),2&e&&i.Y8G("ngIf",t.canAdd||t.canReference)},dependencies:[P.OI,P.bT,I.B,x.ar],encapsulation:2})}}},27871:(e,t,n)=>{"use strict";n.d(t,{O:()=>WorkPackageInlineCreateService});var i=n(24398),o=n(84205),r=n(59452),s=n(61816),a=n(1758),l=n(63894),c=n(86866),p=n(68559);class WorkPackageInlineCreateService{constructor(e){this.injector=e,this.referenceComponentClass=null,this.referenceTarget=null,this.buttonTexts={reference:"",create:this.I18n.t("js.label_create_work_package")},this.newInlineWorkPackageCreated=new o.B,this.newInlineWorkPackageReferenced=new o.B}get canAdd(){return this.canCreateWorkPackages()}get canReference(){return(0,r.of)(!1)}canCreateWorkPackages(e=this.currentProject.id){return this.currentUser.hasCapabilities$(["work_packages/create","work_packages/update"],e||null)}ngOnDestroy(){this.newInlineWorkPackageCreated.complete(),this.newInlineWorkPackageReferenced.complete()}static{this.ɵfac=function WorkPackageInlineCreateService_Factory(e){return new(e||WorkPackageInlineCreateService)(p.KVO(p.zZn))}}static{this.ɵprov=p.jDH({token:WorkPackageInlineCreateService,factory:WorkPackageInlineCreateService.ɵfac})}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",s.W)],WorkPackageInlineCreateService.prototype,"I18n",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",l.K)],WorkPackageInlineCreateService.prototype,"currentUser",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",c.c)],WorkPackageInlineCreateService.prototype,"currentProject",void 0)},44663:(e,t,n)=>{"use strict";n.d(t,{T:()=>WorkPackagesListChecksumService});var i=n(83093),o=n(85247),r=n(68559);class WorkPackagesListChecksumService{constructor(e,t){this.UrlParamsHelper=e,this.$state=t}updateIfDifferent(e,t){const n=this.getNewChecksum(e,t);let i=Promise.resolve();return this.isUninitialized()||(this.isIdDifferent(e.id)?(i=this.maintainUrlQueryState(e.id,null),this.clear()):this.isChecksumDifferent(n)&&(i=this.maintainUrlQueryState(e.id,n))),this.set(e.id,n),i}update(e,t){const n=this.getNewChecksum(e,t);this.set(e.id,n),this.maintainUrlQueryState(e.id,n)}setToQuery(e,t){const n=this.getNewChecksum(e,t);return this.set(e.id,n),this.maintainUrlQueryState(e.id,null)}isQueryOutdated(e,t){const n=this.getNewChecksum(e,t);return this.isOutdated(e.id,n)}executeIfOutdated(e,t,n){(this.isUninitialized()||this.isOutdated(e,t))&&(this.set(e,t),n())}set(e,t){this.id=e,this.checksum=t}clear(){this.id=null,this.checksum=null,this.visibleChecksum=null}isUninitialized(){return!this.id&&!this.checksum}isIdDifferent(e){return this.id!==e}isChecksumDifferent(e){return this.checksum&&e!==this.checksum}isOutdated(e,t){const n=!!this.id,i=!!this.checksum,o=this.id!==e,r=t!==this.checksum,s=this.checksum&&!t&&this.visibleChecksum;return(n||i)&&(o||!o&&r&&(t||this.visibleChecksum)||!n&&s)}getNewChecksum(e,t){return this.UrlParamsHelper.encodeQueryJsonParams(e,{pp:t.perPage,pa:t.page})}maintainUrlQueryState(e,t){return this.visibleChecksum=t,this.$state.go(".",{query_props:t,query_id:e},{custom:{notify:!1}})}static{this.ɵfac=function WorkPackagesListChecksumService_Factory(e){return new(e||WorkPackagesListChecksumService)(r.KVO(o.j),r.KVO(i.dw))}}static{this.ɵprov=r.jDH({token:WorkPackagesListChecksumService,factory:WorkPackagesListChecksumService.ɵfac})}}},40710:(e,t,n)=>{"use strict";n.d(t,{x:()=>WorkPackagesListInvalidQueryService});var i=n(36178),o=n(68559);class WorkPackagesListInvalidQueryService{constructor(e){this.halResourceService=e}restoreQuery(e,t){this.restoreFilters(e,t.payload,t.schema),this.restoreColumns(e,t.payload,t.schema),this.restoreSortBy(e,t.payload,t.schema),this.restoreGroupBy(e,t.payload,t.schema),this.restoreOtherProperties(e,t.payload)}restoreFilters(e,t,n){let i=_.map(t.filters,(e=>{const t=_.find(n.filtersSchemas.elements,(t=>t.filter.allowedValues[0].href===e.filter.href));if(!t)return null;const i=t.getFilter(),o=_.find(t.operator.allowedValues,(t=>t.href===e.operator.href));return o&&(i.operator=o),i.values.length=0,_.each(e.values,(e=>i.values.push(e))),i}));i=_.compact(i),e.filters.length=0,_.each(i,(t=>e.filters.push(t)))}restoreColumns(e,t,n){let i=_.map(t.columns,(e=>_.find(n.columns.allowedValues,(t=>t.href===e.href))));i=_.compact(i),e.columns.length=0,_.each(i,(t=>e.columns.push(t)))}restoreSortBy(e,t,n){let i=_.map(t.sortBy,(e=>_.find(n.sortBy.allowedValues,(t=>t.href===e.href))));i=_.compact(i),e.sortBy.length=0,_.each(i,(t=>e.sortBy.push(t)))}restoreGroupBy(e,t,n){const i=_.find(n.groupBy.allowedValues,(e=>t.groupBy&&t.groupBy.href===e.href));e.groupBy=i}restoreOtherProperties(e,t){_.without(Object.keys(t.$source),"_links","filters").forEach((n=>{e[n]=t[n]})),_.without(Object.keys(t.$source._links),"columns","groupBy","sortBy").forEach((n=>{e[n]=t[n]}))}static{this.ɵfac=function WorkPackagesListInvalidQueryService_Factory(e){return new(e||WorkPackagesListInvalidQueryService)(o.KVO(i.t))}}static{this.ɵprov=o.jDH({token:WorkPackagesListInvalidQueryService,factory:WorkPackagesListInvalidQueryService.ɵfac})}}},95445:(e,t,n)=>{"use strict";n.d(t,{E:()=>WorkPackagesListService});var i=n(89204),o=n(24398),r=n(13432),s=n(67820),a=n(83093),l=n(11048),c=n(1758),p=n(32147),d=n(85247),u=n(72650),h=n(61816),m=n(59452),g=n(14600),_=n(56196),f=n(47418),b=n(36647),k=n(1365),v=n(71870),C=n(61318),y=n(64334),w=n(87378),T=n(49989),S=n(72688),j=n(63894),P=n(14593),I=n(81965),x=n(28702),R=n(40710),F=n(17547),M=n(99700),O=n(68559);class WorkPackagesListService{constructor(e,t,n,i,o,r,s,a,l,c,p,d,u,h,g,_){this.injector=e,this.toastService=t,this.I18n=n,this.UrlParamsHelper=i,this.authorisationService=o,this.$state=r,this.apiV3Service=s,this.states=a,this.querySpace=l,this.pagination=c,this.configuration=p,this.wpTablePagination=d,this.wpStatesInitialization=u,this.wpListInvalidQueryService=h,this.wpQueryView=g,this.submenuService=_,this.queryRequests=(0,f.hF)(),this.queryLoading=this.queryRequests.values$().pipe((0,b.n)((e=>this.streamQueryRequest(e.queryParams,e.projectIdentifier))),(0,k.Z)((e=>(this.conditionallyLoadForm(e),this.wpStatesInitialization.initialize(e,e.results),(0,m.of)(e)))),(0,v.u)())}streamQueryRequest(e,t){const n=this.getCurrentQueryProps(e),i=this.UrlParamsHelper.buildV3GetQueryFromJsonParams(n);return this.apiV3Service.queries.find(i,e.query_id,t).pipe((0,C.W)((i=>{const o=this.UrlParamsHelper.buildV3GetQueryFromJsonParams(n);return(0,g.H)(this.handleQueryLoadingError(i,o,e.query_id,t))})))}fromQueryParams(e,t){return this.queryRequests.clear(),this.queryRequests.putValue({queryParams:e,projectIdentifier:t}),this.queryLoading.pipe((0,y.s)(1))}getCurrentQueryProps(e){return e.query_props?decodeURIComponent(e.query_props):null}loadDefaultQuery(e){return(0,_._)(this.fromQueryParams({},e))}reloadQuery(e,t){const n=this.extractParamsFromQuery(e,{pa:1});return this.queryRequests.clear(),this.queryRequests.putValue({queryParams:{query_id:e.id||void 0,query_props:n},projectIdentifier:t}),this.queryLoading.pipe((0,y.s)(1))}extractParamsFromQuery(e,t={}){return this.UrlParamsHelper.encodeQueryJsonParams(e,{pa:this.wpTablePagination.current.page,pp:this.wpTablePagination.current.perPage,...t})}loadQueryFromExisting(e,t,n){const i=this.UrlParamsHelper.buildV3GetQueryFromQueryResource(e,t);let o;return o=e.id?this.apiV3Service.queries.id(e.id):this.apiV3Service.withOptionalProject(n).queries,o.parameterised(i)}loadCurrentQueryFromParams(e){return(0,_._)(this.fromQueryParams(this.$state.params,e))}loadForm(e){return(0,_._)(this.apiV3Service.queries.form.load(e)).then((([t,n])=>(this.wpStatesInitialization.updateStatesFromForm(e,t),t)))}create(e,t){const n=this.querySpace.queryForm.value;e.name=t;return(0,_._)(this.createQueryAndView(e,n)).then((e=>(this.toastService.addSuccess(this.I18n.t("js.notice_successful_create")),this.reloadQuery(e).subscribe((()=>{this.states.changes.queries.next(e.id),this.reloadSidemenu(e.id)})),e)))}delete(){const e=this.currentQuery,t=this.apiV3Service.queries.id(e).delete().toPromise();return t.then((()=>{this.toastService.addSuccess(this.I18n.t("js.notice_successful_delete")),this.navigateToDefaultQuery(e)})),t}save(e){var t=this;return(0,i.A)((function*(){const n=e||t.currentQuery,i=yield t.querySpace.queryForm.valuesPromise(),o=t.apiV3Service.queries.id(n).patch(n,i).toPromise();return o.then((()=>{t.toastService.addSuccess(t.I18n.t("js.notice_successful_update"));n.public||n.user.id===t.currentUser.userId?(t.$state.go(".",{query_id:n.id,query_props:null},{reload:!0}),t.states.changes.queries.next(n.id),t.reloadSidemenu(n.id)):t.navigateToDefaultQuery(n)})).catch((e=>{t.toastService.addError(e.message)})),o}))()}createOrSave(e){var t=this;return(0,i.A)((function*(){return(0,p.A)(e)?t.save(e):t.create(e,t.I18n.t("js.work_packages.default_queries.manually_sorted"))}))()}toggleStarred(e){const t=this.apiV3Service.queries.toggleStarred(e);return t.then((e=>{this.querySpace.query.putValue(e),this.toastService.addSuccess(this.I18n.t("js.notice_successful_update")),this.states.changes.queries.next(e.id),this.reloadSidemenu(e.id)})),t}getPaginationInfo(){return this.wpTablePagination.paginationObject}conditionallyLoadForm(e=this.currentQuery){const t=this.querySpace.queryForm.value;return e?t&&e.$links.update&&e.$links.update.href===t.href?Promise.resolve(t):this.loadForm(e):(0,_._)(this.queryLoading).then((e=>this.conditionallyLoadForm(e)))}get currentQuery(){return this.querySpace.query.value}handleQueryLoadingError(e,t,n,i){return this.toastService.addError(this.I18n.t("js.work_packages.faulty_query.description"),e.message),new Promise(((e,o)=>{(0,_._)(this.apiV3Service.queries.form.loadWithParams(t,n,i)).then((([r,s])=>{this.apiV3Service.queries.find({pageSize:0},void 0,i).toPromise().then((i=>{this.wpListInvalidQueryService.restoreQuery(i,r),i.results.pageSize=t.pageSize,i.results.total=0,n&&(i.id=n),this.wpStatesInitialization.initialize(i,i.results),this.wpStatesInitialization.updateStatesFromForm(i,r),e(i)})).catch(o)})).catch(o)}))}createQueryAndView(e,t){return this.apiV3Service.queries.post(e,t).pipe((0,b.n)((e=>this.wpQueryView.create(e).pipe((0,w.u)(e)))))}navigateToDefaultQuery(e){const t=this.$state.$current.data?.sideMenuOptions,n=t?.hardReloadOnBaseRoute;if(n){const e=new URL(window.location.href),n=t.defaultQuery;n&&(e.pathname=e.pathname.replace(/\d+$/,n)),e.search="",window.location.href=e.href}else{let t;e.project.href&&(t=e.project.href.split("/").pop()),this.loadDefaultQuery(t),this.states.changes.queries.next(e.id),this.reloadSidemenu(null)}}reloadSidemenu(e){this.submenuService.reloadSubmenu(e)}static{this.ɵfac=function WorkPackagesListService_Factory(e){return new(e||WorkPackagesListService)(O.KVO(O.zZn),O.KVO(u.fw),O.KVO(h.W),O.KVO(d.j),O.KVO(s._),O.KVO(a.dw),O.KVO(P.n),O.KVO(r.D),O.KVO(l.i),O.KVO(I.m),O.KVO(S.s),O.KVO(T.I),O.KVO(x.V),O.KVO(R.x),O.KVO(F.H),O.KVO(M.Z))}}static{this.ɵprov=O.jDH({token:WorkPackagesListService,factory:WorkPackagesListService.ɵfac})}}(0,o.Cg)([(0,c.O)(),(0,o.Sn)("design:type",j.K)],WorkPackagesListService.prototype,"currentUser",void 0)},17547:(e,t,n)=>{"use strict";n.d(t,{H:()=>WorkPackagesQueryViewService});var i=n(83093),o=n(14593),r=n(68559);class WorkPackagesQueryViewService{constructor(e,t){this.$state=e,this.apiV3Service=t}create(e){if(!e.href)throw new Error("Expected only queries that are created since an href is required");return this.apiV3Service.views.post({_links:{query:{href:e.href}}},this.viewType)}get viewType(){if(this.$state.includes("work-packages"))return"work_packages_table";if(this.$state.includes("team_planner"))return"team_planner";if(this.$state.includes("bim"))return"bim";if(this.$state.includes("calendar"))return"work_packages_calendar";if(this.$state.includes("gantt"))return"gantt";throw new Error("Not on a path defined for query views")}static{this.ɵfac=function WorkPackagesQueryViewService_Factory(e){return new(e||WorkPackagesQueryViewService)(r.KVO(i.dw),r.KVO(o.n))}}static{this.ɵprov=r.jDH({token:WorkPackagesQueryViewService,factory:WorkPackagesQueryViewService.ɵfac})}}},28702:(e,t,n)=>{"use strict";n.d(t,{V:()=>WorkPackageStatesInitializationService});var i=n(13432),o=n(67820),r=n(11048),s=n(62665),a=n(64334),l=n(51524),c=n(74573),p=n(80406),d=n(55332),u=n(88352),h=n(1257),m=n(44770),g=n(94450),f=n(49989),b=n(68222),k=n(1750),v=n(34120),C=n(98755),y=n(14593),w=n(59769),T=n(44663),S=n(58154),j=n(68559);class WorkPackageStatesInitializationService{constructor(e,t,n,i,o,r,s,a,l,c,p,d,u,h,m,g,_,f,b,k,v){this.states=e,this.querySpace=t,this.wpTableColumns=n,this.wpTableGroupBy=i,this.wpTableGroupFold=o,this.wpTableSortBy=r,this.wpTableFilters=s,this.wpTableSum=a,this.wpTableTimeline=l,this.wpTableHierarchies=c,this.wpTableHighlighting=p,this.wpTableRelationColumns=d,this.wpTablePagination=u,this.wpTableOrder=h,this.wpTableAdditionalElements=m,this.apiV3Service=g,this.wpListChecksumService=_,this.authorisationService=f,this.wpDisplayRepresentation=b,this.wpIncludeSubprojects=k,this.wpTimestamps=v}initialize(e,t){this.clearStates(),this.querySpace.query.putValue(e),this.initializeFromQuery(e,t);const n=this.querySpace.queryForm.value;n&&this.updateStatesFromForm(e,n),this.updateQuerySpace(e,t),this.updateChecksum(e,t)}updateStatesFromForm(e,t){const n=t.schema;_.each(n.filtersSchemas.elements,(e=>{this.states.schemas.get(e.href).putValue(e)})),this.wpTableFilters.initializeFilters(e,n),this.querySpace.queryForm.putValue(t),this.querySpace.available.columns.putValue(n.columns.allowedValues),this.querySpace.available.sortBy.putValue(n.sortBy.allowedValues),this.querySpace.available.groupBy.putValue(n.groupBy.allowedValues),this.querySpace.available.displayRepresentation.putValue(n.displayRepresentation.allowedValues)}updateQuerySpace(e,t){this.querySpace.additionalRequiredWorkPackages.clear("Clearing additional WPs before updating rows"),this.querySpace.tableRendered.clear("Clearing rendered data before upgrading query space"),t.schemas&&_.each(t.schemas.elements,(e=>{this.states.schemas.get(e.href).putValue(e)})),this.querySpace.query.putValue(e),this.authorisationService.initModelAuth("work_packages",t.$links),t.elements.forEach((e=>this.apiV3Service.work_packages.cache.updateWorkPackage(e,!0))),this.querySpace.results.putValue(t),this.querySpace.groups.putValue(t.groups),this.wpTablePagination.initialize(e,t),this.wpTableRelationColumns.initialize(e,t),this.wpTableAdditionalElements.initialize(e,t),this.wpTableOrder.initialize(e,t),this.wpDisplayRepresentation.initialize(e,t),this.wpIncludeSubprojects.initialize(e,t),this.wpTimestamps.initialize(e,t),this.querySpace.additionalRequiredWorkPackages.values$().pipe((0,a.s)(1)).subscribe((()=>this.querySpace.initialized.putValue(null)))}updateChecksum(e,t){this.wpListChecksumService.updateIfDifferent(this.querySpace.query.value,this.wpTablePagination.current),this.authorisationService.initModelAuth("work_packages",t.$links)}initializeFromQuery(e,t){this.querySpace.query.putValue(e),this.wpTableSum.initialize(e),this.wpTableColumns.initialize(e,t),this.wpTableSortBy.initialize(e,t),this.wpTableGroupBy.initialize(e,t),this.wpTableGroupFold.initialize(e,t),this.wpTableTimeline.initialize(e,t),this.wpTableHierarchies.initialize(e,t),this.wpTableHighlighting.initialize(e,t),this.wpDisplayRepresentation.initialize(e,t),this.wpIncludeSubprojects.initialize(e,t),this.authorisationService.initModelAuth("query",e.$links),this.authorisationService.initModelAuth("work_packages",t.$links)}applyToQuery(e){this.wpTableFilters.applyToQuery(e),this.wpTableSum.applyToQuery(e),this.wpTableColumns.applyToQuery(e),this.wpTableSortBy.applyToQuery(e),this.wpTableGroupBy.applyToQuery(e),this.wpTableGroupFold.applyToQuery(e),this.wpTableTimeline.applyToQuery(e),this.wpTableHighlighting.applyToQuery(e),this.wpTableHierarchies.applyToQuery(e),this.wpTableOrder.applyToQuery(e),this.wpDisplayRepresentation.applyToQuery(e),this.wpIncludeSubprojects.applyToQuery(e)}clearStates(){const e="Clearing states before re-initialization.";this.querySpace.initialized.clear(e),this.querySpace.query.clear(e),this.querySpace.results.clear(e),this.querySpace.groups.clear(e),this.querySpace.additionalRequiredWorkPackages.clear(e),this.wpTableFilters.clear(e),this.wpTableColumns.clear(e),this.wpTableSortBy.clear(e),this.wpTableGroupBy.clear(e),this.wpTableGroupFold.clear(e),this.wpDisplayRepresentation.clear(e),this.wpIncludeSubprojects.clear(e),this.wpTableSum.clear(e),this.querySpace.tableRendered.clear(e)}static{this.ɵfac=function WorkPackageStatesInitializationService_Factory(e){return new(e||WorkPackageStatesInitializationService)(j.KVO(i.D),j.KVO(r.i),j.KVO(u.T),j.KVO(k.W),j.KVO(w.V),j.KVO(h.P),j.KVO(v.N),j.KVO(d.X),j.KVO(b.X),j.KVO(g.j),j.KVO(s.I),j.KVO(C.f),j.KVO(f.I),j.KVO(l.k),j.KVO(m.e),j.KVO(y.n),j.KVO(T.T),j.KVO(o._),j.KVO(c.dd),j.KVO(p.G),j.KVO(S.b1))}}static{this.ɵprov=j.jDH({token:WorkPackageStatesInitializationService,factory:WorkPackageStatesInitializationService.ɵfac})}}},29523:(e,t,n)=>{"use strict";n.d(t,{D:()=>WorkPackageCreateComponent});var i=n(83093),o=n(73014),r=n(13432),s=n(11249),a=n(61816),l=n(34120),c=n(79),p=n(34539),d=n(49349),u=n(45261),h=n(99496),m=n(69728),g=n(14593),_=n(48707),f=n(68267),b=n(16169),k=n(12313),v=n(68559);class WorkPackageCreateComponent extends h.p{constructor(e,t,n,i,o,r,s,a,l,c,p,d,u){super(),this.injector=e,this.$transition=t,this.$state=n,this.I18n=i,this.titleService=o,this.notificationService=r,this.states=s,this.wpCreate=a,this.wpViewFocus=l,this.wpTableFilters=c,this.pathHelper=p,this.apiV3Service=d,this.cdRef=u,this.successState=(0,m.N)(this.$state),this.cancelState=this.$state.current.data.baseRoute,this.copying=!1,this.stateParams=this.$transition.params("to"),this.text={button_settings:this.I18n.t("js.button_settings")},this.destroyed=!1}ngOnInit(){this.closeEditFormWhenNewWorkPackageSaved(),this.showForm()}ngOnDestroy(){super.ngOnDestroy()}switchToFullscreen(){const e=(0,k.A)(this.change.value("type")?.href);this.$state.go("work-packages.new",{...this.$state.params,type:e})}onSaved(e){const{savedResource:t,isInitial:n}=e;this.editForm?.cancel(!1),this.successState&&this.$state.go(this.successState,{workPackageId:t.id}).then((()=>{this.wpViewFocus.updateFocus(t.id),this.notificationService.showSave(t,n)}))}showForm(){this.createdWorkPackage().then((e=>{this.change=e,this.newWorkPackage=e.pristineResource,this.cdRef.detectChanges(),this.setTitle(),this.stateParams.parent_id&&e.setValue("parent",{href:this.apiV3Service.work_packages.id(this.stateParams.parent_id).path}),this.stateParams.parent_id&&this.apiV3Service.work_packages.id(this.stateParams.parent_id).get().pipe(this.untilDestroyed()).subscribe((e=>{this.parentWorkPackage=e,this.cdRef.detectChanges()}))})).catch((e=>{e instanceof b.i&&"urn:openproject-org:api:v3:errors:MissingPermission"===e.errorIdentifier&&(this.apiV3Service.root.get().subscribe((e=>{if(!e.user){const e=u(this.pathHelper.loginPath());e.search({back_url:e}),window.location.href=e.toString()}})),this.notificationService.handleRawError(e))}))}setTitle(){this.titleService.setFirstPart(this.I18n.t("js.work_packages.create.title"))}cancelAndBackToList(){this.wpCreate.cancelCreation(),this.$state.go(this.cancelState,this.$state.params)}createdWorkPackage(){const e=this.stateParams.defaults||{};e._links=e._links||{};const t=this.stateParams.type?parseInt(this.stateParams.type):void 0,n=this.stateParams.parent_id?parseInt(this.stateParams.parent_id):void 0,i=this.stateParams.projectPath;return t&&(e._links.type={href:this.apiV3Service.types.id(t).path}),n&&(e._links.parent={href:this.apiV3Service.work_packages.id(n).path}),this.wpCreate.createOrContinueWorkPackage(i,t,e)}closeEditFormWhenNewWorkPackageSaved(){this.wpCreate.onNewWorkPackage().pipe((0,s.v)((()=>!this.componentDestroyed))).subscribe((e=>{this.onSaved({savedResource:e,isInitial:!0})}))}static{this.ɵfac=function WorkPackageCreateComponent_Factory(e){return new(e||WorkPackageCreateComponent)(v.rXU(v.zZn),v.rXU(i.eB),v.rXU(i.dw),v.rXU(a.W),v.rXU(_.P),v.rXU(d.U),v.rXU(r.D),v.rXU(f.d),v.rXU(c.c),v.rXU(l.N),v.rXU(o.B),v.rXU(g.n),v.rXU(v.gRc))}}static{this.ɵdir=v.FsC({type:WorkPackageCreateComponent,viewQuery:function WorkPackageCreateComponent_Query(e,t){if(1&e&&v.GBs(p.G,5),2&e){let e;v.mGM(e=v.lsd())&&(t.editForm=e.first)}},features:[v.Vt3]})}}},68267:(e,t,n)=>{"use strict";n.d(t,{d:()=>WorkPackageCreateService});var i=n(84205),o=n(56196),r=n(65046),s=n(83145),a=n(51339),l=n(51567),c=n(11048),p=n(91691),d=n(67820),u=n(99496),h=n(14593),m=n(27514),g=n(12313),f=n(44674),b=n(36178),k=n(73962),v=n(68559);const C="/api/v3/work_packages/new";class WorkPackageCreateService extends u.p{constructor(e,t,n,o,r,s,a,c,p,d){super(),this.injector=e,this.hooks=t,this.apiV3Service=n,this.halResourceService=o,this.querySpace=r,this.authorisationService=s,this.halEditing=a,this.schemaCache=c,this.halEvents=p,this.attachmentsService=d,this.newWorkPackageCreatedSubject=new i.B,this.halEditing.committedChanges.pipe(this.untilDestroyed(),(0,l.p)((e=>"WorkPackage"===e.resource._type&&e.wasNew))).subscribe((e=>{this.newWorkPackageCreated(e.resource)})),this.halEditing.changes$(C).pipe(this.untilDestroyed(),(0,l.p)((e=>!e))).subscribe((()=>{this.reset()}))}newWorkPackageCreated(e){this.reset(),this.newWorkPackageCreatedSubject.next(e)}onNewWorkPackage(){return this.newWorkPackageCreatedSubject.asObservable()}createNewWorkPackage(e,t){return this.apiV3Service.withOptionalProject(e).work_packages.form.forPayload(t).toPromise().then((e=>this.fromCreateForm(e)))}fromCreateForm(e){const t=this.initializeNewResource(e),n=this.halEditing.edit(t,e);return this.hooks.call("workPackageNewInitialization",n),n}copyWorkPackage(e){const t=e.pristineResource.$source;return this.apiV3Service.work_packages.form.post(t).toPromise().then((e=>this.fromCreateForm(e)))}copyFrom(e){const t=this.initializeNewResource(e);return this.halEditing.edit(t,e)}getEmptyForm(e){return this.form||(this.form=(0,o._)(this.apiV3Service.withOptionalProject(e).work_packages.form.post({}))),this.form}cancelCreation(){this.halEditing.stopEditing({href:C}),this.reset()}changesetUpdates$(){return this.halEditing.state(C).values$()}createOrContinueWorkPackage(e,t,n){let i=this.continueExistingEdit(t);return i||(i=this.createNewWithDefaults(e,n)),i.then((e=>(this.authorisationService.initModelAuth("work_package",e.pristineResource),this.halEditing.updateValue(C,e),this.apiV3Service.work_packages.cache.updateWorkPackage(e.pristineResource,!0),e)))}reset(){this.apiV3Service.work_packages.cache.clearSome("new"),this.attachmentsService.clear("new"),this.form=void 0}continueExistingEdit(e){const t=this.halEditing.state(C).value;if(void 0!==t){const n=t.projectedResource.type,i=!t.isEmpty(),o=!n&&!e,r=e&&n&&(0,g.A)(n.href)===e.toString();if(i&&(o||r))return Promise.resolve(t)}return null}createNewWithDefaults(e,t){return this.withFiltersPayload(e,t).then((n=>{const i=_.merge({_links:{}},n,t);return this.createNewWorkPackage(e,i).then((e=>{if(!e)throw new Error("No new work package was created");return this.defaultsFromFilters(e,t,(e=>null===/customField\d+/.exec(e))),e}))}))}defaultsFromFilters(e,t,n){const i=this.querySpace.query.value;if(i){let o=t?._links?Object.keys(t._links):[];void 0!==n&&(o=o.concat(i.filters.map((e=>e.id)).filter(n))),new s.Y(this.injector,i.filters,o).applyDefaultsFromFilters(e)}}withFiltersPayload(e,t){const n={_links:{}};this.defaultsFromFilters(n,t);return Object.keys(n).length>1||Object.keys(n._links).length>0?this.apiV3Service.withOptionalProject(e).work_packages.form.forTypePayload(t||{_links:{}}).toPromise().then((e=>(this.toApiPayload(n,e.schema),n))):Promise.resolve(n)}toApiPayload(e,t){const n=[];Object.keys(t.$source).forEach((e=>{["Integer","Float","Date","DateTime","Duration","Formattable","Boolean","String","Text",void 0].includes(t.$source[e].type)||n.push(e)})),n.forEach((t=>{const n=e[t];void 0===n||(n instanceof m.q?e._links[t]={href:n.$links.self.href}:e._links[t]=n||{href:null}),delete e[t]}))}initializeNewResource(e){const t=e.payload.$plain();t._links.schema={href:"new"};const n=this.halResourceService.createHalResourceOfType("WorkPackage",t);return n.$source.id="new",n._type="WorkPackage",n.__initialized_at=Date.now(),n.update=n.$links.update=e.$links.self,n.updateImmediately=e=>(0,o._)(this.apiV3Service.work_packages.post(e)),n.$links.updateImmediately=e=>(0,o._)(this.apiV3Service.work_packages.post(e)),e.schema.$links.attachments&&(n.$links.attachments={elements:[]}),this.schemaCache.update(n,e.schema),n}static{this.ɵfac=function WorkPackageCreateService_Factory(e){return new(e||WorkPackageCreateService)(v.KVO(v.zZn),v.KVO(r.R),v.KVO(h.n),v.KVO(b.t),v.KVO(c.i),v.KVO(d._),v.KVO(a.p),v.KVO(f.D),v.KVO(p.o),v.KVO(k._))}}static{this.ɵprov=v.jDH({token:WorkPackageCreateService,factory:WorkPackageCreateService.ɵfac})}}},81859:(e,t,n)=>{"use strict";n.d(t,{N:()=>WorkPackageNewFullViewComponent});var i=n(29523),o=n(68559),r=n(60316),s=n(58397),a=n(34539),l=n(46337),c=n(82711),p=n(99274),d=n(68899);const _c0=()=>["status","type"];function WorkPackageNewFullViewComponent_div_0_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",1)(1,"edit-form",2),o.bIt("onSaved",(function WorkPackageNewFullViewComponent_div_0_Template_edit_form_onSaved_1_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.onSaved(t))})),o.j41(2,"div",3)(3,"div",4),o.nrm(4,"wp-type-status",5),o.k0s(),o.j41(5,"ul",6)(6,"li",7),o.nrm(7,"opce-zen-mode-toggle-button"),o.k0s(),o.j41(8,"li",7)(9,"button",8),o.nrm(10,"i",9),o.k0s()()()(),o.nrm(11,"wp-single-view",10),o.j41(12,"wp-edit-actions-bar",11),o.bIt("onCancel",(function WorkPackageNewFullViewComponent_div_0_Template_wp_edit_actions_bar_onCancel_12_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.cancelAndBackToList())})),o.k0s()()()}if(2&e){const e=o.XpG();o.R7$(),o.Y8G("resource",e.newWorkPackage)("skippedFields",o.lJ4(7,_c0))("inEditMode",!0),o.R7$(3),o.Y8G("workPackage",e.newWorkPackage),o.R7$(5),o.BMQ("title",e.text.button_settings),o.R7$(2),o.Y8G("workPackage",e.newWorkPackage)("showProject",e.copying)}}class WorkPackageNewFullViewComponent extends i.D{constructor(){super(...arguments),this.successState=this.$state.current.data.successState}static{this.ɵfac=(()=>{let e;return function WorkPackageNewFullViewComponent_Factory(t){return(e||(e=o.xGo(WorkPackageNewFullViewComponent)))(t||WorkPackageNewFullViewComponent)}})()}static{this.ɵcmp=o.VBU({type:WorkPackageNewFullViewComponent,selectors:[["wp-new-full-view"]],hostAttrs:[1,"work-packages-page--ui-view"],features:[o.Vt3],decls:1,vars:1,consts:[["class","work-package--new-state work-packages--new work-packages--show-view toolbar-container",4,"ngIf"],[1,"work-package--new-state","work-packages--new","work-packages--show-view","toolbar-container"],[3,"onSaved","resource","skippedFields","inEditMode"],[1,"toolbar"],[1,"title-container"],[3,"workPackage"],[1,"toolbar-items","hide-when-print"],[1,"toolbar-item","hidden-for-tablet"],["id","create-wp-menu-button","wpCreateSettingsMenu","",1,"button","last","work-packages-settings-button","toolbar-icon"],[1,"button--icon","icon-show-more"],[3,"workPackage","showProject"],[3,"onCancel"]],template:function WorkPackageNewFullViewComponent_Template(e,t){1&e&&o.DNE(0,WorkPackageNewFullViewComponent_div_0_Template,13,8,"div",0),2&e&&o.Y8G("ngIf",t.newWorkPackage)},dependencies:[r.bT,s.y,a.G,l.j,c.l,p.J,d.k],encapsulation:2,changeDetection:0})}}},51472:(e,t,n)=>{"use strict";n.d(t,{O:()=>WorkPackageNewSplitViewComponent});var i=n(29523),o=n(68559),r=n(60316),s=n(34539),a=n(46337),l=n(82711),c=n(2214),p=n(68899);const _c0=()=>["status","type"];function WorkPackageNewSplitViewComponent_div_0_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",1)(1,"edit-form",2),o.bIt("onSaved",(function WorkPackageNewSplitViewComponent_div_0_Template_edit_form_onSaved_1_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.onSaved(t))})),o.j41(2,"div",3)(3,"div",4),o.nrm(4,"wp-type-status",5),o.j41(5,"div",6)(6,"a",7),o.bIt("click",(function WorkPackageNewSplitViewComponent_div_0_Template_a_click_6_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.switchToFullscreen())})),o.nrm(7,"span",8),o.k0s()()(),o.nrm(8,"wp-single-view",9),o.k0s(),o.j41(9,"div",10)(10,"wp-edit-actions-bar",11),o.bIt("onCancel",(function WorkPackageNewSplitViewComponent_div_0_Template_wp_edit_actions_bar_onCancel_10_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.cancelAndBackToList())})),o.k0s()(),o.j41(11,"div",12),o.nrm(12,"wp-resizer",13),o.k0s()()()}if(2&e){const e=o.XpG();o.R7$(),o.Y8G("resource",e.newWorkPackage)("skippedFields",o.lJ4(8,_c0))("inEditMode",!0),o.R7$(3),o.Y8G("workPackage",e.newWorkPackage),o.R7$(4),o.Y8G("workPackage",e.newWorkPackage)("showProject",e.copying),o.R7$(4),o.Y8G("elementClass","work-packages-partitioned-page--content-right")("localStorageKey","openProject-splitViewFlexBasis")}}class WorkPackageNewSplitViewComponent extends i.D{static{this.ɵfac=(()=>{let e;return function WorkPackageNewSplitViewComponent_Factory(t){return(e||(e=o.xGo(WorkPackageNewSplitViewComponent)))(t||WorkPackageNewSplitViewComponent)}})()}static{this.ɵcmp=o.VBU({type:WorkPackageNewSplitViewComponent,selectors:[["wp-new-split-view"]],features:[o.Vt3],decls:1,vars:1,consts:[["class","work-packages--details work-packages--new",4,"ngIf"],[1,"work-packages--details","work-packages--new"],[3,"onSaved","resource","skippedFields","inEditMode"],[1,"work-packages--details-content","-create-mode"],[1,"work-packages--new-details-header"],[3,"workPackage"],[1,"wp--details--switch-fullscreen-wrapper"],[1,"work-packages-show-view-button","wp--details--switch-fullscreen",3,"click"],[1,"icon-context","icon-to-fullscreen"],[3,"workPackage","showProject"],[1,"work-packages--details-toolbar-container"],[3,"onCancel"],[1,"work-packages--details--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"]],template:function WorkPackageNewSplitViewComponent_Template(e,t){1&e&&o.DNE(0,WorkPackageNewSplitViewComponent_div_0_Template,13,9,"div",0),2&e&&o.Y8G("ngIf",t.newWorkPackage)},dependencies:[r.bT,s.G,a.j,l.l,c.H,p.k],encapsulation:2,changeDetection:0})}}},95685:(e,t,n)=>{"use strict";n.d(t,{c:()=>i,t:()=>isRelationColumn});const i={PROPERTY:"QueryColumn::Property",RELATION_OF_TYPE:"QueryColumn::RelationOfType",RELATION_TO_TYPE:"QueryColumn::RelationToType"};function isRelationColumn(e){return[i.RELATION_TO_TYPE,i.RELATION_OF_TYPE].indexOf(e._type)>=0}},49741:(e,t,n)=>{"use strict";n.d(t,{r:()=>QueryFiltersService});var i=n(44674),o=n(68559);class QueryFiltersService{constructor(e){this.schemaCache=e}getFilterSchema(e,t){const n=t.$embedded.schema.filtersSchemas.elements;return _.find(n,(t=>t.allowedFilterValue.href===e.filter.href))}mapSchemasIntoFilters(e,t){e.filters.forEach((e=>{const n=this.getFilterSchema(e,t);e.$links.schema=n.$links.self,this.schemaCache.update(e,n)}))}setSchemas(e){e.elements.forEach((e=>{this.schemaCache.updateValue(e.$links.self.href,e)}))}static{this.ɵfac=function QueryFiltersService_Factory(e){return new(e||QueryFiltersService)(o.KVO(i.D))}}static{this.ɵprov=o.jDH({token:QueryFiltersService,factory:QueryFiltersService.ɵfac})}}},68118:(e,t,n)=>{"use strict";n.d(t,{x:()=>QueryParamListenerService});var i=n(44663),o=n(95445),r=n(83093),s=n(84205),a=n(68559);class QueryParamListenerService{constructor(e){this.injector=e,this.wpListChecksumService=this.injector.get(i.T),this.wpListService=this.injector.get(o.E),this.$transitions=this.injector.get(r.HN),this.observe$=new s.B,this.listenForQueryParamsChanged()}listenForQueryParamsChanged(){return this.queryChangeListener=this.$transitions.onSuccess({},(e=>{const t=e.options(),n=e.params("to"),i=this.wpListService.getCurrentQueryProps(n),o=n.query_id?n.query_id.toString():null;return!!(t.reload||t.custom&&!1===t.custom.notify)||this.wpListChecksumService.executeIfOutdated(o,i,(()=>{this.observe$.next(i)}))}))}removeQueryChangeListener(){this.queryChangeListener()}static{this.ɵfac=function QueryParamListenerService_Factory(e){return new(e||QueryParamListenerService)(a.KVO(a.zZn))}}static{this.ɵprov=a.jDH({token:QueryParamListenerService,factory:QueryParamListenerService.ɵfac})}}},85247:(e,t,n)=>{"use strict";n.d(t,{j:()=>UrlParamsHelperService});var i=n(12313),o=n(32147),r=n(89282),s=n(81965),a=n(68559);class UrlParamsHelperService{constructor(e){this.paginationService=e}buildQueryString(e){if(!e)return;const t=[];return _.each(e,((e,n)=>{e&&(Array.isArray(e)||(e=[e]),_.each(e,(e=>{null!==e&&"object"==typeof e&&(e=JSON.stringify(e)),t.push(`${encodeURIComponent(n)}=${encodeURIComponent(e)}`)})))})),t.join("&")}encodeQueryJsonParams(e,t){const n={c:e.columns.map((e=>e.id)),hi:!!e.showHierarchies,g:_.get(e.groupBy,"id",""),dr:e.displayRepresentation,is:e.includeSubprojects,...this.encodeSums(e),...this.encodeTimelineVisible(e),...this.encodeHighlightingMode(e),...this.encodeHighlightedAttributes(e),...this.encodeSortBy(e),...this.encodeFilters(e.filters),...this.encodeTimestamps(e)};return"function"==typeof t?JSON.stringify(t(n)):"object"==typeof t?JSON.stringify(_.merge(n,t)):JSON.stringify(n)}encodeSums(e){return e.sums?{s:e.sums}:{}}encodeHighlightingMode(e){return e.highlightingMode&&((0,o.A)(e)||"inline"!==e.highlightingMode)?{hl:e.highlightingMode}:{}}encodeHighlightedAttributes(e){return"inline"===e.highlightingMode&&Array.isArray(e.highlightedAttributes)&&e.highlightedAttributes.length>0?{hla:e.highlightedAttributes.map((e=>(0,i.A)(e.href)))}:{}}encodeSortBy(e){return e.sortBy?{t:e.sortBy.map((e=>e.id.replace("-",":"))).join()}:{}}encodeTimestamps(e){return e.timestamps?{ts:e.timestamps.join(",")}:{}}encodeFilters(e){if(e&&e.length>0){return{f:e.map((e=>({n:e.id,o:e.operator.id,v:e.values.map((e=>this.queryFilterValueToParam(e)))})))}}return{f:[]}}encodeTimelineVisible(e){const t={};return e.timelineVisible?(t.tv=e.timelineVisible,_.isEmpty(e.timelineLabels)||(t.tll=JSON.stringify(e.timelineLabels)),t.tzl=e.timelineZoomLevel):t.tv=!1,t}buildV3GetQueryFromJsonParams(e){const t={pageSize:this.paginationService.getPerPage()};if(!e)return t;const n=JSON.parse(e);if(n.c&&(t["columns[]"]=n.c.map((e=>e))),n.s&&(t.showSums=n.s),t.timelineVisible=n.tv,n.tv&&(n.tll&&(t.timelineLabels=n.tll),n.tzl&&(t.timelineZoomLevel=n.tzl)),n.dr&&(t.displayRepresentation=n.dr),void 0!==n.is&&(t.includeSubprojects=n.is),n.hl&&(t.highlightingMode=n.hl),n.hla&&(t["highlightedAttributes[]"]=n.hla.map((e=>e))),void 0!==n.hi&&(t.showHierarchies=n.hi),t.groupBy=_.get(n,"g",""),n.f){const e=n.f.map((e=>{const t={operator:decodeURIComponent(e.o)};if(e.v){const n=Array.isArray(e.v)?e.v:[e.v];_.extend(t,{values:n})}const n={};return n[e.n]=t,n}));t.filters=JSON.stringify(e)}return n.t&&(t.sortBy=JSON.stringify(n.t.split(",").map((e=>e.split(":"))))),n.ts&&(t.timestamps=n.ts),n.pa&&(t.offset=n.pa),n.pp&&(t.pageSize=n.pp),t}buildV3GetQueryFromQueryResource(e,t={},n={}){const i={};return i["columns[]"]=this.buildV3GetColumnsFromQueryResource(e),i.showSums=e.sums,i.timelineVisible=!!e.timelineVisible,e.timelineVisible&&(i.timelineZoomLevel=e.timelineZoomLevel,i.timelineLabels=JSON.stringify(e.timelineLabels)),e.highlightingMode&&(i.highlightingMode=e.highlightingMode),e.highlightedAttributes&&"inline"===e.highlightingMode&&(i["highlightedAttributes[]"]=e.highlightedAttributes.map((e=>e.href))),e.displayRepresentation&&(i.displayRepresentation=e.displayRepresentation),i.includeSubprojects=!!e.includeSubprojects,i.showHierarchies=!!e.showHierarchies,i.groupBy=_.get(e.groupBy,"id",""),i.filters=this.buildV3GetFiltersAsJson(e.filters,n),i.sortBy=this.buildV3GetSortByFromQuery(e),i.timestamps=e.timestamps.join(","),_.extend(t,i)}queryFilterValueToParam(e){if("boolean"==typeof e)return e?"t":"f";if(!e)return"";const t=e;return t.id?t.id.toString():t.href?t.href.split("/").pop():e.toString()}buildV3GetColumnsFromQueryResource(e){return e.columns?e.columns.map((e=>e.id||(0,i.A)(e.href))):e._links.columns?e._links.columns.map((e=>(0,i.A)(e.href))):[]}buildV3GetFilters(e,t={}){return e.map((e=>{const n=this.buildV3GetFilterIdFromFilter(e),i=this.buildV3GetOperatorIdFromFilter(e),o=this.buildV3GetValuesFromFilter(e).map((e=>(_.each(t,((t,n)=>{e=e.replace(`{${n}}`,t)})),e))),r={};return r[n]={operator:i,values:o},r}))}filterBuilderFrom(e){const t=new r.hG;return e.forEach((e=>{const n=this.buildV3GetFilterIdFromFilter(e),i=this.buildV3GetOperatorIdFromFilter(e),o=this.buildV3GetValuesFromFilter(e);t.add(n,i,o)})),t}buildV3GetFiltersAsJson(e,t={}){return JSON.stringify(this.buildV3GetFilters(e,t))}buildV3GetFilterIdFromFilter(e){const t=e.filter?e.filter.href:e._links.filter.href;return(0,i.A)(t)}buildV3GetValuesFromFilter(e){return e.values?_.map(e.values,(e=>this.queryFilterValueToParam(e))):_.map(e._links.values,(e=>(0,i.A)(e.href)))}buildV3GetOperatorIdFromFilter(e){if(e.operator)return e.operator.id||(0,i.A)(e.operator.href);const{href:t}=e._links.operator;return(0,i.A)(t)}buildV3GetSortByFromQuery(e){const t=(e.sortBy?e.sortBy:e._links.sortBy).map((e=>e.id?e.id:(0,i.A)(e.href)));return JSON.stringify(t.map((e=>e.split("-"))))}static{this.ɵfac=function UrlParamsHelperService_Factory(e){return new(e||UrlParamsHelperService)(a.KVO(s.m))}}static{this.ɵprov=a.jDH({token:UrlParamsHelperService,factory:UrlParamsHelperService.ɵfac,providedIn:"root"})}}},31433:(e,t,n)=>{"use strict";n.d(t,{V:()=>WpChildrenInlineCreateService});var i=n(90941),o=n(27871),r=n(27509),s=n(44674),a=n(59452),l=n(12313),c=n(68559);class WpChildrenInlineCreateService extends o.O{constructor(e,t,n){super(e),this.injector=e,this.wpRelationsHierarchyService=t,this.schemaCache=n,this.referenceComponentClass=r.a,this.relationType="children",this.referenceTarget=null,this.buttonTexts={reference:this.I18n.t("js.relation_buttons.add_existing_child"),create:this.I18n.t("js.relation_buttons.add_new_child")}}add(e,t){return this.wpRelationsHierarchyService.addExistingChildWp(e,t)}remove(e,t){return this.wpRelationsHierarchyService.removeChild(t)}get canAdd(){return this.referenceTarget&&this.canAddChild?this.canCreateWorkPackages((0,l.A)(this.referenceTarget.project.href)):(0,a.of)(!1)}get canReference(){return(0,a.of)(!!this.referenceTarget&&this.canAddChild)}get canAddChild(){return!(!this.schema||this.schema.isMilestone||!this.referenceTarget?.changeParent)}get schema(){return this.referenceTarget&&this.schemaCache.of(this.referenceTarget)}static{this.ɵfac=function WpChildrenInlineCreateService_Factory(e){return new(e||WpChildrenInlineCreateService)(c.KVO(c.zZn),c.KVO(i.F),c.KVO(s.D))}}static{this.ɵprov=c.jDH({token:WpChildrenInlineCreateService,factory:WpChildrenInlineCreateService.ɵfac})}}},27509:(e,t,n)=>{"use strict";n.d(t,{a:()=>WpRelationInlineAddExistingComponent});var i=n(61816),o=n(27871),r=n(97975),s=n(21861),a=n(85247),l=n(3575),c=n(91691),p=n(14593),d=n(49349),u=n(11048),h=n(68559),m=n(46765),g=n(63132);class WpRelationInlineAddExistingComponent{constructor(e,t,n,i,o,r,s,a,l){this.parent=e,this.wpInlineCreate=t,this.apiV3Service=n,this.wpRelations=i,this.notificationService=o,this.halEvents=r,this.urlParamsHelper=s,this.querySpace=a,this.I18n=l,this.isDisabled=!1,this.queryFilters=this.buildQueryFilters(),this.text={abort:this.I18n.t("js.relation_buttons.abort")}}addExisting(){if(_.isNil(this.selectedWpId))return;const e=this.selectedWpId;this.isDisabled=!0,this.wpInlineCreate.add(this.workPackage,e).then((()=>{this.apiV3Service.work_packages.id(this.workPackage).refresh(),this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:e,relationType:this.relationType}),this.isDisabled=!1,this.wpInlineCreate.newInlineWorkPackageReferenced.next(e),this.cancel()})).catch((e=>{this.notificationService.handleRawError(e,this.workPackage),this.isDisabled=!1,this.cancel()}))}onSelected(e){e&&(this.selectedWpId=e.id,this.addExisting())}get relationType(){return this.wpInlineCreate.relationType}get workPackage(){return this.wpInlineCreate.referenceTarget}cancel(){this.parent.resetRow()}buildQueryFilters(){const e=this.querySpace.query.value;if(!e)return[];const t=l.H.RELATION_TYPES(!0),n=e.filters.filter((e=>{const n=this.urlParamsHelper.buildV3GetFilterIdFromFilter(e);return-1===t.indexOf(n)})),i=[];return n.forEach((e=>{i.push({name:e.id,operator:e.operator.id,values:e.values.map((e=>"string"==typeof e?e:e.id))})})),i}static{this.ɵfac=function WpRelationInlineAddExistingComponent_Factory(e){return new(e||WpRelationInlineAddExistingComponent)(h.rXU(r.Q),h.rXU(o.O),h.rXU(p.n),h.rXU(s.U),h.rXU(d.U),h.rXU(c.o),h.rXU(a.j),h.rXU(u.i),h.rXU(i.W))}}static{this.ɵcmp=h.VBU({type:WpRelationInlineAddExistingComponent,selectors:[["ng-component"]],decls:7,vars:4,consts:[["data-indicator-name","relationAddChild",1,"loading-indicator--location"],[1,"wp-relations-create--form","wp-relations--add-form"],[1,"wp-relations-input-section"],["data-test-selector","wp-relations-autocomplete","hiddenOverflowContainer",".work-packages-full-view--split-left",3,"change","workPackage","filters","filterCandidatesFor"],[1,"wp-relations-controls-section","relation-row"],["type","button",1,"spot-link","wp-create-relation--cancel",3,"click"],["icon-classes","icon-remove icon-no-color",3,"icon-title"]],template:function WpRelationInlineAddExistingComponent_Template(e,t){1&e&&(h.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"wp-relations-autocomplete",3),h.bIt("change",(function WpRelationInlineAddExistingComponent_Template_wp_relations_autocomplete_change_3_listener(e){return t.onSelected(e)})),h.k0s()(),h.j41(4,"div",4)(5,"button",5),h.bIt("click",(function WpRelationInlineAddExistingComponent_Template_button_click_5_listener(){return t.cancel()})),h.nrm(6,"op-icon",6),h.k0s()()()()),2&e&&(h.R7$(3),h.Y8G("workPackage",t.workPackage)("filters",t.queryFilters)("filterCandidatesFor",t.relationType),h.R7$(3),h.Y8G("icon-title",t.text.abort))},dependencies:[m.i,g.u],encapsulation:2})}}},87962:(e,t,n)=>{"use strict";n.d(t,{i:()=>WpRelationInlineCreateService});var i=n(24398),o=n(27871),r=n(27509),s=n(21861),a=n(1758),l=n(59452),c=n(12313),p=n(91691),d=n(68559);class WpRelationInlineCreateService extends o.O{constructor(e){super(e),this.injector=e,this.referenceComponentClass=r.a,this.relationType="",this.referenceTarget=null,this.buttonTexts={reference:this.I18n.t("js.relation_buttons.add_existing"),create:this.I18n.t("js.relation_buttons.create_new")}}add(e,t){return this.wpRelations.addCommonRelation(t,this.relationType,e.id)}remove(e,t){const n=this.wpRelations.find(t,e,this.relationType);return void 0!==n?this.wpRelations.removeRelation(n).then((()=>{this.halEvents.push(e,{eventType:"association",relatedWorkPackage:t.id,relationType:n.normalizedType(e)})})):Promise.reject()}get canAdd(){return this.referenceTarget?.addRelation?this.canCreateWorkPackages((0,c.A)(this.referenceTarget.project.href)):(0,l.of)(!1)}get canReference(){return this.canAdd}static{this.ɵfac=function WpRelationInlineCreateService_Factory(e){return new(e||WpRelationInlineCreateService)(d.KVO(d.zZn))}}static{this.ɵprov=d.jDH({token:WpRelationInlineCreateService,factory:WpRelationInlineCreateService.ɵfac})}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",s.U)],WpRelationInlineCreateService.prototype,"wpRelations",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",p.o)],WpRelationInlineCreateService.prototype,"halEvents",void 0)},63132:(e,t,n)=>{"use strict";n.d(t,{u:()=>WorkPackageRelationsAutocompleteComponent});var i=n(24398),o=(n(68643),n(59452)),r=n(14600),s=n(70271),a=n(61318),l=n(46303),c=n(89282),p=n(44674),d=n(49349),u=n(1758),h=n(68559),m=n(60316),g=n(34456),_=n(44931),f=n(48377),b=n(62223);const _c0=(e,t,n)=>({$implicit:e,search:t,index:n}),_c1=(e,t,n,i)=>({$implicit:e,search:t,index:n,clear:i}),_c2=e=>({"padding-left.px":e});function WorkPackageRelationsAutocompleteComponent_input_1_Template(e,t){if(1&e&&h.nrm(0,"input",10,3),2&e){const e=h.XpG();h.BMQ("name",e.inputName)("data-action",e.hiddenFieldAction)}}function WorkPackageRelationsAutocompleteComponent_ng_container_2_input_1_Template(e,t){if(1&e&&h.nrm(0,"input",12),2&e){const e=t.$implicit,n=h.XpG(2);h.Y8G("value",e),h.BMQ("name",n.inputName+"[]")("data-action",n.hiddenFieldAction)}}function WorkPackageRelationsAutocompleteComponent_ng_container_2_Template(e,t){if(1&e&&(h.qex(0),h.DNE(1,WorkPackageRelationsAutocompleteComponent_ng_container_2_input_1_Template,1,3,"input",11),h.bVm()),2&e){const e=h.XpG();h.R7$(),h.Y8G("ngForOf",e.mappedInputValue)}}function WorkPackageRelationsAutocompleteComponent_7_ng_template_0_Template(e,t){if(1&e&&h.eu8(0,14),2&e){const e=t.item,n=t.index,i=t.searchTerm,o=h.XpG(2);h.Y8G("ngTemplateOutlet",o.headerTemplate||o.projectedHeaderTemplate)("ngTemplateOutletContext",h.sMw(2,_c0,e,i,n))}}function WorkPackageRelationsAutocompleteComponent_7_Template(e,t){1&e&&h.DNE(0,WorkPackageRelationsAutocompleteComponent_7_ng_template_0_Template,1,6,"ng-template",13)}function WorkPackageRelationsAutocompleteComponent_8_ng_template_0_Template(e,t){if(1&e&&h.eu8(0,14),2&e){const e=t.item,n=t.index,i=t.searchTerm,o=t.clear,r=h.XpG(2),s=h.sdS(14);h.Y8G("ngTemplateOutlet",r.projectedLabelTemplate||r.labelTemplate||s)("ngTemplateOutletContext",h.ziG(2,_c1,e,i,n,o))}}function WorkPackageRelationsAutocompleteComponent_8_Template(e,t){1&e&&h.DNE(0,WorkPackageRelationsAutocompleteComponent_8_ng_template_0_Template,1,7,"ng-template",15)}function WorkPackageRelationsAutocompleteComponent_ng_template_9_Template(e,t){if(1&e&&h.eu8(0,14),2&e){const e=t.item,n=t.index,i=t.searchTerm,o=h.XpG(),r=h.sdS(12);h.Y8G("ngTemplateOutlet",o.projectedOptionTemplate||o.optionTemplate||r)("ngTemplateOutletContext",h.sMw(2,_c0,e,i,n))}}function WorkPackageRelationsAutocompleteComponent_10_ng_template_0_Template(e,t){if(1&e&&h.eu8(0,14),2&e){const e=t.item,n=t.index,i=t.searchTerm,o=h.XpG(2);h.Y8G("ngTemplateOutlet",o.footerTemplate||o.projectedFooterTemplate)("ngTemplateOutletContext",h.sMw(2,_c0,e,i,n))}}function WorkPackageRelationsAutocompleteComponent_10_Template(e,t){1&e&&h.DNE(0,WorkPackageRelationsAutocompleteComponent_10_ng_template_0_Template,1,6,"ng-template",16)}function WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_0_Template(e,t){if(1&e&&(h.qex(0),h.nrm(1,"span",18),h.bVm()),2&e){const e=h.XpG(),t=e.$implicit,n=e.search;h.R7$(),h.Y8G("ngOptionHighlight",n)("textContent",t.name)("ngStyle",h.eq3(3,_c2,16*t.depth))}}function WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_1_op_principal_2_Template(e,t){if(1&e&&h.nrm(0,"op-principal",28),2&e){const e=h.XpG(2).$implicit;h.Y8G("principal",e.author)("hideName",!0)}}function WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_1_span_4_Template(e,t){if(1&e&&h.nrm(0,"span",29),2&e){const e=h.XpG(2).$implicit,t=h.XpG();h.Mz_("textContent","",e.type.name," "),h.Y8G("ngClass",t.highlighting("type",e.type.id))}}function WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_1_Template(e,t){if(1&e&&(h.qex(0),h.j41(1,"div",19),h.DNE(2,WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_1_op_principal_2_Template,1,2,"op-principal",20),h.j41(3,"span",21),h.DNE(4,WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_1_span_4_Template,1,3,"span",22),h.nrm(5,"span",23),h.k0s(),h.j41(6,"div",24),h.nrm(7,"span",25),h.j41(8,"span",26),h.EFF(9),h.k0s(),h.nrm(10,"span",27),h.k0s()(),h.bVm()),2&e){const e=h.XpG(),t=e.$implicit,n=e.search,i=h.XpG();h.R7$(2),h.Y8G("ngIf",t.author&&t.author.href),h.R7$(2),h.Y8G("ngIf",t.type),h.R7$(),h.Y8G("ngOptionHighlight",n)("textContent",t.subject),h.R7$(2),h.Y8G("ngOptionHighlight",n)("textContent",null==t.project?null:t.project.name),h.R7$(),h.Y8G("ngOptionHighlight",n),h.R7$(),h.SpI("#",t.id,""),h.R7$(),h.Y8G("textContent",null==t.status?null:t.status.name)("ngClass",i.highlighting("status",null==t.status?null:t.status.id))}}function WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_2_op_principal_1_Template(e,t){if(1&e&&h.nrm(0,"op-principal",33),2&e){const e=h.XpG(2).$implicit;h.Y8G("principal",e)("hideName",!0)}}function WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_2_span_4_Template(e,t){if(1&e&&(h.j41(0,"span",34),h.EFF(1),h.k0s()),2&e){const e=h.XpG(2),t=e.$implicit,n=e.search;h.Y8G("ngOptionHighlight",n),h.R7$(),h.JRh(t.email)}}function WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_2_Template(e,t){if(1&e&&(h.qex(0),h.DNE(1,WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_2_op_principal_1_Template,1,2,"op-principal",30),h.j41(2,"span",31),h.EFF(3),h.k0s(),h.DNE(4,WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_2_span_4_Template,2,2,"span",32),h.bVm()),2&e){const e=h.XpG(),t=e.$implicit,n=e.search;h.R7$(),h.Y8G("ngIf",t&&t.href),h.R7$(),h.Y8G("ngOptionHighlight",n),h.R7$(),h.JRh(t.name),h.R7$(),h.Y8G("ngIf",t.email)}}function WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_3_span_3_Template(e,t){if(1&e&&(h.j41(0,"span",34),h.EFF(1),h.k0s()),2&e){const e=h.XpG(2),t=e.$implicit,n=e.search;h.Y8G("ngOptionHighlight",n),h.R7$(),h.JRh(t.email)}}function WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_3_Template(e,t){if(1&e&&(h.qex(0),h.j41(1,"span",31),h.EFF(2),h.k0s(),h.DNE(3,WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_3_span_3_Template,2,2,"span",32),h.bVm()),2&e){const e=h.XpG(),t=e.$implicit,n=e.search;h.R7$(),h.Y8G("ngOptionHighlight",n),h.R7$(),h.JRh(t.name),h.R7$(),h.Y8G("ngIf",t.email)}}function WorkPackageRelationsAutocompleteComponent_ng_template_11_Template(e,t){if(1&e&&h.DNE(0,WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_0_Template,2,5,"ng-container",17)(1,WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_1_Template,11,10,"ng-container",17)(2,WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_2_Template,5,4,"ng-container",17)(3,WorkPackageRelationsAutocompleteComponent_ng_template_11_ng_container_3_Template,4,3,"ng-container",17),2&e){const e=t.$implicit,n=h.XpG();h.Y8G("ngSwitchCase",!n.resource&&!!e.depth),h.R7$(),h.Y8G("ngSwitchCase","work_packages"===n.resource||"parent-child"===n.resource),h.R7$(),h.Y8G("ngSwitchCase","users"===n.resource||"assignee"===n.resource||"principals"===n.resource),h.R7$(),h.Y8G("ngSwitchCase","subproject"===n.resource||"version"===n.resource||"status"===n.resource||"default"===n.resource||!n.resource&&!e.depth)}}function WorkPackageRelationsAutocompleteComponent_ng_template_13_ng_container_0_span_3_Template(e,t){if(1&e&&(h.j41(0,"span",37),h.EFF(1),h.k0s()),2&e){const e=h.XpG(2),t=e.$implicit,n=e.search;h.Y8G("ngOptionHighlight",n),h.R7$(),h.E5c(" ",null==t.type?null:t.type.name," #",t.id," ",t.subject||t.name," ")}}function WorkPackageRelationsAutocompleteComponent_ng_template_13_ng_container_0_Template(e,t){if(1&e){const e=h.RV6();h.qex(0),h.j41(1,"span",35),h.bIt("click",(function WorkPackageRelationsAutocompleteComponent_ng_template_13_ng_container_0_Template_span_click_1_listener(){h.eBV(e);const t=h.XpG(),n=t.$implicit,i=t.clear;return h.Njj(i(n))})),h.EFF(2,"×"),h.k0s(),h.DNE(3,WorkPackageRelationsAutocompleteComponent_ng_template_13_ng_container_0_span_3_Template,2,4,"span",36),h.bVm()}if(2&e){const e=h.XpG().$implicit;h.R7$(3),h.Y8G("ngIf",e.id)}}function WorkPackageRelationsAutocompleteComponent_ng_template_13_ng_container_1_Template(e,t){if(1&e){const e=h.RV6();h.qex(0),h.j41(1,"span",35),h.bIt("click",(function WorkPackageRelationsAutocompleteComponent_ng_template_13_ng_container_1_Template_span_click_1_listener(){h.eBV(e);const t=h.XpG(),n=t.$implicit,i=t.clear;return h.Njj(i(n))})),h.EFF(2,"×"),h.k0s(),h.j41(3,"span",37),h.EFF(4),h.k0s(),h.bVm()}if(2&e){const e=h.XpG(),t=e.$implicit,n=e.search;h.R7$(3),h.Y8G("ngOptionHighlight",n),h.R7$(),h.JRh(t.name)}}function WorkPackageRelationsAutocompleteComponent_ng_template_13_Template(e,t){if(1&e&&h.DNE(0,WorkPackageRelationsAutocompleteComponent_ng_template_13_ng_container_0_Template,4,1,"ng-container",6)(1,WorkPackageRelationsAutocompleteComponent_ng_template_13_ng_container_1_Template,5,2,"ng-container",6),2&e){const e=h.XpG();h.Y8G("ngIf","work_packages"===e.resource),h.R7$(),h.Y8G("ngIf","work_packages"!==e.resource)}}class WorkPackageRelationsAutocompleteComponent extends l.T{constructor(){super(...arguments),this.hiddenOverflowContainer="body",this.resource="work_packages",this.appendTo="body",this.placeholder=this.I18n.t("js.relations_autocomplete.placeholder"),this.getOptionsFn=this.getAutocompleterData.bind(this)}reset(){this.cancel.emit()}changed(e){e&&this.schemaCacheService.ensureLoaded(e).then((()=>{this.change.emit(e),this.ngSelectInstance.close()}))}opened(){this.ngZone.runOutsideAngular((()=>{setTimeout((()=>{this.ngSelectInstance.dropdownPanel.adjustPosition(),jQuery(this.hiddenOverflowContainer).one("scroll",(()=>{this.ngSelectInstance.close()}))}),25)}))}getAutocompleterData(e){return null===e||0===e.length?(0,o.of)([]):(0,r.H)(this.workPackage.availableRelationCandidates.$link.$fetch({query:e,filters:JSON.stringify(this.createFilters()),type:this.filterCandidatesFor||this.selectedRelationType,sortBy:JSON.stringify([["updatedAt","desc"]])})).pipe((0,s.T)((e=>e.elements)),(0,a.W)((e=>(this.notificationService.handleRawError(e),(0,o.of)([])))))}createFilters(){const e=new c.hG;return this.filters&&this.filters.forEach((t=>{e.add(t.name,t.operator,t.values)})),e.filters}static{this.ɵfac=(()=>{let e;return function WorkPackageRelationsAutocompleteComponent_Factory(t){return(e||(e=h.xGo(WorkPackageRelationsAutocompleteComponent)))(t||WorkPackageRelationsAutocompleteComponent)}})()}static{this.ɵcmp=h.VBU({type:WorkPackageRelationsAutocompleteComponent,selectors:[["wp-relations-autocomplete"]],hostBindings:function WorkPackageRelationsAutocompleteComponent_HostBindings(e,t){1&e&&h.bIt("keydown.escape",(function WorkPackageRelationsAutocompleteComponent_keydown_escape_HostBindingHandler(){return t.reset()}))},inputs:{workPackage:"workPackage",selectedRelationType:"selectedRelationType",filterCandidatesFor:"filterCandidatesFor",hiddenOverflowContainer:"hiddenOverflowContainer"},features:[h.Vt3],decls:15,vars:59,consts:[["ngSelectInstance",""],["defaultOption",""],["defaultLabel",""],["syncedInput",""],[1,"inline-label"],["type","hidden",4,"ngIf"],[4,"ngIf"],[3,"ngModelChange","change","open","close","blur","focus","clear","keydown","keydown.escape","search","scroll","scrollToEnd","add","remove","ngModel","items","ngClass","typeahead","clearOnBackspace","clearSearchOnAdd","hideSelected","appendTo","multiple","loading","addTag","virtualScroll","required","clearable","closeOnSelect","openOnEnter","disabled","name","id","bindLabel","bindValue","markFirst","notFoundText","addTagText","loadingText","clearAllText","appearance","dropdownPosition","selectOnTab","maxSelectedItems","placeholder","groupBy","groupValue","bufferAmount","selectableGroup","searchable","selectableGroupAsModel","trackByFn","compareWith","searchFn","labelForId","inputAttrs","tabIndex","readonly","searchWhileComposing","minTermLength","editableSearchTerm","keyDownFn"],["ng-option-tmp",""],[3,"ngSwitch"],["type","hidden"],["type","hidden",3,"value",4,"ngFor","ngForOf"],["type","hidden",3,"value"],["ng-header-tmp",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["ng-label-tmp",""],["ng-footer-tmp",""],[4,"ngSwitchCase"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight","textContent","ngStyle"],[1,"op-autocompleter--option-wrapper"],["class","op-autocompleter--option-principal",3,"principal","hideName",4,"ngIf"],["data-test-selector","op-autocompleter-item-subject",1,"op-autocompleter--wp-subject"],[3,"ngClass","textContent",4,"ngIf"],[3,"ngOptionHighlight","textContent"],[1,"op-autocompleter--wp-content"],[1,"op-autocompleter--wp-project",3,"ngOptionHighlight","textContent"],[1,"op-autocompleter--wp-id",3,"ngOptionHighlight"],[1,"op-autocompleter--wp-status",3,"textContent","ngClass"],[1,"op-autocompleter--option-principal",3,"principal","hideName"],[3,"ngClass","textContent"],["class","op-autocompleter--option-principal-avatar","size","mini",3,"principal","hideName",4,"ngIf"],[3,"ngOptionHighlight"],["class","op-autocompleter__option-principal-email",3,"ngOptionHighlight",4,"ngIf"],["size","mini",1,"op-autocompleter--option-principal-avatar",3,"principal","hideName"],[1,"op-autocompleter__option-principal-email",3,"ngOptionHighlight"],[1,"ng-value-icon","left",3,"click"],["class","ng-value-label",3,"ngOptionHighlight",4,"ngIf"],[1,"ng-value-label",3,"ngOptionHighlight"]],template:function WorkPackageRelationsAutocompleteComponent_Template(e,t){if(1&e){const e=h.RV6();h.j41(0,"div",4),h.DNE(1,WorkPackageRelationsAutocompleteComponent_input_1_Template,2,2,"input",5)(2,WorkPackageRelationsAutocompleteComponent_ng_container_2_Template,2,1,"ng-container",6),h.j41(3,"ng-select",7,0),h.nI1(5,"async"),h.nI1(6,"async"),h.mxI("ngModelChange",(function WorkPackageRelationsAutocompleteComponent_Template_ng_select_ngModelChange_3_listener(n){return h.eBV(e),h.DH7(t.model,n)||(t.model=n),h.Njj(n)})),h.bIt("change",(function WorkPackageRelationsAutocompleteComponent_Template_ng_select_change_3_listener(n){return h.eBV(e),h.Njj(t.changed(n))}))("open",(function WorkPackageRelationsAutocompleteComponent_Template_ng_select_open_3_listener(){return h.eBV(e),h.Njj(t.opened())}))("close",(function WorkPackageRelationsAutocompleteComponent_Template_ng_select_close_3_listener(){return h.eBV(e),h.Njj(t.closed())}))("blur",(function WorkPackageRelationsAutocompleteComponent_Template_ng_select_blur_3_listener(n){return h.eBV(e),h.Njj(t.blured(n))}))("focus",(function WorkPackageRelationsAutocompleteComponent_Template_ng_select_focus_3_listener(n){return h.eBV(e),h.Njj(t.focused(n))}))("clear",(function WorkPackageRelationsAutocompleteComponent_Template_ng_select_clear_3_listener(n){return h.eBV(e),h.Njj(t.cleared(n))}))("keydown",(function WorkPackageRelationsAutocompleteComponent_Template_ng_select_keydown_3_listener(n){return h.eBV(e),h.Njj(t.keydowned(n))}))("keydown.escape",(function WorkPackageRelationsAutocompleteComponent_Template_ng_select_keydown_escape_3_listener(n){return h.eBV(e),h.Njj(t.canceled(n))}))("search",(function WorkPackageRelationsAutocompleteComponent_Template_ng_select_search_3_listener(n){return h.eBV(e),h.Njj(t.searched(n))}))("scroll",(function WorkPackageRelationsAutocompleteComponent_Template_ng_select_scroll_3_listener(n){return h.eBV(e),h.Njj(t.scrolled(n))}))("scrollToEnd",(function WorkPackageRelationsAutocompleteComponent_Template_ng_select_scrollToEnd_3_listener(n){return h.eBV(e),h.Njj(t.scrolledToEnd(n))}))("add",(function WorkPackageRelationsAutocompleteComponent_Template_ng_select_add_3_listener(n){return h.eBV(e),h.Njj(t.added(n))}))("remove",(function WorkPackageRelationsAutocompleteComponent_Template_ng_select_remove_3_listener(n){return h.eBV(e),h.Njj(t.removed(n))})),h.DNE(7,WorkPackageRelationsAutocompleteComponent_7_Template,1,0,null,6)(8,WorkPackageRelationsAutocompleteComponent_8_Template,1,0,null,6)(9,WorkPackageRelationsAutocompleteComponent_ng_template_9_Template,1,6,"ng-template",8)(10,WorkPackageRelationsAutocompleteComponent_10_Template,1,0,null,6),h.k0s()(),h.DNE(11,WorkPackageRelationsAutocompleteComponent_ng_template_11_Template,4,4,"ng-template",9,1,h.C5r)(13,WorkPackageRelationsAutocompleteComponent_ng_template_13_Template,2,2,"ng-template",null,2,h.C5r)}2&e&&(h.R7$(),h.Y8G("ngIf",t.inputName&&!(t.multiple&&t.multipleAsSeparateInputs)),h.R7$(),h.Y8G("ngIf",t.multiple&&t.multipleAsSeparateInputs),h.R7$(),h.R50("ngModel",t.model),h.Y8G("items",h.bMT(5,55,t.results$))("ngClass",t.classes)("typeahead",t.typeahead)("clearOnBackspace",t.clearOnBackspace)("clearSearchOnAdd",t.clearSearchOnAdd)("hideSelected",t.hideSelected)("appendTo",t.appendTo)("multiple",t.multiple)("loading",h.bMT(6,57,t.loading$))("addTag",t.addTag)("virtualScroll",t.virtualScroll)("required",t.required)("clearable",t.clearable)("closeOnSelect",t.closeOnSelect)("openOnEnter",t.openOnEnter)("disabled",t.disabled)("name",t.name)("id",t.id)("bindLabel",t.bindLabel)("bindValue",t.bindValue)("markFirst",t.markFirst)("notFoundText",t.notFoundText)("addTagText",t.addTagText)("loadingText",t.loadingText)("clearAllText",t.clearAllText)("appearance",t.appearance)("dropdownPosition",t.dropdownPosition)("selectOnTab",t.selectOnTab)("maxSelectedItems",t.maxSelectedItems)("placeholder",t.placeholder)("groupBy",t.groupBy)("groupValue",t.groupValue)("bufferAmount",t.bufferAmount)("selectableGroup",t.selectableGroup)("searchable",t.searchable)("selectableGroupAsModel",t.selectableGroupAsModel)("trackByFn",t.trackByFn)("compareWith",t.compareWith)("searchFn",t.searchFn)("labelForId",t.labelForId)("inputAttrs",t.inputAttrs)("tabIndex",t.tabIndex)("readonly",t.readonly)("searchWhileComposing",t.searchWhileComposing)("minTermLength",t.minTermLength)("editableSearchTerm",t.editableSearchTerm)("keyDownFn",t.keyDownFn),h.BMQ("accesskey",t.accesskey||void 0),h.R7$(4),h.Y8G("ngIf",t.headerTemplate||t.projectedHeaderTemplate),h.R7$(),h.Y8G("ngIf",t.labelRequired),h.R7$(2),h.Y8G("ngIf",t.footerTemplate||t.projectedFooterTemplate),h.R7$(),h.Y8G("ngSwitch",!0))},dependencies:[m.YU,m.Sq,m.bT,m.T3,m.B3,m.ux,m.e1,g.BC,g.YS,g.vS,_.G,f.f,b.vr,b.Uq,b.ZZ,b.Uc,b.q8,m.Jj],styles:['.op-autocompleter--option-wrapper[_ngcontent-%COMP%]{padding:5px;line-height:15px;min-height:25px;word-break:break-word;display:grid;grid-template-columns:auto 1fr;grid-template-rows:1fr 1fr}.op-autocompleter--option-principal[_ngcontent-%COMP%]{margin-right:5px;float:left;grid-column-start:1;grid-column-end:2;grid-row-start:1;grid-row-end:3}.op-autocompleter--wp-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:50% 1fr auto;grid-template-areas:"project idlink status";font-size:.8rem;padding:1px 0 5px}.op-autocompleter--wp-project[_ngcontent-%COMP%]{grid-area:project;display:inline-block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.op-autocompleter--wp-id[_ngcontent-%COMP%]{grid-area:idlink;font-style:italic;margin:0 .5rem}.op-autocompleter--wp-status[_ngcontent-%COMP%]{grid-area:status;overflow:hidden;font-style:italic}.op-autocompleter--wp-subject[_ngcontent-%COMP%]{font-weight:var(--base-text-weight-bold);display:inline-block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.op-autocompleter__option-principal-email[_ngcontent-%COMP%]{color:var(--fgColor-muted);font-size:var(--font-size-small);margin-left:var(--stack-gap-condensed)}@media screen and (max-width: 543px){.op-autocompleter__option-principal-email[_ngcontent-%COMP%]{display:block;margin-left:0;margin-top:var(--control-xsmall-gap)}.op-autocompleter--option-principal-avatar[_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + .op-autocompleter__option-principal-email[_ngcontent-%COMP%]{margin-left:var(--control-small-size)}}'],changeDetection:0})}}(0,i.Cg)([(0,u.O)(d.U),(0,i.Sn)("design:type",d.U)],WorkPackageRelationsAutocompleteComponent.prototype,"notificationService",void 0),(0,i.Cg)([(0,u.O)(p.D),(0,i.Sn)("design:type",p.D)],WorkPackageRelationsAutocompleteComponent.prototype,"schemaCacheService",void 0)},90941:(e,t,n)=>{"use strict";n.d(t,{F:()=>WorkPackageRelationsHierarchyService});var i=n(13432),o=n(83093),r=n(73014),s=n(49349),a=n(14593),l=n(91691),c=n(68559);class WorkPackageRelationsHierarchyService{constructor(e,t,n,i,o,r){this.$state=e,this.states=t,this.halEvents=n,this.notificationService=i,this.pathHelper=o,this.apiV3Service=r}changeParent(e,t){const n={lockVersion:e.lockVersion};return n._links=t?{parent:{href:this.apiV3Service.work_packages.id(t).path}}:{parent:{href:null}},e.changeParent(n).then((n=>(this.apiV3Service.work_packages.cache.updateWorkPackage(n),this.notificationService.showSave(n),this.halEvents.push(e,{eventType:"association",relatedWorkPackage:t,relationType:"parent"}),n))).catch((t=>(this.notificationService.handleRawError(t,e),Promise.reject(t))))}removeParent(e){return this.changeParent(e,null)}addExistingChildWp(e,t){return this.apiV3Service.work_packages.id(t).get().toPromise().then((t=>this.changeParent(t,e.id).then((n=>(this.apiV3Service.work_packages.id(e).refresh(),this.halEvents.push(e,{eventType:"association",relatedWorkPackage:t.id,relationType:"child"}),n)))))}addNewChildWp(e,t){t.project.$load().then((()=>{const n=[`${e}.new`,{parent_id:t.id}];this.$state.includes("work-packages.show")&&(n[0]="work-packages.new"),this.$state.go(...n)}))}removeChild(e){return e.$load().then((()=>{const t=e.parent;return e.changeParent({_links:{parent:{href:null}},lockVersion:e.lockVersion}).then((e=>{t&&this.apiV3Service.work_packages.id(t).refresh().then((e=>{this.halEvents.push(e,{eventType:"association",relatedWorkPackage:null,relationType:"child"})})),this.apiV3Service.work_packages.cache.updateWorkPackage(e)})).catch((t=>(this.notificationService.handleRawError(t,e),Promise.reject(t))))}))}static{this.ɵfac=function WorkPackageRelationsHierarchyService_Factory(e){return new(e||WorkPackageRelationsHierarchyService)(c.KVO(o.dw),c.KVO(i.D),c.KVO(l.o),c.KVO(s.U),c.KVO(r.B),c.KVO(a.n))}}static{this.ɵprov=c.jDH({token:WorkPackageRelationsHierarchyService,factory:WorkPackageRelationsHierarchyService.ɵfac})}}},8865:(e,t,n)=>{"use strict";n.d(t,{g:()=>WorkPackageRelationsComponent});n(68643);var i=n(51567),o=n(52575),r=n(99496),s=n(14593),a=n(21861),l=n(73014),c=n(88535),p=n(31749),d=n(91691),u=n(68559),h=n(53689);const m=["frameElement"];class WorkPackageRelationsComponent extends r.p{constructor(e,t,n,i,o){super(),this.wpRelations=e,this.apiV3Service=t,this.halEvents=n,this.PathHelper=i,this.turboRequests=o,this.turboFrameListener=this.updateFrontendData.bind(this)}ngOnInit(){this.turboFrameSrc=`${this.PathHelper.staticBase}/work_packages/${this.workPackage.id}/relations_tab`}ngOnDestroy(){super.ngOnDestroy(),document.removeEventListener("turbo:submit-end",this.turboFrameListener)}ngAfterViewInit(){this.halEvents.events$.pipe((0,i.p)((e=>"association"===e.eventType&&e.id.toString()===this.workPackage.id?.toString()&&"parent"!==e.relationType)),(0,o.B)(500),this.untilDestroyed()).subscribe((()=>{this.updateRelationsTab()})),document.addEventListener("turbo:submit-end",this.turboFrameListener)}updateCounter(){const e=this.PathHelper.workPackageUpdateCounterPath(this.workPackage.id,"relations");this.turboRequests.request(e)}updateFrontendData(e){if(e){const t=e.target;!!t.dataset?.updateWorkPackage&&e.detail&&e.detail.success&&(this.apiV3Service.work_packages.id(this.workPackage.id).refresh(),this.halEvents.push(this.workPackage,{eventType:"updated"}),this.wpRelations.require(this.workPackage.id,!0),this.updateCounter())}}updateRelationsTab(){this.turboRequests.requestStream(this.turboFrameSrc).then((e=>{(0,p.aM)(e.html)})),this.updateCounter()}static{this.ɵfac=function WorkPackageRelationsComponent_Factory(e){return new(e||WorkPackageRelationsComponent)(u.rXU(a.U),u.rXU(s.n),u.rXU(d.o),u.rXU(l.B),u.rXU(c.W))}}static{this.ɵcmp=u.VBU({type:WorkPackageRelationsComponent,selectors:[["wp-relations"]],viewQuery:function WorkPackageRelationsComponent_Query(e,t){if(1&e&&u.GBs(m,5),2&e){let e;u.mGM(e=u.lsd())&&(t.relationTurboFrame=e.first)}},inputs:{workPackage:"workPackage"},features:[u.Vt3],decls:7,vars:1,consts:[["frameElement",""],["id","work-package-relations-tab-content"],["viewBox","0 0 100 100"],["x","0","y","0","width","70","height","5","rx","1"],["x","75","y","0","width","25","height","5","rx","1"],["x","0","y","10","width","100","height","8","rx","1"],["x","0","y","25","width","100","height","12","rx","1"]],template:function WorkPackageRelationsComponent_Template(e,t){1&e&&(u.j41(0,"turbo-frame",1,0)(2,"op-content-loader",2),u.qSk(),u.nrm(3,"rect",3)(4,"rect",4)(5,"rect",5)(6,"rect",6),u.k0s()()),2&e&&u.BMQ("src",t.turboFrameSrc)},dependencies:[h.F],encapsulation:2,changeDetection:0})}}},21861:(e,t,n)=>{"use strict";n.d(t,{U:()=>WorkPackageRelationsService});var i=n(73014),o=n(47418),r=n(36178),s=n(14593),a=n(42410),l=n(56196),c=n(70271),p=n(88535),d=n(89282),u=n(68559);class RelationStateGroup extends o.Iq{constructor(){super(),this.name="WP-Relations",this.relations=(0,o.Iy)(),this.initializeMembers()}}class WorkPackageRelationsService extends a.l{constructor(e,t,n,i){super((new RelationStateGroup).relations),this.PathHelper=e,this.apiV3Service=t,this.halResource=n,this.turboRequests=i}require(e,t=!1){return(0,l._)(this.requireAndStream(e,t))}requireAndStream(e,t=!1){return(this.stale(e)||t)&&this.clearAndLoad(e,this.load(e)),this.state(e).values$()}load(e){return this.apiV3Service.relations.filtered((0,d.K7)("involved","=",[e])).getPaginatedResults().pipe((0,c.T)((t=>this.relationsStateValue(e,t))))}requireAll(e){return new Promise(((t,n)=>{this.apiV3Service.relations.loadInvolved(e).toPromise().then((n=>{this.clearSome(...e),this.accumulateRelationsFromInvolved(e,n),t(void 0)})).catch(n)}))}find(e,t,n){const i=this.state(e.id).value;if(i)return _.find(i,(i=>{const o=i.denormalized(e);return o.target.id===t.id&&o.relationType===n}))}removeRelation(e){return e.delete().then((()=>{this.removeFromStates(e)}))}updateRelationType(e,t,n,i){const o={_links:{from:{href:e.href},to:{href:t.href}},type:i};return this.updateRelation(n,o)}updateRelation(e,t){return e.updateImmediately(t).then((e=>(this.insertIntoStates(e),e)))}addCommonRelation(e,t,n){const i={_links:{from:{href:this.apiV3Service.work_packages.id(e).toString()},to:{href:this.apiV3Service.work_packages.id(n).toString()}},type:t},o=this.apiV3Service.work_packages.id(e).relations.toString();return this.halResource.post(o,i).toPromise().then((e=>(this.insertIntoStates(e),e)))}updateCounter(e){if(e.id){const t=this.PathHelper.workPackageUpdateCounterPath(e.id,"relations");this.turboRequests.request(t)}}insertIntoStates(e){_.values(e.ids).forEach((t=>{this.multiState.get(t).doModify((t=>(t[e.id]=e,t)),(()=>{const t={};return t[e.id]=e,t}))}))}removeFromStates(e){_.values(e.ids).forEach((t=>{this.multiState.get(t).doModify((t=>(delete t[e.id],t)),(()=>({})))}))}relationsStateValue(e,t){return _.keyBy(t,(e=>e.id))}accumulateRelationsFromInvolved(e,t){e.forEach((e=>{const n=t.filter((t=>t.isInvolved(e))),i=this.relationsStateValue(e,n);this.updateValue(e,i)}))}static{this.ɵfac=function WorkPackageRelationsService_Factory(e){return new(e||WorkPackageRelationsService)(u.KVO(i.B),u.KVO(s.n),u.KVO(r.t),u.KVO(p.W))}}static{this.ɵprov=u.jDH({token:WorkPackageRelationsService,factory:WorkPackageRelationsService.ɵfac})}}},19593:(e,t,n)=>{"use strict";n.d(t,{$:()=>o});var i=n(83755);const o=(0,i.XI)("[Reminder] Reminder modal closed or updated",(0,i.xk)())},88467:(e,t,n)=>{"use strict";n.d(t,{A:()=>WorkPackageReminderModalComponent});var i=n(69081),o=n(51133),r=n(61816),s=n(73014),a=n(94564),l=n(19593),c=n(70271),p=n(14593),d=n(68559),u=n(93855),h=n(53689),m=n(60316);const g=["frameElement"];class WorkPackageReminderModalComponent extends i.a{constructor(e,t,n,i,o,r,s){super(e,t,i),this.locals=e,this.cdRef=t,this.I18n=n,this.elementRef=i,this.pathHelper=o,this.actions$=r,this.apiV3Service=s,this.showCloseButton=!1,this.text={new_title:this.I18n.t("js.work_packages.reminders.title.new"),edit_title:this.I18n.t("js.work_packages.reminders.title.edit"),subtitle:this.I18n.t("js.work_packages.reminders.subtitle"),button_close:this.I18n.t("js.button_close")},this.workPackage=this.locals.workPackage,this.title$=this.isEditMode().pipe((0,c.T)((e=>e?this.text.edit_title:this.text.new_title))),this.frameSrc=this.pathHelper.workPackageReminderModalBodyPath(this.workPackage.id)}ngOnInit(){super.ngOnInit()}ngAfterViewInit(){this.elementRef.nativeElement.addEventListener("turbo:submit-end",this.turboSubmitEndListener.bind(this))}ngOnDestroy(){super.ngOnDestroy(),this.elementRef.nativeElement.removeEventListener("turbo:submit-end",this.turboSubmitEndListener.bind(this))}onClose(){return this.actions$.dispatch((0,l.$)({workPackageId:this.workPackage.id})),super.onClose()}turboSubmitEndListener(e){const{fetchResponse:t}=e.detail;t.succeeded&&(this.closeMe(),this.onClose())}isEditMode(){return this.apiV3Service.work_packages.id(this.workPackage.id).reminders.get().pipe((0,c.T)((e=>e.total>0)))}static{this.ɵfac=function WorkPackageReminderModalComponent_Factory(e){return new(e||WorkPackageReminderModalComponent)(d.rXU(o.Y),d.rXU(d.gRc),d.rXU(r.W),d.rXU(d.aKT),d.rXU(s.B),d.rXU(a.d),d.rXU(p.n))}}static{this.ɵcmp=d.VBU({type:WorkPackageReminderModalComponent,selectors:[["ng-component"]],viewQuery:function WorkPackageReminderModalComponent_Query(e,t){if(1&e&&d.GBs(g,5),2&e){let e;d.mGM(e=d.lsd())&&(t.frameElement=e.first)}},features:[d.Vt3],decls:19,vars:6,consts:[["frameElement",""],[1,"spot-modal","op-reminder-dialog-modal"],[1,"spot-modal--header"],["id","spotModalTitle",1,"spot-modal--header-title",3,"textContent"],["data-test-selector","op-reminder-dialog-modal--close-icon",1,"button","button_no-margin","-transparent","spot-modal--header-close-button",3,"click"],["x-icon","","size","small",1,"spot-modal--header-close-button-icon"],[1,"spot-modal--subheader","fgColor-muted",3,"textContent"],[1,"spot-modal--body","spot-container"],["id","reminder_modal_body",3,"src"],["viewBox","0 0 180 80"],["height","8","rx","2","ry","2","width","30","x","0","y","0"],["height","10","rx","2","ry","2","width","180","x","0","y","10"],["height","8","rx","2","ry","2","width","30","x","0","y","24"],["height","10","rx","2","ry","2","width","180","x","0","y","34"],["height","8","rx","2","ry","2","width","30","x","0","y","48"],["height","10","rx","2","ry","2","width","180","x","0","y","58"],["height","8","rx","2","ry","2","width","50","x","0","y","72"],["height","8","rx","2","ry","2","width","50","x","130","y","72"]],template:function WorkPackageReminderModalComponent_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"div",1)(1,"div",2),d.nrm(2,"div",3),d.nI1(3,"async"),d.j41(4,"button",4),d.bIt("click",(function WorkPackageReminderModalComponent_Template_button_click_4_listener(n){return d.eBV(e),d.Njj(t.closeMe(n))})),d.qSk(),d.nrm(5,"svg",5),d.k0s()(),d.joV(),d.nrm(6,"p",6),d.j41(7,"div",7)(8,"turbo-frame",8,0)(10,"op-content-loader",9),d.qSk(),d.nrm(11,"rect",10)(12,"rect",11)(13,"rect",12)(14,"rect",13)(15,"rect",14)(16,"rect",15)(17,"rect",16)(18,"rect",17),d.k0s()()()()}2&e&&(d.R7$(2),d.Y8G("textContent",d.bMT(3,4,t.title$)||t.text.new_title),d.R7$(2),d.BMQ("aria-label",t.text.button_close),d.R7$(2),d.Y8G("textContent",t.text.subtitle),d.R7$(2),d.FS9("src",t.frameSrc))},dependencies:[u.bDK,h.F,m.Jj],styles:[".op-reminder-dialog-modal[_ngcontent-%COMP%]{min-height:350px}"],changeDetection:0})}}},59048:(e,t,n)=>{"use strict";n.d(t,{q:()=>o});var i=n(83755);const o=(0,i.XI)("[Sharing] Share modal closed or updated",(0,i.xk)())},20287:(e,t,n)=>{"use strict";n.d(t,{Z:()=>WorkPackageShareModalComponent});var i=n(69081),o=n(51133),r=n(61816),s=n(73014),a=n(94564),l=n(59048),c=n(68559),p=n(93855),d=n(53689);const u=["frameElement"];class WorkPackageShareModalComponent extends i.a{constructor(e,t,n,i,o,r){super(e,t,i),this.locals=e,this.cdRef=t,this.I18n=n,this.elementRef=i,this.pathHelper=o,this.actions$=r,this.showCloseButton=!1,this.text={title:this.I18n.t("js.work_packages.sharing.title"),button_close:this.I18n.t("js.button_close")},this.workPackage=this.locals.workPackage,this.frameSrc=this.pathHelper.workPackageSharePath(this.workPackage.id)}ngOnInit(){super.ngOnInit()}onClose(){return this.actions$.dispatch((0,l.q)({workPackageId:this.workPackage.id})),super.onClose()}static{this.ɵfac=function WorkPackageShareModalComponent_Factory(e){return new(e||WorkPackageShareModalComponent)(c.rXU(o.Y),c.rXU(c.gRc),c.rXU(r.W),c.rXU(c.aKT),c.rXU(s.B),c.rXU(a.d))}}static{this.ɵcmp=c.VBU({type:WorkPackageShareModalComponent,selectors:[["ng-component"]],viewQuery:function WorkPackageShareModalComponent_Query(e,t){if(1&e&&c.GBs(u,5),2&e){let e;c.mGM(e=c.lsd())&&(t.frameElement=e.first)}},features:[c.Vt3],decls:13,vars:3,consts:[["frameElement",""],[1,"spot-modal","spot-modal_wide","op-share-dialog-modal"],[1,"spot-modal--header"],["id","spotModalTitle",1,"spot-modal--header-title",3,"textContent"],["data-test-selector","op-share-dialog-modal--close-icon",1,"button","button_no-margin","-transparent","spot-modal--header-close-button",3,"click"],["x-icon","","size","small",1,"spot-modal--header-close-button-icon"],[1,"spot-modal--body","spot-container"],["id","share_modal_body",3,"src"],["viewBox","0 0 180 80"],["height","10","rx","2","ry","2","width","110","x","0","y","0"],["height","10","rx","2","ry","2","width","25","x","120","y","0"],["height","10","rx","2","ry","2","width","25","x","155","y","0"],["height","25%","rx","2","ry","2","width","180","x","0","y","16"]],template:function WorkPackageShareModalComponent_Template(e,t){if(1&e){const e=c.RV6();c.j41(0,"div",1)(1,"div",2),c.nrm(2,"div",3),c.j41(3,"button",4),c.bIt("click",(function WorkPackageShareModalComponent_Template_button_click_3_listener(n){return c.eBV(e),c.Njj(t.closeMe(n))})),c.qSk(),c.nrm(4,"svg",5),c.k0s()(),c.joV(),c.j41(5,"div",6)(6,"turbo-frame",7,0)(8,"op-content-loader",8),c.qSk(),c.nrm(9,"rect",9)(10,"rect",10)(11,"rect",11)(12,"rect",12),c.k0s()()()()}2&e&&(c.R7$(2),c.Y8G("textContent",t.text.title),c.R7$(),c.BMQ("aria-label",t.text.button_close),c.R7$(3),c.FS9("src",t.frameSrc))},dependencies:[p.bDK,d.F],styles:[".op-share-dialog-modal[_ngcontent-%COMP%]{min-height:350px}"],changeDetection:0})}}},40197:(e,t,n)=>{"use strict";n.d(t,{n:()=>ActivityPanelBaseController});var i=n(83093),o=n(91817),r=n(70271),s=n(64334),a=n(17456),l=n(61816),c=n(99496),p=n(14593),d=n(96613),u=n(75275),h=n(36652),m=n(68559);class ActivityPanelBaseController extends c.p{constructor(e,t,n,i,o,r,s,a,l){super(),this.apiV3Service=e,this.I18n=t,this.cdRef=n,this.uiRouterGlobals=i,this.wpActivity=o,this.storeService=r,this.browserDetector=s,this.wpSingleViewService=a,this.deviceService=l,this.unfilteredActivities=[],this.visibleActivities=[],this.onlyComments=!1,this.text={commentsOnly:this.I18n.t("js.label_activity_show_only_comments"),showAll:this.I18n.t("js.label_activity_show_all")},this.additionalScrollMargin=200,this.initialized=!1,this.comingFromNotifications=!1,this.reverse=o.isReversed,this.togglerText=this.text.commentsOnly,window.location.href.includes("/notifications")&&(this.comingFromNotifications=!0)}ngOnInit(){this.initialized=!1,this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe((e=>{this.workPackage=e,this.reloadActivities()})),this.wpSingleViewService.selectNotificationsCount$.pipe(this.untilDestroyed(),(0,o.F)()).subscribe((()=>{this.reloadActivities()}))}scrollIfNotificationPresent(){this.storeService.hasNotifications$.pipe((0,s.s)(1)).subscribe((e=>{e&&this.scrollToUnreadNotification()}))}reloadActivities(){this.wpActivity.require(this.workPackage,!0).then((e=>{this.updateActivities(e),this.cdRef.detectChanges(),this.initialized||(this.initialized=!0,this.scrollIfNotificationPresent())}))}updateActivities(e){this.unfilteredActivities=e;const t=this.getVisibleActivities();this.visibleActivities=t.map(((e,t)=>this.info(e,t))),this.showToggler=this.shouldShowToggler()}shouldShowToggler(){const e=this.unfilteredActivities.length,t=this.getActivitiesWithComments().length;return e>1&&t>0&&t<this.unfilteredActivities.length}getVisibleActivities(){return this.onlyComments?this.getActivitiesWithComments():this.unfilteredActivities}getActivitiesWithComments(){return this.unfilteredActivities.filter((e=>!!_.get(e,"comment.html")))}hasUnreadNotification(e){return this.storeService.selectNotifications$.pipe((0,r.T)((t=>!!t.find((t=>t._links.activity?.href===e)))))}scrollToUnreadNotification(){const e=document.querySelectorAll("[data-notification-selector='notification-activity']");if(window.location.href.indexOf("activity#")>-1||0===e.length)return;const t=e[this.reverse?e.length-1:0],n=document.querySelectorAll("[data-notification-selector='notification-scroll-container']")[0],i=t.offsetTop-n.offsetTop-this.additionalScrollMargin;n.scrollTop=i,this.comingFromNotifications&&this.deviceService.isMobile&&n.scrollIntoView(!0)}toggleComments(){this.onlyComments=!this.onlyComments,this.updateActivities(this.unfilteredActivities),this.onlyComments?this.togglerText=this.text.showAll:this.togglerText=this.text.commentsOnly}info(e,t){return this.wpActivity.info(this.unfilteredActivities,e,t)}static{this.ɵfac=function ActivityPanelBaseController_Factory(e){return new(e||ActivityPanelBaseController)(m.rXU(p.n),m.rXU(l.W),m.rXU(m.gRc),m.rXU(i.ok),m.rXU(a.Z),m.rXU(d.e),m.rXU(u.l),m.rXU(d.e),m.rXU(h.g))}}static{this.ɵdir=m.FsC({type:ActivityPanelBaseController,features:[m.Vt3]})}}},94210:(e,t,n)=>{"use strict";n.d(t,{H:()=>NewestActivityOnOverviewComponent});n(68643);var i=n(40197),o=n(55596),r=n(68559),s=n(60316),a=n(8871),l=n(66626);function NewestActivityOnOverviewComponent_ng_template_1_div_1_Template(e,t){if(1&e&&(r.j41(0,"div",3),r.nrm(1,"activity-entry",4),r.nI1(2,"async"),r.k0s()),2&e){const e=t.$implicit,n=r.XpG(2);r.R7$(),r.Y8G("workPackage",n.workPackage)("activity",e.activity)("activityNo",e.number(e.isReversed))("hasUnreadNotification",r.bMT(2,5,n.hasUnreadNotification(e.href)))("isInitial",e.isInitial())}}function NewestActivityOnOverviewComponent_ng_template_1_Template(e,t){if(1&e&&(r.j41(0,"div",1),r.DNE(1,NewestActivityOnOverviewComponent_ng_template_1_div_1_Template,3,7,"div",2),r.k0s()),2&e){const e=r.XpG();r.R7$(),r.Y8G("ngForOf",e.latestActivityInfo)("ngForTrackBy",e.trackByIdentifier)}}class NewestActivityOnOverviewComponent extends i.n{constructor(){super(...arguments),this.latestActivityInfo=[],this.trackByIdentifier=(0,o.I$)("identifier")}ngOnInit(){this.workPackageId=this.workPackage.id,super.ngOnInit()}shouldShowToggler(){return!1}updateActivities(e){super.updateActivities(e),this.latestActivityInfo=this.latestActivities()}latestActivities(e=3){if(this.reverse){return this.unfilteredActivities.slice(0,e).map(((e,t)=>this.info(e,t)))}const t=this.unfilteredActivities.slice(-e),n=this.unfilteredActivities.length-t.length;return t.map(((e,t)=>this.info(e,n+t)))}static{this.ɵfac=(()=>{let e;return function NewestActivityOnOverviewComponent_Factory(t){return(e||(e=r.xGo(NewestActivityOnOverviewComponent)))(t||NewestActivityOnOverviewComponent)}})()}static{this.ɵcmp=r.VBU({type:NewestActivityOnOverviewComponent,selectors:[["newest-activity-on-overview"]],inputs:{workPackage:"workPackage"},features:[r.Vt3],decls:2,vars:1,consts:[[3,"workPackage"],[1,"work-package-details-activities-list"],["class","work-package-details-activities-activity",4,"ngFor","ngForOf","ngForTrackBy"],[1,"work-package-details-activities-activity"],[3,"workPackage","activity","activityNo","hasUnreadNotification","isInitial"]],template:function NewestActivityOnOverviewComponent_Template(e,t){1&e&&(r.j41(0,"work-package-comment",0),r.DNE(1,NewestActivityOnOverviewComponent_ng_template_1_Template,2,2,"ng-template"),r.k0s()),2&e&&r.Y8G("workPackage",t.workPackage)},dependencies:[s.Sq,a._,l.P,s.Jj],encapsulation:2,changeDetection:0})}}},26030:(e,t,n)=>{"use strict";n.d(t,{l:()=>WorkPackageActivityTabComponent});n(68643);var i=n(55596),o=n(40197),r=n(68559),s=n(60316),a=n(8871),l=n(66626);const _c0=e=>({"-with-toggler":e});function WorkPackageActivityTabComponent_work_package_comment_0_ng_template_1_div_2_h4_1_button_2_Template(e,t){if(1&e){const e=r.RV6();r.j41(0,"button",11),r.bIt("click",(function WorkPackageActivityTabComponent_work_package_comment_0_ng_template_1_div_2_h4_1_button_2_Template_button_click_0_listener(){r.eBV(e);const t=r.XpG(5);return r.Njj(t.toggleComments())})),r.k0s()}if(2&e){const e=r.XpG(5);r.Y8G("textContent",e.togglerText)}}function WorkPackageActivityTabComponent_work_package_comment_0_ng_template_1_div_2_h4_1_Template(e,t){if(1&e&&(r.j41(0,"h4",8),r.nrm(1,"span",9),r.DNE(2,WorkPackageActivityTabComponent_work_package_comment_0_ng_template_1_div_2_h4_1_button_2_Template,1,1,"button",10),r.k0s()),2&e){const e=r.XpG(),t=e.$implicit,n=e.first,i=r.XpG(3);r.Y8G("ngClass",r.eq3(3,_c0,n&&i.showToggler)),r.R7$(),r.Y8G("textContent",t.date),r.R7$(),r.Y8G("ngIf",n&&i.showToggler)}}function WorkPackageActivityTabComponent_work_package_comment_0_ng_template_1_div_2_Template(e,t){if(1&e&&(r.j41(0,"div",5),r.DNE(1,WorkPackageActivityTabComponent_work_package_comment_0_ng_template_1_div_2_h4_1_Template,3,5,"h4",6),r.nrm(2,"activity-entry",7),r.nI1(3,"async"),r.k0s()),2&e){const e=t.$implicit,n=t.first,i=r.XpG(3);r.R7$(),r.Y8G("ngIf",n||e.isNextDate),r.R7$(),r.Y8G("workPackage",i.workPackage)("activity",e.activity)("activityNo",e.number(e.isReversed))("hasUnreadNotification",r.bMT(3,6,i.hasUnreadNotification(e.href)))("isInitial",e.isInitial())}}function WorkPackageActivityTabComponent_work_package_comment_0_ng_template_1_Template(e,t){if(1&e&&(r.j41(0,"div",2)(1,"div",3),r.DNE(2,WorkPackageActivityTabComponent_work_package_comment_0_ng_template_1_div_2_Template,4,8,"div",4),r.k0s()()),2&e){const e=r.XpG(2);r.R7$(2),r.Y8G("ngForOf",e.visibleActivities)("ngForTrackBy",e.trackByIdentifier)}}function WorkPackageActivityTabComponent_work_package_comment_0_Template(e,t){if(1&e&&(r.j41(0,"work-package-comment",1),r.DNE(1,WorkPackageActivityTabComponent_work_package_comment_0_ng_template_1_Template,3,2,"ng-template"),r.k0s()),2&e){const e=r.XpG();r.Y8G("workPackage",e.workPackage)}}class WorkPackageActivityTabComponent extends o.n{constructor(){super(...arguments),this.tabName=this.I18n.t("js.work_packages.tabs.activity"),this.trackByIdentifier=(0,i.I$)("identifier")}ngOnInit(){const{workPackageId:e}=this.uiRouterGlobals.params;this.workPackageId=this.workPackage.id||e,super.ngOnInit()}static{this.ɵfac=(()=>{let e;return function WorkPackageActivityTabComponent_Factory(t){return(e||(e=r.xGo(WorkPackageActivityTabComponent)))(t||WorkPackageActivityTabComponent)}})()}static{this.ɵcmp=r.VBU({type:WorkPackageActivityTabComponent,selectors:[["wp-activity-tab"]],inputs:{workPackage:"workPackage"},features:[r.Vt3],decls:1,vars:1,consts:[[3,"workPackage",4,"ngIf"],[3,"workPackage"],[1,"detail-activity"],[1,"work-package-details-activities-list"],["class","work-package-details-activities-activity",4,"ngFor","ngForOf","ngForTrackBy"],[1,"work-package-details-activities-activity"],["class","activity-date",3,"ngClass",4,"ngIf"],[3,"workPackage","activity","activityNo","hasUnreadNotification","isInitial"],[1,"activity-date",3,"ngClass"],[1,"activity-date--label",3,"textContent"],["type","button","class","activity-comments--toggler button -small -transparent -with-icon icon-filter icon-small hide-when-print",3,"textContent","click",4,"ngIf"],["type","button",1,"activity-comments--toggler","button","-small","-transparent","-with-icon","icon-filter","icon-small","hide-when-print",3,"click","textContent"]],template:function WorkPackageActivityTabComponent_Template(e,t){1&e&&r.DNE(0,WorkPackageActivityTabComponent_work_package_comment_0_Template,2,1,"work-package-comment",0),2&e&&r.Y8G("ngIf",t.workPackage)},dependencies:[s.YU,s.Sq,s.bT,a._,l.P,s.Jj],encapsulation:2,changeDetection:0})}}},17456:(e,t,n)=>{"use strict";n.d(t,{Z:()=>WorkPackagesActivityService});var i=n(72688),o=n(62187),r=n(32420),s=n(6923);class ActivityEntryInfo{constructor(e,t,n,i,o){this.timezoneService=e,this.isReversed=t,this.activities=n,this.activity=i,this.index=o,this.date=this.activityDate(this.activity),this.dateOfPrevious=this.index>0?this.activityDate(this.activities[this.index-1]):void 0,this.isNextDate=this.date!==this.dateOfPrevious}number(e=!1){return this.orderedIndex(this.index,e)}get href(){return this.activity.href}get identifier(){return`${this.href}-${this.version}-${this.updatedAt}`}get version(){return this.activity.version}get updatedAt(){return this.activity.updatedAt}isInitial(e=!1){let t=this.number(e);if(0!==this.activity._type.indexOf("Activity"))return!1;if(1===t)return!0;for(;--t>0;){const n=this.orderedIndex(t,e)-1,i=this.activities[n];if(!_.isNil(i)&&0===i._type.indexOf("Activity"))return!1}return!0}activityDate(e){return s(e.createdAt).format("LL")}orderedIndex(e,t=!1){return t||this.isReversed?this.activities.length-e:e+1}}var a=n(68559);class WorkPackagesActivityService extends o.${constructor(e,t){super(),this.ConfigurationService=e,this.timezoneService=t}get order(){return this.isReversed?"desc":"asc"}get isReversed(){return!!this.ConfigurationService.commentsSortedInDescendingOrder()}load(e){const t=[],n=[],add=function(e){t.push(e.elements)};return n.push(e.activities.$update().then(add)),e.revisions&&n.push(e.revisions.$update().then(add)),Promise.all(n).then((()=>this.sortedActivityList(t)))}sortedActivityList(e,t="createdAt"){const n=_.sortBy(_.flatten(e),t);return this.isReversed?n.reverse():n}info(e,t,n){return new ActivityEntryInfo(this.timezoneService,this.isReversed,e,t,n)}static{this.ɵfac=function WorkPackagesActivityService_Factory(e){return new(e||WorkPackagesActivityService)(a.KVO(i.s),a.KVO(r.D))}}static{this.ɵprov=a.jDH({token:WorkPackagesActivityService,factory:WorkPackagesActivityService.ɵfac})}}},55355:(e,t,n)=>{"use strict";n.d(t,{R:()=>WorkPackageFilesTabComponent});var i=n(19999),o=n(70271),r=(n(68643),n(61816)),s=n(63894),a=n(66042),l=n(88535),c=n(73014),p=n(68559),d=n(60316),u=n(66913),h=n(39176);const _c0=e=>({"op-tab-content--tab-section_no-header":e});function WorkPackageFilesTabComponent_section_1_div_2_Template(e,t){if(1&e&&(p.j41(0,"div",6),p.nrm(1,"span",7)(2,"span",8),p.k0s()),2&e){const e=p.XpG(2);p.R7$(2),p.Y8G("textContent",e.text.attachments.label)}}function WorkPackageFilesTabComponent_section_1_Template(e,t){if(1&e){const e=p.RV6();p.j41(0,"section",3),p.nI1(1,"async"),p.DNE(2,WorkPackageFilesTabComponent_section_1_div_2_Template,3,1,"div",4),p.nI1(3,"async"),p.j41(4,"op-attachments",5),p.bIt("attachmentRemoved",(function WorkPackageFilesTabComponent_section_1_Template_op_attachments_attachmentRemoved_4_listener(){p.eBV(e);const t=p.XpG();return p.Njj(t.attachmentRemoved())}))("attachmentAdded",(function WorkPackageFilesTabComponent_section_1_Template_op_attachments_attachmentAdded_4_listener(){p.eBV(e);const t=p.XpG();return p.Njj(t.attachmentAdded())})),p.k0s()()}if(2&e){const e=p.XpG();p.Y8G("ngClass",p.eq3(7,_c0,!1===p.bMT(1,3,e.showAttachmentHeader$))),p.R7$(2),p.Y8G("ngIf",p.bMT(3,5,e.showAttachmentHeader$)),p.R7$(2),p.Y8G("resource",e.workPackage)}}function WorkPackageFilesTabComponent_section_2_Template(e,t){if(1&e){const e=p.RV6();p.j41(0,"section",9)(1,"op-storage",10),p.nI1(2,"async"),p.nI1(3,"async"),p.bIt("fileRemoved",(function WorkPackageFilesTabComponent_section_2_Template_op_storage_fileRemoved_1_listener(){p.eBV(e);const t=p.XpG();return p.Njj(t.attachmentRemoved())}))("fileAdded",(function WorkPackageFilesTabComponent_section_2_Template_op_storage_fileAdded_1_listener(){p.eBV(e);const t=p.XpG();return p.Njj(t.attachmentAdded())})),p.k0s()()}if(2&e){const e=t.$implicit,n=p.XpG();p.R7$(),p.Y8G("resource",n.workPackage)("projectStorage",e)("allowUploading",p.bMT(2,4,n.allowManageFileLinks$))("allowLinking",p.bMT(3,6,n.allowManageFileLinks$))}}class WorkPackageFilesTabComponent{constructor(e,t,n,i,o){this.i18n=e,this.currentUserService=t,this.projectStoragesResourceService=n,this.pathHelper=i,this.turboRequests=o,this.text={attachments:{label:this.i18n.t("js.label_attachments")}}}ngOnInit(){const e=this.workPackage.project;if(null===e.id)return;this.showAttachments=!!this.workPackage.$links.attachments;const t=this.currentUserService.hasCapabilities$("file_links/view",e.id);this.projectStorages=this.projectStoragesResourceService.requireCollection({filters:[["projectId","=",[e.id]]]}),this.allowManageFileLinks$=this.currentUserService.hasCapabilities$("file_links/manage",e.id),this.showAttachmentHeader$=(0,i.z)([this.projectStorages,t]).pipe((0,o.T)((([e,t])=>e.length>0&&t)))}attachmentRemoved(){this.updateCounter()}attachmentAdded(){this.updateCounter()}updateCounter(){if(this.workPackage.id){const e=this.pathHelper.workPackageUpdateCounterPath(this.workPackage.id,"files");this.turboRequests.request(e)}}static{this.ɵfac=function WorkPackageFilesTabComponent_Factory(e){return new(e||WorkPackageFilesTabComponent)(p.rXU(r.W),p.rXU(s.K),p.rXU(a.z),p.rXU(c.B),p.rXU(l.W))}}static{this.ɵcmp=p.VBU({type:WorkPackageFilesTabComponent,selectors:[["op-files-tab"]],inputs:{workPackage:"workPackage"},decls:4,vars:4,consts:[[1,"op-tab-content--container","op-files-tab"],["class","op-tab-content--tab-section","data-test-selector","op-tab-content--tab-section",3,"ngClass",4,"ngIf"],["data-test-selector","op-tab-content--tab-section","class","op-tab-content--tab-section",4,"ngFor","ngForOf"],["data-test-selector","op-tab-content--tab-section",1,"op-tab-content--tab-section",3,"ngClass"],["class","op-tab-content--header",4,"ngIf"],[3,"attachmentRemoved","attachmentAdded","resource"],[1,"op-tab-content--header"],[1,"spot-icon","spot-icon_attachment","op-tab-content--header-icon","op-files-tab--icon_clip"],[1,"op-tab-content--header-text",3,"textContent"],["data-test-selector","op-tab-content--tab-section",1,"op-tab-content--tab-section"],[3,"fileRemoved","fileAdded","resource","projectStorage","allowUploading","allowLinking"]],template:function WorkPackageFilesTabComponent_Template(e,t){1&e&&(p.j41(0,"div",0),p.DNE(1,WorkPackageFilesTabComponent_section_1_Template,5,9,"section",1)(2,WorkPackageFilesTabComponent_section_2_Template,4,8,"section",2),p.nI1(3,"async"),p.k0s()),2&e&&(p.R7$(),p.Y8G("ngIf",t.showAttachments),p.R7$(),p.Y8G("ngForOf",p.bMT(3,2,t.projectStorages)))},dependencies:[d.YU,d.Sq,d.bT,u.r,h.P,d.Jj],encapsulation:2,changeDetection:0})}}},66309:(e,t,n)=>{"use strict";n.d(t,{S:()=>KeepTabService});var i=n(83093),o=n(56042),r=n(69728),s=n(68559);class KeepTabService{constructor(e,t,n){this.$state=e,this.uiRouterGlobals=t,this.$transitions=n,this.currentTab="overview",this.subject=new o.m(1),this.updateTabs(),n.onSuccess({},(e=>{this.updateTabs(e.params("to").tabIdentifier)}))}get observable(){return this.subject}get lastActiveTab(){return this.isCurrentState("show")?this.currentShowTab:this.currentDetailsTab}goCurrentShowState(e={}){this.$state.go("work-packages.show.tabs",{...this.uiRouterGlobals.params,...e,tabIdentifier:this.currentShowTab})}goCurrentDetailsState(e={}){const t=(0,r.N)(this.$state);this.$state.go(`${t}.tabs`,{...this.uiRouterGlobals.params,...e,tabIdentifier:this.currentDetailsTab})}isDetailsState(e){return!!e&&e.includes(".details")}get currentShowTab(){return"overview"===this.currentTab?"activity":this.currentTab}get currentDetailsTab(){return this.currentTab}get currentTabIdentifier(){return this.uiRouterGlobals.params.tabIdentifier}notify(){this.subject.next({active:this.lastActiveTab,show:this.currentShowTab,details:this.currentDetailsTab})}updateTab(e){this.isCurrentState(e)&&(this.currentTab=this.uiRouterGlobals.params.tabIdentifier,this.notify())}isCurrentState(e){return"show"===e?this.$state.includes("work-packages.show.*"):"details"===e&&this.$state.includes("**.details.*")}updateTabs(e){if(this.isCurrentState("show")&&"activity"===e)return this.currentTab="overview",this.notify();this.updateTab("show"),this.updateTab("details")}static{this.ɵfac=function KeepTabService_Factory(e){return new(e||KeepTabService)(s.KVO(i.dw),s.KVO(i.ok),s.KVO(i.HN))}}static{this.ɵprov=s.jDH({token:KeepTabService,factory:KeepTabService.ɵfac,providedIn:"root"})}}},33389:(e,t,n)=>{"use strict";n.d(t,{D:()=>WorkPackageOverviewTabComponent});var i=n(83093),o=(n(68643),n(61816)),r=n(99496),s=n(14593),a=n(72688),l=n(68559),c=n(60316),p=n(68899),d=n(94210);function WorkPackageOverviewTabComponent_wp_single_view_0_Template(e,t){if(1&e&&l.nrm(0,"wp-single-view",2),2&e){const e=l.XpG();l.Y8G("workPackage",e.workPackage)}}function WorkPackageOverviewTabComponent_div_1_Template(e,t){if(1&e&&(l.j41(0,"div",3)(1,"div",4)(2,"div",5),l.nrm(3,"h3",6),l.k0s()(),l.nrm(4,"newest-activity-on-overview",2),l.k0s()),2&e){const e=l.XpG();l.R7$(3),l.Y8G("textContent",e.tabName),l.R7$(),l.Y8G("workPackage",e.workPackage)}}class WorkPackageOverviewTabComponent extends r.p{constructor(e,t,n,i){super(),this.I18n=e,this.$state=t,this.apiV3Service=n,this.configurationService=i,this.tabName=this.I18n.t("js.label_latest_activity")}ngOnInit(){this.workPackageId=this.workPackage?.id||this.$state.params.workPackageId,this.primerizedActivitiesEnabled=this.configurationService.activeFeatureFlags.includes("primerizedWorkPackageActivities"),this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe((e=>this.workPackage=e))}static{this.ɵfac=function WorkPackageOverviewTabComponent_Factory(e){return new(e||WorkPackageOverviewTabComponent)(l.rXU(o.W),l.rXU(i.dw),l.rXU(s.n),l.rXU(a.s))}}static{this.ɵcmp=l.VBU({type:WorkPackageOverviewTabComponent,selectors:[["wp-overview-tab"]],inputs:{workPackage:"workPackage"},features:[l.Vt3],decls:2,vars:2,consts:[[3,"workPackage",4,"ngIf"],["class","attributes-group",4,"ngIf"],[3,"workPackage"],[1,"attributes-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"]],template:function WorkPackageOverviewTabComponent_Template(e,t){1&e&&l.DNE(0,WorkPackageOverviewTabComponent_wp_single_view_0_Template,1,1,"wp-single-view",0)(1,WorkPackageOverviewTabComponent_div_1_Template,5,2,"div",1),2&e&&(l.Y8G("ngIf",t.workPackage),l.R7$(),l.Y8G("ngIf",t.workPackage&&!t.primerizedActivitiesEnabled))},dependencies:[c.bT,p.k,d.H],encapsulation:2})}}},38761:(e,t,n)=>{"use strict";n.d(t,{r:()=>WorkPackageRelationsTabComponent});var i=n(83093),o=n(61816),r=(n(68643),n(99496)),s=n(14593),a=n(68559),l=n(60316),c=n(8865);function WorkPackageRelationsTabComponent_div_0_Template(e,t){if(1&e&&(a.j41(0,"div",1)(1,"div",2),a.nrm(2,"wp-relations",3),a.k0s()()),2&e){const e=a.XpG();a.R7$(2),a.Y8G("workPackage",e.workPackage)}}class WorkPackageRelationsTabComponent extends r.p{constructor(e,t,n){super(),this.I18n=e,this.uiRouterGlobals=t,this.apiV3Service=n}ngOnInit(){const{workPackageId:e}=this.uiRouterGlobals.params;this.workPackageId=this.workPackage.id||e,this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe((e=>{this.workPackage=e}))}static{this.ɵfac=function WorkPackageRelationsTabComponent_Factory(e){return new(e||WorkPackageRelationsTabComponent)(a.rXU(o.W),a.rXU(i.ok),a.rXU(s.n))}}static{this.ɵcmp=a.VBU({type:WorkPackageRelationsTabComponent,selectors:[["wp-relations-tab"]],inputs:{workPackageId:"workPackageId",workPackage:"workPackage"},features:[a.Vt3],decls:1,vars:1,consts:[["class","detail-panel-description detail-panel--relations detail-panel--autocomplete-target",4,"ngIf"],[1,"detail-panel-description","detail-panel--relations","detail-panel--autocomplete-target"],[1,"detail-panel-description-content"],[3,"workPackage"]],template:function WorkPackageRelationsTabComponent_Template(e,t){1&e&&a.DNE(0,WorkPackageRelationsTabComponent_div_0_Template,3,1,"div",0),2&e&&a.Y8G("ngIf",t.workPackage)},dependencies:[l.bT,c.g],encapsulation:2})}}},201:(e,t,n)=>{"use strict";n.d(t,{P:()=>WorkPackageWatchersTabComponent});var i=n(83093),o=(n(68643),n(80366)),r=n(61816),s=n(33813),a=n(73014),l=n(55596),c=n(49349),p=n(99496),d=n(14593),u=n(88535),h=n(68559);const _c0=e=>({"-read-only":e});function WorkPackageWatchersTabComponent_div_1_Template(e,t){if(1&e&&(h.j41(0,"div",8)(1,"div",9),h.nrm(2,"p",10),h.k0s()()),2&e){const e=h.XpG();h.R7$(2),h.Y8G("textContent",e.text.loadingError)}}function WorkPackageWatchersTabComponent_op_wp_watcher_entry_4_Template(e,t){if(1&e&&h.nrm(0,"op-wp-watcher-entry",11),2&e){const e=t.$implicit;h.Y8G("watcher",e)}}class WorkPackageWatchersTabComponent extends p.p{constructor(e,t,n,i,o,r,s,a,c,p){super(),this.I18n=e,this.elementRef=t,this.wpWatchersService=n,this.uiRouterGlobals=i,this.notificationService=o,this.loadingIndicator=r,this.cdRef=s,this.pathHelper=a,this.apiV3Service=c,this.turboRequests=p,this.trackByHref=l.S0,this.error=!1,this.noResults=!1,this.allowedToView=!1,this.allowedToAdd=!1,this.allowedToRemove=!1,this.watching=[],this.text={loading:this.I18n.t("js.watchers.label_loading"),loadingError:this.I18n.t("js.watchers.label_error_loading"),autocomplete:{placeholder:this.I18n.t("js.watchers.typeahead_placeholder")}}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement);const{workPackageId:e}=this.uiRouterGlobals.params;this.workPackageId=this.workPackage.id||e,this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe((e=>{this.workPackage=e,this.loadCurrentWatchers()})),this.availableWatchersPath=this.apiV3Service.work_packages.id(this.workPackageId).available_watchers.path}loadCurrentWatchers(){this.error=!1,this.allowedToView=!!this.workPackage.watchers,this.allowedToAdd=!!this.workPackage.addWatcher,this.allowedToRemove=!!this.workPackage.removeWatcher,this.allowedToView?this.wpWatchersService.require(this.workPackage).then((e=>{this.watching=e,this.cdRef.detectChanges()})).catch((e=>{this.notificationService.showError(e,this.workPackage)})):this.error=!0}set loadingPromise(e){this.loadingIndicator.wpDetails.promise=e}addWatcher(e){this.loadingPromise=this.workPackage.addWatcher.$link.$fetch({user:{href:e.href}}).then((()=>{this.wpWatchersService.require(this.workPackage,!0),this.apiV3Service.work_packages.id(this.workPackage).refresh(),this.updateCounter(),this.cdRef.detectChanges()})).catch((e=>this.notificationService.showError(e,this.workPackage)))}removeWatcher(e){this.workPackage.removeWatcher.$link.$prepare({user_id:e.id})().then((()=>{_.remove(this.watching,(t=>t.href===e.href)),this.wpWatchersService.require(this.workPackage,!0),this.apiV3Service.work_packages.id(this.workPackage).refresh(),this.updateCounter(),this.cdRef.detectChanges()})).catch((e=>this.notificationService.showError(e,this.workPackage)))}updateCounter(){const e=this.pathHelper.workPackageUpdateCounterPath(this.workPackageId,"watchers");this.turboRequests.request(e)}static{this.ɵfac=function WorkPackageWatchersTabComponent_Factory(e){return new(e||WorkPackageWatchersTabComponent)(h.rXU(r.W),h.rXU(h.aKT),h.rXU(s.Q),h.rXU(i.ok),h.rXU(c.U),h.rXU(o.FX),h.rXU(h.gRc),h.rXU(a.B),h.rXU(d.n),h.rXU(u.W))}}static{this.ɵcmp=h.VBU({type:WorkPackageWatchersTabComponent,selectors:[["wp-watchers-tab"]],inputs:{workPackage:"workPackage"},features:[h.Vt3],decls:8,vars:10,consts:[["id","detail-panel-watchers"],["class","op-toast -error",4,"ngIf"],[3,"hidden"],[1,"work-package--watchers","form--selected-value--list",3,"ngClass"],[3,"watcher",4,"ngFor","ngForOf","ngForTrackBy"],[1,"work-package--watchers-lookup","hide-when-print",3,"hidden"],["name","watcherForm","novalidate",""],["appendTo","body",1,"wp-watcher--autocomplete",3,"change","url","resetOnChange"],[1,"op-toast","-error"],[1,"op-toast--content"],[3,"textContent"],[3,"watcher"]],template:function WorkPackageWatchersTabComponent_Template(e,t){1&e&&(h.j41(0,"div",0),h.DNE(1,WorkPackageWatchersTabComponent_div_1_Template,3,1,"div",1),h.j41(2,"div",2)(3,"div",3),h.DNE(4,WorkPackageWatchersTabComponent_op_wp_watcher_entry_4_Template,1,1,"op-wp-watcher-entry",4),h.k0s(),h.j41(5,"div",5)(6,"form",6)(7,"op-user-autocompleter",7),h.bIt("change",(function WorkPackageWatchersTabComponent_Template_op_user_autocompleter_change_7_listener(e){return t.addWatcher(e)})),h.k0s()()()()()),2&e&&(h.R7$(),h.Y8G("ngIf",t.error),h.R7$(),h.Y8G("hidden",t.error),h.R7$(),h.Y8G("ngClass",h.eq3(8,_c0,!t.allowedToRemove)),h.R7$(),h.Y8G("ngForOf",t.watching)("ngForTrackBy",t.trackByHref),h.R7$(),h.Y8G("hidden",!t.allowedToAdd),h.R7$(2),h.Y8G("url",t.availableWatchersPath)("resetOnChange",!0))},encapsulation:2,changeDetection:0})}}},33813:(e,t,n)=>{"use strict";n.d(t,{Q:()=>WorkPackageWatchersService});var i=n(62187),o=n(68559);class WorkPackageWatchersService extends i.${load(e){return e.watchers.$update().then((e=>e.elements))}static{this.ɵfac=(()=>{let e;return function WorkPackageWatchersService_Factory(t){return(e||(e=o.xGo(WorkPackageWatchersService)))(t||WorkPackageWatchersService)}})()}static{this.ɵprov=o.jDH({token:WorkPackageWatchersService,factory:WorkPackageWatchersService.ɵfac})}}},62187:(e,t,n)=>{"use strict";n.d(t,{$:()=>WorkPackageLinkedResourceCache});var i=n(47418),o=n(51567),r=n(70271),s=n(59452),a=n(56196);class WorkPackageLinkedResourceCache{constructor(){this.cacheDurationInSeconds=120,this.cache={id:null,state:(0,i.hF)()}}requireAndStream(e,t=!1){const n=e.id.toString(),{state:i}=this.cache;return(t||this.cache.id!==n)&&i.clear(),this.isCached(n)&&i.value?(0,s.of)(i.value.value):(this.isRequested(n)||(this.cache.id=n,this.cache.state.clearAndPutFromPromise(this.load(e).then((e=>({value:e,id:n}))))),this.cache.state.values$().pipe((0,o.p)((e=>e&&e.id===n)),(0,r.T)((e=>e.value))))}require(e,t=!1){return(0,a._)(this.requireAndStream(e,t))}clear(e){this.cache.id===e&&this.cache.state.clear()}isCached(e){const{state:t}=this.cache;return this.cache.id===e&&t.hasValue()&&!t.isValueOlderThan(1e3*this.cacheDurationInSeconds)}isRequested(e){const{state:t}=this.cache;return this.cache.id===e&&t.hasActivePromiseRequest()}}},68899:(e,t,n)=>{"use strict";n.d(t,{k:()=>WorkPackageSingleViewComponent});var i=n(83093),o=n(75797),r=n(19999),s=n(70271),a=n(91817),l=n(32037),c=n(61816),p=n(73014),d=(n(68643),n(51339)),u=n(39356),h=n(20045),m=n(65046),g=n(8655),f=n(36178),b=n(99496),k=n(86866),v=n(13432),C=n(44674),y=n(36819),w=n(75716),T=n(63894),S=n(66042),j=n(12313),P=n(97366),I=n(68559),x=n(60316),R=n(11385),F=n(2731),M=n(25827),O=n(8958),D=n(39176),G=n(63077),E=n(66557),A=n(72864),V=n(45085),$=n(73217);const _c0=e=>({"work-package--single-view_with-columns":e}),_c1=e=>({"-span-all-columns":e}),_c2=e=>({workPackage:e}),_c3=(e,t,n)=>({workPackage:e,group:t,query:n}),_c4=(e,t)=>({workPackage:e,group:t}),_c5=e=>({resource:e});function WorkPackageSingleViewComponent_div_0_div_1_Template(e,t){if(1&e&&(I.j41(0,"div",16),I.nrm(1,"op-editable-attribute-field",17),I.k0s()),2&e){const e=I.XpG(2);I.R7$(),I.Y8G("resource",e.workPackage)("wrapperClasses","-no-label")("fieldName","subject")}}function WorkPackageSingleViewComponent_div_0_wp_status_button_3_Template(e,t){if(1&e&&I.nrm(0,"wp-status-button",18),2&e){const e=I.XpG(2);I.Y8G("workPackage",e.workPackage)}}function WorkPackageSingleViewComponent_div_0_attribute_help_text_4_Template(e,t){1&e&&I.nrm(0,"attribute-help-text",19),2&e&&I.Y8G("attribute","status")("attributeScope","WorkPackage")}function WorkPackageSingleViewComponent_div_0_div_5_Template(e,t){if(1&e&&(I.j41(0,"div",20),I.nrm(1,"span",21),I.EFF(2,": "),I.nrm(3,"span",21),I.j41(4,"span"),I.EFF(5," "),I.k0s(),I.nrm(6,"op-user-link",22),I.j41(7,"span"),I.EFF(8,". "),I.k0s(),I.nrm(9,"span",21),I.j41(10,"span"),I.EFF(11," "),I.k0s(),I.nrm(12,"op-date-time",23),I.j41(13,"span"),I.EFF(14,"."),I.k0s()()),2&e){const e=I.XpG(2);I.R7$(),I.Y8G("textContent",e.idLabel),I.R7$(2),I.Y8G("textContent",e.text.infoRow.createdBy),I.R7$(3),I.Y8G("user",e.workPackage.author),I.R7$(3),I.Y8G("textContent",e.text.infoRow.lastUpdatedOn),I.R7$(3),I.Y8G("dateTimeValue",e.workPackage.updatedAt)}}function WorkPackageSingleViewComponent_div_0_div_7_div_3_span_4_Template(e,t){1&e&&(I.j41(0,"span",33),I.EFF(1,"*"),I.k0s())}function WorkPackageSingleViewComponent_div_0_div_7_div_3_Template(e,t){if(1&e&&(I.j41(0,"div",27)(1,"div",28)(2,"wp-replacement-label",29),I.EFF(3),I.DNE(4,WorkPackageSingleViewComponent_div_0_div_7_div_3_span_4_Template,2,0,"span",30),I.k0s(),I.nrm(5,"attribute-help-text",19),I.k0s(),I.j41(6,"div",31),I.nrm(7,"op-editable-attribute-field",32),I.k0s()()),2&e){const e=t.$implicit,n=I.XpG(3);I.Y8G("ngClass",I.eq3(8,_c1,e.spanAll)),I.R7$(2),I.Y8G("fieldName",e.name),I.R7$(),I.SpI(" ",e.label," "),I.R7$(),I.Y8G("ngIf",e.field.required&&e.field.writable),I.R7$(),I.Y8G("attribute",e.name)("attributeScope","WorkPackage"),I.R7$(2),I.Y8G("resource",n.workPackage)("fieldName",e.name)}}function WorkPackageSingleViewComponent_div_0_div_7_Template(e,t){if(1&e&&(I.j41(0,"div",24)(1,"div"),I.nrm(2,"p",25),I.DNE(3,WorkPackageSingleViewComponent_div_0_div_7_div_3_Template,8,10,"div",26),I.k0s()()),2&e){const e=I.XpG(2);I.R7$(2),I.Y8G("textContent",e.text.project.required),I.R7$(),I.Y8G("ngForOf",e.projectContext.field)("ngForTrackBy",e.trackByName)}}function WorkPackageSingleViewComponent_div_0_div_8_Template(e,t){if(1&e&&(I.j41(0,"div",34)(1,"div"),I.nrm(2,"span",35),I.k0s()()),2&e){const e=I.XpG(2);I.R7$(2),I.Y8G("innerHTML",e.switchToProjectText,I.npT)}}function WorkPackageSingleViewComponent_div_0_ng_container_9_Template(e,t){if(1&e&&(I.qex(0),I.nrm(1,"ndc-dynamic",36),I.bVm()),2&e){const e=t.$implicit,n=I.XpG(2);I.R7$(),I.Y8G("ndcDynamicComponent",e)("ndcDynamicInputs",I.eq3(2,_c2,n.workPackage))}}function WorkPackageSingleViewComponent_div_0_div_13_ng_container_1_Template(e,t){if(1&e&&(I.qex(0,40),I.nrm(1,"ndc-dynamic",36),I.bVm()),2&e){const e=I.XpG().$implicit,t=I.XpG(2);I.R7$(),I.Y8G("ndcDynamicComponent",t.attributeGroupComponent(e))("ndcDynamicInputs",I.sMw(2,_c3,t.workPackage,e,e.query))}}function WorkPackageSingleViewComponent_div_0_div_13_ng_container_2_Template(e,t){if(1&e&&(I.qex(0),I.j41(1,"div",41)(2,"div",42),I.nrm(3,"h3",43),I.k0s()(),I.nrm(4,"ndc-dynamic",44),I.bVm()),2&e){const e=I.XpG().$implicit,t=I.XpG(2);I.R7$(3),I.Y8G("textContent",e.name),I.R7$(),I.Y8G("ndcDynamicComponent",t.attributeGroupComponent(e))("ndcDynamicInjector",t.injector)("ndcDynamicInputs",I.l_i(4,_c4,t.workPackage,e))}}function WorkPackageSingleViewComponent_div_0_div_13_Template(e,t){if(1&e&&(I.j41(0,"div",37),I.DNE(1,WorkPackageSingleViewComponent_div_0_div_13_ng_container_1_Template,2,6,"ng-container",38)(2,WorkPackageSingleViewComponent_div_0_div_13_ng_container_2_Template,5,7,"ng-container",39),I.k0s()),2&e){const e=t.$implicit,n=I.XpG(2);I.Y8G("hidden",n.shouldHideGroup(e))("ngClass","__overflowing_"+e.id),I.BMQ("data-group-name",e.name)("data-overflowing-identifier",".__overflowing_"+e.id),I.R7$(),I.Y8G("ngIf",e.isolated),I.R7$(),I.Y8G("ngIf",!e.isolated)}}function WorkPackageSingleViewComponent_div_0_Template(e,t){if(1&e&&(I.j41(0,"div",2),I.DNE(1,WorkPackageSingleViewComponent_div_0_div_1_Template,2,3,"div",3),I.j41(2,"div",4),I.DNE(3,WorkPackageSingleViewComponent_div_0_wp_status_button_3_Template,1,1,"wp-status-button",5)(4,WorkPackageSingleViewComponent_div_0_attribute_help_text_4_Template,1,2,"attribute-help-text",6)(5,WorkPackageSingleViewComponent_div_0_div_5_Template,15,5,"div",7),I.nrm(6,"wp-custom-actions",8),I.k0s(),I.DNE(7,WorkPackageSingleViewComponent_div_0_div_7_Template,4,3,"div",9)(8,WorkPackageSingleViewComponent_div_0_div_8_Template,3,1,"div",10)(9,WorkPackageSingleViewComponent_div_0_ng_container_9_Template,2,4,"ng-container",11),I.j41(10,"div",12)(11,"div",13),I.nrm(12,"op-editable-attribute-field",14),I.k0s()(),I.DNE(13,WorkPackageSingleViewComponent_div_0_div_13_Template,3,6,"div",15),I.k0s()),2&e){const e=I.XpG();I.Y8G("ngClass",I.eq3(15,_c0,e.showTwoColumnLayout())),I.R7$(),I.Y8G("ngIf",e.isNewResource),I.R7$(2),I.Y8G("ngIf",!e.isNewResource),I.R7$(),I.Y8G("ngIf",!e.isNewResource),I.R7$(),I.Y8G("ngIf",!e.isNewResource),I.R7$(),I.Y8G("workPackage",e.workPackage),I.R7$(),I.Y8G("ngIf",e.projectContext&&e.projectContext.field),I.R7$(),I.Y8G("ngIf",e.showSwitchToProjectBanner()),I.R7$(),I.Y8G("ngForOf",e.prependedAttributeGroupComponents()),I.R7$(3),I.Y8G("fieldName","description")("resource",e.workPackage)("isDropTarget",!0)("wrapperClasses","-no-label"),I.R7$(),I.Y8G("ngForOf",e.groupedFields)("ngForTrackBy",e.trackByName)}}function WorkPackageSingleViewComponent_div_1_div_1_ndc_dynamic_4_Template(e,t){if(1&e&&I.nrm(0,"ndc-dynamic",36),2&e){const e=I.XpG(3);I.Y8G("ndcDynamicComponent",e.attachmentUploadComponent())("ndcDynamicInputs",I.eq3(2,_c5,e.workPackage))}}function WorkPackageSingleViewComponent_div_1_div_1_Template(e,t){if(1&e&&(I.j41(0,"div")(1,"div",47),I.nrm(2,"span",48),I.k0s(),I.nrm(3,"ndc-dynamic",36),I.DNE(4,WorkPackageSingleViewComponent_div_1_div_1_ndc_dynamic_4_Template,1,4,"ndc-dynamic",49),I.k0s()),2&e){const e=I.XpG(2);I.R7$(2),I.Y8G("textContent",e.text.attachments.label),I.R7$(),I.Y8G("ndcDynamicComponent",e.attachmentListComponent())("ndcDynamicInputs",I.eq3(4,_c5,e.workPackage)),I.R7$(),I.Y8G("ngIf",e.workPackage.canAddAttachments)}}function WorkPackageSingleViewComponent_div_1_op_storage_2_Template(e,t){if(1&e&&I.nrm(0,"op-storage",50),2&e){const e=t.$implicit,n=I.XpG(2);I.Y8G("resource",n.workPackage)("projectStorage",e)("allowLinking",!0)("allowUploading",!0)}}function WorkPackageSingleViewComponent_div_1_Template(e,t){if(1&e&&(I.j41(0,"div",45),I.DNE(1,WorkPackageSingleViewComponent_div_1_div_1_Template,5,6,"div",39)(2,WorkPackageSingleViewComponent_div_1_op_storage_2_Template,1,4,"op-storage",46),I.nI1(3,"async"),I.k0s()),2&e){const e=I.XpG();I.R7$(),I.Y8G("ngIf",e.workPackage.$links.attachments),I.R7$(),I.Y8G("ngForOf",I.bMT(3,2,e.projectStorages))}}class WorkPackageSingleViewComponent extends b.p{constructor(e,t,n,i,r,s,a,l,c,p,d,u,h,m,g,_){super(),this.injector=e,this.states=t,this.I18n=n,this.hook=i,this.$state=r,this.elementRef=s,this.cdRef=a,this.PathHelper=l,this.schemaCache=c,this.currentProject=p,this.halEditing=d,this.halResourceService=u,this.currentUserService=h,this.displayFieldService=m,this.projectsResourceService=g,this.projectStoragesService=_,this.showProject=!1,this.groupedFields=[],this.text={attachments:{label:this.I18n.t("js.label_attachments")},files:{label:this.I18n.t("js.work_packages.tabs.files")},project:{required:this.I18n.t("js.project.required_outside_context")},fields:{description:this.I18n.t("js.work_packages.properties.description")},infoRow:{createdBy:this.I18n.t("js.label_created_by"),lastUpdatedOn:this.I18n.t("js.label_last_updated_on")}},this.projectStorages=new o.t([])}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.isNewResource=(0,P.A)(this.workPackage),this.uiSelfRef=this.$state.$current.name;const e=this.halEditing.changeFor(this.workPackage);this.refresh(e),this.halEditing.temporaryEditResource(this.workPackage).values$().pipe(this.untilDestroyed(),(0,s.T)((e=>this.contextFrom(e))),(0,a.F)(((e,t)=>_.isEqual(e,t))),(0,s.T)((()=>this.halEditing.changeFor(this.workPackage)))).subscribe((e=>this.refresh(e)))}refresh(e){const t=e.projectedResource;if(t.project){const e=t.project,n=this.workPackage.id;if(!n)throw new Error("work package id is invalid");this.projectContext={id:e.id,href:this.PathHelper.projectWorkPackagePath(e.id,n),matches:e.href===this.currentProject.apiv3Path}}else this.projectContext={matches:!1,href:null,id:null};(0,P.A)(t)&&this.updateWorkPackageCreationState(e),this.groupedFields=this.rebuildGroupedFields(e,this.schema(t)._attributeGroups),this.cdRef.detectChanges()}updateWorkPackageCreationState(e){const t=e.projectedResource;if(this.currentProject.inProjectContext||(this.projectContext.field=this.getFields(e,["project"]),this.workPackage.project=t.project),null===t.project)this.projectStorages.next([]);else{const e=t.project;(0,r.z)([this.projectsResourceService.requireEntity(e.href),this.projectStoragesService.requireCollection({filters:[["projectId","=",[e.id]]]}),this.currentUserService.hasCapabilities$("file_links/manage",e.id)]).pipe((0,s.T)((([e,t,n])=>e._links.storages&&n?t:[])),(0,l.$)()).subscribe((e=>{this.projectStorages.next(e)}))}}shouldHideGroup(e){const t=0===e.members.length,n=(0,P.A)(this.workPackage)&&!!e.query;return t||n}trackByName(e,t){return t.name}prependedAttributeGroupComponents(){return this.hook.call("prependedAttributeGroups",this.workPackage)}attributeGroupComponent(e){return this.hook.call("attributeGroupComponent",e,this.workPackage).pop()||null}attachmentListComponent(){return this.hook.call("workPackageAttachmentListComponent",this.workPackage).pop()||null}attachmentUploadComponent(){return this.hook.call("workPackageAttachmentUploadComponent",this.workPackage).pop()||null}get idLabel(){return`#${this.workPackage.id||""}`}showSwitchToProjectBanner(){return!this.isNewResource&&this.projectContext&&!this.projectContext.matches}get switchToProjectText(){const e=(0,j.A)(this.workPackage.project.href),t=`<a href="${this.PathHelper.projectPath(e)}" class="project-context--switch-link">${this.workPackage.project.name}<a>`;return this.I18n.t("js.project.click_to_switch_to_project",{projectname:t})}showTwoColumnLayout(){return this.$element[0].getBoundingClientRect().width>750}rebuildGroupedFields(e,t){return t?t.map((t=>{const n=this.getAttributesGroupId(t);return"WorkPackageFormAttributeGroup"===t._type?{name:t.name,id:n||(0,g.D)(16),members:this.getFields(e,t.attributes),type:t._type,isolated:!1}:{name:t.name,id:n||(0,g.D)(16),query:this.halResourceService.createHalResourceOfClass(h.X,t._embedded.query),relationType:t.relationType,members:[t._embedded.query],type:t._type,isolated:!0}})):[]}getFields(e,t){const n=[];return t.forEach((t=>{if("date"===t)return void n.push(this.getDateField(e));if(!e.schema.ofProperty(t))return void(0,y.cY)("Unknown field for current schema",t);const i=this.displayField(e,t);n.push({name:t,label:i.label,multiple:!1,spanAll:i.isFormattable,field:i})})),n}getDateField(e){const t={name:"date",label:this.I18n.t("js.work_packages.properties.date"),spanAll:!1,multiple:!1};return e.schema.ofProperty("date")?t.field=this.displayField(e,"date"):t.field=this.displayField(e,"combinedDate"),t}contextFrom(e){const t=this.schema(e);let n;const i=e.project&&e.project.href;return n=t.baseSchema?t.baseSchema.href:t.href,{isNew:e.isNew,schema:n,project:i}}displayField(e,t){return this.displayFieldService.getField(e.projectedResource,t,e.schema.ofProperty(t),{container:"single-view",injector:this.injector,options:{}})}getAttributesGroupId(e){const t=this.$element.find(`[data-group-name='${e.name}']`).data("overflowingIdentifier");return t?t.replace(".__overflowing_",""):""}schema(e){return this.halEditing.typedState(e).hasValue()?this.halEditing.typedState(this.workPackage).value.schema:this.schemaCache.of(e)}static{this.ɵfac=function WorkPackageSingleViewComponent_Factory(e){return new(e||WorkPackageSingleViewComponent)(I.rXU(I.zZn),I.rXU(v.D),I.rXU(c.W),I.rXU(m.R),I.rXU(i.dw),I.rXU(I.aKT),I.rXU(I.gRc),I.rXU(p.B),I.rXU(C.D),I.rXU(k.c),I.rXU(d.p),I.rXU(f.t),I.rXU(T.K),I.rXU(u.w),I.rXU(w.s),I.rXU(S.z))}}static{this.ɵcmp=I.VBU({type:WorkPackageSingleViewComponent,selectors:[["wp-single-view"]],inputs:{workPackage:"workPackage",showProject:"showProject"},features:[I.Vt3],decls:2,vars:2,consts:[["class","work-package--single-view","data-selector","wp-single-view",3,"ngClass",4,"ngIf"],["class","work-packages--storages",4,"ngIf"],["data-selector","wp-single-view",1,"work-package--single-view",3,"ngClass"],["class","wp-new--subject-wrapper",4,"ngIf"],[1,"wp-info-wrapper"],[3,"workPackage",4,"ngIf"],[3,"attribute","attributeScope",4,"ngIf"],["class","work-packages--info-row",4,"ngIf"],[1,"custom-actions",3,"workPackage"],["class","attributes-group -project-context __overflowing_element_container __overflowing_project_context","data-overflowing-identifier",".__overflowing_project_context",4,"ngIf"],["class","attributes-group -project-context hide-when-print",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"attributes-group","description-group"],[1,"single-attribute","work-packages--details--description"],[3,"fieldName","resource","isDropTarget","wrapperClasses"],["class","attributes-group __overflowing_element_container",3,"hidden","ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"wp-new--subject-wrapper"],[3,"resource","wrapperClasses","fieldName"],[3,"workPackage"],[3,"attribute","attributeScope"],[1,"work-packages--info-row"],[3,"textContent"],[1,"user-link",3,"user"],[3,"dateTimeValue"],["data-overflowing-identifier",".__overflowing_project_context",1,"attributes-group","-project-context","__overflowing_element_container","__overflowing_project_context"],[1,"wp-project-context--warning",3,"textContent"],["class","attributes-key-value",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"attributes-key-value",3,"ngClass"],[1,"attributes-key-value--key"],[3,"fieldName"],["class","required",4,"ngIf"],[1,"attributes-key-value--value-container"],[3,"resource","fieldName"],[1,"required"],[1,"attributes-group","-project-context","hide-when-print"],[3,"innerHTML"],[3,"ndcDynamicComponent","ndcDynamicInputs"],[1,"attributes-group","__overflowing_element_container",3,"hidden","ngClass"],["opWorkPackageIsolatedQuerySpace","",4,"ngIf"],[4,"ngIf"],["opWorkPackageIsolatedQuerySpace",""],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],[3,"ndcDynamicComponent","ndcDynamicInjector","ndcDynamicInputs"],[1,"work-packages--storages"],[3,"resource","projectStorage","allowLinking","allowUploading",4,"ngFor","ngForOf"],[1,"op-tab-content--header"],[1,"op-tab-content--header-text",3,"textContent"],[3,"ndcDynamicComponent","ndcDynamicInputs",4,"ngIf"],[3,"resource","projectStorage","allowLinking","allowUploading"]],template:function WorkPackageSingleViewComponent_Template(e,t){1&e&&I.DNE(0,WorkPackageSingleViewComponent_div_0_Template,14,17,"div",0)(1,WorkPackageSingleViewComponent_div_1_Template,4,4,"div",1),2&e&&(I.Y8G("ngIf",t.workPackage),I.R7$(),I.Y8G("ngIf",t.isNewResource))},dependencies:[x.YU,x.Sq,x.bT,R.e,F.U,M.Bf,M.dE,O.c,D.P,G.Y,E.n,A.h,V.F,$.p,x.Jj],encapsulation:2,changeDetection:0})}}},22079:(e,t,n)=>{"use strict";n.d(t,{J:()=>WorkPackageSubjectComponent});var i=n(83093),o=(n(68643),n(8655)),r=n(99496),s=n(14593),a=n(68559),l=n(60316),c=n(8958);function WorkPackageSubjectComponent_div_0_Template(e,t){if(1&e&&(a.j41(0,"div",1)(1,"div",2),a.nrm(2,"op-editable-attribute-field",3),a.k0s(),a.j41(3,"div",4),a.nrm(4,"op-editable-attribute-field",3),a.k0s()()),2&e){const e=a.XpG();a.Y8G("ngClass","__overflowing_"+e.uniqueElementIdentifier),a.BMQ("data-overflowing-identifier",".__overflowing_"+e.uniqueElementIdentifier),a.R7$(2),a.Y8G("resource",e.workPackage)("wrapperClasses","work-packages--type-selector work-packages--subject-element -no-label")("fieldName","type"),a.R7$(2),a.Y8G("resource",e.workPackage)("wrapperClasses","work-packages--details--subject work-packages--subject-element -no-label")("fieldName","subject")}}class WorkPackageSubjectComponent extends r.p{constructor(e,t){super(),this.uiRouterGlobals=e,this.apiV3Service=t,this.uniqueElementIdentifier=`work-packages--subject-type-row-${(0,o.D)(16)}`}ngOnInit(){this.workPackage||this.apiV3Service.work_packages.id(this.uiRouterGlobals.params.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe((e=>{this.workPackage=e}))}static{this.ɵfac=function WorkPackageSubjectComponent_Factory(e){return new(e||WorkPackageSubjectComponent)(a.rXU(i.ok),a.rXU(s.n))}}static{this.ɵcmp=a.VBU({type:WorkPackageSubjectComponent,selectors:[["wp-subject"]],inputs:{workPackage:"workPackage"},features:[a.Vt3],decls:1,vars:1,consts:[["class","work-packages--subject-type-row __overflowing_element_container",3,"ngClass",4,"ngIf"],[1,"work-packages--subject-type-row","__overflowing_element_container",3,"ngClass"],[1,"work-packages--type-selector","work-packages--subject-element"],[3,"resource","wrapperClasses","fieldName"],[1,"work-packages--details--subject","work-packages--subject-element"]],template:function WorkPackageSubjectComponent_Template(e,t){1&e&&a.DNE(0,WorkPackageSubjectComponent_div_0_Template,5,8,"div",0),2&e&&a.Y8G("ngIf",t.workPackage)},dependencies:[l.YU,l.bT,c.c],encapsulation:2})}}},21449:(e,t,n)=>{"use strict";n.d(t,{z:()=>TabPortalOutlet});var i=n(9168);class TabPortalOutlet{constructor(e,t,n,i,o){this.availableTabs=e,this.outletElement=t,this.componentFactoryResolver=n,this.appRef=i,this.injector=o,this.activeTabs={},this.currentTab=null}get activeComponents(){return _.values(this.activeTabs).map((e=>e.componentRef.instance))}switchTo(e){if(void 0!==e.disable)return;this.detach();const t=this.activateInstance(e);this.outletElement.innerHTML="",this.outletElement.appendChild(this._getComponentRootNode(t.componentRef)),this.outletElement.dataset.tabName=e.name,this.currentTab=t}detach(){const e=this.currentTab;null!==e&&(e.portal.setAttachedHost(null),this.currentTab=null)}dispose(){_.each(this.activeTabs,(e=>e.dispose())),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}activateInstance(e){return this.activeTabs[e.name]||(this.activeTabs[e.name]=this.createComponent(e)),this.activeTabs[e.name]||null}createComponent(e){const t=this.componentFactoryResolver.resolveComponentFactory(e.componentClass).create(this.injector),n=new i.A8(e.componentClass,null,this.injector);return this.appRef.attachView(t.hostView),{...e,portal:n,componentRef:t,dispose:()=>{this.appRef.detachView(t.hostView),t.destroy()}}}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}},79880:(e,t,n)=>{"use strict";n.d(t,{V:()=>WpTableConfigurationColumnsTabComponent});var i=n(61816),o=n(88352),r=n(99972),s=n(38941),a=n(68559),l=n(60316),c=n(66094),p=n(35321);function WpTableConfigurationColumnsTabComponent_op_enterprise_banner_2_Template(e,t){if(1&e&&a.nrm(0,"op-enterprise-banner",3),2&e){const e=a.XpG();a.Y8G("linkMessage",e.text.upsaleCheckOutLink)("textMessage",e.text.upsaleRelationColumns)("moreInfoLink",e.text.moreInfoLink)}}class WpTableConfigurationColumnsTabComponent{constructor(e,t,n,i){this.injector=e,this.I18n=t,this.wpTableColumns=n,this.bannerService=i,this.availableColumnsOptions=this.wpTableColumns.all.map((e=>this.column2Like(e))),this.availableColumns=this.wpTableColumns.all,this.availableColumnsMap=_.keyBy(this.availableColumns,(e=>e.id)),this.selectedColumns=this.wpTableColumns.getColumns().map((e=>this.column2Like(e))),this.selectedColumnMap={},this.eeShowBanners=!1,this.text={columnsHelp:this.I18n.t("js.work_packages.table_configuration.columns_help_text"),columnsLabel:this.I18n.t("js.label_columns"),multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect"),upsaleRelationColumns:this.I18n.t("js.work_packages.table_configuration.upsale.relation_columns"),upsaleCheckOutLink:this.I18n.t("js.work_packages.table_configuration.upsale.check_out_link"),moreInfoLink:s.y$.website,inputPlaceholder:this.I18n.t("js.label_search_columns"),inputLabel:this.I18n.t("js.label_add_columns"),inputDragLabel:this.I18n.t("js.label_manage_columns")}}onSave(){this.wpTableColumns.setColumnsById(this.selectedColumns.map((e=>e.id)))}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners,this.selectedColumns.forEach((e=>{this.selectedColumnMap[e.id]=!0}))}column2Like(e){return{id:e.id,name:e.name}}updateSelected(e){this.selectedColumns=e}static{this.ɵfac=function WpTableConfigurationColumnsTabComponent_Factory(e){return new(e||WpTableConfigurationColumnsTabComponent)(a.rXU(a.zZn),a.rXU(i.W),a.rXU(o.T),a.rXU(r.b))}}static{this.ɵcmp=a.VBU({type:WpTableConfigurationColumnsTabComponent,selectors:[["ng-component"]],decls:3,vars:7,consts:[[1,"columns-modal--content"],[3,"onChange","options","selected","inputLabel","inputPlaceholder","dragAreaLabel","id"],["class","ee-relation-columns-upsale","opReferrer","wp-list-columns#relations",3,"linkMessage","textMessage","moreInfoLink",4,"ngIf"],["opReferrer","wp-list-columns#relations",1,"ee-relation-columns-upsale",3,"linkMessage","textMessage","moreInfoLink"]],template:function WpTableConfigurationColumnsTabComponent_Template(e,t){1&e&&(a.j41(0,"div",0)(1,"op-draggable-autocompleter",1),a.bIt("onChange",(function WpTableConfigurationColumnsTabComponent_Template_op_draggable_autocompleter_onChange_1_listener(e){return t.updateSelected(e)})),a.k0s()(),a.DNE(2,WpTableConfigurationColumnsTabComponent_op_enterprise_banner_2_Template,1,3,"op-enterprise-banner",2)),2&e&&(a.R7$(),a.Y8G("options",t.availableColumnsOptions)("selected",t.selectedColumns)("inputLabel",t.text.inputLabel)("inputPlaceholder",t.text.inputPlaceholder)("dragAreaLabel",t.text.inputDragLabel)("id","columns-select"),a.R7$(),a.Y8G("ngIf",t.eeShowBanners))},dependencies:[l.bT,c.L,p.l],encapsulation:2})}}},58997:(e,t,n)=>{"use strict";n.d(t,{R:()=>WpTableConfigurationDisplaySettingsTabComponent});var i=n(61816),o=n(1750),r=n(94450),s=n(55332),a=n(68559),l=n(60316),c=n(34456),p=n(93855);function WpTableConfigurationDisplaySettingsTabComponent_span_16_Template(e,t){if(1&e&&a.nrm(0,"span",6),2&e){const e=a.XpG();a.Y8G("textContent",e.text.display_mode.hierarchy_hint)}}function WpTableConfigurationDisplaySettingsTabComponent_option_24_Template(e,t){if(1&e&&a.nrm(0,"option",15),2&e){const e=t.$implicit,n=a.XpG();a.Y8G("textContent",e.name)("selected",n.currentGroup&&n.currentGroup.href===e.href)("value",e.href)}}class WpTableConfigurationDisplaySettingsTabComponent{constructor(e,t,n,i,o){this.injector=e,this.I18n=t,this.wpTableGroupBy=n,this.wpTableHierarchies=i,this.wpTableSums=o,this.displayMode="default",this.availableGroups=[],this.displaySums=!1,this.text={choose_mode:this.I18n.t("js.work_packages.table_configuration.choose_display_mode"),label_group_by:this.I18n.t("js.label_group_by"),title:this.I18n.t("js.label_group_by"),placeholder:this.I18n.t("js.placeholders.default"),please_select:this.I18n.t("js.placeholders.selection"),default:`— ${this.I18n.t("js.work_packages.table_configuration.default")}`,display_sums:this.I18n.t("js.work_packages.query.display_sums"),display_sums_hint:`— ${this.I18n.t("js.work_packages.table_configuration.display_sums_hint")}`,display_mode:{default:this.I18n.t("js.work_packages.table_configuration.default_mode"),grouped:this.I18n.t("js.work_packages.table_configuration.grouped_mode"),hierarchy:this.I18n.t("js.work_packages.table_configuration.hierarchy_mode"),hierarchy_hint:`— ${this.I18n.t("js.work_packages.table_configuration.hierarchy_hint")}`}}}onSave(){this.wpTableHierarchies.setEnabled("hierarchy"===this.displayMode);const e="grouped"===this.displayMode?this.currentGroup:null;this.wpTableGroupBy.update(e),this.wpTableSums.setEnabled(this.displaySums)}updateGroup(e){this.displayMode="grouped",this.currentGroup=_.find(this.availableGroups,(t=>t.href===e))||null}ngOnInit(){this.wpTableHierarchies.isEnabled?this.displayMode="hierarchy":this.wpTableGroupBy.current&&(this.displayMode="grouped"),this.displaySums=this.wpTableSums.current,this.wpTableGroupBy.onReady().then((()=>{this.availableGroups=_.sortBy(this.wpTableGroupBy.available,"name"),this.currentGroup=this.wpTableGroupBy.current||this.availableGroups[0]}))}static{this.ɵfac=function WpTableConfigurationDisplaySettingsTabComponent_Factory(e){return new(e||WpTableConfigurationDisplaySettingsTabComponent)(a.rXU(a.zZn),a.rXU(i.W),a.rXU(o.W),a.rXU(r.j),a.rXU(s.X))}}static{this.ɵcmp=a.VBU({type:WpTableConfigurationDisplaySettingsTabComponent,selectors:[["op-wp-table-configuration-settings-tab"]],decls:33,vars:16,consts:[[3,"textContent"],[1,"form--field","-full-width"],[1,"form--field-container"],[1,"option-label"],["type","radio","value","default","name","display_mode_switch",3,"ngModelChange","ngModel"],["op-no-hierarchy-icon","","size","small"],[1,"form--inline-instructions",3,"textContent"],["type","radio","value","hierarchy","name","display_mode_switch",3,"ngModelChange","ngModel"],["op-hierarchy-icon","","size","small"],["class","form--inline-instructions",3,"textContent",4,"ngIf"],["type","radio","value","grouped","name","display_mode_switch",3,"ngModelChange","ngModel"],["op-group-icon","","size","small"],["id","selected_grouping","name","selected_grouping",1,"form--select","form--inline-select","option-label--select",3,"change"],[3,"textContent","selected","value",4,"ngFor","ngForOf"],["type","checkbox","name","display_sums_switch",3,"change","checked"],[3,"textContent","selected","value"]],template:function WpTableConfigurationDisplaySettingsTabComponent_Template(e,t){1&e&&(a.j41(0,"div")(1,"form"),a.nrm(2,"p",0),a.j41(3,"div",1)(4,"div",2)(5,"label",3)(6,"input",4),a.mxI("ngModelChange",(function WpTableConfigurationDisplaySettingsTabComponent_Template_input_ngModelChange_6_listener(e){return a.DH7(t.displayMode,e)||(t.displayMode=e),e})),a.k0s(),a.qSk(),a.nrm(7,"svg",5),a.joV(),a.nrm(8,"span",0)(9,"span",6),a.k0s()()(),a.j41(10,"div",1)(11,"div",2)(12,"label",3)(13,"input",7),a.mxI("ngModelChange",(function WpTableConfigurationDisplaySettingsTabComponent_Template_input_ngModelChange_13_listener(e){return a.DH7(t.displayMode,e)||(t.displayMode=e),e})),a.k0s(),a.qSk(),a.nrm(14,"svg",8),a.joV(),a.nrm(15,"span",0),a.DNE(16,WpTableConfigurationDisplaySettingsTabComponent_span_16_Template,1,1,"span",9),a.k0s()()(),a.j41(17,"div",1)(18,"div",2)(19,"label",3)(20,"input",10),a.mxI("ngModelChange",(function WpTableConfigurationDisplaySettingsTabComponent_Template_input_ngModelChange_20_listener(e){return a.DH7(t.displayMode,e)||(t.displayMode=e),e})),a.k0s(),a.qSk(),a.nrm(21,"svg",11),a.joV(),a.nrm(22,"span",0),a.j41(23,"select",12),a.bIt("change",(function WpTableConfigurationDisplaySettingsTabComponent_Template_select_change_23_listener(e){return t.updateGroup(e.target.value)})),a.DNE(24,WpTableConfigurationDisplaySettingsTabComponent_option_24_Template,1,3,"option",13),a.k0s()()()(),a.nrm(25,"hr"),a.j41(26,"div")(27,"div",1)(28,"div",2)(29,"label",3)(30,"input",14),a.bIt("change",(function WpTableConfigurationDisplaySettingsTabComponent_Template_input_change_30_listener(){return t.displaySums=!t.displaySums})),a.k0s(),a.EFF(31),a.nrm(32,"span",6),a.k0s()()()()()()),2&e&&(a.R7$(2),a.Y8G("textContent",t.text.choose_mode),a.R7$(4),a.R50("ngModel",t.displayMode),a.R7$(),a.BMQ("icon-title",t.text.display_mode.default),a.R7$(),a.Y8G("textContent",t.text.display_mode.default),a.R7$(),a.Y8G("textContent",t.text.default),a.R7$(4),a.R50("ngModel",t.displayMode),a.R7$(),a.BMQ("icon-title",t.text.display_mode.hierarchy),a.R7$(),a.Y8G("textContent",t.text.display_mode.hierarchy),a.R7$(),a.Y8G("ngIf","hierarchy"===t.displayMode),a.R7$(4),a.R50("ngModel",t.displayMode),a.R7$(),a.BMQ("icon-title",t.text.label_group_by),a.R7$(),a.Y8G("textContent",t.text.label_group_by),a.R7$(2),a.Y8G("ngForOf",t.availableGroups),a.R7$(6),a.Y8G("checked",t.displaySums),a.R7$(),a.SpI(" ",t.text.display_sums," "),a.R7$(),a.Y8G("textContent",t.text.display_sums_hint))},dependencies:[l.Sq,l.bT,c.qT,c.xH,c.y7,c.me,c.Fm,c.BC,c.cb,c.vS,c.cV,p.hvu,p.xTw,p._wq],encapsulation:2})}}},59716:(e,t,n)=>{"use strict";n.d(t,{S:()=>WpTableConfigurationFiltersTab});var i=n(61816),o=n(12717),r=n(34120),s=n(99972),a=n(68559),l=n(60316),c=n(37313);function WpTableConfigurationFiltersTab_op_query_filters_0_Template(e,t){if(1&e){const e=a.RV6();a.j41(0,"op-query-filters",1),a.bIt("filtersChanged",(function WpTableConfigurationFiltersTab_op_query_filters_0_Template_op_query_filters_filtersChanged_0_listener(t){a.eBV(e);const n=a.XpG();return a.Njj(n.filters=t)})),a.k0s()}if(2&e){const e=a.XpG();a.Y8G("filters",e.filters)}}class WpTableConfigurationFiltersTab{constructor(e,t,n,i,o){this.injector=e,this.I18n=t,this.wpTableFilters=n,this.wpFiltersService=i,this.bannerService=o,this.filters=[],this.eeShowBanners=!1,this.text={columnsLabel:this.I18n.t("js.label_columns"),selectedColumns:this.I18n.t("js.description_selected_columns"),multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect"),upsaleRelationColumns:this.I18n.t("js.modals.upsale_relation_columns"),upsaleRelationColumnsLink:this.I18n.t("js.modals.upsale_relation_columns_link")}}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners,this.wpTableFilters.onReady().then((()=>this.filters=this.wpTableFilters.current)),this.wpTableFilters.changes$().subscribe((e=>{this.filters=this.wpTableFilters.current}))}onSave(){this.filters&&this.wpTableFilters.replaceIfComplete(this.filters)}static{this.ɵfac=function WpTableConfigurationFiltersTab_Factory(e){return new(e||WpTableConfigurationFiltersTab)(a.rXU(a.zZn),a.rXU(i.W),a.rXU(r.N),a.rXU(o.a),a.rXU(s.b))}}static{this.ɵcmp=a.VBU({type:WpTableConfigurationFiltersTab,selectors:[["wp-table-config-filters-tab"]],decls:1,vars:1,consts:[[3,"filters","filtersChanged",4,"ngIf"],[3,"filtersChanged","filters"]],template:function WpTableConfigurationFiltersTab_Template(e,t){1&e&&a.DNE(0,WpTableConfigurationFiltersTab_op_query_filters_0_Template,1,1,"op-query-filters",0),2&e&&a.Y8G("ngIf",!!t.filters)},dependencies:[l.bT,c.l],encapsulation:2})}}},73677:(e,t,n)=>{"use strict";n.d(t,{c:()=>WpTableConfigurationHighlightingTabComponent});var i=n(62665),o=n(61816),r=n(99972),s=n(11048),a=n(13432),l=n(38941),c=n(11439),p=n(68559),d=n(60316),u=n(34456),h=n(35321),m=n(62223);const g=["highlightedAttributesNgSelect"],_=["rowHighlightNgSelect"];function WpTableConfigurationHighlightingTabComponent_op_enterprise_banner_1_Template(e,t){if(1&e&&p.nrm(0,"op-enterprise-banner",4),2&e){const e=p.XpG();p.Y8G("linkMessage",e.text.upsaleCheckOutLink)("textMessage",e.text.upsaleAttributeHighlighting)("moreInfoLink",e.text.more_info_link)}}function WpTableConfigurationHighlightingTabComponent_form_2_Template(e,t){if(1&e){const e=p.RV6();p.j41(0,"form"),p.nrm(1,"p",5),p.j41(2,"div",6)(3,"label",7)(4,"input",8),p.mxI("ngModelChange",(function WpTableConfigurationHighlightingTabComponent_form_2_Template_input_ngModelChange_4_listener(t){p.eBV(e);const n=p.XpG();return p.DH7(n.highlightingMode,t)||(n.highlightingMode=t),p.Njj(t)})),p.bIt("change",(function WpTableConfigurationHighlightingTabComponent_form_2_Template_input_change_4_listener(t){p.eBV(e);const n=p.XpG();return p.Njj(n.updateMode(t.target.value))})),p.k0s(),p.nrm(5,"span",5),p.EFF(6,"  "),p.k0s(),p.j41(7,"div",9)(8,"div",10)(9,"ng-select",11,0),p.mxI("ngModelChange",(function WpTableConfigurationHighlightingTabComponent_form_2_Template_ng_select_ngModelChange_9_listener(t){p.eBV(e);const n=p.XpG();return p.DH7(n.selectedAttributes,t)||(n.selectedAttributes=t),p.Njj(t)})),p.bIt("open",(function WpTableConfigurationHighlightingTabComponent_form_2_Template_ng_select_open_9_listener(){p.eBV(e);const t=p.sdS(10),n=p.XpG();return p.Njj(n.onOpen(t))}))("change",(function WpTableConfigurationHighlightingTabComponent_form_2_Template_ng_select_change_9_listener(t){p.eBV(e);const n=p.XpG();return p.Njj(n.updateHighlightingAttributes(t))})),p.k0s()()()(),p.j41(11,"div",6)(12,"label",7)(13,"input",12),p.mxI("ngModelChange",(function WpTableConfigurationHighlightingTabComponent_form_2_Template_input_ngModelChange_13_listener(t){p.eBV(e);const n=p.XpG();return p.DH7(n.entireRowMode,t)||(n.entireRowMode=t),p.Njj(t)})),p.bIt("change",(function WpTableConfigurationHighlightingTabComponent_form_2_Template_input_change_13_listener(){p.eBV(e);const t=p.XpG();return p.Njj(t.updateMode("entire-row"))})),p.k0s(),p.nrm(14,"span",5),p.k0s(),p.j41(15,"div",9)(16,"div",10)(17,"ng-select",13,1),p.mxI("ngModelChange",(function WpTableConfigurationHighlightingTabComponent_form_2_Template_ng_select_ngModelChange_17_listener(t){p.eBV(e);const n=p.XpG();return p.DH7(n.lastEntireRowAttribute,t)||(n.lastEntireRowAttribute=t),p.Njj(t)})),p.bIt("open",(function WpTableConfigurationHighlightingTabComponent_form_2_Template_ng_select_open_17_listener(){p.eBV(e);const t=p.sdS(18),n=p.XpG();return p.Njj(n.onOpen(t))}))("change",(function WpTableConfigurationHighlightingTabComponent_form_2_Template_ng_select_change_17_listener(t){p.eBV(e);const n=p.XpG();return p.Njj(n.updateMode(t.value))})),p.k0s()()()(),p.j41(19,"div",6)(20,"label",7)(21,"input",14),p.mxI("ngModelChange",(function WpTableConfigurationHighlightingTabComponent_form_2_Template_input_ngModelChange_21_listener(t){p.eBV(e);const n=p.XpG();return p.DH7(n.highlightingMode,t)||(n.highlightingMode=t),p.Njj(t)})),p.bIt("change",(function WpTableConfigurationHighlightingTabComponent_form_2_Template_input_change_21_listener(t){p.eBV(e);const n=p.XpG();return p.Njj(n.updateMode(t.target.value))})),p.k0s(),p.nrm(22,"span",5),p.k0s()()()}if(2&e){const e=p.XpG();p.R7$(),p.Y8G("textContent",e.text.highlighting_mode.description),p.R7$(3),p.R50("ngModel",e.highlightingMode),p.BMQ("disabled",e.disabledValue(e.eeShowBanners)),p.R7$(),p.Y8G("textContent",e.text.highlighting_mode.inline),p.R7$(4),p.FS9("placeholder",e.text.highlighting_mode.inline_all_attributes),p.Y8G("items",e.availableInlineHighlightedAttributes),p.R50("ngModel",e.selectedAttributes),p.Y8G("multiple",!0)("disabled","inline"!==e.highlightingMode)("clearable",!1)("closeOnSelect",!1),p.R7$(4),p.R50("ngModel",e.entireRowMode),p.Y8G("value",!0),p.BMQ("disabled",e.disabledValue(e.eeShowBanners)),p.R7$(),p.Y8G("textContent",e.text.highlighting_mode.entire_row_by),p.R7$(3),p.Y8G("items",e.availableRowHighlightedAttributes),p.R50("ngModel",e.lastEntireRowAttribute),p.Y8G("disabled",e.disabledValue(e.eeShowBanners))("clearable",!1),p.R7$(4),p.R50("ngModel",e.highlightingMode),p.BMQ("disabled",e.disabledValue(e.eeShowBanners)),p.R7$(),p.Y8G("textContent",e.text.highlighting_mode.none)}}class WpTableConfigurationHighlightingTabComponent{constructor(e,t,n,i,o,r){this.injector=e,this.I18n=t,this.states=n,this.querySpace=i,this.Banners=o,this.wpTableHighlight=r,this.highlightingMode="inline",this.entireRowMode=!1,this.lastEntireRowAttribute="status",this.eeShowBanners=!1,this.availableInlineHighlightedAttributes=[],this.selectedAttributes=[],this.availableRowHighlightedAttributes=[],this.text={title:this.I18n.t("js.work_packages.table_configuration.highlighting"),highlighting_mode:{description:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.description"),none:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.none"),inline:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.inline"),inline_all_attributes:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.inline_all"),status:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.status"),type:this.I18n.t("js.work_packages.properties.type"),priority:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.priority"),entire_row_by:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.entire_row_by")},upsaleAttributeHighlighting:this.I18n.t("js.work_packages.table_configuration.upsale.attribute_highlighting"),upsaleCheckOutLink:this.I18n.t("js.work_packages.table_configuration.upsale.check_out_link"),more_info_link:l.y$.tableHighlighting}}ngOnInit(){this.availableInlineHighlightedAttributes=this.availableHighlightedAttributes,this.availableRowHighlightedAttributes=[{name:this.text.highlighting_mode.status,value:"status"},{name:this.text.highlighting_mode.priority,value:"priority"}],this.setSelectedValues(),this.eeShowBanners=this.Banners.eeShowBanners,this.updateMode(this.wpTableHighlight.current.mode),this.eeShowBanners&&this.updateMode("none")}onSave(){const e=this.highlightingMode;this.wpTableHighlight.update({mode:e,selectedAttributes:this.selectedAttributes})}updateMode(e){this.highlightingMode="entire-row"===e?this.lastEntireRowAttribute:e,-1!==["status","priority"].indexOf(this.highlightingMode)?(this.lastEntireRowAttribute=this.highlightingMode,this.entireRowMode=!0):this.entireRowMode=!1}updateHighlightingAttributes(e){this.selectedAttributes=e}disabledValue(e){return e?"disabled":null}get availableHighlightedAttributes(){const{schema:e}=this.querySpace.queryForm.value;return e.highlightedAttributes.allowedValues}onOpen(e){(0,c.Z)(e)}setSelectedValues(){const e=this.wpTableHighlight.current.selectedAttributes;e&&(this.selectedAttributes=e)}static{this.ɵfac=function WpTableConfigurationHighlightingTabComponent_Factory(e){return new(e||WpTableConfigurationHighlightingTabComponent)(p.rXU(p.zZn),p.rXU(o.W),p.rXU(a.D),p.rXU(s.i),p.rXU(r.b),p.rXU(i.I))}}static{this.ɵcmp=p.VBU({type:WpTableConfigurationHighlightingTabComponent,selectors:[["ng-component"]],viewQuery:function WpTableConfigurationHighlightingTabComponent_Query(e,t){if(1&e&&(p.GBs(g,5),p.GBs(_,5)),2&e){let e;p.mGM(e=p.lsd())&&(t.highlightedAttributesNgSelect=e.first),p.mGM(e=p.lsd())&&(t.rowHighlightNgSelect=e.first)}},decls:3,vars:2,consts:[["highlightedAttributesNgSelect",""],["rowHighlightNgSelect",""],["class","ee-attribute-highlighting-upsale","opReferrer","wp-attribute-highlighting#attribute-highlighting",3,"linkMessage","textMessage","moreInfoLink",4,"ngIf"],[4,"ngIf"],["opReferrer","wp-attribute-highlighting#attribute-highlighting",1,"ee-attribute-highlighting-upsale",3,"linkMessage","textMessage","moreInfoLink"],[3,"textContent"],[1,"form--field"],[1,"form--label"],["type","radio","value","inline","name","highlighting_mode_switch",3,"ngModelChange","change","ngModel"],[1,"form--field-container"],[1,"form--select-container"],["bindLabel","name","name","highlighting_attributes","appendTo","body",1,"form--select-field","-multi-select",3,"ngModelChange","open","change","items","ngModel","multiple","disabled","clearable","closeOnSelect","placeholder"],["type","radio","name","entire_row_switch",3,"ngModelChange","change","ngModel","value"],["bindLabel","name","bindValue","value","name","selected_attribute","appendTo","body","id","selected_attribute",1,"form--select-field",3,"ngModelChange","open","change","items","ngModel","disabled","clearable"],["type","radio","value","none","name","highlighting_mode_switch",3,"ngModelChange","change","ngModel"]],template:function WpTableConfigurationHighlightingTabComponent_Template(e,t){1&e&&(p.j41(0,"div"),p.DNE(1,WpTableConfigurationHighlightingTabComponent_op_enterprise_banner_1_Template,1,3,"op-enterprise-banner",2)(2,WpTableConfigurationHighlightingTabComponent_form_2_Template,23,22,"form",3),p.k0s()),2&e&&(p.R7$(),p.Y8G("ngIf",t.eeShowBanners),p.R7$(),p.Y8G("ngIf",!t.eeShowBanners))},dependencies:[d.bT,u.qT,u.me,u.Fm,u.BC,u.cb,u.vS,u.cV,h.l,m.vr],encapsulation:2,changeDetection:0})}}},91297:(e,t,n)=>{"use strict";n.d(t,{t:()=>WpTableConfigurationSortByTabComponent});var i=n(61816),o=n(1257),r=n(76008),s=n(68559),a=n(60316),l=n(34456);function WpTableConfigurationSortByTabComponent_ng_container_15_div_1_option_6_Template(e,t){if(1&e&&s.nrm(0,"option",18),2&e){const e=s.XpG().$implicit;s.Y8G("textContent",e.column.name)("value",e.column.href)}}function WpTableConfigurationSortByTabComponent_ng_container_15_div_1_option_8_Template(e,t){if(1&e&&s.nrm(0,"option",19),2&e){const e=t.$implicit;s.Y8G("textContent",e.name)("value",e.href)}}function WpTableConfigurationSortByTabComponent_ng_container_15_div_1_label_11_Template(e,t){if(1&e){const e=s.RV6();s.j41(0,"label",5)(1,"input",20),s.mxI("ngModelChange",(function WpTableConfigurationSortByTabComponent_ng_container_15_div_1_label_11_Template_input_ngModelChange_1_listener(t){s.eBV(e);const n=s.XpG().$implicit;return s.DH7(n.direction,t)||(n.direction=t),s.Njj(t)})),s.k0s(),s.EFF(2),s.k0s()}if(2&e){const e=t.$implicit,n=s.XpG(),i=n.$implicit,o=n.index;s.R7$(),s.Mz_("name","modal-sorting-attribute-",o,"--sort-direction"),s.R50("ngModel",i.direction),s.Y8G("value",e.href)("textContent",e.name),s.R7$(),s.SpI(" ",e.name," ")}}function WpTableConfigurationSortByTabComponent_ng_container_15_div_1_Template(e,t){if(1&e){const e=s.RV6();s.j41(0,"div")(1,"div",3),s.nrm(2,"label",11),s.j41(3,"div",4)(4,"div",12)(5,"select",13),s.bIt("change",(function WpTableConfigurationSortByTabComponent_ng_container_15_div_1_Template_select_change_5_listener(t){const n=s.eBV(e).$implicit,i=s.XpG(2);return s.Njj(i.updateSelection(n,t.target.value))})),s.DNE(6,WpTableConfigurationSortByTabComponent_ng_container_15_div_1_option_6_Template,1,2,"option",14),s.nrm(7,"option",15),s.DNE(8,WpTableConfigurationSortByTabComponent_ng_container_15_div_1_option_8_Template,1,2,"option",16),s.k0s()()()(),s.j41(9,"div",3)(10,"div",4),s.DNE(11,WpTableConfigurationSortByTabComponent_ng_container_15_div_1_label_11_Template,3,6,"label",17),s.k0s()()()}if(2&e){const e=t.$implicit,n=t.index,i=s.XpG(2);s.ZvI("form--row modal-sorting-row-",n,""),s.R7$(2),s.Mz_("for","modal-sorting-attribute-",n,""),s.Y8G("textContent",i.text["sort_criteria_"+n]),s.R7$(3),s.Mz_("id","modal-sorting-attribute-",n,""),s.Mz_("name","modal-sorting-attribute-",n,""),s.R7$(),s.Y8G("ngIf",!!e.column.href),s.R7$(),s.Y8G("textContent",i.emptyColumn.name)("value",i.emptyColumn.href)("selected",!e.column.href),s.R7$(),s.Y8G("ngForOf",i.availableColumns),s.R7$(3),s.Y8G("ngForOf",i.availableDirections)}}function WpTableConfigurationSortByTabComponent_ng_container_15_Template(e,t){if(1&e&&(s.qex(0),s.DNE(1,WpTableConfigurationSortByTabComponent_ng_container_15_div_1_Template,12,16,"div",10),s.bVm()),2&e){const e=s.XpG();s.R7$(),s.Y8G("ngForOf",e.sortationObjects)}}class SortModalObject{constructor(e,t){this.column=e,this.direction=t}}class WpTableConfigurationSortByTabComponent{constructor(e,t,n){this.injector=e,this.I18n=t,this.wpTableSortBy=n,this.text={title:this.I18n.t("js.label_sort_by"),placeholder:this.I18n.t("js.placeholders.default"),sort_criteria_1:this.I18n.t("js.filter.sorting.criteria.one"),sort_criteria_2:this.I18n.t("js.filter.sorting.criteria.two"),sort_criteria_3:this.I18n.t("js.filter.sorting.criteria.three"),sorting_mode:{description:this.I18n.t("js.work_packages.table_configuration.sorting_mode.description"),automatic:this.I18n.t("js.work_packages.table_configuration.sorting_mode.automatic"),manually:this.I18n.t("js.work_packages.table_configuration.sorting_mode.manually"),warning:this.I18n.t("js.work_packages.table_configuration.sorting_mode.warning")}},this.availableDirections=[{href:r.cG,name:this.I18n.t("js.label_ascending")},{href:r.yM,name:this.I18n.t("js.label_descending")}],this.availableColumns=[],this.allColumns=[],this.sortationObjects=[],this.emptyColumn={name:this.text.placeholder,href:null},this.sortingMode="automatic"}onSave(){let e;e="automatic"===this.sortingMode?this.sortationObjects.filter((e=>null!==e.column)):[new SortModalObject(this.manualSortColumn,r.cG)],e=e.map((e=>this.getMatchingSort(e.column.href,e.direction))),this.wpTableSortBy.update(_.compact(e))}ngOnInit(){this.wpTableSortBy.onReadyWithAvailable().subscribe((()=>{const e=this.wpTableSortBy.available.filter((e=>!e.column.href.endsWith("/parent"))).map((e=>({name:e.column.name,href:e.column.href})));this.allColumns=_.uniqBy(e,"href"),this.getManualSortingOption(),_.each(this.wpTableSortBy.current,(e=>{e.column.href.endsWith("/parent")||(this.sortationObjects.push(new SortModalObject({name:e.column.name,href:e.column.href},e.direction.href)),e.column.href===this.manualSortColumn.href&&this.updateSortingMode("manual"))})),this.updateUsedColumns(),this.fillUpSortElements()}))}updateSelection(e,t){e.column=_.find(this.allColumns,(e=>e.href===t))||this.emptyColumn,this.updateUsedColumns()}updateUsedColumns(){const e=this.sortationObjects.filter((e=>null!==e.column)).map((e=>e.column));this.availableColumns=_.sortBy(_.differenceBy(this.allColumns,e,"href"),"name")}updateSortingMode(e){this.sortingMode=e}getMatchingSort(e,t){return _.find(this.wpTableSortBy.available,(n=>n.column.href===e&&n.direction.href===t))}fillUpSortElements(){for(;this.sortationObjects.length<3;)this.sortationObjects.push(new SortModalObject(this.emptyColumn,r.cG))}getManualSortingOption(){this.manualSortColumn=this.allColumns.find((e=>e.href.endsWith("/manualSorting"))),this.allColumns.splice(this.allColumns.indexOf(this.manualSortColumn),1)}static{this.ɵfac=function WpTableConfigurationSortByTabComponent_Factory(e){return new(e||WpTableConfigurationSortByTabComponent)(s.rXU(s.zZn),s.rXU(i.W),s.rXU(o.P))}}static{this.ɵcmp=s.VBU({type:WpTableConfigurationSortByTabComponent,selectors:[["ng-component"]],decls:16,vars:7,consts:[["name","modalSortingForm"],["id","modal-sorting","data-indicator-name","sorting-modal",1,"modal-content-container","loading-indicator--location"],[3,"textContent"],[1,"form--field","-full-width"],[1,"form--field-container"],[1,"option-label"],["type","radio","name","sorting_mode_switch","value","manual",3,"ngModelChange","change","ngModel"],["type","radio","name","sorting_mode_switch","value","automatic",3,"ngModelChange","change","ngModel"],[1,"form--field-instructions"],[4,"ngIf"],[3,"class",4,"ngFor","ngForOf"],[1,"form--label","hidden-for-sighted",3,"for","textContent"],[1,"form--select-container"],[1,"form--select",3,"change","id","name"],["selected","",3,"textContent","value",4,"ngIf"],[3,"textContent","value","selected"],[3,"textContent","value",4,"ngFor","ngForOf"],["class","option-label",4,"ngFor","ngForOf"],["selected","",3,"textContent","value"],[3,"textContent","value"],["type","radio",3,"ngModelChange","ngModel","value","textContent","name"]],template:function WpTableConfigurationSortByTabComponent_Template(e,t){1&e&&(s.j41(0,"form",0)(1,"div",1),s.nrm(2,"p",2),s.j41(3,"div",3)(4,"div",4)(5,"label",5)(6,"input",6),s.mxI("ngModelChange",(function WpTableConfigurationSortByTabComponent_Template_input_ngModelChange_6_listener(e){return s.DH7(t.sortingMode,e)||(t.sortingMode=e),e})),s.bIt("change",(function WpTableConfigurationSortByTabComponent_Template_input_change_6_listener(e){return t.updateSortingMode(e.target.value)})),s.k0s(),s.EFF(7),s.k0s()()(),s.j41(8,"div",3)(9,"div",4)(10,"label",5)(11,"input",7),s.mxI("ngModelChange",(function WpTableConfigurationSortByTabComponent_Template_input_ngModelChange_11_listener(e){return s.DH7(t.sortingMode,e)||(t.sortingMode=e),e})),s.bIt("change",(function WpTableConfigurationSortByTabComponent_Template_input_change_11_listener(e){return t.updateSortingMode(e.target.value)})),s.k0s(),s.EFF(12),s.k0s()(),s.j41(13,"div",8),s.EFF(14),s.k0s()(),s.DNE(15,WpTableConfigurationSortByTabComponent_ng_container_15_Template,2,1,"ng-container",9),s.k0s()()),2&e&&(s.R7$(2),s.Y8G("textContent",t.text.sorting_mode.description),s.R7$(4),s.R50("ngModel",t.sortingMode),s.R7$(),s.SpI(" ",t.text.sorting_mode.manually," "),s.R7$(4),s.R50("ngModel",t.sortingMode),s.R7$(),s.SpI(" ",t.text.sorting_mode.automatic," "),s.R7$(2),s.SpI(" ",t.text.sorting_mode.warning," "),s.R7$(),s.Y8G("ngIf","automatic"===t.sortingMode))},dependencies:[a.Sq,a.bT,l.qT,l.xH,l.y7,l.me,l.Fm,l.BC,l.cb,l.vS,l.cV],encapsulation:2})}}},2867:(e,t,n)=>{"use strict";n.d(t,{o:()=>WpTableConfigurationTimelinesTabComponent});var i=n(61816),o=n(68222),r=n(88352),s=n(13517),a=n(68559),l=n(83093),c=n(60316),p=n(34456);function WpTableConfigurationTimelinesTabComponent_ng_container_8_option_8_Template(e,t){if(1&e&&a.nrm(0,"option",15),2&e){const e=t.$implicit,n=a.XpG(2);a.Y8G("textContent",n.text.zoom[e])("value",e)("selected",n.zoomLevel===e)}}function WpTableConfigurationTimelinesTabComponent_ng_container_8_div_12_option_7_Template(e,t){if(1&e&&a.nrm(0,"option",15),2&e){const e=t.$implicit,n=a.XpG().$implicit,i=a.XpG(2);a.Y8G("textContent",e.name)("value",e.id)("selected",i.labels[n]===e.id)}}function WpTableConfigurationTimelinesTabComponent_ng_container_8_div_12_Template(e,t){if(1&e){const e=a.RV6();a.j41(0,"div",16)(1,"div",1)(2,"label",17),a.EFF(3),a.k0s(),a.j41(4,"div",3)(5,"div",18)(6,"select",19),a.bIt("change",(function WpTableConfigurationTimelinesTabComponent_ng_container_8_div_12_Template_select_change_6_listener(t){const n=a.eBV(e).$implicit,i=a.XpG(2);return a.Njj(i.updateLabels(n,t.target.value))})),a.DNE(7,WpTableConfigurationTimelinesTabComponent_ng_container_8_div_12_option_7_Template,1,3,"option",13),a.k0s()()()()()}if(2&e){const e=t.$implicit,n=a.XpG(2);a.R7$(2),a.Mz_("for","modal-timelines-label-",e,""),a.R7$(),a.SpI(" ",n.text.labels[e]," "),a.R7$(3),a.Mz_("id","modal-timelines-label-",e,""),a.R7$(),a.Y8G("ngForOf",n.availableAttributes)}}function WpTableConfigurationTimelinesTabComponent_ng_container_8_Template(e,t){if(1&e){const e=a.RV6();a.qex(0),a.j41(1,"fieldset",8),a.nrm(2,"legend",9)(3,"p",10),a.j41(4,"div",1)(5,"div",3)(6,"div",11)(7,"select",12),a.bIt("change",(function WpTableConfigurationTimelinesTabComponent_ng_container_8_Template_select_change_7_listener(t){a.eBV(e);const n=a.XpG();return a.Njj(n.zoomLevel=t.target.value)})),a.DNE(8,WpTableConfigurationTimelinesTabComponent_ng_container_8_option_8_Template,1,3,"option",13),a.k0s()()()()(),a.j41(9,"fieldset",8),a.nrm(10,"legend",9)(11,"p",10),a.DNE(12,WpTableConfigurationTimelinesTabComponent_ng_container_8_div_12_Template,8,6,"div",14),a.k0s(),a.bVm()}if(2&e){const e=a.XpG();a.R7$(2),a.Y8G("textContent",e.text.zoom.level),a.R7$(),a.Y8G("textContent",e.text.zoom.description),a.R7$(5),a.Y8G("ngForOf",e.availableZoomLevels),a.R7$(2),a.Y8G("textContent",e.text.labels.title),a.R7$(),a.Y8G("textContent",e.text.labels.description),a.R7$(),a.Y8G("ngForOf",e.availableLabels)}}class WpTableConfigurationTimelinesTabComponent{constructor(e,t,n,i,o){this.injector=e,this.I18n=t,this.wpTableTimeline=n,this.wpTableColumns=i,this.$state=o,this.timelineVisible=!1,this.availableZoomLevels=["auto",...s.W8],this.text={title:this.I18n.t("js.gantt_chart.label"),display_timelines:this.I18n.t("js.gantt_chart.button_activate"),display_timelines_hint:this.I18n.t("js.work_packages.table_configuration.show_timeline_hint"),zoom:{level:this.I18n.t("js.tl_toolbar.zooms"),description:this.I18n.t("js.gantt_chart.zoom.description"),days:this.I18n.t("js.gantt_chart.zoom.days"),weeks:this.I18n.t("js.gantt_chart.zoom.weeks"),months:this.I18n.t("js.gantt_chart.zoom.months"),quarters:this.I18n.t("js.gantt_chart.zoom.quarters"),years:this.I18n.t("js.gantt_chart.zoom.years"),auto:this.I18n.t("js.gantt_chart.zoom.auto")},labels:{title:this.I18n.t("js.gantt_chart.labels.title"),description:this.I18n.t("js.gantt_chart.labels.description"),bar:this.I18n.t("js.gantt_chart.labels.bar"),none:this.I18n.t("js.gantt_chart.filter.noneSelection"),left:this.I18n.t("js.gantt_chart.labels.left"),right:this.I18n.t("js.gantt_chart.labels.right"),farRight:this.I18n.t("js.gantt_chart.labels.farRight")}}}onSave(){this.wpTableTimeline.update({...this.wpTableTimeline.current,visible:this.timelineVisible,labels:this.labels,zoomLevel:this.zoomLevel})}updateLabels(e,t){""===t&&(t=null),this.labels[e]=t}ngOnInit(){this.timelineVisible=this.wpTableTimeline.isVisible,this.zoomLevel=this.wpTableTimeline.zoomLevel;const{labels:e}=this.wpTableTimeline;this.labels=_.clone(e),this.availableLabels=Object.keys(this.labels);const t=this.wpTableColumns.allPropertyColumns.sort(((e,t)=>e.name.localeCompare(t.name)));this.availableAttributes=[{id:"",name:this.text.labels.none}].concat(t)}timelineToggleDisabled(){return!!this.$state.current.name?.includes("gantt")}static{this.ɵfac=function WpTableConfigurationTimelinesTabComponent_Factory(e){return new(e||WpTableConfigurationTimelinesTabComponent)(a.rXU(a.zZn),a.rXU(i.W),a.rXU(o.X),a.rXU(r.T),a.rXU(l.dw))}}static{this.ɵcmp=a.VBU({type:WpTableConfigurationTimelinesTabComponent,selectors:[["ng-component"]],decls:9,vars:5,consts:[[1,"form"],[1,"form--field"],["for","display_timelines_switch",1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--check-box-container"],["type","checkbox","id","display_timelines_switch","name","display_timelines_switch",3,"change","checked","disabled"],[1,"form--field-instructions",3,"textContent"],[4,"ngIf"],[1,"form--fieldset"],[1,"form--fieldset-legend",3,"textContent"],[3,"textContent"],[1,"form--text-select-container","-slim"],["id","modal-timelines-zoomlevel",1,"form--select",3,"change"],[3,"textContent","value","selected",4,"ngFor","ngForOf"],["class","form--row",4,"ngFor","ngForOf"],[3,"textContent","value","selected"],[1,"form--row"],[1,"form--label",3,"for"],[1,"form--select-container"],[1,"form--select",3,"change","id"]],template:function WpTableConfigurationTimelinesTabComponent_Template(e,t){1&e&&(a.j41(0,"div")(1,"form",0)(2,"div",1),a.nrm(3,"label",2),a.j41(4,"div",3)(5,"div",4)(6,"input",5),a.bIt("change",(function WpTableConfigurationTimelinesTabComponent_Template_input_change_6_listener(){return t.timelineVisible=!t.timelineVisible})),a.k0s()()(),a.nrm(7,"p",6),a.k0s(),a.DNE(8,WpTableConfigurationTimelinesTabComponent_ng_container_8_Template,13,6,"ng-container",7),a.k0s()()),2&e&&(a.R7$(3),a.Y8G("textContent",t.text.display_timelines),a.R7$(3),a.Y8G("checked",t.timelineVisible)("disabled",t.timelineToggleDisabled()),a.R7$(),a.Y8G("textContent",t.text.display_timelines_hint),a.R7$(),a.Y8G("ngIf",t.timelineVisible))},dependencies:[c.Sq,c.bT,p.qT,p.xH,p.y7,p.cb,p.cV],encapsulation:2})}}},81213:(e,t,n)=>{"use strict";n.d(t,{G:()=>WpTableConfigurationRelationSelectorComponent});var i=n(72688),o=n(61816),r=n(34120),s=n(44674),a=n(68559),l=n(60316),c=n(34456);function WpTableConfigurationRelationSelectorComponent_option_5_Template(e,t){if(1&e&&a.nrm(0,"option",4),2&e){const e=t.$implicit,n=a.XpG();a.Y8G("textContent",n.text[e.id])("ngValue",e)}}class WpTableConfigurationRelationSelectorComponent{constructor(e,t,n,i,o){this.injector=e,this.I18n=t,this.wpTableFilters=n,this.ConfigurationService=i,this.schemaCache=o,this.relationFilterIds=["parent","precedes","follows","relates","duplicates","duplicated","blocks","blocked","partof","includes","requires","required"],this.availableRelationFilters=[],this.selectedRelationFilter=void 0,this.text={filter_work_packages_by_relation_type:this.I18n.t("js.work_packages.table_configuration.relation_filters.filter_work_packages_by_relation_type"),please_select:this.I18n.t("js.placeholders.selection"),parent:this.I18n.t("js.relation_labels.children"),precedes:this.I18n.t("js.relation_labels.follows"),follows:this.I18n.t("js.relation_labels.precedes"),relates:this.I18n.t("js.relation_labels.relates"),duplicates:this.I18n.t("js.relation_labels.duplicated"),duplicated:this.I18n.t("js.relation_labels.duplicates"),blocks:this.I18n.t("js.relation_labels.blocked"),blocked:this.I18n.t("js.relation_labels.blocks"),requires:this.I18n.t("js.relation_labels.required"),required:this.I18n.t("js.relation_labels.requires"),partof:this.I18n.t("js.relation_labels.includes"),includes:this.I18n.t("js.relation_labels.partof")}}ngOnInit(){const e=this;this.wpTableFilters.onReady().then((()=>{e.availableRelationFilters=e.relationFiltersOf(e.wpTableFilters.availableFilters),e.setSelectedRelationFilter()}))}setSelectedRelationFilter(){const e=this.relationFiltersOf(this.wpTableFilters.current);e.length>0?this.selectedRelationFilter=_.find(this.availableRelationFilters,{id:e[0].id}):this.selectedRelationFilter=this.availableRelationFilters[0],this.onRelationFilterSelected()}onRelationFilterSelected(){this.selectedRelationFilter&&(this.removeRelationFiltersFromCurrentState(),this.addFilterToCurrentState(this.selectedRelationFilter))}removeRelationFiltersFromCurrentState(){const e=this.relationFiltersOf(this.wpTableFilters.current);this.wpTableFilters.remove(...e)}relationFiltersOf(e){return _.filter(e,(e=>_.includes(this.relationFilterIds,e.id)))}addFilterToCurrentState(e){const t=this.wpTableFilters.instantiate(e),n=this.getOperatorForId(t,"=");t.operator=n,t.values=[{href:"/api/v3/work_packages/{id}"}],this.wpTableFilters.add(t)}getOperatorForId(e,t){return _.find(this.schemaCache.of(e).availableOperators,{id:t})}compareRelationFilters(e,t){return e&&t?e.id===t.id:e===t}static{this.ɵfac=function WpTableConfigurationRelationSelectorComponent_Factory(e){return new(e||WpTableConfigurationRelationSelectorComponent)(a.rXU(a.zZn),a.rXU(o.W),a.rXU(r.N),a.rXU(i.s),a.rXU(s.D))}}static{this.ɵcmp=a.VBU({type:WpTableConfigurationRelationSelectorComponent,selectors:[["wp-table-configuration-relation-selector"]],decls:6,vars:4,consts:[[1,"relation-filter-selector"],[3,"textContent"],["id","",1,"form--select","form--inline-select",3,"ngModelChange","ngModel","compareWith"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],[3,"textContent","ngValue"]],template:function WpTableConfigurationRelationSelectorComponent_Template(e,t){1&e&&(a.j41(0,"div",0)(1,"h5"),a.nrm(2,"span",1),a.EFF(3," "),a.j41(4,"select",2),a.mxI("ngModelChange",(function WpTableConfigurationRelationSelectorComponent_Template_select_ngModelChange_4_listener(e){return a.DH7(t.selectedRelationFilter,e)||(t.selectedRelationFilter=e),e})),a.bIt("ngModelChange",(function WpTableConfigurationRelationSelectorComponent_Template_select_ngModelChange_4_listener(){return t.onRelationFilterSelected()})),a.DNE(5,WpTableConfigurationRelationSelectorComponent_option_5_Template,1,2,"option",3),a.k0s()()()),2&e&&(a.R7$(2),a.Y8G("textContent",t.text.filter_work_packages_by_relation_type),a.R7$(2),a.R50("ngModel",t.selectedRelationFilter),a.Y8G("compareWith",t.compareRelationFilters),a.R7$(),a.Y8G("ngForOf",t.availableRelationFilters))},dependencies:[l.Sq,c.xH,c.y7,c.wz,c.BC,c.vS],encapsulation:2})}}},16545:(e,t,n)=>{"use strict";n.d(t,{E:()=>WpTableConfigurationModalComponent,K:()=>C});var i=n(68559),o=n(72688),r=n(88352),s=n(44131),a=n(21449),l=n(28702),c=n(11048),p=n(80366),d=n(61816),u=n(51133),h=n(69081),m=n(49349),g=n(14593),_=n(83093),f=n(60316),b=n(25827),k=n(74406);const v=["tabContentOutlet"];function WpTableConfigurationModalComponent_ng_container_5_ng_container_1_Template(e,t){1&e&&i.eu8(0)}function WpTableConfigurationModalComponent_ng_container_5_Template(e,t){if(1&e&&(i.qex(0),i.DNE(1,WpTableConfigurationModalComponent_ng_container_5_ng_container_1_Template,1,0,"ng-container",12),i.bVm()),2&e){const e=i.XpG();i.R7$(),i.Y8G("ngComponentOutlet",e.prependModalComponent)("ngComponentOutletInjector",e.injector)}}function WpTableConfigurationModalComponent_op_scrollable_tabs_6_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-scrollable-tabs",13),i.bIt("tabSelected",(function WpTableConfigurationModalComponent_op_scrollable_tabs_6_Template_op_scrollable_tabs_tabSelected_0_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.switchTo(t))})),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("tabs",e.availableTabs)("currentTabId",null==e.tabPortalHost.currentTab?null:e.tabPortalHost.currentTab.id)}}const C=new i.nKC("WpTableConfigurationModalPrependComponent");class WpTableConfigurationModalComponent extends h.a{constructor(e,t,n,o,r,a,l,c,p,d,u,h,m,g,_,f){super(e,m,_),this.locals=e,this.prependModalComponent=t,this.I18n=n,this.injector=o,this.appRef=r,this.componentFactoryResolver=a,this.loadingIndicator=l,this.querySpace=c,this.wpStatesInitialization=p,this.apiV3Service=d,this.notificationService=u,this.wpTableColumns=h,this.cdRef=m,this.ConfigurationService=g,this.elementRef=_,this.$state=f,this.text={title:this.I18n.t("js.work_packages.table_configuration.modal_title"),closePopup:this.I18n.t("js.close_popup_title"),columnsLabel:this.I18n.t("js.label_columns"),selectedColumns:this.I18n.t("js.description_selected_columns"),multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect"),applyButton:this.I18n.t("js.modals.button_apply"),cancelButton:this.I18n.t("js.modals.button_cancel"),upsaleRelationColumns:this.I18n.t("js.modals.upsale_relation_columns"),upsaleRelationColumnsLink:this.I18n.t("js.modals.upsale_relation_columns_link")},this.onDataUpdated=new i.bkB,this.selectedColumnMap={},this.wpTableConfigurationService=this.injector.get(s.B,new s.B(this.I18n,this.$state))}ngOnInit(){this.$element=this.elementRef.nativeElement,this.tabPortalHost=new a.z(this.wpTableConfigurationService.tabs,this.tabContentOutlet.nativeElement,this.componentFactoryResolver,this.appRef,this.injector),this.loadingIndicator.indicator("modal").promise=this.loadForm().then((()=>{const e=this.locals.initialTab,t=this.availableTabs.find((t=>t.id===e));this.switchTo(t||this.availableTabs[0]),this.cdRef.detectChanges()}))}ngOnDestroy(){this.onDataUpdated.complete(),this.tabPortalHost.dispose()}get availableTabs(){return this.tabPortalHost.availableTabs}get currentTab(){return this.tabPortalHost.currentTab}switchTo(e){this.tabPortalHost.switchTo(e)}saveChanges(){this.tabPortalHost.activeComponents.forEach((e=>{e.onSave()})),this.onDataUpdated.emit(),this.service.close()}onClose(){return this.afterFocusOn.focus(),!0}get afterFocusOn(){return this.$element}loadForm(){const e=this.querySpace.query.value;return this.apiV3Service.queries.form.load(e).toPromise().then((([t,n])=>(this.wpStatesInitialization.updateStatesFromForm(e,t),t))).catch((e=>this.notificationService.handleRawError(e)))}static{this.ɵfac=function WpTableConfigurationModalComponent_Factory(e){return new(e||WpTableConfigurationModalComponent)(i.rXU(u.Y),i.rXU(C,8),i.rXU(d.W),i.rXU(i.zZn),i.rXU(i.o8S),i.rXU(i.OM3),i.rXU(p.FX),i.rXU(c.i),i.rXU(l.V),i.rXU(g.n),i.rXU(m.U),i.rXU(r.T),i.rXU(i.gRc),i.rXU(o.s),i.rXU(i.aKT),i.rXU(_.dw))}}static{this.ɵcmp=i.VBU({type:WpTableConfigurationModalComponent,selectors:[["ng-component"]],viewQuery:function WpTableConfigurationModalComponent_Query(e,t){if(1&e&&i.GBs(v,7),2&e){let e;i.mGM(e=i.lsd())&&(t.tabContentOutlet=e.first)}},features:[i.Vt3],decls:13,vars:5,consts:[["tabContentOutlet",""],["data-indicator-name","modal",1,"spot-modal","spot-modal_wide","wp-table--configuration-modal","loading-indicator--location"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"spot-modal--body","spot-container"],[4,"ngIf"],[3,"tabs","currentTabId","tabSelected",4,"ngIf"],[1,"tab-content"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],[1,"button","button_no-margin","spot-modal--cancel-button","spot-action-bar--action",3,"click","textContent"],["data-test-selector","spot-modal-wp-table-configuration-save-button",1,"button","button_no-margin","-primary","spot-action-bar--action",3,"click","textContent"],[4,"ngComponentOutlet","ngComponentOutletInjector"],[3,"tabSelected","tabs","currentTabId"]],template:function WpTableConfigurationModalComponent_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",1)(1,"div",2),i.EFF(2),i.k0s(),i.nrm(3,"div",3),i.j41(4,"div",4),i.DNE(5,WpTableConfigurationModalComponent_ng_container_5_Template,2,2,"ng-container",5)(6,WpTableConfigurationModalComponent_op_scrollable_tabs_6_Template,1,2,"op-scrollable-tabs",6),i.nrm(7,"div",7,0),i.k0s(),i.j41(9,"div",8)(10,"div",9)(11,"button",10),i.bIt("click",(function WpTableConfigurationModalComponent_Template_button_click_11_listener(n){return i.eBV(e),i.Njj(t.closeMe(n))})),i.k0s(),i.j41(12,"button",11),i.bIt("click",(function WpTableConfigurationModalComponent_Template_button_click_12_listener(){return i.eBV(e),i.Njj(t.saveChanges())})),i.k0s()()()()}2&e&&(i.R7$(2),i.JRh(t.text.title),i.R7$(3),i.Y8G("ngIf",!!t.prependModalComponent),i.R7$(),i.Y8G("ngIf",t.tabPortalHost),i.R7$(5),i.Y8G("textContent",t.text.cancelButton),i.R7$(),i.Y8G("textContent",t.text.applyButton))},dependencies:[f.OI,f.bT,b.ar,k.f],encapsulation:2})}}},44131:(e,t,n)=>{"use strict";n.d(t,{B:()=>WpTableConfigurationService});var i=n(61816),o=n(58997),r=n(79880),s=n(59716),a=n(91297),l=n(2867),c=n(73677),p=n(81711),d=n(68559),u=n(83093);class WpTableConfigurationService{constructor(e,t){this.I18n=e,this.$state=t,this._tabs=[{id:"columns",name:this.I18n.t("js.label_columns"),componentClass:r.V},{id:"filters",name:this.I18n.t("js.work_packages.query.filters"),componentClass:s.S},{id:"sort-by",name:this.I18n.t("js.label_sort_by"),componentClass:a.t},{id:"baseline",name:this.I18n.t("js.baseline.toggle_title"),componentClass:p.Q},{id:"display-settings",name:this.I18n.t("js.work_packages.table_configuration.display_settings"),componentClass:o.R},{id:"highlighting",name:this.I18n.t("js.work_packages.table_configuration.highlighting"),componentClass:c.c}]}get tabs(){return this.$state.current.name?.includes("work-packages")||this.$state.current.name?.includes("bim")?this._tabs:this._tabs.concat([{id:"timelines",name:this.I18n.t("js.gantt_chart.label"),componentClass:l.o}])}static{this.ɵfac=function WpTableConfigurationService_Factory(e){return new(e||WpTableConfigurationService)(d.KVO(i.W),d.KVO(u.dw))}}static{this.ɵprov=d.jDH({token:WpTableConfigurationService,factory:WpTableConfigurationService.ɵfac})}}},72790:(e,t,n)=>{"use strict";n.d(t,{R:()=>WorkPackageContextMenuHelperService});var i=n(73014),o=n(85247),r=n(65046),s=n(68222),a=n(87454),l=n(74573),c=n(68559);class WorkPackageContextMenuHelperService{constructor(e,t,n,i,o,r){this.HookService=e,this.UrlParamsHelper=t,this.wpViewRepresentation=n,this.wpViewTimeline=i,this.wpViewIndent=o,this.PathHelper=r,this.BULK_ACTIONS=[{text:I18n.t("js.work_packages.bulk_actions.edit"),key:"edit",link:"update",href:this.PathHelper.workPackagesBulkEditPath()},{text:I18n.t("js.work_packages.bulk_actions.move"),key:"move",link:"move",href:this.PathHelper.workPackagesBulkMovePath()},{text:I18n.t("js.work_packages.bulk_actions.copy"),key:"copy",link:"copy",href:this.PathHelper.workPackagesBulkCopyPath()},{text:I18n.t("js.work_packages.bulk_actions.delete"),key:"delete",link:"delete",href:this.PathHelper.workPackagesBulkDeletePath()}]}getPermittedActionLinks(e,t,n){const i=[];let o=this.getAllowedActions(e,t);return o=o.concat(this.getAllowedParentActions(e)),this.wpViewTimeline.isVisible&&(o=o.filter((e=>!["log_time","copy","copy_to_other_project","export-pdf","generate_pdf","export-atom","log_costs"].includes(e.key)))),o=o.concat(this.getAllowedRelationActions(e,n)),_.each(o,(t=>{i.push({key:t.key,text:t.text,icon:t.icon,link:this.linkForAction(e,t)})})),i}linkForAction(e,t){let n;if("copy_link_to_clipboard"===t.key)n=this.PathHelper.workPackageShortPath(e.id);else n=t.link?e[t.link].href:void 0;return n}getIntersectOfPermittedActions(e){const t=[],n=this.BULK_ACTIONS.concat(this.HookService.call("workPackageBulkContextMenu")),i=_.filter(n,(t=>_.every(e,(e=>this.isActionAllowed(e,t)))));return _.each(i,(n=>{t.push({key:n.key,text:n.text,icon:n.icon,link:this.getBulkActionLink(n,e)})})),t}getBulkActionLink(e,t){const n={"ids[]":t.map((e=>e.id))},i=this.UrlParamsHelper.buildQueryString(n),o=e.href.split("?");return`${o.shift()}?${o.concat(new Array(i)).join("&")}`}isActionAllowed(e,t){return _.filter(this.getAllowedActions(e,[t]),(e=>e===t)).length>=1}getAllowedActions(e,t){const n=[];return _.each(t,(t=>{t.link&&void 0!==e[t.link]&&(t.text=t.text||I18n.t(`js.button_${t.key}`),n.push(t))})),_.each(this.HookService.call("workPackageTableContextMenu"),(t=>{if(void 0!==e[t.link]){const e=t.indexBy?t.indexBy(n):n.length;n.splice(e,0,t)}})),n}getAllowedParentActions(e){const t=[];return this.wpViewRepresentation.isList?(this.wpViewIndent.canOutdent(e)&&t.push({key:"hierarchy-outdent",icon:"icon-paragraph-left",text:I18n.t("js.relation_buttons.hierarchy_outdent")}),this.wpViewIndent.canIndent(e)&&t.push({key:"hierarchy-indent",icon:"icon-paragraph-right",text:I18n.t("js.relation_buttons.hierarchy_indent")}),t):[]}getAllowedRelationActions(e,t){const n=[];return e.addRelation&&this.wpViewTimeline.isVisible&&(n.push({key:"relation-precedes",text:I18n.t("js.relation_buttons.add_predecessor"),link:"addRelation"}),n.push({key:"relation-follows",text:I18n.t("js.relation_buttons.add_follower"),link:"addRelation"})),this.wpViewTimeline.isVisible&&n.push({key:"relations",text:I18n.t("js.relation_buttons.show_relations"),link:"relations"}),e.addChild&&t&&n.push({key:"relation-new-child",text:I18n.t("js.relation_buttons.add_new_child"),link:"addChild"}),n}getPermittedActions(e,t,n){return 1===e.length?this.getPermittedActionLinks(e[0],t,n):this.getIntersectOfPermittedActions(e)}static{this.ɵfac=function WorkPackageContextMenuHelperService_Factory(e){return new(e||WorkPackageContextMenuHelperService)(c.KVO(r.R),c.KVO(o.j),c.KVO(l.dd),c.KVO(s.X),c.KVO(a.a),c.KVO(i.B))}}static{this.ɵprov=c.jDH({token:WorkPackageContextMenuHelperService,factory:WorkPackageContextMenuHelperService.ɵfac})}}},9845:(e,t,n)=>{"use strict";n.d(t,{_:()=>TableDragActionsRegistryService});var i=n(11048);class TableDragActionService{constructor(e,t){this.querySpace=e,this.injector=t}get applies(){return!0}onNewOrder(e){}canPickup(e){return!0}handleDrop(e,t){return Promise.resolve(void 0)}changeShadowElement(e,t=!1){return t?e.classList.remove("-dragged"):e.classList.add("-dragged"),!0}}var o=n(24398),r=n(94450),s=n(90941),a=n(40659),l=n(28952),c=n(1758),p=n(14593);class HierarchyDragActionService extends TableDragActionService{get applies(){return this.wpTableHierarchies.isEnabled}canPickup(e){return!!e.changeParent}handleDrop(e,t){return this.determineParent(t).then((t=>this.relationHierarchyService.changeParent(e,t)))}determineParent(e){let t=e.previousElementSibling;const n=e.nextElementSibling;let i=null;if(null!==t&&this.droppedIntoGroup(e,t,n)){if(t.className.indexOf((0,l.fD)())>=0){const e=this.findRelationRowRoot(t);if(null==e)return Promise.resolve(null);t=e}const e=t.dataset.workPackageId;if(this.isHiearchyRoot(t,e)){if((0,l.nT)(n))return this.determineParent(t);i=e}else i=this.loadParentOfWP(e)}return Promise.resolve(i)}findRelationRowRoot(e){let t=e.previousElementSibling;for(;null!==t;){if(t.className.indexOf((0,l.fD)())<0)return t;t=t.previousElementSibling}return null}droppedIntoGroup(e,t,n){const i=t.className.indexOf((0,a.LB)(""))>=0,o=t.className.indexOf((0,a.GK)(""))>=0;let r;if(i||o){const i=Array.from(e.classList).filter((e=>e.includes("__hierarchy-group-")))||[],o=Array.from(t.classList).filter((e=>e.includes("__hierarchy-group-")))||[],s=n&&Array.from(n.classList).filter((e=>e.includes("__hierarchy-group-")))||[],l=t.dataset.workPackageId,c=!s.some((e=>o.includes(e)))&&!s.includes((0,a.LB)(l)),p=i.some((e=>o.includes(e)))||i.includes((0,a.LB)(l));r=c&&!p}return!r&&i||o}isHiearchyRoot(e,t){return e.classList.contains((0,a.GK)(t))}loadParentOfWP(e){return this.apiV3Service.work_packages.id(e).get().toPromise().then((e=>Promise.resolve(e.parent?.id||null)))}}(0,o.Cg)([(0,c.O)(),(0,o.Sn)("design:type",r.j)],HierarchyDragActionService.prototype,"wpTableHierarchies",void 0),(0,o.Cg)([(0,c.O)(),(0,o.Sn)("design:type",s.F)],HierarchyDragActionService.prototype,"relationHierarchyService",void 0),(0,o.Cg)([(0,c.O)(),(0,o.Sn)("design:type",p.n)],HierarchyDragActionService.prototype,"apiV3Service",void 0);var d=n(1750),u=n(51339),h=n(56368),m=n(11762),g=n(40358),_=n(91691),f=n(44674);class GroupByDragActionService extends TableDragActionService{get applies(){return this.wpTableGroupBy.isEnabled}canPickup(e){const t=this.groupedAttribute;return null!==t&&this.schemaCache.of(e).isAttributeEditable(t)}handleDrop(e,t){const n=this.halEditing.changeFor(e),i=this.getValueForGroup(t);return n.projectedResource[this.groupedAttribute]=i,this.halEditing.save(n).then((e=>this.halEvents.push(e.resource,{eventType:"updated"}))).catch((t=>this.halNotification.handleRawError(t,e)))}getValueForGroup(e){const t=(0,l.Y9)(e,`.${h.D}`),n=this.groups.find((e=>(0,m.HA)(e)===t.dataset.groupIdentifier));if(!n)return null;if(n._links&&n._links.valueLink){const e=n._links.valueLink;return 1===e.length?e[0]:e}return n.value}get groupedAttribute(){const{current:e}=this.wpTableGroupBy;return e?e.id:null}get groups(){return this.querySpace.groups.value||[]}}(0,o.Cg)([(0,c.O)(),(0,o.Sn)("design:type",d.W)],GroupByDragActionService.prototype,"wpTableGroupBy",void 0),(0,o.Cg)([(0,c.O)(),(0,o.Sn)("design:type",u.p)],GroupByDragActionService.prototype,"halEditing",void 0),(0,o.Cg)([(0,c.O)(),(0,o.Sn)("design:type",_.o)],GroupByDragActionService.prototype,"halEvents",void 0),(0,o.Cg)([(0,c.O)(),(0,o.Sn)("design:type",g.Y)],GroupByDragActionService.prototype,"halNotification",void 0),(0,o.Cg)([(0,c.O)(),(0,o.Sn)("design:type",f.D)],GroupByDragActionService.prototype,"schemaCache",void 0);var b=n(68559);class TableDragActionsRegistryService{constructor(){this.register=[HierarchyDragActionService,GroupByDragActionService]}add(e){this.register.push(e)}get(e){const t=e.get(i.i);return this.register.map((n=>new n(t,e))).find((e=>e.applies))||new TableDragActionService(t,e)}static{this.ɵfac=function TableDragActionsRegistryService_Factory(e){return new(e||TableDragActionsRegistryService)}}static{this.ɵprov=b.jDH({token:TableDragActionsRegistryService,factory:TableDragActionsRegistryService.ɵfac})}}},17573:(e,t,n)=>{"use strict";n.d(t,{F:()=>EmbeddedTablesMacroComponent});var i=n(37749),o=n(68559),r=n(32808);class EmbeddedTablesMacroComponent{constructor(e){this.elementRef=e,this.configuration={actionsColumnEnabled:!1,columnMenuEnabled:!1,contextMenuEnabled:!1},(0,i.w)(this)}static{this.ɵfac=function EmbeddedTablesMacroComponent_Factory(e){return new(e||EmbeddedTablesMacroComponent)(o.rXU(o.aKT))}}static{this.ɵcmp=o.VBU({type:EmbeddedTablesMacroComponent,selectors:[["ng-component"]],inputs:{queryProps:"queryProps"},decls:1,vars:2,consts:[[3,"queryProps","configuration"]],template:function EmbeddedTablesMacroComponent_Template(e,t){1&e&&o.nrm(0,"wp-embedded-table-entry",0),2&e&&o.Y8G("queryProps",t.queryProps)("configuration",t.configuration)},dependencies:[r.T],encapsulation:2})}}},32808:(e,t,n)=>{"use strict";n.d(t,{T:()=>WorkPackageEmbeddedTableEntryComponent});var i=n(37749),o=n(68559),r=n(63077),s=n(95083);class WorkPackageEmbeddedTableEntryComponent{constructor(e){this.elementRef=e,this.initialLoadingIndicator=!0,(0,i.w)(this)}static{this.ɵfac=function WorkPackageEmbeddedTableEntryComponent_Factory(e){return new(e||WorkPackageEmbeddedTableEntryComponent)(o.rXU(o.aKT))}}static{this.ɵcmp=o.VBU({type:WorkPackageEmbeddedTableEntryComponent,selectors:[["wp-embedded-table-entry"]],inputs:{queryProps:"queryProps",configuration:"configuration",initialLoadingIndicator:"initialLoadingIndicator"},features:[o.nM4([r.Y])],decls:1,vars:3,consts:[[3,"queryProps","initialLoadingIndicator","configuration"]],template:function WorkPackageEmbeddedTableEntryComponent_Template(e,t){1&e&&o.nrm(0,"wp-embedded-table",0),2&e&&o.Y8G("queryProps",t.queryProps)("initialLoadingIndicator",t.initialLoadingIndicator)("configuration",t.configuration)},dependencies:[s.Z],encapsulation:2})}}},95083:(e,t,n)=>{"use strict";n.d(t,{Z:()=>WorkPackageEmbeddedTableComponent});var i=n(89204),o=n(24398),r=n(68559),s=n(68222),a=n(49989),l=n(1567),c=n(16545),p=n(51133),d=n(49025),u=n(80366),h=n(85247),m=n(61816),g=n(11048),f=n(89391),b=n(1758),k=n(14593),v=n(86866),C=n(28702),y=n(56196);class WorkPackageEmbeddedBaseComponent extends f.${constructor(){super(...arguments),this.uniqueEmbeddedTableName=`embedded-table-${Date.now()}`,this.initialLoadingIndicator=!0,this.renderTable=!1,this.showTablePagination=!1,this.error=null,this.initialized=!1}ngOnInit(){this.configuration=new d.y(this.providedConfiguration),this.configuration.isEmbedded=!0,this.initialized=!0,super.ngOnInit()}ngAfterViewInit(){this.loadQuery(!0,!1)}ngOnChanges(e){this.initialized&&(e.queryId||e.queryProps)&&this.loadQuery(this.initialLoadingIndicator,!1)}get projectIdentifier(){return this.configuration.projectContext?this.currentProject.identifier||void 0:this.configuration.projectIdentifier||void 0}buildQueryProps(){const e=this.querySpace.query.value;return this.wpStatesInitialization.applyToQuery(e),this.urlParamsHelper.buildV3GetQueryFromQueryResource(e)}buildUrlParams(){const e=this.querySpace.query.value;return this.wpStatesInitialization.applyToQuery(e),this.urlParamsHelper.encodeQueryJsonParams(e)}setLoaded(){this.renderTable=this.configuration.tableVisible,this.cdRef.detectChanges()}refresh(e=!0,t=!1){const n=this.querySpace.query.value,i=this.wpTablePagination.paginationObject;t&&(i.offset=1);const o=this.urlParamsHelper.buildV3GetQueryFromQueryResource(n,i),r=(0,y._)(this.wpListService.loadQueryFromExisting(n,o,this.queryProjectScope)).then((e=>this.wpStatesInitialization.updateQuerySpace(e,e.results)));return e&&(this.loadingIndicator=r),r}get isInitialized(){return!!this.configuration}set loadingIndicator(e){this.configuration.tableVisible&&(this.loadingIndicatorService.indicator(this.uniqueEmbeddedTableName).promise=e)}get queryProjectScope(){if(this.configuration.projectContext)return this.projectIdentifier}initializeStates(e){this.wpStatesInitialization.clearStates(),this.wpStatesInitialization.initializeFromQuery(e,e.results),this.wpStatesInitialization.updateQuerySpace(e,e.results)}static{this.ɵfac=(()=>{let e;return function WorkPackageEmbeddedBaseComponent_Factory(t){return(e||(e=r.xGo(WorkPackageEmbeddedBaseComponent)))(t||WorkPackageEmbeddedBaseComponent)}})()}static{this.ɵdir=r.FsC({type:WorkPackageEmbeddedBaseComponent,inputs:{providedConfiguration:[r.Mj6.None,"configuration","providedConfiguration"],uniqueEmbeddedTableName:"uniqueEmbeddedTableName",initialLoadingIndicator:"initialLoadingIndicator"},features:[r.Vt3,r.OA$]})}}(0,o.Cg)([(0,b.O)(),(0,o.Sn)("design:type",k.n)],WorkPackageEmbeddedBaseComponent.prototype,"apiV3Service",void 0),(0,o.Cg)([(0,b.O)(),(0,o.Sn)("design:type",g.i)],WorkPackageEmbeddedBaseComponent.prototype,"querySpace",void 0),(0,o.Cg)([(0,b.O)(),(0,o.Sn)("design:type",m.W)],WorkPackageEmbeddedBaseComponent.prototype,"I18n",void 0),(0,o.Cg)([(0,b.O)(),(0,o.Sn)("design:type",h.j)],WorkPackageEmbeddedBaseComponent.prototype,"urlParamsHelper",void 0),(0,o.Cg)([(0,b.O)(),(0,o.Sn)("design:type",u.FX)],WorkPackageEmbeddedBaseComponent.prototype,"loadingIndicatorService",void 0),(0,o.Cg)([(0,b.O)(),(0,o.Sn)("design:type",C.V)],WorkPackageEmbeddedBaseComponent.prototype,"wpStatesInitialization",void 0),(0,o.Cg)([(0,b.O)(),(0,o.Sn)("design:type",v.c)],WorkPackageEmbeddedBaseComponent.prototype,"currentProject",void 0),(0,o.Cg)([(0,b.O)(),(0,o.Sn)("design:type",r.gRc)],WorkPackageEmbeddedBaseComponent.prototype,"cdRef",void 0);var w=n(70271),T=n(91817),S=n(15842),j=n(64334),P=n(66309),I=n(60316),x=n(28601),R=n(43311),F=n(64940),M=n(35245);const _c0=(e,t,n)=>({"-hierarchy-disabled":e,"-compact-tables":t,"-external-height":n});function WorkPackageEmbeddedTableComponent_div_0_ng_container_1_op_filter_container_1_Template(e,t){if(1&e&&r.nrm(0,"op-filter-container",10),2&e){const e=r.XpG(3);r.Y8G("showFilterButton",e.configuration.showFilterButton)("filterButtonText",e.configuration.filterButtonText)}}function WorkPackageEmbeddedTableComponent_div_0_ng_container_1_wp_table_2_Template(e,t){if(1&e){const e=r.RV6();r.j41(0,"wp-table",11),r.bIt("itemClicked",(function WorkPackageEmbeddedTableComponent_div_0_ng_container_1_wp_table_2_Template_wp_table_itemClicked_0_listener(t){r.eBV(e);const n=r.XpG(3);return r.Njj(n.handleWorkPackageClicked(t))}))("stateLinkClicked",(function WorkPackageEmbeddedTableComponent_div_0_ng_container_1_wp_table_2_Template_wp_table_stateLinkClicked_0_listener(t){r.eBV(e);const n=r.XpG(3);return r.Njj(n.openStateLink(t))})),r.k0s()}if(2&e){const e=r.XpG(3);r.Y8G("projectIdentifier",e.projectIdentifier)("configuration",e.configuration)}}function WorkPackageEmbeddedTableComponent_div_0_ng_container_1_wp_grid_4_Template(e,t){if(1&e){const e=r.RV6();r.j41(0,"wp-grid",12),r.bIt("itemClicked",(function WorkPackageEmbeddedTableComponent_div_0_ng_container_1_wp_grid_4_Template_wp_grid_itemClicked_0_listener(t){r.eBV(e);const n=r.XpG(3);return r.Njj(n.handleWorkPackageClicked(t))}))("stateLinkClicked",(function WorkPackageEmbeddedTableComponent_div_0_ng_container_1_wp_grid_4_Template_wp_grid_stateLinkClicked_0_listener(t){r.eBV(e);const n=r.XpG(3);return r.Njj(n.openStateLink(t))})),r.k0s()}if(2&e){const e=r.XpG(3);r.Y8G("configuration",e.configuration)}}function WorkPackageEmbeddedTableComponent_div_0_ng_container_1_Template(e,t){if(1&e&&(r.qex(0),r.DNE(1,WorkPackageEmbeddedTableComponent_div_0_ng_container_1_op_filter_container_1_Template,1,2,"op-filter-container",4)(2,WorkPackageEmbeddedTableComponent_div_0_ng_container_1_wp_table_2_Template,1,2,"wp-table",5),r.j41(3,"div",6),r.DNE(4,WorkPackageEmbeddedTableComponent_div_0_ng_container_1_wp_grid_4_Template,1,1,"wp-grid",7),r.k0s(),r.j41(5,"div",8),r.nrm(6,"wp-table-pagination",9),r.k0s(),r.bVm()),2&e){const e=r.XpG(2);r.R7$(),r.Y8G("ngIf",e.configuration.withFilters),r.R7$(),r.Y8G("ngIf",!e.configuration.isCardView),r.R7$(2),r.Y8G("ngIf",e.configuration.isCardView),r.R7$(2),r.Y8G("hideForSinglePageResults",!0)}}function WorkPackageEmbeddedTableComponent_div_0_div_2_Template(e,t){if(1&e&&(r.j41(0,"div",13),r.nrm(1,"span",14),r.k0s()),2&e){const e=r.XpG(2);r.R7$(),r.Y8G("textContent",e.error.message||e.error)}}function WorkPackageEmbeddedTableComponent_div_0_Template(e,t){if(1&e&&(r.j41(0,"div",1),r.DNE(1,WorkPackageEmbeddedTableComponent_div_0_ng_container_1_Template,7,4,"ng-container",2)(2,WorkPackageEmbeddedTableComponent_div_0_div_2_Template,2,1,"div",3),r.k0s()),2&e){const e=r.XpG();r.Y8G("ngClass",r.sMw(4,_c0,!e.configuration.hierarchyToggleEnabled,e.configuration.compactTableStyle,e.externalHeight)),r.BMQ("data-indicator-name",e.uniqueEmbeddedTableName),r.R7$(),r.Y8G("ngIf",e.renderTable),r.R7$(),r.Y8G("ngIf",e.error)}}class WorkPackageEmbeddedTableComponent extends WorkPackageEmbeddedBaseComponent{constructor(){super(...arguments),this.queryProps={},this.tableActions=[],this.externalHeight=!1,this.onError=new r.bkB,this.onQueryLoaded=new r.bkB}ngOnInit(){super.ngOnInit(),this.loadedQuery=this.querySpace.query.value}ngAfterViewInit(){super.ngAfterViewInit(),this.tableActions&&this.tableActionsService.setActions(...this.tableActions),this.wpTablePagination.updates$().pipe((0,w.T)((e=>[e.page,e.perPage])),(0,T.F)(),this.untilDestroyed(),(0,S.E)(this.querySpace.query.values$())).subscribe((([e,t])=>{const n=this.wpTablePagination.paginationObject,i=this.urlParamsHelper.buildV3GetQueryFromQueryResource(t,n);this.loadingIndicator=(0,y._)(this.wpListService.loadQueryFromExisting(t,i,this.queryProjectScope)).then((e=>this.initializeStates(e)))}))}openConfigurationModal(e){var t=this;return(0,i.A)((function*(){yield t.querySpace.query.valuesPromise(),t.opModalService.show(c.E,t.injector).subscribe((t=>t.onDataUpdated.subscribe(e)))}))()}initializeStates(e){super.initializeStates(e),this.querySpace.initialized.values$().pipe((0,j.s)(1)).subscribe((()=>{this.showTablePagination=e.results.total>e.results.count,this.setLoaded(),this.wpTableTimeline.isVisible&&(this.configuration={...this.configuration,compactTableStyle:!1})}))}loadQuery(e=!0,t=!1){if(this.loadedQuery){const e=this.loadedQuery;return this.loadedQuery=void 0,this.initializeStates(e),Promise.resolve(e)}this.configuration.tableVisible||(this.queryProps.pageSize=1,this.queryProps.valid_subset=!0),t&&(this.queryProps.page=1),this.error=null;const n=this.apiv3Service.queries.find(this.queryProps,this.queryId,this.queryProjectScope).toPromise().then((e=>(this.initializeStates(e),this.onQueryLoaded.emit(e),e))).catch((e=>{this.error=this.I18n.t("js.error.embedded_table_loading",{message:_.get(e,"message",e)}),this.onError.emit(e)}));return e&&(this.loadingIndicator=n),n}handleWorkPackageClicked(e){e.double&&this.$state.go("work-packages.show",{workPackageId:e.workPackageId})}openStateLink(e){const t={workPackageId:e.workPackageId,focus:!0};"split"===e.requestedState?this.keepTab.goCurrentDetailsState(t):this.keepTab.goCurrentShowState(t)}static{this.ɵfac=(()=>{let e;return function WorkPackageEmbeddedTableComponent_Factory(t){return(e||(e=r.xGo(WorkPackageEmbeddedTableComponent)))(t||WorkPackageEmbeddedTableComponent)}})()}static{this.ɵcmp=r.VBU({type:WorkPackageEmbeddedTableComponent,selectors:[["wp-embedded-table"]],inputs:{queryId:"queryId",queryProps:"queryProps",tableActions:"tableActions",externalHeight:"externalHeight"},outputs:{onError:"onError",onQueryLoaded:"onQueryLoaded"},features:[r.Vt3],decls:1,vars:1,consts:[["class","work-packages-embedded-view--container loading-indicator--location",3,"ngClass",4,"ngIf"],[1,"work-packages-embedded-view--container","loading-indicator--location",3,"ngClass"],[4,"ngIf"],["class","op-toast -error",4,"ngIf"],[3,"showFilterButton","filterButtonText",4,"ngIf"],["class","work-packages-split-view--tabletimeline-content",3,"projectIdentifier","configuration","itemClicked","stateLinkClicked",4,"ngIf"],[1,"work-packages-embedded-view--grid-view"],[3,"configuration","itemClicked","stateLinkClicked",4,"ngIf"],[1,"work-packages-split-view--tabletimeline-footer","hide-when-print"],[3,"hideForSinglePageResults"],[3,"showFilterButton","filterButtonText"],[1,"work-packages-split-view--tabletimeline-content",3,"itemClicked","stateLinkClicked","projectIdentifier","configuration"],[3,"itemClicked","stateLinkClicked","configuration"],[1,"op-toast","-error"],[3,"textContent"]],template:function WorkPackageEmbeddedTableComponent_Template(e,t){1&e&&r.DNE(0,WorkPackageEmbeddedTableComponent_div_0_Template,3,8,"div",0),2&e&&r.Y8G("ngIf",t.configuration)},dependencies:[I.YU,I.bT,x.U,R.c,F.x,M.c],encapsulation:2})}}(0,o.Cg)([(0,b.O)(),(0,o.Sn)("design:type",k.n)],WorkPackageEmbeddedTableComponent.prototype,"apiv3Service",void 0),(0,o.Cg)([(0,b.O)(),(0,o.Sn)("design:type",p.a)],WorkPackageEmbeddedTableComponent.prototype,"opModalService",void 0),(0,o.Cg)([(0,b.O)(),(0,o.Sn)("design:type",l.A)],WorkPackageEmbeddedTableComponent.prototype,"tableActionsService",void 0),(0,o.Cg)([(0,b.O)(),(0,o.Sn)("design:type",s.X)],WorkPackageEmbeddedTableComponent.prototype,"wpTableTimeline",void 0),(0,o.Cg)([(0,b.O)(),(0,o.Sn)("design:type",a.I)],WorkPackageEmbeddedTableComponent.prototype,"wpTablePagination",void 0),(0,o.Cg)([(0,b.O)(),(0,o.Sn)("design:type",P.S)],WorkPackageEmbeddedTableComponent.prototype,"keepTab",void 0)},99320:(e,t,n)=>{"use strict";n.d(t,{X:()=>ExternalQueryConfigurationComponent});var i=n(95083),o=n(44131),r=n(7383),s=n(53169),a=n(85247),l=n(68559),c=n(63077);const p=["embeddedTableForConfiguration"],_c1=()=>({tableVisible:!1});class ExternalQueryConfigurationComponent{constructor(e,t,n){this.locals=e,this.urlParamsHelper=t,this.cdRef=n}ngOnInit(){this.locals.urlParams?this.queryProps=this.urlParamsHelper.buildV3GetQueryFromJsonParams(this.locals.currentQuery):this.queryProps=this.locals.currentQuery}ngAfterViewInit(){setTimeout((()=>{this.embeddedTable.openConfigurationModal((()=>{this.service.detach(),this.locals.urlParams?this.locals.callback(this.embeddedTable.buildUrlParams()):this.locals.callback(this.embeddedTable.buildQueryProps())})),this.cdRef.detectChanges()}))}get service(){return this.locals.service}static{this.ɵfac=function ExternalQueryConfigurationComponent_Factory(e){return new(e||ExternalQueryConfigurationComponent)(l.rXU(s.h),l.rXU(a.j),l.rXU(l.gRc))}}static{this.ɵcmp=l.VBU({type:ExternalQueryConfigurationComponent,selectors:[["ng-component"]],viewQuery:function ExternalQueryConfigurationComponent_Query(e,t){if(1&e&&l.GBs(p,7),2&e){let e;l.mGM(e=l.lsd())&&(t.embeddedTable=e.first)}},features:[l.Jv_([[{provide:o.B,useClass:r.G}]]),l.nM4([c.Y])],decls:2,vars:3,consts:[["embeddedTableForConfiguration",""],[3,"queryProps","configuration"]],template:function ExternalQueryConfigurationComponent_Template(e,t){1&e&&l.nrm(0,"wp-embedded-table",1,0),2&e&&l.Y8G("queryProps",t.queryProps)("configuration",l.lJ4(2,_c1))},dependencies:[i.Z],encapsulation:2})}}},53169:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});const i=new(n(68559).nKC)("OpQueryConfigurationLocalsToken")},74627:(e,t,n)=>{"use strict";n.d(t,{H:()=>ExternalQueryConfigurationService});var i=n(9168),o=n(83093),r=n(87879),s=n(99320),a=n(53169),l=n(68559);class ExternalQueryConfigurationService{constructor(e,t,n,i,o){this.componentFactoryResolver=e,this.FocusHelper=t,this.appRef=n,this.$transitions=i,this.injector=o}get bodyPortalHost(){if(!this._portalHostElement){const e=this._portalHostElement=document.createElement("div");e.classList.add("op-external-query-configuration--container"),document.body.appendChild(e),this._bodyPortalHost=new i.aI(e,this.componentFactoryResolver,this.appRef,this.injector)}return this._bodyPortalHost}show(e){this.detach();const t=new i.A8(this.externalQueryConfigurationComponent(),null,this.injectorFor(e));this.bodyPortalHost.attach(t),this._portalHostElement.style.display="block"}detach(){this.bodyPortalHost.hasAttached()&&(this.bodyPortalHost.detach(),this._portalHostElement.style.display="none")}injectorFor(e){const t=new WeakMap;return e.service=this,t.set(a.h,e),new i.JP(this.injector,t)}externalQueryConfigurationComponent(){return s.X}static{this.ɵfac=function ExternalQueryConfigurationService_Factory(e){return new(e||ExternalQueryConfigurationService)(l.KVO(l.OM3),l.KVO(r.k),l.KVO(l.o8S),l.KVO(o.HN),l.KVO(l.zZn))}}static{this.ɵprov=l.jDH({token:ExternalQueryConfigurationService,factory:ExternalQueryConfigurationService.ɵfac})}}},8878:(e,t,n)=>{"use strict";n.d(t,{H:()=>ExternalRelationQueryConfigurationComponent});var i=n(44131),o=n(7383),r=n(81213),s=n(16545),a=n(99320),l=n(68559),c=n(95083);const _c0=()=>({tableVisible:!1});class ExternalRelationQueryConfigurationComponent extends a.X{static{this.ɵfac=(()=>{let e;return function ExternalRelationQueryConfigurationComponent_Factory(t){return(e||(e=l.xGo(ExternalRelationQueryConfigurationComponent)))(t||ExternalRelationQueryConfigurationComponent)}})()}static{this.ɵcmp=l.VBU({type:ExternalRelationQueryConfigurationComponent,selectors:[["ng-component"]],features:[l.Jv_([[{provide:i.B,useClass:o.G}],{provide:s.K,useValue:r.G}]),l.Vt3],decls:2,vars:3,consts:[["embeddedTableForConfiguration",""],[3,"queryProps","configuration"]],template:function ExternalRelationQueryConfigurationComponent_Template(e,t){1&e&&l.nrm(0,"wp-embedded-table",1,0),2&e&&l.Y8G("queryProps",t.queryProps)("configuration",l.lJ4(2,_c0))},dependencies:[c.Z],encapsulation:2})}}},70130:(e,t,n)=>{"use strict";n.d(t,{R:()=>ExternalRelationQueryConfigurationService});var i=n(74627),o=n(8878),r=n(68559);class ExternalRelationQueryConfigurationService extends i.H{externalQueryConfigurationComponent(){return o.H}static{this.ɵfac=(()=>{let e;return function ExternalRelationQueryConfigurationService_Factory(t){return(e||(e=r.xGo(ExternalRelationQueryConfigurationService)))(t||ExternalRelationQueryConfigurationService)}})()}static{this.ɵprov=r.jDH({token:ExternalRelationQueryConfigurationService,factory:ExternalRelationQueryConfigurationService.ɵfac})}}},7383:(e,t,n)=>{"use strict";n.d(t,{G:()=>RestrictedWpTableConfigurationService});var i=n(61816),o=n(44131),r=n(53169),s=n(68559),a=n(83093);class RestrictedWpTableConfigurationService extends o.B{constructor(e,t,n){super(t,n),this.locals=e,this.I18n=t,this.$state=n}get tabs(){const e=this.locals.disabledTabs||{};return super.tabs.map((t=>{const n=e[t.id];return null!=n&&(t.disable=n),t}))}static{this.ɵfac=function RestrictedWpTableConfigurationService_Factory(e){return new(e||RestrictedWpTableConfigurationService)(s.KVO(r.h),s.KVO(i.W),s.KVO(a.dw))}}static{this.ɵprov=s.jDH({token:RestrictedWpTableConfigurationService,factory:RestrictedWpTableConfigurationService.ɵfac})}}},94530:(e,t,n)=>{"use strict";n.d(t,{t:()=>SortHeaderDirective});var i=n(61816),o=(n(3422),n(76008)),r=n(94450),s=n(1257),a=n(1750),l=n(98755),c=n(19999),p=n(99496),d=n(58154),u=n(68559),h=n(60316),m=n(46765);const _c0=(e,t)=>[e,t];function SortHeaderDirective_span_1_span_1_Template(e,t){if(1&e){const e=u.RV6();u.j41(0,"span",9),u.bIt("click",(function SortHeaderDirective_span_1_span_1_Template_span_click_0_listener(t){u.eBV(e);const n=u.XpG(2);return u.Njj(n.toggleHierarchy(t))})),u.nrm(1,"op-icon",10),u.k0s()}if(2&e){const e=u.XpG(2);u.BMQ("title",e.text.toggleHierarchy),u.R7$(),u.Mz_("icon-classes","icon ",e.hierarchyIcon,"")}}function SortHeaderDirective_span_1_a_2_Template(e,t){if(1&e&&(u.j41(0,"a",11),u.EFF(1),u.k0s()),2&e){const e=u.XpG(2);u.FS9("lang",e.locale),u.FS9("id",e.headerColumn.id),u.Y8G("ngClass",u.l_i(4,_c0,e.directionClass&&"sort",e.directionClass)),u.R7$(),u.JRh(e.headerColumn.name)}}function SortHeaderDirective_span_1_a_3_Template(e,t){if(1&e&&(u.j41(0,"a"),u.EFF(1),u.k0s()),2&e){const e=u.XpG(2);u.R7$(),u.JRh(e.headerColumn.name)}}function SortHeaderDirective_span_1_op_icon_4_Template(e,t){if(1&e&&u.nrm(0,"op-icon",12),2&e){const e=u.XpG(2);u.FS9("icon-title",e.text.openMenu)}}function SortHeaderDirective_span_1_Template(e,t){if(1&e&&(u.j41(0,"span",4),u.DNE(1,SortHeaderDirective_span_1_span_1_Template,2,3,"span",5)(2,SortHeaderDirective_span_1_a_2_Template,2,7,"a",6)(3,SortHeaderDirective_span_1_a_3_Template,2,1,"a",7)(4,SortHeaderDirective_span_1_op_icon_4_Template,1,1,"op-icon",8),u.k0s()),2&e){const e=u.XpG();u.R7$(),u.Y8G("ngIf",e.displayHierarchyIcon),u.R7$(),u.Y8G("ngIf",e.sortable),u.R7$(),u.Y8G("ngIf",!e.sortable),u.R7$(),u.Y8G("ngIf",e.displayDropdownIcon)}}function SortHeaderDirective_span_2_op_icon_4_Template(e,t){if(1&e&&u.nrm(0,"op-icon",12),2&e){const e=u.XpG(2);u.FS9("icon-title",e.text.openMenu)}}function SortHeaderDirective_span_2_Template(e,t){if(1&e&&(u.j41(0,"span",4)(1,"a"),u.nrm(2,"op-icon",13),u.EFF(3),u.k0s(),u.DNE(4,SortHeaderDirective_span_2_op_icon_4_Template,1,1,"op-icon",8),u.k0s()),2&e){const e=u.XpG();u.R7$(),u.BMQ("title",e.headerColumn.name),u.R7$(2),u.SpI(" ",e.columnName," "),u.R7$(),u.Y8G("ngIf",e.displayDropdownIcon)}}function SortHeaderDirective_span_3_Template(e,t){1&e&&u.nrm(0,"span",14)}function SortHeaderDirective_span_4_a_1_Template(e,t){if(1&e&&(u.j41(0,"a",11),u.EFF(1),u.k0s()),2&e){const e=u.XpG(2);u.FS9("lang",e.locale),u.FS9("id",e.headerColumn.id),u.Y8G("ngClass",u.l_i(4,_c0,e.directionClass&&"sort",e.directionClass)),u.R7$(),u.JRh(e.headerColumn.name)}}function SortHeaderDirective_span_4_a_2_Template(e,t){if(1&e&&(u.j41(0,"a"),u.EFF(1),u.k0s()),2&e){const e=u.XpG(2);u.R7$(),u.JRh(e.headerColumn.name)}}function SortHeaderDirective_span_4_span_3_Template(e,t){if(1&e&&u.nrm(0,"span",16),2&e){const e=u.XpG(2);u.BMQ("title",e.text.baselineIncompatible)}}function SortHeaderDirective_span_4_op_icon_4_Template(e,t){if(1&e&&u.nrm(0,"op-icon",12),2&e){const e=u.XpG(2);u.FS9("icon-title",e.text.openMenu)}}function SortHeaderDirective_span_4_Template(e,t){if(1&e&&(u.j41(0,"span",4),u.DNE(1,SortHeaderDirective_span_4_a_1_Template,2,7,"a",6)(2,SortHeaderDirective_span_4_a_2_Template,2,1,"a",7)(3,SortHeaderDirective_span_4_span_3_Template,1,1,"span",15)(4,SortHeaderDirective_span_4_op_icon_4_Template,1,1,"op-icon",8),u.k0s()),2&e){const e=u.XpG();u.R7$(),u.Y8G("ngIf",e.sortable),u.R7$(),u.Y8G("ngIf",!e.sortable),u.R7$(),u.Y8G("ngIf",e.baselineIncompatible),u.R7$(),u.Y8G("ngIf",e.displayDropdownIcon)}}class SortHeaderDirective extends p.p{constructor(e,t,n,i,o,r,s,a){super(),this.wpTableHierarchies=e,this.wpTableSortBy=t,this.wpTableGroupBy=n,this.wpTableBaseline=i,this.wpTableRelationColumns=o,this.elementRef=r,this.cdRef=s,this.I18n=a,this.text={toggleHierarchy:this.I18n.t("js.work_packages.hierarchy.show"),openMenu:this.I18n.t("js.label_open_menu"),baselineIncompatible:this.I18n.t("js.work_packages.baseline.column_incompatible")},this.baselineIncompatible=!1}ngAfterViewInit(){setTimeout((()=>this.initialize()))}initialize(){(0,c.z)([this.wpTableSortBy.onReadyWithAvailable(),this.wpTableSortBy.live$()]).pipe(this.untilDestroyed()).subscribe((()=>{const e=this.wpTableSortBy.current[0];e&&this.headerColumn.href===e.column.href?this.currentSortDirection=e.direction:this.currentSortDirection=null,this.setActiveColumnClass(),this.sortable=this.wpTableSortBy.isSortable(this.headerColumn),this.directionClass=this.getDirectionClass(),this.cdRef.detectChanges()})),this.isHierarchyColumn="subject"===this.headerColumn.id,"sortHandle"===this.headerColumn.id&&(this.columnType="sort"),this.isHierarchyColumn?this.columnType="hierarchy":"toType"===this.wpTableRelationColumns.relationColumnType(this.headerColumn)?(this.columnType="relation",this.columnName=this.headerColumn.type.name):"ofType"===this.wpTableRelationColumns.relationColumnType(this.headerColumn)&&(this.columnType="relation",this.columnName=I18n.t(`js.relation_labels.${this.headerColumn.relationType}`)),this.isHierarchyColumn&&(this.hierarchyIcon="icon-hierarchy",this.isHierarchyDisabled=this.wpTableGroupBy.isEnabled,this.wpTableGroupBy.live$().pipe(this.untilDestroyed()).subscribe((()=>{this.isHierarchyDisabled=this.wpTableGroupBy.isEnabled,this.cdRef.detectChanges()})),this.wpTableHierarchies.live$().pipe(this.untilDestroyed()).subscribe((()=>{this.setHierarchyIcon(),this.cdRef.detectChanges()})),this.setHierarchyIcon()),this.wpTableBaseline.live$().pipe(this.untilDestroyed()).subscribe((()=>{this.baselineIncompatible=this.wpTableBaseline.isActive()&&this.wpTableBaseline.isIncompatibleColumn(this.headerColumn.id)})),this.cdRef.detectChanges()}get displayDropdownIcon(){return this.table&&this.table.configuration.columnMenuEnabled}get displayHierarchyIcon(){return this.table&&this.table.configuration.hierarchyToggleEnabled}toggleHierarchy(e){return this.wpTableHierarchies.toggleState()&&this.wpTableGroupBy.disable(),this.setHierarchyIcon(),e.stopPropagation(),!1}setHierarchyIcon(){this.wpTableHierarchies.isEnabled?(this.text.toggleHierarchy=I18n.t("js.work_packages.hierarchy.hide"),this.hierarchyIcon="icon-hierarchy"):(this.text.toggleHierarchy=I18n.t("js.work_packages.hierarchy.show"),this.hierarchyIcon="icon-no-hierarchy")}getDirectionClass(){if(!this.currentSortDirection)return"";switch(this.currentSortDirection.href){case o.cG:return"asc";case o.yM:return"desc";default:return""}}setActiveColumnClass(){this.currentSortDirection?this.elementRef.nativeElement.classList.add("active-column"):this.elementRef.nativeElement.classList.remove("active-column")}static{this.ɵfac=function SortHeaderDirective_Factory(e){return new(e||SortHeaderDirective)(u.rXU(r.j),u.rXU(s.P),u.rXU(a.W),u.rXU(d.b1),u.rXU(l.f),u.rXU(u.aKT),u.rXU(u.gRc),u.rXU(i.W))}}static{this.ɵcmp=u.VBU({type:SortHeaderDirective,selectors:[["sortHeader"]],inputs:{headerColumn:"headerColumn",locale:"locale",table:"table"},features:[u.Vt3],decls:5,vars:4,consts:[[1,"generic-table--sort-header-outer",3,"ngSwitch"],["class","generic-table--sort-header",4,"ngSwitchCase"],["class","draggable-table--sort-header",4,"ngSwitchCase"],["class","generic-table--sort-header",4,"ngSwitchDefault"],[1,"generic-table--sort-header"],["class","hierarchy-header--icon","tabindex","-1","aria-hidden","true",3,"click",4,"ngIf"],["href","#","lang-attribute","","rel","nofollow",3,"ngClass","lang","id",4,"ngIf"],[4,"ngIf"],["icon-classes","dropdown-indicator icon-small icon-pulldown",3,"icon-title",4,"ngIf"],["tabindex","-1","aria-hidden","true",1,"hierarchy-header--icon",3,"click"],[3,"icon-classes"],["href","#","lang-attribute","","rel","nofollow",3,"ngClass","lang","id"],["icon-classes","dropdown-indicator icon-small icon-pulldown",3,"icon-title"],["icon-classes","icon-context icon-relations relations-header--icon"],[1,"draggable-table--sort-header"],["class","spot-icon spot-icon_1_25 spot-icon_warning",4,"ngIf"],[1,"spot-icon","spot-icon_1_25","spot-icon_warning"]],template:function SortHeaderDirective_Template(e,t){1&e&&(u.j41(0,"div",0),u.DNE(1,SortHeaderDirective_span_1_Template,5,4,"span",1)(2,SortHeaderDirective_span_2_Template,5,3,"span",1)(3,SortHeaderDirective_span_3_Template,1,0,"span",2)(4,SortHeaderDirective_span_4_Template,5,4,"span",3),u.k0s()),2&e&&(u.Y8G("ngSwitch",t.columnType),u.R7$(),u.Y8G("ngSwitchCase","hierarchy"),u.R7$(),u.Y8G("ngSwitchCase","relation"),u.R7$(),u.Y8G("ngSwitchCase","sort"))},dependencies:[h.YU,h.bT,h.ux,h.e1,h.fG,m.i],encapsulation:2})}}},34522:(e,t,n)=>{"use strict";n.d(t,{D2:()=>c,GZ:()=>s,Gj:()=>a,K8:()=>OpTableAction,Kd:()=>l});var i=n(24398),o=n(61816),r=n(1758);const s="wp-table--context-menu-td",a="wp-table--context-menu-span",l="wp-table-context-menu-link",c="wp-table-context-menu-icon";class OpTableAction{constructor(e,t){this.injector=e,this.workPackage=t}}(0,i.Cg)([(0,r.O)(),(0,i.Sn)("design:type",o.W)],OpTableAction.prototype,"I18n",void 0)},1567:(e,t,n)=>{"use strict";n.d(t,{A:()=>OpTableActionsService});var i=n(34522),o=n(25073),r=n(66309),s=n(79421),a=n(83093);class OpDetailsTableAction extends i.K8{constructor(){super(...arguments),this.identifier="open-details-action",this.uiStatebuilder=new s.Xq(this.injector.get(a.dw),this.injector.get(r.S)),this.text={button:this.I18n.t("js.button_open_details")}}buildElement(){const e=this.uiStatebuilder.linkToDetails(this.workPackage.id,this.text.button,"");return e.classList.add("wp-table--details-link",i.D2,"hidden-for-mobile"),e.appendChild((0,o.N)("icon","icon-info2")),e}}class OpContextMenuTableAction extends i.K8{constructor(){super(...arguments),this.identifier="open-context-menu-action",this.text={linkTitle:this.I18n.t("js.label_open_context_menu")}}buildElement(){const e=document.createElement("a");return e.href="#",e.classList.add(i.Kd,i.D2),e.title=this.text.linkTitle,e.appendChild((0,o.N)("icon","icon-show-more-horizontal")),e}}var l=n(68559);class OpTableActionsService{constructor(e){this.injector=e,this.actions=[(e,t)=>new OpDetailsTableAction(e,t),(e,t)=>new OpContextMenuTableAction(e,t)]}setActions(...e){this.actions=e}render(e){const t=this.actions.map((t=>t(this.injector,e).buildElement()));return _.compact(t)}static{this.ɵfac=function OpTableActionsService_Factory(e){return new(e||OpTableActionsService)(l.KVO(l.zZn))}}static{this.ɵprov=l.jDH({token:OpTableActionsService,factory:OpTableActionsService.ɵfac})}}},64940:(e,t,n)=>{"use strict";n.d(t,{x:()=>WorkPackageTablePaginationComponent});var i=n(19999),o=n(61816),r=n(49989),s=n(1257),a=n(11048),l=n(13813),c=n(81965),p=n(68559),d=n(60316),u=n(46765);const _c0=e=>({"op-pagination--item_current":e});function WorkPackageTablePaginationComponent_div_0_ng_container_6_li_1_Template(e,t){if(1&e){const e=p.RV6();p.j41(0,"li",15)(1,"button",16),p.bIt("click",(function WorkPackageTablePaginationComponent_div_0_ng_container_6_li_1_Template_button_click_1_listener(){const t=p.eBV(e).$implicit,n=p.XpG(3);return p.Njj(n.showPage(t))})),p.k0s()()}if(2&e){const e=t.$implicit;p.R7$(),p.Y8G("textContent",e)}}function WorkPackageTablePaginationComponent_div_0_ng_container_6_Template(e,t){if(1&e&&(p.qex(0),p.DNE(1,WorkPackageTablePaginationComponent_div_0_ng_container_6_li_1_Template,2,1,"li",13),p.j41(2,"li",14),p.EFF(3,"…"),p.k0s(),p.bVm()),2&e){const e=p.XpG(2);p.R7$(),p.Y8G("ngForOf",e.prePageNumbers)}}function WorkPackageTablePaginationComponent_div_0_ng_container_7_li_1_em_1_Template(e,t){if(1&e&&(p.j41(0,"em"),p.EFF(1),p.k0s()),2&e){const e=p.XpG().$implicit;p.R7$(),p.JRh(e)}}function WorkPackageTablePaginationComponent_div_0_ng_container_7_li_1_button_2_Template(e,t){if(1&e){const e=p.RV6();p.j41(0,"button",16),p.bIt("click",(function WorkPackageTablePaginationComponent_div_0_ng_container_7_li_1_button_2_Template_button_click_0_listener(){p.eBV(e);const t=p.XpG().$implicit,n=p.XpG(3);return p.Njj(n.showPage(t))})),p.k0s()}if(2&e){const e=p.XpG().$implicit;p.Y8G("textContent",e)}}function WorkPackageTablePaginationComponent_div_0_ng_container_7_li_1_Template(e,t){if(1&e&&(p.j41(0,"li",19),p.DNE(1,WorkPackageTablePaginationComponent_div_0_ng_container_7_li_1_em_1_Template,2,1,"em",6)(2,WorkPackageTablePaginationComponent_div_0_ng_container_7_li_1_button_2_Template,1,1,"button",20),p.k0s()),2&e){const e=t.$implicit,n=p.XpG(3);p.Y8G("ngClass",p.eq3(3,_c0,e===n.pagination.page)),p.R7$(),p.Y8G("ngIf",e===n.pagination.page),p.R7$(),p.Y8G("ngIf",e!==n.pagination.page)}}function WorkPackageTablePaginationComponent_div_0_ng_container_7_li_2_Template(e,t){1&e&&(p.j41(0,"li",14),p.EFF(1,"…"),p.k0s())}function WorkPackageTablePaginationComponent_div_0_ng_container_7_Template(e,t){if(1&e&&(p.qex(0),p.DNE(1,WorkPackageTablePaginationComponent_div_0_ng_container_7_li_1_Template,3,5,"li",17)(2,WorkPackageTablePaginationComponent_div_0_ng_container_7_li_2_Template,2,0,"li",18),p.bVm()),2&e){const e=p.XpG(2);p.R7$(),p.Y8G("ngForOf",e.pageNumbers),p.R7$(),p.Y8G("ngIf",e.postPageNumbers.length)}}function WorkPackageTablePaginationComponent_div_0_ng_container_8_li_1_Template(e,t){if(1&e){const e=p.RV6();p.j41(0,"li",15)(1,"button",16),p.bIt("click",(function WorkPackageTablePaginationComponent_div_0_ng_container_8_li_1_Template_button_click_1_listener(){const t=p.eBV(e).$implicit,n=p.XpG(3);return p.Njj(n.showPage(t))})),p.k0s()()}if(2&e){const e=t.$implicit;p.R7$(),p.Y8G("textContent",e)}}function WorkPackageTablePaginationComponent_div_0_ng_container_8_Template(e,t){if(1&e&&(p.qex(0),p.DNE(1,WorkPackageTablePaginationComponent_div_0_ng_container_8_li_1_Template,2,1,"li",13),p.bVm()),2&e){const e=p.XpG(2);p.R7$(),p.Y8G("ngForOf",e.postPageNumbers)}}function WorkPackageTablePaginationComponent_div_0_span_14_Template(e,t){if(1&e&&p.nrm(0,"span",21),2&e){const e=p.XpG(2);p.Y8G("textContent",e.text.no_other_page)}}function WorkPackageTablePaginationComponent_div_0_li_15_Template(e,t){if(1&e&&(p.j41(0,"li",22),p.nrm(1,"op-icon",23)(2,"span",9),p.k0s()),2&e){const e=p.XpG(2);p.R7$(2),p.Y8G("textContent",e.infoText)}}function WorkPackageTablePaginationComponent_div_0_div_16_li_3_span_1_Template(e,t){if(1&e){const e=p.RV6();p.j41(0,"span")(1,"button",27),p.bIt("click",(function WorkPackageTablePaginationComponent_div_0_div_16_li_3_span_1_Template_button_click_1_listener(){p.eBV(e);const t=p.XpG().$implicit,n=p.XpG(3);return p.Njj(n.selectPerPage(t))})),p.k0s()()}if(2&e){const e=p.XpG().$implicit;p.R7$(),p.Y8G("textContent",e)}}function WorkPackageTablePaginationComponent_div_0_div_16_li_3_span_2_Template(e,t){if(1&e&&(p.j41(0,"span"),p.EFF(1),p.k0s()),2&e){const e=p.XpG().$implicit;p.R7$(),p.JRh(e)}}function WorkPackageTablePaginationComponent_div_0_div_16_li_3_Template(e,t){if(1&e&&(p.j41(0,"li",19),p.DNE(1,WorkPackageTablePaginationComponent_div_0_div_16_li_3_span_1_Template,2,1,"span",6)(2,WorkPackageTablePaginationComponent_div_0_div_16_li_3_span_2_Template,2,1,"span",6),p.k0s()),2&e){const e=t.$implicit,n=p.XpG(3);p.Y8G("ngClass",p.eq3(3,_c0,e===n.pagination.perPage)),p.R7$(),p.Y8G("ngIf",e!==n.pagination.perPage),p.R7$(),p.Y8G("ngIf",e===n.pagination.perPage)}}function WorkPackageTablePaginationComponent_div_0_div_16_Template(e,t){if(1&e&&(p.j41(0,"div",24)(1,"ul",25),p.nrm(2,"li",26),p.DNE(3,WorkPackageTablePaginationComponent_div_0_div_16_li_3_Template,3,5,"li",17),p.k0s()()),2&e){const e=p.XpG(2);p.R7$(2),p.FS9("title",e.text.per_page),p.Y8G("textContent",e.text.per_page),p.R7$(),p.Y8G("ngForOf",e.perPageOptions)}}function WorkPackageTablePaginationComponent_div_0_Template(e,t){if(1&e){const e=p.RV6();p.j41(0,"div",1)(1,"nav",2)(2,"ul",3)(3,"li",4)(4,"button",5),p.bIt("click",(function WorkPackageTablePaginationComponent_div_0_Template_button_click_4_listener(){p.eBV(e);const t=p.XpG();return p.Njj(t.showPage(t.pagination.page-1))})),p.EFF(5," < "),p.k0s()(),p.DNE(6,WorkPackageTablePaginationComponent_div_0_ng_container_6_Template,4,1,"ng-container",6)(7,WorkPackageTablePaginationComponent_div_0_ng_container_7_Template,3,2,"ng-container",6)(8,WorkPackageTablePaginationComponent_div_0_ng_container_8_Template,2,1,"ng-container",6),p.j41(9,"li",4)(10,"button",7),p.bIt("click",(function WorkPackageTablePaginationComponent_div_0_Template_button_click_10_listener(){p.eBV(e);const t=p.XpG();return p.Njj(t.showPage(t.pagination.page+1))})),p.EFF(11," > "),p.k0s()(),p.j41(12,"li",8),p.nrm(13,"span",9),p.DNE(14,WorkPackageTablePaginationComponent_div_0_span_14_Template,1,1,"span",10),p.k0s(),p.DNE(15,WorkPackageTablePaginationComponent_div_0_li_15_Template,3,1,"li",11),p.k0s()(),p.DNE(16,WorkPackageTablePaginationComponent_div_0_div_16_Template,4,3,"div",12),p.k0s()}if(2&e){const e=p.XpG();p.R7$(3),p.Y8G("hidden",1===e.pagination.page||!e.showPageSelections),p.R7$(),p.BMQ("aria-label",e.text.label_previous),p.R7$(2),p.Y8G("ngIf",e.prePageNumbers.length>0),p.R7$(),p.Y8G("ngIf",e.pageNumbers.length>1),p.R7$(),p.Y8G("ngIf",e.postPageNumbers.length),p.R7$(),p.Y8G("hidden",!(e.pagination.total&&e.pagination.page<e.pageNumbers[e.pageNumbers.length-1])),p.R7$(),p.BMQ("aria-label",e.text.label_next),p.R7$(3),p.Y8G("textContent",e.currentRange),p.R7$(),p.Y8G("ngIf",1===e.pageNumbers.length),p.R7$(),p.Y8G("ngIf",e.infoText),p.R7$(),p.Y8G("ngIf",e.showPerPageOptions())}}class WorkPackageTablePaginationComponent extends l.w{constructor(e,t,n,i,o,r){super(e,t,r),this.paginationService=e,this.cdRef=t,this.wpTablePagination=n,this.querySpace=i,this.wpTableSortBy=o,this.I18n=r}ngOnInit(){super.ngOnInit(),this.wpTablePagination.live$().pipe(this.untilDestroyed()).subscribe((e=>{this.pagination=e.current,this.update()})),(0,i.z)([this.querySpace.query.values$(),this.wpTableSortBy.live$()]).pipe(this.untilDestroyed()).subscribe((([e,t])=>{this.showPerPage=this.showPageSelections=!this.isManualSortingMode,this.infoText=this.paginationInfoText(e.results),this.update()}))}selectPerPage(e){this.paginationService.setPerPage(e),this.wpTablePagination.updateFromObject({page:1,perPage:e})}showPage(e){this.wpTablePagination.updateFromObject({page:e})}get isManualSortingMode(){return this.wpTableSortBy.isManualSortingMode}paginationInfoText(e){if(this.isManualSortingMode&&e.count<e.total)return I18n.t("js.work_packages.limited_results",{count:e.count})}static{this.ɵfac=function WorkPackageTablePaginationComponent_Factory(e){return new(e||WorkPackageTablePaginationComponent)(p.rXU(c.m),p.rXU(p.gRc),p.rXU(r.I),p.rXU(a.i),p.rXU(s.P),p.rXU(o.W))}}static{this.ɵcmp=p.VBU({type:WorkPackageTablePaginationComponent,selectors:[["wp-table-pagination"]],features:[p.Vt3],decls:1,vars:1,consts:[["class","op-pagination",4,"ngIf"],[1,"op-pagination"],[1,"op-pagination--pages"],[1,"op-pagination--items","op-pagination--items_start"],[1,"op-pagination--item",3,"hidden"],["type","button","rel","prev start",1,"op-pagination--item-link","op-pagination--item-link_prev",3,"click"],[4,"ngIf"],["type","button","rel","next",1,"op-pagination--item-link","op-pagination--item-link_next",3,"click"],[1,"op-pagination--range"],[3,"textContent"],["id","op-pagination-empty-text","tabindex","0","class","hidden-for-sighted",3,"textContent",4,"ngIf"],["class","op-pagination--info",4,"ngIf"],["class","op-pagination--options",4,"ngIf"],["class","op-pagination--item",4,"ngFor","ngForOf"],[1,"op-pagination--space"],[1,"op-pagination--item"],["type","button","rel","next",1,"op-pagination--item-link",3,"click","textContent"],["class","op-pagination--item",3,"ngClass",4,"ngFor","ngForOf"],["class","op-pagination--space",4,"ngIf"],[1,"op-pagination--item",3,"ngClass"],["class","op-pagination--item-link","type","button","rel","next",3,"textContent","click",4,"ngIf"],["id","op-pagination-empty-text","tabindex","0",1,"hidden-for-sighted",3,"textContent"],[1,"op-pagination--info"],["icon-classes","icon-info1 icon-context"],[1,"op-pagination--options"],[1,"op-pagination--items","op-pagination--items_end"],[1,"op-pagination--label",3,"textContent","title"],["type","button",1,"op-pagination--item-link",3,"click","textContent"]],template:function WorkPackageTablePaginationComponent_Template(e,t){1&e&&p.DNE(0,WorkPackageTablePaginationComponent_div_0_Template,17,11,"div",0),2&e&&p.Y8G("ngIf",t.pagination&&t.isVisible&&t.pagination.total)},dependencies:[d.YU,d.Sq,d.bT,u.i],encapsulation:2,changeDetection:0})}}},13517:(e,t,n)=>{"use strict";n.d(t,{$K:()=>s,Cr:()=>r,HY:()=>calculatePositionValueForDayCountingPx,Hs:()=>TimelineViewParameters,JO:()=>calculatePositionValueForDayCount,Qy:()=>c,W0:()=>getPixelPerDayForZoomLevel,W8:()=>p,_$:()=>l,bS:()=>d,lR:()=>calculateDaySpan,pz:()=>o,q1:()=>a,tI:()=>getTimeSlicesForHeader});var i=n(39545);const o="timeline-element",r="timeline-element--bg",s="wp-timeline--grid-element",a="selection-start",l="wp-timeline--header-element",c="wp-timeline-header";class TimelineViewParametersSettings{constructor(){this.zoomLevel="days",this.visibleBeforeTodayInZoomLevel=2}}const p=["days","weeks","months","quarters","years"];function getPixelPerDayForZoomLevel(e){switch(e){case"days":return 30;case"weeks":return 15;case"months":return 6;case"quarters":return 2;case"years":return.5}throw new Error(`invalid zoom level: ${e}`)}const d=120;class TimelineViewParameters{constructor(){this.now=i({hour:0,minute:0,seconds:0}),this.dateDisplayStart=i({hour:0,minute:0,seconds:0}),this.dateDisplayEnd=this.dateDisplayStart.clone().add(1,"day"),this.settings=new TimelineViewParametersSettings,this.activeSelectionMode=null,this.selectionModeStart=null}get pixelPerDay(){return getPixelPerDayForZoomLevel(this.settings.zoomLevel)}get maxWidthInPx(){return this.maxSteps*this.pixelPerDay}get maxSteps(){return this.dateDisplayEnd.diff(this.dateDisplayStart,"days")}get dayCountForMarginLeft(){return Math.ceil(d/this.pixelPerDay)}}function calculatePositionValueForDayCountingPx(e,t){return t*e.pixelPerDay}function calculatePositionValueForDayCount(e,t){return`${calculatePositionValueForDayCountingPx(e,t)}px`}function getTimeSlicesForHeader(e,t,n,o){const r=[],s=[],a=n.clone().startOf(t),l=o.clone().endOf(t);for(;a.isBefore(l);){const l=i.max(a,n).clone(),c=i.min(a.clone().endOf(t),o).clone();a.add(1,t);const p=e.visibleViewportAtCalculationTime;l.isSameOrAfter(p[0])&&l.isSameOrBefore(p[1])||c.isSameOrAfter(p[0])&&c.isSameOrBefore(p[1])?r.push([l,c]):s.push([l,c])}const c=s.splice(0,1)[0],p=s.pop();return{inViewportAndBoundaries:_.concat([c].filter((e=>!_.isNil(e))),r,[p].filter((e=>!_.isNil(e)))),rest:s}}function calculateDaySpan(e,t,n){let o=i(),r=i();e.forEach((e=>{const n=e.workPackageId;if(!n)return;const s=t.get(n).value;if(!s)return;const a=s.startDate?s.startDate:s.date;a&&i(a).isBefore(o)&&(o=i(a));const l=s.dueDate?s.dueDate:s.date;l&&i(l).isAfter(r)&&(r=i(l))}));return r.diff(o,"days")+1}},49025:(e,t,n)=>{"use strict";n.d(t,{y:()=>WorkPackageTableConfiguration});class WorkPackageTableConfiguration{constructor(e){this.tableVisible=!0,this.compactTableStyle=!1,this.actionsColumnEnabled=!0,this.contextMenuEnabled=!0,this.columnMenuEnabled=!0,this.projectContext=!0,this.projectIdentifier=null,this.inlineCreateEnabled=!0,this.hierarchyToggleEnabled=!0,this.dragAndDropEnabled=!1,this.isEmbedded=!1,this.isCardView=!1,this.withFilters=!1,this.filtersExpanded=!1,this.showFilterButton=!1,this.filterButtonText=I18n.t("js.button_filter"),_.each(e,((e,t)=>{this[t]=e}))}}},70512:(e,t,n)=>{"use strict";n.d(t,{_e:()=>o,hn:()=>createScrollSync});const i=".work-packages-tabletimeline--table-side",o=".work-packages-tabletimeline--timeline-side",r=".scroll-sync",s=15;function getPlattformAgnosticScrollAmount(e){if(0===e)return e;let t=s;return e<0&&(t*=-1),t}function syncWheelEvent(e,t,n){const i=e.target,o=e.originalEvent;let[r,s]=function getXandYScrollDeltas(e){let t=e.deltaX,n=e.deltaY;return e.shiftKey&&(t=n,n=0),[t,n]}(o);0!==s&&(r=getPlattformAgnosticScrollAmount(r),s=getPlattformAgnosticScrollAmount(s),window.requestAnimationFrame((()=>{t[0].scrollTop=t[0].scrollTop+s,n[0].scrollTop=t[0].scrollTop+s,i.scrollLeft+=r})))}function createScrollSync(e){const t=jQuery(e).find(i),n=jQuery(e).find(o);return e=>{let i=!1,o=!1;e?(t.on(`wheel${r}`,(e=>{syncWheelEvent(e,t,n)})),t.on(`scroll${r}`,(e=>{i=!0,o||(n[0].scrollTop=e.target.scrollTop),i&&o&&(i=!1,o=!1)})),n.on(`wheel${r}`,(e=>{syncWheelEvent(e,t,n)})),n.on(`scroll${r}`,(e=>{o=!0,i||(t[0].scrollTop=e.target.scrollTop),i&&o&&(i=!1,o=!1)}))):t.off(r)}}},43311:(e,t,n)=>{"use strict";n.d(t,{c:()=>WorkPackagesTableComponent});var i=n(68559),o=n(61816),r=n(24398),s=n(33900),a=n(91817),l=n(11048),c=n(62665),p=n(1758);class HighlightingTransformer{constructor(e,t){this.injector=e,this.wpTableHighlighting.updates$().pipe((0,s.Q)(this.querySpace.stopAllSubscriptions),(0,a.F)()).subscribe((()=>t.redrawTable()))}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",c.I)],HighlightingTransformer.prototype,"wpTableHighlighting",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",l.i)],HighlightingTransformer.prototype,"querySpace",void 0);var d=n(89204),u=n(64334),h=n(27871),m=n(40358),g=n(1257),f=n(9845),b=n(13432),k=n(72407),v=n(21162),C=n(13344),y=n(51524),w=n(75275),T=n(95445),S=n(14593),j=n(28952),P=n(40659),I=n(56196);class DragAndDropTransformer{constructor(e,t){var n,i,o,r=this;(this.injector=e,this.table=t,null!==this.dragService)&&(this.inlineCreateService.newInlineWorkPackageCreated.pipe((0,s.Q)(this.querySpace.stopAllSubscriptions)).subscribe(function(){var e=(0,d.A)((function*(e){const t=yield r.wpTableOrder.add(r.currentOrder,e);r.updateRenderedOrder(t)}));return function(t){return e.apply(this,arguments)}}()),this.querySpace.stopAllSubscriptions.pipe((0,u.s)(1)).subscribe((()=>{this.dragService.remove(this.table.tbody)})),this.dragService.register({dragContainer:this.table.tbody,scrollContainers:[this.table.scrollContainer],accepts:()=>!0,moves:(e,t,n)=>{if(!n.classList.contains("wp-table--drag-and-drop-handle"))return!1;const i=e.dataset.workPackageId,o=this.states.workPackages.get(i).value;return!!o&&this.actionService.canPickup(o)},onMoved:(o=(0,d.A)((function*(e,t,n,i){const o=e.dataset.workPackageId;let s;try{const t=yield(0,I._)(r.apiV3Service.work_packages.id(o).get());if((0,j.nT)(i)){const e=Array.from(i.classList).find((e=>e.includes((0,P.Bj)()))).replace((0,P.Bj)(),""),t=n.getElementsByClassName((0,P.Bj)(e)),o=t[t.length-1];s=r.findRowIndex(o)}else s=r.findRowIndex(e);const a=yield r.wpTableOrder.move(r.currentOrder,o,s);yield r.actionService.handleDrop(t,e),r.updateRenderedOrder(a),r.actionService.onNewOrder(a);const l=r.querySpace.query.value;l&&r.wpTableSortBy.switchToManualSorting(l)&&(yield r.wpListService.createOrSave(l))}catch(t){r.halNotification.handleRawError(t),r.actionService.changeShadowElement(e,!0),(0,C.l)(e,e.dataset.sourceIndex||-1,n)}})),function onMoved(e,t,n,i){return o.apply(this,arguments)}),onRemoved:e=>{const t=e.dataset.workPackageId,n=this.wpTableOrder.remove(this.currentOrder,t);this.updateRenderedOrder(n)},onAdded:(i=(0,d.A)((function*(e){const t=e.dataset.workPackageId,n=yield(0,I._)(r.apiV3Service.work_packages.id(t).get()),i=r.findRowIndex(e);return r.actionService.handleDrop(n,e).then((0,d.A)((function*(){const e=yield r.wpTableOrder.add(r.currentOrder,t,i);return r.updateRenderedOrder(e),r.actionService.onNewOrder(e),!0}))).catch((()=>!1))})),function onAdded(e){return i.apply(this,arguments)}),onCloned:(n=(0,d.A)((function*(e,t){const n=t.dataset.workPackageId,i=yield(0,I._)(r.apiV3Service.work_packages.id(n).get()),o=e.children.length,s=document.createElement("td");s.textContent=i.subjectWithId(),s.colSpan=o,s.classList.add("wp-table--cell-td","subject"),e.style.maxWidth="500px",e.innerHTML=s.outerHTML})),function onCloned(e,t){return n.apply(this,arguments)}),onShadowInserted:e=>{this.browserDetector.isEdge||this.actionService.changeShadowElement(e)},onCancel:e=>{this.browserDetector.isEdge||this.actionService.changeShadowElement(e,!0)}}))}updateRenderedOrder(e){var t=this;return(0,d.A)((function*(){e=_.uniq(e);const n=yield Promise.all(e.map((e=>(0,I._)(t.apiV3Service.work_packages.id(e).get()))));t.table.initialSetup(n)}))()}get actionService(){return this.dragActionRegistry.get(this.injector)}get currentOrder(){return this.currentRenderedOrder.map((e=>e.workPackageId))}get currentRenderedOrder(){return this.querySpace.renderedWorkPackages.getValueOr([])}findRowIndex(e){return Array.from(this.table.tbody.getElementsByClassName(k.Wc)).indexOf(e)||0}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",b.D)],DragAndDropTransformer.prototype,"states",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",l.i)],DragAndDropTransformer.prototype,"querySpace",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",h.O)],DragAndDropTransformer.prototype,"inlineCreateService",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",m.Y)],DragAndDropTransformer.prototype,"halNotification",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",g.P)],DragAndDropTransformer.prototype,"wpTableSortBy",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",y.k)],DragAndDropTransformer.prototype,"wpTableOrder",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",w.l)],DragAndDropTransformer.prototype,"browserDetector",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",S.n)],DragAndDropTransformer.prototype,"apiV3Service",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",T.E)],DragAndDropTransformer.prototype,"wpListService",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",f._)],DragAndDropTransformer.prototype,"dragActionRegistry",void 0),(0,r.Cg)([(0,p.O)(v.W,null),(0,r.Sn)("design:type",Object)],DragAndDropTransformer.prototype,"dragService",void 0);var x=n(37339),R=n(59769);class GroupFoldTransformer{constructor(e,t){this.injector=e,this.workPackageViewCollapsedGroupsService.updates$().pipe((0,s.Q)(this.querySpace.stopAllSubscriptions),(0,a.F)()).subscribe((e=>t.setGroupsCollapseState(e.state)))}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",R.V)],GroupFoldTransformer.prototype,"workPackageViewCollapsedGroupsService",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",l.i)],GroupFoldTransformer.prototype,"querySpace",void 0);var F=n(60807),M=n(51339),O=n(49763),D=n(36819),G=n(26655);class EditCellHandler extends G.c{get EVENT(){return"click.table.cell, keydown.table.cell"}get SELECTOR(){return`.${F.IB}.${F.UJ}`}eventScope(e){return jQuery(e.workPackageTable.tableAndTimelineContainer)}constructor(e){super(),this.injector=e}processEvent(e,t){(0,D.cY)("Starting editing on cell: ",t.target),t.preventDefault();const n=jQuery(t.target).closest(`.${F.IB}`),i=n.data("fieldName");if(!i)return void(0,D.cY)("Click handled by cell not a field? ",t.target);const o=n.closest(`.${k.Wc}`),r=o.data("workPackageId"),s=this.states.workPackages.get(r).value,a=o.data("classIdentifier"),l=e.editing.startEditing(s,a),c=(0,O.E)(t);l.activate(i).then((e=>{e.$onUserActivate.next(),e.focus(c)})).catch((()=>n.addClass(F.Sx)))}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",b.D)],EditCellHandler.prototype,"states",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",M.p)],EditCellHandler.prototype,"halEditing",void 0);var E=n(98755),A=n(82839);class RelationsCellHandler extends G.c{get EVENT(){return"click.table.relationsCell, keydown.table.relationsCell"}get SELECTOR(){return`.${A.r7}`}eventScope(e){return jQuery(e.workPackageTable.tableAndTimelineContainer)}constructor(e){super(),this.injector=e}processEvent(e,t){(0,D.cY)("Handled click on relation cell %o",t.target),t.preventDefault();const n=jQuery(t.target).closest(`.${A.U$}`).data("columnId"),i=jQuery(t.target).closest(`.${k.Wc}`).data("workPackageId");this.wpTableRelationColumns.getExpandFor(i)===n?this.wpTableRelationColumns.collapse(i):this.wpTableRelationColumns.setExpandFor(i,n)}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",E.f)],RelationsCellHandler.prototype,"wpTableRelationColumns",void 0);var V=n(34522),$=n(79421),B=n(67369),W=n(56439),N=n(87454);class WorkPackageTableContextMenu extends W.L{constructor(e,t,n,i={},o){super(e,t,n,i,!0),this.injector=e,this.workPackageId=t,this.$element=n,this.additionalPositionArgs=i,this.table=o}triggerContextMenuAction(e){switch(e.key){case"relation-precedes":this.table.timelineController.startAddRelationPredecessor(this.workPackage);break;case"relation-follows":this.table.timelineController.startAddRelationFollower(this.workPackage);break;case"hierarchy-indent":this.wpViewIndentation.indent(this.workPackage);break;case"hierarchy-outdent":this.wpViewIndentation.outdent(this.workPackage);break;default:super.triggerContextMenuAction(e)}}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",N.a)],WorkPackageTableContextMenu.prototype,"wpViewIndentation",void 0);class ContextMenuHandler{constructor(e){this.injector=e}get rowSelector(){return`.${k.Wc}`}eventScope(e){return jQuery(e.workPackageTable.tableAndTimelineContainer)}openContextMenu(e,t,n,i){const o=new WorkPackageTableContextMenu(this.injector,n,jQuery(t.target),i,e);this.opContextMenu.show(o,t)}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",B.V)],ContextMenuHandler.prototype,"opContextMenu",void 0);class ContextMenuClickHandler extends ContextMenuHandler{constructor(e){super(e),this.injector=e}get EVENT(){return"click.table.contextmenu"}get SELECTOR(){return`.${V.Kd}`}handleEvent(e,t){const n=jQuery(t.target);if(n.closest(`.${$.qk}`).length)return(0,D.cY)("Allowing original context menu on state link"),!0;t.preventDefault(),t.stopPropagation();const i=n.closest(this.rowSelector).data("workPackageId");return i&&this.openContextMenu(e.workPackageTable,t,i),!1}}var U=n(41670);class ContextMenuKeyboardHandler extends ContextMenuHandler{constructor(e){super(e),this.injector=e}get EVENT(){return"keydown.table.contextmenu"}get SELECTOR(){return this.rowSelector}handleEvent(e,t){if(!e.workPackageTable.configuration.contextMenuEnabled)return!1;const n=jQuery(t.target);if(t.keyCode!==U.c.F10||!t.shiftKey||!t.altKey)return!0;t.preventDefault(),t.stopPropagation();const i=n.closest(this.SELECTOR).data("workPackageId"),o={my:"left top",at:"left bottom",of:n};return super.openContextMenu(e.workPackageTable,t,i,o),!1}}var Y=n(29925),X=n(78158);class ContextMenuRightClickHandler extends ContextMenuHandler{constructor(e){super(e),this.injector=e}get EVENT(){return"contextmenu.table.rightclick"}get SELECTOR(){return`.${k.Wc},.${X.T}`}eventScope(e){return jQuery(e.workPackageTable.tableAndTimelineContainer)}handleEvent(e,t){if(!e.workPackageTable.configuration.contextMenuEnabled)return!1;const n=jQuery(t.target);if(n.closest(`.${$.qk}`).length)return(0,D.cY)("Allowing original context menu on state link"),!0;t.preventDefault(),t.stopPropagation();const i=n.closest(this.SELECTOR).data("workPackageId");if(i){const[n]=e.workPackageTable.findRenderedRow(i);this.wpTableSelection.isSelected(i)||this.wpTableSelection.setSelection(i,n),this.openContextMenu(e.workPackageTable,t,i)}return!1}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",Y.a)],ContextMenuRightClickHandler.prototype,"wpTableSelection",void 0);var q=n(83093),L=n(79),H=n(51053),z=n(66309);class RowClickHandler{constructor(e){this.injector=e}get EVENT(){return"click.table.row"}get SELECTOR(){return`.${k.Wc}`}eventScope(e){return jQuery(e.workPackageTable.tbody)}handleEvent(e,t){const n=jQuery(t.target);if(n.is("a")||n.parent().is("a"))return!0;if(n.hasClass(`${F.IB}`)||n.hasClass(`${H.qG}`))return(0,D.cY)("Skipping click on inner cell"),!0;const i=n.closest(this.SELECTOR),o=i.data("workPackageId"),r=i.data("classIdentifier");if(!o)return!0;const[s,a]=e.workPackageTable.findRenderedRow(r);return t.ctrlKey||t.metaKey||t.shiftKey||(this.wpTableSelection.setSelection(o,s),e.itemClicked.emit({workPackageId:o,double:!1})),t.shiftKey&&this.wpTableSelection.setMultiSelectionFrom(e.workPackageTable.renderedRows,o,s),(t.ctrlKey||t.metaKey)&&this.wpTableSelection.toggleRow(o),e.selectionChanged.emit(this.wpTableSelection.getSelectedWorkPackageIds()),this.wpTableFocus.updateFocus(o),!1}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",q.dw)],RowClickHandler.prototype,"$state",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",b.D)],RowClickHandler.prototype,"states",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",z.S)],RowClickHandler.prototype,"keepTab",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",Y.a)],RowClickHandler.prototype,"wpTableSelection",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",L.c)],RowClickHandler.prototype,"wpTableFocus",void 0);var Q=n(2183),K=n(11262);class RowDoubleClickHandler{constructor(e){this.injector=e}get EVENT(){return"dblclick.table.row"}get SELECTOR(){return`.${K.IZ}`}eventScope(e){return jQuery(e.workPackageTable.tbody)}handleEvent(e,t){const n=jQuery(t.target);if((0,Q.R)(t))return!0;if(n.hasClass(`${F.IB}`)||n.hasClass(`${H.qG}`))return(0,D.cY)("Skipping click on inner cell"),!0;const i=n.closest(this.SELECTOR).closest(`.${k.Wc}`).data("workPackageId");return!(!n.is("a")&&!n.parent().is("a"))||(this.wpTableFocus.updateFocus(i),e.itemClicked.emit({workPackageId:i,double:!0}),!1)}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",q.dw)],RowDoubleClickHandler.prototype,"$state",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",b.D)],RowDoubleClickHandler.prototype,"states",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",Y.a)],RowDoubleClickHandler.prototype,"wpTableSelection",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",L.c)],RowDoubleClickHandler.prototype,"wpTableFocus",void 0);var J=n(56368);class GroupRowHandler{constructor(e){this.injector=e}get EVENT(){return"click.table.groupheader"}get SELECTOR(){return`.${J.D} .expander`}eventScope(e){return jQuery(e.workPackageTable.tbody)}handleEvent(e,t){t.preventDefault(),t.stopPropagation();const n=jQuery(t.target).parents(`.${J.D}`).data("groupIdentifier");this.workPackageViewCollapsedGroupsService.toggleGroupCollapseState(n)}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",l.i)],GroupRowHandler.prototype,"querySpace",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",R.V)],GroupRowHandler.prototype,"workPackageViewCollapsedGroupsService",void 0);var Z=n(94450);class HierarchyClickHandler extends G.c{constructor(e){super(),this.injector=e}get EVENT(){return"click.table.hierarchy"}get SELECTOR(){return".wp-table--hierarchy-indicator"}eventScope(e){return jQuery(e.workPackageTable.tbody)}processEvent(e,t){const n=jQuery(t.target).closest(`.${k.Wc}`).data("workPackageId");this.wpTableHierarchies.toggle(n),t.stopImmediatePropagation(),t.preventDefault()}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",b.D)],HierarchyClickHandler.prototype,"states",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",Z.j)],HierarchyClickHandler.prototype,"wpTableHierarchies",void 0);class WorkPackageStateLinksHandler{constructor(e){this.injector=e}get EVENT(){return"click.table.wpLink"}get SELECTOR(){return`.${$.qk}`}eventScope(e){return jQuery(e.workPackageTable.tableAndTimelineContainer)}handleEvent(e,t){if(t.stopPropagation(),t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)return!0;const n=t.target,i=n.closest(this.SELECTOR),o=i.dataset.wpState,r=i.dataset.workPackageId;if(!o||!r)return!0;n.closest("a")?.blur();const s=n.closest(`.${k.Wc}`).dataset.classIdentifier,[a]=e.workPackageTable.findRenderedRow(s);return this.wpTableSelection.setSelection(r,a),e.stateLinkClicked.emit({workPackageId:r,requestedState:o}),t.preventDefault(),!1}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",q.dw)],WorkPackageStateLinksHandler.prototype,"$state",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",z.S)],WorkPackageStateLinksHandler.prototype,"keepTab",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",b.D)],WorkPackageStateLinksHandler.prototype,"states",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",Y.a)],WorkPackageStateLinksHandler.prototype,"wpTableSelection",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",L.c)],WorkPackageStateLinksHandler.prototype,"wpTableFocus",void 0);var ee=n(88352);class ColumnsTransformer{constructor(e,t){this.injector=e,this.table=t,this.wpTableColumns.updates$().pipe((0,s.Q)(this.querySpace.stopAllSubscriptions)).subscribe((()=>{if(t.originalRows.length>0){const e=performance.now();t.redrawTable();const n=performance.now();(0,D.cY)(`column redraw took ${n-e} milliseconds.`)}}))}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",l.i)],ColumnsTransformer.prototype,"querySpace",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",ee.T)],ColumnsTransformer.prototype,"wpTableColumns",void 0);var te=n(70271),ne=n(51567),ie=n(75808);class HierarchyTransformer{constructor(e,t){this.injector=e,this.wpTableHierarchies.updates$().pipe((0,s.Q)(this.querySpace.stopAllSubscriptions),(0,te.T)((e=>e.isVisible)),(0,a.F)()).subscribe((()=>{this.wpTableHierarchies.isEnabled||t.redrawTableAndTimeline()}));let n=this.wpTableHierarchies.isEnabled;this.wpTableHierarchies.updates$().pipe((0,s.Q)(this.querySpace.stopAllSubscriptions),(0,ne.p)((()=>this.querySpace.tableRendered.hasValue()))).subscribe((e=>{e.isVisible===n&&this.renderHierarchyState(e),n=e.isVisible}))}renderHierarchyState(e){const t=this.querySpace.tableRendered.value;jQuery('[class^="__hierarchy-group-"]').removeClass(((e,t)=>(t.match(/__collapsed-group-\d+/g)||[]).join(" ")));const n={};_.each(e.collapsed,((e,i)=>{jQuery(`.${(0,P.GK)(i)} .wp-table--hierarchy-indicator`).toggleClass(ie.T5,e);const o=document.querySelector(`.wp-timeline-cell.__hierarchy-root-${i}`);o&&(e?o.classList.add("__hierarchy-root-collapsed"):o.classList.remove("__hierarchy-root-collapsed"));const r=jQuery(`.${(0,P.LB)(i)}`);r.toggleClass((0,P.Bj)(i),e),r.filter(`.${k.Wc}`).each(((i,o)=>{const r=jQuery(o).index();n[r]||(t[r].hidden=e,n[r]=e)}))})),e.last&&(0,j.bU)(e.last),this.querySpace.tableRendered.putValue(t,"Updated hidden state of rows after hierarchy change.")}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",Z.j)],HierarchyTransformer.prototype,"wpTableHierarchies",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",l.i)],HierarchyTransformer.prototype,"querySpace",void 0);class RelationsTransformer{constructor(e,t){this.injector=e,this.wpTableRelationColumns.updates$().pipe((0,s.Q)(this.querySpace.stopAllSubscriptions)).subscribe((()=>{t.redrawTableAndTimeline()}))}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",E.f)],RelationsTransformer.prototype,"wpTableRelationColumns",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",l.i)],RelationsTransformer.prototype,"querySpace",void 0);class RowsTransformer{constructor(e,t){this.injector=e,this.table=t,this.querySpace.initialized.values$().pipe((0,s.Q)(this.querySpace.stopAllSubscriptions)).subscribe((()=>{let e;e=this.wpTableSortBy.isManualSortingMode?this.wpTableOrder.orderedWorkPackages():this.querySpace.results.value.elements,t.initialSetup(e)})),this.states.workPackages.observeChange().pipe((0,s.Q)(this.querySpace.stopAllSubscriptions.asObservable()),(0,ne.p)((()=>{const e=this.querySpace.tableRendered.getValueOr([]);return e&&e.length>0}))).subscribe((([e,t])=>{void 0!==t&&this.table.refreshRows(t)}))}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",l.i)],RowsTransformer.prototype,"querySpace",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",g.P)],RowsTransformer.prototype,"wpTableSortBy",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",y.k)],RowsTransformer.prototype,"wpTableOrder",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",b.D)],RowsTransformer.prototype,"states",void 0);var oe=n(87879);class SelectionTransformer{constructor(e,t){this.injector=e,this.table=t,this.querySpace.tableRendered.values$().pipe((0,s.Q)(this.querySpace.stopAllSubscriptions)).subscribe((()=>{this.wpTableFocus.ifShouldFocus((e=>{const t=(0,j.LC)(e);t.length&&((0,j.bU)(e),this.FocusHelper.focus(t[0]))}))})),this.wpTableSelection.live$().pipe((0,s.Q)(this.querySpace.stopAllSubscriptions)).subscribe((e=>{this.renderSelectionState(e)})),this.wpTableSelection.registerSelectAllListener((()=>t.renderedRows)),this.wpTableSelection.registerDeselectAllListener()}renderSelectionState(e){const t=jQuery(this.table.tableAndTimelineContainer);t.find(`.${k.Wc}.${$.BE}`).removeClass($.BE),_.each(e.selected,((e,n)=>{t.find(`.${k.Wc}[data-work-package-id="${n}"]`).toggleClass($.BE,e)}))}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",Y.a)],SelectionTransformer.prototype,"wpTableSelection",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",L.c)],SelectionTransformer.prototype,"wpTableFocus",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",l.i)],SelectionTransformer.prototype,"querySpace",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",oe.k)],SelectionTransformer.prototype,"FocusHelper",void 0);var re=n(68222);class TimelineTransformer{constructor(e,t){this.injector=e,this.table=t,this.wpTableTimeline.live$().pipe((0,s.Q)(this.querySpace.stopAllSubscriptions)).subscribe((e=>{this.renderVisibility(e.visible)}))}renderVisibility(e){const t=jQuery(this.table.tableAndTimelineContainer).parent();t.find(".work-packages-tabletimeline--timeline-side").toggle(e),t.find(".work-packages-tabletimeline--table-side").toggleClass("-timeline-visible",e)}}(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",l.i)],TimelineTransformer.prototype,"querySpace",void 0),(0,r.Cg)([(0,p.O)(),(0,r.Sn)("design:type",re.X)],TimelineTransformer.prototype,"wpTableTimeline",void 0);var se=n(94564),ae=n(59048),le=n(58103);class SharingTransformer{constructor(e,t){this.injector=e,this.table=t,this.actions$=this.injector.get(se.d),this.actions$.ofType(ae.q).pipe((0,te.T)((e=>e.workPackageId)),(0,ne.p)((e=>!!this.table.renderedRows.find((t=>t.workPackageId===e))))).subscribe((()=>{this.actions$.dispatch((0,le.$)())}))}}class TableHandlerRegistry extends x.C{constructor(){super(...arguments),this.eventHandlers=[()=>new HierarchyClickHandler(this.injector),()=>new EditCellHandler(this.injector),()=>new WorkPackageStateLinksHandler(this.injector),()=>new RowClickHandler(this.injector),()=>new RowDoubleClickHandler(this.injector),()=>new GroupRowHandler(this.injector),()=>new ContextMenuRightClickHandler(this.injector),()=>new ContextMenuClickHandler(this.injector),()=>new ContextMenuKeyboardHandler(this.injector),()=>new RelationsCellHandler(this.injector)],this.stateTransformers=[SelectionTransformer,RowsTransformer,ColumnsTransformer,GroupFoldTransformer,TimelineTransformer,HierarchyTransformer,RelationsTransformer,SharingTransformer,HighlightingTransformer,DragAndDropTransformer]}attachTo(e){this.stateTransformers.map((t=>new t(this.injector,e.workPackageTable))),super.attachTo(e)}}var ce=n(19999),pe=n(55596),de=n(1750),ue=n(70512);const he="row-hovered";class WpTableHoverSync{constructor(e){this.tableAndTimeline=e,this.lastHoveredElement=null,this.eventListener=e=>{const t=e.target;t&&t!==this.lastHoveredElement&&this.handleHover(t),this.lastHoveredElement=t}}activate(){window.addEventListener("mousemove",this.eventListener,{passive:!0})}deactivate(){window.removeEventListener("mousemove",this.eventListener),this.removeAllHoverClasses()}locateHoveredTableRow(e){const t=e.closest("tr");return 0===t.length?null:t[0]}locateHoveredTimelineRow(e){const t=e.closest("div.wp-timeline-cell");return 0===t.length?null:t[0]}handleHover(e){const t=jQuery(e),n=this.locateHoveredTableRow(t),i=this.locateHoveredTimelineRow(t);null!==n||null!==i?this.removeOldAndAddNewHoverClass(n,i):this.removeAllHoverClasses()}extractWorkPackageId(e){return parseInt(e.getAttribute("data-work-package-id"))}removeOldAndAddNewHoverClass(e,t){const n=null!==e?e:t,i=this.extractWorkPackageId(n),o=this.tableAndTimeline.find(`tr.wp-row-${i}`).first(),r=this.tableAndTimeline.find(`div.wp-row-${i}`).length?this.tableAndTimeline.find(`div.wp-row-${i}`).first():this.tableAndTimeline.find(`div.wp-ancestor-row-${i}`).first();requestAnimationFrame((()=>{this.removeAllHoverClasses(),r.addClass(he),o.addClass(he)}))}removeAllHoverClasses(){this.tableAndTimeline.find(`.${he}`).removeClass(he)}}var me=n(3422),ge=n(99496),_e=n(55332),fe=n(49025),be=n(58154);const _c0=()=>[],_c1=(e,t)=>({"-single-margin":e,"-double-margin":t}),_c2=()=>["estimatedTime","remainingTime"],_c3=(e,t)=>({"-max":e,"-min-200":t});function WorkPackagesTableComponent_div_0_col_4_Template(e,t){1&e&&i.nrm(0,"col",20)}function WorkPackagesTableComponent_div_0_col_5_Template(e,t){1&e&&i.nrm(0,"col",20)}function WorkPackagesTableComponent_div_0_col_6_Template(e,t){1&e&&i.nrm(0,"col")}function WorkPackagesTableComponent_div_0_col_7_Template(e,t){1&e&&i.nrm(0,"col")}function WorkPackagesTableComponent_div_0_col_8_Template(e,t){1&e&&i.nrm(0,"col",20)}function WorkPackagesTableComponent_div_0_th_17_op_icon_2_Template(e,t){1&e&&i.nrm(0,"op-icon",24)}function WorkPackagesTableComponent_div_0_th_17_Template(e,t){if(1&e&&(i.j41(0,"th",21)(1,"div",22),i.DNE(2,WorkPackagesTableComponent_div_0_th_17_op_icon_2_Template,1,0,"op-icon",23),i.k0s()()),2&e){const e=i.XpG(2);i.R7$(2),i.Y8G("ngIf",e.manualSortEnabled)}}function WorkPackagesTableComponent_div_0_th_18_Template(e,t){1&e&&(i.j41(0,"th",25)(1,"div",26),i.nrm(2,"span",27),i.k0s()())}function WorkPackagesTableComponent_div_0_th_19_Template(e,t){if(1&e&&(i.j41(0,"th",28),i.nrm(1,"sortHeader",29),i.k0s()),2&e){const e=t.$implicit,n=i.XpG(2);i.Y8G("ngClass",i.l_i(7,_c3,"subject"===e.id,i.lJ4(6,_c2).includes(e.id))),i.R7$(),i.Y8G("headerColumn",e)("locale",e.custom_field&&e.custom_field.name_locale||n.locale)("table",n.workPackageTable)("opColumnsContextMenu-column",e)("opColumnsContextMenu-table",n.workPackageTable)}}function WorkPackagesTableComponent_div_0_th_20_div_1_Template(e,t){1&e&&(i.j41(0,"div",32),i.nrm(1,"wp-table-config-menu"),i.k0s())}function WorkPackagesTableComponent_div_0_th_20_Template(e,t){if(1&e&&(i.j41(0,"th",30),i.DNE(1,WorkPackagesTableComponent_div_0_th_20_div_1_Template,2,0,"div",31),i.k0s()),2&e){const e=i.XpG(2);i.R7$(),i.Y8G("ngIf",e.configuration.columnMenuEnabled)}}function WorkPackagesTableComponent_div_0_tbody_21_Template(e,t){if(1&e&&(i.j41(0,"tbody",33)(1,"tr",34)(2,"td")(3,"span"),i.nrm(4,"op-icon",35),i.j41(5,"span")(6,"strong"),i.EFF(7),i.k0s(),i.EFF(8),i.k0s()()()()()),2&e){const e=i.XpG(2);i.R7$(2),i.BMQ("colspan",e.numTableColumns),i.R7$(5),i.JRh(e.text.noResults.title),i.R7$(),i.SpI(" ",e.text.noResults.description," ")}}function WorkPackagesTableComponent_div_0_tbody_25_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"tbody",36),i.bIt("showing",(function WorkPackagesTableComponent_div_0_tbody_25_Template_tbody_showing_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.inlineCreateVisible=t)})),i.k0s()}if(2&e){const e=i.XpG(2);i.Y8G("colspan",e.numTableColumns)("table",e.workPackageTable)("projectIdentifier",e.projectIdentifier)}}function WorkPackagesTableComponent_div_0_div_26_Template(e,t){1&e&&(i.j41(0,"div",37),i.nrm(1,"wp-resizer",38),i.k0s()),2&e&&(i.R7$(),i.Y8G("elementClass","work-packages-tabletimeline--timeline-side")("resizeEvent","wp-resize.timeline")("variableName","--gantt-split-width")("localStorageKey","openProject-timelineFlexBasis"))}function WorkPackagesTableComponent_div_0_Template(e,t){if(1&e&&(i.j41(0,"div",1)(1,"div",2)(2,"table",3)(3,"colgroup"),i.DNE(4,WorkPackagesTableComponent_div_0_col_4_Template,1,0,"col",4)(5,WorkPackagesTableComponent_div_0_col_5_Template,1,0,"col",4)(6,WorkPackagesTableComponent_div_0_col_6_Template,1,0,"col",5)(7,WorkPackagesTableComponent_div_0_col_7_Template,1,0,"col",6)(8,WorkPackagesTableComponent_div_0_col_8_Template,1,0,"col",4),i.k0s(),i.j41(9,"caption",7)(10,"span"),i.EFF(11),i.k0s(),i.nrm(12,"span",8),i.j41(13,"span"),i.EFF(14),i.k0s()(),i.j41(15,"thead",9)(16,"tr"),i.DNE(17,WorkPackagesTableComponent_div_0_th_17_Template,3,1,"th",10)(18,WorkPackagesTableComponent_div_0_th_18_Template,3,0,"th",11)(19,WorkPackagesTableComponent_div_0_th_19_Template,2,10,"th",12)(20,WorkPackagesTableComponent_div_0_th_20_Template,2,1,"th",13),i.k0s()(),i.DNE(21,WorkPackagesTableComponent_div_0_tbody_21_Template,9,3,"tbody",14),i.nrm(22,"tbody",15),i.j41(23,"tbody"),i.nrm(24,"tr",16),i.k0s(),i.DNE(25,WorkPackagesTableComponent_div_0_tbody_25_Template,1,3,"tbody",17),i.k0s()(),i.DNE(26,WorkPackagesTableComponent_div_0_div_26_Template,2,4,"div",18),i.j41(27,"div",19),i.nrm(28,"wp-timeline-container"),i.k0s()()),2&e){const e=i.XpG();i.R7$(2),i.AVh("op-table-baseline",e.baselineEnabled),i.R7$(2),i.Y8G("ngIf",e.configuration.dragAndDropEnabled),i.R7$(),i.Y8G("ngIf",e.baselineEnabled),i.R7$(),i.Y8G("ngForOf",i.lJ4(19,_c0).constructor(e.columns.length)),i.R7$(),i.Y8G("ngIf",e.configuration.columnMenuEnabled),i.R7$(),i.Y8G("ngIf",!e.configuration.columnMenuEnabled),i.R7$(3),i.JRh(e.text.tableSummary),i.R7$(3),i.JRh(e.text.tableSummaryHints),i.R7$(3),i.Y8G("ngIf",e.configuration.dragAndDropEnabled),i.R7$(),i.Y8G("ngIf",e.baselineEnabled),i.R7$(),i.Y8G("ngForOf",e.columns)("ngForTrackBy",e.trackByHref),i.R7$(),i.Y8G("ngIf",e.configuration.columnMenuEnabled||e.configuration.actionsColumnEnabled),i.R7$(),i.Y8G("ngIf",!e.isEmbedded&&e.query&&0===e.results.count),i.R7$(3),i.Y8G("wpTableSumsRow-table",e.workPackageTable),i.R7$(),i.Y8G("ngIf",e.tableElement&&e.configuration.inlineCreateEnabled),i.R7$(),i.Y8G("ngIf",!e.configuration.isEmbedded),i.R7$(),i.Y8G("ngClass",i.l_i(20,_c1,(e.sumVisible||e.inlineCreateVisible)&&!(e.sumVisible&&e.inlineCreateVisible),e.sumVisible&&e.inlineCreateVisible))}}class WorkPackagesTableComponent extends ge.p{constructor(e,t,n,o,r,s,a,l,c,p,d,u,h){super(),this.elementRef=e,this.injector=t,this.states=n,this.querySpace=o,this.I18n=r,this.cdRef=s,this.zone=a,this.wpTableGroupBy=l,this.wpTableTimeline=c,this.wpTableColumns=p,this.wpTableSortBy=d,this.wpTableSums=u,this.wpTableBaseline=h,this.selectionChanged=new i.bkB,this.itemClicked=new i.bkB,this.stateLinkClicked=new i.bkB,this.trackByHref=pe.S0,this.limitedResults=!1,this.inlineCreateVisible=!1,this.sumVisible=!1}ngOnInit(){this.configuration=new fe.y(this.configurationObject),this.$element=jQuery(this.elementRef.nativeElement),this.querySpace.stopAllSubscriptions.next(),this.locale=I18n.locale,this.text={cancel:I18n.t("js.button_cancel"),noResults:{title:I18n.t("js.work_packages.no_results.title"),description:I18n.t("js.work_packages.no_results.description")},limitedResults:(e,t)=>I18n.t("js.work_packages.limited_results",{count:e,total:t}),tableSummary:I18n.t("js.work_packages.table.summary"),tableSummaryHints:[I18n.t("js.work_packages.table.text_inline_edit"),I18n.t("js.work_packages.table.text_select_hint"),I18n.t("js.work_packages.table.text_sort_hint")].join(" ")};(0,ce.z)([this.querySpace.results.values$(),this.wpTableGroupBy.live$(),this.wpTableColumns.live$(),this.wpTableTimeline.live$(),this.wpTableSortBy.live$(),this.wpTableSums.live$(),this.wpTableBaseline.live$()]).pipe(this.untilDestroyed()).subscribe((([e,t,n,i,o,r])=>{this.query=this.querySpace.query.value,this.results=e,this.sumVisible=r,this.groupBy=t,this.columns=n,this.timelineVisible=i.visible,this.manualSortEnabled=this.wpTableSortBy.isManualSortingMode,this.baselineEnabled=this.wpTableBaseline.isActive(),this.limitedResults=this.manualSortEnabled&&e.total>e.count,this.numTableColumns=this.columns.length+2,this.manualSortEnabled&&(this.numTableColumns+=1),this.baselineEnabled&&(this.numTableColumns+=1),this.workPackageTable&&(this.workPackageTable.colspan=this.numTableColumns),this.scrollSyncUpdate&&this.timelineVisible!==i.visible&&this.scrollSyncUpdate(i.visible),this.cdRef.detectChanges()})),this.cdRef.detectChanges()}ngOnDestroy(){super.ngOnDestroy(),this.wpTableHoverSync.deactivate()}registerTimeline(e,t){const n=this.$element.find(".work-package--results-tbody"),i=this.$element.find(".work-package-table--container")[0];this.workPackageTable=new me.G(this.injector,this.$element[0],i,n[0],t,e,this.configuration),this.workPackageTable.colspan=this.numTableColumns,this.tbody=n,e.workPackageTable=this.workPackageTable,new TableHandlerRegistry(this.injector).attachTo(this);const o=this.getTableAndTimelineElement();this.tableElement=o[0],this.timeline=o[1],this.wpTableHoverSync=new WpTableHoverSync(this.$element),this.wpTableHoverSync.activate(),this.scrollSyncUpdate=(0,ue.hn)(this.$element),this.scrollSyncUpdate(this.timelineVisible),this.cdRef.detectChanges()}get isEmbedded(){return this.configuration.isEmbedded}getTableAndTimelineElement(){const e=this.$element.find(".work-packages-tabletimeline--table-side"),t=this.$element.find(".work-packages-tabletimeline--timeline-side");if(0===t.length||0===e.length)throw new Error("invalid state");return[e[0],t[0]]}static{this.ɵfac=function WorkPackagesTableComponent_Factory(e){return new(e||WorkPackagesTableComponent)(i.rXU(i.aKT),i.rXU(i.zZn),i.rXU(b.D),i.rXU(l.i),i.rXU(o.W),i.rXU(i.gRc),i.rXU(i.SKi),i.rXU(de.W),i.rXU(re.X),i.rXU(ee.T),i.rXU(g.P),i.rXU(_e.X),i.rXU(be.b1))}}static{this.ɵcmp=i.VBU({type:WorkPackagesTableComponent,selectors:[["wp-table"]],inputs:{projectIdentifier:"projectIdentifier",configurationObject:[i.Mj6.None,"configuration","configurationObject"]},outputs:{selectionChanged:"selectionChanged",itemClicked:"itemClicked",stateLinkClicked:"stateLinkClicked"},features:[i.Vt3],decls:1,vars:1,consts:[["class","work-packages-split-view--tabletimeline-content",4,"ngIf"],[1,"work-packages-split-view--tabletimeline-content"],[1,"work-packages-tabletimeline--table-side","work-package-table--container","__hidden_overflow_container"],["data-controller","table-highlighting",1,"keyboard-accessible-list","generic-table","work-package-table"],["data-highlight","false",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"hidden-for-sighted"],["id","wp-table-sort-summary"],[1,"-sticky"],["class","wp-table--manual-sort-th -short hide-when-print",4,"ngIf"],["class","wp-table--baseline-th -short hide-when-print",4,"ngIf"],["class","wp-table--table-header",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["class","wp-table--configuration-modal--trigger wp-table--context-menu-th -short hide-when-print",4,"ngIf"],["class","work-package--empty-tbody",4,"ngIf"],[1,"results-tbody","work-package--results-tbody"],["wpTableSumsRow","",1,"wp-table--sums-row","wp-table--row",3,"wpTableSumsRow-table"],["wpInlineCreate","",3,"colspan","table","projectIdentifier","showing",4,"ngIf"],["class","work-packages--tabletimeline--timeline--resizer hidden-for-mobile hide-when-print",4,"ngIf"],[1,"work-packages-tabletimeline--timeline-side",3,"ngClass"],["data-highlight","false"],[1,"wp-table--manual-sort-th","-short","hide-when-print"],[1,"generic-table--empty-header"],["icon-classes","icon-sort-by",4,"ngIf"],["icon-classes","icon-sort-by"],[1,"wp-table--baseline-th","-short","hide-when-print"],[1,"generic-table--empty-header","op-table-baseline--column-header"],[1,"spot-icon","spot-icon_baseline"],[1,"wp-table--table-header",3,"ngClass"],["opColumnsContextMenu","",3,"headerColumn","locale","table","opColumnsContextMenu-column","opColumnsContextMenu-table"],[1,"wp-table--configuration-modal--trigger","wp-table--context-menu-th","-short","hide-when-print"],["class","generic-table--sort-header-outer",4,"ngIf"],[1,"generic-table--sort-header-outer"],[1,"work-package--empty-tbody"],["id","empty-row-notification"],["icon-classes","icon-info1 icon-context"],["wpInlineCreate","",3,"showing","colspan","table","projectIdentifier"],[1,"work-packages--tabletimeline--timeline--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","resizeEvent","variableName","localStorageKey"]],template:function WorkPackagesTableComponent_Template(e,t){1&e&&i.DNE(0,WorkPackagesTableComponent_div_0_Template,29,23,"div",0),2&e&&i.Y8G("ngIf",t.query)},styles:[".wp-table--drag-and-drop-handle:hover{cursor:move}\n"],encapsulation:2,changeDetection:0})}}},4213:(e,t,n)=>{"use strict";n.d(t,{B:()=>WpTabWrapperComponent});var i=n(83093),o=n(61816),r=n(14593),s=n(70271),a=n(33924),l=n(68559),c=n(60316),p=n(25827);const _c0=e=>({workPackage:e});function WpTabWrapperComponent_ng_container_0_ndc_dynamic_1_Template(e,t){if(1&e&&l.nrm(0,"ndc-dynamic",2),2&e){const e=l.XpG().ngIf;l.Y8G("ndcDynamicComponent",e.tab.component)("ndcDynamicInputs",l.eq3(2,_c0,e.workPackage))}}function WpTabWrapperComponent_ng_container_0_Template(e,t){if(1&e&&(l.qex(0),l.DNE(1,WpTabWrapperComponent_ng_container_0_ndc_dynamic_1_Template,1,4,"ndc-dynamic",1),l.bVm()),2&e){const e=t.ngIf;l.R7$(),l.Y8G("ngIf",e.workPackage&&e.tab)}}class WpTabWrapperComponent{get workPackageId(){const{workPackageId:e}=this.uiRouterGlobals.params;return e}constructor(e,t,n,i){this.I18n=e,this.uiRouterGlobals=t,this.apiV3Service=n,this.wpTabsService=i}ngOnInit(){this.ndcDynamicInputs$=this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe((0,s.T)((e=>({workPackage:e,tab:this.findTab(e)}))))}findTab(e){const{tabIdentifier:t}=this.uiRouterGlobals.params;return this.wpTabsService.getTab(t,e)}static{this.ɵfac=function WpTabWrapperComponent_Factory(e){return new(e||WpTabWrapperComponent)(l.rXU(o.W),l.rXU(i.ok),l.rXU(r.n),l.rXU(a.L))}}static{this.ɵcmp=l.VBU({type:WpTabWrapperComponent,selectors:[["op-wp-tab"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"ndcDynamicComponent","ndcDynamicInputs",4,"ngIf"],[3,"ndcDynamicComponent","ndcDynamicInputs"]],template:function WpTabWrapperComponent_Template(e,t){1&e&&(l.DNE(0,WpTabWrapperComponent_ng_container_0_Template,2,1,"ng-container",0),l.nI1(1,"async")),2&e&&l.Y8G("ngIf",l.bMT(1,1,t.ndcDynamicInputs$))},dependencies:[c.bT,p.Bf,p.dE,c.Jj],encapsulation:2})}}},40221:(e,t,n)=>{"use strict";n.d(t,{$:()=>WpTabsComponent});var i=n(66309),o=n(83093),r=n(61816),s=n(33924),a=(n(68643),n(68559)),l=n(60316),c=n(74406),p=n(46765);function WpTabsComponent_ng_container_1_Template(e,t){if(1&e){const e=a.RV6();a.qex(0,2),a.j41(1,"li",3)(2,"button",4),a.bIt("click",(function WpTabsComponent_ng_container_1_Template_button_click_2_listener(){a.eBV(e);const t=a.XpG();return a.Njj(t.switchToFullscreen())})),a.nrm(3,"op-icon",5),a.k0s()(),a.j41(4,"li",3)(5,"button",6),a.bIt("click",(function WpTabsComponent_ng_container_1_Template_button_click_5_listener(){a.eBV(e);const t=a.XpG();return a.Njj(t.close())})),a.nrm(6,"op-icon",7),a.k0s()(),a.bVm()}if(2&e){const e=a.XpG();a.R7$(2),a.Y8G("title",e.text.details.goToFullScreen),a.R7$(3),a.Y8G("title",e.text.details.close)}}class WpTabsComponent{constructor(e,t,n,i,o,r){this.wpTabsService=e,this.I18n=t,this.injector=n,this.$state=i,this.uiRouterGlobals=o,this.keepTab=r,this.canViewWatchers=!1,this.text={details:{close:this.I18n.t("js.button_close_details"),goToFullScreen:this.I18n.t("js.button_show_fullscreen")}}}ngOnInit(){this.uiSrefBase="split"===this.view?"":"work-packages.show",this.canViewWatchers=!(!this.workPackage||!this.workPackage.watchers),this.tabs=this.getDisplayableTabs()}getDisplayableTabs(){return this.wpTabsService.getDisplayableTabs(this.workPackage).map((e=>({...e,route:`${this.uiSrefBase}.tabs`,routeParams:{workPackageId:this.workPackage.id,tabIdentifier:e.id}})))}switchToFullscreen(){this.keepTab.goCurrentShowState()}close(){this.$state.go(this.uiRouterGlobals.current.data.baseRoute,this.uiRouterGlobals.params)}static{this.ɵfac=function WpTabsComponent_Factory(e){return new(e||WpTabsComponent)(a.rXU(s.L),a.rXU(r.W),a.rXU(a.zZn),a.rXU(o.dw),a.rXU(o.ok),a.rXU(i.S))}}static{this.ɵcmp=a.VBU({type:WpTabsComponent,selectors:[["op-wp-tabs"]],inputs:{workPackage:"workPackage",view:"view"},decls:2,vars:2,consts:[[1,"op-work-package-tabs",3,"tabs"],["slot","actions",4,"ngIf"],["slot","actions"],[1,"tab-icon"],["type","button",1,"spot-link","work-packages--details-fullscreen-icon",3,"click","title"],["icon-classes","icon-context icon-no-color icon-to-fullscreen"],["type","button",1,"spot-link","work-packages--details-close-icon",3,"click","title"],["icon-classes","icon-context icon-no-color icon-close"]],template:function WpTabsComponent_Template(e,t){1&e&&(a.j41(0,"op-scrollable-tabs",0),a.DNE(1,WpTabsComponent_ng_container_1_Template,7,2,"ng-container",1),a.k0s()),2&e&&(a.Y8G("tabs",t.tabs),a.R7$(),a.Y8G("ngIf","split"===t.view))},dependencies:[l.bT,c.f,p.i],styles:["[_nghost-%COMP%]{width:100%;max-width:100%;overflow:hidden}"],changeDetection:0})}}},33924:(e,t,n)=>{"use strict";n.d(t,{L:()=>WorkPackageTabsService});var i=n(14600),o=n(83093),r=n(38761),s=n(33389),a=n(26030),l=n(201),c=n(55355),p=n(61816),d=n(33813),u=n(70271);function workPackageWatchersCount(e,t){return t.get(d.Q).requireAndStream(e).pipe((0,u.T)((e=>e.length)))}var h=n(19999),m=n(14593),g=n(21861);function workPackageRelationsCount(e,t){const n=t.get(g.U),i=t.get(m.n),o=e.id.toString();return n.require(o),(0,h.z)([n.state(o.toString()).values$(),i.work_packages.id(o).requireAndStream()]).pipe((0,u.T)((([e,t])=>_.size(e)+_.size(t.children))))}var f=n(96613);function workPackageNotificationsCount(e,t){return t.get(f.e).nonDateAlertNotificationsCount$}var b=n(30501),k=n(59452),v=n(73962);function workPackageFilesCount(e,t){const n=t.get(v._),i=t.get(b.Qq),o=e.$links.attachments?n.collection(e.$links.attachments.href||""):(0,k.of)([]),r=e.$links.fileLinks?i.get(function href(e){if(!e.$links.fileLinks)return"";return`${e.$links.fileLinks.href}?pageSize=0`}(e)):(0,k.of)({total:0});return(0,h.z)([o,r]).pipe((0,u.T)((([e,t])=>e.length+t.total)))}var C=n(68559);class WorkPackageTabsService{constructor(e,t,n){this.$state=e,this.I18n=t,this.injector=n,this.registeredTabs=this.buildDefaultTabs()}get tabs(){return[...this.registeredTabs]}register(...e){this.registeredTabs=[...this.registeredTabs,...e]}patchTabCondition(e,t){const n=this.registeredTabs.find((t=>t.id===e));n&&(n.displayable=t)}getDisplayableTabs(e){return this.tabs.filter((t=>!t.displayable||t.displayable(e,this.$state))).map((t=>({...t,counter:t.count?n=>t.count(e,n||this.injector):e=>(0,i.H)([0])})))}getTab(e,t){return this.getDisplayableTabs(t).find((({id:t})=>t===e))}buildDefaultTabs(){return[{component:s.D,name:this.I18n.t("js.work_packages.tabs.overview"),id:"overview",displayable:(e,t)=>t.includes("**.details.*")},{id:"activity",component:a.l,name:I18n.t("js.work_packages.tabs.activity"),count:workPackageNotificationsCount,showCountAsBubble:!0},{id:"files",component:c.R,name:I18n.t("js.work_packages.tabs.files"),count:workPackageFilesCount},{id:"relations",component:r.r,name:I18n.t("js.work_packages.tabs.relations"),count:workPackageRelationsCount},{id:"watchers",component:l.P,name:I18n.t("js.work_packages.tabs.watchers"),displayable:e=>!!e.watchers,count:workPackageWatchersCount}]}static{this.ɵfac=function WorkPackageTabsService_Factory(e){return new(e||WorkPackageTabsService)(C.KVO(o.dw),C.KVO(p.W),C.KVO(C.zZn))}}static{this.ɵprov=C.jDH({token:WorkPackageTabsService,factory:WorkPackageTabsService.ɵfac,providedIn:"root"})}}},25070:(e,t,n)=>{"use strict";n.d(t,{R:()=>formatElapsedTime});var i=n(39545);function paddedNumber(e){return e.toString().padStart(2,"0")}function formatElapsedTime(e){const t=i(e),n=i().diff(t,"seconds"),o=Math.floor(n/3600),r=Math.floor((n-3600*o)/60),s=n-3600*o-60*r;return[paddedNumber(o),paddedNumber(r),paddedNumber(s)].join(":")}},92897:(e,t,n)=>{"use strict";n.d(t,{k:()=>WorkPackageTimerButtonComponent});var i=n(89204),o=(n(68643),n(61816)),r=n(99496),s=n(14593),a=n(85254),l=n(36647),c=n(51567),p=n(70271),d=n(14876),u=n(56196),h=n(14600),m=n(51339),g=n(39545),_=n(44674),f=n(32420),b=n(95122),k=n(25070),v=n(51133),C=n(24935),y=n(22842),w=n(72650),T=n(68559),S=n(60316);const _c0=(e,t)=>({timer:e,active:t});function WorkPackageTimerButtonComponent_ng_container_0_ng_container_1_Template(e,t){if(1&e){const e=T.RV6();T.qex(0),T.j41(1,"button",2),T.bIt("click",(function WorkPackageTimerButtonComponent_ng_container_0_ng_container_1_Template_button_click_1_listener(){T.eBV(e);const t=T.XpG(2);return T.Njj(t.stop())})),T.nrm(2,"span",3),T.j41(3,"span",4),T.EFF(4),T.nI1(5,"async"),T.k0s()(),T.bVm()}if(2&e){const e=T.XpG(2);T.R7$(),T.Y8G("title",e.text.stop_timer),T.R7$(3),T.SpI(" ",T.bMT(5,2,e.elapsed$)," ")}}function WorkPackageTimerButtonComponent_ng_container_0_button_2_Template(e,t){if(1&e){const e=T.RV6();T.j41(0,"button",5),T.bIt("click",(function WorkPackageTimerButtonComponent_ng_container_0_button_2_Template_button_click_0_listener(){T.eBV(e);const t=T.XpG(2);return T.Njj(t.start())})),T.nrm(1,"span",6),T.k0s()}if(2&e){const e=T.XpG(2);T.Y8G("title",e.text.start_timer)}}function WorkPackageTimerButtonComponent_ng_container_0_Template(e,t){if(1&e&&(T.qex(0),T.DNE(1,WorkPackageTimerButtonComponent_ng_container_0_ng_container_1_Template,6,4,"ng-container",0)(2,WorkPackageTimerButtonComponent_ng_container_0_button_2_Template,2,1,"button",1),T.bVm()),2&e){const e=t.ngIf;T.R7$(),T.Y8G("ngIf",e.timer&&e.active),T.R7$(),T.Y8G("ngIf",!e.timer||!e.active)}}class WorkPackageTimerButtonComponent extends r.p{constructor(e,t,n,i,o,r,s,a,u,h,m,g){super(),this.injector=e,this.I18n=t,this.apiV3Service=n,this.timeEntryService=i,this.timeEntryEditService=o,this.timeEntryCreateService=r,this.halEditing=s,this.modalService=a,this.schemaCache=u,this.timezoneService=h,this.toastService=m,this.cdRef=g,this.timer$=this.timeEntryService.activeTimer$,this.elapsed$=(0,d.O)(0,1e3).pipe((0,l.n)((()=>this.timer$)),(0,c.p)((e=>null!==e)),(0,p.T)((e=>(0,k.R)(e.createdAt)))),this.text={workPackage:this.I18n.t("js.label_work_package"),start_timer:this.I18n.t("js.timer.start_new_timer"),stop_timer:this.I18n.t("js.timer.button_stop"),timer_already_stopped:this.I18n.t("js.timer.timer_already_stopped")}}activeForWorkPackage(e){return!!e&&e.workPackage.href===this.workPackage.href}clear(){this.timeEntryService.timer$.next(null)}stop(){var e=this;return(0,i.A)((function*(){const t=yield(0,u._)(e.timeEntryService.refresh());return t?e.timeEntryEditService.stopTimerAndEdit(t):e.toastService.addWarning(e.text.timer_already_stopped)}))()}start(){this.timeEntryService.refresh().subscribe((e=>{e?this.showStopModal(e).then((()=>this.stop().then((()=>this.startTimer())))).catch((()=>{})):this.startTimer()}))}startTimer(){this.timeEntryCreateService.createNewTimeEntry(g(),this.workPackage,!0).pipe((0,l.n)((e=>(0,h.H)(this.halEditing.save(e)))),(0,p.T)((e=>e.resource))).subscribe((e=>{this.timeEntryService.timer$.next(e)}))}showStopModal(e){return new Promise(((t,n)=>{this.modalService.show(C.D,this.injector,{timer:e}).subscribe((e=>e.closingEvent.subscribe((()=>{e.confirmed?t():n()}))))}))}static{this.ɵfac=function WorkPackageTimerButtonComponent_Factory(e){return new(e||WorkPackageTimerButtonComponent)(T.rXU(T.zZn),T.rXU(o.W),T.rXU(s.n),T.rXU(b.O),T.rXU(y.r),T.rXU(a.h),T.rXU(m.p),T.rXU(v.a),T.rXU(_.D),T.rXU(f.D),T.rXU(w.fw),T.rXU(T.gRc))}}static{this.ɵcmp=T.VBU({type:WorkPackageTimerButtonComponent,selectors:[["op-wp-timer-button"]],inputs:{workPackage:"workPackage"},features:[T.Vt3],decls:3,vars:8,consts:[[4,"ngIf"],["class","button","type","button","data-test-selector","timer-inactive",3,"title","click",4,"ngIf"],["type","button","data-test-selector","timer-active",1,"button","button_flex",3,"click","title"],[1,"spot-icon","spot-icon_time-tracking-stop"],[1,"button--text"],["type","button","data-test-selector","timer-inactive",1,"button",3,"click","title"],[1,"spot-icon","spot-icon_time-tracking-start"]],template:function WorkPackageTimerButtonComponent_Template(e,t){1&e&&(T.DNE(0,WorkPackageTimerButtonComponent_ng_container_0_Template,3,2,"ng-container",0),T.nI1(1,"async"),T.nI1(2,"async")),2&e&&T.Y8G("ngIf",T.l_i(5,_c0,T.bMT(1,1,t.timer$),t.activeForWorkPackage(T.bMT(2,3,t.timer$))))},dependencies:[S.bT,S.Jj],encapsulation:2,changeDetection:0})}}},46337:(e,t,n)=>{"use strict";n.d(t,{j:()=>WorkPackageTypeStatusComponent});n(68643);var i=n(68559),o=n(60316),r=n(8958);const _c0=()=>({colorize:!1});function WorkPackageTypeStatusComponent_div_0_Template(e,t){if(1&e&&(i.j41(0,"div",1)(1,"div",2),i.nrm(2,"op-editable-attribute-field",3),i.k0s(),i.j41(3,"div",4),i.nrm(4,"op-editable-attribute-field",5),i.k0s()()),2&e){const e=i.XpG();i.R7$(2),i.Y8G("resource",e.workPackage)("displayFieldOptions",i.lJ4(7,_c0))("wrapperClasses","wp-new-top-row--status -no-label")("fieldName","status"),i.R7$(2),i.Y8G("resource",e.workPackage)("wrapperClasses","wp-new-top-row--type -no-label")("fieldName","type")}}class WorkPackageTypeStatusComponent{static{this.ɵfac=function WorkPackageTypeStatusComponent_Factory(e){return new(e||WorkPackageTypeStatusComponent)}}static{this.ɵcmp=i.VBU({type:WorkPackageTypeStatusComponent,selectors:[["wp-type-status"]],inputs:{workPackage:"workPackage"},decls:1,vars:1,consts:[["class","wp-new-top-row",4,"ngIf"],[1,"wp-new-top-row"],[1,"work-packages--status-selector","wp-new-top-row--element"],[3,"resource","displayFieldOptions","wrapperClasses","fieldName"],[1,"work-packages--type-selector","wp-new-top-row--element"],[3,"resource","wrapperClasses","fieldName"]],template:function WorkPackageTypeStatusComponent_Template(e,t){1&e&&i.DNE(0,WorkPackageTypeStatusComponent_div_0_Template,5,8,"div",0),2&e&&i.Y8G("ngIf",t.workPackage)},dependencies:[o.bT,r.c],encapsulation:2})}}},61933:(e,t,n)=>{"use strict";n.d(t,{d:()=>WorkPackageWatcherButtonComponent});n(68643);var i=n(61816),o=n(33813),r=n(99496),s=n(14593),a=n(68559),l=n(60316),c=n(46765);function WorkPackageWatcherButtonComponent_button_0_span_2_Template(e,t){if(1&e&&a.nrm(0,"span",4),2&e){const e=a.XpG(2);a.Y8G("textContent",e.buttonText)}}function WorkPackageWatcherButtonComponent_button_0_Template(e,t){if(1&e){const e=a.RV6();a.j41(0,"button",1),a.bIt("click",(function WorkPackageWatcherButtonComponent_button_0_Template_button_click_0_listener(){a.eBV(e);const t=a.XpG();return a.Njj(t.toggleWatch())})),a.nrm(1,"op-icon",2),a.DNE(2,WorkPackageWatcherButtonComponent_button_0_span_2_Template,1,1,"span",3),a.k0s()}if(2&e){const e=a.XpG();a.Y8G("disabled",e.disabled)("ngClass",e.buttonClass)("id",e.buttonId),a.BMQ("title",e.buttonTitle),a.R7$(),a.Mz_("icon-classes","button--icon ",e.watchIconClass,""),a.R7$(),a.Y8G("ngIf",e.showText)}}class WorkPackageWatcherButtonComponent extends r.p{constructor(e,t,n,i){super(),this.I18n=e,this.wpWatchersService=t,this.apiV3Service=n,this.cdRef=i,this.showText=!1,this.disabled=!1}ngOnInit(){this.apiV3Service.work_packages.id(this.workPackage).requireAndStream().pipe(this.untilDestroyed()).subscribe((e=>{this.workPackage=e,this.setWatchStatus(),this.cdRef.detectChanges()}))}get isWatched(){return this.workPackage.hasOwnProperty("unwatch")}get displayWatchButton(){return this.isWatched||this.workPackage.hasOwnProperty("watch")}toggleWatch(){const e=this.nextStateLink();e(e.$link.payload).then((()=>{this.wpWatchersService.clear(this.workPackage.id),this.apiV3Service.work_packages.id(this.workPackage).refresh()}))}nextStateLink(){const e=this.isWatched?"unwatch":"watch";return this.workPackage[e]}setWatchStatus(){this.isWatched?(this.buttonTitle=this.I18n.t("js.label_unwatch_work_package"),this.buttonText=this.I18n.t("js.label_unwatch"),this.buttonClass="-active",this.buttonId="unwatch-button",this.watchIconClass="icon-watched"):(this.buttonTitle=this.I18n.t("js.label_watch_work_package"),this.buttonText=this.I18n.t("js.label_watch"),this.buttonClass="",this.buttonId="watch-button",this.watchIconClass="icon-unwatched")}static{this.ɵfac=function WorkPackageWatcherButtonComponent_Factory(e){return new(e||WorkPackageWatcherButtonComponent)(a.rXU(i.W),a.rXU(o.Q),a.rXU(s.n),a.rXU(a.gRc))}}static{this.ɵcmp=a.VBU({type:WorkPackageWatcherButtonComponent,selectors:[["wp-watcher-button"]],inputs:{workPackage:"workPackage",showText:"showText",disabled:"disabled"},features:[a.Vt3],decls:1,vars:1,consts:[["class","button toolbar-icon",3,"disabled","ngClass","id","click",4,"ngIf"],[1,"button","toolbar-icon",3,"click","disabled","ngClass","id"],[3,"icon-classes"],["class","button--text",3,"textContent",4,"ngIf"],[1,"button--text",3,"textContent"]],template:function WorkPackageWatcherButtonComponent_Template(e,t){1&e&&a.DNE(0,WorkPackageWatcherButtonComponent_button_0_Template,3,7,"button",0),2&e&&a.Y8G("ngIf",t.displayWatchButton)},dependencies:[l.YU,l.bT,c.i],encapsulation:2,changeDetection:0})}}},11048:(e,t,n)=>{"use strict";n.d(t,{i:()=>IsolatedQuerySpace});var i=n(47418),o=n(84205),r=n(70271),s=n(68559);class IsolatedQuerySpace extends i.Iq{constructor(){super(...arguments),this.name="IsolatedQuerySpace",this.query=(0,i.hF)(),this.queryForm=(0,i.hF)(),this.results=(0,i.hF)(),this.groups=(0,i.hF)(),this.columns=(0,i.hF)(),this.collapsedGroups=(0,i.hF)(),this.tableRendered=(0,i.hF)(),this.timelineRendered=new o.B,this.renderedWorkPackages=(0,i.CX)(this.tableRendered,(e=>e.pipe((0,r.T)((e=>e.filter((e=>!!e.workPackageId))))))),this.renderedWorkPackageIds=(0,i.CX)(this.renderedWorkPackages,(e=>e.pipe((0,r.T)((e=>e.map((e=>e.workPackageId.toString()))))))),this.stopAllSubscriptions=new o.B,this.additionalRequiredWorkPackages=(0,i.hF)(),this.workPackageSharesCache=(0,i.Iy)(),this.initialized=(0,i.hF)(),this.available={columns:(0,i.hF)(),sortBy:(0,i.hF)(),groupBy:(0,i.hF)(),filters:(0,i.hF)(),displayRepresentation:(0,i.hF)()}}static{this.ɵfac=(()=>{let e;return function IsolatedQuerySpace_Factory(t){return(e||(e=s.xGo(IsolatedQuerySpace)))(t||IsolatedQuerySpace)}})()}static{this.ɵprov=s.jDH({token:IsolatedQuerySpace,factory:IsolatedQuerySpace.ɵfac})}}},63077:(e,t,n)=>{"use strict";n.d(t,{Y:()=>WorkPackageIsolatedQuerySpaceDirective});var i=n(11048),o=n(1567),r=n(98755),s=n(49989),a=n(1750),l=n(94450),c=n(1257),p=n(88352),d=n(34120),u=n(68222),h=n(29925),m=n(55332),g=n(44770),_=n(62665),f=n(68267),b=n(28702),k=n(79),v=n(51339),C=n(95445),y=n(90941),w=n(12717),T=n(72790),S=n(27871),j=n(31433),P=n(87962),I=n(44663),x=n(36819),R=n(9845),F=n(51524),M=n(99763),O=n(51724),D=n(74573),G=n(80406),E=n(87454),A=n(40358),V=n(49349),$=n(85254),B=n(59769),W=n(20734),N=n(58154),U=n(22842),Y=n(68559);class WorkPackageIsolatedQuerySpaceDirective{constructor(e,t){this.querySpace=e,(0,x.cY)("Opening isolated query space in %O",t.nativeElement)}static{this.ɵfac=function WorkPackageIsolatedQuerySpaceDirective_Factory(e){return new(e||WorkPackageIsolatedQuerySpaceDirective)(Y.rXU(i.i),Y.rXU(Y.aKT))}}static{this.ɵdir=Y.FsC({type:WorkPackageIsolatedQuerySpaceDirective,selectors:[["","opWorkPackageIsolatedQuerySpace",""]],standalone:!0,features:[Y.Jv_([{provide:A.Y,useExisting:V.U},i.i,o.A,I.T,C.E,r.f,s.I,a.W,B.V,l.j,c.P,p.T,d.N,u.X,h.a,m.X,g.e,k.c,_.I,D.dd,G.G,F.k,E.a,N.b1,M.p,W.p,y.F,w.a,T.R,S.O,j.V,P.i,O.K,v.p,$.h,U.r,f.d,b.V,R._])]})}}},53156:(e,t,n)=>{"use strict";n.d(t,{W:()=>OpenprojectWorkPackagesModule});var i=n(34802),o=n(74785),r=n(21452),s=n(65046),a=n(95083),l=n(32808),c=n(64940),p=n(89204),d=n(61816),u=n(72650),h=n(39545),m=n(33900),g=n(51567),f=n(64334),b=n(47418),k=n(24398),v=n(13432),C=n(51339),y=n(1758),w=n(60807),T=n(46116),S=n(68222),j=n(44674),P=n(74037);class WorkPackageCellLabels{constructor(e,t,n,i,o,r,s){this.center=e,this.left=t,this.leftHover=n,this.right=i,this.rightHover=o,this.farRight=r,this.withAlternativeLabels=s}}var I=n(13517);const x="labelLeft",R="containerRight",F="labelRight",M="labelHoverLeft",O="labelHoverRight",D="-label-style",G="labelFarRight",E="show-on-hover",A="hide-on-hover",V="leftHandle",$="rightHandle";class TimelineCellRenderer{constructor(e,t){this.injector=e,this.workPackageTimeline=t,this.text={label_children_derived_duration:this.I18n.t("js.label_children_derived_duration")},this.fieldRenderer=new w.wJ(this.injector,"timeline"),this.ganttChartRowHeight=+getComputedStyle(document.documentElement).getPropertyValue("--table-timeline--row-height").replace("px","")}get type(){return"bar"}canMoveDates(e){const t=this.schemaCache.of(e);return t.startDate.writable&&t.dueDate.writable&&t.isAttributeEditable("startDate")}isEmpty(e){const t=h(e.startDate),n=h(e.dueDate);return _.isNaN(t.valueOf())&&_.isNaN(n.valueOf())}displayPlaceholderUnderCursor(e,t){const[n,i]=this.cursorDateAndDayOffset(e,t),o=this.displayDurationForDate(t,n)*t.viewParams.pixelPerDay||30,r=document.createElement("div");return r.style.pointerEvents="none",r.style.position="absolute",r.style.height="1em",r.style.width=`${o}px`,r.style.zIndex="9999",r.style.left=i*t.viewParams.pixelPerDay+"px",this.applyTypeColor(t,r),r}assignDateValues(e,t,n){this.assignDate(e,"startDate",n.startDate),this.assignDate(e,"dueDate",n.dueDate),this.updateLabels(!0,t,e)}onDaysMoved(e,t,n,i){const o=e.pristineResource.startDate,r=e.pristineResource.dueDate,s=h().format("YYYY-MM-DD"),a=h(e.projectedResource.startDate),l=h(e.projectedResource.dueDate),c={};if("left"===i)c.startDate=h(o||r).add(n,"days");else if("right"===i){const e=r||(s>o?s:o);c.dueDate=h(e).add(n,"days")}else"both"===i?(o&&(c.startDate=h(o).add(n,"days")),r&&(c.dueDate=h(r).add(n,"days"))):"dragright"===i&&(c.dueDate=a.clone().add(n,"days"));return"both"!==i&&(void 0!==c.startDate&&c.startDate.isAfter(l)?c.startDate=l:void 0!==c.dueDate&&c.dueDate.isBefore(a)&&(c.dueDate=a)),c}onMouseDown(e,t,n,i){if(n.viewParams.activeSelectionMode)return n.viewParams.activeSelectionMode(n.workPackage),e.preventDefault(),this.mouseDirection="both","both";const o=n.change.projectedResource;let r;if(jQuery(e.target).hasClass(V)?(r="left",this.mouseDirection="left",this.mouseDownCursorType="col-resize",null===o.startDate&&(o.startDate=o.dueDate)):jQuery(e.target).hasClass($)||t?(r="right",this.mouseDirection="right",this.mouseDownCursorType="col-resize"):(r="both",this.mouseDirection="both",this.mouseDownCursorType="ew-resize"),this.workPackageTimeline.forceCursor(this.mouseDownCursorType),t){const i=this.cursorDateAndDayOffset(e,n)[0],s=this.displayDurationForDate(n,i)-1;o.startDate=t,o.dueDate=h(t).add(s,"days").format("YYYY-MM-DD"),r="dragright",this.mouseDirection="dragright"}return this.updateLabels(!0,i,n.change),r}onMouseDownEnd(e,t){this.mouseDownCursorType="",this.workPackageTimeline.forceCursor(this.mouseDownCursorType),this.updateLabels(!1,e,t)}update(e,t,n){const{change:i}=n,o=e.querySelector(`.${I.Cr}`);let r=h(i.projectedResource.startDate),s=h(i.projectedResource.dueDate);return _.isNaN(r.valueOf())&&_.isNaN(s.valueOf())?e.style.visibility="hidden":e.style.visibility="visible",_.isNaN(s.valueOf())&&!_.isNaN(r.valueOf())&&(s=h(),o.setAttribute("style","background-image: linear-gradient(90deg, rgba(255,255,255,0) 0%, #F1F1F1 100%) !important")),_.isNaN(r.valueOf())&&!_.isNaN(s.valueOf())&&(r=s.clone(),o.setAttribute("style","background-image: linear-gradient(90deg, #F1F1F1 0%, rgba(255,255,255,0) 80%) !important")),this.setElementPositionAndSize(e,n,r,s),t&&this.updateLabels(!1,t,i),this.checkForActiveSelectionMode(n,o),this.checkForSpecialDisplaySituations(n,o),this.applyTypeColor(n,o),!0}cursorDateAndDayOffset(e,t){const n=Math.floor(e.offsetX/t.viewParams.pixelPerDay);return[t.viewParams.dateDisplayStart.clone().add(n,"days"),n]}checkForActiveSelectionMode(e,t){e.viewParams.activeSelectionMode&&(t.style.backgroundImage="",e.viewParams.selectionModeStart===`${e.workPackage.id}`&&(jQuery(t).addClass(I.q1),t.style.background="none"))}displayDurationForDate(e,t){const{workPackage:n}=e;let i=Number(h.duration(n.duration||"P1D").asDays().toFixed(0));if(n.ignoreNonWorkingDays)return i;const{dateDisplayEnd:o}=e.viewParams;let r=0;for(;r<i;r++){const e=t.clone().add(r,"days");if(e>o)break;this.weekdayService.isNonWorkingDay(e.toDate()||this.workPackageTimeline.isNonWorkingDay(e.toDate()))&&(i+=1)}return r}getMarginLeftOfLeftSide(e){const t=e.change.projectedResource;let n=h(t.startDate);const i=h(t.dueDate);n=_.isNaN(n.valueOf())?i.clone():n;const o=n.diff(e.viewParams.dateDisplayStart,"days");return(0,I.HY)(e.viewParams,o)}getMarginLeftOfRightSide(e){const t=e.change.projectedResource;let n=h(t.startDate),i=h(t.dueDate);n=_.isNaN(n.valueOf())?i.clone():n,i=_.isNaN(i.valueOf())?n.clone():i;const o=n.diff(e.viewParams.dateDisplayStart,"days"),r=i.diff(n,"days")+1;return(0,I.HY)(e.viewParams,o+r)}getPaddingLeftForIncomingRelationLines(e){return e.viewParams.pixelPerDay/8}getPaddingRightForOutgoingRelationLines(e){return 0}render(e){const t=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div");return t.className=`${I.pz} ${this.type}`,n.className=I.Cr,i.className=V,o.className=$,t.appendChild(n),t.appendChild(i),t.appendChild(o),t}createAndAddLabels(e,t){const n=document.createElement("div");n.classList.add("bar-label"),this.applyTypeColor(e,n),t.appendChild(n);const i=document.createElement("div");i.classList.add(x,A),t.appendChild(i);const o=document.createElement("div");o.classList.add(R),t.appendChild(o);const r=document.createElement("div");r.classList.add(F,A),o.appendChild(r);const s=document.createElement("div");s.classList.add(G,A),o.appendChild(s);const a=document.createElement("div");a.classList.add(M,E,D),t.appendChild(a);const l=document.createElement("div");l.classList.add(O,E,D),t.appendChild(l);const c=new WorkPackageCellLabels(n,i,a,r,l,s);return this.updateLabels(!1,c,e.change),c}applyTypeColor(e,t){const n=e.workPackage,{type:i}=n,o=e.viewParams.activeSelectionMode,{id:r}=i;o?t.classList.remove(T.H.backgroundClass("type",r)):t.classList.add(T.H.backgroundClass("type",r))}assignDate(e,t,n){n&&(e.projectedResource[t]=n.format("YYYY-MM-DD"))}setElementPositionAndSize(e,t,n,i){const{viewParams:o}=t,r=n.diff(o.dateDisplayStart,"days");e.style.left=(0,I.JO)(o,r);const s=i.diff(n,"days")+1;if(e.style.width=(0,I.JO)(o,s),!_.isNaN(n.valueOf())||!_.isNaN(i.valueOf())){const n=_.max([t.viewParams.pixelPerDay,2]);e.style.minWidth=`${n}px`}}cursorOrDatesAreNonWorking(e,t,n){if(t.workPackage.ignoreNonWorkingDays)return!1;const i=e instanceof MouseEvent?[this.cursorDateAndDayOffset(e,t)[0]]:e;return!(!t.workPackage.ignoreNonWorkingDays&&"both"===n&&this.weekdayService.isNonWorkingDay(i[i.length-1].toDate()||this.workPackageTimeline.isNonWorkingDay(i[i.length-1].toDate())))&&i.some((e=>this.weekdayService.isNonWorkingDay(e.toDate())||this.workPackageTimeline.isNonWorkingDay(e.toDate())))}checkForSpecialDisplaySituations(e,t){const n=e.workPackage,i=t.parentElement.parentElement,o=e.viewParams.activeSelectionMode;if(n.isLeaf||o||n.scheduleManually?t.classList.remove("-readonly"):t.classList.add("-readonly"),n.derivedStartDate&&n.derivedDueDate){const t=h(n.derivedStartDate),o=h(n.derivedDueDate),r=h(e.change.projectedResource.startDate),s=h(e.change.projectedResource.dueDate),a=i.querySelector(".children-duration-bar"),l=document.createElement("div"),c=document.createElement("div"),p=document.querySelectorAll(`.wp-timeline-cell.__hierarchy-group-${n.id}:not([class*='__collapsed-group'])`).length||0;l.classList.add("children-duration-bar","-clamp-style"),l.title=this.text.label_children_derived_duration,c.classList.add("children-duration-hover-container"),c.style.height=this.ganttChartRowHeight*p+10+"px",(t.isBefore(r)||o.isAfter(s))&&l.classList.add("-duration-overflow"),this.setElementPositionAndSize(l,e,t,o),a&&a.remove(),l.appendChild(c),i.appendChild(l)}const{startDate:r,dueDate:s}=e.change.projectedResource;this.cursorOrDatesAreNonWorking([h(r),h(s)],e,this.mouseDirection)?this.workPackageTimeline.forceCursor("not-allowed"):this.workPackageTimeline.forceCursor(this.mouseDownCursorType)}updateLabels(e,t,n){const i=this.wpTableTimeline.getNormalizedLabels(n.projectedResource);e||(this.renderLabel(n,t,"left",i.left),this.renderLabel(n,t,"right",i.right),this.renderLabel(n,t,"farRight",i.farRight)),this.renderHoverLabels(t,n)}renderHoverLabels(e,t){this.renderLabel(t,e,"leftHover","startDate"),this.renderLabel(t,e,"rightHover","dueDate")}renderLabel(e,t,n,i){const o=t[n];if(!o)return;if(o.innerHTML="",null===i)return void o.classList.remove("not-empty");const[r,s]=this.fieldRenderer.renderFieldValue(e.projectedResource,i,e);o&&r&&s?(s.classList.add("label-content"),o.appendChild(s),o.classList.add("not-empty")):o&&o.classList.remove("not-empty")}isParentWithVisibleChildren(e){if(!this.workPackageTimeline.inHierarchyMode)return!1;const t=this.workPackageTimeline.workPackageTable.lastRenderPass;return!!t&&!!t.parentsWithVisibleChildren[e.id]}}(0,k.Cg)([(0,y.O)(),(0,k.Sn)("design:type",S.X)],TimelineCellRenderer.prototype,"wpTableTimeline",void 0),(0,k.Cg)([(0,y.O)(),(0,k.Sn)("design:type",P.I)],TimelineCellRenderer.prototype,"weekdayService",void 0),(0,k.Cg)([(0,y.O)(),(0,k.Sn)("design:type",j.D)],TimelineCellRenderer.prototype,"schemaCache",void 0),(0,k.Cg)([(0,y.O)(),(0,k.Sn)("design:type",d.W)],TimelineCellRenderer.prototype,"I18n",void 0);class TimelineMilestoneCellRenderer extends TimelineCellRenderer{get type(){return"milestone"}isEmpty(e){const t=h(e.date);return _.isNaN(t.valueOf())}canMoveDates(e){const t=this.schemaCache.of(e);return t.date.writable&&t.isAttributeEditable("date")}displayPlaceholderUnderCursor(e,t){const n=Math.floor(e.offsetX/t.viewParams.pixelPerDay),i=document.createElement("div");i.className="timeline-element milestone",i.style.pointerEvents="none",i.style.height="1em",i.style.width="1em",i.style.left=n*t.viewParams.pixelPerDay+"px";const o=document.createElement("div");return o.className="diamond",o.style.left="0.5em",o.style.height="1em",o.style.width="1em",i.appendChild(o),this.applyTypeColor(t,o),i}assignDateValues(e,t,n){this.assignDate(e,"date",n.date),this.updateLabels(!0,t,e)}onDaysMoved(e,t,n,i){const o=e.pristineResource.date,r={};return o&&(r.date=h(o).add(n,"days")),r}onMouseDown(e,t,n,i){if(n.viewParams.activeSelectionMode)return n.viewParams.activeSelectionMode(n.workPackage),e.preventDefault(),"both";let o="both";return this.workPackageTimeline.forceCursor("ew-resize"),t?(n.change.projectedResource.date=t,o="create",o):(this.updateLabels(!0,i,n.change),o)}update(e,t,n){const{viewParams:i}=n,o=h(n.change.projectedResource.date);if(_.isNaN(o.valueOf()))return!1;const r=jQuery(".diamond",e)[0];r.style.width="15px",r.style.height="15px",r.style.width="15px",r.style.height="15px",r.style.marginLeft=n.viewParams.pixelPerDay/2-7.5+"px",this.applyTypeColor(n,r);const s=o.diff(i.dateDisplayStart,"days");return e.style.left=`${(0,I.HY)(i,s)}px`,t&&this.updateLabels(!1,t,n.change),this.checkForActiveSelectionMode(n,r),!0}getMarginLeftOfLeftSide(e){const{change:t}=e,n=h(t.projectedResource.date).diff(e.viewParams.dateDisplayStart,"days");return(0,I.HY)(e.viewParams,n)}getMarginLeftOfRightSide(e){return this.getMarginLeftOfLeftSide(e)+e.viewParams.pixelPerDay}getPaddingLeftForIncomingRelationLines(e){return e.viewParams.pixelPerDay/2-1}getPaddingRightForOutgoingRelationLines(e){return 7.5}render(e){const t=document.createElement("div");t.className=`${I.pz} ${this.type}`;const n=document.createElement("div");return n.className="diamond",t.appendChild(n),t}createAndAddLabels(e,t){const n=document.createElement("div");n.classList.add(x,A),t.appendChild(n);const i=document.createElement("div");i.classList.add(R),t.appendChild(i);const o=document.createElement("div");o.classList.add(F,A),i.appendChild(o);const r=document.createElement("div");r.classList.add(G,A),i.appendChild(r);const s=document.createElement("div");s.classList.add(O,E,D),t.appendChild(s);const a=document.createElement("div");a.classList.add(M,E,D),t.appendChild(a);const l=new WorkPackageCellLabels(null,n,a,o,s,r,e.withAlternativeLabels);return this.updateLabels(!1,l,e.change),l}renderHoverLabels(e,t){e.withAlternativeLabels?(this.renderLabel(t,e,"leftHover","date"),this.renderLabel(t,e,"rightHover","subject")):this.renderLabel(t,e,"rightHover","date")}updateLabels(e,t,n){const i=this.wpTableTimeline.getNormalizedLabels(n.projectedResource);e||(t.withAlternativeLabels?this.renderLabel(n,t,"right","subject"):"startDate"===i.left&&"dueDate"===i.right?(this.renderLabel(n,t,"left",null),this.renderLabel(n,t,"right","date")):(this.renderLabel(n,t,"left",i.left),this.renderLabel(n,t,"right",i.right)),this.renderLabel(n,t,"farRight",i.farRight)),this.renderHoverLabels(t,n)}renderLabel(e,t,n,i){"startDate"!==i&&"dueDate"!==i||(i="date"),super.renderLabel(e,t,n,i)}}var B=n(80366),W=n(91691),N=n(49349),U=n(11048),Y=n(41670),X=n(14593);function registerWorkPackageMouseHandler(e,t,n,i,o,r,s,a,l,c,p,d){let u,m=null;d.change=i.changeFor(d.workPackage);const g=jQuery("body");function applyRendererMoveChanges(e,t,n){const i=p.onDaysMoved(d.change,e,t,n);p.assignDateValues(d.change,c,i),p.update(l,c,d)}function getCursorOffsetInDaysFromLeft(e){const t=n.getAbsoluteLeftCoordinates(),i=e.clientX-t;return Math.floor(i/d.viewParams.pixelPerDay)}function keyPressFn(e){e.originalEvent.keyCode===Y.c.ESCAPE&&deactivate(null,!0)}function handleMouseMoveOnEmptyCell(e){const t=d.workPackage;if(!p.isEmpty(t))return;u?.remove(),u=p.displayPlaceholderUnderCursor(e,d);(t.isLeaf||t.scheduleManually)&&p.canMoveDates(t)&&!p.cursorOrDatesAreNonWorking(e,d)?(a.style.cursor="",a.appendChild(u),a.onmouseleave=()=>{u.remove()},a.onmousedown=e=>{if(u.remove(),e.preventDefault(),p.cursorOrDatesAreNonWorking(e,d))return;l.style.pointerEvents="none";const[t,n]=p.cursorDateAndDayOffset(e,d),i=t.format("YYYY-MM-DD"),o=p.onMouseDown(e,i,d,c);p.update(l,c,d),"create"!==o?(g.on("mousemove.emptytimelinecell",function mouseMoveOnEmptyCellFn(e,t){return n=>{u.remove();const i=Math.abs(a.getBoundingClientRect().x-n.clientX),o=Math.floor(i/d.viewParams.pixelPerDay);applyRendererMoveChanges(d.viewParams.dateDisplayStart.clone().add(o,"days"),o-e,t)}}(n,o)),g.on("mouseup.emptytimelinecell",(()=>deactivate(o,!1))),a.onmouseup=()=>{deactivate(o,!1)},g.on("keyup.timelinecell",keyPressFn)):deactivate(o,!1)}):a.style.cursor="not-allowed"}function deactivate(t,u){const b=d.change;n.disableViewParamsCalculation=!1,a.onmousemove=handleMouseMoveOnEmptyCell,a.onmousedown=()=>{},a.onmouseleave=()=>{},a.onmouseup=()=>{},l.style.pointerEvents="auto",g.off(".timelinecell"),g.off(".emptytimelinecell"),n.resetCursor(),m=null;const{startDate:k,dueDate:v}=b.projectedResource,C=p.cursorOrDatesAreNonWorking([h(k),h(v)],d,t);if(u||b.isEmpty()||C)return void cancelChange();const y=b.pristineResource.duration;"both"===t&&y&&(b.clearValue("dueDate"),b.setValue("duration",y)),function saveWorkPackage(t){const n=e.get(X.n),a=e.get(U.i),l=h().toISOString();return s.table.promise=i.save(t).then((e=>{r.showSave(e.resource);const t=_.map(a.tableRendered.value,(e=>e.workPackageId));return n.work_packages.filterUpdatedSince(t,l).get().toPromise().then((()=>(o.push(e.resource,{eventType:"updated"}),a.timelineRendered.pipe((0,f.s)(1)).toPromise())))}))}(d.change).then((()=>{d.change.clear(),p.onMouseDownEnd(c,d.change)})).catch((e=>{r.handleRawError(e,d.workPackage),cancelChange()}))}function cancelChange(){d.change.clear(),p.update(l,c,d),p.onMouseDownEnd(c,d.change),n.refreshView()}l.onmousedown=e=>{1===e.which&&function workPackageMouseDownFn(e){e.preventDefault();const t="active-drag";if(l.classList.add(t),g.on("mouseup.timelinecell",(()=>l.classList.remove(t))),n.disableViewParamsCalculation=!0,m=getCursorOffsetInDaysFromLeft(e),!d.workPackage.isLeaf&&!d.viewParams.activeSelectionMode&&!d.workPackage.scheduleManually)return;const i=p.onMouseDown(e,null,d,c);g.on("mousemove.timelinecell",function createMouseMoveFn(e){return t=>{const n=getCursorOffsetInDaysFromLeft(t.originalEvent)-m,i=Math.floor(t.offsetX/d.viewParams.pixelPerDay);applyRendererMoveChanges(d.viewParams.dateDisplayStart.clone().add(i,"days"),n,e)}}(i)),g.on("keyup.timelinecell",keyPressFn),g.on("mouseup.timelinecell",(()=>deactivate(i,!1)))}(e)},a.onmousemove=handleMouseMoveOnEmptyCell}class WorkPackageTimelineCell{constructor(e,t,n,i,o,r){this.injector=e,this.workPackageTimeline=t,this.renderers=n,this.latestRenderInfo=i,this.classIdentifier=o,this.workPackageId=r,this.wpElement=null}getMarginLeftOfLeftSide(){return this.cellRenderer(this.latestRenderInfo.workPackage).getMarginLeftOfLeftSide(this.latestRenderInfo)}getMarginLeftOfRightSide(){return this.cellRenderer(this.latestRenderInfo.workPackage).getMarginLeftOfRightSide(this.latestRenderInfo)}getPaddingLeftForIncomingRelationLines(){return this.cellRenderer(this.latestRenderInfo.workPackage).getPaddingLeftForIncomingRelationLines(this.latestRenderInfo)}getPaddingRightForOutgoingRelationLines(){return this.cellRenderer(this.latestRenderInfo.workPackage).getPaddingRightForOutgoingRelationLines(this.latestRenderInfo)}canConnectRelations(){const e=this.latestRenderInfo.workPackage;return this.schemaCache.of(e).isMilestone?!_.isNil(e.date):!_.isNil(e.startDate)||!_.isNil(e.dueDate)}clear(){this.cellElement.html(""),this.wpElement=null}get cellContainer(){return this.workPackageTimeline.timelineBody}get cellElement(){return this.cellContainer.find(`.${this.classIdentifier}`)}lazyInit(e,t){const n=this.workPackageTimeline.timelineBody[0],i=this.cellElement;if(!i.length)return Promise.reject("uninitialized");return null!==this.wpElement&&n.contains(this.wpElement)&&this.elementShape===e.type||(t.isDuplicatedCell||this.clear(),this.wpElement=e.render(t),this.labels=e.createAndAddLabels(t,this.wpElement),this.elementShape=e.type,i.append(this.wpElement),e.canMoveDates(t.workPackage)&&(this.wpElement.classList.add("-editable"),registerWorkPackageMouseHandler(this.injector,0,this.workPackageTimeline,this.halEditing,this.halEvents,this.notificationService,this.loadingIndicator,i[0],this.wpElement,this.labels,e,t))),Promise.resolve()}cellRenderer(e){return this.schemaCache.of(e).isMilestone?this.renderers.milestone:this.renderers.generic}refreshView(e){this.latestRenderInfo=e;const t=this.cellRenderer(e.workPackage);this.lazyInit(t,e).then((()=>{t.update(this.wpElement,this.labels,e)||this.clear()})).catch((()=>null))}}(0,k.Cg)([(0,y.O)(),(0,k.Sn)("design:type",C.p)],WorkPackageTimelineCell.prototype,"halEditing",void 0),(0,k.Cg)([(0,y.O)(),(0,k.Sn)("design:type",W.o)],WorkPackageTimelineCell.prototype,"halEvents",void 0),(0,k.Cg)([(0,y.O)(),(0,k.Sn)("design:type",N.U)],WorkPackageTimelineCell.prototype,"notificationService",void 0),(0,k.Cg)([(0,y.O)(),(0,k.Sn)("design:type",v.D)],WorkPackageTimelineCell.prototype,"states",void 0),(0,k.Cg)([(0,y.O)(),(0,k.Sn)("design:type",B.FX)],WorkPackageTimelineCell.prototype,"loadingIndicator",void 0),(0,k.Cg)([(0,y.O)(),(0,k.Sn)("design:type",j.D)],WorkPackageTimelineCell.prototype,"schemaCache",void 0);class WorkPackageTimelineCellsRenderer{constructor(e,t){this.injector=e,this.wpTimeline=t,this.cells={},this.cellRenderers={milestone:new TimelineMilestoneCellRenderer(this.injector,t),generic:new TimelineCellRenderer(this.injector,t)}}hasCell(e){return this.getCellsFor(e).length>0}getCellsFor(e){return _.filter(this.cells,(t=>t.workPackageId===e))||[]}refreshAllCells(){this.synchronizeCells(),_.each(this.cells,(e=>this.refreshSingleCell(e)))}refreshCellsFor(e){_.each(this.getCellsFor(e),(e=>this.refreshSingleCell(e)))}refreshSingleCell(e,t,n){const i=this.renderInfoFor(e.workPackageId,t,n);i.workPackage&&e.refreshView(i)}synchronizeCells(){const e=Object.keys(this.cells),t=[];_.each(this.wpTimeline.workPackageIdOrder,(e=>{const n=e.workPackageId;if(!n)return;if(this.states.workPackages.get(n).isPristine())return;const i=e.classIdentifier;this.cells[i]||(this.cells[i]=this.buildCell(i,n.toString())),t.push(i)})),_.difference(e,t).forEach((e=>{this.cells[e].clear(),delete this.cells[e]}))}buildCell(e,t){return new WorkPackageTimelineCell(this.injector,this.wpTimeline,this.cellRenderers,this.renderInfoFor(t),e,t)}renderInfoFor(e,t,n){const i=this.states.workPackages.get(e).value;return{viewParams:this.wpTimeline.viewParameters,workPackage:i,change:this.halEditing.changeFor(i),isDuplicatedCell:t,withAlternativeLabels:n}}buildCellsAndRenderOnRow(e,t,n){const i=e.map((e=>this.buildCell(t,e)));return i.forEach((e=>this.refreshSingleCell(e,n,!0))),i}}(0,k.Cg)([(0,y.O)(),(0,k.Sn)("design:type",v.D)],WorkPackageTimelineCellsRenderer.prototype,"states",void 0),(0,k.Cg)([(0,y.O)(),(0,k.Sn)("design:type",C.p)],WorkPackageTimelineCellsRenderer.prototype,"halEditing",void 0);var q=n(21861),L=n(94450),H=n(70512),z=n(36819),Q=n(19999),K=n(56196),J=n(99496),Z=n(43311),ee=n(11762),te=n(59769),ne=n(80559),ie=n(42032),oe=n(68559);class WorkPackageTimelineTableController extends J.p{get commonPipes(){return e=>e.pipe(this.untilDestroyed(),(0,m.Q)(this.querySpace.stopAllSubscriptions),(0,g.p)((()=>this.initialized&&this.wpTableTimeline.isVisible)))}get workPackagesWithGroupHeaderCell(){const e=this.querySpace.results.value.elements.filter((e=>this.shouldBeShownInCollapsedGroupHeaders(e))).map((e=>e.id));return this.orderedRows.filter((t=>e.includes(t.workPackageId)&&!this.workPackageIdOrder.includes(t)))}constructor(e,t,n,i,o,r,s,a,l,c,p,d,u,h,m){super(),this.injector=e,this.elementRef=t,this.states=n,this.wpTableComponent=i,this.toastService=o,this.wpTableTimeline=r,this.notificationService=s,this.wpRelations=a,this.wpTableHierarchies=l,this.halEvents=c,this.querySpace=p,this.I18n=d,this.workPackageViewCollapsedGroupsService=u,this.weekdaysService=h,this.daysService=m,this._viewParameters=new I.Hs,this.disableViewParamsCalculation=!1,this.workPackageIdOrder=[],this.renderers={},this.cellsRenderer=new WorkPackageTimelineCellsRenderer(this.injector,this),this.selectionParams={notification:null},this.refreshRequest=(0,b.hF)(),this.collapsedGroupsCellsMap={},this.orderedRows=[],this.nonWorkingDays=[]}ngAfterViewInit(){this.$element=jQuery(this.elementRef.nativeElement);const e=document.querySelector(".work-packages-tabletimeline--timeline-side");e&&e.addEventListener("scroll",(()=>{this.requireNonWorkingDays(this.getFirstDayInViewport().format("YYYY-MM-DD"),this.getLastDayInViewport().format("YYYY-MM-DD"))})),this.text={selectionMode:this.I18n.t("js.gantt_chart.selection_mode.notification")},this.outerContainer=this.$element.find(".wp-table-timeline--outer"),this.timelineBody=this.$element.find(".wp-table-timeline--body"),this.wpTableComponent.registerTimeline(this,this.timelineBody[0]),window.addEventListener("wp-resize.timeline",(()=>this.refreshRequest.putValue(void 0))),(0,Q.z)([this.querySpace.tableRendered.values$(),this.refreshRequest.changes$(),this.wpTableTimeline.live$(),this.weekdaysService.loadWeekdays()]).pipe(this.commonPipes).subscribe((([e])=>{this.workPackageIdOrder=e.filter((e=>!e.hidden)),this.orderedRows=e,this.refreshView()})),this.setupManageCollapsedGroupHeaderCells()}workPackageCells(e){return this.cellsRenderer.getCellsFor(e)}workPackageIndex(e){return this.workPackageIdOrder.findIndex((t=>t.classIdentifier===e))}onRefreshRequested(e,t){this.renderers[e]=t}getAbsoluteLeftCoordinates(){return this.$element.offset().left}getParentScrollContainer(){return this.outerContainer.closest(H._e)[0]}get viewParameters(){return this._viewParameters}get inHierarchyMode(){return this.wpTableHierarchies.isEnabled}get initialized(){return this.workPackageTable&&this.querySpace.tableRendered.hasValue()}refreshView(){var e=this;this.wpTableTimeline.isVisible?(this.wpTableTimeline.isAutoZoom()?this.applyAutoZoomLevel():(this._viewParameters.settings.zoomLevel=this.wpTableTimeline.zoomLevel,this.wpTableTimeline.appliedZoomLevel=this.wpTableTimeline.zoomLevel),(0,z.li)("refreshView() in timeline container",(0,p.A)((function*(){e.outerContainer.css("width","auto"),e.calculateViewParams(e._viewParameters),yield e.requireNonWorkingDays(e.getFirstDayInViewport().format("YYYY-MM-DD"),e.getLastDayInViewport().format("YYYY-MM-DD")),e.cellsRenderer.refreshAllCells(),_.each(e.renderers,((t,n)=>{(0,z.cY)(`Refreshing timeline member ${n}`),t(e._viewParameters)})),e.refreshCollapsedGroupsHeaderCells(e.collapsedGroupsCellsMap,e.cellsRenderer);const t=e.$element.find(I.Qy)[0].scrollWidth;e.outerContainer.width(t),setTimeout((()=>{e.querySpace.timelineRendered.next(null)}))})))):(0,z.cY)("refreshView() requested, but TL is invisible.")}startAddRelationPredecessor(e){this.activateSelectionMode(e.id,(t=>{this.wpRelations.addCommonRelation(e.id,"follows",t.id).then((()=>{this.halEvents.push(e,{eventType:"association",relatedWorkPackage:t.id,relationType:"follows"})})).catch((e=>this.notificationService.handleRawError(e,t)))}))}startAddRelationFollower(e){this.activateSelectionMode(e.id,(t=>{this.wpRelations.addCommonRelation(e.id,"precedes",t.id).then((()=>{this.halEvents.push(e,{eventType:"association",relatedWorkPackage:t.id,relationType:"precedes"})})).catch((e=>this.notificationService.handleRawError(e,t)))}))}getFirstDayInViewport(){const e=this.getParentScrollContainer(),{scrollLeft:t}=e,n=Math.floor(t/this.viewParameters.pixelPerDay);return this.viewParameters.dateDisplayStart.clone().add(n,"days")}getLastDayInViewport(){const e=this.getParentScrollContainer(),{scrollLeft:t}=e,n=t+e.offsetWidth,i=Math.ceil(n/this.viewParameters.pixelPerDay)+1;return this.viewParameters.dateDisplayStart.clone().add(i,"days")}forceCursor(e){jQuery(`.${I.pz}`).css("cursor",e),jQuery(".wp-timeline-cell").css("cursor",e),jQuery(".hascontextmenu").css("cursor",e),jQuery(".leftHandle").css("cursor",e),jQuery(".rightHandle").css("cursor",e)}resetCursor(){jQuery(`.${I.pz}`).css("cursor",""),jQuery(".wp-timeline-cell").css("cursor",""),jQuery(".hascontextmenu").css("cursor",""),jQuery(".leftHandle").css("cursor",""),jQuery(".rightHandle").css("cursor","")}resetSelectionMode(){this._viewParameters.activeSelectionMode=null,this._viewParameters.selectionModeStart=null,this.selectionParams.notification&&this.toastService.remove(this.selectionParams.notification),ne.unbind("esc"),this.$element.removeClass("active-selection-mode"),jQuery(`.${I.q1}`).removeClass(I.q1),this.refreshView()}activateSelectionMode(e,t){e=e.toString(),this._viewParameters.activeSelectionMode=e=>{t(e),this.resetSelectionMode()},this._viewParameters.selectionModeStart=e,ne.bind("esc",(()=>this.resetSelectionMode())),this.selectionParams.notification=this.toastService.addNotice(this.text.selectionMode),this.$element.addClass("active-selection-mode"),this.refreshView()}requireNonWorkingDays(e,t){var n=this;return(0,p.A)((function*(){n.nonWorkingDays=yield(0,K._)(n.daysService.requireNonWorkingYears$(e,t).pipe((0,f.s)(1)))}))()}isNonWorkingDay(e){const t=h(e).format("YYYY-MM-DD");return-1!==this.nonWorkingDays.findIndex((e=>e.date===t))}calculateViewParams(e){if(this.disableViewParamsCalculation)return!1;const t=new I.Hs;let n=!1;this.getWorkPackagesToCalculateTimelineWidthFrom().forEach((n=>{const i=n.workPackageId;if(!i)return;const o=this.states.workPackages.get(i).value;if(!o)return;const r=o.startDate?h(o.startDate):e.now,s=o.dueDate?h(o.dueDate):e.now,a=o.date?h(o.date):e.now;t.dateDisplayStart=h.min(t.dateDisplayStart,e.now,r,a).clone(),t.dateDisplayEnd=h.max(t.dateDisplayEnd,e.now,s,a).clone()})),t.dateDisplayStart.subtract(e.dayCountForMarginLeft,"days");const i=this.$element.children().width(),{pixelPerDay:o}=e,r=Math.ceil(i/o*1.5);t.dateDisplayEnd.add(r,"days"),t.dateDisplayStart.isSame(this._viewParameters.dateDisplayStart)||(n=!0,this._viewParameters.dateDisplayStart=t.dateDisplayStart),t.dateDisplayEnd.isSame(this._viewParameters.dateDisplayEnd)||(n=!0,this._viewParameters.dateDisplayEnd=t.dateDisplayEnd);const s=[this.getFirstDayInViewport(),this.getLastDayInViewport()];return this._viewParameters.visibleViewportAtCalculationTime=s,n}applyAutoZoomLevel(){if(0===this.workPackageIdOrder.length)return;const e=this.getWorkPackagesToCalculateTimelineWidthFrom(),t=(0,I.lR)(e,this.states.workPackages,this._viewParameters),n=this.$element.parent().width()-2*I.bS;for(const e of I.W8){if(n/(0,I.W0)(e)>=t||e===_.last(I.W8)){return this._viewParameters.settings.zoomLevel!==e&&(this._viewParameters.settings.zoomLevel=e,this.wpTableComponent.timeline.scrollLeft=0),void(this.wpTableTimeline.appliedZoomLevel=e)}}}setupManageCollapsedGroupHeaderCells(){this.workPackageViewCollapsedGroupsService.updates$().pipe(this.commonPipes).subscribe((e=>{this.manageCollapsedGroupHeaderCells(e,this.querySpace.results.value.elements,this.collapsedGroupsCellsMap)}))}manageCollapsedGroupHeaderCells(e,t,n){const i=e.allGroupsChanged,o=e.state,r=Object.keys(o);let s=[];if(r.length){if(i)s=r.filter((t=>this.shouldManageCollapsedGroupHeaderCells(t,e)));else{const t=e.lastChangedGroup;this.shouldManageCollapsedGroupHeaderCells(t,e)&&(s=[t])}s.forEach((e=>{o[e]?this.createCollapsedGroupHeaderCells(e,t,n):this.removeCollapsedGroupHeaderCells(e,n)}))}}shouldManageCollapsedGroupHeaderCells(e,t){const n=(0,ee.$m)(e);return this.workPackageViewCollapsedGroupsService.groupTypesWithHeaderCellsWhenCollapsed.includes(n)&&this.workPackageViewCollapsedGroupsService.groupTypesWithHeaderCellsWhenCollapsed.includes(t.groupedBy)}createCollapsedGroupHeaderCells(e,t,n){this.removeCollapsedGroupHeaderCells(e,n);const i=(0,ee.QY)(e),o=(0,ee.$m)(e),r=t.filter((e=>e[o].id===i)).filter((e=>this.shouldBeShownInCollapsedGroupHeaders(e)&&(e.date||e.startDate))).map((e=>e.id));this.collapsedGroupsCellsMap[e]=this.cellsRenderer.buildCellsAndRenderOnRow(r,`group-${e}-timeline`,!0)}removeCollapsedGroupHeaderCells(e,t){t[e]&&(t[e].forEach((e=>e.clear())),t[e]=[])}refreshCollapsedGroupsHeaderCells(e,t){Object.keys(e).forEach((n=>{e[n].forEach((e=>t.refreshSingleCell(e,!1,!0)))}))}shouldBeShownInCollapsedGroupHeaders(e){return this.workPackageViewCollapsedGroupsService.wpTypesToShowInCollapsedGroupHeaders.some((t=>t(e)))}getWorkPackagesToCalculateTimelineWidthFrom(){return[...this.workPackageIdOrder,...this.workPackagesWithGroupHeaderCell]}static{this.ɵfac=function WorkPackageTimelineTableController_Factory(e){return new(e||WorkPackageTimelineTableController)(oe.rXU(oe.zZn),oe.rXU(oe.aKT),oe.rXU(v.D),oe.rXU(Z.c),oe.rXU(u.fw),oe.rXU(S.X),oe.rXU(N.U),oe.rXU(q.U),oe.rXU(L.j),oe.rXU(W.o),oe.rXU(U.i),oe.rXU(d.W),oe.rXU(te.V),oe.rXU(P.I),oe.rXU(ie.o))}}static{this.ɵcmp=oe.VBU({type:WorkPackageTimelineTableController,selectors:[["wp-timeline-container"]],features:[oe.Vt3],decls:7,vars:0,consts:[[1,"wp-table-timeline--outer"],[1,"wp-table-timeline--container"],[1,"wp-table-timeline--body"]],template:function WorkPackageTimelineTableController_Template(e,t){1&e&&(oe.j41(0,"div",0)(1,"div",1),oe.nrm(2,"wp-timeline-header")(3,"wp-timeline-static-elements")(4,"wp-timeline-grid")(5,"wp-timeline-relations")(6,"div",2),oe.k0s()())},encapsulation:2})}}var re=n(97975),se=n(82633),ae=n(11284),le=n(67369),ce=n(51133),pe=n(88352),de=n(1750),ue=n(1257),he=(n(3422),n(16545)),me=n(76008),ge=n(48908);class OpColumnsContextMenu extends ae.i{constructor(e,t,n,i,o,r,s,a,l,c){super(e,t),this.elementRef=e,this.opContextMenu=t,this.wpTableColumns=n,this.wpTableSortBy=i,this.wpTableGroupBy=o,this.wpTableHierarchies=r,this.opModalService=s,this.injector=a,this.I18n=l,this.confirmDialog=c,this.text={confirmDelete:{text:this.I18n.t("js.work_packages.table_configuration.sorting_mode.warning"),title:this.I18n.t("js.modals.form_submit.title")}}}open(e){this.table.configuration.columnMenuEnabled&&(this.buildItems(),this.opContextMenu.show(this,e))}get locals(){return{showAnchorRight:this.column&&"id"!==this.column.id,contextMenuId:"column-context-menu",items:this.items}}positionArgs(e){const t={of:this.$element.find(".generic-table--sort-header-outer")},n=super.positionArgs(e);return _.assign(n,t),n}get afterFocusOn(){return this.$element.find(`#${this.column.id}`)}buildItems(){const e=this.column;this.items=[{hidden:!this.wpTableSortBy.isSortable(e),linkText:this.I18n.t("js.work_packages.query.sort_descending"),icon:"icon-sort-descending",onClick:t=>this.wpTableSortBy.isManualSortingMode?(this.confirmDialog.confirm({text:this.text.confirmDelete}).then((()=>(this.wpTableSortBy.setAsSingleSortCriteria(e,me.yM),!0))),!1):(this.wpTableSortBy.addSortCriteria(e,me.yM),!0)},{hidden:!this.wpTableSortBy.isSortable(e),linkText:this.I18n.t("js.work_packages.query.sort_ascending"),icon:"icon-sort-ascending",onClick:t=>this.wpTableSortBy.isManualSortingMode?(this.confirmDialog.confirm({text:this.text.confirmDelete}).then((()=>(this.wpTableSortBy.setAsSingleSortCriteria(e,me.cG),!0))),!1):(this.wpTableSortBy.addSortCriteria(e,me.cG),!0)},{hidden:!this.wpTableGroupBy.isGroupable(e)||this.wpTableGroupBy.isCurrentlyGroupedBy(e),linkText:this.I18n.t("js.work_packages.query.group"),icon:"icon-group-by",onClick:()=>(this.wpTableHierarchies.isEnabled&&this.wpTableHierarchies.setEnabled(!1),this.wpTableGroupBy.setBy(e),!0)},{hidden:this.wpTableColumns.isFirst(e),linkText:this.I18n.t("js.work_packages.query.move_column_left"),icon:"icon-column-left",onClick:()=>(this.wpTableColumns.shift(e,-1),!0)},{hidden:this.wpTableColumns.isLast(e),linkText:this.I18n.t("js.work_packages.query.move_column_right"),icon:"icon-column-right",onClick:()=>(this.wpTableColumns.shift(e,1),!0)},{linkText:this.I18n.t("js.work_packages.query.hide_column"),icon:"icon-delete",onClick:()=>{const t=this.wpTableColumns.previous(e)||this.wpTableColumns.next(e);return this.wpTableColumns.removeColumn(e),setTimeout((()=>{t&&jQuery(`#${t.id}`).focus()})),!0}},{linkText:this.I18n.t("js.work_packages.query.insert_columns"),icon:"icon-columns",onClick:()=>(this.opModalService.show(he.E,this.injector,{initialTab:"columns"}),!0)}]}static{this.ɵfac=function OpColumnsContextMenu_Factory(e){return new(e||OpColumnsContextMenu)(oe.rXU(oe.aKT),oe.rXU(le.V),oe.rXU(pe.T),oe.rXU(ue.P),oe.rXU(de.W),oe.rXU(L.j),oe.rXU(ce.a),oe.rXU(oe.zZn),oe.rXU(d.W),oe.rXU(ge.g))}}static{this.ɵdir=oe.FsC({type:OpColumnsContextMenu,selectors:[["","opColumnsContextMenu",""]],inputs:{column:[oe.Mj6.None,"opColumnsContextMenu-column","column"],table:[oe.Mj6.None,"opColumnsContextMenu-table","table"]},features:[oe.Vt3]})}}var _e=n(67035),fe=n(57592),be=n(99274),ke=n(61944);class WorkPackageTimelineHeaderController{constructor(e,t,n,i){this.I18n=t,this.wpTimelineService=n,this.workPackageTimelineTableController=i,this.$element=jQuery(e.nativeElement)}ngOnInit(){this.workPackageTimelineTableController.onRefreshRequested("header",(e=>this.refreshView(e)))}refreshView(e){this.innerHeader=this.$element.find(".wp-table-timeline--header-inner"),this.renderLabels(e)}renderLabels(e){switch(this.innerHeader.empty(),this.innerHeader.attr("data-current-zoom-level",this.wpTimelineService.zoomLevel),e.settings.zoomLevel){case"days":this.renderLabelsDays(e);break;case"weeks":this.renderLabelsWeeks(e);break;case"months":this.renderLabelsMonths(e);break;case"quarters":this.renderLabelsQuarters(e);break;case"years":this.renderLabelsYears(e);break;default:return}this.activeZoomLevel=e.settings.zoomLevel}renderLabelsDays(e){this.renderTimeSlices(e,"month",0,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=e.format("MMM YYYY"),t.classList.add("wp-timeline--header-top-bold-element"),t.style.height="13px"})),this.renderTimeSlices(e,"week",13,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=e.format("ww"),t.classList.add("-top-border"),t.style.height="32px"})),this.renderTimeSlices(e,"day",23,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=e.format("D"),t.classList.add("-top-border"),t.style.height="22px"})),this.renderTimeSlices(e,"day",33,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=e.format("dd"),t.classList.add("wp-timeline--header-day-element")}))}renderLabelsWeeks(e){this.renderTimeSlices(e,"month",0,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=e.format("MMM YYYY"),t.classList.add("wp-timeline--header-top-bold-element")})),this.renderTimeSlices(e,"week",15,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=e.format("ww"),t.classList.add("-top-border"),t.style.height="22px"})),this.renderTimeSlices(e,"day",25,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=e.format("D"),t.classList.add("wp-timeline--header-middle-element")}))}renderLabelsMonths(e){this.renderTimeSlices(e,"year",0,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=e.format("YYYY"),t.classList.add("wp-timeline--header-top-bold-element")})),this.renderTimeSlices(e,"month",15,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=e.format("MMM"),t.classList.add("-top-border"),t.style.height="30px"})),this.renderTimeSlices(e,"week",25,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=e.format("ww"),t.classList.add("wp-timeline--header-middle-element")}))}renderLabelsQuarters(e){this.renderTimeSlices(e,"year",0,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.classList.add("wp-timeline--header-top-bold-element"),t.innerHTML=e.format("YYYY")})),this.renderTimeSlices(e,"quarter",15,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=this.I18n.t("js.gantt_chart.quarter_label",{quarter_number:e.format("Q")}),t.classList.add("-top-border"),t.style.height="30px"})),this.renderTimeSlices(e,"month",25,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=e.format("MMM"),t.classList.add("wp-timeline--header-middle-element")}))}renderLabelsYears(e){this.renderTimeSlices(e,"year",0,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=e.format("YYYY"),t.classList.add("wp-timeline--header-top-bold-element")})),this.renderTimeSlices(e,"quarter",15,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=this.I18n.t("js.gantt_chart.quarter_label",{quarter_number:e.format("Q")}),t.classList.add("-top-border"),t.style.height="30px"})),this.renderTimeSlices(e,"month",25,e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.innerHTML=e.format("M"),t.classList.add("wp-timeline--header-middle-element")}))}renderTimeSlices(e,t,n,i,o,r){const{inViewportAndBoundaries:s,rest:a}=(0,I.tI)(e,t,i,o);for(const[t,o]of s){const s=this.addLabelCell();s.style.top=`${n}px`,s.style.left=(0,I.JO)(e,t.diff(i,"days")),s.style.width=(0,I.JO)(e,o.diff(t,"days")+1),r(t,s)}setTimeout((()=>{for(const[t,o]of a){const s=this.addLabelCell();s.style.top=`${n}px`,s.style.left=(0,I.JO)(e,t.diff(i,"days")),s.style.width=(0,I.JO)(e,o.diff(t,"days")+1),r(t,s)}}),0)}addLabelCell(){const e=document.createElement("div");return e.className=I._$,this.innerHeader.append(e),e}static{this.ɵfac=function WorkPackageTimelineHeaderController_Factory(e){return new(e||WorkPackageTimelineHeaderController)(oe.rXU(oe.aKT),oe.rXU(d.W),oe.rXU(S.X),oe.rXU(WorkPackageTimelineTableController))}}static{this.ɵcmp=oe.VBU({type:WorkPackageTimelineHeaderController,selectors:[["wp-timeline-header"]],decls:2,vars:0,consts:[[1,"wp-table-timeline--header"],[1,"wp-table-timeline--header-inner"]],template:function WorkPackageTimelineHeaderController_Template(e,t){1&e&&(oe.j41(0,"div",0),oe.nrm(1,"div",1),oe.k0s())},encapsulation:2})}}var ve=n(70271);function workPackagePrefix(e){return`__tl-relation-${e}`}class TimelineRelationElement{constructor(e,t){this.belongsToId=e,this.relation=t}get classNames(){return[workPackagePrefix(this.relation.ids.from),workPackagePrefix(this.relation.ids.to)]}}const Ce="relation-line";function newSegment(e,t,n,i,o,r,s,a){const l=document.createElement("div");return l.classList.add(I.pz,Ce,...t),l.style.top=`${40*n+i}px`,l.style.left=`${o}px`,l.style.width=`${r}px`,l.style.height=`${s}px`,l}class WorkPackageTableTimelineRelations extends J.p{constructor(e,t,n,i,o,r){super(),this.injector=e,this.elementRef=t,this.states=n,this.workPackageTimelineTableController=i,this.wpTableTimeline=o,this.wpRelations=r,this.workPackagesWithRelations={}}ngOnInit(){const e=jQuery(this.elementRef.nativeElement);this.container=e.find(".wp-table-timeline--relations"),this.workPackageTimelineTableController.onRefreshRequested("relations",(e=>this.refreshView())),this.setupRelationSubscription()}refreshView(){this.update()}get workPackageIdOrder(){return this.workPackageTimelineTableController.workPackageIdOrder}setupRelationSubscription(){(0,Q.z)([this.querySpace.renderedWorkPackages.values$(),this.wpTableTimeline.live$()]).pipe((0,g.p)((([e,t])=>t.visible)),this.untilDestroyed(),(0,ve.T)((([e,t])=>e))).subscribe((e=>{const t=_.compact(e.map((e=>e.workPackageId)));this.wpRelations.requireAll(t),t.forEach((e=>{const t=this.wpRelations.state(e);this.workPackagesWithRelations[e]=t,t.values$().pipe((0,f.s)(1)).subscribe((()=>{this.renderWorkPackagesRelations([e])}))}))})),this.states.workPackages.observeChange().pipe(this.untilDestroyed(),(0,g.p)((()=>this.wpTableTimeline.isVisible))).subscribe((([e])=>{this.renderWorkPackagesRelations([e])}))}renderWorkPackagesRelations(e){e.forEach((e=>{const t=this.workPackagesWithRelations[e];if(_.isNil(t))return;this.removeRelationElementsForWorkPackage(e);const n=_.values(t.value);_.values(n).forEach((e=>{if("precedes"!==e.type&&"follows"!==e.type)return;const t=new TimelineRelationElement(e.ids.from,e);this.renderElement(this.workPackageTimelineTableController.viewParameters,t)}))}))}update(){this.removeAllVisibleElements(),this.renderElements()}removeRelationElementsForWorkPackage(e){const t=workPackagePrefix(e);this.container.find(`.${t}`).remove()}removeAllVisibleElements(){this.container.find(`.${Ce}`).remove()}renderElements(){const e=_.keys(this.workPackagesWithRelations);this.renderWorkPackagesRelations(e)}renderElement(e,t){const n=t.relation.ids,i=this.workPackageTimelineTableController.workPackageCells(n.to),o=this.workPackageTimelineTableController.workPackageCells(n.from);0!==i.length&&0!==o.length&&i.forEach((n=>{const i=this.workPackageTimelineTableController.workPackageIndex(n.classIdentifier);o.forEach((o=>{const r=this.workPackageTimelineTableController.workPackageIndex(o.classIdentifier);this.renderRelation(e,t,i,r,n,o)}))}))}renderRelation(e,t,n,i,o,r){const s=this.workPackageIdOrder[n],a=this.workPackageIdOrder[i];if(!s||!a||s.hidden||a.hidden)return;if(!o.canConnectRelations()||!r.canConnectRelations())return;const l=o.getMarginLeftOfRightSide()-o.getPaddingRightForOutgoingRelationLines(),c=r.getMarginLeftOfLeftSide()+r.getPaddingLeftForIncomingRelationLines(),p=n<i?"toDown":"toUp",d=c>l?"toRight":c<l?"toLeft":"beneath";if(!o)return;const u=o.getPaddingRightForOutgoingRelationLines(),h=r.getPaddingLeftForIncomingRelationLines()+(u>0?u:0);this.container.append(newSegment(0,t.classNames,n,19,l,h,1));const m=l+h,g=Math.abs(i-n);"toDown"===p?"toRight"===d||"beneath"===d?this.container.append(newSegment(0,t.classNames,n,19,m,1,40*g)):"toLeft"===d&&this.container.append(newSegment(0,t.classNames,n,19,m,1,40*g-10)):"toUp"===p&&this.container.append(newSegment(0,t.classNames,i,30,m,1,40*g-10)),"toRight"===d?"toDown"===p?this.container.append(newSegment(0,t.classNames,i,19,m,c-m,1)):"toUp"===p&&(this.container.append(newSegment(0,t.classNames,i,20,m,1,10)),this.container.append(newSegment(0,t.classNames,i,20,m,c-m,1))):"toLeft"===d&&("toDown"===p?(this.container.append(newSegment(0,t.classNames,i,0,m,1,8)),this.container.append(newSegment(0,t.classNames,i,8,c,m-c,1)),this.container.append(newSegment(0,t.classNames,i,8,c,1,11))):"toUp"===p&&(this.container.append(newSegment(0,t.classNames,i,30,c+1,m-c,1)),this.container.append(newSegment(0,t.classNames,i,19,c+1,1,11))))}static{this.ɵfac=function WorkPackageTableTimelineRelations_Factory(e){return new(e||WorkPackageTableTimelineRelations)(oe.rXU(oe.zZn),oe.rXU(oe.aKT),oe.rXU(v.D),oe.rXU(WorkPackageTimelineTableController),oe.rXU(S.X),oe.rXU(q.U))}}static{this.ɵcmp=oe.VBU({type:WorkPackageTableTimelineRelations,selectors:[["wp-timeline-relations"]],features:[oe.Vt3],decls:1,vars:0,consts:[[1,"wp-table-timeline--relations"]],template:function WorkPackageTableTimelineRelations_Template(e,t){1&e&&oe.nrm(0,"div",0)},encapsulation:2})}}(0,k.Cg)([(0,y.O)(),(0,k.Sn)("design:type",U.i)],WorkPackageTableTimelineRelations.prototype,"querySpace",void 0);const ye="wp-timeline--static-element";class TimelineStaticElement{constructor(){}render(e){const t=document.createElement("div");return t.id=this.identifier,t.classList.add(...this.classNames),this.finishElement(t,e)}get classNames(){return[ye]}}class TodayLineElement extends TimelineStaticElement{finishElement(e,t){const n=t.now.diff(t.dateDisplayStart,"days"),i=h().hour()/24;return e.style.left=(0,I.JO)(t,n+i),e}get identifier(){return"wp-timeline-static-element-today-line"}}class WorkPackageTableTimelineStaticElements{constructor(e,t,n){this.states=t,this.workPackageTimelineTableController=n,this.$element=e.nativeElement,this.elements=[new TodayLineElement]}ngOnInit(){this.container=this.$element.querySelector(".wp-table-timeline--static-elements"),this.workPackageTimelineTableController.onRefreshRequested("static elements",(e=>this.update(e)))}update(e){this.removeAllVisibleElements(),this.renderElements(e)}removeAllVisibleElements(){this.container.querySelectorAll(`.${ye}`).forEach((e=>e.remove()))}renderElements(e){for(const t of this.elements)this.container.appendChild(t.render(e));const t=document.querySelector(".work-packages-tabletimeline--timeline-side");if(null!==t&&"auto"!==e.settings.zoomLevel){const n=e.now.clone().subtract(e.settings.visibleBeforeTodayInZoomLevel,e.settings.zoomLevel).diff(e.dateDisplayStart,"days"),i=(0,I.HY)(e,n);t.scrollLeft=i}}static{this.ɵfac=function WorkPackageTableTimelineStaticElements_Factory(e){return new(e||WorkPackageTableTimelineStaticElements)(oe.rXU(oe.aKT),oe.rXU(v.D),oe.rXU(WorkPackageTimelineTableController))}}static{this.ɵcmp=oe.VBU({type:WorkPackageTableTimelineStaticElements,selectors:[["wp-timeline-static-elements"]],decls:1,vars:0,consts:[[1,"wp-table-timeline--static-elements"]],template:function WorkPackageTableTimelineStaticElements_Template(e,t){1&e&&oe.nrm(0,"div",0)},encapsulation:2})}}class WorkPackageTableTimelineGrid{constructor(e,t,n){this.elementRef=e,this.wpTimeline=t,this.weekdaysService=n}ngAfterViewInit(){const e=jQuery(this.elementRef.nativeElement);this.gridContainer=e.find(".wp-table-timeline--grid"),this.wpTimeline.onRefreshRequested("grid",(e=>this.refreshView(e)))}refreshView(e){this.renderLabels(e)}renderLabels(e){switch(this.gridContainer.empty(),e.settings.zoomLevel){case"days":this.renderLabelsDays(e);break;case"weeks":this.renderLabelsWeeks(e);break;case"months":this.renderLabelsMonths(e);break;case"quarters":this.renderLabelsQuarters(e);break;case"years":this.renderLabelsYears(e);break;default:return}this.activeZoomLevel=e.settings.zoomLevel}renderLabelsDays(e){this.renderTimeSlices(e,"day",e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.style.paddingTop="1px",this.checkForNonWorkingDayHighlight(e,t)})),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.classList.add("wp-timeline--grid-element_highlight"),t.style.zIndex="2"}))}renderLabelsWeeks(e){this.renderTimeSlices(e,"day",e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{this.checkForNonWorkingDayHighlight(e,t)})),this.renderTimeSlices(e,"week",e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.classList.add("wp-timeline--grid-element_highlight")})),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.classList.add("wp-timeline--grid-element_highlight"),t.style.zIndex="2"}))}renderLabelsMonths(e){this.renderTimeSlices(e,"week",e.dateDisplayStart,e.dateDisplayEnd,(()=>{})),this.renderTimeSlices(e,"month",e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.classList.add("wp-timeline--grid-element_highlight")})),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.classList.add("wp-timeline--grid-element_highlight"),t.style.zIndex="2"}))}renderLabelsQuarters(e){this.renderTimeSlices(e,"month",e.dateDisplayStart,e.dateDisplayEnd,(()=>{})),this.renderTimeSlices(e,"quarter",e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.classList.add("wp-timeline--grid-element_highlight")})),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.classList.add("wp-timeline--grid-element_highlight"),t.style.zIndex="2"}))}renderLabelsYears(e){this.renderTimeSlices(e,"month",e.dateDisplayStart,e.dateDisplayEnd,(()=>{})),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,((e,t)=>{t.classList.add("wp-timeline--grid-element_highlight")}))}renderTimeSlices(e,t,n,i,o){const{inViewportAndBoundaries:r,rest:s}=(0,I.tI)(e,t,n,i);for(const[t,i]of r){const r=document.createElement("div");r.classList.add(I.pz,I.$K),r.style.left=(0,I.JO)(e,t.diff(n,"days")),r.style.width=(0,I.JO)(e,i.diff(t,"days")+1),this.gridContainer[0].appendChild(r),o(t,r)}setTimeout((()=>{for(const[t,i]of s){const r=document.createElement("div");r.classList.add(I.pz,I.$K),r.style.left=(0,I.JO)(e,t.diff(n,"days")),r.style.width=(0,I.JO)(e,i.diff(t,"days")+1),this.gridContainer[0].appendChild(r),o(t,r)}}),0)}checkForNonWorkingDayHighlight(e,t){const n=e.toDate();(this.weekdaysService.isNonWorkingDay(n)||this.wpTimeline.isNonWorkingDay(n))&&(t.classList.add("wp-timeline--non-working-day"),t.dataset.testSelector=`wp-timeline--non-working-day_${n.getDate()}-${n.getMonth()+1}-${n.getFullYear()}`)}static{this.ɵfac=function WorkPackageTableTimelineGrid_Factory(e){return new(e||WorkPackageTableTimelineGrid)(oe.rXU(oe.aKT),oe.rXU(WorkPackageTimelineTableController),oe.rXU(P.I))}}static{this.ɵcmp=oe.VBU({type:WorkPackageTableTimelineGrid,selectors:[["wp-timeline-grid"]],decls:1,vars:0,consts:[[1,"wp-table-timeline--grid"]],template:function WorkPackageTableTimelineGrid_Template(e,t){1&e&&oe.nrm(0,"div",0)},encapsulation:2})}}var we=n(43341),Te=n(33389),Se=n(66557),je=n(72864),Pe=n(94210),Ie=n(26030),xe=n(6540),Re=n(31616),Fe=n(73217),Me=n(38761),Oe=n(8865),De=(n(68643),n(60316)),Ge=n(73014),Ee=n(3575),Ae=n(88955),Ve=n(34456),$e=n(46765),Be=n(2768),We=n(87715),Ne=n(34539),Ue=n(8958),Ye=n(15121);const Xe=["relationDescriptionTextarea"],_c1=e=>({workPackageId:e,tabIdentifier:"relations"}),_c2=e=>({"-visible":e});function WorkPackageRelationRowComponent_div_0_button_3_span_1_Template(e,t){if(1&e&&oe.nrm(0,"span",18),2&e){const e=oe.XpG(3);oe.Y8G("textContent",e.normalizedRelationType)}}function WorkPackageRelationRowComponent_div_0_button_3_span_2_Template(e,t){if(1&e&&oe.nrm(0,"span",19),2&e){const e=oe.XpG(3);oe.Y8G("ngClass",e.highlightingClassForWpType())("textContent",e.relatedWorkPackage.type.name)}}function WorkPackageRelationRowComponent_div_0_button_3_Template(e,t){if(1&e){const e=oe.RV6();oe.j41(0,"button",14),oe.bIt("click",(function WorkPackageRelationRowComponent_div_0_button_3_Template_button_click_0_listener(){oe.eBV(e);const t=oe.XpG(2);return oe.Njj(t.activateRelationTypeEdit())})),oe.DNE(1,WorkPackageRelationRowComponent_div_0_button_3_span_1_Template,1,1,"span",15)(2,WorkPackageRelationRowComponent_div_0_button_3_span_2_Template,1,2,"span",16),oe.nrm(3,"span",17),oe.k0s()}if(2&e){const e=oe.XpG(2);oe.R7$(),oe.Y8G("ngIf",e.groupByWorkPackageType),oe.R7$(),oe.Y8G("ngIf",!e.groupByWorkPackageType),oe.R7$(),oe.Y8G("textContent",e.text.updateRelation)}}function WorkPackageRelationRowComponent_div_0_div_4_option_2_Template(e,t){if(1&e&&oe.nrm(0,"option",23),2&e){const e=t.$implicit;oe.Y8G("textContent",e.label)("ngValue",e)}}function WorkPackageRelationRowComponent_div_0_div_4_Template(e,t){if(1&e){const e=oe.RV6();oe.j41(0,"div",20)(1,"select",21),oe.mxI("ngModelChange",(function WorkPackageRelationRowComponent_div_0_div_4_Template_select_ngModelChange_1_listener(t){oe.eBV(e);const n=oe.XpG(2);return oe.DH7(n.selectedRelationType,t)||(n.selectedRelationType=t),oe.Njj(t)})),oe.bIt("change",(function WorkPackageRelationRowComponent_div_0_div_4_Template_select_change_1_listener(){oe.eBV(e);const t=oe.XpG(2);return oe.Njj(t.saveRelationType())}))("keydown.escape",(function WorkPackageRelationRowComponent_div_0_div_4_Template_select_keydown_escape_1_listener(t){oe.eBV(e);const n=oe.XpG(2);return oe.Njj(n.cancelRelationTypeEditOnEscape(t))})),oe.DNE(2,WorkPackageRelationRowComponent_div_0_div_4_option_2_Template,1,2,"option",22),oe.k0s()()}if(2&e){const e=oe.XpG(2);oe.R7$(),oe.R50("ngModel",e.selectedRelationType),oe.R7$(),oe.Y8G("ngForOf",e.availableRelationTypes)}}function WorkPackageRelationRowComponent_div_0_edit_form_8_Template(e,t){if(1&e&&(oe.j41(0,"edit-form",24),oe.nrm(1,"op-editable-attribute-field",25),oe.k0s()),2&e){const e=oe.XpG(2);oe.Y8G("resource",e.relatedWorkPackage),oe.R7$(),oe.Y8G("resource",e.relatedWorkPackage)}}function WorkPackageRelationRowComponent_div_0_button_12_Template(e,t){if(1&e){const e=oe.RV6();oe.j41(0,"button",26),oe.bIt("click",(function WorkPackageRelationRowComponent_div_0_button_12_Template_button_click_0_listener(){oe.eBV(e);const t=oe.XpG(2);return oe.Njj(t.removeRelation())})),oe.nrm(1,"op-icon",27),oe.k0s()}if(2&e){const e=oe.XpG(2);oe.Y8G("ngClass",oe.eq3(3,_c2,e.showDescriptionInfo))("title",e.text.removeButton),oe.R7$(),oe.Y8G("icon-title",e.text.removeButton)}}function WorkPackageRelationRowComponent_div_0_div_13_button_1_Template(e,t){if(1&e){const e=oe.RV6();oe.j41(0,"button",31),oe.bIt("click",(function WorkPackageRelationRowComponent_div_0_div_13_button_1_Template_button_click_0_listener(){oe.eBV(e);const t=oe.XpG(3);return oe.Njj(t.startDescriptionEdit())})),oe.k0s()}if(2&e){const e=oe.XpG(3);oe.AVh("-placeholder",!e.relation.description),oe.Y8G("textContent",e.relation.description||e.text.placeholder.description)}}function WorkPackageRelationRowComponent_div_0_div_13_div_2_Template(e,t){if(1&e){const e=oe.RV6();oe.j41(0,"div",32)(1,"textarea",33,0),oe.bIt("keyup",(function WorkPackageRelationRowComponent_div_0_div_13_div_2_Template_textarea_keyup_1_listener(t){oe.eBV(e);const n=oe.XpG(3);return oe.Njj(n.handleDescriptionKey(t))})),oe.mxI("ngModelChange",(function WorkPackageRelationRowComponent_div_0_div_13_div_2_Template_textarea_ngModelChange_1_listener(t){oe.eBV(e);const n=oe.XpG(3);return oe.DH7(n.userInputs.newRelationText,t)||(n.userInputs.newRelationText=t),oe.Njj(t)})),oe.k0s(),oe.j41(3,"edit-field-controls",34),oe.bIt("onSave",(function WorkPackageRelationRowComponent_div_0_div_13_div_2_Template_edit_field_controls_onSave_3_listener(){oe.eBV(e);const t=oe.XpG(3);return oe.Njj(t.saveDescription())}))("onCancel",(function WorkPackageRelationRowComponent_div_0_div_13_div_2_Template_edit_field_controls_onCancel_3_listener(){oe.eBV(e);const t=oe.XpG(3);return oe.Njj(t.cancelDescriptionEdit())})),oe.k0s()()}if(2&e){const e=oe.XpG(3);oe.R7$(),oe.R50("ngModel",e.userInputs.newRelationText),oe.R7$(2),oe.Y8G("fieldController",e.fieldController)("saveTitle",e.text.save)("cancelTitle",e.text.cancel)}}function WorkPackageRelationRowComponent_div_0_div_13_Template(e,t){if(1&e&&(oe.j41(0,"div",28),oe.DNE(1,WorkPackageRelationRowComponent_div_0_div_13_button_1_Template,1,3,"button",29)(2,WorkPackageRelationRowComponent_div_0_div_13_div_2_Template,4,4,"div",30),oe.k0s()),2&e){const e=oe.XpG(2);oe.R7$(),oe.Y8G("ngIf",!e.userInputs.showDescriptionEditForm),oe.R7$(),oe.Y8G("ngIf",e.userInputs.showDescriptionEditForm)}}function WorkPackageRelationRowComponent_div_0_Template(e,t){if(1&e){const e=oe.RV6();oe.j41(0,"div",2)(1,"div",3)(2,"div"),oe.DNE(3,WorkPackageRelationRowComponent_div_0_button_3_Template,4,3,"button",4)(4,WorkPackageRelationRowComponent_div_0_div_4_Template,3,2,"div",5),oe.k0s(),oe.j41(5,"a",6),oe.EFF(6),oe.k0s(),oe.nrm(7,"a",7),oe.DNE(8,WorkPackageRelationRowComponent_div_0_edit_form_8_Template,2,2,"edit-form",8),oe.j41(9,"div",9)(10,"button",10),oe.bIt("click",(function WorkPackageRelationRowComponent_div_0_Template_button_click_10_listener(){oe.eBV(e);const t=oe.XpG();return oe.Njj(t.userInputs.showRelationInfo=!t.userInputs.showRelationInfo)})),oe.nrm(11,"op-icon",11),oe.k0s(),oe.DNE(12,WorkPackageRelationRowComponent_div_0_button_12_Template,2,5,"button",12),oe.k0s()(),oe.DNE(13,WorkPackageRelationRowComponent_div_0_div_13_Template,3,2,"div",13),oe.k0s()}if(2&e){const e=oe.XpG();oe.ZvI("relation-row relation-row-",e.relatedWorkPackage.id,""),oe.R7$(3),oe.Y8G("ngIf",!e.userInputs.showRelationTypesForm),oe.R7$(),oe.Y8G("ngIf",e.userInputs.showRelationTypesForm),oe.R7$(),oe.Y8G("uiParams",oe.eq3(16,_c1,e.relatedWorkPackage.id)),oe.R7$(),oe.SpI("#",e.relatedWorkPackage.id,""),oe.R7$(),oe.Y8G("uiParams",oe.eq3(18,_c1,e.relatedWorkPackage.id))("textContent",e.relatedWorkPackage.subject),oe.BMQ("aria-label",e.normalizedRelationType+" "+e.relatedWorkPackage.subjectWithId(0)),oe.R7$(),oe.Y8G("ngIf",e.relatedWorkPackage),oe.R7$(2),oe.Y8G("ngClass",oe.eq3(20,_c2,e.showDescriptionInfo))("title",e.text.description_label),oe.R7$(),oe.Y8G("icon-title",e.text.toggleDescription),oe.R7$(),oe.Y8G("ngIf",!!e.relation.delete),oe.R7$(),oe.Y8G("ngIf",e.userInputs.showRelationInfo)}}class WorkPackageRelationRowComponent extends J.p{constructor(e,t,n,i,o,r,s){super(),this.apiV3Service=e,this.notificationService=t,this.wpRelations=n,this.halEvents=i,this.I18n=o,this.cdRef=r,this.PathHelper=s,this.showRelationInfo=!1,this.showEditForm=!1,this.userInputs={newRelationText:"",showDescriptionEditForm:!1,showRelationTypesForm:!1,showRelationInfo:!1},this.fieldController={handler:{active:!0},required:!1},this.text={cancel:this.I18n.t("js.button_cancel"),save:this.I18n.t("js.button_save"),removeButton:this.I18n.t("js.relation_buttons.remove"),description_label:this.I18n.t("js.relation_buttons.update_description"),toggleDescription:this.I18n.t("js.relation_buttons.toggle_description"),updateRelation:this.I18n.t("js.relation_buttons.update_relation"),placeholder:{description:this.I18n.t("js.placeholders.relation_description")}}}ngOnInit(){this.relation=this.relatedWorkPackage.relatedBy,this.userInputs.newRelationText=this.relation.description||"",this.availableRelationTypes=Ee.H.LOCALIZED_RELATION_TYPES(!1),this.selectedRelationType=_.find(this.availableRelationTypes,{name:this.relation.normalizedType(this.workPackage)}),this.apiV3Service.work_packages.id(this.relatedWorkPackage).requireAndStream().pipe(this.untilDestroyed()).subscribe((e=>{this.relatedWorkPackage=e}))}get normalizedRelationType(){const e=this.relation.normalizedType(this.workPackage);return this.I18n.t(`js.relation_labels.${e}`)}get relationReady(){return this.relatedWorkPackage&&this.relatedWorkPackage.$loaded}startDescriptionEdit(){this.userInputs.showDescriptionEditForm=!0,setTimeout((()=>{const e=jQuery(this.relationDescriptionTextarea.nativeElement),t=e.val().length;e.focus(),e.prop("selectionStart",t),e.prop("selectionEnd",t)}))}handleDescriptionKey(e){27===e.which&&this.cancelDescriptionEdit()}cancelDescriptionEdit(){this.userInputs.showDescriptionEditForm=!1,this.userInputs.newRelationText=this.relation.description||""}saveDescription(){this.wpRelations.updateRelation(this.relation,{description:this.userInputs.newRelationText}).then((e=>{this.relation=e,this.relatedWorkPackage.relatedBy=e,this.userInputs.showDescriptionEditForm=!1,this.notificationService.showSave(this.relatedWorkPackage),this.cdRef.detectChanges()}))}get showDescriptionInfo(){return this.userInputs.showRelationInfo||this.relation.description}activateRelationTypeEdit(){this.groupByWorkPackageType&&(this.userInputs.showRelationTypesForm=!0)}cancelRelationTypeEditOnEscape(e){this.userInputs.showRelationTypesForm=!1}saveRelationType(){this.wpRelations.updateRelationType(this.workPackage,this.relatedWorkPackage,this.relation,this.selectedRelationType.name).then((e=>{this.notificationService.showSave(this.relatedWorkPackage),this.relatedWorkPackage.relatedBy=e,this.relation=e,this.userInputs.showRelationTypesForm=!1,this.cdRef.detectChanges()})).catch((e=>this.notificationService.handleRawError(e,this.workPackage)))}toggleUserDescriptionForm(){this.userInputs.showDescriptionEditForm=!this.userInputs.showDescriptionEditForm}removeRelation(){this.wpRelations.removeRelation(this.relation).then((()=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:null,relationType:this.relation.normalizedType(this.workPackage)}),this.apiV3Service.work_packages.cache.updateWorkPackage(this.relatedWorkPackage),this.wpRelations.updateCounter(this.workPackage),this.notificationService.showSave(this.relatedWorkPackage)})).catch((e=>this.notificationService.handleRawError(e,this.relatedWorkPackage)))}highlightingClassForWpType(){return T.H.inlineClass("type",this.relatedWorkPackage.type.id)}static{this.ɵfac=function WorkPackageRelationRowComponent_Factory(e){return new(e||WorkPackageRelationRowComponent)(oe.rXU(X.n),oe.rXU(N.U),oe.rXU(q.U),oe.rXU(W.o),oe.rXU(d.W),oe.rXU(oe.gRc),oe.rXU(Ge.B))}}static{this.ɵcmp=oe.VBU({type:WorkPackageRelationRowComponent,selectors:[["wp-relation-row"]],viewQuery:function WorkPackageRelationRowComponent_Query(e,t){if(1&e&&oe.GBs(Xe,5),2&e){let e;oe.mGM(e=oe.lsd())&&(t.relationDescriptionTextarea=e.first)}},inputs:{workPackage:"workPackage",relatedWorkPackage:"relatedWorkPackage",groupByWorkPackageType:"groupByWorkPackageType"},features:[oe.Vt3],decls:1,vars:1,consts:[["relationDescriptionTextarea",""],["opFocusWithin",".relation-row--grid-actions button",3,"class",4,"ngIf"],["opFocusWithin",".relation-row--grid-actions button"],[1,"relation-row--grid"],["type","button","class","relation-row--type","data-test-selector","op-relation--row-type",3,"click",4,"ngIf"],["class","inline-edit--container inplace-edit",4,"ngIf"],["data-test-selector","op-relation--row-id","uiSref","work-packages.show.tabs",1,"relation-row--grid-id",3,"uiParams"],["data-test-selector","op-relation--row-subject","uiSref","work-packages.show.tabs",1,"relation-row--grid-subject",3,"uiParams","textContent"],[3,"resource",4,"ngIf"],[1,"relation-row--grid-actions"],["type","button",1,"spot-link","wp-relations--description-btn",3,"click","ngClass","title"],["icon-classes","icon-info1 icon-no-color -padded wp-relations--icon wp-relations--description-icon",3,"icon-title"],["type","button","class","spot-link relation-row--remove-btn",3,"ngClass","title","click",4,"ngIf"],["class","grid-block hierarchy-item description-container",4,"ngIf"],["type","button","data-test-selector","op-relation--row-type",1,"relation-row--type",3,"click"],[3,"textContent",4,"ngIf"],[3,"ngClass","textContent",4,"ngIf"],[1,"hidden-for-sighted",3,"textContent"],[3,"textContent"],[3,"ngClass","textContent"],[1,"inline-edit--container","inplace-edit"],["role","listbox","opAutofocus","",1,"inline-edit--field","form--select",3,"ngModelChange","change","keydown.escape","ngModel"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],[3,"textContent","ngValue"],[3,"resource"],["fieldName","status",3,"resource"],["type","button",1,"spot-link","relation-row--remove-btn",3,"click","ngClass","title"],["icon-classes","icon-remove icon-no-color -padded wp-relations--icon",3,"icon-title"],[1,"grid-block","hierarchy-item","description-container"],["type","button","class","wp-relation--description-read-value",3,"-placeholder","textContent","click",4,"ngIf"],["class","wp-relation--description-wrapper textarea-wrapper",4,"ngIf"],["type","button",1,"wp-relation--description-read-value",3,"click","textContent"],[1,"wp-relation--description-wrapper","textarea-wrapper"],["autofocus","","name","description",1,"wp-relation--description-textarea",3,"keyup","ngModelChange","ngModel"],[3,"onSave","onCancel","fieldController","saveTitle","cancelTitle"]],template:function WorkPackageRelationRowComponent_Template(e,t){1&e&&oe.DNE(0,WorkPackageRelationRowComponent_div_0_Template,14,22,"div",1),2&e&&oe.Y8G("ngIf",t.workPackage&&t.relatedWorkPackage)},dependencies:[Ae.UISref,Ae.AnchorUISref,De.YU,De.Sq,De.bT,Ve.xH,Ve.y7,Ve.me,Ve.wz,Ve.BC,Ve.vS,$e.i,Be.B,We.x,Ne.G,Ue.c,Ye.C],encapsulation:2})}}const qe=["wpRelationGroupByToggler"];function WorkPackageRelationsGroupComponent_div_3_Template(e,t){if(1&e){const e=oe.RV6();oe.j41(0,"div",6)(1,"button",7,0),oe.bIt("click",(function WorkPackageRelationsGroupComponent_div_3_Template_button_click_1_listener(){oe.eBV(e);const t=oe.XpG();return oe.Njj(t.toggleButton())})),oe.nrm(3,"span",8),oe.k0s()()}if(2&e){const e=oe.XpG();oe.R7$(3),oe.Y8G("textContent",e.togglerText)}}function WorkPackageRelationsGroupComponent_div_4_wp_relation_row_1_Template(e,t){if(1&e&&oe.nrm(0,"wp-relation-row",11),2&e){const e=t.$implicit,n=oe.XpG(2);oe.Y8G("workPackage",n.workPackage)("groupByWorkPackageType",n.groupByWorkPackageType)("relatedWorkPackage",e)}}function WorkPackageRelationsGroupComponent_div_4_Template(e,t){if(1&e&&(oe.j41(0,"div",9),oe.DNE(1,WorkPackageRelationsGroupComponent_div_4_wp_relation_row_1_Template,1,3,"wp-relation-row",10),oe.k0s()),2&e){const e=oe.XpG();oe.R7$(),oe.Y8G("ngForOf",e.relatedWorkPackages)}}class WorkPackageRelationsGroupComponent{constructor(e){this.I18n=e,this.className=!0,this.onToggleGroupBy=new oe.bkB,this.text={groupByType:this.I18n.t("js.relation_buttons.group_by_wp_type"),groupByRelation:this.I18n.t("js.relation_buttons.group_by_relation_type")}}get togglerText(){return this.groupByWorkPackageType?this.text.groupByRelation:this.text.groupByType}toggleButton(){this.onToggleGroupBy.emit(),setTimeout((()=>{this.toggleElement.nativeElement.focus()}),20)}static{this.ɵfac=function WorkPackageRelationsGroupComponent_Factory(e){return new(e||WorkPackageRelationsGroupComponent)(oe.rXU(d.W))}}static{this.ɵcmp=oe.VBU({type:WorkPackageRelationsGroupComponent,selectors:[["wp-relations-group"]],viewQuery:function WorkPackageRelationsGroupComponent_Query(e,t){if(1&e&&oe.GBs(qe,5),2&e){let e;oe.mGM(e=oe.lsd())&&(t.toggleElement=e.first)}},hostVars:2,hostBindings:function WorkPackageRelationsGroupComponent_HostBindings(e,t){2&e&&oe.AVh("attributes-group",t.className)},inputs:{relatedWorkPackages:"relatedWorkPackages",workPackage:"workPackage",header:"header",firstGroup:"firstGroup",groupByWorkPackageType:"groupByWorkPackageType"},outputs:{onToggleGroupBy:"onToggleGroupBy"},decls:5,vars:3,consts:[["wpRelationGroupByToggler",""],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text","relation-group--header",3,"textContent"],["class","attributes-group--header-toggle",4,"ngIf"],["class","relation-container",4,"ngIf"],[1,"attributes-group--header-toggle"],["id","wp-relation-group-by-toggle","type","button",1,"button","-small","-transparent","-with-icon","icon-group-by","icon-small","hide-when-print",3,"click"],[3,"textContent"],[1,"relation-container"],[3,"workPackage","groupByWorkPackageType","relatedWorkPackage",4,"ngFor","ngForOf"],[3,"workPackage","groupByWorkPackageType","relatedWorkPackage"]],template:function WorkPackageRelationsGroupComponent_Template(e,t){1&e&&(oe.j41(0,"div",1)(1,"div",2),oe.nrm(2,"h3",3),oe.k0s(),oe.DNE(3,WorkPackageRelationsGroupComponent_div_3_Template,4,1,"div",4),oe.k0s(),oe.DNE(4,WorkPackageRelationsGroupComponent_div_4_Template,2,1,"div",5)),2&e&&(oe.R7$(2),oe.Y8G("textContent",t.header),oe.R7$(),oe.Y8G("ngIf",t.firstGroup),oe.R7$(),oe.Y8G("ngIf",t.relatedWorkPackages))},dependencies:[De.Sq,De.bT,WorkPackageRelationRowComponent],encapsulation:2})}}var Le=n(63132);function WorkPackageRelationsCreateComponent_div_1_Template(e,t){if(1&e){const e=oe.RV6();oe.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"button",7),oe.bIt("click",(function WorkPackageRelationsCreateComponent_div_1_Template_button_click_3_listener(){oe.eBV(e);const t=oe.XpG();return oe.Njj(t.toggleRelationsCreateForm())})),oe.nrm(4,"span",8)(5,"span",9),oe.k0s()()()()}if(2&e){const e=oe.XpG();oe.R7$(5),oe.Y8G("textContent",e.text.addNewRelation)}}function WorkPackageRelationsCreateComponent_div_3_option_4_Template(e,t){if(1&e&&oe.nrm(0,"option",20),2&e){const e=t.$implicit;oe.Y8G("textContent",e.label)("value",e.name)}}function WorkPackageRelationsCreateComponent_div_3_Template(e,t){if(1&e){const e=oe.RV6();oe.j41(0,"div",10)(1,"div",11),oe.nrm(2,"label",12),oe.j41(3,"select",13),oe.mxI("ngModelChange",(function WorkPackageRelationsCreateComponent_div_3_Template_select_ngModelChange_3_listener(t){oe.eBV(e);const n=oe.XpG();return oe.DH7(n.selectedRelationType,t)||(n.selectedRelationType=t),oe.Njj(t)})),oe.DNE(4,WorkPackageRelationsCreateComponent_div_3_option_4_Template,1,2,"option",14),oe.k0s()(),oe.j41(5,"div",15)(6,"wp-relations-autocomplete",16),oe.bIt("change",(function WorkPackageRelationsCreateComponent_div_3_Template_wp_relations_autocomplete_change_6_listener(t){oe.eBV(e);const n=oe.XpG();return oe.Njj(n.onSelected(t))}))("cancel",(function WorkPackageRelationsCreateComponent_div_3_Template_wp_relations_autocomplete_cancel_6_listener(){oe.eBV(e);const t=oe.XpG();return oe.Njj(t.toggleRelationsCreateForm())})),oe.k0s()(),oe.j41(7,"div",17)(8,"button",18),oe.bIt("click",(function WorkPackageRelationsCreateComponent_div_3_Template_button_click_8_listener(){oe.eBV(e);const t=oe.XpG();return oe.Njj(t.toggleRelationsCreateForm())})),oe.nrm(9,"op-icon",19),oe.k0s()()()}if(2&e){const e=oe.XpG();oe.R7$(2),oe.Y8G("textContent",e.text.relationType),oe.R7$(),oe.R50("ngModel",e.selectedRelationType),oe.R7$(),oe.Y8G("ngForOf",e.relationTypes),oe.R7$(2),oe.Y8G("workPackage",e.workPackage)("hiddenOverflowContainer",".work-packages-tab-view--overflow")("selectedRelationType",e.selectedRelationType),oe.R7$(3),oe.Y8G("icon-title",e.text.abort)}}class WorkPackageRelationsCreateComponent{constructor(e,t,n,i){this.I18n=e,this.wpRelations=t,this.notificationService=n,this.halEvents=i,this.showRelationsCreateForm=!1,this.selectedRelationType=Ee.H.DEFAULT(),this.relationTypes=Ee.H.LOCALIZED_RELATION_TYPES(!1),this.isDisabled=!1,this.text={abort:this.I18n.t("js.relation_buttons.abort"),relationType:this.I18n.t("js.relation_buttons.relation_type"),addNewRelation:this.I18n.t("js.relation_buttons.add_new_relation")}}onSelected(e){e&&(this.selectedWpId=e.id,this.createCommonRelation())}createCommonRelation(){return this.wpRelations.addCommonRelation(this.workPackage.id,this.selectedRelationType,this.selectedWpId).then((e=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:e.id,relationType:this.selectedRelationType}),this.notificationService.showSave(this.workPackage),this.wpRelations.updateCounter(this.workPackage),this.toggleRelationsCreateForm()})).catch((e=>{this.notificationService.handleRawError(e,this.workPackage),this.toggleRelationsCreateForm()}))}toggleRelationsCreateForm(){this.showRelationsCreateForm=!this.showRelationsCreateForm,this.selectedWpId=""}static{this.ɵfac=function WorkPackageRelationsCreateComponent_Factory(e){return new(e||WorkPackageRelationsCreateComponent)(oe.rXU(d.W),oe.rXU(q.U),oe.rXU(N.U),oe.rXU(W.o))}}static{this.ɵcmp=oe.VBU({type:WorkPackageRelationsCreateComponent,selectors:[["wp-relations-create"]],inputs:{workPackage:"workPackage"},decls:4,vars:2,consts:[[1,"wp-relations-create"],["class","wp-relations-create-button hide-when-print",4,"ngIf"],["data-indicator-name","relationAddDynamic",1,"loading-indicator--location"],["class","v-align wp-relations-create--form",4,"ngIf"],[1,"wp-relations-create-button","hide-when-print"],[1,"grid-block"],[1,"grid-content","collapse"],["type","button","opAutofocus","","id","relation--add-relation",1,"spot-link","wp-inline-create--add-link",3,"click"],[1,"spot-icon","spot-icon_add"],[3,"textContent"],[1,"v-align","wp-relations-create--form"],[1,"grid-content","collapse","medium-3"],["for","relation-type--select",1,"hidden-for-sighted",3,"textContent"],["id","relation-type--select","role","listbox","opAutofocus","",1,"form--select","relationTypeSelect",3,"ngModelChange","ngModel"],[3,"textContent","value",4,"ngFor","ngForOf"],[1,"grid-content","medium-8"],["data-test-selector","wp-relations-autocomplete",3,"change","cancel","workPackage","hiddenOverflowContainer","selectedRelationType"],[1,"grid-content","medium-1","collapse","wp-relations-controls-section","relation-row"],["type","button",1,"spot-link","wp-create-relation--cancel",3,"click"],["icon-classes","icon-remove icon-no-color -padded",3,"icon-title"],[3,"textContent","value"]],template:function WorkPackageRelationsCreateComponent_Template(e,t){1&e&&(oe.j41(0,"div",0),oe.DNE(1,WorkPackageRelationsCreateComponent_div_1_Template,6,1,"div",1),oe.j41(2,"div",2),oe.DNE(3,WorkPackageRelationsCreateComponent_div_3_Template,10,7,"div",3),oe.k0s()()),2&e&&(oe.R7$(),oe.Y8G("ngIf",!t.showRelationsCreateForm),oe.R7$(2),oe.Y8G("ngIf",t.showRelationsCreateForm))},dependencies:[De.Sq,De.bT,Ve.xH,Ve.y7,Ve.wz,Ve.BC,Ve.vS,$e.i,Be.B,Le.u],encapsulation:2})}}var He=n(15842),ze=n(63077),Qe=n(85247),Ke=n(90941),Je=n(34522),Ze=n(25073);class OpUnlinkTableAction extends Je.K8{constructor(e,t,n,i,o,r){super(e,t),this.injector=e,this.workPackage=t,this.identifier=n,this.title=i,this.applicable=o,this.onClick=r}static factoryFor(e,t,n,i=(()=>!0)){return(o,r)=>new OpUnlinkTableAction(o,r,e,t,i,n)}buildElement(){if(!this.applicable(this.workPackage))return null;const e=document.createElement("a");return e.title=this.title,e.href="#",e.classList.add(Je.D2,"wp-table-action--unlink"),e.dataset.workPackageId=this.workPackage.id,e.appendChild((0,Ze.N)("icon","icon-close")),jQuery(e).click((e=>{e.preventDefault(),this.onClick(this.workPackage)})),e}}var et=n(27871),tt=n(20045);const nt=["embeddedTable"];class WorkPackageRelationQueryBase extends J.p{constructor(e){super(),this.queryUrlParamsHelper=e,this.hidden=!1}refreshTable(){this.embeddedTable?.isInitialized&&this.embeddedTable.loadQuery(!0,!1)}handleQueryLoaded(e){if(!(this.query instanceof tt.X))return;const t=this.projectValuesCount(this.query),n=this.projectValuesCount(e);null!==t&&null===n&&(this.hidden=!0),t&&n&&t>0&&0===n&&(this.hidden=!0)}projectValuesCount(e){const t=e.filters.find((e=>"project"===e.id));return t?t.values.length:null}buildQueryProps(){return this.query instanceof tt.X?this.queryUrlParamsHelper.buildV3GetQueryFromQueryResource(this.query,{valid_subset:!0},{id:this.workPackage.id}):this.query}static{this.ɵfac=function WorkPackageRelationQueryBase_Factory(e){return new(e||WorkPackageRelationQueryBase)(oe.rXU(Qe.j))}}static{this.ɵdir=oe.FsC({type:WorkPackageRelationQueryBase,viewQuery:function WorkPackageRelationQueryBase_Query(e,t){if(1&e&&oe.GBs(nt,5),2&e){let e;oe.mGM(e=oe.lsd())&&(t.embeddedTable=e.first)}},features:[oe.Vt3]})}}var it=n(31433),ot=n(12313);const wp_children_query_component_c0=e=>({actionsColumnEnabled:!0,hierarchyToggleEnabled:!1,inlineCreateEnabled:!0,compactTableStyle:!0,columnMenuEnabled:!1,contextMenuEnabled:!1,projectIdentifier:e,projectContext:!1});function WorkPackageChildrenQueryComponent_ng_container_0_div_1_Template(e,t){if(1&e&&(oe.j41(0,"div",4)(1,"div",5),oe.nrm(2,"h3",6),oe.k0s()()),2&e){const e=oe.XpG(2);oe.R7$(2),oe.Y8G("textContent",e.group.name)}}function WorkPackageChildrenQueryComponent_ng_container_0_Template(e,t){if(1&e){const e=oe.RV6();oe.qex(0),oe.DNE(1,WorkPackageChildrenQueryComponent_ng_container_0_div_1_Template,3,1,"div",2),oe.j41(2,"wp-embedded-table",3,0),oe.bIt("onQueryLoaded",(function WorkPackageChildrenQueryComponent_ng_container_0_Template_wp_embedded_table_onQueryLoaded_2_listener(t){oe.eBV(e);const n=oe.XpG();return oe.Njj(n.handleQueryLoaded(t))})),oe.k0s(),oe.bVm()}if(2&e){const e=oe.XpG();oe.R7$(),oe.Y8G("ngIf",e.group),oe.R7$(),oe.Y8G("initialLoadingIndicator",!1)("queryProps",e.queryProps)("tableActions",e.tableActions)("configuration",oe.eq3(5,wp_children_query_component_c0,e.idFromLink(e.workPackage.project.href)))}}class WorkPackageChildrenQueryComponent extends WorkPackageRelationQueryBase{constructor(e,t,n,i,o,r,s,a){super(r),this.wpRelationsHierarchyService=e,this.PathHelper=t,this.wpInlineCreate=n,this.halEvents=i,this.apiV3Service=o,this.queryUrlParamsHelper=r,this.I18n=s,this.wpRelations=a,this.addExistingChildEnabled=!1,this.idFromLink=ot.A,this.tableActions=[OpUnlinkTableAction.factoryFor("remove-child-action",this.I18n.t("js.relation_buttons.remove_child"),(e=>{this.embeddedTable&&(this.embeddedTable.loadingIndicator=this.wpRelationsHierarchyService.removeChild(e))}),(e=>!!e.changeParent))]}ngOnInit(){this.wpInlineCreate.referenceTarget=this.workPackage,this.queryProps=this.buildQueryProps(),this.wpInlineCreate.newInlineWorkPackageCreated.pipe(this.untilDestroyed()).subscribe((e=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:e,relationType:"child"})})),this.apiV3Service.work_packages.id(this.workPackage).observe().pipe((0,g.p)((()=>!!this.embeddedTable?.isInitialized)),this.untilDestroyed()).subscribe((()=>{this.wpRelations.updateCounter(this.workPackage),this.refreshTable()}))}static{this.ɵfac=function WorkPackageChildrenQueryComponent_Factory(e){return new(e||WorkPackageChildrenQueryComponent)(oe.rXU(Ke.F),oe.rXU(Ge.B),oe.rXU(et.O),oe.rXU(W.o),oe.rXU(X.n),oe.rXU(Qe.j),oe.rXU(d.W),oe.rXU(q.U))}}static{this.ɵcmp=oe.VBU({type:WorkPackageChildrenQueryComponent,selectors:[["wp-children-query"]],inputs:{workPackage:"workPackage",query:"query",group:"group",addExistingChildEnabled:"addExistingChildEnabled"},features:[oe.Jv_([{provide:et.O,useClass:it.V}]),oe.Vt3],decls:1,vars:1,consts:[["embeddedTable",""],[4,"ngIf"],["class","attributes-group--header",4,"ngIf"],[3,"onQueryLoaded","initialLoadingIndicator","queryProps","tableActions","configuration"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"]],template:function WorkPackageChildrenQueryComponent_Template(e,t){1&e&&oe.DNE(0,WorkPackageChildrenQueryComponent_ng_container_0_Template,4,7,"ng-container",1),2&e&&oe.Y8G("ngIf",!t.hidden)},dependencies:[De.bT,a.Z],encapsulation:2})}}function WorkPackageRelationsHierarchyComponent_div_0_Template(e,t){if(1&e&&(oe.j41(0,"div",1)(1,"div",2)(2,"div",3),oe.nrm(3,"h3",4),oe.k0s()(),oe.nrm(4,"wp-children-query",5),oe.k0s()),2&e){const e=oe.XpG();oe.R7$(3),oe.Y8G("textContent",e.text.childrenHeadline),oe.R7$(),oe.Y8G("workPackage",e.workPackage)("addExistingChildEnabled",!0)("query",e.childrenQueryProps)}}class WorkPackageRelationsHierarchyComponent extends J.p{constructor(e,t,n,i,o){super(),this.apiV3Service=e,this.PathHelper=t,this.I18n=n,this.schemaCache=i,this.cdRef=o,this.showEditForm=!1,this.canHaveChildren=!1,this.text={parentHeadline:this.I18n.t("js.relations_hierarchy.parent_headline"),childrenHeadline:this.I18n.t("js.relations_hierarchy.children_headline")}}ngOnInit(){this.workPackagePath=this.PathHelper.workPackagePath(this.workPackage.id),this.canModifyHierarchy=!!this.workPackage.changeParent,this.canAddRelation=!!this.workPackage.addRelation,this.childrenQueryProps={filters:JSON.stringify([{parent:{operator:"=",values:[this.workPackage.id]}}]),"columns[]":["id","type","subject","status"],showHierarchies:!1},this.apiV3Service.work_packages.id(this.workPackage).requireAndStream().pipe((0,He.E)(this.schemaCache.requireAndStream(this.schemaCache.getSchemaHref(this.workPackage))),this.untilDestroyed()).subscribe((([e,t])=>{const n=this.schemaCache.of(e).isMilestone;this.workPackage=e,this.canHaveChildren=!n,this.cdRef.detectChanges()}))}static{this.ɵfac=function WorkPackageRelationsHierarchyComponent_Factory(e){return new(e||WorkPackageRelationsHierarchyComponent)(oe.rXU(X.n),oe.rXU(Ge.B),oe.rXU(d.W),oe.rXU(j.D),oe.rXU(oe.gRc))}}static{this.ɵcmp=oe.VBU({type:WorkPackageRelationsHierarchyComponent,selectors:[["wp-relations-hierarchy"]],inputs:{workPackage:"workPackage",relationType:"relationType"},features:[oe.nM4([ze.Y]),oe.Vt3],decls:1,vars:1,consts:[["class","wp-relations-hierarchy-section wp-relations--children",4,"ngIf"],[1,"wp-relations-hierarchy-section","wp-relations--children"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],[3,"workPackage","addExistingChildEnabled","query"]],template:function WorkPackageRelationsHierarchyComponent_Template(e,t){1&e&&oe.DNE(0,WorkPackageRelationsHierarchyComponent_div_0_Template,5,4,"div",0),2&e&&oe.Y8G("ngIf",t.canHaveChildren)},dependencies:[De.bT,WorkPackageChildrenQueryComponent],encapsulation:2})}}var rt=n(49977),st=n(81805),at=n(47637),lt=n(28549),ct=n(79880),pt=n(58997),dt=n(59716),ut=n(91297),ht=n(2867),mt=n(73677),gt=n(81213),_t=n(201),ft=(n(6758),n(48377));class WorkPackageWatcherEntryComponent{constructor(e,t){this.I18n=e,this.panelCtrl=t}ngOnInit(){this.text={remove:this.I18n.t("js.label_remove_watcher",{name:this.watcher.name})}}remove(){this.panelCtrl.removeWatcher(this.watcher)}static{this.ɵfac=function WorkPackageWatcherEntryComponent_Factory(e){return new(e||WorkPackageWatcherEntryComponent)(oe.rXU(d.W),oe.rXU(_t.P))}}static{this.ɵcmp=oe.VBU({type:WorkPackageWatcherEntryComponent,selectors:[["op-wp-watcher-entry"]],inputs:{watcher:"watcher"},decls:5,vars:3,consts:[["opFocusWithin","button",1,"op-wp-watcher","form--selected-value--container"],[1,"op-wp-watcher--form","form--selected-value"],["size","mini","data-test-selector","op-wp-watcher-name",3,"principal","link"],["type","button",1,"spot-link","form--selected-value--remover",3,"click","title"],["icon-classes","icon-remove"]],template:function WorkPackageWatcherEntryComponent_Template(e,t){1&e&&(oe.j41(0,"div",0)(1,"span",1),oe.nrm(2,"op-principal",2),oe.k0s(),oe.j41(3,"button",3),oe.bIt("click",(function WorkPackageWatcherEntryComponent_Template_button_click_3_listener(){return t.remove()})),oe.nrm(4,"op-icon",4),oe.k0s()()),2&e&&(oe.R7$(2),oe.Y8G("principal",t.watcher)("link",!0),oe.R7$(),oe.Y8G("title",t.text.remove))},dependencies:[$e.i,ft.f,We.x],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-wp-watcher--form[_ngcontent-%COMP%]{display:inline-block;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}"],changeDetection:0})}}var bt=n(51472),kt=n(81859),vt=n(17573),Ct=n(23084),yt=n(55332),wt=n(75930);class WorkPackageTableSumsRowController{constructor(e,t,n,i,o,r,s,a){this.injector=e,this.elementRef=t,this.querySpace=n,this.states=i,this.schemaCache=o,this.wpTableColumns=r,this.wpTableSums=s,this.I18n=a,this.isHidden=!0,this.text={sum:a.t("js.label_total_sum")}}ngAfterViewInit(){this.element=this.elementRef.nativeElement,(0,Q.z)([this.wpTableColumns.live$(),this.wpTableSums.live$(),this.querySpace.results.values$()]).pipe((0,m.Q)(this.querySpace.stopAllSubscriptions)).subscribe((([e,t,n])=>{this.isHidden=!t,t&&n.sumsSchema?this.schemaCache.ensureLoaded(n.sumsSchema.href).then((t=>{this.refresh(e,n,t)})):this.clear()}))}clear(){this.element.innerHTML=""}refresh(e,t,n){this.clear(),this.render(e,t,n)}render(e,t,n){this.groupSumsBuilder=new wt.x(this.injector,this.workPackageTable),this.groupSumsBuilder.text=this.text,this.groupSumsBuilder.renderColumns(t.totalSums,this.element)}static{this.ɵfac=function WorkPackageTableSumsRowController_Factory(e){return new(e||WorkPackageTableSumsRowController)(oe.rXU(oe.zZn),oe.rXU(oe.aKT),oe.rXU(U.i),oe.rXU(v.D),oe.rXU(j.D),oe.rXU(pe.T),oe.rXU(yt.X),oe.rXU(d.W))}}static{this.ɵdir=oe.FsC({type:WorkPackageTableSumsRowController,selectors:[["","wpTableSumsRow",""]],hostVars:2,hostBindings:function WorkPackageTableSumsRowController_HostBindings(e,t){2&e&&oe.AVh("-hidden",t.isHidden)},inputs:{workPackageTable:[oe.Mj6.None,"wpTableSumsRow-table","workPackageTable"]}})}}var Tt=n(99320),St=n(74627),jt=n(8878),Pt=n(70130),It=n(40710),xt=n(33813),Rt=n(17456),Ft=n(27509),Mt=n(87962);const wp_relation_query_component_c0=e=>({actionsColumnEnabled:!0,hierarchyToggleEnabled:!1,inlineCreateEnabled:!0,compactTableStyle:!0,columnMenuEnabled:!1,contextMenuEnabled:!1,projectIdentifier:e,projectContext:!1});function WorkPackageRelationQueryComponent_ng_container_0_div_1_Template(e,t){if(1&e&&(oe.j41(0,"div",4)(1,"div",5),oe.nrm(2,"h3",6),oe.k0s()()),2&e){const e=oe.XpG(2);oe.R7$(2),oe.Y8G("textContent",e.group.name)}}function WorkPackageRelationQueryComponent_ng_container_0_Template(e,t){if(1&e){const e=oe.RV6();oe.qex(0),oe.DNE(1,WorkPackageRelationQueryComponent_ng_container_0_div_1_Template,3,1,"div",2),oe.j41(2,"wp-embedded-table",3,0),oe.bIt("onQueryLoaded",(function WorkPackageRelationQueryComponent_ng_container_0_Template_wp_embedded_table_onQueryLoaded_2_listener(t){oe.eBV(e);const n=oe.XpG();return oe.Njj(n.handleQueryLoaded(t))})),oe.k0s(),oe.bVm()}if(2&e){const e=oe.XpG();oe.R7$(),oe.Y8G("ngIf",e.group),oe.R7$(),oe.Y8G("initialLoadingIndicator",!1)("queryProps",e.queryProps)("tableActions",e.tableActions)("configuration",oe.eq3(5,wp_relation_query_component_c0,e.idFromLink(e.workPackage.project.href)))}}class WorkPackageRelationQueryComponent extends WorkPackageRelationQueryBase{constructor(e,t,n,i,o,r,s){super(o),this.PathHelper=e,this.wpInlineCreate=t,this.wpRelations=n,this.halEvents=i,this.queryUrlParamsHelper=o,this.notificationService=r,this.I18n=s,this.tableActions=[OpUnlinkTableAction.factoryFor("remove-relation-action",this.I18n.t("js.relation_buttons.remove"),(e=>{this.embeddedTable&&(this.embeddedTable.loadingIndicator=this.wpRelations.require(e.id).then((()=>this.wpInlineCreate.remove(this.workPackage,e))).then((()=>this.refreshTable())).catch((e=>this.notificationService.handleRawError(e,this.workPackage))))}),(e=>!!e.changeParent))],this.idFromLink=ot.A}ngOnInit(){const e=this.getRelationTypeFromQuery();this.wpInlineCreate.referenceTarget=this.workPackage,this.wpInlineCreate.relationType=e,this.queryProps=this.buildQueryProps(),this.wpInlineCreate.newInlineWorkPackageCreated.pipe(this.untilDestroyed()).subscribe((e=>this.addRelation(e))),this.wpRelations.observe(this.workPackage.id).pipe((0,g.p)((e=>!_.isEmpty(e))),this.untilDestroyed()).subscribe((()=>this.refreshTable()))}addRelation(e){this.wpInlineCreate.add(this.workPackage,e).then((()=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:e,relationType:this.getRelationTypeFromQuery()})})).catch((e=>this.notificationService.handleRawError(e,this.workPackage)))}getRelationTypeFromQuery(){return this.group.relationType}static{this.ɵfac=function WorkPackageRelationQueryComponent_Factory(e){return new(e||WorkPackageRelationQueryComponent)(oe.rXU(Ge.B),oe.rXU(et.O),oe.rXU(q.U),oe.rXU(W.o),oe.rXU(Qe.j),oe.rXU(N.U),oe.rXU(d.W))}}static{this.ɵcmp=oe.VBU({type:WorkPackageRelationQueryComponent,selectors:[["wp-relation-query"]],inputs:{workPackage:"workPackage",query:"query",group:"group"},features:[oe.Jv_([{provide:et.O,useClass:Mt.i}]),oe.Vt3],decls:1,vars:1,consts:[["embeddedTable",""],[4,"ngIf"],["class","attributes-group--header",4,"ngIf"],[3,"onQueryLoaded","initialLoadingIndicator","queryProps","tableActions","configuration"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"]],template:function WorkPackageRelationQueryComponent_Template(e,t){1&e&&oe.DNE(0,WorkPackageRelationQueryComponent_ng_container_0_Template,4,7,"ng-container",1),2&e&&oe.Y8G("ngIf",!t.hidden)},dependencies:[De.bT,a.Z],encapsulation:2})}}var Ot=n(27973),Dt=n(60129),Gt=n(76321),Et=n(49741),At=n(81067),Vt=n(39739),$t=n(5749);class WorkPackagesTableConfigMenuComponent{constructor(e,t,n,i){this.I18n=e,this.injector=t,this.opModalService=n,this.opContextMenu=i,this.text={configureTable:this.I18n.t("js.toolbar.settings.configure_view")}}openTableConfigurationModal(){this.opContextMenu.close(),this.opModalService.show(he.E,this.injector)}static{this.ɵfac=function WorkPackagesTableConfigMenuComponent_Factory(e){return new(e||WorkPackagesTableConfigMenuComponent)(oe.rXU(d.W),oe.rXU(oe.zZn),oe.rXU(ce.a),oe.rXU(le.V))}}static{this.ɵcmp=oe.VBU({type:WorkPackagesTableConfigMenuComponent,selectors:[["wp-table-config-menu"]],decls:2,vars:1,consts:[["type","button",1,"spot-link","wp-table--columns-selection",3,"click","title"],["icon-classes","icon-button icon-small icon-no-color icon-settings"]],template:function WorkPackagesTableConfigMenuComponent_Template(e,t){1&e&&(oe.j41(0,"button",0),oe.bIt("click",(function WorkPackagesTableConfigMenuComponent_Template_button_click_0_listener(){return t.openTableConfigurationModal()})),oe.nrm(1,"op-icon",1),oe.k0s()),2&e&&oe.Y8G("title",t.text.configureTable)},dependencies:[$e.i],encapsulation:2})}}var Bt=n(74573);class WorkPackageViewDropdownMenuDirective extends ae.i{constructor(e,t,n,i,o){super(e,t),this.elementRef=e,this.opContextMenu=t,this.I18n=n,this.wpDisplayRepresentationService=i,this.wpTableTimeline=o,this.isOpen=!1}open(e){this.isOpen=!this.isOpen,this.isOpen?(this.buildItems(),this.opContextMenu.show(this,e)):this.opContextMenu.close()}get locals(){return{items:this.items,contextMenuId:"wp-view-context-menu"}}buildItems(){this.items=[],this.wpDisplayRepresentationService.current!==Bt.ze&&this.items.push({linkText:this.I18n.t("js.views.card"),title:this.I18n.t("js.button_show_cards"),icon:"icon-view-card",onClick:e=>(this.isOpen=!1,this.wpDisplayRepresentationService.setDisplayRepresentation(Bt.ze),this.wpTableTimeline.isVisible&&this.wpTableTimeline.toggle(),!0)}),(this.wpTableTimeline.isVisible||this.wpDisplayRepresentationService.current===Bt.ze)&&this.items.push({linkText:this.I18n.t("js.views.list"),title:this.I18n.t("js.button_show_table"),icon:"icon-view-list",onClick:e=>(this.isOpen=!1,this.wpDisplayRepresentationService.setDisplayRepresentation(Bt.hS),this.wpTableTimeline.isVisible&&this.wpTableTimeline.toggle(),!0)}),this.wpTableTimeline.isVisible&&this.wpDisplayRepresentationService.current!==Bt.ze||this.items.push({linkText:this.I18n.t("js.views.timeline"),title:this.I18n.t("js.button_show_gantt"),icon:"icon-view-timeline",onClick:e=>(this.isOpen=!1,this.wpTableTimeline.isVisible||this.wpTableTimeline.toggle(),this.wpDisplayRepresentationService.setDisplayRepresentation(Bt.hS),!0)})}static{this.ɵfac=function WorkPackageViewDropdownMenuDirective_Factory(e){return new(e||WorkPackageViewDropdownMenuDirective)(oe.rXU(oe.aKT),oe.rXU(le.V),oe.rXU(d.W),oe.rXU(Bt.dd),oe.rXU(S.X))}}static{this.ɵdir=oe.FsC({type:WorkPackageViewDropdownMenuDirective,selectors:[["","wpViewDropdown",""]],features:[oe.Vt3]})}}var Wt=n(11856),Nt=n(82711),Ut=n(30189),Yt=n(38424),Xt=n(19015),qt=n(99569),Lt=n(96941),Ht=n(15615),zt=n(92103),Qt=n(56912),Kt=n(42572),Jt=n(4213),Zt=n(25827),en=n(99014),tn=n(17136),nn=n(40221);class OpWpTabsModule{static{this.ɵfac=function OpWpTabsModule_Factory(e){return new(e||OpWpTabsModule)}}static{this.ɵmod=oe.$C({type:OpWpTabsModule})}static{this.ɵinj=oe.G2t({imports:[De.MD,Ae.UIRouterModule,Zt.oW,en.q,tn.o]})}}("undefined"==typeof ngJitMode||ngJitMode)&&oe.Obh(OpWpTabsModule,{declarations:[nn.$,Jt.B],imports:[De.MD,Ae.UIRouterModule,Zt.oW,en.q,tn.o],exports:[nn.$,Jt.B]});var on=n(23604),rn=n(37330),sn=n(38640),an=n(74311),ln=n(7467),cn=n(27160),pn=n(46337),dn=n(92564),un=n(22079),hn=n(25377),mn=n(45085),gn=n(8871),_n=n(61933),fn=n(96825),bn=n(2214),kn=n(68899),vn=n(49341),Cn=n(95246),yn=n(11385);const wp_attribute_group_component_c0=e=>({"wp-attribute-group--attribute_span-all":e}),wp_attribute_group_component_c1=e=>({"wp-edit-formattable-field":e});function WorkPackageFormAttributeGroupComponent_div_0_ng_template_1_div_0_span_3_Template(e,t){1&e&&(oe.j41(0,"span",9),oe.EFF(1," *"),oe.k0s())}function WorkPackageFormAttributeGroupComponent_div_0_ng_template_1_div_0_Template(e,t){if(1&e&&(oe.j41(0,"div",5)(1,"wp-replacement-label",6),oe.EFF(2),oe.DNE(3,WorkPackageFormAttributeGroupComponent_div_0_ng_template_1_div_0_span_3_Template,2,0,"span",7),oe.k0s(),oe.nrm(4,"attribute-help-text",8),oe.k0s()),2&e){const e=oe.XpG(2).$implicit;oe.R7$(),oe.Y8G("fieldName",e.name),oe.R7$(),oe.SpI(" ",e.label," "),oe.R7$(),oe.Y8G("ngIf",e.field.required&&e.field.writable),oe.R7$(),oe.Y8G("attribute",e.name)("attributeScope","WorkPackage")}}function WorkPackageFormAttributeGroupComponent_div_0_ng_template_1_div_1_Template(e,t){if(1&e&&(oe.j41(0,"div",10),oe.nrm(1,"op-editable-attribute-field",11),oe.k0s()),2&e){const e=oe.XpG(2).$implicit,t=oe.XpG();oe.R7$(),oe.Y8G("ngClass",oe.eq3(4,wp_attribute_group_component_c1,e.field.isFormattable))("resource",t.workPackage)("isDropTarget",e.field.isFormattable)("fieldName",e.field.name)}}function WorkPackageFormAttributeGroupComponent_div_0_ng_template_1_Template(e,t){if(1&e&&oe.DNE(0,WorkPackageFormAttributeGroupComponent_div_0_ng_template_1_div_0_Template,5,5,"div",3)(1,WorkPackageFormAttributeGroupComponent_div_0_ng_template_1_div_1_Template,2,6,"div",4),2&e){const e=oe.XpG().$implicit;oe.Y8G("ngIf",!e.multiple&&e.field),oe.R7$(),oe.Y8G("ngIf",!e.multiple&&e.field)}}function WorkPackageFormAttributeGroupComponent_div_0_Template(e,t){if(1&e&&(oe.j41(0,"div",1),oe.DNE(1,WorkPackageFormAttributeGroupComponent_div_0_ng_template_1_Template,2,2,"ng-template",2),oe.k0s()),2&e){const e=t.$implicit,n=oe.XpG();oe.Y8G("ngClass",oe.eq3(2,wp_attribute_group_component_c0,e.spanAll)),oe.R7$(),oe.Y8G("ngIf",!n.shouldHideField(e))}}class WorkPackageFormAttributeGroupComponent extends J.p{constructor(e,t,n){super(),this.I18n=e,this.wpEditForm=t,this.injector=n,this.className=!0,this.parentClassName=!0}trackByName(e,t){return t.name}shouldHideField(e){const t=e.field||e.fields[0];return this.wpEditForm.editMode&&!t.writable}static{this.ɵfac=function WorkPackageFormAttributeGroupComponent_Factory(e){return new(e||WorkPackageFormAttributeGroupComponent)(oe.rXU(d.W),oe.rXU(Ne.G),oe.rXU(oe.zZn))}}static{this.ɵcmp=oe.VBU({type:WorkPackageFormAttributeGroupComponent,selectors:[["wp-attribute-group"]],hostVars:4,hostBindings:function WorkPackageFormAttributeGroupComponent_HostBindings(e,t){2&e&&oe.AVh("wp-attribute-group",t.className)("attributes-group--attributes",t.parentClassName)},inputs:{workPackage:"workPackage",group:"group"},features:[oe.Vt3],decls:1,vars:2,consts:[["class","wp-attribute-group--attribute attributes-key-value",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"wp-attribute-group--attribute","attributes-key-value",3,"ngClass"],[3,"ngIf"],["class","wp-attribute-group--attribute-key attributes-key-value--key",4,"ngIf"],["class","wp-attribute-group--attribute-value-container attributes-key-value--value-container",4,"ngIf"],[1,"wp-attribute-group--attribute-key","attributes-key-value--key"],[3,"fieldName"],["class","required",4,"ngIf"],[3,"attribute","attributeScope"],[1,"required"],[1,"wp-attribute-group--attribute-value-container","attributes-key-value--value-container"],[3,"ngClass","resource","isDropTarget","fieldName"]],template:function WorkPackageFormAttributeGroupComponent_Template(e,t){1&e&&oe.DNE(0,WorkPackageFormAttributeGroupComponent_div_0_Template,2,4,"div",0),2&e&&oe.Y8G("ngForOf",t.group.members)("ngForTrackBy",t.trackByName)},dependencies:[De.YU,De.Sq,De.bT,yn.e,Ue.c,je.h],styles:[".cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.wp-attribute-group{display:flex;flex-direction:row;flex-wrap:wrap;margin:0 -1.5rem;width:calc(100% + 3rem)}.wp-attribute-group--attribute{flex-basis:400px;flex-grow:1;flex-shrink:1;min-width:calc(50% - 3rem);max-width:calc(100% - 3rem);margin:0 1.5rem}.wp-attribute-group--attribute_span-all{flex-basis:calc(100% - 3rem);flex-shrink:0;flex-wrap:wrap}.wp-attribute-group--attribute-key{flex-basis:140px}@media screen and (min-width: 767px){.wp-attribute-group--attribute-key{flex-basis:140px}}.wp-attribute-group--attribute-value-container{flex-basis:260px}.wp-attribute-group--attribute_span-all .wp-attribute-group--attribute-value-container{flex-shrink:0;flex-basis:708px;max-width:100%}\n"],encapsulation:2})}}var wn=n(28601),Tn=n(66626),Sn=n(43570),jn=n(43837),Pn=n(42793),In=n(59933),xn=n(38429);class TimeEntryChangeset extends xn.b{setValue(e,t){super.setValue(e,t),"workPackage"===e&&this.updateForm()}buildPayloadFromChanges(){const e=super.buildPayloadFromChanges();return delete e._links.project,e}}var Rn=n(66913),Fn=n(37313),Mn=n(45709),On=n(45425),Dn=n(33157),Gn=n(43727),En=n(62417),An=n(6211),Vn=n(43161),$n=n(63045),Bn=n(28445),Wn=n(7957),Nn=n(29417),Un=n(35245),Yn=n(58197),Xn=n(21212),qn=n(55355),Ln=n(17547),Hn=n(97366),zn=n(76579),Qn=n(12918),Kn=n(39176),Jn=n(60990),Zn=n(40080),ei=n(544),ti=n(16604),ni=n(54972),ii=n(51152),oi=n(66984),ri=n(12920),si=n(88124),ai=n(4286);class OpenprojectStoragesModule{static{this.ɵfac=function OpenprojectStoragesModule_Factory(e){return new(e||OpenprojectStoragesModule)}}static{this.ɵmod=oe.$C({type:OpenprojectStoragesModule})}static{this.ɵinj=oe.G2t({providers:[ti.O,zn.O,si.X],imports:[De.MD,tn.o,Qn.m,i.d]})}}("undefined"==typeof ngJitMode||ngJitMode)&&oe.Obh(OpenprojectStoragesModule,{declarations:[Kn.P,ai.q,Jn.h,ei.T,ii.o,oi.S,Zn.Z,ni.c,ti.O,ri._],imports:[De.MD,tn.o,Qn.m,i.d],exports:[Kn.P]});var li=n(77159),ci=n(26109),pi=n(36023),di=n(66042),ui=n(29039),hi=n(81711),mi=n(87297),gi=n(76745),_i=n(62223),fi=n(92897),bi=n(91812),ki=n(7749),vi=n(17709),Ci=n(88467),yi=n(921),wi=n(20287),Ti=n(10752),Si=n(94530),ji=n(77938),Pi=n(79727);class OpenprojectWorkPackagesModule{static{this.bootstrapAttributeGroupsCalled=!1}constructor(e){this.injector=e,OpenprojectWorkPackagesModule.bootstrapAttributeGroups(e)}static bootstrapAttributeGroups(e){if(this.bootstrapAttributeGroupsCalled)return;this.bootstrapAttributeGroupsCalled=!0;const t=e.get(s.R);t.register("attributeGroupComponent",((e,t)=>"WorkPackageFormAttributeGroup"===e.type?WorkPackageFormAttributeGroupComponent:(0,Hn.A)(t)||"WorkPackageFormChildrenQueryGroup"!==e.type?(0,Hn.A)(t)||"WorkPackageFormRelationQueryGroup"!==e.type?null:WorkPackageRelationQueryComponent:WorkPackageChildrenQueryComponent)),t.register("workPackageAttachmentListComponent",(()=>Rn.r)),t.register("halResourceChangesetClass",(e=>{switch(e._type){case"WorkPackage":return Ut.C;case"TimeEntry":return TimeEntryChangeset;default:return null}}))}static{this.ɵfac=function OpenprojectWorkPackagesModule_Factory(e){return new(e||OpenprojectWorkPackagesModule)(oe.KVO(oe.zZn))}}static{this.ɵmod=oe.$C({type:OpenprojectWorkPackagesModule})}static{this.ɵinj=oe.G2t({providers:[N.U,St.H,Pt.R,j.D,Et.r,It.x,q.U,Rt.Z,q.U,xt.Q,Ln.H,W.o,li.T,pi.u,ci.m,di.z,ki.D],imports:[i.d,_i.MQ,o.X,Ct.b,xe._,Vt.r,Wt.K,r.p,Kt.E,bi.d,OpWpTabsModule,on.T,en.q,OpenprojectStoragesModule]})}}("undefined"==typeof ngJitMode||ngJitMode)&&oe.Obh(OpenprojectWorkPackagesModule,{declarations:[Ot.F,qt.U,Lt.L,Xt.W,Ht.K,kt.N,bt.O,pn.j,Nt.l,In.K,Cn.r,a.Z,l.T,Tt.X,jt.H,re.Q,Ft.a,wn.U,Z.c,WorkPackagesTableConfigMenuComponent,c.x,bn.H,WorkPackageTableSumsRowController,lt.a,Fn.l,Dn.Q,Yn.X,Vn.P,Gn.I,$n.y,Mn.$,Nn.V,En.s,An.B,Bn.A,On.a,Un.c,st.f,se.S,OpColumnsContextMenu,_e.p,fe.K,be.J,ke.T,WorkPackageViewDropdownMenuDirective,Qt._,we.G,WorkPackageTimelineHeaderController,WorkPackageTableTimelineRelations,WorkPackageTableTimelineStaticElements,WorkPackageTableTimelineGrid,WorkPackageTimelineTableController,rt.X,Wn.t,Te.D,kn.k,Se.n,je.h,mn.F,WorkPackageChildrenQueryComponent,WorkPackageRelationQueryComponent,WorkPackageFormAttributeGroupComponent,zt.X,fi.k,Pe.H,gn._,fn.A,Tn.P,jn.c,vn.U,Sn.d,Ie.l,_t.P,WorkPackageWatcherEntryComponent,Me.r,Oe.g,WorkPackageRelationsGroupComponent,WorkPackageRelationRowComponent,WorkPackageRelationsCreateComponent,WorkPackageRelationsHierarchyComponent,Le.u,dn.C,qn.R,at.I,Dt.w,Ti.m,hn.Q,Pn.B,_n.d,vi.l,yi.u,un.J,Gt.y,he.E,ct.V,pt.R,dt.S,ut.t,ht.o,mt.c,gt.G,ln.C,sn.J,an.g,cn.g,wi.Z,Ci.A,Re.o,Fe.p,$t.C,vt.F,rn.G,At.A,Yt.V,Xn.d,ui.f,hi.Q,mi.I,gi.C],imports:[i.d,_i.MQ,o.X,Ct.b,xe._,Vt.r,Wt.K,r.p,Kt.E,bi.d,OpWpTabsModule,on.T,en.q,OpenprojectStoragesModule,ze.Y],exports:[Z.c,c.x,a.Z,l.T,At.A,Yt.V,st.f,Un.c,Fn.l,bn.H,hn.Q,dn.C,Pn.B,un.J,wn.U,he.E,dt.S,rt.X,Se.n,pn.j,Nt.l,kn.k,Dt.w,zt.X]}),oe.wjB(Z.c,[De.YU,De.Sq,De.bT,$e.i,Si.t,re.Q,WorkPackagesTableConfigMenuComponent,bn.H,WorkPackageTableSumsRowController,OpColumnsContextMenu,WorkPackageTimelineTableController],[]),oe.wjB(WorkPackageTimelineTableController,[WorkPackageTimelineHeaderController,WorkPackageTableTimelineRelations,WorkPackageTableTimelineStaticElements,WorkPackageTableTimelineGrid],[]),oe.wjB(_t.P,[De.YU,De.Sq,De.bT,Ve.qT,Ve.cb,Ve.cV,ji.P,WorkPackageWatcherEntryComponent],[]),oe.wjB(At.A,[De.YU,De.Sq,De.bT,Pi.h,Zt.Bf,Zt.dE,Yt.V],[])},99569:(e,t,n)=>{"use strict";n.d(t,{U:()=>PartitionedQuerySpacePageComponent});var i=n(24398),o=n(48707),r=n(89391),s=n(64334),a=n(40358),l=n(49349),c=n(68118),p=n(1758),d=n(61816),u=n(51133),h=n(8790),m=n(35245),g=n(32147),_=n(83093),f=n(72688),b=n(56196),k=n(68559),v=n(88955),C=n(60316),y=n(24557),w=n(25827),T=n(92103);function PartitionedQuerySpacePageComponent_op_back_button_3_Template(e,t){if(1&e&&k.nrm(0,"op-back-button",11),2&e){const e=k.XpG();k.Y8G("customBackMethod",e.backButtonCallback)}}function PartitionedQuerySpacePageComponent_ul_5_ng_container_1_li_1_Template(e,t){if(1&e&&(k.j41(0,"li",15),k.nrm(1,"ndc-dynamic",16),k.k0s()),2&e){const e=k.XpG().$implicit,t=k.XpG(2);k.Y8G("ngClass",e.containerClasses),k.R7$(),k.Y8G("ndcDynamicComponent",e.component)("ndcDynamicInputs",e.inputs)("ndcDynamicInjector",t.injector)("ndcDynamicOutputs",e.outputs)}}function PartitionedQuerySpacePageComponent_ul_5_ng_container_1_Template(e,t){if(1&e&&(k.qex(0),k.DNE(1,PartitionedQuerySpacePageComponent_ul_5_ng_container_1_li_1_Template,2,5,"li",14),k.bVm()),2&e){const e=t.$implicit;k.R7$(),k.Y8G("ngIf",!e.show||e.show())}}function PartitionedQuerySpacePageComponent_ul_5_Template(e,t){if(1&e&&(k.j41(0,"ul",12),k.DNE(1,PartitionedQuerySpacePageComponent_ul_5_ng_container_1_Template,2,1,"ng-container",13),k.k0s()),2&e){const e=k.XpG();k.R7$(),k.Y8G("ngForOf",e.toolbarButtonComponents)}}function PartitionedQuerySpacePageComponent_ndc_dynamic_7_Template(e,t){if(1&e&&k.nrm(0,"ndc-dynamic",17),2&e){const e=k.XpG();k.Y8G("ndcDynamicComponent",e.filterContainerDefinition.component)("ndcDynamicInputs",e.filterContainerDefinition.inputs)("ndcDynamicOutputs",e.filterContainerDefinition.outputs)("ndcDynamicInjector",e.injector)}}class PartitionedQuerySpacePageComponent extends r.${constructor(){super(...arguments),this.text={jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.pagination"),text_jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.label_pagination")},this.showToolbar=!1,this.toolbarButtonComponents=[],this.filterAllowed=!0,this.currentPartition="-split",this.filterContainerDefinition={component:m.c},this.inviteModal=h.X}ngOnInit(){super.ngOnInit(),this.showToolbarSaveButton=!!this.$state.params.query_props,this.setPartition(this.$state.current),this.removeTransitionSubscription=this.$transitions.onSuccess({},(e=>{const t=e.params("to"),n=e.to();this.showToolbarSaveButton=!!t.query_props,this.setPartition(n);const i=this.querySpace.query.value;i&&this.shouldUpdateHtmlTitle()&&this.titleService.setFirstPart(this.queryTitle(i)),this.cdRef.detectChanges()})),this.loadInitialQuery(),this.setupInformationLoadedListener(),this.queryParamListener.observe$.pipe(this.untilDestroyed()).subscribe((()=>{this.currentQuery=void 0,this.refresh(!0,!0)})),this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe((e=>{this.updateTitle(e),this.currentQuery=e}))}setPartition(e){this.currentPartition=e.data&&e.data.partition?e.data.partition:"-split"}setupInformationLoadedListener(){this.querySpace.initialized.values$().pipe((0,s.s)(1)).subscribe((()=>{this.showToolbar=!0,this.cdRef.detectChanges()}))}ngOnDestroy(){super.ngOnDestroy(),this.removeTransitionSubscription(),this.queryParamListener.removeQueryChangeListener()}changeChangesFromTitle(e){this.currentQuery&&(0,g.A)(this.currentQuery)?this.updateTitleName(e):this.wpListService.create(this.currentQuery,e).finally((()=>{this.toolbarDisabled=!1}))}updateTitleName(e){this.toolbarDisabled=!0,this.currentQuery.name=e,this.wpListService.save(this.currentQuery).finally((()=>{this.toolbarDisabled=!1,this.cdRef.detectChanges()}))}updateTitle(e){e&&(this.selectedTitle=this.queryTitle(e),this.titleEditingEnabled=this.authorisationService.can("query","updateImmediately"),this.shouldUpdateHtmlTitle()&&this.titleService.setFirstPart(this.selectedTitle))}refresh(e=!1,t=!1){let n=this.loadQuery(t);e?(n=n.then((e=>(this.wpStatesInitialization.initialize(e,e.results),this.additionalLoadingTime().then((()=>e))))),this.loadingIndicator=n):n.then((e=>{this.wpStatesInitialization.initialize(e,e.results)}))}loadQuery(e=!1){let t;const n=this.currentQuery;if(e||!n)t=this.loadFirstPage();else{const e=this.wpListService.getPaginationInfo();t=(0,b._)(this.wpListService.loadQueryFromExisting(n,e,this.projectIdentifier))}return t}loadFirstPage(){return this.currentQuery?(0,b._)(this.wpListService.reloadQuery(this.currentQuery,this.projectIdentifier)):this.wpListService.loadCurrentQueryFromParams(this.projectIdentifier)}additionalLoadingTime(){return Promise.resolve()}set loadingIndicator(e){this.loadingIndicatorService.table.promise=e}shouldUpdateHtmlTitle(){return!0}staticQueryName(e){return this.opStaticQueries.getStaticName(e)}loadInitialQuery(){const e=!this.querySpace.initialized.hasValue();this.loadingIndicator=this.loadQuery(e)}queryTitle(e){return(0,g.A)(e)?e.name:this.staticQueryName(e)}static{this.ɵfac=(()=>{let e;return function PartitionedQuerySpacePageComponent_Factory(t){return(e||(e=k.xGo(PartitionedQuerySpacePageComponent)))(t||PartitionedQuerySpacePageComponent)}})()}static{this.ɵcmp=k.VBU({type:PartitionedQuerySpacePageComponent,selectors:[["ng-component"]],features:[k.Jv_([{provide:a.Y,useClass:l.U},c.x]),k.Vt3],decls:11,vars:8,consts:[[1,"work-packages-partitioned-query-space--container",3,"ngClass"],[1,"toolbar-container","-editable"],[1,"toolbar"],["class","op-back-button","linkClass","op-back-button_mobile-limited-width",3,"customBackMethod",4,"ngIf"],[3,"onSave","onEmptySubmit","title","inFlight","showSaveCondition","editable"],["class","toolbar-items hide-when-print",4,"ngIf"],[1,"work-packages-partitioned-query-space--filter-area"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector",4,"ngIf"],[1,"work-packages-partitioned-page--content-container"],["data-indicator-name","table","ui-view","content-left",1,"work-packages-partitioned-page--content-left","loading-indicator--location"],["ui-view","content-right",1,"work-packages-partitioned-page--content-right"],["linkClass","op-back-button_mobile-limited-width",1,"op-back-button",3,"customBackMethod"],[1,"toolbar-items","hide-when-print"],[4,"ngFor","ngForOf"],["class","toolbar-item",3,"ngClass",4,"ngIf"],[1,"toolbar-item",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicInjector","ndcDynamicOutputs"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector"]],template:function PartitionedQuerySpacePageComponent_Template(e,t){1&e&&(k.j41(0,"div",0)(1,"div",1)(2,"div",2),k.DNE(3,PartitionedQuerySpacePageComponent_op_back_button_3_Template,1,1,"op-back-button",3),k.j41(4,"editable-toolbar-title",4),k.bIt("onSave",(function PartitionedQuerySpacePageComponent_Template_editable_toolbar_title_onSave_4_listener(e){return t.changeChangesFromTitle(e)}))("onEmptySubmit",(function PartitionedQuerySpacePageComponent_Template_editable_toolbar_title_onEmptySubmit_4_listener(){return t.updateTitleName("")})),k.k0s(),k.DNE(5,PartitionedQuerySpacePageComponent_ul_5_Template,2,1,"ul",5),k.k0s()(),k.j41(6,"div",6),k.DNE(7,PartitionedQuerySpacePageComponent_ndc_dynamic_7_Template,1,4,"ndc-dynamic",7),k.k0s(),k.j41(8,"div",8),k.nrm(9,"div",9)(10,"div",10),k.k0s()()),2&e&&(k.Y8G("ngClass",t.currentPartition),k.R7$(3),k.Y8G("ngIf",t.backButtonCallback),k.R7$(),k.Y8G("title",t.selectedTitle)("inFlight",t.toolbarDisabled)("showSaveCondition",t.showToolbarSaveButton)("editable",t.titleEditingEnabled),k.R7$(),k.Y8G("ngIf",t.showToolbar),k.R7$(2),k.Y8G("ngIf",t.filterContainerDefinition))},dependencies:[v.UIView,C.YU,C.Sq,C.bT,y.JS,w.Bf,w.dE,T.X],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;display:grid;grid-template-columns:1fr;grid-template-rows:auto auto minmax(200px,1fr);margin-left:-10px;padding-left:10px;width:calc(100% + 10px)}.work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{flex-grow:1}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{overflow:auto}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   wp-resizer[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]{display:flex;overflow:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{position:relative}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{flex:1}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .title-container_editable[_ngcontent-%COMP%]{margin-left:-7px}@media only screen and (max-width: 543px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{min-width:initial;max-width:100vw;max-height:100%}}@media only screen and (max-width: 767px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto;grid-template-rows:auto auto;justify-items:start}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .op-back-button[_ngcontent-%COMP%]{grid-column:1/3;grid-row:1/2}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]{grid-column:1/2;grid-row:2/3;overflow:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-items[_ngcontent-%COMP%]{grid-column:2/3;grid-row:2/3}}"],changeDetection:0})}}(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",d.W)],PartitionedQuerySpacePageComponent.prototype,"I18n",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",o.P)],PartitionedQuerySpacePageComponent.prototype,"titleService",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",c.x)],PartitionedQuerySpacePageComponent.prototype,"queryParamListener",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",u.a)],PartitionedQuerySpacePageComponent.prototype,"opModalService",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",_.ok)],PartitionedQuerySpacePageComponent.prototype,"uiRouterGlobals",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",f.s)],PartitionedQuerySpacePageComponent.prototype,"configuration",void 0)},69728:(e,t,n)=>{"use strict";function splitViewRoute(e,t="details"){return`${e.current.data.baseRoute||""}.${t}`}n.d(t,{N:()=>splitViewRoute})},72870:(e,t,n)=>{"use strict";n.d(t,{M:()=>makeSplitViewRoutes});var i=n(51472),o=n(4213),r=n(95246);function makeSplitViewRoutes(e,t,n,s=i.O,a,l=!0,c=e){return[{name:`${c}.details`,url:"/details/{workPackageId:[0-9]+}",redirectTo:e=>{const t=e.params("to");return{state:`${c}.details.tabs`,params:{...t,tabIdentifier:"overview"}}},reloadOnSearch:!1,data:{bodyClasses:"router--work-packages-partitioned-split-view-details",menuItem:t,baseRoute:e,newRoute:`${c}.new`,partition:a?"-left-only":"-split",mobileAlternative:l?"work-packages.show":void 0},views:a?{"content-left@^.^":{component:n}}:{"content-right@^.^":{component:n}}},{name:`${c}.details.tabs`,url:"/:tabIdentifier",component:o.B,data:{baseRoute:e,menuItem:t,parent:`${c}.details`,mobileAlternative:l?"work-packages.show":void 0}},{name:`${c}.new`,url:"/create_new?{type:[0-9]+}&{parent_id:[0-9]+}",reloadOnSearch:!1,params:{defaults:{value:null}},data:{partition:"-split",allowMovingInEditMode:!0,bodyClasses:"router--work-packages-partitioned-split-view-new",baseRoute:e,parent:e,mobileAlternative:l?"work-packages.new":void 0},views:{"content-right@^.^":{component:s}}},{name:`${c}.copy`,url:"/details/{copiedFromWorkPackageId:[0-9]+}/copy",views:{"content-right@^.^":{component:r.r}},reloadOnSearch:!1,data:{baseRoute:e,parent:e,allowMovingInEditMode:!0,bodyClasses:"router--work-packages-partitioned-split-view",menuItem:t,partition:"-split",mobileAlternative:l?"work-packages.show":void 0}}]}},27973:(e,t,n)=>{"use strict";n.d(t,{F:()=>WorkPackagesBaseComponent});var i=n(76939),o=n(68559);class WorkPackageEditFormRoutingService extends i.w{blockedTransition(e){const t=e.to(),n=e.from(),i=e.params("from"),o=e.params("to");return n.name&&/\.(new|copy)$/.exec(n.name)?!(t.data&&t.data.allowMovingInEditMode):void 0===o.workPackageId||o.workPackageId!==i.workPackageId}static{this.ɵfac=(()=>{let e;return function WorkPackageEditFormRoutingService_Factory(t){return(e||(e=o.xGo(WorkPackageEditFormRoutingService)))(t||WorkPackageEditFormRoutingService)}})()}static{this.ɵprov=o.jDH({token:WorkPackageEditFormRoutingService,factory:WorkPackageEditFormRoutingService.ɵfac})}}var r=n(63077),s=n(88955);class WorkPackagesBaseComponent{static{this.ɵfac=function WorkPackagesBaseComponent_Factory(e){return new(e||WorkPackagesBaseComponent)}}static{this.ɵcmp=o.VBU({type:WorkPackagesBaseComponent,selectors:[["work-packages-base"]],features:[o.Jv_([{provide:i.w,useClass:WorkPackageEditFormRoutingService}]),o.nM4([r.Y])],decls:2,vars:0,consts:[[1,"work-packages-page--ui-view"]],template:function WorkPackagesBaseComponent_Template(e,t){1&e&&(o.j41(0,"div",0),o.nrm(1,"ui-view"),o.k0s())},dependencies:[s.UIView],encapsulation:2})}}},76321:(e,t,n)=>{"use strict";n.d(t,{y:()=>WorkPackagesFullViewComponent});var i=n(83093),o=n(72688),r=n(63894),s=n(7749),a=n(40358),l=n(39056),c=n(96613),p=n(29925),d=n(46169),u=n(49349),h=n(59452),m=n(68559),g=n(88955),_=n(60316),f=n(46765),b=n(2768),k=n(58397),v=n(34539),C=n(40221),y=n(2214),w=n(61944),T=n(49977),S=n(68899),j=n(92103),P=n(92897),I=n(25377),x=n(61933),R=n(17709),F=n(921),M=n(22079),O=n(21212);const _c0=()=>["work_package.addChild","work_package.copy"];function WorkPackagesFullViewComponent_div_0_li_10_Template(e,t){if(1&e&&(m.j41(0,"li",25),m.nrm(1,"wp-share-button",18),m.k0s()),2&e){const e=m.XpG(2);m.R7$(),m.Y8G("workPackage",e.workPackage)}}function WorkPackagesFullViewComponent_div_0_li_12_Template(e,t){if(1&e&&(m.j41(0,"li",8),m.nrm(1,"op-wp-timer-button",18),m.k0s()),2&e){const e=m.XpG(2);m.R7$(),m.Y8G("workPackage",e.workPackage)}}function WorkPackagesFullViewComponent_div_0_li_13_Template(e,t){if(1&e&&(m.j41(0,"li",25),m.nrm(1,"wp-watcher-button",26),m.k0s()),2&e){const e=m.XpG(2);m.R7$(),m.Y8G("workPackage",e.workPackage)("showText",!1)}}function WorkPackagesFullViewComponent_div_0_li_14_Template(e,t){if(1&e&&(m.j41(0,"li",25),m.nrm(1,"wp-reminder-button",18),m.k0s()),2&e){const e=m.XpG(2);m.R7$(),m.Y8G("workPackage",e.workPackage)}}function WorkPackagesFullViewComponent_div_0_li_16_Template(e,t){if(1&e&&(m.j41(0,"li",25),m.nrm(1,"op-work-package-mark-notification-button",27),m.k0s()),2&e){const e=m.XpG(2);m.R7$(),m.Y8G("workPackage",e.workPackage)}}function WorkPackagesFullViewComponent_div_0_Template(e,t){if(1&e&&(m.j41(0,"div",1)(1,"div",2)(2,"div",3),m.nrm(3,"wp-breadcrumb",4)(4,"op-back-button",5),m.j41(5,"div",6),m.nrm(6,"wp-subject"),m.k0s(),m.j41(7,"ul",7)(8,"li",8),m.nrm(9,"wp-create-button",9),m.k0s(),m.DNE(10,WorkPackagesFullViewComponent_div_0_li_10_Template,2,1,"li",10),m.nI1(11,"async"),m.DNE(12,WorkPackagesFullViewComponent_div_0_li_12_Template,2,1,"li",11)(13,WorkPackagesFullViewComponent_div_0_li_13_Template,2,2,"li",10)(14,WorkPackagesFullViewComponent_div_0_li_14_Template,2,1,"li",10),m.nI1(15,"async"),m.DNE(16,WorkPackagesFullViewComponent_div_0_li_16_Template,2,1,"li",10),m.nI1(17,"async"),m.j41(18,"li",8),m.nrm(19,"opce-zen-mode-toggle-button"),m.k0s(),m.j41(20,"li",12)(21,"button",13),m.nrm(22,"op-icon",14),m.k0s()()()()(),m.j41(23,"div",15)(24,"div",16)(25,"div",17),m.nrm(26,"wp-single-view",18),m.k0s()(),m.j41(27,"div",19)(28,"div",17),m.nrm(29,"span",20)(30,"op-wp-tabs",21)(31,"div",22),m.k0s(),m.j41(32,"div",23),m.nrm(33,"wp-resizer",24),m.k0s()()()()),2&e){const e=m.XpG();m.Y8G("resource",e.workPackage),m.R7$(3),m.Y8G("workPackage",e.workPackage),m.R7$(6),m.Y8G("allowed",m.lJ4(24,_c0))("stateName$",e.stateName$),m.R7$(),m.Y8G("ngIf",m.bMT(11,18,e.displayShareButton$)),m.R7$(2),m.Y8G("ngIf",e.displayTimerButton),m.R7$(),m.Y8G("ngIf",e.displayWatchButton),m.R7$(),m.Y8G("ngIf",m.bMT(15,20,e.displayReminderButton$)),m.R7$(2),m.Y8G("ngIf",m.bMT(17,22,e.displayNotificationsButton$)),m.R7$(5),m.Y8G("wpSingleContextMenu-workPackage",e.workPackage),m.BMQ("title",e.text.fullView.buttonMore),m.R7$(5),m.Y8G("workPackage",e.workPackage),m.R7$(3),m.Y8G("textContent",e.focusAnchorLabel),m.R7$(),m.Y8G("workPackage",e.workPackage)("view","full"),m.R7$(3),m.Y8G("elementClass","work-packages-full-view--split-right")("variableName","--full-view-split-right-width")("localStorageKey","openProject-fullViewFlexBasis")}}class WorkPackagesFullViewComponent extends d.y{constructor(e,t,n,i,o,r){super(e,i.params.workPackageId),this.injector=e,this.wpTableSelection=t,this.recentItemsService=n,this.$state=i,this.currentUserService=o,this.configurationService=r,this.displayReminderButton$=(0,h.of)(!1),this.displayShareButton$=!1,this.displayTimerButton=!1,this.displayWatchButton=!1,this.text={fullView:{buttonMore:this.i18n.t("js.button_more")}},this.stateName$=(0,h.of)("work-packages.new")}triggerImmediateUpdate(){this.storeService.reload()}ngOnInit(){this.observeWorkPackage()}init(){super.init(),this.workPackage.id&&(this.recentItemsService.add(this.workPackage.id),this.wpTableFocus.updateFocus(this.workPackage.id)),this.setWorkPackageScopeProperties(this.workPackage)}setWorkPackageScopeProperties(e){this.isWatched=Object.prototype.hasOwnProperty.call(e,"unwatch"),this.displayWatchButton=Object.prototype.hasOwnProperty.call(e,"unwatch")||Object.prototype.hasOwnProperty.call(e,"watch"),this.displayTimerButton=Object.prototype.hasOwnProperty.call(e,"logTime"),this.displayShareButton$=this.currentUserService.hasCapabilities$("work_package_shares/index",e.project.id),this.displayReminderButton$=this.currentUserService.isLoggedInAndHasCapabalities$("work_packages/read",this.workPackage.project.id),e.watchers&&(this.watchers=e.watchers.elements)}static{this.ɵfac=function WorkPackagesFullViewComponent_Factory(e){return new(e||WorkPackagesFullViewComponent)(m.rXU(m.zZn),m.rXU(p.a),m.rXU(s.D),m.rXU(i.dw),m.rXU(r.K),m.rXU(o.s))}}static{this.ɵcmp=m.VBU({type:WorkPackagesFullViewComponent,selectors:[["wp-full-view-entry"]],hostAttrs:[1,"work-packages-page--ui-view"],hostBindings:function WorkPackagesFullViewComponent_HostBindings(e,t){1&e&&m.bIt("ian-update-immediate",(function WorkPackagesFullViewComponent_ian_update_immediate_HostBindingHandler(){return t.triggerImmediateUpdate()}),!1,m.EBC)},features:[m.Jv_([c.e,l.j,{provide:a.Y,useExisting:u.U}]),m.Vt3],decls:1,vars:1,consts:[["edit-form","","class","work-packages--show-view",3,"resource",4,"ngIf"],["edit-form","",1,"work-packages--show-view",3,"resource"],[1,"toolbar-container"],["id","toolbar",1,"wp-show--header-container"],[1,"wp-show--header-container--breadcrumb",3,"workPackage"],["linkClass","work-packages-back-button op-back-button_mobile-limited-width",1,"wp-show--header-container--back-button"],[1,"subject-header","wp-show--header-container--subject"],["id","toolbar-items",1,"toolbar-items","hide-when-print","wp-show--header-container--toolbar-items"],[1,"toolbar-item","hidden-for-tablet"],[3,"allowed","stateName$"],["class","toolbar-item",4,"ngIf"],["class","toolbar-item hidden-for-tablet",4,"ngIf"],["id","action-show-more-dropdown-menu",1,"toolbar-item","action_menu_main"],["wpSingleContextMenu","",1,"button","dropdown-relative","toolbar-icon",3,"wpSingleContextMenu-workPackage"],["icon-classes","button--icon icon-show-more"],[1,"work-packages-full-view--split-container"],[1,"work-packages-full-view--split-left"],[1,"work-packages--panel-inner"],[3,"workPackage"],[1,"work-packages-full-view--split-right","work-packages-tab-view--overflow"],["tabindex","-1","opAutofocus","",1,"hidden-for-sighted",3,"textContent"],[3,"workPackage","view"],["data-notification-selector","notification-scroll-container","ui-view","",1,"tabcontent"],[1,"work-packages-full-view--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","variableName","localStorageKey"],[1,"toolbar-item"],[3,"workPackage","showText"],["data-test-selector","mark-notification-read-button",3,"workPackage"]],template:function WorkPackagesFullViewComponent_Template(e,t){1&e&&m.DNE(0,WorkPackagesFullViewComponent_div_0_Template,34,25,"div",0),2&e&&m.Y8G("ngIf",t.workPackage)},dependencies:[g.UIView,_.bT,f.i,b.B,k.y,v.G,C.$,y.H,w.T,T.X,S.k,j.X,P.k,I.Q,x.d,R.l,F.u,M.J,O.d,_.Jj],encapsulation:2,changeDetection:0})}}},19015:(e,t,n)=>{"use strict";n.d(t,{W:()=>WorkPackageListViewComponent});var i=n(64334),o=n(99763),r=n(21162),s=n(74573),a=n(40358),l=n(49349),c=n(61816),p=n(11048),d=n(36652),u=n(86866),h=n(34120),m=n(99496),g=n(83093),_=n(66309),f=n(58154),b=n(19999),k=n(68559),v=n(60316),C=n(28601),y=n(43311),w=n(64940),T=n(76745);const _c0=e=>({"-with-resizer":e});function WorkPackageListViewComponent_div_0_Template(e,t){1&e&&k.nrm(0,"div",5)}function WorkPackageListViewComponent_op_baseline_legends_2_Template(e,t){1&e&&k.nrm(0,"op-baseline-legends")}function WorkPackageListViewComponent_wp_table_3_Template(e,t){if(1&e){const e=k.RV6();k.j41(0,"wp-table",6),k.bIt("itemClicked",(function WorkPackageListViewComponent_wp_table_3_Template_wp_table_itemClicked_0_listener(t){k.eBV(e);const n=k.XpG();return k.Njj(n.handleWorkPackageClicked(t))}))("stateLinkClicked",(function WorkPackageListViewComponent_wp_table_3_Template_wp_table_stateLinkClicked_0_listener(t){k.eBV(e);const n=k.XpG();return k.Njj(n.openStateLink(t))})),k.k0s()}if(2&e){const e=k.XpG();k.Y8G("projectIdentifier",e.CurrentProject.identifier)("configuration",e.wpTableConfiguration)}}function WorkPackageListViewComponent_div_4_Template(e,t){if(1&e){const e=k.RV6();k.j41(0,"div",7)(1,"wp-grid",8),k.bIt("itemClicked",(function WorkPackageListViewComponent_div_4_Template_wp_grid_itemClicked_1_listener(t){k.eBV(e);const n=k.XpG();return k.Njj(n.handleWorkPackageCardClicked(t))}))("stateLinkClicked",(function WorkPackageListViewComponent_div_4_Template_wp_grid_stateLinkClicked_1_listener(t){k.eBV(e);const n=k.XpG();return k.Njj(n.openStateLink(t))})),k.k0s()()}if(2&e){const e=k.XpG();k.Y8G("ngClass",k.eq3(3,_c0,e.showResizerInCardView())),k.R7$(),k.Y8G("configuration",e.wpTableConfiguration)("showResizer",e.showResizerInCardView())}}function WorkPackageListViewComponent_div_5_Template(e,t){1&e&&(k.j41(0,"div",9),k.nrm(1,"wp-table-pagination"),k.k0s())}class WorkPackageListViewComponent extends m.p{constructor(e,t,n,i,o,r,s,a,l,c,p,d,u){super(),this.I18n=e,this.injector=t,this.$state=n,this.keepTab=i,this.querySpace=o,this.wpViewFilters=r,this.deviceService=s,this.CurrentProject=a,this.wpDisplayRepresentation=l,this.cdRef=c,this.elementRef=p,this.ngZone=d,this.wpTableBaseline=u,this.text={jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.pagination"),text_jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.label_pagination"),button_settings:this.I18n.t("js.button_settings")},this.showTableView=!0,this.tableInformationLoaded=!1,this.noResults=!1,this.showResultOverlay$=this.wpViewFilters.incomplete$,this.wpTableConfiguration={dragAndDropEnabled:!0}}ngOnInit(){this.setupInformationLoadedListener();(0,b.z)([this.querySpace.query.values$(),this.wpTableBaseline.live$()]).pipe(this.untilDestroyed()).subscribe((([e])=>{this.updateViewRepresentation(e),this.baselineEnabled=this.wpTableBaseline.isActive(),this.noResults=0===e.results.total,this.cdRef.detectChanges()})),this.ngZone.runOutsideAngular((()=>{setTimeout((()=>{const e=this.elementRef.nativeElement.querySelector(".wp-table--row.-checked"),t=this.elementRef.nativeElement.querySelector('[data-test-selector="op-wp-single-card"].-checked');e&&e.previousSibling&&e.previousSibling.scrollIntoView({block:"start"}),t&&t.scrollIntoView({block:"start"})}),0)}))}setupInformationLoadedListener(){this.querySpace.initialized.values$().pipe((0,i.s)(1)).subscribe((()=>{this.tableInformationLoaded=!0,this.cdRef.detectChanges()}))}showResizerInCardView(){return!1}updateViewRepresentation(e){this.showTableView=!(this.deviceService.isMobile||this.wpDisplayRepresentation.valueFromQuery(e)===s.ze)}handleWorkPackageClicked(e){e.double&&this.openInFullView(e.workPackageId)}openStateLink(e){const t={workPackageId:e.workPackageId,focus:!0};"split"===e.requestedState?this.keepTab.goCurrentDetailsState(t):this.keepTab.goCurrentShowState(t)}handleWorkPackageCardClicked(e){this.deviceService.isMobile?this.openInFullView(e.workPackageId):this.handleWorkPackageClicked(e)}openInFullView(e){this.$state.go("work-packages.show",{workPackageId:e})}static{this.ɵfac=function WorkPackageListViewComponent_Factory(e){return new(e||WorkPackageListViewComponent)(k.rXU(c.W),k.rXU(k.zZn),k.rXU(g.dw),k.rXU(_.S),k.rXU(p.i),k.rXU(h.N),k.rXU(d.g),k.rXU(u.c),k.rXU(s.dd),k.rXU(k.gRc),k.rXU(k.aKT),k.rXU(k.SKi),k.rXU(f.b1))}}static{this.ɵcmp=k.VBU({type:WorkPackageListViewComponent,selectors:[["wp-list-view"]],hostAttrs:[1,"op-wp-list-view","work-packages-split-view--tabletimeline-side"],features:[k.Jv_([{provide:a.Y,useClass:l.U},r.W,o.p]),k.Vt3],decls:6,vars:7,consts:[["class","op-wp-list-view--result-overlay",4,"ngIf"],[4,"ngIf"],["class","work-packages-split-view--tabletimeline-content",3,"projectIdentifier","configuration","itemClicked","stateLinkClicked",4,"ngIf"],["class","op-wp-list-view--card-view-container",3,"ngClass",4,"ngIf"],["class","work-packages-split-view--tabletimeline-footer hide-when-print",4,"ngIf"],[1,"op-wp-list-view--result-overlay"],[1,"work-packages-split-view--tabletimeline-content",3,"itemClicked","stateLinkClicked","projectIdentifier","configuration"],[1,"op-wp-list-view--card-view-container",3,"ngClass"],["resizerClass","work-packages-partitioned-page--content-right","resizerStorageKey","openProject-splitViewFlexBasis",3,"itemClicked","stateLinkClicked","configuration","showResizer"],[1,"work-packages-split-view--tabletimeline-footer","hide-when-print"]],template:function WorkPackageListViewComponent_Template(e,t){1&e&&(k.DNE(0,WorkPackageListViewComponent_div_0_Template,1,0,"div",0),k.nI1(1,"async"),k.DNE(2,WorkPackageListViewComponent_op_baseline_legends_2_Template,1,0,"op-baseline-legends",1)(3,WorkPackageListViewComponent_wp_table_3_Template,1,2,"wp-table",2)(4,WorkPackageListViewComponent_div_4_Template,2,5,"div",3)(5,WorkPackageListViewComponent_div_5_Template,2,0,"div",4)),2&e&&(k.Y8G("ngIf",k.bMT(1,5,t.showResultOverlay$)&&t.showTableView),k.R7$(2),k.Y8G("ngIf",t.baselineEnabled),k.R7$(),k.Y8G("ngIf",t.tableInformationLoaded&&t.showTableView),k.R7$(),k.Y8G("ngIf",!t.showTableView),k.R7$(),k.Y8G("ngIf",t.tableInformationLoaded))},dependencies:[v.YU,v.bT,C.U,y.c,w.x,T.C,v.Jj],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-wp-list-view--result-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:900;background-color:#fff;opacity:.5}.op-wp-list-view--card-view-container[_ngcontent-%COMP%]{width:100%;overflow:auto;padding-bottom:5px;scrollbar-color:transparent transparent;scrollbar-width:thin}.op-wp-list-view--card-view-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.op-wp-list-view--card-view-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.op-wp-list-view--card-view-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.op-wp-list-view--card-view-container[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.op-wp-list-view--card-view-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}@media screen and (min-width: 679px){.op-wp-list-view--card-view-container.-with-resizer[_ngcontent-%COMP%]{padding-left:10px}}@media screen and (max-width: 543px){.op-wp-list-view--card-view-container[_ngcontent-%COMP%]{min-width:calc(100vw + 10px)}}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]{display:flex;flex:1 1 100%;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}@media screen and (min-width: 679px){.work-packages-split-view--tabletimeline-container.-with-resizer[_ngcontent-%COMP%]{padding-left:10px}}@media screen and (max-width: 543px){.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]{min-width:calc(100vw + 10px)}}"],changeDetection:0})}}},10752:(e,t,n)=>{"use strict";n.d(t,{m:()=>WorkPackageSplitViewEntryComponent});var i=n(37749),o=n(68559),r=n(63077),s=n(60129);class WorkPackageSplitViewEntryComponent{constructor(e){this.elementRef=e,(0,i.w)(this)}static{this.ɵfac=function WorkPackageSplitViewEntryComponent_Factory(e){return new(e||WorkPackageSplitViewEntryComponent)(o.rXU(o.aKT))}}static{this.ɵcmp=o.VBU({type:WorkPackageSplitViewEntryComponent,selectors:[["ng-component"]],inputs:{workPackageId:"workPackageId",activeTab:"activeTab",resizerClass:"resizerClass"},features:[o.nM4([r.Y])],decls:1,vars:4,consts:[[3,"workPackageId","activeTab","showTabs","resizerClass"]],template:function WorkPackageSplitViewEntryComponent_Template(e,t){1&e&&o.nrm(0,"op-wp-split-view",0),2&e&&o.Y8G("workPackageId",t.workPackageId)("activeTab",t.activeTab)("showTabs",!1)("resizerClass",t.resizerClass)},dependencies:[s.w],encapsulation:2,changeDetection:0})}}},60129:(e,t,n)=>{"use strict";n.d(t,{w:()=>WorkPackageSplitViewComponent});var i=n(83093),o=n(79),r=n(13432),s=n(72097),a=n(66309),l=n(29925),c=n(46169),p=n(40358),d=n(49349),u=n(30327),h=n(96613),m=n(39056),g=n(7749),_=n(98522),f=n(33924),b=n(68559),k=n(88955),v=n(60316),C=n(2768),y=n(25827),w=n(34539),T=n(40221),S=n(2214),j=n(92103),P=n(25377),I=n(42793),x=n(22079);const _c0=e=>({workPackage:e});function WorkPackageSplitViewComponent_div_0_op_wp_tabs_1_Template(e,t){if(1&e&&b.nrm(0,"op-wp-tabs",7),2&e){const e=b.XpG(2);b.Y8G("workPackage",e.workPackage)("view","split")}}function WorkPackageSplitViewComponent_div_0_div_2_op_back_button_6_Template(e,t){if(1&e&&b.nrm(0,"op-back-button",18),2&e){const e=b.XpG(3);b.Y8G("customBackMethod",e.backToList.bind(e))}}function WorkPackageSplitViewComponent_div_0_div_2_div_8_Template(e,t){1&e&&b.nrm(0,"div",19)}function WorkPackageSplitViewComponent_div_0_div_2_div_9_Template(e,t){if(1&e&&(b.j41(0,"div",20),b.nrm(1,"ndc-dynamic",21),b.k0s()),2&e){const e=b.XpG(3);b.R7$(),b.Y8G("ndcDynamicComponent",e.activeTabComponent)("ndcDynamicInputs",b.eq3(2,_c0,e.workPackage))}}function WorkPackageSplitViewComponent_div_0_div_2_Template(e,t){if(1&e&&(b.j41(0,"div",8),b.nrm(1,"span",9),b.j41(2,"edit-form",10)(3,"div",11)(4,"div",12),b.nrm(5,"wp-breadcrumb",13),b.DNE(6,WorkPackageSplitViewComponent_div_0_div_2_op_back_button_6_Template,1,1,"op-back-button",14),b.nrm(7,"wp-subject",15),b.k0s()(),b.DNE(8,WorkPackageSplitViewComponent_div_0_div_2_div_8_Template,1,0,"div",16)(9,WorkPackageSplitViewComponent_div_0_div_2_div_9_Template,2,4,"div",17),b.k0s()()),2&e){const e=b.XpG(2);b.AVh("work-packages--details-content_no-tabs",!e.showTabs),b.R7$(),b.Y8G("opAutofocus",e.shouldFocus)("textContent",e.focusAnchorLabel),b.R7$(),b.Y8G("resource",e.workPackage),b.R7$(3),b.Y8G("workPackage",e.workPackage),b.R7$(),b.Y8G("ngIf",e.showBackButton()),b.R7$(),b.Y8G("workPackage",e.workPackage),b.R7$(),b.Y8G("ngIf",e.showTabs),b.R7$(),b.Y8G("ngIf",!e.showTabs&&e.activeTab)}}function WorkPackageSplitViewComponent_div_0_div_3_Template(e,t){if(1&e&&(b.j41(0,"div",22),b.nrm(1,"wp-details-toolbar",23),b.nI1(2,"async"),b.k0s()),2&e){const e=b.XpG(2);b.R7$(),b.Y8G("workPackage",e.workPackage)("displayNotificationsButton",b.bMT(2,2,e.displayNotificationsButton$))}}function WorkPackageSplitViewComponent_div_0_Template(e,t){if(1&e&&(b.j41(0,"div",1),b.DNE(1,WorkPackageSplitViewComponent_div_0_op_wp_tabs_1_Template,1,2,"op-wp-tabs",2)(2,WorkPackageSplitViewComponent_div_0_div_2_Template,10,10,"div",3)(3,WorkPackageSplitViewComponent_div_0_div_3_Template,3,4,"div",4),b.j41(4,"div",5),b.nrm(5,"wp-resizer",6),b.k0s()()),2&e){const e=b.XpG();b.R7$(),b.Y8G("ngIf",e.showTabs),b.R7$(),b.Y8G("ngIf",e.workPackage),b.R7$(),b.Y8G("ngIf",e.workPackage),b.R7$(2),b.Y8G("elementClass",e.resizerClass)("localStorageKey","openProject-splitViewFlexBasis")}}class WorkPackageSplitViewComponent extends c.y{constructor(e,t,n,i,o,r,s,a,l,c,p){super(e,a.params.workPackageId),this.injector=e,this.states=t,this.firstRoute=n,this.keepTab=i,this.wpTableSelection=o,this.wpTableFocus=r,this.recentItemsService=s,this.$state=a,this.urlParams=l,this.backRouting=c,this.wpTabs=p,this.hasState=!!this.$state.current,this.baseRoute=this.$state.current?.data?.baseRoute,this.showTabs=!0,this.resizerClass="work-packages-partitioned-page--content-right"}triggerImmediateUpdate(){this.storeService.reload()}ngOnInit(){this.observeWorkPackage();const e=this.$state.params.workPackageId||this.workPackageId;if(this.wpTableFocus.focusedWorkPackage)this.wpTableFocus.updateFocus(e,!1);else{const t=this.firstRoute.name===`${this.baseRoute}.details.overview`,n=this.firstRoute.params&&e===this.firstRoute.params.workPackageI;this.wpTableFocus.updateFocus(e,t&&n)}this.wpTableSelection.isEmpty&&this.wpTableSelection.setRowState(e,!0),this.wpTableFocus.whenChanged().pipe(this.untilDestroyed()).subscribe((t=>{!(e.toString()===t.toString())&&this.$state.includes(`${this.baseRoute}.details`)&&this.$state.go(this.$state.current.name,{workPackageId:t,focus:!1})})),this.recentItemsService.add(e)}get shouldFocus(){return!0===this.$state.params.focus}get activeTabComponent(){return this.wpTabs.tabs.find((e=>e.id===this.activeTab))?.component}showBackButton(){return this.baseRoute?.includes("bim")}backToList(){this.backRouting.goToBaseState()}handleLoadingError(e){const t=this.notificationService.retrieveErrorMessage(e);this.$state.go(this.baseRoute,{flash_message:{type:"error",message:t}})}static{this.ɵfac=function WorkPackageSplitViewComponent_Factory(e){return new(e||WorkPackageSplitViewComponent)(b.rXU(b.zZn),b.rXU(r.D),b.rXU(s.H),b.rXU(a.S),b.rXU(l.a),b.rXU(o.c),b.rXU(g.D),b.rXU(i.dw),b.rXU(_.Z),b.rXU(u.v),b.rXU(f.L))}}static{this.ɵcmp=b.VBU({type:WorkPackageSplitViewComponent,selectors:[["op-wp-split-view"]],hostBindings:function WorkPackageSplitViewComponent_HostBindings(e,t){1&e&&b.bIt("ian-update-immediate",(function WorkPackageSplitViewComponent_ian_update_immediate_HostBindingHandler(){return t.triggerImmediateUpdate()}),!1,b.EBC)},inputs:{workPackageId:"workPackageId",showTabs:"showTabs",activeTab:"activeTab",resizerClass:"resizerClass"},features:[b.Jv_([h.e,m.j,{provide:p.Y,useClass:d.U}]),b.Vt3],decls:1,vars:1,consts:[["class","work-packages--details loading-indicator--location","data-indicator-name","wpDetails",4,"ngIf"],["data-indicator-name","wpDetails",1,"work-packages--details","loading-indicator--location"],[3,"workPackage","view",4,"ngIf"],["class","work-packages--details-content work-packages-tab-view--overflow",3,"work-packages--details-content_no-tabs",4,"ngIf"],["class","work-packages--details-toolbar-container",4,"ngIf"],[1,"work-packages--details--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"],[3,"workPackage","view"],[1,"work-packages--details-content","work-packages-tab-view--overflow"],["tabindex","-1",1,"hidden-for-sighted",3,"opAutofocus","textContent"],[1,"work-packages--details-form",3,"resource"],[1,"work-packages--details-header"],[1,"work-packages--details-header-left"],[1,"work-packages--breadcrumb",3,"workPackage"],["linkClass","work-packages-back-button",3,"customBackMethod",4,"ngIf"],[1,"subject-header",3,"workPackage"],["class","work-package-details-tab","data-notification-selector","notification-scroll-container","ui-view","",4,"ngIf"],["class","work-package-details-tab","data-notification-selector","notification-scroll-container",4,"ngIf"],["linkClass","work-packages-back-button",3,"customBackMethod"],["data-notification-selector","notification-scroll-container","ui-view","",1,"work-package-details-tab"],["data-notification-selector","notification-scroll-container",1,"work-package-details-tab"],[3,"ndcDynamicComponent","ndcDynamicInputs"],[1,"work-packages--details-toolbar-container"],[3,"workPackage","displayNotificationsButton"]],template:function WorkPackageSplitViewComponent_Template(e,t){1&e&&b.DNE(0,WorkPackageSplitViewComponent_div_0_Template,6,5,"div",0),2&e&&b.Y8G("ngIf",t.workPackage)},dependencies:[k.UIView,v.bT,C.B,y.Bf,y.dE,w.G,T.$,S.H,j.X,P.Q,I.B,x.J,v.Jj],encapsulation:2,changeDetection:0})}}},37339:(e,t,n)=>{"use strict";n.d(t,{C:()=>WorkPackageViewHandlerRegistry,Q:()=>i});const i=new(n(68559).nKC)("CardEventHandler");class WorkPackageViewHandlerRegistry{constructor(e){this.injector=e}attachTo(e){this.eventHandlers.map((t=>{const n=t(e);return n.eventScope(e).on(n.EVENT,n.SELECTOR,(t=>{n.handleEvent(e,t)})),n}))}}},96613:(e,t,n)=>{"use strict";n.d(t,{e:()=>_});var i=n(24398),o=n(57678);let r=class WpSingleViewStore extends o.il{constructor(){super({notifications:{filters:[]}})}};r=(0,i.Cg)([(0,o.g7)({name:"wp-single-view"}),(0,i.Sn)("design:paramtypes",[])],r);var s=n(51567),a=n(36647),l=n(70271),c=n(64334),p=n(21567),d=n(17270),u=n(94564),h=n(86748),m=n(63894),g=n(68559);let _=class WpSingleViewService{get params(){return{filters:this.query.getValue().notifications.filters}}constructor(e,t,n){this.actions$=e,this.currentUser$=t,this.resourceService=n,this.id="WorkPackage Activity Store",this.store=new r,this.query=new o.XK(this.store),this.selectNotifications$=this.query.select((e=>e.notifications.filters)).pipe((0,s.p)((e=>e.length>0)),(0,a.n)((e=>this.resourceService.collection({filters:e})))),this.selectNotificationsCount$=this.selectNotifications$.pipe((0,l.T)((e=>e.length))),this.nonDateAlertNotificationsCount$=this.selectNotifications$.pipe((0,l.T)((e=>e.filter((e=>"dateAlert"!==e.reason)))),(0,l.T)((e=>e.length))),this.hasNotifications$=this.selectNotificationsCount$.pipe((0,l.T)((e=>e>0)))}setFilters(e){const t=[["readIAN","=",!1],["resourceId","=",[e]],["resourceType","=",["WorkPackage"]]];this.store.update((({notifications:e})=>({notifications:{...e,filters:t}}))),this.reload()}markAllAsRead(){this.resourceService.collection({filters:this.store.getValue().notifications.filters}).pipe((0,c.s)(1)).subscribe((e=>{this.actions$.dispatch((0,d.Q1)({origin:this.id,notifications:e.map((e=>e.id))}))}))}reload(){this.currentUser$.isLoggedIn$.pipe((0,c.s)(1),(0,s.p)((e=>e)),(0,a.n)((()=>this.resourceService.fetchCollection(this.params)))).subscribe()}reloadOnNotificationRead(){this.reload()}reloadOnCenterUpdate(){this.reload()}static{this.ɵfac=function WpSingleViewService_Factory(e){return new(e||WpSingleViewService)(g.KVO(u.d),g.KVO(m.K),g.KVO(p.u))}}static{this.ɵprov=g.jDH({token:WpSingleViewService,factory:WpSingleViewService.ɵfac})}};(0,i.Cg)([(0,h.xP)(d.jo),(0,i.Sn)("design:type",Function),(0,i.Sn)("design:paramtypes",[]),(0,i.Sn)("design:returntype",void 0)],_.prototype,"reloadOnNotificationRead",null),(0,i.Cg)([(0,h.xP)(d.NB),(0,i.Sn)("design:type",Function),(0,i.Sn)("design:paramtypes",[]),(0,i.Sn)("design:returntype",void 0)],_.prototype,"reloadOnCenterUpdate",null),_=(0,i.Cg)([h.qm,(0,i.Sn)("design:paramtypes",[u.d,m.K,p.u])],_)},44770:(e,t,n)=>{"use strict";n.d(t,{e:()=>WorkPackageViewAdditionalElementsService});var i=n(11048),o=n(21861),r=n(49349),s=n(44674),a=n(14593),l=n(36178),c=n(94450),p=n(88352),d=n(89282),u=n(70271),h=n(56196),m=n(68559);class WorkPackageViewAdditionalElementsService{constructor(e,t,n,i,o,r,s,a){this.querySpace=e,this.wpTableHierarchies=t,this.wpTableColumns=n,this.notificationService=i,this.halResourceService=o,this.apiV3Service=r,this.schemaCache=s,this.wpRelations=a}initialize(e,t){const n=t.elements,i=n.map((e=>e.id));Promise.all([this.requireInvolvedRelations(i),this.requireHierarchyElements(n),this.requireWorkPackageShares(i),this.requireSumsSchema(t)]).then((e=>{this.loadAdditional(_.flatten(e))}))}loadAdditional(e){this.apiV3Service.work_packages.requireAll(e).then((()=>{this.querySpace.additionalRequiredWorkPackages.putValue(null,"All required work packages are loaded")})).catch((e=>{this.querySpace.additionalRequiredWorkPackages.putValue(null,"Failure loading required work packages"),this.notificationService.handleRawError(e)}))}requireInvolvedRelations(e){return this.wpTableColumns.hasRelationColumns()?this.wpRelations.requireAll(e).then((()=>{const t=this.getInvolvedWorkPackages(e.map((e=>this.wpRelations.state(e).value)));return _.flatten(t)})):Promise.resolve([])}requireHierarchyElements(e){if(!this.wpTableHierarchies.isEnabled)return Promise.resolve([]);const t=e.map((e=>e.id.toString())),n=_.flatten(e.map((e=>e.ancestorIds))).filter((e=>!t.includes(e)));return Promise.resolve(n)}getInvolvedWorkPackages(e){const t=[];return _.each(e,(e=>{_.each(e,(e=>{t.push(e.ids.from,e.ids.to)}))})),t}requireSumsSchema(e){return e.sumsSchema?this.schemaCache.ensureLoaded(e.sumsSchema.href).then((()=>[])):Promise.resolve([])}requireWorkPackageShares(e){if(!this.wpTableColumns.hasShareColumn())return Promise.resolve([]);if(0===e.length)return Promise.resolve([]);const t=(new d.hG).add("entityType","=",["WorkPackage"]).add("entityId","=",e),n=this.apiV3Service.shares.filtered(t,{pageSize:"-1"}).getPaginatedResults().pipe((0,u.T)((e=>{const t=e;return _.uniq(t.map((e=>e.entity.id))).forEach((e=>{this.querySpace.workPackageSharesCache.get(e).putValue(t.filter((t=>t.entity.id===e)))})),[]})));return(0,h._)(n)}static{this.ɵfac=function WorkPackageViewAdditionalElementsService_Factory(e){return new(e||WorkPackageViewAdditionalElementsService)(m.KVO(i.i),m.KVO(c.j),m.KVO(p.T),m.KVO(r.U),m.KVO(l.t),m.KVO(a.n),m.KVO(s.D),m.KVO(o.U))}}static{this.ɵprov=m.jDH({token:WorkPackageViewAdditionalElementsService,factory:WorkPackageViewAdditionalElementsService.ɵfac})}}},10548:(e,t,n)=>{"use strict";n.d(t,{O:()=>WorkPackageQueryStateService,d:()=>WorkPackageViewBaseService});var i=n(11048),o=n(47418),r=n(64334),s=n(87378),a=n(70271),l=n(63617),c=n(68559);class WorkPackageViewBaseService{constructor(e){this.querySpace=e,this.updatesState=(0,o.hF)(),this.pristineState=(0,o.hF)()}initialize(e,t,n){const i=this.valueFromQuery(e,t);this.pristineState.putValue(i)}update(e){this.updatesState.putValue(e)}clear(e){this.pristineState.clear(e),this.updatesState.clear(e)}live$(){return(0,l.h)(this.pristineState.values$(),this.updatesState.values$())}pristine$(){return this.pristineState.values$()}updates$(){return this.updatesState.values$()}changes$(){return this.updatesState.changes$()}onReady(){return this.pristineState.values$().pipe((0,r.s)(1),(0,s.u)(null)).toPromise()}get lastUpdatedState(){const e=(0,o.kg)(this.pristineState,this.updatesState);return(0,o.OC)(e,(e=>e.pipe((0,a.T)((([e,t])=>void 0===t?e:t)))))}set current(e){e?this.updatesState.putValue(e):this.updatesState.clear()}get current(){return this.lastUpdatedState.value}static{this.ɵfac=function WorkPackageViewBaseService_Factory(e){return new(e||WorkPackageViewBaseService)(c.KVO(i.i))}}static{this.ɵprov=c.jDH({token:WorkPackageViewBaseService,factory:WorkPackageViewBaseService.ɵfac})}}class WorkPackageQueryStateService extends WorkPackageViewBaseService{static{this.ɵfac=(()=>{let e;return function WorkPackageQueryStateService_Factory(t){return(e||(e=c.xGo(WorkPackageQueryStateService)))(t||WorkPackageQueryStateService)}})()}static{this.ɵprov=c.jDH({token:WorkPackageQueryStateService,factory:WorkPackageQueryStateService.ɵfac})}}},58154:(e,t,n)=>{"use strict";n.d(t,{R8:()=>h,b1:()=>WorkPackageViewBaselineService});var i=n(11048),o=n(13432),r=n(73014),s=n(10548),a=n(72688),l=n(32420),c=n(74037),p=n(42032),d=n(6923),u=n(68559);const h="PT0S",m=["attachmentContent","attachmentFileName","watcher","comment"],g=["category","updatedAt","estimatedTime","remainingTime","spentTime","percentageDone","duration","budget","materialCosts","laborCosts","overallCosts"];class WorkPackageViewBaselineService extends s.O{constructor(e,t,n,i,o,r,s){super(t),this.states=e,this.querySpace=t,this.pathHelper=n,this.configurationService=i,this.timezoneService=o,this.weekdaysService=r,this.daysService=s,this.nonWorkingDays=[],this.nonWorkingDays$=this.requireNonWorkingDaysOfTwoYears()}detectIncompatibleFilters(e){return m.filter((t=>!!e.find((e=>e.id===t))))}isIncompatibleFilter(e){return m.includes(e)}isIncompatibleColumn(e){return g.includes(e)}yesterdayDate(){return d().subtract(1,"days").format("YYYY-MM-DD")}lastMonthDate(){return d().subtract(1,"month").format("YYYY-MM-DD")}lastweekDate(){return d().subtract(1,"week").format("YYYY-MM-DD")}requireNonWorkingDaysOfTwoYears(){const e=new Date,t=new Date(e);t.setFullYear(e.getFullYear()-1);const n=this.daysService.requireNonWorkingYears$(t,e);return n.subscribe((e=>{this.nonWorkingDays=e})),n}isNonWorkingDay(e){const t=d(e).format("YYYY-MM-DD");return-1!==this.nonWorkingDays.findIndex((e=>e.date===t))}lastWorkingDate(){const e=d().subtract(1,"days");for(;;){if(!this.isNonWorkingDay(e)&&!this.weekdaysService.isNonWorkingDay(e))return e.format("YYYY-MM-DD");e.subtract(1,"days")}}isActive(){return this.current.length>=1&&this.current[0]!==h}isChanged(e,t){const n=e.attributesByTimestamp||[];return this.isActive()&&n.length>=1&&Object.prototype.hasOwnProperty.call(n[0],t)}valueFromQuery(e){return e.timestamps}hasChanged(e){return!_.isEqual(e.timestamps,this.current)}applyToQuery(e){return e.timestamps=[...this.current],!0}disable(){this.update([h])}get current(){return this.lastUpdatedState.getValueOr([h])}static{this.ɵfac=function WorkPackageViewBaselineService_Factory(e){return new(e||WorkPackageViewBaselineService)(u.KVO(o.D),u.KVO(i.i),u.KVO(r.B),u.KVO(a.s),u.KVO(l.D),u.KVO(c.I),u.KVO(p.o))}}static{this.ɵprov=u.jDH({token:WorkPackageViewBaselineService,factory:WorkPackageViewBaselineService.ɵfac})}}},59769:(e,t,n)=>{"use strict";n.d(t,{V:()=>WorkPackageViewCollapsedGroupsService});var i=n(1750),o=n(11048),r=n(64334),s=n(44674),a=n(10548),l=n(68559);class WorkPackageViewCollapsedGroupsService extends a.d{get config(){return this.updatesState.getValueOr(this.getDefaultState())}get currentGroups(){return this.querySpace.groups.value}get allGroupsAreCollapsed(){return this.config.allGroupsAreCollapsed}get allGroupsAreExpanded(){return this.config.allGroupsAreExpanded}get currentGroupedBy(){return this.workPackageViewGroupByService.current}constructor(e,t,n){super(e),this.querySpace=e,this.workPackageViewGroupByService=t,this.schemaCacheService=n,this.groupTypesWithHeaderCellsWhenCollapsed=["project"],this.isMilestone=e=>this.schemaCacheService.of(e)?.isMilestone,this.wpTypesToShowInCollapsedGroupHeaders=[this.isMilestone]}getDefaultState(){return{state:this.querySpace.collapsedGroups.value||{},allGroupsChanged:!1,lastChangedGroup:null,groupedBy:this.currentGroupedBy?.id||null,...this.getAllGroupsCollapsedState(this.currentGroups,this.querySpace.collapsedGroups.value)}}toggleGroupCollapseState(e){const t=!this.config.state[e],n={...this.config.state,[e]:t},i={...this.config,state:n,lastChangedGroup:e,...this.getAllGroupsCollapsedState(this.currentGroups,n)};this.update(i)}setAllGroupsCollapseStateTo(e){const t=this.currentGroups.reduce(((t,n)=>({...t,[n.identifier]:e})),{}),n={...this.config,state:{...this.config.state,...t},lastChangedGroup:null,allGroupsAreCollapsed:e,allGroupsAreExpanded:!e,allGroupsChanged:!0};this.update(n)}getAllGroupsCollapsedState(e,t){let n=!1,i=!0;if(t&&e?.length){const o=e[0].identifier,r=t[o],s=e.every((e=>null!=t[e.identifier]&&t[e.identifier]===t[o]));n=s&&r,i=s&&!r}return{allGroupsAreCollapsed:n,allGroupsAreExpanded:i}}initialize(e,t,n){this.querySpace.tableRendered.values$().pipe((0,r.s)(1)).subscribe((()=>this.update({...this.config,allGroupsChanged:!0})))}valueFromQuery(e,t){return this.getDefaultState()}applyToQuery(e){}static{this.ɵfac=function WorkPackageViewCollapsedGroupsService_Factory(e){return new(e||WorkPackageViewCollapsedGroupsService)(l.KVO(o.i),l.KVO(i.W),l.KVO(s.D))}}static{this.ɵprov=l.jDH({token:WorkPackageViewCollapsedGroupsService,factory:WorkPackageViewCollapsedGroupsService.ɵfac})}}},88352:(e,t,n)=>{"use strict";n.d(t,{T:()=>WorkPackageViewColumnsService});var i=n(11048),o=n(13432),r=n(95685),s=n(47418),a=n(64334),l=n(87378),c=n(10267),p=n(10548),d=n(13036),u=n(68559);class WorkPackageViewColumnsService extends p.O{constructor(e,t){super(t),this.states=e,this.querySpace=t}initialize(e,t,n){super.initialize(e,t,n)}valueFromQuery(e){return[...e.columns]}hasChanged(e){return!this.isCurrentlyEqualTo(e.columns)}isCurrentlyEqualTo(e){const comparer=e=>e.map((e=>e.href));return _.isEqual(comparer(e),comparer(this.getColumns()))}applyToQuery(e){const t=this.getColumns(),n=e.columns.map((e=>e.id)),i=t.map((e=>e.id));e.columns=(0,c.Zp)(t);return!(0===_.difference(i,n).length)&&(this.hasRelationColumns()||this.hasShareColumn())}hasRelationColumns(){const e=[r.c.RELATION_OF_TYPE,r.c.RELATION_TO_TYPE];return!!_.find(this.getColumns(),(t=>e.indexOf(t._type)>=0))}hasShareColumn(){return!!_.find(this.getColumns(),(e=>e.id===d.N8.id))}getColumns(){return[...this.current]}index(e){return _.findIndex(this.getColumns(),(t=>t.id===e))}findById(e){return _.find(this.getColumns(),(t=>t.id===e))}previous(e){const t=this.index(e.id);return t<=0?null:this.getColumns()[t-1]}next(e){const t=this.index(e.id);return-1===t||this.isLast(e)?null:this.getColumns()[t+1]}isFirst(e){return 0===this.index(e.id)}isLast(e){return this.index(e.id)===this.columnCount-1}setColumns(e){this.isCurrentlyEqualTo(e)||this.update(e)}setColumnsById(e){const t=e.map((e=>_.find(this.all,(t=>t.id===e))));this.setColumns(_.compact(t))}moveColumn(e,t){const n=this.getColumns();t>=n.length&&(t=n.length-1),t<0&&(t=0);const i=n[e];n.splice(e,1),n.splice(t,0,i),this.setColumns(n)}shift(e,t){const n=this.index(e.id);-1!==n&&this.moveColumn(n,n+t)}addColumn(e,t){const n=this.getColumns();if(void 0===t&&(t=n.length),-1===this.index(e)){const i=_.find(this.all,(t=>t.id===e));if(!i)throw new Error("Column with provided name is not found");n.splice(t,0,i),this.setColumns(n)}}removeColumn(e){const t=this.index(e.id);if(-1!==t){const e=this.getColumns();e.splice(t,1),this.setColumns(e)}}get current(){return this.lastUpdatedState.getValueOr([])}get availableState(){return this.querySpace.available.columns}get columnCount(){return this.getColumns().length}get all(){return this.availableState.getValueOr([])}get allPropertyColumns(){return this.all.filter((e=>e._type===r.c.PROPERTY))}get unused(){return _.differenceBy(this.all,this.getColumns(),"$href")}onReady(){return(0,s.kg)(this.pristineState,this.availableState).values$().pipe((0,a.s)(1),(0,l.u)(null)).toPromise()}static{this.ɵfac=function WorkPackageViewColumnsService_Factory(e){return new(e||WorkPackageViewColumnsService)(u.KVO(o.D),u.KVO(i.i))}}static{this.ɵprov=u.jDH({token:WorkPackageViewColumnsService,factory:WorkPackageViewColumnsService.ɵfac})}}},74573:(e,t,n)=>{"use strict";n.d(t,{dd:()=>WorkPackageViewDisplayRepresentationService,hS:()=>a,ze:()=>l});var i=n(13432),o=n(11048),r=n(10548),s=n(68559);const a="list",l="card";class WorkPackageViewDisplayRepresentationService extends r.O{constructor(e,t){super(t),this.states=e,this.querySpace=t}hasChanged(e){return this.current!==e.displayRepresentation}valueFromQuery(e){return e.displayRepresentation||null}applyToQuery(e){const{current:t}=this;return e.displayRepresentation=null===t?void 0:t,!1}get current(){return this.lastUpdatedState.getValueOr(null)}get isList(){const{current:e}=this;return!e||e===a}get isCards(){return this.current===l}setDisplayRepresentation(e){this.update(e)}static{this.ɵfac=function WorkPackageViewDisplayRepresentationService_Factory(e){return new(e||WorkPackageViewDisplayRepresentationService)(s.KVO(i.D),s.KVO(o.i))}}static{this.ɵprov=s.jDH({token:WorkPackageViewDisplayRepresentationService,factory:WorkPackageViewDisplayRepresentationService.ɵfac})}}},34120:(e,t,n)=>{"use strict";n.d(t,{N:()=>WorkPackageViewFiltersService});var i=n(11048),o=n(47418),r=n(13432),s=n(87636),a=n(10267),l=n(97964),c=n(10548),p=n(56196),d=n(70271),u=n(68559);class WorkPackageViewFiltersService extends c.O{constructor(e,t){super(t),this.states=e,this.querySpace=t,this.hidden=["datesInterval","precedes","follows","relates","duplicates","duplicated","blocks","blocked","partof","includes","requires","required","search","subjectOrId","subjectOr","manualSort","typeahead"],this.incomplete=(0,o.hF)(!1)}initializeFilters(e,t){const n=(0,a.Zp)(e.filters);this.availableState.putValue(t.filtersSchemas.elements),this.pristineState.putValue(n)}get isEmpty(){const{value:e}=this.lastUpdatedState;return!e||0===e.length}get availableState(){return this.querySpace.available.filters}get incomplete$(){return this.incomplete.values$()}add(e){this.updatesState.putValue([...this.rawFilters,e])}replace(e,t){const n=this.instantiate(e),i=[...this.rawFilters];t(n);const o=this.findIndex(e);-1===o?i.push(n):i.splice(o,1,n),this.update(i)}modify(e,t){const n=this.findIndex(e);if(-1===n)return!1;const i=[...this.rawFilters];return t(i[n]),this.update(i),!0}instantiate(e){const t=e instanceof l.x?e.id:e;return _.find(this.availableSchemas,(e=>e.filter.allowedValues[0].id===t)).getFilter()}remove(...e){const mapper=e=>e instanceof s.Q?e.id:e,t=new Set(e.map(mapper));this.update(this.rawFilters.filter((e=>!t.has(mapper(e)))))}remainingVisibleFilters(e=this.current){return this.remainingFilters(e).filter((e=>-1===this.hidden.indexOf(e.id)))}get availableFilters(){return this.availableSchemas.map((e=>e.allowedFilterValue))}get availableSchemas(){return this.availableState.getValueOr([])}isComplete(e){return _.every(e,(e=>e.isCompletelyDefined()))}hasChanged(e){const comparer=e=>e.map((e=>e.$source));return!_.isEqual(comparer(e.filters),comparer(this.rawFilters))}valueFromQuery(e){}update(e){super.update(e),this.incomplete.putValue(!1)}find(e){const t=this.findIndex(e);if(-1!==t)return this.rawFilters[t]}findIndex(e){return _.findIndex(this.current,(t=>t.id===e))}applyToQuery(e){return e.filters=this.cloneFilters(),!0}get current(){return[...this.rawFilters]}cloneFilters(){return(0,a.Zp)(this.rawFilters)}get rawFilters(){return this.lastUpdatedState.value||[]}get currentlyVisibleFilters(){const e=new Set(this.hidden);return e.delete("search"),_.reject(this.current,(t=>e.has(t.id)))}replaceIfComplete(e){this.isComplete(e)?this.update(e):this.incomplete.putValue(!0)}onReady(){return(0,p._)((0,o.kg)(this.pristineState,this.availableState).values$().pipe((0,d.T)((()=>null))))}remainingFilters(e=this.rawFilters){return _.differenceBy(this.availableFilters,e,(e=>e.id))}isAvailable(e){return!!this.availableFilters.find((t=>t.id===e.id))}static{this.ɵfac=function WorkPackageViewFiltersService_Factory(e){return new(e||WorkPackageViewFiltersService)(u.KVO(r.D),u.KVO(i.i))}}static{this.ɵprov=u.jDH({token:WorkPackageViewFiltersService,factory:WorkPackageViewFiltersService.ɵfac})}}},79:(e,t,n)=>{"use strict";n.d(t,{c:()=>WorkPackageViewFocusService});var i=n(11048),o=n(70271),r=n(91817),s=n(29925),a=n(10548),l=n(68559);class WorkPackageViewFocusService extends a.d{constructor(e,t){super(e),this.querySpace=e,this.wpTableSelection=t}isFocused(e){return this.focusedWorkPackage===e}ifShouldFocus(e){const t=this.current;t&&t.focusAfterRender&&(e(t.workPackageId),t.focusAfterRender=!1,this.update(t))}get focusedWorkPackage(){const e=this.current;if(e)return e.workPackageId;const t=this.querySpace.results.value;return t&&t.elements.length>0?t.elements[0].id.toString():null}whenChanged(){return this.live$().pipe((0,o.T)((e=>e.workPackageId)),(0,r.F)())}updateFocus(e,t=!1){this.wpTableSelection.isEmpty&&this.wpTableSelection.setRowState(e,!0),this.update({workPackageId:e,focusAfterRender:t})}valueFromQuery(e,t){}static{this.ɵfac=function WorkPackageViewFocusService_Factory(e){return new(e||WorkPackageViewFocusService)(l.KVO(i.i),l.KVO(s.a))}}static{this.ɵprov=l.jDH({token:WorkPackageViewFocusService,factory:WorkPackageViewFocusService.ɵfac})}}},1750:(e,t,n)=>{"use strict";n.d(t,{W:()=>WorkPackageViewGroupByService});var i=n(13432),o=n(11048),r=n(10548),s=n(68559);class WorkPackageViewGroupByService extends r.O{constructor(e,t){super(t),this.states=e,this.querySpace=t}valueFromQuery(e){return e.groupBy||null}hasChanged(e){const comparer=e=>e?e.href:null;return!_.isEqual(comparer(e.groupBy),comparer(this.current))}applyToQuery(e){const{current:t}=this;return e.groupBy=null===t?void 0:t,!0}isGroupable(e){return!!_.find(this.available,(t=>t.id===e.id))}disable(){this.update(null)}setBy(e){const t=_.find(this.available,(t=>t.id===e.id));t&&this.update(t)}get current(){return this.lastUpdatedState.getValueOr(null)}get availableState(){return this.querySpace.available.groupBy}get isEnabled(){return!!this.current}get available(){return this.availableState.getValueOr([])}isCurrentlyGroupedBy(e){const t=this.current;return!(!t||t.id!==e.id)}static{this.ɵfac=function WorkPackageViewGroupByService_Factory(e){return new(e||WorkPackageViewGroupByService)(s.KVO(i.D),s.KVO(o.i))}}static{this.ɵprov=s.jDH({token:WorkPackageViewGroupByService,factory:WorkPackageViewGroupByService.ɵfac})}}},87454:(e,t,n)=>{"use strict";n.d(t,{a:()=>WorkPackageViewHierarchyIdentationService});var i=n(89204),o=n(94450),r=n(11048),s=n(90941),a=n(13432),l=n(74573),c=n(14593),p=n(56196),d=n(68559);class WorkPackageViewHierarchyIdentationService{constructor(e,t,n,i,o,r){this.wpViewHierarchies=e,this.wpDisplayRepresentation=t,this.states=n,this.wpRelationHierarchy=i,this.apiV3Service=o,this.querySpace=r}get applicable(){return this.wpViewHierarchies.isEnabled&&this.wpDisplayRepresentation.isList}canIndent(e){if(!e.changeParent||!this.applicable)return!1;const t=this.renderedWorkPackageIds,n=t.indexOf(e.id);if(0===n)return!1;const i=e.ancestorIds,o=i.length;if(0===o)return!0;const r=i[o-1];return t[n-1]!==r}canOutdent(e){return!(!e.changeParent||!this.applicable)&&!!e.parent}indent(e){var t=this;return(0,i.A)((function*(){if(!t.canIndent(e))return Promise.reject();const n=t.renderedWorkPackageIds,i=n.indexOf(e.id),o=n[i-1];let r=o;const s=yield(0,p._)(t.apiV3Service.work_packages.id(o).get()),a=_.difference(s.ancestorIds,e.ancestorIds);return a&&a.length>0&&(r=a[0]),t.wpRelationHierarchy.changeParent(e,r)}))()}outdent(e){if(!this.canOutdent(e))return Promise.reject();let t=null;const{ancestorIds:n}=e,i=n.length;return i>1&&(t=n[i-2]),this.wpRelationHierarchy.changeParent(e,t)}get renderedWorkPackageIds(){return this.querySpace.renderedWorkPackageIds.getValueOr([])}static{this.ɵfac=function WorkPackageViewHierarchyIdentationService_Factory(e){return new(e||WorkPackageViewHierarchyIdentationService)(d.KVO(o.j),d.KVO(l.dd),d.KVO(a.D),d.KVO(s.F),d.KVO(c.n),d.KVO(r.i))}}static{this.ɵprov=d.jDH({token:WorkPackageViewHierarchyIdentationService,factory:WorkPackageViewHierarchyIdentationService.ɵfac})}}},94450:(e,t,n)=>{"use strict";n.d(t,{j:()=>WorkPackageViewHierarchiesService});class WorkPackageViewHierarchies{constructor(e){this.isVisible=!1,this.last=null,this.collapsed={},this.isVisible=e}}var i=n(10548),o=n(68559);class WorkPackageViewHierarchiesService extends i.O{valueFromQuery(e){const t=new WorkPackageViewHierarchies(e.showHierarchies),{current:n}=this;return n&&(t.collapsed=n.collapsed),t}hasChanged(e){return e.showHierarchies!==this.isEnabled}applyToQuery(e){return e.showHierarchies=this.isEnabled,this.isEnabled}get isEnabled(){return!(!this.current||!this.current.isVisible)}setEnabled(e=!0){const t={...this.current,isVisible:e,last:null};this.update(t)}toggleState(){return this.setEnabled(!this.isEnabled),this.isEnabled}collapsed(e){return this.current.collapsed[e]}collapse(e){this.setState(e,!0)}expand(e){this.setState(e,!1)}toggle(e){this.setState(e,!this.collapsed(e))}setState(e,t){const n={...this.current,last:e};n.collapsed[e]=t,this.update(n)}get current(){const e=this.lastUpdatedState.value;return void 0===e?this.initialState:(e.collapsed||(e.collapsed={}),e)}get initialState(){return new WorkPackageViewHierarchies(!1)}static{this.ɵfac=(()=>{let e;return function WorkPackageViewHierarchiesService_Factory(t){return(e||(e=o.xGo(WorkPackageViewHierarchiesService)))(t||WorkPackageViewHierarchiesService)}})()}static{this.ɵprov=o.jDH({token:WorkPackageViewHierarchiesService,factory:WorkPackageViewHierarchiesService.ɵfac})}}},62665:(e,t,n)=>{"use strict";n.d(t,{I:()=>WorkPackageViewHighlightingService});var i=n(11048),o=n(13432),r=n(99972),s=n(10548),a=n(68559);class WorkPackageViewHighlightingService extends s.O{constructor(e,t,n){super(n),this.states=e,this.Banners=t,this.querySpace=n}initialize(e,t,n){super.initialize(e,t,n)}shouldHighlightInline(e){return!(!this.isInline||this.Banners.eeShowBanners)&&(0===this.current.selectedAttributes?.length||!!_.find(this.current.selectedAttributes,(t=>t.id===e)))}get current(){const e=this.lastUpdatedState.getValueOr({mode:"inline"});return this.filteredValue(e)}get isInline(){return"inline"===this.current.mode}get isDisabled(){return"none"===this.current.mode}update(e){super.update(this.filteredValue(e))}valueFromQuery(e){const t={mode:e.highlightingMode||"inline",selectedAttributes:e.highlightedAttributes};return this.filteredValue(t)}hasChanged(e){return e.highlightingMode!==this.current.mode||!_.isEqual(e.highlightedAttributes,this.current.selectedAttributes)}applyToQuery(e){const{current:t}=this;return e.highlightingMode=t.mode,e.highlightedAttributes=t.selectedAttributes,!1}filteredValue(e){return _.isEmpty(e.selectedAttributes)&&(e.selectedAttributes=void 0),this.Banners.conditional((()=>{e.mode="none",e.selectedAttributes=void 0})),e}static{this.ɵfac=function WorkPackageViewHighlightingService_Factory(e){return new(e||WorkPackageViewHighlightingService)(a.KVO(o.D),a.KVO(r.b),a.KVO(i.i))}}static{this.ɵprov=a.jDH({token:WorkPackageViewHighlightingService,factory:WorkPackageViewHighlightingService.ɵfac})}}},80406:(e,t,n)=>{"use strict";n.d(t,{G:()=>WorkPackageViewIncludeSubprojectsService});var i=n(13432),o=n(11048),r=n(10548),s=n(68559);class WorkPackageViewIncludeSubprojectsService extends r.O{constructor(e,t){super(t),this.states=e,this.querySpace=t}hasChanged(e){return this.current!==e.includeSubprojects}valueFromQuery(e){return e.includeSubprojects||!1}applyToQuery(e){const{current:t}=this;return e.includeSubprojects=t,!0}get current(){return this.lastUpdatedState.getValueOr(!1)}setIncludeSubprojects(e){this.update(e)}static{this.ɵfac=function WorkPackageViewIncludeSubprojectsService_Factory(e){return new(e||WorkPackageViewIncludeSubprojectsService)(s.KVO(i.D),s.KVO(o.i))}}static{this.ɵprov=s.jDH({token:WorkPackageViewIncludeSubprojectsService,factory:WorkPackageViewIncludeSubprojectsService.ɵfac})}}},51524:(e,t,n)=>{"use strict";n.d(t,{k:()=>WorkPackageViewOrderService});var i=n(89204),o=n(13432),r=n(11048),s=n(73014),a=n(32147),l=n(36819);const c=-2147483647,p=2147483647,d=0,u=16384;function livePosition(e,t,n){return void 0===e[n]?t[n]:e[n]}function positionFor(e,t,n,i){return livePosition(e,n,t[i])}function redistribute(e,t,n,i){const o=t.length;let r=n,s=i,a=Math.floor((s-r)/(o-1));if(a<1){if(s+o<=p)s+=o;else{if(!(r-o>=c))throw new Error("Elements cannot be moved further and no space is left. Too many elements");r-=o}a=Math.floor((s-r)/(o-1))}const l={...e};for(let e=0;e<o;e+=1){l[t[e]]=r+e*a}return l}function reorderedInsert(e,t,n){const i=function firstPosition(e,t,n){return livePosition(e,n,t[0]||"")||0}(e,t,n),o=function lastPosition(e,t,n){for(let i=t.length-1;i>=0;i-=1){const o=livePosition(e,n,t[i]);if(void 0!==o)return o}return 0}(e,t,n);return redistribute(e,t,i,o)}function buildInsertPosition(e,t,n,i,o){const r={};if(e.length<=1&&void 0===t[n])return{...r,[n]:d};const s=function positionSwap(e,t,n,i,o,r){if(null===o)return e;const s=positionFor(e,t,n,i),a=t[o],l=positionFor(e,t,n,o);return void 0===s||void 0===l?e:{...e,[`${r}`]:l,[`${a}`]:s}}(r,e,t,i,o,n);if(null!==o&&1===Math.abs(o-i)&&r!==s)return s;if(0===i)return function insertAsFirst(e,t,n,i,o){const r=positionFor(e,t,n,i+1);return void 0===r?{...e,[o]:d}:{...e,[o]:r-u/2}}(s,e,t,i,n);const{delta:a,predecessorPosition:c}=function buildUpPredecessorPosition(e,t,n,i){let o=d-u;const r={...e};for(let e=0;e<i;e+=1){const i=t[e],s=n[i];void 0===s?(r[i]=o+u,o=r[i]):o=s}return{predecessorPosition:o,delta:r}}(s,e,t,i);if(c>=p)return(0,l.cY)("Predecessor position is at max order, need to reorder"),reorderedInsert(a,e,t);const h=positionFor(a,e,t,i+1);if(void 0===h)return{...a,[n]:c+u/2};if(h>=p)return(0,l.cY)("Successor position is at max order, need to reorder"),reorderedInsert(a,e,t);const m=Math.floor((h-c)/2);return m<1?((0,l.cY)("Cannot insert at optimal position, no space left. Need to reorder"),reorderedInsert(a,e,t)):{...a,[n]:c+m}}function rebuildPositions(e,t){const n={},[i,o]=function minMaxPositions(e,t,n){let i=p,o=c,r=!1;for(let s=t.length-1;s>=0;s-=1){const a=livePosition(e,n,t[s]);void 0!==a&&(i=Math.min(a,i),o=Math.max(a,o),r=!0)}return r&&i!==o?[i,o]:[d,t.length*u]}(n,e,t);return redistribute(n,e,i,o)}var h=n(1257),m=n(99763),g=n(14593),f=n(10548),b=n(56196),k=n(68559);class WorkPackageViewOrderService extends f.O{constructor(e,t,n,i,o,r){super(e),this.querySpace=e,this.apiV3Service=t,this.states=n,this.causedUpdates=i,this.wpTableSortBy=o,this.pathHelper=r}initialize(e,t,n){return!(0,a.A)(e)&&this.positions.hasValue()&&this.applyToQuery(e),this.wpTableSortBy.isManualSortingMode?this.withLoadedPositions():Promise.resolve()}move(e,t,n){var o=this;return(0,i.A)((function*(){const i=e.findIndex((e=>e===t));return e.splice(i,1),e.splice(n,0,t),yield o.assignPosition(e,t,n,i),e}))()}remove(e,t){return _.remove(e,(e=>e===t)),this.update({[t]:-1}),e}add(e,t,n=-1){var o=this;return(0,i.A)((function*(){return-1===n?(e.push(t),n=e.length-1):e.splice(n,0,t),yield o.assignPosition(e,t,n),e}))()}get applicable(){return(0,a.A)(this.currentQuery)}get currentQuery(){return this.querySpace.query.value}assignPosition(e,t,n,o=null){var r=this;return(0,i.A)((function*(){const i=yield r.withLoadedPositions(),s=function buildDelta(e,t,n,i,o){return function isAscendingOrder(e,t,n){let i;for(let o=0,r=e.length;o<r;o+=1){const r=t[e[o]];if(o!==n)if(void 0!==i&&void 0!==r){if(r<i)return!1}else i=r}return!0}(e,t,i)?buildInsertPosition(e,t,n,i,o):rebuildPositions(e,t)}(e,i,t,n,o);yield r.update(s)}))()}get positions(){return this.updatesState}update(e){var t=this;return(0,i.A)((function*(){const n=t.positions.getValueOr({});if(t.positions.putValue({...n,...e}),(0,a.A)(t.currentQuery)){const n=yield t.apiV3Service.queries.id(t.currentQuery).order.update(e);t.currentQuery.updatedAt=n,t.causedUpdates.add(t.currentQuery)}t.applyToQuery(t.currentQuery),t.querySpace.query.putValue(t.currentQuery)}))()}withLoadedPositions(){if((0,a.A)(this.currentQuery)){const{value:e}=this.positions;(_.isEmpty(e)||this.positions.isValueOlderThan(6e4))&&this.positions.clear("Clearing old positions value"),this.positions.putFromPromiseIfPristine((()=>this.apiV3Service.queries.id(this.currentQuery).order.get()))}else this.positions.isPristine()&&this.positions.putValue({});return(0,b._)(this.positions.values$())}valueFromQuery(e){}orderedWorkPackages(){const e=this.querySpace.results.value.elements.map((e=>this.states.workPackages.get(e.id).getValueOr(e)));if((0,a.A)(this.currentQuery)||this.positions.isPristine())return e;const t=this.positions.value;return _.sortBy(e,(e=>{const n=t[e.id];return void 0!==n?n:p}))}applyToQuery(e){return e.orderedWorkPackages=this.positions.getValueOr({}),!1}hasChanged(e){return!1}static{this.ɵfac=function WorkPackageViewOrderService_Factory(e){return new(e||WorkPackageViewOrderService)(k.KVO(r.i),k.KVO(g.n),k.KVO(o.D),k.KVO(m.p),k.KVO(h.P),k.KVO(s.B))}}static{this.ɵprov=k.jDH({token:WorkPackageViewOrderService,factory:WorkPackageViewOrderService.ɵfac})}}},49989:(e,t,n)=>{"use strict";n.d(t,{I:()=>WorkPackageViewPaginationService});var i=n(11048),o=n(27091);class WorkPackageViewPagination{constructor(e){this.current=new o.i(e.offset,e.total,e.pageSize)}get page(){return this.current.page}set page(e){this.current.page=e}get perPage(){return this.current.perPage}set perPage(e){this.current.perPage=e}get total(){return this.current.total}set total(e){this.current.total=e}}var r=n(10548),s=n(81965),a=n(68559);class WorkPackageViewPaginationService extends r.d{constructor(e,t){super(e),this.paginationService=t}get paginationObject(){return this.current?{pageSize:this.current.perPage,offset:this.current.page}:{pageSize:this.paginationService.getCachedPerPage([]),offset:1}}valueFromQuery(e,t){return new WorkPackageViewPagination(t)}updateFromObject(e){const t=this.current;e.page&&(t.page=e.page),e.perPage&&(t.perPage=e.perPage),e.total&&(t.total=e.total),this.updatesState.putValue(t)}updateFromResults(e){const t={page:e.offset,perPage:e.pageSize,total:e.total,count:e.count};this.updateFromObject(t)}get current(){return this.lastUpdatedState.value}static{this.ɵfac=function WorkPackageViewPaginationService_Factory(e){return new(e||WorkPackageViewPaginationService)(a.KVO(i.i),a.KVO(s.m))}}static{this.ɵprov=a.jDH({token:WorkPackageViewPaginationService,factory:WorkPackageViewPaginationService.ɵfac})}}},98755:(e,t,n)=>{"use strict";n.d(t,{f:()=>WorkPackageViewRelationColumnsService});var i=n(11048),o=n(21861),r=n(95685),s=n(14593),a=n(36178),l=n(10548),c=n(88352),p=n(68559);class WorkPackageViewRelationColumnsService extends l.d{constructor(e,t,n,i,o){super(e),this.querySpace=e,this.wpTableColumns=t,this.halResourceService=n,this.apiV3Service=i,this.wpRelations=o}valueFromQuery(e){return this.current}relationsToExtendFor(e,t,n){if(!this.wpTableColumns.hasRelationColumns()||!this.lastUpdatedState.hasValue())return;if(_.isNil(t))return;const i=this.getExpandFor(e.id);if(void 0===i)return;const o=this.wpTableColumns.findById(i),r=this.relationColumnType(o);null!==r&&_.each(this.relationsForColumn(e,t,o),(e=>n(e,o,r)))}relationsForColumn(e,t,n){if(_.isNil(t))return[];const i=this.relationColumnType(n);if("toType"===i){const i=n.type.href;return _.filter(t,(t=>{const n=t.denormalized(e),o=this.apiV3Service.work_packages.cache.state(n.targetId).value;return _.get(o,"type.href")===i}))}if("ofType"===i){const{relationType:i}=n;return _.filter(t,(t=>t.denormalized(e).relationType===i))}return[]}relationColumnType(e){switch(e._type){case r.c.RELATION_TO_TYPE:return"toType";case r.c.RELATION_OF_TYPE:return"ofType";default:return null}}getExpandFor(e){return this.current[e]}setExpandFor(e,t){const n={...this.current};n[e]=t,this.update(n)}collapse(e){const t={...this.current};delete t[e],this.update(t)}get current(){return this.lastUpdatedState.getValueOr({})}static{this.ɵfac=function WorkPackageViewRelationColumnsService_Factory(e){return new(e||WorkPackageViewRelationColumnsService)(p.KVO(i.i),p.KVO(c.T),p.KVO(a.t),p.KVO(s.n),p.KVO(o.U))}}static{this.ɵprov=p.jDH({token:WorkPackageViewRelationColumnsService,factory:WorkPackageViewRelationColumnsService.ɵfac})}}},29925:(e,t,n)=>{"use strict";n.d(t,{a:()=>WorkPackageViewSelectionService});var i=n(11048),o=n(13432),r=n(67369),s=n(10548),a=n(80559),l=n(68559);class WorkPackageViewSelectionService extends s.d{constructor(e,t,n){super(e),this.querySpace=e,this.states=t,this.opContextMenu=n,this.reset()}ngOnDestroy(){a.unbind(["command+d","ctrl+d"]),a.unbind(["command+a","ctrl+a"])}initializeSelection(e){const t={selected:{},activeRowIndex:null};e.forEach((e=>t.selected[e]=!0)),this.updatesState.clear(),this.pristineState.putValue(t)}isSelected(e){return!!this.current?.selected[e]}selectAll(e){const t=this._emptyState;e.forEach((e=>{e.workPackageId&&(t.selected[e.workPackageId]=!0)})),this.update(t)}getSelectedWorkPackages(){const e=this.states.workPackages;return this.getSelectedWorkPackageIds().map((t=>e.get(t).value))}getSelectedWorkPackageIds(){const e=[];return _.each(this.current?.selected,((t,n)=>{t&&e.push(n)})),e}reset(){this.update(this._emptyState)}get isEmpty(){return 0===this.selectionCount}get selectionCount(){return _.size(this.current?.selected)}toggleRow(e){const t=this.current?.selected[e];this.setRowState(e,!t)}setRowState(e,t){const n=this.current||this._emptyState;n.selected[e]=t,this.update(n)}setSelection(e,t){const n=this._emptyState;n.selected[e]=!0,n.activeRowIndex=t,this.update(n)}setMultiSelectionFrom(e,t,n){const i=this.current||this._emptyState;if(0===this.selectionCount||null===i.activeRowIndex)i.selected[t]=!0,i.activeRowIndex=n;else{const t=Math.min(n,i.activeRowIndex),o=Math.max(n,i.activeRowIndex);e.forEach(((e,n)=>{e.workPackageId&&(i.selected[e.workPackageId]=n>=t&&n<=o)}))}this.update(i)}registerSelectAllListener(e){a.bind(["command+a","ctrl+a"],(t=>(this.selectAll(e()),t.preventDefault(),this.opContextMenu.close(),!1)))}registerDeselectAllListener(){a.bind(["command+d","ctrl+d"],(e=>(this.reset(),e.preventDefault(),this.opContextMenu.close(),!1)))}get _emptyState(){return{selected:{},activeRowIndex:null}}valueFromQuery(e,t){}static{this.ɵfac=function WorkPackageViewSelectionService_Factory(e){return new(e||WorkPackageViewSelectionService)(l.KVO(i.i),l.KVO(o.D),l.KVO(r.V))}}static{this.ɵprov=l.jDH({token:WorkPackageViewSelectionService,factory:WorkPackageViewSelectionService.ɵfac})}}},1257:(e,t,n)=>{"use strict";n.d(t,{P:()=>WorkPackageViewSortByService});var i=n(47418),o=n(87378),r=n(11048),s=n(13432),a=n(73014),l=n(10548),c=n(68559);class WorkPackageViewSortByService extends l.O{constructor(e,t,n){super(t),this.states=e,this.querySpace=t,this.pathHelper=n}valueFromQuery(e){return[...e.sortBy]}onReadyWithAvailable(){return(0,i.kg)(this.pristineState,this.querySpace.available.sortBy).values$().pipe((0,o.u)(null))}hasChanged(e){const comparer=e=>e.map((e=>e.href));return!_.isEqual(comparer(e.sortBy),comparer(this.current))}applyToQuery(e){const t=this.isManuallySorted(e.sortBy);return e.sortBy=[...this.current],!(t&&this.isManualSortingMode)}isSortable(e){return!!_.find(this.available,(t=>t.column.href===e.href))}addSortCriteria(e,t){const n=this.findAvailableDirection(e,t);n&&this.add(n)}setAsSingleSortCriteria(e,t){const n=this.findAvailableDirection(e,t);n&&this.update([n])}findAvailableDirection(e,t){return _.find(this.available,(n=>n.column.href===e.href&&n.direction.href===t))}add(e){const t=_.uniqBy([e,...this.current],(e=>e.column.href)).slice(0,3);this.update(t)}get isManualSortingMode(){return this.isManuallySorted(this.current)}switchToManualSorting(e){const{manualSortObject:t}=this;return!(!t||this.isManualSortingMode)&&(e.setSortBy([t]),!0)}get current(){return this.lastUpdatedState.getValueOr([])}get availableState(){return this.querySpace.available.sortBy}get available(){return this.availableState.getValueOr([])}isManuallySorted(e){return!!(e&&e.length>0)&&e[0].column.href.endsWith("/manualSorting")}get manualSortObject(){return _.find(this.available,(e=>e.column.href.endsWith("/manualSorting")))}static{this.ɵfac=function WorkPackageViewSortByService_Factory(e){return new(e||WorkPackageViewSortByService)(c.KVO(s.D),c.KVO(r.i),c.KVO(a.B))}}static{this.ɵprov=c.jDH({token:WorkPackageViewSortByService,factory:WorkPackageViewSortByService.ɵfac})}}},55332:(e,t,n)=>{"use strict";n.d(t,{X:()=>WorkPackageViewSumService});var i=n(11048),o=n(10548),r=n(68559);class WorkPackageViewSumService extends o.O{constructor(e){super(e)}valueFromQuery(e){return!!e.sums}initialize(e){this.pristineState.putValue(!!e.sums)}hasChanged(e){return e.sums!==this.isEnabled}applyToQuery(e){return e.sums=this.isEnabled,!0}toggle(){this.updatesState.putValue(!this.current)}setEnabled(e){this.updatesState.putValue(e)}get isEnabled(){return this.current}get current(){return this.lastUpdatedState.getValueOr(!1)}static{this.ɵfac=function WorkPackageViewSumService_Factory(e){return new(e||WorkPackageViewSumService)(r.KVO(i.i))}}static{this.ɵprov=r.jDH({token:WorkPackageViewSumService,factory:WorkPackageViewSumService.ɵfac})}}},68222:(e,t,n)=>{"use strict";n.d(t,{X:()=>WorkPackageViewTimelineService});var i=n(11048),o=n(47418),r=n(13517),s=n(10548),a=n(68559);class WorkPackageViewTimelineService extends s.O{constructor(e){super(e),this.querySpace=e,this.appliedZoomLevel$=(0,o.hF)("auto")}valueFromQuery(e){return{...this.defaultState,visible:e.timelineVisible,zoomLevel:e.timelineZoomLevel,labels:e.timelineLabels}}set appliedZoomLevel(e){this.appliedZoomLevel$.putValue(e)}get appliedZoomLevel(){return this.appliedZoomLevel$.value}hasChanged(e){const t=this.isVisible!==e.timelineVisible,n=this.zoomLevel!==e.timelineZoomLevel,i=!_.isEqual(this.current.labels,e.timelineLabels);return t||n||i}applyToQuery(e){return e.timelineVisible=this.isVisible,e.timelineZoomLevel=this.zoomLevel,e.timelineLabels=this.current.labels,!1}toggle(){const e=this.current;this.setVisible(!e.visible)}setVisible(e){this.updatesState.putValue({...this.current,visible:e})}get isVisible(){return this.current.visible}get zoomLevel(){return this.current.zoomLevel}get labels(){return _.isEmpty(this.current.labels)?this.defaultLabels:this.current.labels}updateLabels(e){this.modify({labels:e})}getNormalizedLabels(e){const t=this.defaultLabels;return _.each(this.current.labels,((e,n)=>{const i=n;t[i]=""===e?null:e})),t}setZoomLevel(e){this.modify({zoomLevel:e})}updateZoomWithDelta(e){const t=this.current.zoomLevel;if("auto"!==t)return this.applyZoomLevel(t,e);const n=this.appliedZoomLevel;if(n&&"auto"!==n)this.applyZoomLevel(n,e);else{const t=e<0?"days":"years";this.setZoomLevel(t)}}isAutoZoom(){return"auto"===this.current.zoomLevel}enableAutozoom(){this.modify({zoomLevel:"auto"})}get current(){return this.lastUpdatedState.getValueOr(this.defaultState)}modify(e){this.update({...this.current,...e})}applyZoomLevel(e,t){let n=r.W8.indexOf(e);n+=t,n>=0&&n<r.W8.length&&this.setZoomLevel(r.W8[n])}get defaultLabels(){return{left:"",right:"",farRight:"subject"}}get defaultState(){return{zoomLevel:"auto",visible:!1,labels:this.defaultLabels}}static{this.ɵfac=function WorkPackageViewTimelineService_Factory(e){return new(e||WorkPackageViewTimelineService)(a.KVO(i.i))}}static{this.ɵprov=a.jDH({token:WorkPackageViewTimelineService,factory:WorkPackageViewTimelineService.ɵfac})}}},46169:(e,t,n)=>{"use strict";n.d(t,{y:()=>WorkPackageSingleViewBase});var i=n(24398),o=n(68559),r=n(61816),s=n(73014),a=n(79),l=n(48707),c=n(67820),p=n(13432),d=n(66309),u=n(51339),h=n(49349),m=n(1758),g=n(99496),_=n(14593),f=n(65046),b=n(96613),k=n(94564),v=n(73962),C=n(26109),y=n(77159),w=n(75716),T=n(72650);class WorkPackageSingleViewBase extends g.p{constructor(e,t){super(),this.injector=e,this.workPackageId=t}observeWorkPackage(){this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe((e=>{this.workPackage?this.workPackage=e:(this.workPackage=e,this.init()),this.cdRef.detectChanges()}),(e=>{this.handleLoadingError(e)}))}init(){this.apiV3Service.projects.id(this.workPackage.project).requireAndStream().subscribe((()=>{this.projectIdentifier=this.workPackage.project.identifier,this.cdRef.detectChanges()})),this.projectsResourceService.requireEntity(this.workPackage.$links.project.href).subscribe((()=>{}),(e=>{this.toastService.addError(e)})),this.displayNotificationsButton$=this.storeService.hasNotifications$,this.storeService.setFilters(this.workPackage.id),this.authorisationService.initModelAuth("work_package",this.workPackage.$links),this.titleService.setFirstPart(this.workPackage.subjectWithType(-1)),this.showStaticPagePath=this.PathHelper.workPackagePath(this.workPackageId),this.workPackage.$links.attachments&&this.attachmentsResourceService.fetchCollection(this.workPackage.$links.attachments.href).subscribe(),this.keepTab.observable.pipe(this.untilDestroyed()).subscribe((e=>{this.updateFocusAnchorLabel(e.active)}))}handleLoadingError(e){this.notificationService.handleRawError(e)}updateFocusAnchorLabel(e){return this.focusAnchorLabel=this.i18n.t("js.label_work_package_details_you_are_here",{tab:this.i18n.t(`js.work_packages.tabs.${e}`),type:this.workPackage.type.name,subject:this.workPackage.subject}),this.focusAnchorLabel}}(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",p.D)],WorkPackageSingleViewBase.prototype,"states",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",r.W)],WorkPackageSingleViewBase.prototype,"i18n",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",d.S)],WorkPackageSingleViewBase.prototype,"keepTab",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",s.B)],WorkPackageSingleViewBase.prototype,"PathHelper",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",u.p)],WorkPackageSingleViewBase.prototype,"halEditing",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",a.c)],WorkPackageSingleViewBase.prototype,"wpTableFocus",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",h.U)],WorkPackageSingleViewBase.prototype,"notificationService",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",c._)],WorkPackageSingleViewBase.prototype,"authorisationService",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",v._)],WorkPackageSingleViewBase.prototype,"attachmentsResourceService",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",y.T)],WorkPackageSingleViewBase.prototype,"fileLinkResourceService",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",w.s)],WorkPackageSingleViewBase.prototype,"projectsResourceService",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",C.m)],WorkPackageSingleViewBase.prototype,"storages",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",T.fw)],WorkPackageSingleViewBase.prototype,"toastService",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",o.gRc)],WorkPackageSingleViewBase.prototype,"cdRef",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",l.P)],WorkPackageSingleViewBase.prototype,"titleService",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",_.n)],WorkPackageSingleViewBase.prototype,"apiV3Service",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",f.R)],WorkPackageSingleViewBase.prototype,"hooks",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",k.d)],WorkPackageSingleViewBase.prototype,"actions$",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",b.e)],WorkPackageSingleViewBase.prototype,"storeService",void 0)},58103:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});const i=(0,n(83755).XI)("[Work packages] Table refresh requested")},89391:(e,t,n)=>{"use strict";n.d(t,{$:()=>WorkPackagesViewBase});var i=n(24398),o=n(68559),r=n(83093),s=n(67820),a=n(11048),l=n(15842),c=n(51567),p=n(64334),d=n(80366),u=n(61816),h=n(23906),m=n(62665),g=n(13432),_=n(88352),f=n(1257),b=n(1750),k=n(34120),v=n(55332),C=n(68222),y=n(94450),w=n(49989),T=n(95445),S=n(44663),j=n(28702),P=n(51524),I=n(74573),x=n(80406),R=n(91691),F=n(36652),M=n(1758),O=n(86866),D=n(99496),G=n(58154),E=n(94564),A=n(58103);class WorkPackagesViewBase extends D.p{constructor(e){super(),this.injector=e,this.queryLoaded=!1,this.destroyed=!1}ngOnInit(){this.setupQueryObservers(),this.setupRefreshObserver(),this.setupQueryLoadedListener()}setupQueryObservers(){this.wpTablePagination.updates$().pipe(this.untilDestroyed(),(0,l.E)(this.querySpace.query.values$())).subscribe((([e,t])=>{this.wpListChecksumService.isQueryOutdated(t,e)&&(this.wpListChecksumService.update(t,e),this.refresh(!0,!1))})),this.setupChangeObserver(this.wpTableFilters,!0),this.setupChangeObserver(this.wpTableGroupBy),this.setupChangeObserver(this.wpTableSortBy),this.setupChangeObserver(this.wpTableSum),this.setupChangeObserver(this.wpTableTimeline),this.setupChangeObserver(this.wpTableHierarchies),this.setupChangeObserver(this.wpTableColumns),this.setupChangeObserver(this.wpTableHighlighting),this.setupChangeObserver(this.wpTableOrder),this.setupChangeObserver(this.wpDisplayRepresentation),this.setupChangeObserver(this.wpIncludeSubprojects),this.setupChangeObserver(this.wpTableBaseline)}setupChangeObserver(e,t=!1){const n=this.querySpace.query;e.updates$().pipe(this.untilDestroyed(),(0,c.p)((()=>n.hasValue()&&e.hasChanged(n.value)))).subscribe((()=>{const i=n.value,o=e.applyToQuery(i);this.querySpace.query.putValue(i),this.wpListChecksumService.updateIfDifferent(i,this.wpTablePagination.current).then((()=>{o&&this.refresh(!0,t)}))}))}get projectIdentifier(){return this.currentProject.identifier||void 0}setupRefreshObserver(){this.halEvents.aggregated$("WorkPackage").pipe(this.untilDestroyed(),(0,c.p)((e=>this.filterRefreshEvents(e)))).subscribe((e=>{this.refresh(!1,!1)})),this.actions$.ofType(A.$).pipe(this.untilDestroyed()).subscribe((()=>{this.refresh(!1,!1)}))}filterRefreshEvents(e){const t=this.querySpace.renderedWorkPackageIds.value||this.querySpace.results.value?.elements.map((e=>e.id))||[],n=new Set(t);for(let t=0;t<e.length;t++){const i=e[t];if(n.has(i.id)||"created"===i.eventType)return!0}return!1}setupQueryLoadedListener(){this.querySpace.initialized.values$().pipe((0,p.s)(1),(0,c.p)((()=>!this.componentDestroyed))).subscribe((()=>{this.queryLoaded=!0,this.cdRef.detectChanges()}))}static{this.ɵfac=function WorkPackagesViewBase_Factory(e){return new(e||WorkPackagesViewBase)(o.rXU(o.zZn))}}static{this.ɵdir=o.FsC({type:WorkPackagesViewBase,features:[o.Vt3]})}}(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",r.dw)],WorkPackagesViewBase.prototype,"$state",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",g.D)],WorkPackagesViewBase.prototype,"states",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",a.i)],WorkPackagesViewBase.prototype,"querySpace",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",s._)],WorkPackagesViewBase.prototype,"authorisationService",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",_.T)],WorkPackagesViewBase.prototype,"wpTableColumns",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",m.I)],WorkPackagesViewBase.prototype,"wpTableHighlighting",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",f.P)],WorkPackagesViewBase.prototype,"wpTableSortBy",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",b.W)],WorkPackagesViewBase.prototype,"wpTableGroupBy",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",k.N)],WorkPackagesViewBase.prototype,"wpTableFilters",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",v.X)],WorkPackagesViewBase.prototype,"wpTableSum",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",C.X)],WorkPackagesViewBase.prototype,"wpTableTimeline",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",y.j)],WorkPackagesViewBase.prototype,"wpTableHierarchies",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",w.I)],WorkPackagesViewBase.prototype,"wpTablePagination",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",P.k)],WorkPackagesViewBase.prototype,"wpTableOrder",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",T.E)],WorkPackagesViewBase.prototype,"wpListService",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",S.T)],WorkPackagesViewBase.prototype,"wpListChecksumService",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",d.FX)],WorkPackagesViewBase.prototype,"loadingIndicatorService",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",r.HN)],WorkPackagesViewBase.prototype,"$transitions",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",u.W)],WorkPackagesViewBase.prototype,"I18n",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",h.M)],WorkPackagesViewBase.prototype,"opStaticQueries",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",j.V)],WorkPackagesViewBase.prototype,"wpStatesInitialization",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",o.gRc)],WorkPackagesViewBase.prototype,"cdRef",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",I.dd)],WorkPackagesViewBase.prototype,"wpDisplayRepresentation",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",x.G)],WorkPackagesViewBase.prototype,"wpIncludeSubprojects",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",G.b1)],WorkPackagesViewBase.prototype,"wpTableBaseline",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",R.o)],WorkPackagesViewBase.prototype,"halEvents",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",F.g)],WorkPackagesViewBase.prototype,"deviceService",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",O.c)],WorkPackagesViewBase.prototype,"currentProject",void 0),(0,i.Cg)([(0,M.O)(),(0,i.Sn)("design:type",E.d)],WorkPackagesViewBase.prototype,"actions$",void 0)},96941:(e,t,n)=>{"use strict";n.d(t,{L:()=>WorkPackageViewPageComponent});var i=n(64334),o=n(40358),r=n(49349),s=n(68118),a=n(99569),l=n(49977),c=n(81805),p=n(47637),d=n(43341),u=n(58397),h=n(15615),m=n(59452),g=n(28549),_=n(89075),f=n(29039),b=n(68559),k=n(88955),v=n(60316),C=n(24557),y=n(25827),w=n(92103);function WorkPackageViewPageComponent_op_back_button_3_Template(e,t){if(1&e&&b.nrm(0,"op-back-button",11),2&e){const e=b.XpG();b.Y8G("customBackMethod",e.backButtonCallback)}}function WorkPackageViewPageComponent_ul_5_ng_container_1_li_1_Template(e,t){if(1&e&&(b.j41(0,"li",15),b.nrm(1,"ndc-dynamic",16),b.k0s()),2&e){const e=b.XpG().$implicit,t=b.XpG(2);b.Y8G("ngClass",e.containerClasses),b.R7$(),b.Y8G("ndcDynamicComponent",e.component)("ndcDynamicInputs",e.inputs)("ndcDynamicInjector",t.injector)("ndcDynamicOutputs",e.outputs)}}function WorkPackageViewPageComponent_ul_5_ng_container_1_Template(e,t){if(1&e&&(b.qex(0),b.DNE(1,WorkPackageViewPageComponent_ul_5_ng_container_1_li_1_Template,2,5,"li",14),b.bVm()),2&e){const e=t.$implicit;b.R7$(),b.Y8G("ngIf",!e.show||e.show())}}function WorkPackageViewPageComponent_ul_5_Template(e,t){if(1&e&&(b.j41(0,"ul",12),b.DNE(1,WorkPackageViewPageComponent_ul_5_ng_container_1_Template,2,1,"ng-container",13),b.k0s()),2&e){const e=b.XpG();b.R7$(),b.Y8G("ngForOf",e.toolbarButtonComponents)}}function WorkPackageViewPageComponent_ndc_dynamic_7_Template(e,t){if(1&e&&b.nrm(0,"ndc-dynamic",17),2&e){const e=b.XpG();b.Y8G("ndcDynamicComponent",e.filterContainerDefinition.component)("ndcDynamicInputs",e.filterContainerDefinition.inputs)("ndcDynamicOutputs",e.filterContainerDefinition.outputs)("ndcDynamicInjector",e.injector)}}class WorkPackageViewPageComponent extends a.U{constructor(){super(...arguments),this.toolbarButtonComponents=[{component:l.X,inputs:{stateName$:(0,m.of)(this.stateName),allowed:["work_packages.createWorkPackage"]}},{component:_.c},{component:f.f,containerClasses:"hidden-for-tablet"},{component:c.f},{component:g.a,show:()=>!(!this.currentQuery||!this.currentQuery.groupBy)},{component:p.I,containerClasses:"hidden-for-tablet"},{component:d.G,containerClasses:"hidden-for-tablet -no-spacing"},{component:u.y,containerClasses:"hidden-for-tablet"},{component:h.K}]}ngOnInit(){super.ngOnInit(),this.wpTableFilters.hidden.push("project"),this.text.button_settings=this.I18n.t("js.button_settings")}additionalLoadingTime(){return this.wpTableTimeline.isVisible?this.querySpace.timelineRendered.pipe((0,i.s)(1)).toPromise():this.querySpace.tableRendered.valuesPromise()}shouldUpdateHtmlTitle(){return"work-packages.partitioned.list"===this.$state.current.name}get stateName(){return this.$state.current.name?.includes("gantt")?"gantt.partitioned.list.new":"work-packages.partitioned.list.new"}static{this.ɵfac=(()=>{let e;return function WorkPackageViewPageComponent_Factory(t){return(e||(e=b.xGo(WorkPackageViewPageComponent)))(t||WorkPackageViewPageComponent)}})()}static{this.ɵcmp=b.VBU({type:WorkPackageViewPageComponent,selectors:[["wp-view-page"]],features:[b.Jv_([{provide:o.Y,useClass:r.U},s.x]),b.Vt3],decls:11,vars:8,consts:[[1,"work-packages-partitioned-query-space--container",3,"ngClass"],[1,"toolbar-container","-editable"],[1,"toolbar"],["class","op-back-button","linkClass","op-back-button_mobile-limited-width",3,"customBackMethod",4,"ngIf"],[3,"onSave","onEmptySubmit","title","inFlight","showSaveCondition","editable"],["class","toolbar-items hide-when-print",4,"ngIf"],[1,"work-packages-partitioned-query-space--filter-area"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector",4,"ngIf"],[1,"work-packages-partitioned-page--content-container"],["data-indicator-name","table","ui-view","content-left",1,"work-packages-partitioned-page--content-left","loading-indicator--location"],["ui-view","content-right",1,"work-packages-partitioned-page--content-right"],["linkClass","op-back-button_mobile-limited-width",1,"op-back-button",3,"customBackMethod"],[1,"toolbar-items","hide-when-print"],[4,"ngFor","ngForOf"],["class","toolbar-item",3,"ngClass",4,"ngIf"],[1,"toolbar-item",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicInjector","ndcDynamicOutputs"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector"]],template:function WorkPackageViewPageComponent_Template(e,t){1&e&&(b.j41(0,"div",0)(1,"div",1)(2,"div",2),b.DNE(3,WorkPackageViewPageComponent_op_back_button_3_Template,1,1,"op-back-button",3),b.j41(4,"editable-toolbar-title",4),b.bIt("onSave",(function WorkPackageViewPageComponent_Template_editable_toolbar_title_onSave_4_listener(e){return t.changeChangesFromTitle(e)}))("onEmptySubmit",(function WorkPackageViewPageComponent_Template_editable_toolbar_title_onEmptySubmit_4_listener(){return t.updateTitleName("")})),b.k0s(),b.DNE(5,WorkPackageViewPageComponent_ul_5_Template,2,1,"ul",5),b.k0s()(),b.j41(6,"div",6),b.DNE(7,WorkPackageViewPageComponent_ndc_dynamic_7_Template,1,4,"ndc-dynamic",7),b.k0s(),b.j41(8,"div",8),b.nrm(9,"div",9)(10,"div",10),b.k0s()()),2&e&&(b.Y8G("ngClass",t.currentPartition),b.R7$(3),b.Y8G("ngIf",t.backButtonCallback),b.R7$(),b.Y8G("title",t.selectedTitle)("inFlight",t.toolbarDisabled)("showSaveCondition",t.showToolbarSaveButton)("editable",t.titleEditingEnabled),b.R7$(),b.Y8G("ngIf",t.showToolbar),b.R7$(2),b.Y8G("ngIf",t.filterContainerDefinition))},dependencies:[k.UIView,v.YU,v.Sq,v.bT,C.JS,y.Bf,y.dE,w.X],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;display:grid;grid-template-columns:1fr;grid-template-rows:auto auto minmax(200px,1fr);margin-left:-10px;padding-left:10px;width:calc(100% + 10px)}.work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{flex-grow:1}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{overflow:auto}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   wp-resizer[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]{display:flex;overflow:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{position:relative}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{flex:1}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .title-container_editable[_ngcontent-%COMP%]{margin-left:-7px}@media only screen and (max-width: 543px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{min-width:initial;max-width:100vw;max-height:100%}}@media only screen and (max-width: 767px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto;grid-template-rows:auto auto;justify-items:start}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .op-back-button[_ngcontent-%COMP%]{grid-column:1/3;grid-row:1/2}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]{grid-column:1/2;grid-row:2/3;overflow:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-items[_ngcontent-%COMP%]{grid-column:2/3;grid-row:2/3}}"],changeDetection:0})}}},49349:(e,t,n)=>{"use strict";n.d(t,{U:()=>WorkPackageNotificationService});var i=n(40358),o=n(14593),r=n(88535),s=n(72688),a=n(68559);class WorkPackageNotificationService extends i.Y{constructor(e,t,n,i){super(e),this.injector=e,this.apiV3Service=t,this.turboRequests=n,this.configurationService=i,this.primerizedActivitiesEnabled=this.configurationService.activeFeatureFlags.includes("primerizedWorkPackageActivities")}showSave(e,t=!1){const n={message:this.I18n.t("js.notice_successful_"+(t?"create":"update")),type:"success"};this.ToastService.addSuccess(n)}showCustomError(e,t){return"urn:openproject-org:api:v3:errors:UpdateConflict"===e.errorIdentifier?(this.primerizedActivitiesEnabled?this.turboRequests.request("/work_packages/show_conflict_flash_message?scheme=danger",{method:"GET"}):this.ToastService.addError({message:e.message,type:"error",link:{text:this.I18n.t("js.hal.error.update_conflict_refresh"),target:()=>this.apiV3Service.work_packages.id(t).refresh()}}),!0):super.showCustomError(e,t)}static{this.ɵfac=function WorkPackageNotificationService_Factory(e){return new(e||WorkPackageNotificationService)(a.KVO(a.zZn),a.KVO(o.n),a.KVO(r.W),a.KVO(s.s))}}static{this.ɵprov=a.jDH({token:WorkPackageNotificationService,factory:WorkPackageNotificationService.ɵfac})}}},20734:(e,t,n)=>{"use strict";n.d(t,{p:()=>WorkPackageService});var i=n(83093),o=n(73014),r=n(85247),s=n(72650),a=n(61816),l=n(91691),c=n(68559),p=n(30501);class WorkPackageService{constructor(e,t,n,i,o,r,s){this.http=e,this.$state=t,this.PathHelper=n,this.UrlParamsHelper=i,this.toastService=o,this.I18n=r,this.halEvents=s,this.text={successful_delete:this.I18n.t("js.work_packages.message_successful_bulk_delete")}}performBulkDelete(e,t){const n={"ids[]":e},i=this.http.delete(this.PathHelper.workPackagesBulkDeletePath(),{params:n,withCredentials:!0}).toPromise();return t&&i.then((()=>{this.toastService.addSuccess(this.text.successful_delete),e.forEach((e=>this.halEvents.push({_type:"WorkPackage",id:e},{eventType:"deleted"}))),this.$state.includes("**.list.details.**")&&e.indexOf(this.$state.params.workPackageId)>-1&&this.$state.go("work-packages.partitioned.list",this.$state.params)})).catch((()=>{const e=this.UrlParamsHelper.buildQueryString(n);window.location.href=`${this.PathHelper.workPackagesBulkDeletePath()}?${e}`})),i}static{this.ɵfac=function WorkPackageService_Factory(e){return new(e||WorkPackageService)(c.KVO(p.Qq),c.KVO(i.dw),c.KVO(o.B),c.KVO(r.j),c.KVO(s.fw),c.KVO(a.W),c.KVO(l.o))}}static{this.ɵprov=c.jDH({token:WorkPackageService,factory:WorkPackageService.ɵfac})}}},95752:(e,t,n)=>{"use strict";n.d(t,{z:()=>OpAttachmentListItemComponent});var i=n(68559),o=n(75797),r=n(19999),s=n(91817),a=n(61816),l=n(32420),c=n(73014),p=n(99496),d=n(24443),u=n(65896),h=n(48908),m=n(2319),g=n(60316);const _=["avatar"],f=["op-attachment-list-item",""];function OpAttachmentListItemComponent_span_3_Template(e,t){1&e&&i.nrm(0,"span",13)}function OpAttachmentListItemComponent_span_4_Template(e,t){if(1&e&&i.nrm(0,"span"),2&e){const e=i.XpG();i.STu("spot-icon spot-icon_",e.fileIcon.icon," op-files-tab--icon op-files-tab--icon_",e.fileIcon.clazz,"")}}function OpAttachmentListItemComponent_span_6_Template(e,t){if(1&e&&i.nrm(0,"span",14),2&e){const e=i.XpG();i.Y8G("textContent",e.timestampText)}}function OpAttachmentListItemComponent_a_10_Template(e,t){if(1&e&&(i.j41(0,"a",15),i.nrm(1,"span",16),i.k0s()),2&e){const e=i.XpG();i.Y8G("href",e.attachment._links.staticDownloadLocation.href,i.B4B)}}function OpAttachmentListItemComponent_button_11_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",17),i.bIt("click",(function OpAttachmentListItemComponent_button_11_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.confirmRemoveAttachment())})),i.nrm(1,"span",18),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("title",e.deleteIconTitle)}}class OpAttachmentListItemComponent extends p.p{static{this.imageFileExtensions=["jpeg","jpg","gif","bmp","png"]}get deleteIconTitle(){return this.text.removeFile({fileName:this.attachment.fileName})}constructor(e,t,n,r,s,a){super(),this.I18n=e,this.pathHelper=t,this.timezoneService=n,this.confirmDialogService=r,this.principalsResourceService=s,this.principalRendererService=a,this.showTimestamp=!0,this.removeAttachment=new i.bkB,this.text={quarantinedHint:this.I18n.t("js.attachments.quarantined_hint"),dragHint:this.I18n.t("js.attachments.draggable_hint"),deleteTitle:this.I18n.t("js.attachments.delete"),deleteConfirmation:this.I18n.t("js.attachments.delete_confirmation"),removeFile:e=>this.I18n.t("js.label_remove_file",e)},this.viewInitialized$=new o.t(!1)}ngOnInit(){this.fileIcon=(0,m.nF)(this.attachment.contentType);const e=this.attachment._links.author.href;this.author$=this.principalsResourceService.requireEntity(e),this.timestampText=this.timezoneService.parseDatetime(this.attachment.createdAt).fromNow(),(0,r.z)([this.author$,this.viewInitialized$.pipe((0,s.F)())]).pipe(this.untilDestroyed()).subscribe((([e,t])=>{t&&this.principalRendererService.render(this.avatar.nativeElement,e,{hide:!0,link:!1},{hide:!1,size:"mini"})}))}ngAfterViewInit(){this.viewInitialized$.next(!0)}setDragData(e){const t=this.downloadPath,n=this.draggableHTML(t);null!=e.dataTransfer&&(e.dataTransfer.setData("text/plain",t),e.dataTransfer.setData("text/html",n.outerHTML),e.dataTransfer.setData("text/uri-list",t),e.dataTransfer.setDragImage(n,0,0))}draggableHTML(e){let t;return this.isImage?(t=document.createElement("img"),t.src=e,t.textContent=this.attachment.fileName):(t=document.createElement("a"),t.href=e,t.textContent=this.attachment.fileName),t}get downloadPath(){return this.pathHelper.attachmentDownloadPath(String(this.attachment.id),this.attachment.fileName)}get isImage(){const e=this.attachment.fileName.split(".").pop()||"";return OpAttachmentListItemComponent.imageFileExtensions.indexOf(e.toLowerCase())>-1}confirmRemoveAttachment(){const e={text:{text:this.text.deleteConfirmation,title:this.text.deleteTitle,button_continue:this.text.deleteTitle},icon:{continue:"delete"},dangerHighlighting:!0};this.confirmDialogService.confirm(e).then((()=>{this.removeAttachment.emit()})).catch((()=>{}))}static{this.ɵfac=function OpAttachmentListItemComponent_Factory(e){return new(e||OpAttachmentListItemComponent)(i.rXU(a.W),i.rXU(c.B),i.rXU(l.D),i.rXU(h.g),i.rXU(d.V),i.rXU(u.r))}}static{this.ɵcmp=i.VBU({type:OpAttachmentListItemComponent,selectors:[["","op-attachment-list-item",""]],viewQuery:function OpAttachmentListItemComponent_Query(e,t){if(1&e&&i.GBs(_,5),2&e){let e;i.mGM(e=i.lsd())&&(t.avatar=e.first)}},inputs:{attachment:"attachment",index:"index",showTimestamp:"showTimestamp"},outputs:{removeAttachment:"removeAttachment"},features:[i.Vt3],attrs:f,decls:13,vars:13,consts:[["avatar",""],[1,"spot-list--item-floating-wrapper","op-file-list--item-floating-wrapper"],["target","_blank",1,"spot-list--item-action","spot-list--item-action_link","op-file-list--item-action",3,"dragstart","href"],["data-test-selector","op-files-tab--file-list-item-title",1,"spot-list--item-title","op-file-list--item-title",3,"title"],["class","spot-icon spot-icon_bug op-files-tab-icon",4,"ngIf"],[3,"class",4,"ngIf"],[3,"textContent"],["class","op-file-list--item-text hide-when-print",3,"textContent",4,"ngIf"],[1,"op-file-list--item-avatar"],[1,"spot-list--item-floating-actions","op-file-list--item-floating-actions","hidden-for-mobile"],["class","spot-link","target","_blank",3,"href",4,"ngIf"],["type","button","class","spot-link",3,"title","click",4,"ngIf"],["type","hidden",3,"name","value"],[1,"spot-icon","spot-icon_bug","op-files-tab-icon"],[1,"op-file-list--item-text","hide-when-print",3,"textContent"],["target","_blank",1,"spot-link",3,"href"],[1,"spot-icon","spot-icon_download-arrow"],["type","button",1,"spot-link",3,"click","title"],[1,"spot-icon","spot-icon_delete"]],template:function OpAttachmentListItemComponent_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",1)(1,"a",2),i.bIt("dragstart",(function OpAttachmentListItemComponent_Template_a_dragstart_1_listener(n){return i.eBV(e),i.Njj(t.setDragData(n))})),i.j41(2,"div",3),i.DNE(3,OpAttachmentListItemComponent_span_3_Template,1,0,"span",4)(4,OpAttachmentListItemComponent_span_4_Template,1,4,"span",5),i.nrm(5,"span",6),i.k0s(),i.DNE(6,OpAttachmentListItemComponent_span_6_Template,1,1,"span",7),i.nrm(7,"div",8,0),i.k0s(),i.j41(9,"div",9),i.DNE(10,OpAttachmentListItemComponent_a_10_Template,2,1,"a",10)(11,OpAttachmentListItemComponent_button_11_Template,2,1,"button",11),i.k0s()(),i.nrm(12,"input",12)}2&e&&(i.R7$(),i.AVh("spot-list--item-action_disabled","quarantined"===t.attachment.status),i.Y8G("href",(null==t.attachment._links.originOpen?null:t.attachment._links.originOpen.href)||t.attachment._links.staticDownloadLocation.href,i.B4B),i.R7$(),i.Y8G("title","quarantined"===t.attachment.status?t.text.quarantinedHint:t.attachment.fileName),i.R7$(),i.Y8G("ngIf","quarantined"===t.attachment.status),i.R7$(),i.Y8G("ngIf","quarantined"!==t.attachment.status),i.R7$(),i.Y8G("textContent",t.attachment.fileName),i.R7$(),i.Y8G("ngIf",t.showTimestamp),i.R7$(4),i.Y8G("ngIf",!!t.attachment._links.originOpen),i.R7$(),i.Y8G("ngIf",!!t.attachment._links.delete),i.R7$(),i.Mz_("name","attachments[",t.index,"][id]"),i.FS9("value",t.attachment.id))},dependencies:[g.bT],encapsulation:2,changeDetection:0})}}},3544:(e,t,n)=>{"use strict";n.d(t,{m:()=>OpAttachmentListComponent});var i=n(68559),o=n(99496),r=n(73962),s=n(60316),a=n(95752);function OpAttachmentListComponent_ul_0_li_1_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"li",3),i.bIt("removeAttachment",(function OpAttachmentListComponent_ul_0_li_1_Template_li_removeAttachment_0_listener(){const t=i.eBV(e).$implicit,n=i.XpG(2);return i.Njj(n.removeAttachment(t))})),i.k0s()}if(2&e){const e=t.$implicit,n=t.index,o=i.XpG(2);i.Y8G("attachment",e)("showTimestamp",o.showTimestamp)("index",n)}}function OpAttachmentListComponent_ul_0_Template(e,t){if(1&e&&(i.j41(0,"ul",1),i.DNE(1,OpAttachmentListComponent_ul_0_li_1_Template,1,3,"li",2),i.k0s()),2&e){const e=i.XpG();i.R7$(),i.Y8G("ngForOf",e.attachments)}}class OpAttachmentListComponent extends o.p{constructor(e){super(),this.attachmentsResourceService=e,this.attachments=[],this.showTimestamp=!0,this.attachmentRemoved=new i.bkB}removeAttachment(e){this.attachmentsResourceService.removeAttachment(this.collectionKey,e).subscribe((()=>{this.attachmentRemoved.emit()}))}static{this.ɵfac=function OpAttachmentListComponent_Factory(e){return new(e||OpAttachmentListComponent)(i.rXU(r._))}}static{this.ɵcmp=i.VBU({type:OpAttachmentListComponent,selectors:[["op-attachment-list"]],inputs:{attachments:"attachments",collectionKey:"collectionKey",showTimestamp:"showTimestamp"},outputs:{attachmentRemoved:"attachmentRemoved"},features:[i.Vt3],decls:1,vars:1,consts:[["class","spot-list spot-list_compact op-file-list",4,"ngIf"],[1,"spot-list","spot-list_compact","op-file-list"],["op-attachment-list-item","","class","spot-list--item op-file-list--item","data-test-selector","op-attachment-list-item",3,"attachment","showTimestamp","index","removeAttachment",4,"ngFor","ngForOf"],["op-attachment-list-item","","data-test-selector","op-attachment-list-item",1,"spot-list--item","op-file-list--item",3,"removeAttachment","attachment","showTimestamp","index"]],template:function OpAttachmentListComponent_Template(e,t){1&e&&i.DNE(0,OpAttachmentListComponent_ul_0_Template,2,1,"ul",0),2&e&&i.Y8G("ngIf",t.attachments.length>0)},dependencies:[s.Sq,s.bT,a.z],encapsulation:2,changeDetection:0})}}},66913:(e,t,n)=>{"use strict";n.d(t,{r:()=>OpAttachmentsComponent});var i=n(68559),o=n(18537),r=n(51567),s=n(70271),a=n(98764),l=n(13432),c=n(61816),p=n(27514),d=n(36178),u=n(99496),h=n(37749),m=n(73962),g=n(72650),_=n(32420),f=n(97366),b=n(39626),k=n(60316),v=n(3544);const C=["hiddenFileInput"],_c1=e=>({"op-file-section--list":!0,"op-file-section--list_dragging":e}),_c2=(e,t,n)=>({"hide-when-print":!0,"op-file-section--drop-box":!0,"op-file-section--drop-box_dragging":e,"op-file-section--drop-box_dragging-over":t,"op-file-section--drop-box_float":n});function OpAttachmentsComponent_op_attachment_list_0_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-attachment-list",5),i.nI1(1,"async"),i.bIt("attachmentRemoved",(function OpAttachmentsComponent_op_attachment_list_0_Template_op_attachment_list_attachmentRemoved_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.attachmentRemoved.emit())})),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("ngClass",i.eq3(6,_c1,e.dragging>0))("attachments",i.bMT(1,4,e.attachments$))("collectionKey",e.collectionKey)("showTimestamp",e.showTimestamp)}}function OpAttachmentsComponent_input_2_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"input",6,0),i.bIt("change",(function OpAttachmentsComponent_input_2_Template_input_change_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.onFilePickerChanged())})),i.k0s()}}function OpAttachmentsComponent_button_3_span_3_Template(e,t){if(1&e&&i.nrm(0,"span",10),2&e){const e=i.XpG(2);i.Y8G("textContent",e.text.dropFiles)}}function OpAttachmentsComponent_button_3_span_5_Template(e,t){if(1&e&&i.nrm(0,"span",10),2&e){const e=i.XpG(2);i.Y8G("textContent",e.text.dropClickFiles)}}function OpAttachmentsComponent_button_3_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",7),i.nI1(1,"async"),i.bIt("click",(function OpAttachmentsComponent_button_3_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.triggerFileInput())}))("dragover",(function OpAttachmentsComponent_button_3_Template_button_dragover_0_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.onDragOver(t))}))("dragleave",(function OpAttachmentsComponent_button_3_Template_button_dragleave_0_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.onDragLeave(t))}))("drop",(function OpAttachmentsComponent_button_3_Template_button_drop_0_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.onDropFiles(t))})),i.nrm(2,"span",8),i.DNE(3,OpAttachmentsComponent_button_3_span_3_Template,1,1,"span",9),i.nI1(4,"async"),i.DNE(5,OpAttachmentsComponent_button_3_span_5_Template,1,1,"span",9),i.nI1(6,"async"),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("ngClass",i.sMw(10,_c2,e.dragging>0,e.draggingOverDropZone,i.bMT(1,4,e.attachments$).length)),i.BMQ("aria-label",e.text.uploadLabel),i.R7$(3),i.Y8G("ngIf",i.bMT(4,6,e.attachments$).length>0),i.R7$(2),i.Y8G("ngIf",0===i.bMT(6,8,e.attachments$).length)}}function OpAttachmentsComponent_div_4_button_1_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",13),i.bIt("click",(function OpAttachmentsComponent_div_4_button_1_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.triggerFileInput())})),i.nrm(1,"span",14)(2,"span",15),i.k0s()}if(2&e){const e=i.XpG(2);i.R7$(2),i.Y8G("textContent",e.text.uploadLabel)}}function OpAttachmentsComponent_div_4_Template(e,t){if(1&e&&(i.j41(0,"div",11),i.DNE(1,OpAttachmentsComponent_div_4_button_1_Template,3,1,"button",12),i.k0s()),2&e){const e=i.XpG();i.R7$(),i.Y8G("ngIf",!e.externalUploadButton)}}class OpAttachmentsComponent extends u.p{get attachmentsSelfLink(){return this.resource.attachments.href}get collectionKey(){return(0,f.A)(this.resource)?"new":this.attachmentsSelfLink}constructor(e,t,n,o,r,s,a,l,c){super(),this.elementRef=e,this.I18n=t,this.states=n,this.toastService=o,this.uploadService=r,this.halResourceService=s,this.attachmentsResourceService=a,this.timezoneService=l,this.cdRef=c,this.testSelector="op-attachments",this.className=!0,this.allowUploading=!0,this.destroyImmediately=!0,this.externalUploadButton=null,this.showTimestamp=!0,this.attachmentRemoved=new i.bkB,this.attachmentAdded=new i.bkB,this.draggingOverDropZone=!1,this.dragging=0,this.text={attachments:this.I18n.t("js.label_attachments"),uploadLabel:this.I18n.t("js.label_add_attachments"),dropFiles:this.I18n.t("js.label_drop_files"),dropClickFiles:this.I18n.t("js.label_drop_or_click_files"),foldersWarning:this.I18n.t("js.label_drop_folders_hint")},this.onGlobalDragLeave=e=>{this.dragging=Math.max(this.dragging-1,0),this.cdRef.detectChanges()},this.onGlobalDragEnd=e=>{this.dragging=0,this.cdRef.detectChanges()},this.onGlobalDragEnter=e=>{this.dragging=2,this.cdRef.detectChanges()},(0,h.w)(this)}ngOnInit(){this.resource instanceof p.q||(this.resource=this.halResourceService.createHalResource(this.resource,!0)),this.externalUploadButton&&(0,o.R)(document.querySelector(this.externalUploadButton),"click").pipe(this.untilDestroyed()).subscribe((()=>this.triggerFileInput())),this.states.forResource(this.resource).changes$().pipe(this.untilDestroyed(),(0,r.p)((e=>!!e))).subscribe((e=>{this.resource=e||this.resource})),(0,f.A)(this.resource)||this.attachmentsResourceService.requireCollection(this.attachmentsSelfLink).subscribe();const compareCreatedAtTimestamps=(e,t)=>{const n=this.timezoneService.parseDatetime(t.createdAt),i=this.timezoneService.parseDatetime(e.createdAt);return n.isBefore(i)?-1:1};this.attachments$=this.attachmentsResourceService.collection(this.collectionKey).pipe(this.untilDestroyed(),(0,s.T)((e=>e.sort(compareCreatedAtTimestamps))),(0,a.M)((e=>{(0,f.A)(this.resource)&&(this.resource.attachments={elements:e.map((e=>e._links.self))})}))),document.body.addEventListener("dragenter",this.onGlobalDragEnter),document.body.addEventListener("dragleave",this.onGlobalDragLeave),document.body.addEventListener("dragend",this.onGlobalDragEnd),document.body.addEventListener("drop",this.onGlobalDragEnd)}ngOnDestroy(){document.body.removeEventListener("dragenter",this.onGlobalDragEnter),document.body.removeEventListener("dragleave",this.onGlobalDragLeave),document.body.removeEventListener("dragend",this.onGlobalDragEnd),document.body.removeEventListener("drop",this.onGlobalDragEnd)}triggerFileInput(){this.filePicker.nativeElement.click()}onFilePickerChanged(){const e=this.filePicker.nativeElement.files;null!==e&&(this.uploadFiles(Array.from(e)),this.filePicker.nativeElement.value="")}onDropFiles(e){null!==e.dataTransfer&&(e.dataTransfer.dropEffect="copy",this.uploadFiles(Array.from(e.dataTransfer.files)),this.draggingOverDropZone=!1,this.dragging=0)}onDragOver(e){null!==e.dataTransfer&&function containsFiles(e){return e.types.indexOf("Files")>=0}(e.dataTransfer)&&(e.dataTransfer.dropEffect="copy",this.draggingOverDropZone=!0)}onDragLeave(e){this.draggingOverDropZone=!1}uploadFiles(e){let t=e||[];const n=e.length;t=this.filterFolders(t),0!==t.length?this.attachmentsResourceService.attachFiles(this.resource,t).subscribe({next:()=>{this.attachmentAdded.emit()},error:e=>this.toastService.addError(e)}):n>0&&this.toastService.addNotice(this.text.foldersWarning)}filterFolders(e){return e.filter((e=>""!==e.type||(0!==e.size||(console.warn(`Skipping file because of file size (${e.size}) %O`,e),!1))))}static{this.ɵfac=function OpAttachmentsComponent_Factory(e){return new(e||OpAttachmentsComponent)(i.rXU(i.aKT),i.rXU(c.W),i.rXU(l.D),i.rXU(g.fw),i.rXU(b.u),i.rXU(d.t),i.rXU(m._),i.rXU(_.D),i.rXU(i.gRc))}}static{this.ɵcmp=i.VBU({type:OpAttachmentsComponent,selectors:[["op-attachments"]],viewQuery:function OpAttachmentsComponent_Query(e,t){if(1&e&&i.GBs(C,5),2&e){let e;i.mGM(e=i.lsd())&&(t.filePicker=e.first)}},hostVars:3,hostBindings:function OpAttachmentsComponent_HostBindings(e,t){2&e&&(i.BMQ("data-test-selector",t.testSelector),i.AVh("op-file-section",t.className))},inputs:{resource:"resource",allowUploading:"allowUploading",destroyImmediately:"destroyImmediately",externalUploadButton:"externalUploadButton",showTimestamp:"showTimestamp"},outputs:{attachmentRemoved:"attachmentRemoved",attachmentAdded:"attachmentAdded"},features:[i.Vt3],decls:5,vars:6,consts:[["hiddenFileInput",""],[3,"ngClass","attachments","collectionKey","showTimestamp","attachmentRemoved",4,"ngIf"],["type","file","id","attachment_files","name","attachment_files","hidden","","multiple","",3,"change",4,"ngIf"],["data-test-selector","op-attachments--drop-box","type","button",3,"ngClass","click","dragover","dragleave","drop",4,"ngIf"],["class","op-file-section--actions hide-when-print",4,"ngIf"],[3,"attachmentRemoved","ngClass","attachments","collectionKey","showTimestamp"],["type","file","id","attachment_files","name","attachment_files","hidden","","multiple","",3,"change"],["data-test-selector","op-attachments--drop-box","type","button",3,"click","dragover","dragleave","drop","ngClass"],[1,"spot-icon","spot-icon_add-attachment","op-file-section--drop-box-icon"],["class","op-file-section--drop-box-text",3,"textContent",4,"ngIf"],[1,"op-file-section--drop-box-text",3,"textContent"],[1,"op-file-section--actions","hide-when-print"],["type","button","class","spot-link","data-test-selector","op-attachments--upload-button",3,"click",4,"ngIf"],["type","button","data-test-selector","op-attachments--upload-button",1,"spot-link",3,"click"],[1,"spot-icon","spot-icon_add-attachment"],[3,"textContent"]],template:function OpAttachmentsComponent_Template(e,t){1&e&&(i.DNE(0,OpAttachmentsComponent_op_attachment_list_0_Template,2,8,"op-attachment-list",1),i.nI1(1,"async"),i.DNE(2,OpAttachmentsComponent_input_2_Template,2,0,"input",2)(3,OpAttachmentsComponent_button_3_Template,7,14,"button",3)(4,OpAttachmentsComponent_div_4_Template,2,1,"div",4)),2&e&&(i.Y8G("ngIf",i.bMT(1,4,t.attachments$).length),i.R7$(2),i.Y8G("ngIf",t.allowUploading&&t.resource.canAddAttachments),i.R7$(),i.Y8G("ngIf",t.allowUploading&&t.resource.canAddAttachments),i.R7$(),i.Y8G("ngIf",t.allowUploading&&t.resource.canAddAttachments))},dependencies:[k.YU,k.bT,v.m,k.Jj],encapsulation:2,changeDetection:0})}}},6540:(e,t,n)=>{"use strict";n.d(t,{_:()=>OpenprojectAttachmentsModule});var i=n(60316),o=n(17136),r=n(66913),s=n(3544),a=n(95752),l=n(68559);class OpenprojectAttachmentsModule{static{this.ɵfac=function OpenprojectAttachmentsModule_Factory(e){return new(e||OpenprojectAttachmentsModule)}}static{this.ɵmod=l.$C({type:OpenprojectAttachmentsModule})}static{this.ɵinj=l.G2t({imports:[i.MD,o.o]})}}("undefined"==typeof ngJitMode||ngJitMode)&&l.Obh(OpenprojectAttachmentsModule,{declarations:[r.r,s.m,a.z],imports:[i.MD,o.o],exports:[s.m,r.r,a.z]})},11385:(e,t,n)=>{"use strict";n.d(t,{e:()=>AttributeHelpTextComponent});var i=n(61816),o=n(51133),r=n(37749),s=n(47418),a=n(14593),l=n(64334),c=n(68559);class AttributeHelpTextsService{constructor(e){this.apiV3Service=e,this.helpTexts=(0,s.hF)()}require(e,t){return this.load(),new Promise(((n,i)=>{this.helpTexts.valuesPromise().then((()=>n(this.find(e,t))))}))}requireById(e){return this.load(),this.helpTexts.values$().pipe((0,l.s)(1)).toPromise().then((()=>{const t=this.helpTexts.getValueOr([]);return _.find(t,(t=>t.id?.toString()===e.toString()))}))}load(){this.helpTexts.putFromPromiseIfPristine((()=>this.apiV3Service.help_texts.get().toPromise().then((e=>e.elements))))}find(e,t){const n=this.helpTexts.getValueOr([]);return _.find(n,(n=>n.scope===t&&n.attribute===e))}static{this.ɵfac=function AttributeHelpTextsService_Factory(e){return new(e||AttributeHelpTextsService)(c.KVO(a.n))}}static{this.ɵprov=c.jDH({token:AttributeHelpTextsService,factory:AttributeHelpTextsService.ɵfac,providedIn:"root"})}}var p=n(34046),d=n(60316),u=n(46765);function AttributeHelpTextComponent_div_0_span_1_Template(e,t){if(1&e&&c.nrm(0,"span",4),2&e){const e=c.XpG(2);c.Y8G("textContent",e.additionalLabel)}}function AttributeHelpTextComponent_div_0_Template(e,t){if(1&e){const e=c.RV6();c.j41(0,"div",1),c.bIt("click",(function AttributeHelpTextComponent_div_0_Template_div_click_0_listener(t){c.eBV(e);const n=c.XpG();return c.Njj(n.handleClick(t))}))("keydown.enter",(function AttributeHelpTextComponent_div_0_Template_div_keydown_enter_0_listener(t){c.eBV(e);const n=c.XpG();return c.Njj(n.handleClick(t))}))("keydown.space",(function AttributeHelpTextComponent_div_0_Template_div_keydown_space_0_listener(t){c.eBV(e);const n=c.XpG();return c.Njj(n.handleClick(t))})),c.DNE(1,AttributeHelpTextComponent_div_0_span_1_Template,1,1,"span",2),c.nrm(2,"op-icon",3),c.k0s()}if(2&e){const e=c.XpG();c.Y8G("title",e.text.open_dialog),c.BMQ("data-qa-help-text-for",e.attribute),c.R7$(),c.Y8G("ngIf",e.additionalLabel)}}class AttributeHelpTextComponent{constructor(e,t,n,i,o,s){this.elementRef=e,this.attributeHelpTexts=t,this.opModalService=n,this.cdRef=i,this.injector=o,this.I18n=s,this.exists=!1,this.text={open_dialog:this.I18n.t("js.help_texts.show_modal"),edit:this.I18n.t("js.button_edit"),close:this.I18n.t("js.button_close")},(0,r.w)(this)}ngOnInit(){this.helpTextId?this.exists=!0:this.load().then((e=>(this.exists=!!e,this.cdRef.detectChanges(),e)))}handleClick(e){this.load().then((e=>{this.opModalService.show(p.J,this.injector,{helpText:e})})),e.preventDefault()}load(){return this.helpTextId?this.attributeHelpTexts.requireById(this.helpTextId):this.attributeHelpTexts.require(this.attribute,this.attributeScope)}static{this.ɵfac=function AttributeHelpTextComponent_Factory(e){return new(e||AttributeHelpTextComponent)(c.rXU(c.aKT),c.rXU(AttributeHelpTextsService),c.rXU(o.a),c.rXU(c.gRc),c.rXU(c.zZn),c.rXU(i.W))}}static{this.ɵcmp=c.VBU({type:AttributeHelpTextComponent,selectors:[["attribute-help-text"]],inputs:{attribute:"attribute",additionalLabel:"additionalLabel",attributeScope:"attributeScope",helpTextId:"helpTextId"},decls:1,vars:1,consts:[["class","spot-link help-text--entry","role","button","tabindex","0",3,"title","click","keydown.enter","keydown.space",4,"ngIf"],["role","button","tabindex","0",1,"spot-link","help-text--entry",3,"click","keydown.enter","keydown.space","title"],[3,"textContent",4,"ngIf"],["icon-classes","icon3 icon-help1"],[3,"textContent"]],template:function AttributeHelpTextComponent_Template(e,t){1&e&&c.DNE(0,AttributeHelpTextComponent_div_0_Template,3,3,"div",0),2&e&&c.Y8G("ngIf",t.exists)},dependencies:[d.bT,u.i],encapsulation:2,changeDetection:0})}}},34046:(e,t,n)=>{"use strict";n.d(t,{J:()=>AttributeHelpTextModalComponent});var i=n(69081),o=n(51133),r=n(61816),s=n(68559),a=n(60316),l=n(66913),c=n(46765);function AttributeHelpTextModalComponent_fieldset_6_Template(e,t){if(1&e&&(s.j41(0,"fieldset",11)(1,"legend",12),s.EFF(2),s.k0s(),s.nrm(3,"op-attachments",13),s.k0s()),2&e){const e=s.XpG();s.R7$(2),s.SpI(" ",e.text.attachments," "),s.R7$(),s.Y8G("resource",e.helpText)("allowUploading",!1)}}function AttributeHelpTextModalComponent_a_11_Template(e,t){if(1&e&&(s.j41(0,"a",14),s.nrm(1,"op-icon",15)(2,"span",16),s.k0s()),2&e){const e=s.XpG();s.BMQ("href",e.helpTextLink,s.B4B)("title",e.text.edit),s.R7$(2),s.Y8G("textContent",e.text.edit)}}class AttributeHelpTextModalComponent extends i.a{constructor(e,t,n,i){super(e,n,i),this.locals=e,this.I18n=t,this.cdRef=n,this.elementRef=i,this.text={attachments:this.I18n.t("js.label_attachments"),edit:this.I18n.t("js.button_edit"),close:this.I18n.t("js.button_close")},this.helpText=this.locals.helpText}ngOnInit(){super.ngOnInit(),this.helpText.attachments.$load().then((()=>this.cdRef.detectChanges()))}get helpTextLink(){return this.helpText.editText?this.helpText.editText.$link.href:""}static{this.ɵfac=function AttributeHelpTextModalComponent_Factory(e){return new(e||AttributeHelpTextModalComponent)(s.rXU(o.Y),s.rXU(r.W),s.rXU(s.gRc),s.rXU(s.aKT))}}static{this.ɵcmp=s.VBU({type:AttributeHelpTextModalComponent,selectors:[["ng-component"]],features:[s.Vt3],decls:12,vars:5,consts:[["data-indicator-name","modal",1,"spot-modal","attribute-help-text--modal","loading-indicator--location"],["data-test-selector","attribute-help-text--header",1,"spot-modal--header"],[1,"spot-icon","spot-icon_help1"],[1,"attribute-help-text--header-text",3,"textContent"],[1,"spot-modal--body","spot-container"],[1,"op-uc-container","op-uc-container__no-permalinks",3,"innerHtml"],["class","form--fieldset",4,"ngIf"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button",1,"button","spot-action-bar--action","spot-modal--cancel-button",3,"click"],["class","help-text--edit-button button spot-action-bar--action",4,"ngIf"],[1,"form--fieldset"],[1,"form--fieldset-legend"],[3,"resource","allowUploading"],[1,"help-text--edit-button","button","spot-action-bar--action"],["icon-classes","button--icon icon-edit"],[1,"button--text",3,"textContent"]],template:function AttributeHelpTextModalComponent_Template(e,t){1&e&&(s.j41(0,"div",0)(1,"div",1),s.nrm(2,"span",2)(3,"span",3),s.k0s(),s.j41(4,"div",4),s.nrm(5,"div",5),s.DNE(6,AttributeHelpTextModalComponent_fieldset_6_Template,4,3,"fieldset",6),s.k0s(),s.j41(7,"div",7)(8,"div",8)(9,"button",9),s.bIt("click",(function AttributeHelpTextModalComponent_Template_button_click_9_listener(){return t.closeMe()})),s.EFF(10),s.k0s(),s.DNE(11,AttributeHelpTextModalComponent_a_11_Template,3,3,"a",10),s.k0s()()()),2&e&&(s.R7$(3),s.Y8G("textContent",t.helpText.attributeCaption),s.R7$(2),s.Y8G("innerHtml",t.helpText.helpText.html,s.npT),s.R7$(),s.Y8G("ngIf",t.helpText&&t.helpText.attachments.elements.length>0),s.R7$(4),s.SpI(" ",t.text.close," "),s.R7$(),s.Y8G("ngIf",t.helpText.editText))},dependencies:[a.bT,l.r,c.i],encapsulation:2,changeDetection:0})}}},72811:(e,t,n)=>{"use strict";n.d(t,{f:()=>AttributeHelpTextModule});var i=n(60316),o=n(6540),r=n(17136),s=n(21452),a=n(11385),l=n(34046),c=n(29655),p=n(66549),d=n(68559);class AttributeHelpTextModule{static{this.ɵfac=function AttributeHelpTextModule_Factory(e){return new(e||AttributeHelpTextModule)}}static{this.ɵmod=d.$C({type:AttributeHelpTextModule})}static{this.ɵinj=d.G2t({imports:[i.MD,s.p,o._,r.o]})}}("undefined"==typeof ngJitMode||ngJitMode)&&d.Obh(AttributeHelpTextModule,{declarations:[a.e,l.J,c.I,p.x],imports:[i.MD,s.p,o._,r.o],exports:[a.e,c.I]})},29655:(e,t,n)=>{"use strict";n.d(t,{I:()=>StaticAttributeHelpTextComponent});var i=n(61816),o=n(37749),r=n(51133),s=n(66549),a=n(68559);class StaticAttributeHelpTextComponent{constructor(e,t,n,i,r){this.elementRef=e,this.opModalService=t,this.cdRef=n,this.injector=i,this.I18n=r,this.className=!0,this.text={open_dialog:this.I18n.t("js.help_texts.show_modal")},(0,o.w)(this)}handleClick(e){this.opModalService.show(s.x,this.injector,{title:this.title,content:this.content}),e.preventDefault()}static{this.ɵfac=function StaticAttributeHelpTextComponent_Factory(e){return new(e||StaticAttributeHelpTextComponent)(a.rXU(a.aKT),a.rXU(r.a),a.rXU(a.gRc),a.rXU(a.zZn),a.rXU(i.W))}}static{this.ɵcmp=a.VBU({type:StaticAttributeHelpTextComponent,selectors:[["opce-static-attribute-help-text"]],hostVars:2,hostBindings:function StaticAttributeHelpTextComponent_HostBindings(e,t){2&e&&a.AVh("form--field-inline-buttons-container",t.className)},inputs:{title:"title",content:"content"},decls:2,vars:1,consts:[["role","button","tabindex","0","data-test-selector","static-attribute-help-text--icon",1,"spot-link",3,"click","keydown.enter","keydown.space","title"],[1,"spot-icon","spot-icon_help1"]],template:function StaticAttributeHelpTextComponent_Template(e,t){1&e&&(a.j41(0,"div",0),a.bIt("click",(function StaticAttributeHelpTextComponent_Template_div_click_0_listener(e){return t.handleClick(e)}))("keydown.enter",(function StaticAttributeHelpTextComponent_Template_div_keydown_enter_0_listener(e){return t.handleClick(e)}))("keydown.space",(function StaticAttributeHelpTextComponent_Template_div_keydown_space_0_listener(e){return t.handleClick(e)})),a.nrm(1,"span",1),a.k0s()),2&e&&a.Y8G("title",t.text.open_dialog)},encapsulation:2,changeDetection:0})}}},66549:(e,t,n)=>{"use strict";n.d(t,{x:()=>StaticAttributeHelpTextModalComponent});var i=n(61816),o=n(69081),r=n(51133),s=n(68559);class StaticAttributeHelpTextModalComponent extends o.a{constructor(e,t,n,i){super(e,n,i),this.locals=e,this.I18n=t,this.cdRef=n,this.elementRef=i,this.text={close:this.I18n.t("js.button_close")},this.title=this.locals.title,this.content=this.locals.content}ngOnInit(){super.ngOnInit()}static{this.ɵfac=function StaticAttributeHelpTextModalComponent_Factory(e){return new(e||StaticAttributeHelpTextModalComponent)(s.rXU(r.Y),s.rXU(i.W),s.rXU(s.gRc),s.rXU(s.aKT))}}static{this.ɵcmp=s.VBU({type:StaticAttributeHelpTextModalComponent,selectors:[["ng-component"]],features:[s.Vt3],decls:11,vars:3,consts:[["data-indicator-name","modal","data-test-selector","static-attribute-help-text--modal",1,"spot-modal"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"spot-modal--body","spot-container"],[1,"spot-body-small"],[1,"spot-action-bar","hidden-for-mobile"],[1,"spot-action-bar--right"],["type","button",1,"button","spot-action-bar--action","spot-modal--cancel-button",3,"click"]],template:function StaticAttributeHelpTextModalComponent_Template(e,t){1&e&&(s.j41(0,"div",0)(1,"div",1),s.EFF(2),s.k0s(),s.nrm(3,"div",2),s.j41(4,"div",3)(5,"span",4),s.EFF(6),s.k0s()(),s.j41(7,"div",5)(8,"div",6)(9,"button",7),s.bIt("click",(function StaticAttributeHelpTextModalComponent_Template_button_click_9_listener(){return t.closeMe()})),s.EFF(10),s.k0s()()()()),2&e&&(s.R7$(2),s.SpI(" ",t.title," "),s.R7$(4),s.JRh(t.content),s.R7$(4),s.SpI(" ",t.text.close," "))},encapsulation:2,changeDetection:0})}}},27834:(e,t,n)=>{"use strict";n.d(t,{m:()=>AutocompleteSelectDecorationComponent});var i=n(62223),o=n(46303),r=n(68559),s=n(60316),a=n(34456),l=n(51196);function AutocompleteSelectDecorationComponent_op_project_autocompleter_0_Template(e,t){if(1&e){const e=r.RV6();r.j41(0,"op-project-autocompleter",2),r.bIt("change",(function AutocompleteSelectDecorationComponent_op_project_autocompleter_0_Template_op_project_autocompleter_change_0_listener(t){r.eBV(e);const n=r.XpG();return r.Njj(n.updateProjectSelection(t))})),r.k0s()}if(2&e){const e=r.XpG();r.Y8G("model",e.currentProjectSelection)("multiple",e.multiple)("labelForId",e.labelForId)("appendTo",e.appendTo)}}function AutocompleteSelectDecorationComponent_ng_select_1_ng_template_1_Template(e,t){if(1&e&&r.EFF(0),2&e){const e=t.item;r.SpI(" ",e.label," ")}}function AutocompleteSelectDecorationComponent_ng_select_1_Template(e,t){if(1&e){const e=r.RV6();r.j41(0,"ng-select",3),r.bIt("ngModelChange",(function AutocompleteSelectDecorationComponent_ng_select_1_Template_ng_select_ngModelChange_0_listener(t){r.eBV(e);const n=r.XpG();return r.Njj(n.updateSelection(t))})),r.DNE(1,AutocompleteSelectDecorationComponent_ng_select_1_ng_template_1_Template,1,1,"ng-template",4),r.k0s()}if(2&e){const e=r.XpG();r.Y8G("items",e.options)("labelForId",e.labelForId)("multiple",e.multiple)("virtualScroll",!0)("ngModel",e.selected)("appendTo",e.appendTo)("placeholder",e.text.placeholder)}}class AutocompleteSelectDecorationComponent extends o.T{constructor(){super(...arguments),this.text={placeholder:this.I18n.t("js.placeholders.selection")}}ngOnInit(){const e=this.elementRef.nativeElement;this.multiple="true"===e.dataset.multiple,this.labelForId=e.dataset.inputId,this.key=e.dataset.key,this.appendTo=e.dataset.appendTo,this.syncInputFieldName=e.dataset.inputName,this.multiple&&(this.syncInputFieldName+="[]");const t=JSON.parse(e.dataset.options);this.setInitialSelection(t),this.isProjectField()&&this.setInitialProjectSelection(),this.multiple||(this.selected=this.selected[0]),this.options=t,e.parentElement.hidden=!1}ngAfterViewInit(){}setInitialSelection(e){this.updateSelection(e.filter((e=>e.selected)))}updateSelection(e){this.selected=e,e=_.castArray(e),this.removeCurrentSyncedFields(),e.forEach((e=>{this.createSyncedField(e.value)}))}createSyncedField(e){jQuery(this.elementRef.nativeElement).parent().append(`<input type="hidden" name="${this.syncInputFieldName||""}" value="${e}" />`)}removeCurrentSyncedFields(){jQuery(this.elementRef.nativeElement).parent().find(`input[name="${this.syncInputFieldName}"]`).remove()}updateProjectSelection(e){const t=(e=_.castArray(e)).map((e=>({label:e.name,value:e.id.toString(),selected:!0})));this.updateSelection(t)}setInitialProjectSelection(){const e=_.castArray(this.selected);0!==e.length&&(this.multiple?this.currentProjectSelection=e.map((e=>({id:e.value,name:e.label}))):this.currentProjectSelection={id:e[0].value,name:e[0].label})}isProjectField(){return"project"===this.key}static{this.ɵfac=(()=>{let e;return function AutocompleteSelectDecorationComponent_Factory(t){return(e||(e=r.xGo(AutocompleteSelectDecorationComponent)))(t||AutocompleteSelectDecorationComponent)}})()}static{this.ɵcmp=r.VBU({type:AutocompleteSelectDecorationComponent,selectors:[["autocomplete-select-decoration"]],viewQuery:function AutocompleteSelectDecorationComponent_Query(e,t){if(1&e&&r.GBs(i.vr,5),2&e){let e;r.mGM(e=r.lsd())&&(t.ngSelectComponent=e.first)}},features:[r.Vt3],decls:2,vars:2,consts:[[3,"model","multiple","labelForId","appendTo","change",4,"ngIf"],["bindLabel","label",3,"items","labelForId","multiple","virtualScroll","ngModel","appendTo","placeholder","ngModelChange",4,"ngIf"],[3,"change","model","multiple","labelForId","appendTo"],["bindLabel","label",3,"ngModelChange","items","labelForId","multiple","virtualScroll","ngModel","appendTo","placeholder"],["ng-option-tmp",""]],template:function AutocompleteSelectDecorationComponent_Template(e,t){1&e&&r.DNE(0,AutocompleteSelectDecorationComponent_op_project_autocompleter_0_Template,1,4,"op-project-autocompleter",0)(1,AutocompleteSelectDecorationComponent_ng_select_1_Template,2,7,"ng-select",1),2&e&&(r.Y8G("ngIf",t.isProjectField()),r.R7$(),r.Y8G("ngIf",!t.isProjectField()))},dependencies:[s.bT,i.vr,i.Uq,a.BC,a.vS,l.j],encapsulation:2})}}},10402:(e,t,n)=>{"use strict";n.d(t,{I:()=>OpAutocompleterFooterTemplateDirective});var i=n(68559);class OpAutocompleterFooterTemplateDirective{static{this.ɵfac=function OpAutocompleterFooterTemplateDirective_Factory(e){return new(e||OpAutocompleterFooterTemplateDirective)}}static{this.ɵdir=i.FsC({type:OpAutocompleterFooterTemplateDirective,selectors:[["","op-autocompleter-footer-tmp",""]]})}}},89120:(e,t,n)=>{"use strict";n.d(t,{I:()=>CreateAutocompleterComponent});var i=n(24398),o=n(68559),r=n(62223),s=n(61816),a=n(86866),l=n(73014),c=(n(27514),n(99496)),p=n(1758),d=n(55596),u=n(11439),h=n(60316),m=n(34456);const _c0=e=>({"padding-left.px":e});function CreateAutocompleterComponent_ng_template_2_Template(e,t){if(1&e&&(o.nrm(0,"b",4),o.EFF(1)),2&e){const e=t.searchTerm,n=o.XpG();o.Y8G("textContent",n.text.add_new_action),o.R7$(),o.SpI(": ",e," ")}}function CreateAutocompleterComponent_ng_template_3_Template(e,t){if(1&e&&o.nrm(0,"span",5),2&e){const e=t.item,n=t.searchTerm;o.Y8G("ngOptionHighlight",n)("textContent",e.name)("ngStyle",o.eq3(3,_c0,16*e.depth))}}class CreateAutocompleterComponent extends c.p{constructor(e){super(),this.injector=e,this.required=!1,this.disabled=!1,this.finishedLoading=!1,this.id="",this.classes="",this.hideSelected=!1,this.onChange=new o.bkB,this.onKeydown=new o.bkB,this.onOpen=new o.bkB,this.onClose=new o.bkB,this.onAfterViewInit=new o.bkB,this.onAddNew=new o.bkB,this.compareByHref=d.Mz,this.text={},this.createAllowed=!1,this._openDirectly=!1,this.text.add_new_action=this.I18n.t("js.label_create")}ngAfterViewInit(){this.onAfterViewInit.emit(this)}openSelect(){this.ngSelectComponent&&(this.ngSelectComponent.open(),this.openDirectly=!1)}closeSelect(){this.ngSelectComponent&&this.ngSelectComponent.close()}changeModel(e){this.onChange.emit(e)}opened(){(0,u.Z)(this.ngSelectComponent),this.onOpen.emit()}closed(){this.openDirectly=!1,this.onClose.emit()}keyPressed(e){this.onKeydown.emit(e)}get openDirectly(){return this._openDirectly}set openDirectly(e){this._openDirectly=e,e&&this.openSelect()}focusInputField(){this.ngSelectComponent&&this.ngSelectComponent.focus()}static{this.ɵfac=function CreateAutocompleterComponent_Factory(e){return new(e||CreateAutocompleterComponent)(o.rXU(o.zZn))}}static{this.ɵcmp=o.VBU({type:CreateAutocompleterComponent,selectors:[["create-autocompleter"]],viewQuery:function CreateAutocompleterComponent_Query(e,t){if(1&e&&o.GBs(r.vr,5),2&e){let e;o.mGM(e=o.lsd())&&(t.ngSelectComponent=e.first)}},inputs:{availableValues:"availableValues",appendTo:"appendTo",resource:"resource",model:"model",required:"required",disabled:"disabled",finishedLoading:"finishedLoading",id:"id",classes:"classes",typeahead:"typeahead",hideSelected:"hideSelected"},outputs:{onChange:"onChange",onKeydown:"onKeydown",onOpen:"onOpen",onClose:"onClose",onAfterViewInit:"onAfterViewInit",onAddNew:"onAddNew"},features:[o.Vt3],decls:4,vars:15,consts:[["ngSelectComponent",""],["bindLabel","name",3,"ngModelChange","change","open","close","keydown","ngModel","items","ngClass","addTag","virtualScroll","required","clearable","disabled","typeahead","clearOnBackspace","clearSearchOnAdd","appendTo","hideSelected","compareWith","id"],["ng-tag-tmp",""],["ng-option-tmp",""],[3,"textContent"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight","textContent","ngStyle"]],template:function CreateAutocompleterComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"ng-select",1,0),o.mxI("ngModelChange",(function CreateAutocompleterComponent_Template_ng_select_ngModelChange_0_listener(n){return o.eBV(e),o.DH7(t.model,n)||(t.model=n),o.Njj(n)})),o.bIt("change",(function CreateAutocompleterComponent_Template_ng_select_change_0_listener(n){return o.eBV(e),o.Njj(t.changeModel(n))}))("open",(function CreateAutocompleterComponent_Template_ng_select_open_0_listener(){return o.eBV(e),o.Njj(t.opened())}))("close",(function CreateAutocompleterComponent_Template_ng_select_close_0_listener(){return o.eBV(e),o.Njj(t.closed())}))("keydown",(function CreateAutocompleterComponent_Template_ng_select_keydown_0_listener(n){return o.eBV(e),o.Njj(t.keyPressed(n))})),o.DNE(2,CreateAutocompleterComponent_ng_template_2_Template,2,2,"ng-template",2)(3,CreateAutocompleterComponent_ng_template_3_Template,1,5,"ng-template",3),o.k0s()}2&e&&(o.R50("ngModel",t.model),o.Y8G("items",t.availableValues)("ngClass",t.classes)("addTag",t.createAllowed)("virtualScroll",!0)("required",t.required)("clearable",!t.required)("disabled",t.disabled)("typeahead",t.typeahead)("clearOnBackspace",!1)("clearSearchOnAdd",!1)("appendTo",t.appendTo)("hideSelected",t.hideSelected)("compareWith",t.compareByHref)("id",t.id))},dependencies:[h.YU,h.B3,r.vr,r.Uq,r.BW,m.BC,m.YS,m.vS],styles:[".button.-tiny[_ngcontent-%COMP%]{margin:0}"]})}}(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",s.W)],CreateAutocompleterComponent.prototype,"I18n",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",o.gRc)],CreateAutocompleterComponent.prototype,"cdRef",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",a.c)],CreateAutocompleterComponent.prototype,"currentProject",void 0),(0,i.Cg)([(0,p.O)(),(0,i.Sn)("design:type",l.B)],CreateAutocompleterComponent.prototype,"pathHelper",void 0)},66094:(e,t,n)=>{"use strict";n.d(t,{L:()=>DraggableAutocompleteComponent});var i=n(68559),o=n(61816),r=n(36831),s=n(99496),a=n(22989),l=n(11439),c=n(85058),p=n(37749),d=n(63617),u=n(46147),h=n(60316),m=n(62223);const g=["ngSelectComponent"],_=["input"];function DraggableAutocompleteComponent_span_6_Template(e,t){if(1&e&&i.nrm(0,"span",12),2&e){const e=i.XpG();i.Y8G("textContent",e.inputCaption)}}function DraggableAutocompleteComponent_div_11_a_2_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"a",16),i.bIt("click",(function DraggableAutocompleteComponent_div_11_a_2_Template_a_click_0_listener(){i.eBV(e);const t=i.XpG().$implicit,n=i.XpG();return i.Njj(n.remove(t))})),i.k0s()}}function DraggableAutocompleteComponent_div_11_Template(e,t){if(1&e&&(i.j41(0,"div",13),i.nrm(1,"span",14),i.DNE(2,DraggableAutocompleteComponent_div_11_a_2_Template,1,0,"a",15),i.k0s()),2&e){const e=t.$implicit,n=i.XpG();i.R7$(),i.Y8G("textContent",e.name),i.R7$(),i.Y8G("ngIf",n.isRemovable(e))}}function DraggableAutocompleteComponent_span_12_Template(e,t){if(1&e&&(i.j41(0,"span"),i.nrm(1,"input",17),i.k0s()),2&e){const e=i.XpG();i.R7$(),i.Y8G("name",e.name)("value",e.hiddenValue)}}function DraggableAutocompleteComponent_span_13_input_1_Template(e,t){if(1&e&&i.nrm(0,"input",17),2&e){const e=t.$implicit,n=i.XpG(2);i.Y8G("name",n.name)("value",e)}}function DraggableAutocompleteComponent_span_13_Template(e,t){if(1&e&&(i.j41(0,"span"),i.DNE(1,DraggableAutocompleteComponent_span_13_input_1_Template,1,2,"input",18),i.k0s()),2&e){const e=i.XpG();i.R7$(),i.Y8G("ngForOf",e.hiddenValues)}}class DraggableAutocompleteComponent extends s.p{constructor(e,t,n,o){super(),this.I18n=e,this.elementRef=t,this.dragula=n,this.alternativeSearchService=o,this.selected=[],this.protected=[],this.autofocus=!0,this.name="",this.id=this.name,this.inputLabel="",this.inputPlaceholder="",this.inputCaption="",this.dragAreaLabel="",this.dragAreaName="columns",this.appendToComponent=!1,this.formControlId="op-draggable-autocomplete-container",this.onChange=new i.bkB,this.availableOptions=[],this.appendTo="body",this.searchFunction=(e,t)=>this.alternativeSearchService.searchFunction(e,t)}ngOnInit(){(0,p.w)(this),this.dragula.destroy(this.dragAreaName),this.updateAvailableOptions(),this.columnsGroup=this.dragula.createGroup(this.dragAreaName,{mirrorContainer:this.appendToComponent?document.getElementById(this.formControlId):document.body}),this.dragula.drag(this.dragAreaName).pipe(this.untilDestroyed()).subscribe((()=>(0,a.r)("move","important"))),(0,d.h)(this.dragula.drop(this.dragAreaName),this.dragula.cancel(this.dragAreaName)).pipe(this.untilDestroyed()).subscribe((()=>(0,a.r)("auto")));const e=this;this.autoscroll=new r.A([document.getElementById("content-body")],{margin:25,maxSpeed:10,scrollWhenOutside:!0,autoScroll(){return this.down&&e.columnsGroup.drake.dragging}}),this.appendTo=this.appendToComponent?`#${this.formControlId}`:"body"}ngAfterViewInit(){this.autofocus&&this.ngSelectComponent.focus();const e=this.ngSelectComponent.element.querySelector("input");e&&(e.id=this.id)}ngOnDestroy(){super.ngOnDestroy(),this.dragula.destroy(this.dragAreaName)}select(e){e&&(this.selectedOptions=[...this.selectedOptions,e],this.ngSelectComponent.clearModel())}remove(e){this.selectedOptions=this.selectedOptions.filter((t=>t.id!==e.id))}isRemovable(e){return!this.protected.find((t=>t.id===e.id))}get selectedOptions(){return this.selected}set selectedOptions(e){this.selected=e,this.updateAvailableOptions(),this.onChange.emit(this.selectedOptions)}get hiddenValue(){return this.selectedOptions.map((e=>e.id)).join(" ")}get hiddenValues(){return this.selectedOptions.map((e=>e.id))}get isArrayOfValues(){return this.name.endsWith("[]")}opened(){(0,l.Z)(this.ngSelectComponent)}updateAvailableOptions(){this.availableOptions=this.options.filter((e=>!this.selectedOptions.find((t=>t.id===e.id))))}static{this.ɵfac=function DraggableAutocompleteComponent_Factory(e){return new(e||DraggableAutocompleteComponent)(i.rXU(o.W),i.rXU(i.aKT),i.rXU(u.g$),i.rXU(c.n))}}static{this.ɵcmp=i.VBU({type:DraggableAutocompleteComponent,selectors:[["op-draggable-autocompleter"]],viewQuery:function DraggableAutocompleteComponent_Query(e,t){if(1&e&&(i.GBs(g,5),i.GBs(_,5)),2&e){let e;i.mGM(e=i.lsd())&&(t.ngSelectComponent=e.first),i.mGM(e=i.lsd())&&(t.inputElement=e.first)}},inputs:{options:"options",selected:"selected",protected:"protected",autofocus:"autofocus",name:"name",id:"id",inputLabel:"inputLabel",inputPlaceholder:"inputPlaceholder",inputCaption:"inputCaption",dragAreaLabel:"dragAreaLabel",dragAreaName:"dragAreaName",appendToComponent:"appendToComponent",formControlId:"formControlId"},outputs:{onChange:"onChange"},features:[i.Vt3],decls:14,vars:17,consts:[["ngSelectComponent",""],[1,"op-draggable-autocomplete"],[1,"FormControl-spacingWrapper","mb-3"],[1,"FormControl","width-full","op-draggable-autocomplete-container",3,"id"],[1,"FormControl-label",3,"textContent"],["ngClass","op-draggable-autocomplete--input ng-select--primerized","bindLabel","name",3,"open","change","items","multiple","virtualScroll","placeholder","clearSearchOnAdd","closeOnSelect","searchFn","appendTo"],["class","FormControl-caption",3,"textContent",4,"ngIf"],[1,"FormControl-spacingWrapper"],[1,"FormControl","width-full"],["dragula","columns",1,"op-draggable-autocomplete--selected",3,"dragulaModelChange","dragulaModel"],["class","op-draggable-autocomplete--item",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"FormControl-caption",3,"textContent"],[1,"op-draggable-autocomplete--item"],[1,"op-draggable-autocomplete--item-text",3,"textContent"],["class","op-draggable-autocomplete--remove-item icon-remove",3,"click",4,"ngIf"],[1,"op-draggable-autocomplete--remove-item","icon-remove",3,"click"],["type","hidden",3,"name","value"],["type","hidden",3,"name","value",4,"ngFor","ngForOf"]],template:function DraggableAutocompleteComponent_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",1)(1,"div",2)(2,"div",3),i.nrm(3,"label",4),i.j41(4,"ng-select",5,0),i.bIt("open",(function DraggableAutocompleteComponent_Template_ng_select_open_4_listener(){return i.eBV(e),i.Njj(t.opened())}))("change",(function DraggableAutocompleteComponent_Template_ng_select_change_4_listener(n){return i.eBV(e),i.Njj(t.select(n))})),i.k0s(),i.DNE(6,DraggableAutocompleteComponent_span_6_Template,1,1,"span",6),i.k0s()(),i.j41(7,"div",7)(8,"div",8),i.nrm(9,"label",4),i.j41(10,"div",9),i.mxI("dragulaModelChange",(function DraggableAutocompleteComponent_Template_div_dragulaModelChange_10_listener(n){return i.eBV(e),i.DH7(t.selectedOptions,n)||(t.selectedOptions=n),i.Njj(n)})),i.DNE(11,DraggableAutocompleteComponent_div_11_Template,3,2,"div",10)(12,DraggableAutocompleteComponent_span_12_Template,2,2,"span",11)(13,DraggableAutocompleteComponent_span_13_Template,2,1,"span",11),i.k0s()()()()}2&e&&(i.R7$(2),i.Y8G("id",t.formControlId),i.R7$(),i.Y8G("textContent",t.inputLabel),i.BMQ("for",t.id),i.R7$(),i.Y8G("items",t.availableOptions)("multiple",!1)("virtualScroll",!0)("placeholder",t.inputPlaceholder)("clearSearchOnAdd",!0)("closeOnSelect",!0)("searchFn",t.searchFunction)("appendTo",t.appendTo),i.R7$(2),i.Y8G("ngIf",t.inputCaption),i.R7$(3),i.Y8G("textContent",t.dragAreaLabel),i.R7$(),i.R50("dragulaModel",t.selectedOptions),i.R7$(),i.Y8G("ngForOf",t.selectedOptions),i.R7$(),i.Y8G("ngIf",!t.isArrayOfValues),i.R7$(),i.Y8G("ngIf",t.isArrayOfValues))},dependencies:[h.YU,h.Sq,h.bT,m.vr,u.Am],styles:[".op-draggable-autocomplete--selected[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;padding-bottom:1rem}.op-draggable-autocomplete--item[_ngcontent-%COMP%]{padding:5px;margin-right:5px;margin-bottom:5px;min-width:50px;border:1px solid var(--borderColor-default);background:var(--button-default-bgColor-rest);cursor:move;display:flex;align-items:center;justify-content:space-between}.op-draggable-autocomplete--remove-item[_ngcontent-%COMP%]{font-size:8px;color:#999;padding-left:5px;cursor:pointer}.op-draggable-autocomplete-container[_ngcontent-%COMP%], #op-draggable-autocomplete-container[_ngcontent-%COMP%]{position:relative}"],changeDetection:0})}}},11439:(e,t,n)=>{"use strict";function repositionDropdownBugfix(e){const t=e;t?.appendTo&&t?.dropdownPanel&&setTimeout((()=>{t.dropdownPanel?._updateXPosition(),t.dropdownPanel?._updateYPosition()}),25)}n.d(t,{Z:()=>repositionDropdownBugfix})},22444:(e,t,n)=>{"use strict";n.d(t,{O:()=>OpAutocompleterHeaderTemplateDirective});var i=n(68559);class OpAutocompleterHeaderTemplateDirective{static{this.ɵfac=function OpAutocompleterHeaderTemplateDirective_Factory(e){return new(e||OpAutocompleterHeaderTemplateDirective)}}static{this.ɵdir=i.FsC({type:OpAutocompleterHeaderTemplateDirective,selectors:[["","op-autocompleter-header-tmp",""]]})}}},32829:(e,t,n)=>{"use strict";n.d(t,{n:()=>OpAutocompleterLabelTemplateDirective});var i=n(68559);class OpAutocompleterLabelTemplateDirective{static{this.ɵfac=function OpAutocompleterLabelTemplateDirective_Factory(e){return new(e||OpAutocompleterLabelTemplateDirective)}}static{this.ɵdir=i.FsC({type:OpAutocompleterLabelTemplateDirective,selectors:[["","op-autocompleter-label-tmp",""]]})}}},11528:(e,t,n)=>{"use strict";n.d(t,{Q:()=>OpAutocompleterOptionTemplateDirective});var i=n(68559);class OpAutocompleterOptionTemplateDirective{static{this.ɵfac=function OpAutocompleterOptionTemplateDirective_Factory(e){return new(e||OpAutocompleterOptionTemplateDirective)}}static{this.ɵdir=i.FsC({type:OpAutocompleterOptionTemplateDirective,selectors:[["","op-autocompleter-option-tmp",""]]})}}},46303:(e,t,n)=>{"use strict";n.d(t,{T:()=>OpAutocompleterComponent});var i=n(68559),o=n(75797),r=n(84205),s=n(63617),a=n(59452),l=n(79439),c=n(14876),p=n(51567),d=n(91817),u=n(98764),h=n(9114),m=n(36647),g=n(70271),_=n(46116),f=n(99496),b=n(61816),k=n(10402),v=n(89282),C=n(14593),y=n(61873);class OpAutocompleterService extends f.p{constructor(e){super(),this.apiV3Service=e}loadAvailable(e,t,n,i){const o=this.createFilters(n??[],e,i),r=this.createParams(t);return this.apiV3Service[t].filtered(o,r).get().pipe((0,g.T)((e=>e.elements)))}loadValue(e,t,n){if(n){const n=e.map((e=>this.loadSingleValue(e,t)));return(0,y.p)(n)}return this.loadSingleValue(e,t)}loadSingleValue(e,t){return this.apiV3Service[t].id(e).get()}createParams(e){return"work_packages"===e?{sortBy:'[["updatedAt","desc"]]'}:{}}createFilters(e,t,n){const i=new v.hG;for(const t of e)i.add(t.name,t.operator,t.values);return t&&i.add(n??"","**",[t]),i}loadData(e,t,n,i){return this.loadAvailable(e,t,n,i)}static{this.ɵfac=function OpAutocompleterService_Factory(e){return new(e||OpAutocompleterService)(i.KVO(C.n))}}static{this.ɵprov=i.jDH({token:OpAutocompleterService,factory:OpAutocompleterService.ɵfac})}}var w=n(22444),T=n(32829),S=n(11528),j=n(11439),P=n(37749),I=n(34456),x=n(36178),R=n(68365),F=n(30501),M=n(60316),O=n(62223),D=n(48377);const G=["ngSelectInstance"],E=["syncedInput"],_c2=(e,t,n)=>({$implicit:e,search:t,index:n}),_c3=(e,t,n,i)=>({$implicit:e,search:t,index:n,clear:i}),_c4=e=>({"padding-left.px":e});function OpAutocompleterComponent_input_1_Template(e,t){if(1&e&&i.nrm(0,"input",10,3),2&e){const e=i.XpG();i.BMQ("name",e.inputName)("data-action",e.hiddenFieldAction)}}function OpAutocompleterComponent_ng_container_2_input_1_Template(e,t){if(1&e&&i.nrm(0,"input",12),2&e){const e=t.$implicit,n=i.XpG(2);i.Y8G("value",e),i.BMQ("name",n.inputName+"[]")("data-action",n.hiddenFieldAction)}}function OpAutocompleterComponent_ng_container_2_Template(e,t){if(1&e&&(i.qex(0),i.DNE(1,OpAutocompleterComponent_ng_container_2_input_1_Template,1,3,"input",11),i.bVm()),2&e){const e=i.XpG();i.R7$(),i.Y8G("ngForOf",e.mappedInputValue)}}function OpAutocompleterComponent_7_ng_template_0_Template(e,t){if(1&e&&i.eu8(0,14),2&e){const e=t.item,n=t.index,o=t.searchTerm,r=i.XpG(2);i.Y8G("ngTemplateOutlet",r.headerTemplate||r.projectedHeaderTemplate)("ngTemplateOutletContext",i.sMw(2,_c2,e,o,n))}}function OpAutocompleterComponent_7_Template(e,t){1&e&&i.DNE(0,OpAutocompleterComponent_7_ng_template_0_Template,1,6,"ng-template",13)}function OpAutocompleterComponent_8_ng_template_0_Template(e,t){if(1&e&&i.eu8(0,14),2&e){const e=t.item,n=t.index,o=t.searchTerm,r=t.clear,s=i.XpG(2),a=i.sdS(14);i.Y8G("ngTemplateOutlet",s.projectedLabelTemplate||s.labelTemplate||a)("ngTemplateOutletContext",i.ziG(2,_c3,e,o,n,r))}}function OpAutocompleterComponent_8_Template(e,t){1&e&&i.DNE(0,OpAutocompleterComponent_8_ng_template_0_Template,1,7,"ng-template",15)}function OpAutocompleterComponent_ng_template_9_Template(e,t){if(1&e&&i.eu8(0,14),2&e){const e=t.item,n=t.index,o=t.searchTerm,r=i.XpG(),s=i.sdS(12);i.Y8G("ngTemplateOutlet",r.projectedOptionTemplate||r.optionTemplate||s)("ngTemplateOutletContext",i.sMw(2,_c2,e,o,n))}}function OpAutocompleterComponent_10_ng_template_0_Template(e,t){if(1&e&&i.eu8(0,14),2&e){const e=t.item,n=t.index,o=t.searchTerm,r=i.XpG(2);i.Y8G("ngTemplateOutlet",r.footerTemplate||r.projectedFooterTemplate)("ngTemplateOutletContext",i.sMw(2,_c2,e,o,n))}}function OpAutocompleterComponent_10_Template(e,t){1&e&&i.DNE(0,OpAutocompleterComponent_10_ng_template_0_Template,1,6,"ng-template",16)}function OpAutocompleterComponent_ng_template_11_ng_container_0_Template(e,t){if(1&e&&(i.qex(0),i.nrm(1,"span",18),i.bVm()),2&e){const e=i.XpG(),t=e.$implicit,n=e.search;i.R7$(),i.Y8G("ngOptionHighlight",n)("textContent",t.name)("ngStyle",i.eq3(3,_c4,16*t.depth))}}function OpAutocompleterComponent_ng_template_11_ng_container_1_op_principal_2_Template(e,t){if(1&e&&i.nrm(0,"op-principal",28),2&e){const e=i.XpG(2).$implicit;i.Y8G("principal",e.author)("hideName",!0)}}function OpAutocompleterComponent_ng_template_11_ng_container_1_span_4_Template(e,t){if(1&e&&i.nrm(0,"span",29),2&e){const e=i.XpG(2).$implicit,t=i.XpG();i.Mz_("textContent","",e.type.name," "),i.Y8G("ngClass",t.highlighting("type",e.type.id))}}function OpAutocompleterComponent_ng_template_11_ng_container_1_Template(e,t){if(1&e&&(i.qex(0),i.j41(1,"div",19),i.DNE(2,OpAutocompleterComponent_ng_template_11_ng_container_1_op_principal_2_Template,1,2,"op-principal",20),i.j41(3,"span",21),i.DNE(4,OpAutocompleterComponent_ng_template_11_ng_container_1_span_4_Template,1,3,"span",22),i.nrm(5,"span",23),i.k0s(),i.j41(6,"div",24),i.nrm(7,"span",25),i.j41(8,"span",26),i.EFF(9),i.k0s(),i.nrm(10,"span",27),i.k0s()(),i.bVm()),2&e){const e=i.XpG(),t=e.$implicit,n=e.search,o=i.XpG();i.R7$(2),i.Y8G("ngIf",t.author&&t.author.href),i.R7$(2),i.Y8G("ngIf",t.type),i.R7$(),i.Y8G("ngOptionHighlight",n)("textContent",t.subject),i.R7$(2),i.Y8G("ngOptionHighlight",n)("textContent",null==t.project?null:t.project.name),i.R7$(),i.Y8G("ngOptionHighlight",n),i.R7$(),i.SpI("#",t.id,""),i.R7$(),i.Y8G("textContent",null==t.status?null:t.status.name)("ngClass",o.highlighting("status",null==t.status?null:t.status.id))}}function OpAutocompleterComponent_ng_template_11_ng_container_2_op_principal_1_Template(e,t){if(1&e&&i.nrm(0,"op-principal",33),2&e){const e=i.XpG(2).$implicit;i.Y8G("principal",e)("hideName",!0)}}function OpAutocompleterComponent_ng_template_11_ng_container_2_span_4_Template(e,t){if(1&e&&(i.j41(0,"span",34),i.EFF(1),i.k0s()),2&e){const e=i.XpG(2),t=e.$implicit,n=e.search;i.Y8G("ngOptionHighlight",n),i.R7$(),i.JRh(t.email)}}function OpAutocompleterComponent_ng_template_11_ng_container_2_Template(e,t){if(1&e&&(i.qex(0),i.DNE(1,OpAutocompleterComponent_ng_template_11_ng_container_2_op_principal_1_Template,1,2,"op-principal",30),i.j41(2,"span",31),i.EFF(3),i.k0s(),i.DNE(4,OpAutocompleterComponent_ng_template_11_ng_container_2_span_4_Template,2,2,"span",32),i.bVm()),2&e){const e=i.XpG(),t=e.$implicit,n=e.search;i.R7$(),i.Y8G("ngIf",t&&t.href),i.R7$(),i.Y8G("ngOptionHighlight",n),i.R7$(),i.JRh(t.name),i.R7$(),i.Y8G("ngIf",t.email)}}function OpAutocompleterComponent_ng_template_11_ng_container_3_span_3_Template(e,t){if(1&e&&(i.j41(0,"span",34),i.EFF(1),i.k0s()),2&e){const e=i.XpG(2),t=e.$implicit,n=e.search;i.Y8G("ngOptionHighlight",n),i.R7$(),i.JRh(t.email)}}function OpAutocompleterComponent_ng_template_11_ng_container_3_Template(e,t){if(1&e&&(i.qex(0),i.j41(1,"span",31),i.EFF(2),i.k0s(),i.DNE(3,OpAutocompleterComponent_ng_template_11_ng_container_3_span_3_Template,2,2,"span",32),i.bVm()),2&e){const e=i.XpG(),t=e.$implicit,n=e.search;i.R7$(),i.Y8G("ngOptionHighlight",n),i.R7$(),i.JRh(t.name),i.R7$(),i.Y8G("ngIf",t.email)}}function OpAutocompleterComponent_ng_template_11_Template(e,t){if(1&e&&i.DNE(0,OpAutocompleterComponent_ng_template_11_ng_container_0_Template,2,5,"ng-container",17)(1,OpAutocompleterComponent_ng_template_11_ng_container_1_Template,11,10,"ng-container",17)(2,OpAutocompleterComponent_ng_template_11_ng_container_2_Template,5,4,"ng-container",17)(3,OpAutocompleterComponent_ng_template_11_ng_container_3_Template,4,3,"ng-container",17),2&e){const e=t.$implicit,n=i.XpG();i.Y8G("ngSwitchCase",!n.resource&&!!e.depth),i.R7$(),i.Y8G("ngSwitchCase","work_packages"===n.resource||"parent-child"===n.resource),i.R7$(),i.Y8G("ngSwitchCase","users"===n.resource||"assignee"===n.resource||"principals"===n.resource),i.R7$(),i.Y8G("ngSwitchCase","subproject"===n.resource||"version"===n.resource||"status"===n.resource||"default"===n.resource||!n.resource&&!e.depth)}}function OpAutocompleterComponent_ng_template_13_ng_container_0_span_3_Template(e,t){if(1&e&&(i.j41(0,"span",37),i.EFF(1),i.k0s()),2&e){const e=i.XpG(2),t=e.$implicit,n=e.search;i.Y8G("ngOptionHighlight",n),i.R7$(),i.E5c(" ",null==t.type?null:t.type.name," #",t.id," ",t.subject||t.name," ")}}function OpAutocompleterComponent_ng_template_13_ng_container_0_Template(e,t){if(1&e){const e=i.RV6();i.qex(0),i.j41(1,"span",35),i.bIt("click",(function OpAutocompleterComponent_ng_template_13_ng_container_0_Template_span_click_1_listener(){i.eBV(e);const t=i.XpG(),n=t.$implicit,o=t.clear;return i.Njj(o(n))})),i.EFF(2,"×"),i.k0s(),i.DNE(3,OpAutocompleterComponent_ng_template_13_ng_container_0_span_3_Template,2,4,"span",36),i.bVm()}if(2&e){const e=i.XpG().$implicit;i.R7$(3),i.Y8G("ngIf",e.id)}}function OpAutocompleterComponent_ng_template_13_ng_container_1_Template(e,t){if(1&e){const e=i.RV6();i.qex(0),i.j41(1,"span",35),i.bIt("click",(function OpAutocompleterComponent_ng_template_13_ng_container_1_Template_span_click_1_listener(){i.eBV(e);const t=i.XpG(),n=t.$implicit,o=t.clear;return i.Njj(o(n))})),i.EFF(2,"×"),i.k0s(),i.j41(3,"span",37),i.EFF(4),i.k0s(),i.bVm()}if(2&e){const e=i.XpG(),t=e.$implicit,n=e.search;i.R7$(3),i.Y8G("ngOptionHighlight",n),i.R7$(),i.JRh(t.name)}}function OpAutocompleterComponent_ng_template_13_Template(e,t){if(1&e&&i.DNE(0,OpAutocompleterComponent_ng_template_13_ng_container_0_Template,4,1,"ng-container",6)(1,OpAutocompleterComponent_ng_template_13_ng_container_1_Template,5,2,"ng-container",6),2&e){const e=i.XpG();i.Y8G("ngIf","work_packages"===e.resource),i.R7$(),i.Y8G("ngIf","work_packages"!==e.resource)}}class OpAutocompleterComponent extends f.p{set addTag(e){this._addTag=!0===e?this.addNewObjectFn.bind(this):e,this.cdRef.detectChanges()}get addTag(){return this._addTag}constructor(e,t,n,s,a,l,c,p,d){super(),this.injector=e,this.elementRef=t,this.http=n,this.apiV3Service=s,this.cdRef=a,this.ngZone=l,this.vcRef=c,this.I18n=p,this.halResourceService=d,this.className=!0,this.filters=[],this.searchKey="",this.defaultData=!1,this.focusDirectly=!0,this.fetchDataDirectly=!1,this.labelRequired=!0,this.multipleAsSeparateInputs=!0,this.inputBindValue="id",this.hiddenFieldAction="",this.required=!1,this.searchable=!0,this.clearable=!0,this._addTag=!1,this.id="",this.items$=new o.t(null),this.clearSearchOnAdd=!0,this.multiple=!1,this.openDirectly=!1,this.markFirst=!0,this.placeholder=this.I18n.t("js.autocompleter.placeholder"),this.notFoundText=this.I18n.t("js.autocompleter.notFoundText"),this.loadingText=this.I18n.t("js.ajax.loading"),this.dropdownPosition="auto",this.closeOnSelect=!0,this.hideSelected=!1,this.selectOnTab=!1,this.openOnEnter=!0,this.bufferAmount=4,this.virtualScroll=!0,this.selectableGroup=!1,this.selectableGroupAsModel=!0,this.trackByFn=this.defaultTrackByFunction(),this.compareWith=this.defaultCompareWithFunction(),this.clearOnBackspace=!0,this.inputAttrs={},this.readonly=!1,this.searchWhileComposing=!0,this.minTermLength=0,this.editableSearchTerm=!1,this.keyDownFn=()=>!0,this.typeahead=null,this.resetOnChange=!1,this.relations=!1,this.open=new i.bkB,this.close=new i.bkB,this.cancel=new i.bkB,this.change=new i.bkB,this.focus=new i.bkB,this.blur=new i.bkB,this.search=new i.bkB,this.keydown=new i.bkB,this.clear=new i.bkB,this.add=new i.bkB,this.remove=new i.bkB,this.scroll=new i.bkB,this.scrollToEnd=new i.bkB,this.loading$=new r.B,this.initialDebounce=!0,this.opAutocompleterService=new OpAutocompleterService(this.apiV3Service),this.onChange=e=>{},this.onTouched=e=>{}}ngOnInit(){(0,P.w)(this),(this.getOptionsFn||this.defaultData)&&(this.typeahead=new o.t("")),this.inputValue&&!this.model&&this.opAutocompleterService.loadValue(this.inputValue,this.resource,this.multiple).subscribe((e=>{this.model=e,this.syncHiddenField(this.mappedInputValue),this.cdRef.detectChanges()}))}ngOnChanges(e){e.items&&this.items$.next(e.items.currentValue)}ngAfterViewInit(){this.inputName&&this.model&&this.syncHiddenField(this.mappedInputValue),this.ngZone.runOutsideAngular((()=>{setTimeout((()=>{this.results$=(0,s.h)(this.items$,this.autocompleteInputStream()),this.fetchDataDirectly&&this.typeahead?.next(""),this.openDirectly?(this.ngSelectInstance.open(),this.ngSelectInstance.focus()):this.focusDirectly&&this.ngSelectInstance.focus()}),25)}))}get mappedInputValue(){return this.model?Array.isArray(this.model)?this.model.map((e=>e[this.inputBindValue])):this.model[this.inputBindValue]:""}repositionDropdown(){(0,j.Z)(this.ngSelectInstance)}opened(){this.repositionDropdown(),this.open.emit()}getOptionsItems(e){return(0,a.of)(this.items?.filter((t=>t.name.includes(e))))}closeSelect(){this.ngSelectInstance?.close()}openSelect(){this.ngSelectInstance?.open()}focusSelect(){this.ngZone.runOutsideAngular((()=>{setTimeout((()=>{this.ngSelectInstance.focus()}),25)}))}closed(){this.close.emit()}changed(e){this.writeValue(e),this.onTouched(e),this.onChange(e),this.syncHiddenField(this.mappedInputValue),this.change.emit(e),this.resetOnChange&&this.ngSelectInstance.clearModel(),this.cdRef.detectChanges()}searched(e){this.search.emit(e)}blured(e){this.blur.emit(e)}focused(e){this.focus.emit(e)}cleared(e){this.clear.emit(e)}keydowned(e){this.keydown.emit(e)}added(e){this.add.emit(e)}canceled(e){this.cancel.emit(e)}removed(e){this.remove.emit(e)}scrolled(e){this.scroll.emit(e)}scrolledToEnd(e){this.scrollToEnd.emit(e)}highlighting(e,t){return _.H.inlineClass(e,t)}autocompleteInputStream(){return this.typeahead?this.typeahead.pipe((0,p.p)((()=>!(!this.defaultData&&!this.getOptionsFn))),(0,d.F)(),(0,u.M)((()=>this.loading$.next(!0))),(0,h.s)((()=>(0,c.O)(this.getDebounceTimeout()))),(0,m.n)((e=>this.relations&&this.url?this.fetchFromUrl(e):this.defaultData?this.opAutocompleterService.loadData(e,this.resource,this.filters,this.searchKey):this.getOptionsFn?this.getOptionsFn(e):l.t)),(0,u.M)((()=>this.loading$.next(!1)),(()=>this.loading$.next(!1)))):l.t}fetchFromUrl(e){if(null===e||0===e.length)return(0,a.of)([]);const t=new v.hG;this.filters?.forEach((e=>{t.add(e.name,e.operator,e.values)}));const n=(0,R.R)(this.url,t);"work_packages"===this.resource&&n.searchParams.set("sortBy",'[["updatedAt","desc"]]'),n.searchParams.set("query",e);const i=n.toString();return this.halResourceService.get(i).pipe((0,g.T)((e=>e.elements)))}getDebounceTimeout(){return this.initialDebounce?(this.initialDebounce=!1,0):50}writeValue(e){this.model=e}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}applyTemplates(e,t={}){const n=this.vcRef.createComponent(e,{injector:this.templateInjector});Object.keys(t).forEach((e=>{const i=t[e];n.setInput(e,i)})),n.changeDetectorRef.detectChanges(),["optionTemplate","headerTemplate","labelTemplate","footerTemplate"].forEach((e=>{const t=n.instance[e];t&&(this[e]=t)}))}get templateInjector(){return i.zZn.create({providers:[{provide:OpAutocompleterComponent,useValue:this}],parent:this.injector})}syncHiddenField(e){const t=this.syncedInput?.nativeElement;if(t){t.value=Array.isArray(e)?e.join(","):e;const n=new Event("change");t.dispatchEvent(n)}}addNewObjectFn(e){return this.bindLabel?{[this.bindLabel]:e}:e}defaultTrackByFunction(){return null}defaultCompareWithFunction(){return(e,t)=>e===t}static{this.ɵfac=function OpAutocompleterComponent_Factory(e){return new(e||OpAutocompleterComponent)(i.rXU(i.zZn),i.rXU(i.aKT),i.rXU(F.Qq),i.rXU(C.n),i.rXU(i.gRc),i.rXU(i.SKi),i.rXU(i.c1b),i.rXU(b.W),i.rXU(x.t))}}static{this.ɵcmp=i.VBU({type:OpAutocompleterComponent,selectors:[["op-autocompleter"]],contentQueries:function OpAutocompleterComponent_ContentQueries(e,t,n){if(1&e&&(i.wni(n,S.Q,5,i.C4Q),i.wni(n,T.n,5,i.C4Q),i.wni(n,w.O,5,i.C4Q),i.wni(n,k.I,5,i.C4Q)),2&e){let e;i.mGM(e=i.lsd())&&(t.projectedOptionTemplate=e.first),i.mGM(e=i.lsd())&&(t.projectedLabelTemplate=e.first),i.mGM(e=i.lsd())&&(t.projectedHeaderTemplate=e.first),i.mGM(e=i.lsd())&&(t.projectedFooterTemplate=e.first)}},viewQuery:function OpAutocompleterComponent_Query(e,t){if(1&e&&(i.GBs(G,5),i.GBs(E,5)),2&e){let e;i.mGM(e=i.lsd())&&(t.ngSelectInstance=e.first),i.mGM(e=i.lsd())&&(t.syncedInput=e.first)}},hostVars:2,hostBindings:function OpAutocompleterComponent_HostBindings(e,t){2&e&&i.AVh("op-autocompleter",t.className)},inputs:{filters:"filters",resource:"resource",model:"model",searchKey:"searchKey",defaultData:"defaultData",focusDirectly:"focusDirectly",fetchDataDirectly:"fetchDataDirectly",labelRequired:"labelRequired",name:"name",inputName:"inputName",inputValue:"inputValue",multipleAsSeparateInputs:"multipleAsSeparateInputs",inputBindValue:"inputBindValue",hiddenFieldAction:"hiddenFieldAction",required:"required",disabled:"disabled",searchable:"searchable",clearable:"clearable",addTag:"addTag",id:"id",accesskey:"accesskey",items:"items",clearSearchOnAdd:"clearSearchOnAdd",classes:"classes",multiple:"multiple",openDirectly:"openDirectly",bindLabel:"bindLabel",bindValue:"bindValue",markFirst:"markFirst",placeholder:"placeholder",notFoundText:"notFoundText",addTagText:"addTagText",loadingText:"loadingText",clearAllText:"clearAllText",appearance:"appearance",dropdownPosition:"dropdownPosition",appendTo:"appendTo",closeOnSelect:"closeOnSelect",hideSelected:"hideSelected",selectOnTab:"selectOnTab",openOnEnter:"openOnEnter",maxSelectedItems:"maxSelectedItems",groupBy:"groupBy",groupValue:"groupValue",bufferAmount:"bufferAmount",virtualScroll:"virtualScroll",selectableGroup:"selectableGroup",selectableGroupAsModel:"selectableGroupAsModel",searchFn:"searchFn",trackByFn:"trackByFn",compareWith:"compareWith",clearOnBackspace:"clearOnBackspace",labelForId:"labelForId",inputAttrs:"inputAttrs",tabIndex:"tabIndex",readonly:"readonly",searchWhileComposing:"searchWhileComposing",minTermLength:"minTermLength",editableSearchTerm:"editableSearchTerm",keyDownFn:"keyDownFn",typeahead:"typeahead",resetOnChange:"resetOnChange",getOptionsFn:"getOptionsFn",url:"url",relations:"relations"},outputs:{open:"open",close:"close",cancel:"cancel",change:"change",focus:"focus",blur:"blur",search:"search",keydown:"keydown",clear:"clear",add:"add",remove:"remove",scroll:"scroll",scrollToEnd:"scrollToEnd"},features:[i.Jv_([{provide:I.kq,useExisting:(0,i.Rfq)((()=>OpAutocompleterComponent)),multi:!0}]),i.Vt3,i.OA$],decls:15,vars:59,consts:[["ngSelectInstance",""],["defaultOption",""],["defaultLabel",""],["syncedInput",""],[1,"inline-label"],["type","hidden",4,"ngIf"],[4,"ngIf"],[3,"ngModelChange","change","open","close","blur","focus","clear","keydown","keydown.escape","search","scroll","scrollToEnd","add","remove","ngModel","items","ngClass","typeahead","clearOnBackspace","clearSearchOnAdd","hideSelected","appendTo","multiple","loading","addTag","virtualScroll","required","clearable","closeOnSelect","openOnEnter","disabled","name","id","bindLabel","bindValue","markFirst","notFoundText","addTagText","loadingText","clearAllText","appearance","dropdownPosition","selectOnTab","maxSelectedItems","placeholder","groupBy","groupValue","bufferAmount","selectableGroup","searchable","selectableGroupAsModel","trackByFn","compareWith","searchFn","labelForId","inputAttrs","tabIndex","readonly","searchWhileComposing","minTermLength","editableSearchTerm","keyDownFn"],["ng-option-tmp",""],[3,"ngSwitch"],["type","hidden"],["type","hidden",3,"value",4,"ngFor","ngForOf"],["type","hidden",3,"value"],["ng-header-tmp",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["ng-label-tmp",""],["ng-footer-tmp",""],[4,"ngSwitchCase"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight","textContent","ngStyle"],[1,"op-autocompleter--option-wrapper"],["class","op-autocompleter--option-principal",3,"principal","hideName",4,"ngIf"],["data-test-selector","op-autocompleter-item-subject",1,"op-autocompleter--wp-subject"],[3,"ngClass","textContent",4,"ngIf"],[3,"ngOptionHighlight","textContent"],[1,"op-autocompleter--wp-content"],[1,"op-autocompleter--wp-project",3,"ngOptionHighlight","textContent"],[1,"op-autocompleter--wp-id",3,"ngOptionHighlight"],[1,"op-autocompleter--wp-status",3,"textContent","ngClass"],[1,"op-autocompleter--option-principal",3,"principal","hideName"],[3,"ngClass","textContent"],["class","op-autocompleter--option-principal-avatar","size","mini",3,"principal","hideName",4,"ngIf"],[3,"ngOptionHighlight"],["class","op-autocompleter__option-principal-email",3,"ngOptionHighlight",4,"ngIf"],["size","mini",1,"op-autocompleter--option-principal-avatar",3,"principal","hideName"],[1,"op-autocompleter__option-principal-email",3,"ngOptionHighlight"],[1,"ng-value-icon","left",3,"click"],["class","ng-value-label",3,"ngOptionHighlight",4,"ngIf"],[1,"ng-value-label",3,"ngOptionHighlight"]],template:function OpAutocompleterComponent_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",4),i.DNE(1,OpAutocompleterComponent_input_1_Template,2,2,"input",5)(2,OpAutocompleterComponent_ng_container_2_Template,2,1,"ng-container",6),i.j41(3,"ng-select",7,0),i.nI1(5,"async"),i.nI1(6,"async"),i.mxI("ngModelChange",(function OpAutocompleterComponent_Template_ng_select_ngModelChange_3_listener(n){return i.eBV(e),i.DH7(t.model,n)||(t.model=n),i.Njj(n)})),i.bIt("change",(function OpAutocompleterComponent_Template_ng_select_change_3_listener(n){return i.eBV(e),i.Njj(t.changed(n))}))("open",(function OpAutocompleterComponent_Template_ng_select_open_3_listener(){return i.eBV(e),i.Njj(t.opened())}))("close",(function OpAutocompleterComponent_Template_ng_select_close_3_listener(){return i.eBV(e),i.Njj(t.closed())}))("blur",(function OpAutocompleterComponent_Template_ng_select_blur_3_listener(n){return i.eBV(e),i.Njj(t.blured(n))}))("focus",(function OpAutocompleterComponent_Template_ng_select_focus_3_listener(n){return i.eBV(e),i.Njj(t.focused(n))}))("clear",(function OpAutocompleterComponent_Template_ng_select_clear_3_listener(n){return i.eBV(e),i.Njj(t.cleared(n))}))("keydown",(function OpAutocompleterComponent_Template_ng_select_keydown_3_listener(n){return i.eBV(e),i.Njj(t.keydowned(n))}))("keydown.escape",(function OpAutocompleterComponent_Template_ng_select_keydown_escape_3_listener(n){return i.eBV(e),i.Njj(t.canceled(n))}))("search",(function OpAutocompleterComponent_Template_ng_select_search_3_listener(n){return i.eBV(e),i.Njj(t.searched(n))}))("scroll",(function OpAutocompleterComponent_Template_ng_select_scroll_3_listener(n){return i.eBV(e),i.Njj(t.scrolled(n))}))("scrollToEnd",(function OpAutocompleterComponent_Template_ng_select_scrollToEnd_3_listener(n){return i.eBV(e),i.Njj(t.scrolledToEnd(n))}))("add",(function OpAutocompleterComponent_Template_ng_select_add_3_listener(n){return i.eBV(e),i.Njj(t.added(n))}))("remove",(function OpAutocompleterComponent_Template_ng_select_remove_3_listener(n){return i.eBV(e),i.Njj(t.removed(n))})),i.DNE(7,OpAutocompleterComponent_7_Template,1,0,null,6)(8,OpAutocompleterComponent_8_Template,1,0,null,6)(9,OpAutocompleterComponent_ng_template_9_Template,1,6,"ng-template",8)(10,OpAutocompleterComponent_10_Template,1,0,null,6),i.k0s()(),i.DNE(11,OpAutocompleterComponent_ng_template_11_Template,4,4,"ng-template",9,1,i.C5r)(13,OpAutocompleterComponent_ng_template_13_Template,2,2,"ng-template",null,2,i.C5r)}2&e&&(i.R7$(),i.Y8G("ngIf",t.inputName&&!(t.multiple&&t.multipleAsSeparateInputs)),i.R7$(),i.Y8G("ngIf",t.multiple&&t.multipleAsSeparateInputs),i.R7$(),i.R50("ngModel",t.model),i.Y8G("items",i.bMT(5,55,t.results$))("ngClass",t.classes)("typeahead",t.typeahead)("clearOnBackspace",t.clearOnBackspace)("clearSearchOnAdd",t.clearSearchOnAdd)("hideSelected",t.hideSelected)("appendTo",t.appendTo)("multiple",t.multiple)("loading",i.bMT(6,57,t.loading$))("addTag",t.addTag)("virtualScroll",t.virtualScroll)("required",t.required)("clearable",t.clearable)("closeOnSelect",t.closeOnSelect)("openOnEnter",t.openOnEnter)("disabled",t.disabled)("name",t.name)("id",t.id)("bindLabel",t.bindLabel)("bindValue",t.bindValue)("markFirst",t.markFirst)("notFoundText",t.notFoundText)("addTagText",t.addTagText)("loadingText",t.loadingText)("clearAllText",t.clearAllText)("appearance",t.appearance)("dropdownPosition",t.dropdownPosition)("selectOnTab",t.selectOnTab)("maxSelectedItems",t.maxSelectedItems)("placeholder",t.placeholder)("groupBy",t.groupBy)("groupValue",t.groupValue)("bufferAmount",t.bufferAmount)("selectableGroup",t.selectableGroup)("searchable",t.searchable)("selectableGroupAsModel",t.selectableGroupAsModel)("trackByFn",t.trackByFn)("compareWith",t.compareWith)("searchFn",t.searchFn)("labelForId",t.labelForId)("inputAttrs",t.inputAttrs)("tabIndex",t.tabIndex)("readonly",t.readonly)("searchWhileComposing",t.searchWhileComposing)("minTermLength",t.minTermLength)("editableSearchTerm",t.editableSearchTerm)("keyDownFn",t.keyDownFn),i.BMQ("accesskey",t.accesskey||void 0),i.R7$(4),i.Y8G("ngIf",t.headerTemplate||t.projectedHeaderTemplate),i.R7$(),i.Y8G("ngIf",t.labelRequired),i.R7$(2),i.Y8G("ngIf",t.footerTemplate||t.projectedFooterTemplate),i.R7$(),i.Y8G("ngSwitch",!0))},dependencies:[M.YU,M.Sq,M.bT,M.T3,M.B3,M.ux,M.e1,O.vr,O.Uq,O.ZZ,O.Uc,O.q8,I.BC,I.YS,I.vS,D.f,M.Jj],styles:['.op-autocompleter--option-wrapper[_ngcontent-%COMP%]{padding:5px;line-height:15px;min-height:25px;word-break:break-word;display:grid;grid-template-columns:auto 1fr;grid-template-rows:1fr 1fr}.op-autocompleter--option-principal[_ngcontent-%COMP%]{margin-right:5px;float:left;grid-column-start:1;grid-column-end:2;grid-row-start:1;grid-row-end:3}.op-autocompleter--wp-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:50% 1fr auto;grid-template-areas:"project idlink status";font-size:.8rem;padding:1px 0 5px}.op-autocompleter--wp-project[_ngcontent-%COMP%]{grid-area:project;display:inline-block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.op-autocompleter--wp-id[_ngcontent-%COMP%]{grid-area:idlink;font-style:italic;margin:0 .5rem}.op-autocompleter--wp-status[_ngcontent-%COMP%]{grid-area:status;overflow:hidden;font-style:italic}.op-autocompleter--wp-subject[_ngcontent-%COMP%]{font-weight:var(--base-text-weight-bold);display:inline-block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.op-autocompleter__option-principal-email[_ngcontent-%COMP%]{color:var(--fgColor-muted);font-size:var(--font-size-small);margin-left:var(--stack-gap-condensed)}@media screen and (max-width: 543px){.op-autocompleter__option-principal-email[_ngcontent-%COMP%]{display:block;margin-left:0;margin-top:var(--control-xsmall-gap)}.op-autocompleter--option-principal-avatar[_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + .op-autocompleter__option-principal-email[_ngcontent-%COMP%]{margin-left:var(--control-small-size)}}'],changeDetection:0})}}},42572:(e,t,n)=>{"use strict";n.d(t,{E:()=>OpenprojectAutocompleterModule});var i=n(62223),o=n(34456),r=n(25827),s=n(60316),a=n(46147),l=n(98637),c=n(54547),p=n(66094),d=n(24128),u=n(16455),h=n(81944),m=n(27834),g=n(97564),_=n(77938),f=n(51196),b=n(46303),k=n(11528),v=n(32829),C=n(22444),y=n(89120),w=n(10402),T=n(26579),S=n(22179),j=n(24505),P=n(68559);y.I,g.e,u.R,h._,p.L,_.P,S.b,f.j,j.L,d.w,m.m,b.T,k.Q,v.n,C.O,w.I,T.p;class OpenprojectAutocompleterModule{constructor(e){}static{this.ɵfac=function OpenprojectAutocompleterModule_Factory(e){return new(e||OpenprojectAutocompleterModule)(P.KVO(P.zZn))}}static{this.ɵmod=P.$C({type:OpenprojectAutocompleterModule})}static{this.ɵinj=P.G2t({imports:[s.MD,i.MQ,a.d0,o.YN,o.X1,r.oW,c.W,l.t]})}}("undefined"==typeof ngJitMode||ngJitMode)&&P.Obh(OpenprojectAutocompleterModule,{declarations:[y.I,g.e,u.R,h._,p.L,_.P,S.b,f.j,j.L,d.w,m.m,b.T,k.Q,v.n,C.O,w.I,T.p],imports:[s.MD,i.MQ,a.d0,o.YN,o.X1,r.oW,c.W,l.t],exports:[y.I,g.e,u.R,h._,p.L,_.P,S.b,f.j,j.L,d.w,m.m,b.T,k.Q,v.n,C.O,w.I,T.p]})},24505:(e,t,n)=>{"use strict";n.d(t,{L:()=>ProjectAutocompleterTemplateComponent});var i=n(68559),o=n(60316),r=n(26579);const s=["optionTemplate"],a=["labelTemplate"],_c2=e=>({"padding-left.px":e});function ProjectAutocompleterTemplateComponent_ng_template_0_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"span",2),i.bIt("click",(function ProjectAutocompleterTemplateComponent_ng_template_0_Template_span_click_0_listener(){const t=i.eBV(e),n=t.$implicit,o=t.clear;return i.Njj(o(n))})),i.EFF(1,"×"),i.k0s(),i.j41(2,"span",3),i.EFF(3),i.k0s()}if(2&e){const e=t.$implicit;i.R7$(3),i.JRh(e.name)}}function ProjectAutocompleterTemplateComponent_ng_template_2_div_2_Template(e,t){if(1&e&&(i.j41(0,"div",6),i.EFF(1),i.k0s()),2&e){const e=i.XpG().$implicit;i.Y8G("title",e.disabledReason)("ngStyle",i.eq3(3,_c2,16*e.numberOfAncestors)),i.R7$(),i.JRh(e.disabledReason)}}function ProjectAutocompleterTemplateComponent_ng_template_2_Template(e,t){if(1&e&&(i.j41(0,"div",4),i.EFF(1),i.k0s(),i.DNE(2,ProjectAutocompleterTemplateComponent_ng_template_2_div_2_Template,2,5,"div",5)),2&e){const e=t.$implicit,n=t.search;i.Y8G("title",e.name)("ngStyle",i.eq3(5,_c2,16*e.numberOfAncestors))("opSearchHighlight",n),i.R7$(),i.JRh(e.name),i.R7$(),i.Y8G("ngIf",e.disabled&&e.disabledReason)}}class ProjectAutocompleterTemplateComponent{static{this.ɵfac=function ProjectAutocompleterTemplateComponent_Factory(e){return new(e||ProjectAutocompleterTemplateComponent)}}static{this.ɵcmp=i.VBU({type:ProjectAutocompleterTemplateComponent,selectors:[["ng-component"]],viewQuery:function ProjectAutocompleterTemplateComponent_Query(e,t){if(1&e&&(i.GBs(s,5),i.GBs(a,5)),2&e){let e;i.mGM(e=i.lsd())&&(t.optionTemplate=e.first),i.mGM(e=i.lsd())&&(t.labelTemplate=e.first)}},decls:4,vars:0,consts:[["labelTemplate",""],["optionTemplate",""],[1,"ng-value-icon","left",3,"click"],[1,"ng-value-label"],[1,"ng-option-label","ellipsis",3,"title","ngStyle","opSearchHighlight"],["class","ng-option-label ellipsis",3,"title","ngStyle",4,"ngIf"],[1,"ng-option-label","ellipsis",3,"title","ngStyle"]],template:function ProjectAutocompleterTemplateComponent_Template(e,t){1&e&&i.DNE(0,ProjectAutocompleterTemplateComponent_ng_template_0_Template,4,1,"ng-template",null,0,i.C5r)(2,ProjectAutocompleterTemplateComponent_ng_template_2_Template,3,7,"ng-template",null,1,i.C5r)},dependencies:[o.bT,o.B3,r.p],encapsulation:2,changeDetection:0})}}},51196:(e,t,n)=>{"use strict";n.d(t,{j:()=>ProjectAutocompleterComponent});var i=n(68559),o=n(34456),r=n(59452),s=n(63617),a=n(70271),l=n(36647);const flattenProjectTree=(e,t=0)=>e.reduce(((e,n)=>[...e,{...n,numberOfAncestors:t,ancestors:[]},...flattenProjectTree(n.children,t+1)]),[]);var c=n(96027),p=n(12313);const insertProjectWithAncestors=(e,t,n)=>{if(!n.length)return[...e,{...t,children:[]}];const i=n[0],o=e.find((e=>e.href===i.href));return o?e.map((e=>e===o?{...e,children:insertProjectWithAncestors(e.children,t,n.slice(1))}:{...e})):[...e,{id:(0,p.A)(i.href),name:i.title,href:i.href,disabled:!0,children:insertProjectWithAncestors([],t,n.slice(1))}]},buildTree=e=>e.reduce(((e,t)=>insertProjectWithAncestors(e,t,t.ancestors)),[]),recursiveSort=e=>e.map((e=>({...e,children:recursiveSort(e.children)}))).sort(((e,t)=>e.name.localeCompare(t.name)));var d=n(46303),u=n(89282),h=n(24505),m=n(68365),g=n(60316),f=n(62223),b=n(48377);const _c0=(e,t,n)=>({$implicit:e,search:t,index:n}),_c1=(e,t,n,i)=>({$implicit:e,search:t,index:n,clear:i}),_c2=e=>({"padding-left.px":e});function ProjectAutocompleterComponent_input_1_Template(e,t){if(1&e&&i.nrm(0,"input",10,3),2&e){const e=i.XpG();i.BMQ("name",e.inputName)("data-action",e.hiddenFieldAction)}}function ProjectAutocompleterComponent_ng_container_2_input_1_Template(e,t){if(1&e&&i.nrm(0,"input",12),2&e){const e=t.$implicit,n=i.XpG(2);i.Y8G("value",e),i.BMQ("name",n.inputName+"[]")("data-action",n.hiddenFieldAction)}}function ProjectAutocompleterComponent_ng_container_2_Template(e,t){if(1&e&&(i.qex(0),i.DNE(1,ProjectAutocompleterComponent_ng_container_2_input_1_Template,1,3,"input",11),i.bVm()),2&e){const e=i.XpG();i.R7$(),i.Y8G("ngForOf",e.mappedInputValue)}}function ProjectAutocompleterComponent_7_ng_template_0_Template(e,t){if(1&e&&i.eu8(0,14),2&e){const e=t.item,n=t.index,o=t.searchTerm,r=i.XpG(2);i.Y8G("ngTemplateOutlet",r.headerTemplate||r.projectedHeaderTemplate)("ngTemplateOutletContext",i.sMw(2,_c0,e,o,n))}}function ProjectAutocompleterComponent_7_Template(e,t){1&e&&i.DNE(0,ProjectAutocompleterComponent_7_ng_template_0_Template,1,6,"ng-template",13)}function ProjectAutocompleterComponent_8_ng_template_0_Template(e,t){if(1&e&&i.eu8(0,14),2&e){const e=t.item,n=t.index,o=t.searchTerm,r=t.clear,s=i.XpG(2),a=i.sdS(14);i.Y8G("ngTemplateOutlet",s.projectedLabelTemplate||s.labelTemplate||a)("ngTemplateOutletContext",i.ziG(2,_c1,e,o,n,r))}}function ProjectAutocompleterComponent_8_Template(e,t){1&e&&i.DNE(0,ProjectAutocompleterComponent_8_ng_template_0_Template,1,7,"ng-template",15)}function ProjectAutocompleterComponent_ng_template_9_Template(e,t){if(1&e&&i.eu8(0,14),2&e){const e=t.item,n=t.index,o=t.searchTerm,r=i.XpG(),s=i.sdS(12);i.Y8G("ngTemplateOutlet",r.projectedOptionTemplate||r.optionTemplate||s)("ngTemplateOutletContext",i.sMw(2,_c0,e,o,n))}}function ProjectAutocompleterComponent_10_ng_template_0_Template(e,t){if(1&e&&i.eu8(0,14),2&e){const e=t.item,n=t.index,o=t.searchTerm,r=i.XpG(2);i.Y8G("ngTemplateOutlet",r.footerTemplate||r.projectedFooterTemplate)("ngTemplateOutletContext",i.sMw(2,_c0,e,o,n))}}function ProjectAutocompleterComponent_10_Template(e,t){1&e&&i.DNE(0,ProjectAutocompleterComponent_10_ng_template_0_Template,1,6,"ng-template",16)}function ProjectAutocompleterComponent_ng_template_11_ng_container_0_Template(e,t){if(1&e&&(i.qex(0),i.nrm(1,"span",18),i.bVm()),2&e){const e=i.XpG(),t=e.$implicit,n=e.search;i.R7$(),i.Y8G("ngOptionHighlight",n)("textContent",t.name)("ngStyle",i.eq3(3,_c2,16*t.depth))}}function ProjectAutocompleterComponent_ng_template_11_ng_container_1_op_principal_2_Template(e,t){if(1&e&&i.nrm(0,"op-principal",28),2&e){const e=i.XpG(2).$implicit;i.Y8G("principal",e.author)("hideName",!0)}}function ProjectAutocompleterComponent_ng_template_11_ng_container_1_span_4_Template(e,t){if(1&e&&i.nrm(0,"span",29),2&e){const e=i.XpG(2).$implicit,t=i.XpG();i.Mz_("textContent","",e.type.name," "),i.Y8G("ngClass",t.highlighting("type",e.type.id))}}function ProjectAutocompleterComponent_ng_template_11_ng_container_1_Template(e,t){if(1&e&&(i.qex(0),i.j41(1,"div",19),i.DNE(2,ProjectAutocompleterComponent_ng_template_11_ng_container_1_op_principal_2_Template,1,2,"op-principal",20),i.j41(3,"span",21),i.DNE(4,ProjectAutocompleterComponent_ng_template_11_ng_container_1_span_4_Template,1,3,"span",22),i.nrm(5,"span",23),i.k0s(),i.j41(6,"div",24),i.nrm(7,"span",25),i.j41(8,"span",26),i.EFF(9),i.k0s(),i.nrm(10,"span",27),i.k0s()(),i.bVm()),2&e){const e=i.XpG(),t=e.$implicit,n=e.search,o=i.XpG();i.R7$(2),i.Y8G("ngIf",t.author&&t.author.href),i.R7$(2),i.Y8G("ngIf",t.type),i.R7$(),i.Y8G("ngOptionHighlight",n)("textContent",t.subject),i.R7$(2),i.Y8G("ngOptionHighlight",n)("textContent",null==t.project?null:t.project.name),i.R7$(),i.Y8G("ngOptionHighlight",n),i.R7$(),i.SpI("#",t.id,""),i.R7$(),i.Y8G("textContent",null==t.status?null:t.status.name)("ngClass",o.highlighting("status",null==t.status?null:t.status.id))}}function ProjectAutocompleterComponent_ng_template_11_ng_container_2_op_principal_1_Template(e,t){if(1&e&&i.nrm(0,"op-principal",33),2&e){const e=i.XpG(2).$implicit;i.Y8G("principal",e)("hideName",!0)}}function ProjectAutocompleterComponent_ng_template_11_ng_container_2_span_4_Template(e,t){if(1&e&&(i.j41(0,"span",34),i.EFF(1),i.k0s()),2&e){const e=i.XpG(2),t=e.$implicit,n=e.search;i.Y8G("ngOptionHighlight",n),i.R7$(),i.JRh(t.email)}}function ProjectAutocompleterComponent_ng_template_11_ng_container_2_Template(e,t){if(1&e&&(i.qex(0),i.DNE(1,ProjectAutocompleterComponent_ng_template_11_ng_container_2_op_principal_1_Template,1,2,"op-principal",30),i.j41(2,"span",31),i.EFF(3),i.k0s(),i.DNE(4,ProjectAutocompleterComponent_ng_template_11_ng_container_2_span_4_Template,2,2,"span",32),i.bVm()),2&e){const e=i.XpG(),t=e.$implicit,n=e.search;i.R7$(),i.Y8G("ngIf",t&&t.href),i.R7$(),i.Y8G("ngOptionHighlight",n),i.R7$(),i.JRh(t.name),i.R7$(),i.Y8G("ngIf",t.email)}}function ProjectAutocompleterComponent_ng_template_11_ng_container_3_span_3_Template(e,t){if(1&e&&(i.j41(0,"span",34),i.EFF(1),i.k0s()),2&e){const e=i.XpG(2),t=e.$implicit,n=e.search;i.Y8G("ngOptionHighlight",n),i.R7$(),i.JRh(t.email)}}function ProjectAutocompleterComponent_ng_template_11_ng_container_3_Template(e,t){if(1&e&&(i.qex(0),i.j41(1,"span",31),i.EFF(2),i.k0s(),i.DNE(3,ProjectAutocompleterComponent_ng_template_11_ng_container_3_span_3_Template,2,2,"span",32),i.bVm()),2&e){const e=i.XpG(),t=e.$implicit,n=e.search;i.R7$(),i.Y8G("ngOptionHighlight",n),i.R7$(),i.JRh(t.name),i.R7$(),i.Y8G("ngIf",t.email)}}function ProjectAutocompleterComponent_ng_template_11_Template(e,t){if(1&e&&i.DNE(0,ProjectAutocompleterComponent_ng_template_11_ng_container_0_Template,2,5,"ng-container",17)(1,ProjectAutocompleterComponent_ng_template_11_ng_container_1_Template,11,10,"ng-container",17)(2,ProjectAutocompleterComponent_ng_template_11_ng_container_2_Template,5,4,"ng-container",17)(3,ProjectAutocompleterComponent_ng_template_11_ng_container_3_Template,4,3,"ng-container",17),2&e){const e=t.$implicit,n=i.XpG();i.Y8G("ngSwitchCase",!n.resource&&!!e.depth),i.R7$(),i.Y8G("ngSwitchCase","work_packages"===n.resource||"parent-child"===n.resource),i.R7$(),i.Y8G("ngSwitchCase","users"===n.resource||"assignee"===n.resource||"principals"===n.resource),i.R7$(),i.Y8G("ngSwitchCase","subproject"===n.resource||"version"===n.resource||"status"===n.resource||"default"===n.resource||!n.resource&&!e.depth)}}function ProjectAutocompleterComponent_ng_template_13_ng_container_0_span_3_Template(e,t){if(1&e&&(i.j41(0,"span",37),i.EFF(1),i.k0s()),2&e){const e=i.XpG(2),t=e.$implicit,n=e.search;i.Y8G("ngOptionHighlight",n),i.R7$(),i.E5c(" ",null==t.type?null:t.type.name," #",t.id," ",t.subject||t.name," ")}}function ProjectAutocompleterComponent_ng_template_13_ng_container_0_Template(e,t){if(1&e){const e=i.RV6();i.qex(0),i.j41(1,"span",35),i.bIt("click",(function ProjectAutocompleterComponent_ng_template_13_ng_container_0_Template_span_click_1_listener(){i.eBV(e);const t=i.XpG(),n=t.$implicit,o=t.clear;return i.Njj(o(n))})),i.EFF(2,"×"),i.k0s(),i.DNE(3,ProjectAutocompleterComponent_ng_template_13_ng_container_0_span_3_Template,2,4,"span",36),i.bVm()}if(2&e){const e=i.XpG().$implicit;i.R7$(3),i.Y8G("ngIf",e.id)}}function ProjectAutocompleterComponent_ng_template_13_ng_container_1_Template(e,t){if(1&e){const e=i.RV6();i.qex(0),i.j41(1,"span",35),i.bIt("click",(function ProjectAutocompleterComponent_ng_template_13_ng_container_1_Template_span_click_1_listener(){i.eBV(e);const t=i.XpG(),n=t.$implicit,o=t.clear;return i.Njj(o(n))})),i.EFF(2,"×"),i.k0s(),i.j41(3,"span",37),i.EFF(4),i.k0s(),i.bVm()}if(2&e){const e=i.XpG(),t=e.$implicit,n=e.search;i.R7$(3),i.Y8G("ngOptionHighlight",n),i.R7$(),i.JRh(t.name)}}function ProjectAutocompleterComponent_ng_template_13_Template(e,t){if(1&e&&i.DNE(0,ProjectAutocompleterComponent_ng_template_13_ng_container_0_Template,4,1,"ng-container",6)(1,ProjectAutocompleterComponent_ng_template_13_ng_container_1_Template,5,2,"ng-container",6),2&e){const e=i.XpG();i.Y8G("ngIf","work_packages"===e.resource),i.R7$(),i.Y8G("ngIf","work_packages"!==e.resource)}}class ProjectAutocompleterComponent extends d.T{constructor(){super(...arguments),this.className=!0,this.url=this.apiV3Service.projects.path,this.isInlineContext=!1,this.disabledProjects={},this.mapResultsFn=e=>e,this.valueChange=new i.bkB,this.projectTracker=e=>e.href||e.id,this.getOptionsFn=this.getAvailableProjects.bind(this),this.dataLoaded=!1}get inlineClass(){return this.isInlineContext}ngOnInit(){super.ngOnInit(),this.applyTemplates(h.L,{})}matchingItems(e,t){let n;if(""!==t&&t){const i=t.toLowerCase();n=e.filter((e=>e.name.toLowerCase().includes(i)))}else n=e;return(0,r.of)(n)}disableSelectedItems(e,t){if(!this.multiple)return e;const n=t||[],i=(Array.isArray(n)?n:[n]).map((e=>e.href||e.id));return e.map((e=>{const t=!!i.find((t=>t===this.projectTracker(e))),n=e.id.toString(),o=t||e.disabled||!!this.disabledProjects[n];return{...e,disabled:o,disabledReason:"string"==typeof this.disabledProjects[n]?this.disabledProjects[n]:""}}))}getAvailableProjects(e){return this.dataLoaded?this.matchingItems(this.projects,e).pipe((0,a.T)(this.mapResultsFn),(0,a.T)((e=>e.sort(((e,t)=>e.ancestors.length-t.ancestors.length)))),(0,a.T)((e=>buildTree(e))),(0,a.T)((e=>recursiveSort(e))),(0,a.T)((e=>flattenProjectTree(e))),(0,l.n)((e=>(0,s.h)((0,r.of)([]),this.valueChange).pipe((0,a.T)((()=>this.disableSelectedItems(e,this.model))))))):(0,c.eS)((t=>{const n=this.buildFilteredURL(e);return n.searchParams.set("pageSize",t.pageSize?.toString()||"-1"),n.searchParams.set("offset",t.offset?.toString()||"1"),n.searchParams.set("select","elements/id,elements/name,elements/identifier,elements/self,elements/ancestors,total,count,pageSize"),this.http.get(n.toString())})).pipe((0,a.T)((e=>e.map((e=>{const t=e.id.toString(),n=!!this.disabledProjects[t];return{id:e.id,href:e._links.self.href,name:e.name,disabled:n,disabledReason:"string"==typeof this.disabledProjects[t]?this.disabledProjects[t]:"",ancestors:e._links.ancestors,children:[]}})))),(0,a.T)(this.mapResultsFn),(0,a.T)((e=>(this.dataLoaded=!0,this.projects=e,e.sort(((e,t)=>e.ancestors.length-t.ancestors.length))))),(0,a.T)((e=>buildTree(e))),(0,a.T)((e=>recursiveSort(e))),(0,a.T)((e=>flattenProjectTree(e))),(0,l.n)((e=>(0,s.h)((0,r.of)([]),this.valueChange).pipe((0,a.T)((()=>this.disableSelectedItems(e,this.model)))))))}buildFilteredURL(e){const t=_.keyBy(this.filters,"name"),n=u.hG.fromFilterObject(t);return e?.length&&n.add("typeahead","**",[e]),(0,m.R)(this.url,n)}static{this.ɵfac=(()=>{let e;return function ProjectAutocompleterComponent_Factory(t){return(e||(e=i.xGo(ProjectAutocompleterComponent)))(t||ProjectAutocompleterComponent)}})()}static{this.ɵcmp=i.VBU({type:ProjectAutocompleterComponent,selectors:[["op-project-autocompleter"]],hostVars:4,hostBindings:function ProjectAutocompleterComponent_HostBindings(e,t){2&e&&i.AVh("op-project-autocompleter",t.className)("op-project-autocompleter_inline",t.inlineClass)},inputs:{url:"url",isInlineContext:"isInlineContext",disabledProjects:"disabledProjects",mapResultsFn:"mapResultsFn"},outputs:{valueChange:"valueChange"},features:[i.Jv_([{provide:o.kq,useExisting:(0,i.Rfq)((()=>ProjectAutocompleterComponent)),multi:!0}]),i.Vt3],decls:15,vars:59,consts:[["ngSelectInstance",""],["defaultOption",""],["defaultLabel",""],["syncedInput",""],[1,"inline-label"],["type","hidden",4,"ngIf"],[4,"ngIf"],[3,"ngModelChange","change","open","close","blur","focus","clear","keydown","keydown.escape","search","scroll","scrollToEnd","add","remove","ngModel","items","ngClass","typeahead","clearOnBackspace","clearSearchOnAdd","hideSelected","appendTo","multiple","loading","addTag","virtualScroll","required","clearable","closeOnSelect","openOnEnter","disabled","name","id","bindLabel","bindValue","markFirst","notFoundText","addTagText","loadingText","clearAllText","appearance","dropdownPosition","selectOnTab","maxSelectedItems","placeholder","groupBy","groupValue","bufferAmount","selectableGroup","searchable","selectableGroupAsModel","trackByFn","compareWith","searchFn","labelForId","inputAttrs","tabIndex","readonly","searchWhileComposing","minTermLength","editableSearchTerm","keyDownFn"],["ng-option-tmp",""],[3,"ngSwitch"],["type","hidden"],["type","hidden",3,"value",4,"ngFor","ngForOf"],["type","hidden",3,"value"],["ng-header-tmp",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["ng-label-tmp",""],["ng-footer-tmp",""],[4,"ngSwitchCase"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight","textContent","ngStyle"],[1,"op-autocompleter--option-wrapper"],["class","op-autocompleter--option-principal",3,"principal","hideName",4,"ngIf"],["data-test-selector","op-autocompleter-item-subject",1,"op-autocompleter--wp-subject"],[3,"ngClass","textContent",4,"ngIf"],[3,"ngOptionHighlight","textContent"],[1,"op-autocompleter--wp-content"],[1,"op-autocompleter--wp-project",3,"ngOptionHighlight","textContent"],[1,"op-autocompleter--wp-id",3,"ngOptionHighlight"],[1,"op-autocompleter--wp-status",3,"textContent","ngClass"],[1,"op-autocompleter--option-principal",3,"principal","hideName"],[3,"ngClass","textContent"],["class","op-autocompleter--option-principal-avatar","size","mini",3,"principal","hideName",4,"ngIf"],[3,"ngOptionHighlight"],["class","op-autocompleter__option-principal-email",3,"ngOptionHighlight",4,"ngIf"],["size","mini",1,"op-autocompleter--option-principal-avatar",3,"principal","hideName"],[1,"op-autocompleter__option-principal-email",3,"ngOptionHighlight"],[1,"ng-value-icon","left",3,"click"],["class","ng-value-label",3,"ngOptionHighlight",4,"ngIf"],[1,"ng-value-label",3,"ngOptionHighlight"]],template:function ProjectAutocompleterComponent_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",4),i.DNE(1,ProjectAutocompleterComponent_input_1_Template,2,2,"input",5)(2,ProjectAutocompleterComponent_ng_container_2_Template,2,1,"ng-container",6),i.j41(3,"ng-select",7,0),i.nI1(5,"async"),i.nI1(6,"async"),i.mxI("ngModelChange",(function ProjectAutocompleterComponent_Template_ng_select_ngModelChange_3_listener(n){return i.eBV(e),i.DH7(t.model,n)||(t.model=n),i.Njj(n)})),i.bIt("change",(function ProjectAutocompleterComponent_Template_ng_select_change_3_listener(n){return i.eBV(e),i.Njj(t.changed(n))}))("open",(function ProjectAutocompleterComponent_Template_ng_select_open_3_listener(){return i.eBV(e),i.Njj(t.opened())}))("close",(function ProjectAutocompleterComponent_Template_ng_select_close_3_listener(){return i.eBV(e),i.Njj(t.closed())}))("blur",(function ProjectAutocompleterComponent_Template_ng_select_blur_3_listener(n){return i.eBV(e),i.Njj(t.blured(n))}))("focus",(function ProjectAutocompleterComponent_Template_ng_select_focus_3_listener(n){return i.eBV(e),i.Njj(t.focused(n))}))("clear",(function ProjectAutocompleterComponent_Template_ng_select_clear_3_listener(n){return i.eBV(e),i.Njj(t.cleared(n))}))("keydown",(function ProjectAutocompleterComponent_Template_ng_select_keydown_3_listener(n){return i.eBV(e),i.Njj(t.keydowned(n))}))("keydown.escape",(function ProjectAutocompleterComponent_Template_ng_select_keydown_escape_3_listener(n){return i.eBV(e),i.Njj(t.canceled(n))}))("search",(function ProjectAutocompleterComponent_Template_ng_select_search_3_listener(n){return i.eBV(e),i.Njj(t.searched(n))}))("scroll",(function ProjectAutocompleterComponent_Template_ng_select_scroll_3_listener(n){return i.eBV(e),i.Njj(t.scrolled(n))}))("scrollToEnd",(function ProjectAutocompleterComponent_Template_ng_select_scrollToEnd_3_listener(n){return i.eBV(e),i.Njj(t.scrolledToEnd(n))}))("add",(function ProjectAutocompleterComponent_Template_ng_select_add_3_listener(n){return i.eBV(e),i.Njj(t.added(n))}))("remove",(function ProjectAutocompleterComponent_Template_ng_select_remove_3_listener(n){return i.eBV(e),i.Njj(t.removed(n))})),i.DNE(7,ProjectAutocompleterComponent_7_Template,1,0,null,6)(8,ProjectAutocompleterComponent_8_Template,1,0,null,6)(9,ProjectAutocompleterComponent_ng_template_9_Template,1,6,"ng-template",8)(10,ProjectAutocompleterComponent_10_Template,1,0,null,6),i.k0s()(),i.DNE(11,ProjectAutocompleterComponent_ng_template_11_Template,4,4,"ng-template",9,1,i.C5r)(13,ProjectAutocompleterComponent_ng_template_13_Template,2,2,"ng-template",null,2,i.C5r)}2&e&&(i.R7$(),i.Y8G("ngIf",t.inputName&&!(t.multiple&&t.multipleAsSeparateInputs)),i.R7$(),i.Y8G("ngIf",t.multiple&&t.multipleAsSeparateInputs),i.R7$(),i.R50("ngModel",t.model),i.Y8G("items",i.bMT(5,55,t.results$))("ngClass",t.classes)("typeahead",t.typeahead)("clearOnBackspace",t.clearOnBackspace)("clearSearchOnAdd",t.clearSearchOnAdd)("hideSelected",t.hideSelected)("appendTo",t.appendTo)("multiple",t.multiple)("loading",i.bMT(6,57,t.loading$))("addTag",t.addTag)("virtualScroll",t.virtualScroll)("required",t.required)("clearable",t.clearable)("closeOnSelect",t.closeOnSelect)("openOnEnter",t.openOnEnter)("disabled",t.disabled)("name",t.name)("id",t.id)("bindLabel",t.bindLabel)("bindValue",t.bindValue)("markFirst",t.markFirst)("notFoundText",t.notFoundText)("addTagText",t.addTagText)("loadingText",t.loadingText)("clearAllText",t.clearAllText)("appearance",t.appearance)("dropdownPosition",t.dropdownPosition)("selectOnTab",t.selectOnTab)("maxSelectedItems",t.maxSelectedItems)("placeholder",t.placeholder)("groupBy",t.groupBy)("groupValue",t.groupValue)("bufferAmount",t.bufferAmount)("selectableGroup",t.selectableGroup)("searchable",t.searchable)("selectableGroupAsModel",t.selectableGroupAsModel)("trackByFn",t.trackByFn)("compareWith",t.compareWith)("searchFn",t.searchFn)("labelForId",t.labelForId)("inputAttrs",t.inputAttrs)("tabIndex",t.tabIndex)("readonly",t.readonly)("searchWhileComposing",t.searchWhileComposing)("minTermLength",t.minTermLength)("editableSearchTerm",t.editableSearchTerm)("keyDownFn",t.keyDownFn),i.BMQ("accesskey",t.accesskey||void 0),i.R7$(4),i.Y8G("ngIf",t.headerTemplate||t.projectedHeaderTemplate),i.R7$(),i.Y8G("ngIf",t.labelRequired),i.R7$(2),i.Y8G("ngIf",t.footerTemplate||t.projectedFooterTemplate),i.R7$(),i.Y8G("ngSwitch",!0))},dependencies:[g.YU,g.Sq,g.bT,g.T3,g.B3,g.ux,g.e1,f.vr,f.Uq,f.ZZ,f.Uc,f.q8,o.BC,o.YS,o.vS,b.f,g.Jj],styles:[".cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-project-autocompleter,.op-project-autocompleter>*{width:100%;display:flex;flex-direction:column}.op-project-autocompleter_inline .op-autocompleter{display:inline}.op-project-autocompleter .ng-dropdown-panel .ng-dropdown-panel-items .ng-option.ng-option-disabled{cursor:default;color:var(--fgColor-muted)}\n"],encapsulation:2,changeDetection:0})}}},81944:(e,t,n)=>{"use strict";n.d(t,{_:()=>TimeEntryWorkPackageAutocompleterComponent});var i=n(68559),o=n(16455),r=n(60316),s=n(46303),a=n(22444);function TimeEntryWorkPackageAutocompleterComponent_ng_template_1_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",2)(1,"div",3)(2,"ul",4)(3,"li",5),i.bIt("click",(function TimeEntryWorkPackageAutocompleterComponent_ng_template_1_Template_li_click_3_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.setMode("all"))})),i.nrm(4,"a",6),i.k0s(),i.j41(5,"li",5),i.bIt("click",(function TimeEntryWorkPackageAutocompleterComponent_ng_template_1_Template_li_click_5_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.setMode("recent"))})),i.nrm(6,"a",6),i.k0s()()()()}if(2&e){const e=i.XpG();i.R7$(4),i.AVh("op-tab-row--link_selected","all"===e.mode),i.Y8G("textContent",e.text.all),i.R7$(2),i.AVh("op-tab-row--link_selected","recent"===e.mode),i.Y8G("textContent",e.text.recent)}}class TimeEntryWorkPackageAutocompleterComponent extends o.R{constructor(e){super(e),this.injector=e,this.modeSwitch=new i.bkB,this.mode="all",this.text.all=this.I18n.t("js.label_all"),this.text.recent=this.I18n.t("js.label_recent")}setMode(e){e!==this.mode&&this.modeSwitch.emit(e),this.mode=e}static{this.ɵfac=function TimeEntryWorkPackageAutocompleterComponent_Factory(e){return new(e||TimeEntryWorkPackageAutocompleterComponent)(i.rXU(i.zZn))}}static{this.ɵcmp=i.VBU({type:TimeEntryWorkPackageAutocompleterComponent,selectors:[["te-work-package-autocompleter"]],outputs:{modeSwitch:"modeSwitch"},features:[i.Vt3],decls:2,vars:13,consts:[["resource","work_packages",3,"change","open","close","keydown","model","items","ngClass","addTag","virtualScroll","required","clearable","disabled","clearOnBackspace","typeahead","appendTo","hideSelected","id"],["op-autocompleter-header-tmp",""],[1,"scrollable-tabs"],[1,"op-scrollable-tabs--tab-container"],[1,"op-tab-row"],[1,"op-tab-row--tab",3,"click"],["href","#",1,"op-tab-row--link",3,"textContent"]],template:function TimeEntryWorkPackageAutocompleterComponent_Template(e,t){1&e&&(i.j41(0,"op-autocompleter",0),i.bIt("change",(function TimeEntryWorkPackageAutocompleterComponent_Template_op_autocompleter_change_0_listener(e){return t.changeModel(e)}))("open",(function TimeEntryWorkPackageAutocompleterComponent_Template_op_autocompleter_open_0_listener(){return t.opened()}))("close",(function TimeEntryWorkPackageAutocompleterComponent_Template_op_autocompleter_close_0_listener(){return t.closed()}))("keydown",(function TimeEntryWorkPackageAutocompleterComponent_Template_op_autocompleter_keydown_0_listener(e){return t.keyPressed(e)})),i.DNE(1,TimeEntryWorkPackageAutocompleterComponent_ng_template_1_Template,7,6,"ng-template",1),i.k0s()),2&e&&i.Y8G("model",t.model)("items",t.availableValues)("ngClass",t.classes)("addTag",t.createAllowed)("virtualScroll",!0)("required",t.required)("clearable",!t.required)("disabled",t.disabled)("clearOnBackspace",!1)("typeahead",t.typeahead)("appendTo",t.appendTo)("hideSelected",t.hideSelected)("id",t.id)},dependencies:[r.YU,s.T,a.O],styles:[".ng-dropdown-panel .ng-dropdown-header{padding-bottom:0}\n"],encapsulation:2})}}},22179:(e,t,n)=>{"use strict";n.d(t,{b:()=>UserAutocompleterTemplateComponent});var i=n(68559),o=n(60316),r=n(48377),s=n(28890),a=n(26579);const l=["optionTemplate"],c=["footerTemplate"];function UserAutocompleterTemplateComponent_ng_template_0_op_principal_0_Template(e,t){if(1&e&&i.nrm(0,"op-principal",6),2&e){const e=i.XpG().$implicit,t=i.XpG();i.Y8G("principal",e)("hideName",!0)("hoverCard",t.hoverCards)("hoverCardModalTarget",t.isOpenedInModal?"custom":"default")}}function UserAutocompleterTemplateComponent_ng_template_0_span_3_Template(e,t){if(1&e&&(i.j41(0,"span",7),i.EFF(1),i.k0s()),2&e){const e=i.XpG(),t=e.$implicit,n=e.search;i.Y8G("opSearchHighlight",n),i.R7$(),i.JRh(t.email)}}function UserAutocompleterTemplateComponent_ng_template_0_Template(e,t){if(1&e&&(i.DNE(0,UserAutocompleterTemplateComponent_ng_template_0_op_principal_0_Template,1,4,"op-principal",3),i.j41(1,"span",4),i.EFF(2),i.k0s(),i.DNE(3,UserAutocompleterTemplateComponent_ng_template_0_span_3_Template,2,2,"span",5)),2&e){const e=t.$implicit,n=t.search;i.Y8G("ngIf",e&&e.href),i.R7$(),i.Y8G("opSearchHighlight",n),i.R7$(),i.SpI(" ",e.name," "),i.R7$(),i.Y8G("ngIf",e.email)}}function UserAutocompleterTemplateComponent_2_ng_template_0_Template(e,t){if(1&e&&i.nrm(0,"op-invite-user-button",8),2&e){const e=i.XpG(2);i.Y8G("projectId",e.inviteUserToProject)}}function UserAutocompleterTemplateComponent_2_Template(e,t){1&e&&i.DNE(0,UserAutocompleterTemplateComponent_2_ng_template_0_Template,1,1,"ng-template",null,1,i.C5r)}class UserAutocompleterTemplateComponent{constructor(){this.isOpenedInModal=!1,this.hoverCards=!0}static{this.ɵfac=function UserAutocompleterTemplateComponent_Factory(e){return new(e||UserAutocompleterTemplateComponent)}}static{this.ɵcmp=i.VBU({type:UserAutocompleterTemplateComponent,selectors:[["ng-component"]],viewQuery:function UserAutocompleterTemplateComponent_Query(e,t){if(1&e&&(i.GBs(l,5),i.GBs(c,5)),2&e){let e;i.mGM(e=i.lsd())&&(t.optionTemplate=e.first),i.mGM(e=i.lsd())&&(t.footerTemplate=e.first)}},inputs:{inviteUserToProject:"inviteUserToProject",isOpenedInModal:"isOpenedInModal",hoverCards:"hoverCards"},decls:3,vars:1,consts:[["optionTemplate",""],["footerTemplate",""],[4,"ngIf"],["size","mini",3,"principal","hideName","hoverCard","hoverCardModalTarget",4,"ngIf"],[1,"op-user-autocompleter--name",3,"opSearchHighlight"],["class","op-autocompleter__option-principal-email",3,"opSearchHighlight",4,"ngIf"],["size","mini",3,"principal","hideName","hoverCard","hoverCardModalTarget"],[1,"op-autocompleter__option-principal-email",3,"opSearchHighlight"],[1,"op-select-footer",3,"projectId"]],template:function UserAutocompleterTemplateComponent_Template(e,t){1&e&&i.DNE(0,UserAutocompleterTemplateComponent_ng_template_0_Template,4,4,"ng-template",null,0,i.C5r)(2,UserAutocompleterTemplateComponent_2_Template,2,0,null,2),2&e&&(i.R7$(2),i.Y8G("ngIf",t.inviteUserToProject))},dependencies:[o.bT,r.f,s.Y,a.p],styles:[".op-autocompleter__option-principal-email[_ngcontent-%COMP%]{color:var(--fgColor-muted);font-size:var(--font-size-small);margin-left:var(--stack-gap-condensed)}@media screen and (max-width: 543px){.op-autocompleter__option-principal-email[_ngcontent-%COMP%]{display:block;margin-left:var(--control-small-size);margin-top:var(--control-xsmall-gap)}}"],changeDetection:0})}}},77938:(e,t,n)=>{"use strict";n.d(t,{P:()=>UserAutocompleterComponent});var i=n(24398),o=n(68559),r=n(51567),s=n(70271),a=n(34456),l=n(54182),c=n(1758),p=n(46303),d=n(89282),u=n(68365),h=n(22179),m=n(55596),g=n(16452),f=n(60316),b=n(62223),k=n(48377);const _c0=(e,t,n)=>({$implicit:e,search:t,index:n}),_c1=(e,t,n,i)=>({$implicit:e,search:t,index:n,clear:i}),_c2=e=>({"padding-left.px":e});function UserAutocompleterComponent_input_1_Template(e,t){if(1&e&&o.nrm(0,"input",10,3),2&e){const e=o.XpG();o.BMQ("name",e.inputName)("data-action",e.hiddenFieldAction)}}function UserAutocompleterComponent_ng_container_2_input_1_Template(e,t){if(1&e&&o.nrm(0,"input",12),2&e){const e=t.$implicit,n=o.XpG(2);o.Y8G("value",e),o.BMQ("name",n.inputName+"[]")("data-action",n.hiddenFieldAction)}}function UserAutocompleterComponent_ng_container_2_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,UserAutocompleterComponent_ng_container_2_input_1_Template,1,3,"input",11),o.bVm()),2&e){const e=o.XpG();o.R7$(),o.Y8G("ngForOf",e.mappedInputValue)}}function UserAutocompleterComponent_7_ng_template_0_Template(e,t){if(1&e&&o.eu8(0,14),2&e){const e=t.item,n=t.index,i=t.searchTerm,r=o.XpG(2);o.Y8G("ngTemplateOutlet",r.headerTemplate||r.projectedHeaderTemplate)("ngTemplateOutletContext",o.sMw(2,_c0,e,i,n))}}function UserAutocompleterComponent_7_Template(e,t){1&e&&o.DNE(0,UserAutocompleterComponent_7_ng_template_0_Template,1,6,"ng-template",13)}function UserAutocompleterComponent_8_ng_template_0_Template(e,t){if(1&e&&o.eu8(0,14),2&e){const e=t.item,n=t.index,i=t.searchTerm,r=t.clear,s=o.XpG(2),a=o.sdS(14);o.Y8G("ngTemplateOutlet",s.projectedLabelTemplate||s.labelTemplate||a)("ngTemplateOutletContext",o.ziG(2,_c1,e,i,n,r))}}function UserAutocompleterComponent_8_Template(e,t){1&e&&o.DNE(0,UserAutocompleterComponent_8_ng_template_0_Template,1,7,"ng-template",15)}function UserAutocompleterComponent_ng_template_9_Template(e,t){if(1&e&&o.eu8(0,14),2&e){const e=t.item,n=t.index,i=t.searchTerm,r=o.XpG(),s=o.sdS(12);o.Y8G("ngTemplateOutlet",r.projectedOptionTemplate||r.optionTemplate||s)("ngTemplateOutletContext",o.sMw(2,_c0,e,i,n))}}function UserAutocompleterComponent_10_ng_template_0_Template(e,t){if(1&e&&o.eu8(0,14),2&e){const e=t.item,n=t.index,i=t.searchTerm,r=o.XpG(2);o.Y8G("ngTemplateOutlet",r.footerTemplate||r.projectedFooterTemplate)("ngTemplateOutletContext",o.sMw(2,_c0,e,i,n))}}function UserAutocompleterComponent_10_Template(e,t){1&e&&o.DNE(0,UserAutocompleterComponent_10_ng_template_0_Template,1,6,"ng-template",16)}function UserAutocompleterComponent_ng_template_11_ng_container_0_Template(e,t){if(1&e&&(o.qex(0),o.nrm(1,"span",18),o.bVm()),2&e){const e=o.XpG(),t=e.$implicit,n=e.search;o.R7$(),o.Y8G("ngOptionHighlight",n)("textContent",t.name)("ngStyle",o.eq3(3,_c2,16*t.depth))}}function UserAutocompleterComponent_ng_template_11_ng_container_1_op_principal_2_Template(e,t){if(1&e&&o.nrm(0,"op-principal",28),2&e){const e=o.XpG(2).$implicit;o.Y8G("principal",e.author)("hideName",!0)}}function UserAutocompleterComponent_ng_template_11_ng_container_1_span_4_Template(e,t){if(1&e&&o.nrm(0,"span",29),2&e){const e=o.XpG(2).$implicit,t=o.XpG();o.Mz_("textContent","",e.type.name," "),o.Y8G("ngClass",t.highlighting("type",e.type.id))}}function UserAutocompleterComponent_ng_template_11_ng_container_1_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"div",19),o.DNE(2,UserAutocompleterComponent_ng_template_11_ng_container_1_op_principal_2_Template,1,2,"op-principal",20),o.j41(3,"span",21),o.DNE(4,UserAutocompleterComponent_ng_template_11_ng_container_1_span_4_Template,1,3,"span",22),o.nrm(5,"span",23),o.k0s(),o.j41(6,"div",24),o.nrm(7,"span",25),o.j41(8,"span",26),o.EFF(9),o.k0s(),o.nrm(10,"span",27),o.k0s()(),o.bVm()),2&e){const e=o.XpG(),t=e.$implicit,n=e.search,i=o.XpG();o.R7$(2),o.Y8G("ngIf",t.author&&t.author.href),o.R7$(2),o.Y8G("ngIf",t.type),o.R7$(),o.Y8G("ngOptionHighlight",n)("textContent",t.subject),o.R7$(2),o.Y8G("ngOptionHighlight",n)("textContent",null==t.project?null:t.project.name),o.R7$(),o.Y8G("ngOptionHighlight",n),o.R7$(),o.SpI("#",t.id,""),o.R7$(),o.Y8G("textContent",null==t.status?null:t.status.name)("ngClass",i.highlighting("status",null==t.status?null:t.status.id))}}function UserAutocompleterComponent_ng_template_11_ng_container_2_op_principal_1_Template(e,t){if(1&e&&o.nrm(0,"op-principal",33),2&e){const e=o.XpG(2).$implicit;o.Y8G("principal",e)("hideName",!0)}}function UserAutocompleterComponent_ng_template_11_ng_container_2_span_4_Template(e,t){if(1&e&&(o.j41(0,"span",34),o.EFF(1),o.k0s()),2&e){const e=o.XpG(2),t=e.$implicit,n=e.search;o.Y8G("ngOptionHighlight",n),o.R7$(),o.JRh(t.email)}}function UserAutocompleterComponent_ng_template_11_ng_container_2_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,UserAutocompleterComponent_ng_template_11_ng_container_2_op_principal_1_Template,1,2,"op-principal",30),o.j41(2,"span",31),o.EFF(3),o.k0s(),o.DNE(4,UserAutocompleterComponent_ng_template_11_ng_container_2_span_4_Template,2,2,"span",32),o.bVm()),2&e){const e=o.XpG(),t=e.$implicit,n=e.search;o.R7$(),o.Y8G("ngIf",t&&t.href),o.R7$(),o.Y8G("ngOptionHighlight",n),o.R7$(),o.JRh(t.name),o.R7$(),o.Y8G("ngIf",t.email)}}function UserAutocompleterComponent_ng_template_11_ng_container_3_span_3_Template(e,t){if(1&e&&(o.j41(0,"span",34),o.EFF(1),o.k0s()),2&e){const e=o.XpG(2),t=e.$implicit,n=e.search;o.Y8G("ngOptionHighlight",n),o.R7$(),o.JRh(t.email)}}function UserAutocompleterComponent_ng_template_11_ng_container_3_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"span",31),o.EFF(2),o.k0s(),o.DNE(3,UserAutocompleterComponent_ng_template_11_ng_container_3_span_3_Template,2,2,"span",32),o.bVm()),2&e){const e=o.XpG(),t=e.$implicit,n=e.search;o.R7$(),o.Y8G("ngOptionHighlight",n),o.R7$(),o.JRh(t.name),o.R7$(),o.Y8G("ngIf",t.email)}}function UserAutocompleterComponent_ng_template_11_Template(e,t){if(1&e&&o.DNE(0,UserAutocompleterComponent_ng_template_11_ng_container_0_Template,2,5,"ng-container",17)(1,UserAutocompleterComponent_ng_template_11_ng_container_1_Template,11,10,"ng-container",17)(2,UserAutocompleterComponent_ng_template_11_ng_container_2_Template,5,4,"ng-container",17)(3,UserAutocompleterComponent_ng_template_11_ng_container_3_Template,4,3,"ng-container",17),2&e){const e=t.$implicit,n=o.XpG();o.Y8G("ngSwitchCase",!n.resource&&!!e.depth),o.R7$(),o.Y8G("ngSwitchCase","work_packages"===n.resource||"parent-child"===n.resource),o.R7$(),o.Y8G("ngSwitchCase","users"===n.resource||"assignee"===n.resource||"principals"===n.resource),o.R7$(),o.Y8G("ngSwitchCase","subproject"===n.resource||"version"===n.resource||"status"===n.resource||"default"===n.resource||!n.resource&&!e.depth)}}function UserAutocompleterComponent_ng_template_13_ng_container_0_span_3_Template(e,t){if(1&e&&(o.j41(0,"span",37),o.EFF(1),o.k0s()),2&e){const e=o.XpG(2),t=e.$implicit,n=e.search;o.Y8G("ngOptionHighlight",n),o.R7$(),o.E5c(" ",null==t.type?null:t.type.name," #",t.id," ",t.subject||t.name," ")}}function UserAutocompleterComponent_ng_template_13_ng_container_0_Template(e,t){if(1&e){const e=o.RV6();o.qex(0),o.j41(1,"span",35),o.bIt("click",(function UserAutocompleterComponent_ng_template_13_ng_container_0_Template_span_click_1_listener(){o.eBV(e);const t=o.XpG(),n=t.$implicit,i=t.clear;return o.Njj(i(n))})),o.EFF(2,"×"),o.k0s(),o.DNE(3,UserAutocompleterComponent_ng_template_13_ng_container_0_span_3_Template,2,4,"span",36),o.bVm()}if(2&e){const e=o.XpG().$implicit;o.R7$(3),o.Y8G("ngIf",e.id)}}function UserAutocompleterComponent_ng_template_13_ng_container_1_Template(e,t){if(1&e){const e=o.RV6();o.qex(0),o.j41(1,"span",35),o.bIt("click",(function UserAutocompleterComponent_ng_template_13_ng_container_1_Template_span_click_1_listener(){o.eBV(e);const t=o.XpG(),n=t.$implicit,i=t.clear;return o.Njj(i(n))})),o.EFF(2,"×"),o.k0s(),o.j41(3,"span",37),o.EFF(4),o.k0s(),o.bVm()}if(2&e){const e=o.XpG(),t=e.$implicit,n=e.search;o.R7$(3),o.Y8G("ngOptionHighlight",n),o.R7$(),o.JRh(t.name)}}function UserAutocompleterComponent_ng_template_13_Template(e,t){if(1&e&&o.DNE(0,UserAutocompleterComponent_ng_template_13_ng_container_0_Template,4,1,"ng-container",6)(1,UserAutocompleterComponent_ng_template_13_ng_container_1_Template,5,2,"ng-container",6),2&e){const e=o.XpG();o.Y8G("ngIf","work_packages"===e.resource),o.R7$(),o.Y8G("ngIf","work_packages"!==e.resource)}}class UserAutocompleterComponent extends p.T{constructor(){super(...arguments),this.isOpenedInModal=!1,this.hoverCards=!0,this.url=this.apiV3Service.users.path,this.userInvited=new o.bkB,this.getOptionsFn=this.getAvailableUsers.bind(this)}ngOnInit(){super.ngOnInit(),this.showUserHoverCard||(this.hoverCards=!1),this.applyTemplates(h.b,{inviteUserToProject:this.inviteUserToProject,isOpenedInModal:this.isOpenedInModal,hoverCards:this.hoverCards}),this.opInviteUserModalService.close.pipe(this.untilDestroyed(),(0,r.p)((e=>!!e))).subscribe((e=>{this.userInvited.emit(e)}))}getAvailableUsers(e){const t=this.buildFilteredURL(e);return t.searchParams.set("pageSize","-1"),t.searchParams.set("select","elements/id,elements/name,elements/email,elements/self,total,count,pageSize"),this.http.get(t.toString()).pipe((0,s.T)((e=>_.uniqBy(e._embedded.elements,(e=>e._links.self?.href||e.id)))),(0,s.T)((e=>e.map((e=>({id:e.id,name:e.name,href:e._links.self?.href,email:e.email}))))))}buildFilteredURL(e){const t=_.keyBy(this.filters,"name"),n=d.hG.fromFilterObject(t);return e?.length&&n.add(this.searchKey||"name","~",[e]),(0,u.R)(this.url,n)}addNewObjectFn(e){return{id:e,name:e,href:null,avatar:null}}defaultTrackByFunction(){return e=>e.href||e.name}defaultCompareWithFunction(){return(0,m.bO)("href","name")}static{this.ɵfac=(()=>{let e;return function UserAutocompleterComponent_Factory(t){return(e||(e=o.xGo(UserAutocompleterComponent)))(t||UserAutocompleterComponent)}})()}static{this.ɵcmp=o.VBU({type:UserAutocompleterComponent,selectors:[["op-user-autocompleter"]],inputs:{inviteUserToProject:"inviteUserToProject",isOpenedInModal:"isOpenedInModal",hoverCards:"hoverCards",url:"url"},outputs:{userInvited:"userInvited"},features:[o.Jv_([{provide:a.kq,useExisting:(0,o.Rfq)((()=>UserAutocompleterComponent)),multi:!0},l.Q]),o.Vt3],decls:15,vars:59,consts:[["ngSelectInstance",""],["defaultOption",""],["defaultLabel",""],["syncedInput",""],[1,"inline-label"],["type","hidden",4,"ngIf"],[4,"ngIf"],[3,"ngModelChange","change","open","close","blur","focus","clear","keydown","keydown.escape","search","scroll","scrollToEnd","add","remove","ngModel","items","ngClass","typeahead","clearOnBackspace","clearSearchOnAdd","hideSelected","appendTo","multiple","loading","addTag","virtualScroll","required","clearable","closeOnSelect","openOnEnter","disabled","name","id","bindLabel","bindValue","markFirst","notFoundText","addTagText","loadingText","clearAllText","appearance","dropdownPosition","selectOnTab","maxSelectedItems","placeholder","groupBy","groupValue","bufferAmount","selectableGroup","searchable","selectableGroupAsModel","trackByFn","compareWith","searchFn","labelForId","inputAttrs","tabIndex","readonly","searchWhileComposing","minTermLength","editableSearchTerm","keyDownFn"],["ng-option-tmp",""],[3,"ngSwitch"],["type","hidden"],["type","hidden",3,"value",4,"ngFor","ngForOf"],["type","hidden",3,"value"],["ng-header-tmp",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["ng-label-tmp",""],["ng-footer-tmp",""],[4,"ngSwitchCase"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight","textContent","ngStyle"],[1,"op-autocompleter--option-wrapper"],["class","op-autocompleter--option-principal",3,"principal","hideName",4,"ngIf"],["data-test-selector","op-autocompleter-item-subject",1,"op-autocompleter--wp-subject"],[3,"ngClass","textContent",4,"ngIf"],[3,"ngOptionHighlight","textContent"],[1,"op-autocompleter--wp-content"],[1,"op-autocompleter--wp-project",3,"ngOptionHighlight","textContent"],[1,"op-autocompleter--wp-id",3,"ngOptionHighlight"],[1,"op-autocompleter--wp-status",3,"textContent","ngClass"],[1,"op-autocompleter--option-principal",3,"principal","hideName"],[3,"ngClass","textContent"],["class","op-autocompleter--option-principal-avatar","size","mini",3,"principal","hideName",4,"ngIf"],[3,"ngOptionHighlight"],["class","op-autocompleter__option-principal-email",3,"ngOptionHighlight",4,"ngIf"],["size","mini",1,"op-autocompleter--option-principal-avatar",3,"principal","hideName"],[1,"op-autocompleter__option-principal-email",3,"ngOptionHighlight"],[1,"ng-value-icon","left",3,"click"],["class","ng-value-label",3,"ngOptionHighlight",4,"ngIf"],[1,"ng-value-label",3,"ngOptionHighlight"]],template:function UserAutocompleterComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",4),o.DNE(1,UserAutocompleterComponent_input_1_Template,2,2,"input",5)(2,UserAutocompleterComponent_ng_container_2_Template,2,1,"ng-container",6),o.j41(3,"ng-select",7,0),o.nI1(5,"async"),o.nI1(6,"async"),o.mxI("ngModelChange",(function UserAutocompleterComponent_Template_ng_select_ngModelChange_3_listener(n){return o.eBV(e),o.DH7(t.model,n)||(t.model=n),o.Njj(n)})),o.bIt("change",(function UserAutocompleterComponent_Template_ng_select_change_3_listener(n){return o.eBV(e),o.Njj(t.changed(n))}))("open",(function UserAutocompleterComponent_Template_ng_select_open_3_listener(){return o.eBV(e),o.Njj(t.opened())}))("close",(function UserAutocompleterComponent_Template_ng_select_close_3_listener(){return o.eBV(e),o.Njj(t.closed())}))("blur",(function UserAutocompleterComponent_Template_ng_select_blur_3_listener(n){return o.eBV(e),o.Njj(t.blured(n))}))("focus",(function UserAutocompleterComponent_Template_ng_select_focus_3_listener(n){return o.eBV(e),o.Njj(t.focused(n))}))("clear",(function UserAutocompleterComponent_Template_ng_select_clear_3_listener(n){return o.eBV(e),o.Njj(t.cleared(n))}))("keydown",(function UserAutocompleterComponent_Template_ng_select_keydown_3_listener(n){return o.eBV(e),o.Njj(t.keydowned(n))}))("keydown.escape",(function UserAutocompleterComponent_Template_ng_select_keydown_escape_3_listener(n){return o.eBV(e),o.Njj(t.canceled(n))}))("search",(function UserAutocompleterComponent_Template_ng_select_search_3_listener(n){return o.eBV(e),o.Njj(t.searched(n))}))("scroll",(function UserAutocompleterComponent_Template_ng_select_scroll_3_listener(n){return o.eBV(e),o.Njj(t.scrolled(n))}))("scrollToEnd",(function UserAutocompleterComponent_Template_ng_select_scrollToEnd_3_listener(n){return o.eBV(e),o.Njj(t.scrolledToEnd(n))}))("add",(function UserAutocompleterComponent_Template_ng_select_add_3_listener(n){return o.eBV(e),o.Njj(t.added(n))}))("remove",(function UserAutocompleterComponent_Template_ng_select_remove_3_listener(n){return o.eBV(e),o.Njj(t.removed(n))})),o.DNE(7,UserAutocompleterComponent_7_Template,1,0,null,6)(8,UserAutocompleterComponent_8_Template,1,0,null,6)(9,UserAutocompleterComponent_ng_template_9_Template,1,6,"ng-template",8)(10,UserAutocompleterComponent_10_Template,1,0,null,6),o.k0s()(),o.DNE(11,UserAutocompleterComponent_ng_template_11_Template,4,4,"ng-template",9,1,o.C5r)(13,UserAutocompleterComponent_ng_template_13_Template,2,2,"ng-template",null,2,o.C5r)}2&e&&(o.R7$(),o.Y8G("ngIf",t.inputName&&!(t.multiple&&t.multipleAsSeparateInputs)),o.R7$(),o.Y8G("ngIf",t.multiple&&t.multipleAsSeparateInputs),o.R7$(),o.R50("ngModel",t.model),o.Y8G("items",o.bMT(5,55,t.results$))("ngClass",t.classes)("typeahead",t.typeahead)("clearOnBackspace",t.clearOnBackspace)("clearSearchOnAdd",t.clearSearchOnAdd)("hideSelected",t.hideSelected)("appendTo",t.appendTo)("multiple",t.multiple)("loading",o.bMT(6,57,t.loading$))("addTag",t.addTag)("virtualScroll",t.virtualScroll)("required",t.required)("clearable",t.clearable)("closeOnSelect",t.closeOnSelect)("openOnEnter",t.openOnEnter)("disabled",t.disabled)("name",t.name)("id",t.id)("bindLabel",t.bindLabel)("bindValue",t.bindValue)("markFirst",t.markFirst)("notFoundText",t.notFoundText)("addTagText",t.addTagText)("loadingText",t.loadingText)("clearAllText",t.clearAllText)("appearance",t.appearance)("dropdownPosition",t.dropdownPosition)("selectOnTab",t.selectOnTab)("maxSelectedItems",t.maxSelectedItems)("placeholder",t.placeholder)("groupBy",t.groupBy)("groupValue",t.groupValue)("bufferAmount",t.bufferAmount)("selectableGroup",t.selectableGroup)("searchable",t.searchable)("selectableGroupAsModel",t.selectableGroupAsModel)("trackByFn",t.trackByFn)("compareWith",t.compareWith)("searchFn",t.searchFn)("labelForId",t.labelForId)("inputAttrs",t.inputAttrs)("tabIndex",t.tabIndex)("readonly",t.readonly)("searchWhileComposing",t.searchWhileComposing)("minTermLength",t.minTermLength)("editableSearchTerm",t.editableSearchTerm)("keyDownFn",t.keyDownFn),o.BMQ("accesskey",t.accesskey||void 0),o.R7$(4),o.Y8G("ngIf",t.headerTemplate||t.projectedHeaderTemplate),o.R7$(),o.Y8G("ngIf",t.labelRequired),o.R7$(2),o.Y8G("ngIf",t.footerTemplate||t.projectedFooterTemplate),o.R7$(),o.Y8G("ngSwitch",!0))},dependencies:[f.YU,f.Sq,f.bT,f.T3,f.B3,f.ux,f.e1,b.vr,b.Uq,b.ZZ,b.Uc,b.q8,a.BC,a.YS,a.vS,k.f,f.Jj],styles:["ng-dropdown-panel:has(.op-user-autocompleter--name){min-width:300px!important}\n"],encapsulation:2,changeDetection:0})}}(0,i.Cg)([(0,c.O)(l.Q),(0,i.Sn)("design:type",l.Q)],UserAutocompleterComponent.prototype,"opInviteUserModalService",void 0),(0,i.Cg)([(0,c.O)(g.k,!0),(0,i.Sn)("design:type",Boolean)],UserAutocompleterComponent.prototype,"showUserHoverCard",void 0)},97564:(e,t,n)=>{"use strict";n.d(t,{e:()=>VersionAutocompleterComponent});var i=n(68559),o=n(86866),r=n(89120),s=n(14593),a=n(40358),l=n(61816),c=n(73014),p=n(56196),d=n(60316),u=n(62223),h=n(34456);const _c0=e=>({"padding-left.px":e});function VersionAutocompleterComponent_ng_template_2_Template(e,t){if(1&e&&(i.nrm(0,"b",4),i.EFF(1)),2&e){const e=t.searchTerm,n=i.XpG();i.Y8G("textContent",n.text.add_new_action),i.R7$(),i.SpI(": ",e," ")}}function VersionAutocompleterComponent_ng_template_3_Template(e,t){if(1&e&&i.nrm(0,"span",5),2&e){const e=t.item,n=t.searchTerm;i.Y8G("ngOptionHighlight",n)("textContent",e.name)("ngStyle",i.eq3(3,_c0,16*e.depth))}}class VersionAutocompleterComponent extends r.I{constructor(e,t,n,o,r,s,a){super(e),this.injector=e,this.I18n=t,this.currentProject=n,this.cdRef=o,this.pathHelper=r,this.apiV3Service=s,this.halNotification=a,this.onCreate=new i.bkB}ngAfterViewInit(){super.ngAfterViewInit(),this.canCreateNewActionElements().then((e=>{e&&(this.createAllowed=e=>this.createNewVersion(e),this.cdRef.detectChanges())}))}canCreateNewActionElements(){return this.currentProject.id?(0,p._)(this.apiV3Service.versions.available_projects.exists(this.currentProject.id)).catch((()=>!1)):Promise.resolve(!1)}createNewVersion(e){this.apiV3Service.versions.post(this.getVersionPayload(e)).subscribe((e=>this.onCreate.emit(e)),(e=>{this.closeSelect(),this.halNotification.handleRawError(e)}))}getVersionPayload(e){const t={};return t.name=e,t._links={definingProject:{href:this.apiV3Service.projects.id(this.currentProject.id).path}},t}static{this.ɵfac=function VersionAutocompleterComponent_Factory(e){return new(e||VersionAutocompleterComponent)(i.rXU(i.zZn),i.rXU(l.W),i.rXU(o.c),i.rXU(i.gRc),i.rXU(c.B),i.rXU(s.n),i.rXU(a.Y))}}static{this.ɵcmp=i.VBU({type:VersionAutocompleterComponent,selectors:[["version-autocompleter"]],outputs:{onCreate:"onCreate"},features:[i.Vt3],decls:4,vars:15,consts:[["ngSelectComponent",""],["bindLabel","name",3,"ngModelChange","change","open","close","keydown","ngModel","items","ngClass","addTag","virtualScroll","required","clearable","disabled","typeahead","clearOnBackspace","clearSearchOnAdd","appendTo","hideSelected","compareWith","id"],["ng-tag-tmp",""],["ng-option-tmp",""],[3,"textContent"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight","textContent","ngStyle"]],template:function VersionAutocompleterComponent_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"ng-select",1,0),i.mxI("ngModelChange",(function VersionAutocompleterComponent_Template_ng_select_ngModelChange_0_listener(n){return i.eBV(e),i.DH7(t.model,n)||(t.model=n),i.Njj(n)})),i.bIt("change",(function VersionAutocompleterComponent_Template_ng_select_change_0_listener(n){return i.eBV(e),i.Njj(t.changeModel(n))}))("open",(function VersionAutocompleterComponent_Template_ng_select_open_0_listener(){return i.eBV(e),i.Njj(t.opened())}))("close",(function VersionAutocompleterComponent_Template_ng_select_close_0_listener(){return i.eBV(e),i.Njj(t.closed())}))("keydown",(function VersionAutocompleterComponent_Template_ng_select_keydown_0_listener(n){return i.eBV(e),i.Njj(t.keyPressed(n))})),i.DNE(2,VersionAutocompleterComponent_ng_template_2_Template,2,2,"ng-template",2)(3,VersionAutocompleterComponent_ng_template_3_Template,1,5,"ng-template",3),i.k0s()}2&e&&(i.R50("ngModel",t.model),i.Y8G("items",t.availableValues)("ngClass",t.classes)("addTag",t.createAllowed)("virtualScroll",!0)("required",t.required)("clearable",!t.required)("disabled",t.disabled)("typeahead",t.typeahead)("clearOnBackspace",!1)("clearSearchOnAdd",!1)("appendTo",t.appendTo)("hideSelected",t.hideSelected)("compareWith",t.compareByHref)("id",t.id))},dependencies:[d.YU,d.B3,u.vr,u.Uq,u.BW,h.BC,h.YS,h.vS],encapsulation:2})}}},16455:(e,t,n)=>{"use strict";n.d(t,{R:()=>WorkPackageAutocompleterComponent});var i=n(89120),o=n(68559),r=n(60316),s=n(62223),a=n(34456);const _c0=e=>({"padding-left.px":e});function WorkPackageAutocompleterComponent_ng_template_2_Template(e,t){if(1&e&&(o.nrm(0,"b",4),o.EFF(1)),2&e){const e=t.searchTerm,n=o.XpG();o.Y8G("textContent",n.text.add_new_action),o.R7$(),o.SpI(": ",e," ")}}function WorkPackageAutocompleterComponent_ng_template_3_Template(e,t){if(1&e&&o.nrm(0,"span",5),2&e){const e=t.item,n=t.searchTerm;o.Y8G("ngOptionHighlight",n)("textContent",e.name)("ngStyle",o.eq3(3,_c0,16*e.depth))}}class WorkPackageAutocompleterComponent extends i.I{static{this.ɵfac=(()=>{let e;return function WorkPackageAutocompleterComponent_Factory(t){return(e||(e=o.xGo(WorkPackageAutocompleterComponent)))(t||WorkPackageAutocompleterComponent)}})()}static{this.ɵcmp=o.VBU({type:WorkPackageAutocompleterComponent,selectors:[["wp-autocompleter"]],features:[o.Vt3],decls:4,vars:15,consts:[["ngSelectComponent",""],["bindLabel","name",3,"ngModelChange","change","open","close","keydown","ngModel","items","ngClass","addTag","virtualScroll","required","clearable","disabled","typeahead","clearOnBackspace","clearSearchOnAdd","appendTo","hideSelected","compareWith","id"],["ng-tag-tmp",""],["ng-option-tmp",""],[3,"textContent"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight","textContent","ngStyle"]],template:function WorkPackageAutocompleterComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"ng-select",1,0),o.mxI("ngModelChange",(function WorkPackageAutocompleterComponent_Template_ng_select_ngModelChange_0_listener(n){return o.eBV(e),o.DH7(t.model,n)||(t.model=n),o.Njj(n)})),o.bIt("change",(function WorkPackageAutocompleterComponent_Template_ng_select_change_0_listener(n){return o.eBV(e),o.Njj(t.changeModel(n))}))("open",(function WorkPackageAutocompleterComponent_Template_ng_select_open_0_listener(){return o.eBV(e),o.Njj(t.opened())}))("close",(function WorkPackageAutocompleterComponent_Template_ng_select_close_0_listener(){return o.eBV(e),o.Njj(t.closed())}))("keydown",(function WorkPackageAutocompleterComponent_Template_ng_select_keydown_0_listener(n){return o.eBV(e),o.Njj(t.keyPressed(n))})),o.DNE(2,WorkPackageAutocompleterComponent_ng_template_2_Template,2,2,"ng-template",2)(3,WorkPackageAutocompleterComponent_ng_template_3_Template,1,5,"ng-template",3),o.k0s()}2&e&&(o.R50("ngModel",t.model),o.Y8G("items",t.availableValues)("ngClass",t.classes)("addTag",t.createAllowed)("virtualScroll",!0)("required",t.required)("clearable",!t.required)("disabled",t.disabled)("typeahead",t.typeahead)("clearOnBackspace",!1)("clearSearchOnAdd",!1)("appendTo",t.appendTo)("hideSelected",t.hideSelected)("compareWith",t.compareByHref)("id",t.id))},dependencies:[r.YU,r.B3,s.vr,s.Uq,s.BW,a.BC,a.YS,a.vS],encapsulation:2})}}},68481:(e,t,n)=>{"use strict";n.d(t,{x:()=>CollapsibleSectionComponent});var i=n(68559),o=n(60316);const r=["sectionBody"],_c1=e=>({"-expanded":e});class CollapsibleSectionComponent{constructor(e){this.elementRef=e,this.expanded=!1}ngOnInit(){const e=this.elementRef.nativeElement;this.sectionTitle=e.getAttribute("section-title"),"true"===e.getAttribute("initially-expanded")&&(this.expanded=!0);const t=e.nextElementSibling;this.sectionBody.nativeElement.appendChild(t),t.removeAttribute("hidden")}toggle(e){this.expanded=!this.expanded,e.preventDefault()}static{this.ɵfac=function CollapsibleSectionComponent_Factory(e){return new(e||CollapsibleSectionComponent)(i.rXU(i.aKT))}}static{this.ɵcmp=i.VBU({type:CollapsibleSectionComponent,selectors:[["opce-opce-collapsible-section-augment"]],viewQuery:function CollapsibleSectionComponent_Query(e,t){if(1&e&&i.GBs(r,7),2&e){let e;i.mGM(e=i.lsd())&&(t.sectionBody=e.first)}},decls:5,vars:5,consts:[["sectionBody",""],[1,"collapsible-section",3,"ngClass"],[1,"collapsible-section--toggle-link",3,"click"],[1,"collapsible-section--legend",3,"textContent"],[1,"collapsible-section--body","toggle-slide-animation",3,"hidden"]],template:function CollapsibleSectionComponent_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"section",1)(1,"button",2),i.bIt("click",(function CollapsibleSectionComponent_Template_button_click_1_listener(n){return i.eBV(e),i.Njj(t.toggle(n))})),i.nrm(2,"span",3),i.k0s(),i.nrm(3,"div",4,0),i.k0s()}2&e&&(i.Y8G("ngClass",i.eq3(3,_c1,t.expanded)),i.R7$(2),i.Y8G("textContent",t.sectionTitle),i.R7$(),i.Y8G("hidden",!t.expanded))},dependencies:[o.YU],encapsulation:2})}}},24128:(e,t,n)=>{"use strict";n.d(t,{w:()=>ColorsAutocompleterComponent});var i=n(46116),o=n(61816),r=n(68559),s=n(60316),a=n(62223),l=n(34456);function ColorsAutocompleterComponent_ng_template_1_Template(e,t){if(1&e&&(r.j41(0,"span",3),r.EFF(1),r.k0s()),2&e){const e=t.item,n=r.XpG();r.Y8G("ngClass",n.highlightColor(e)),r.R7$(),r.JRh(e.name)}}function ColorsAutocompleterComponent_ng_template_2_Template(e,t){if(1&e&&(r.j41(0,"span",3),r.EFF(1),r.k0s()),2&e){const e=t.item,n=r.XpG();r.Y8G("ngClass",n.highlightColor(e)),r.R7$(),r.JRh(e.name)}}class ColorsAutocompleterComponent{constructor(e,t){this.elementRef=e,this.I18n=t,this.highlightTextInline=!1}ngOnInit(){this.setColorOptions(),this.updateInputField=document.getElementsByName(this.elementRef.nativeElement.dataset.updateInput)[0],this.highlightTextInline=JSON.parse(this.elementRef.nativeElement.dataset.highlightTextInline||"false"),this.classes=this.elementRef.nativeElement.dataset.classes||""}onModelChange(e){e&&this.updateInputField&&(this.updateInputField.value=e.value)}setColorOptions(){this.options=JSON.parse(this.elementRef.nativeElement.dataset.colors),this.options.unshift({name:this.I18n.t("js.label_no_color"),value:""}),this.selectedOption=this.options.find((e=>!0===e.selected)),this.selectedOption?this.selectedOption=this.selectedOption.value:(this.selectedColorId=this.elementRef.nativeElement.dataset.selectedColor,this.selectedOption=this.selectedColorId?this.selectedColorId:"")}highlightColor(e){if(""===e.value)return;let t;return t=this.highlightTextInline?"__hl_inline_type_ ":"__hl_inline_ ",t+i.H.colorClass(this.highlightTextInline,e.value)}static{this.ɵfac=function ColorsAutocompleterComponent_Factory(e){return new(e||ColorsAutocompleterComponent)(r.rXU(r.aKT),r.rXU(o.W))}}static{this.ɵcmp=r.VBU({type:ColorsAutocompleterComponent,selectors:[["opce-colors-autocompleter"]],decls:3,vars:5,consts:[["bindLabel","name","bindValue","value","appendTo","body",3,"ngModelChange","change","items","virtualScroll","ngModel","ngClass","clearable"],["ng-label-tmp",""],["ng-option-tmp",""],[3,"ngClass"]],template:function ColorsAutocompleterComponent_Template(e,t){1&e&&(r.j41(0,"ng-select",0),r.mxI("ngModelChange",(function ColorsAutocompleterComponent_Template_ng_select_ngModelChange_0_listener(e){return r.DH7(t.selectedOption,e)||(t.selectedOption=e),e})),r.bIt("change",(function ColorsAutocompleterComponent_Template_ng_select_change_0_listener(e){return t.onModelChange(e)})),r.DNE(1,ColorsAutocompleterComponent_ng_template_1_Template,2,2,"ng-template",1)(2,ColorsAutocompleterComponent_ng_template_2_Template,2,2,"ng-template",2),r.k0s()),2&e&&(r.Y8G("items",t.options)("virtualScroll",!0),r.R50("ngModel",t.selectedOption),r.Y8G("ngClass",t.classes)("clearable",!1))},dependencies:[s.YU,a.vr,a.Uq,a.ZZ,l.BC,l.vS],encapsulation:2,changeDetection:0})}}},55939:(e,t,n)=>{"use strict";n.d(t,{e:()=>ColorsService,s:()=>o});var i=n(68559);const o={lightHighContrast:"lightHighContrast",light:"light",dark:"dark"};class ColorsService{toHsl(e,t){return`hsl(${this.valueHash(e)}, 50%, ${t===o.lightHighContrast?"30%":"50%"})`}toHsla(e,t){return`hsla(${this.valueHash(e)}, 50%, 30%, ${t}%)`}valueHash(e){let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return t%360}colorMode(){return"dark"===document.body.getAttribute("data-color-mode")?o.dark:"light_high_contrast"===document.body.getAttribute("data-light-theme")?o.lightHighContrast:o.light}static{this.ɵfac=function ColorsService_Factory(e){return new(e||ColorsService)}}static{this.ɵprov=i.jDH({token:ColorsService,factory:ColorsService.ɵfac,providedIn:"root"})}}},86757:(e,t,n)=>{"use strict";n.d(t,{_:()=>CopyToClipboardComponent});var i=n(72650),o=n(61816),r=n(36777),s=n(68559);class CopyToClipboardComponent{constructor(e,t,n,i){this.toastService=e,this.elementRef=t,this.I18n=n,this.copyToClipboardService=i}ngOnInit(){const e=this.elementRef.nativeElement;this.clickTarget=e.getAttribute("click-target"),this.clipboardTarget=e.getAttribute("clipboard-target"),jQuery(this.clickTarget).on("click",(e=>this.onClick(e))),e.classList.add("copy-to-clipboard"),this.target=jQuery(this.clipboardTarget?this.clipboardTarget:e)}onClick(e){e.preventDefault(),this.target.select().focus(),this.copyToClipboardService.copy(String(this.target.val()))}static{this.ɵfac=function CopyToClipboardComponent_Factory(e){return new(e||CopyToClipboardComponent)(s.rXU(i.fw),s.rXU(s.aKT),s.rXU(o.W),s.rXU(r.g))}}static{this.ɵcmp=s.VBU({type:CopyToClipboardComponent,selectors:[["opce-copy-to-clipboard"]],decls:0,vars:0,template:function CopyToClipboardComponent_Template(e,t){},encapsulation:2,changeDetection:0})}}},36777:(e,t,n)=>{"use strict";n.d(t,{g:()=>CopyToClipboardService});var i=n(72650),o=n(61816),r=n(68559);class CopyToClipboardService{constructor(e,t){this.toastService=e,this.I18n=t}copy(e,t){navigator.clipboard?navigator.clipboard.writeText(e).then((()=>{this.addNotification("addSuccess",t||this.I18n.t("js.clipboard.copied_successful"))})).catch((()=>{this.addNotification("addError",this.I18n.t("js.clipboard.browser_error",{content:e}))})):this.addNotification("addError",this.I18n.t("js.clipboard.browser_error",{content:e}))}addNotification(e,t){const n=this.toastService[e](t);n&&setTimeout((()=>this.toastService.remove(n)),5e3)}static{this.ɵfac=function CopyToClipboardService_Factory(e){return new(e||CopyToClipboardService)(r.KVO(i.fw),r.KVO(o.W))}}static{this.ɵprov=r.jDH({token:CopyToClipboardService,factory:CopyToClipboardService.ɵfac,providedIn:"root"})}}},37749:(e,t,n)=>{"use strict";n.d(t,{w:()=>populateInputsFromDataset});n(99585);function populateInputsFromDataset(e){const t=e.constructor,n=Object.keys(t).find((e=>"object"==typeof t[e].declaredInputs));if(!n)return void console.warn("Could not find declared inputs for component");const i=t[n].declaredInputs;Object.keys(i).forEach((t=>{const n=i[t],{dataset:o}=e.elementRef.nativeElement;if(o[t])try{e[n]=JSON.parse(o[t]||"")}catch(n){throw console.error("Couldn't parse input: ",t,e.elementRef.nativeElement.dataset),console.error("\nMake sure to make all data attributes you want to use as input JSON parseable.\nThis means that plain strings have to be wrapped in double quotes, and the attribute value is easiest to set with single quotes.\nAn example:\n\n<op-example example-input='\"myString\"'></op-example>\n"),n}}))}},2731:(e,t,n)=>{"use strict";n.d(t,{U:()=>OpDateTimeComponent});var i=n(32420),o=n(68559);class OpDateTimeComponent{constructor(e){this.timezoneService=e}ngOnInit(){const e=this.timezoneService.formattedDatetimeComponents(this.dateTimeValue);this.date=e[0],this.time=e[1]}static{this.ɵfac=function OpDateTimeComponent_Factory(e){return new(e||OpDateTimeComponent)(o.rXU(i.D))}}static{this.ɵcmp=o.VBU({type:OpDateTimeComponent,selectors:[["op-date-time"]],inputs:{dateTimeValue:"dateTimeValue"},decls:5,vars:5,consts:[[3,"title"],[3,"textContent"]],template:function OpDateTimeComponent_Template(e,t){1&e&&(o.j41(0,"span",0),o.nrm(1,"span",1),o.j41(2,"span"),o.EFF(3," "),o.k0s(),o.nrm(4,"span",1),o.k0s()),2&e&&(o.FCK("title","",t.date," ",t.time,""),o.R7$(),o.Y8G("textContent",t.date),o.R7$(3),o.Y8G("textContent",t.time))},encapsulation:2})}}},6811:(e,t,n)=>{"use strict";n.d(t,{J:()=>OpDatePickerBannerComponent});var i=n(61816),o=n(70271),r=n(64334),s=n(83093),a=n(42446),l=n(68559),c=n(60316),p=n(42225);function OpDatePickerBannerComponent_op_modal_banner_0_Template(e,t){if(1&e){const e=l.RV6();l.j41(0,"op-modal-banner",3),l.bIt("buttonClicked",(function OpDatePickerBannerComponent_op_modal_banner_0_Template_op_modal_banner_buttonClicked_0_listener(t){l.eBV(e);const n=l.XpG();return l.Njj(n.openGantt(t))})),l.k0s()}if(2&e){const e=l.XpG();l.Y8G("title",e.text.manually_scheduled)("subtitle",e.text.click_on_show_relations_to_open_gantt)("actionButton",e.text.show_relations_button)}}function OpDatePickerBannerComponent_op_modal_banner_2_Template(e,t){if(1&e){const e=l.RV6();l.j41(0,"op-modal-banner",4),l.bIt("buttonClicked",(function OpDatePickerBannerComponent_op_modal_banner_2_Template_op_modal_banner_buttonClicked_0_listener(t){l.eBV(e);const n=l.XpG();return l.Njj(n.openGantt(t))})),l.k0s()}if(2&e){const e=l.XpG();l.Y8G("title",e.text.automatically_scheduled_parent)("subtitle",e.text.click_on_show_relations_to_open_gantt)("actionButton",e.text.show_relations_button)}}function OpDatePickerBannerComponent_ng_container_3_op_modal_banner_1_Template(e,t){if(1&e){const e=l.RV6();l.j41(0,"op-modal-banner",4),l.bIt("buttonClicked",(function OpDatePickerBannerComponent_ng_container_3_op_modal_banner_1_Template_op_modal_banner_buttonClicked_0_listener(t){l.eBV(e);const n=l.XpG(2);return l.Njj(n.openGantt(t))})),l.k0s()}if(2&e){const e=l.XpG(2);l.Y8G("title",e.text.start_date_limited_by_relations)("subtitle",e.text.click_on_show_relations_to_open_gantt)("actionButton",e.text.show_relations_button)}}function OpDatePickerBannerComponent_ng_container_3_op_modal_banner_4_Template(e,t){if(1&e){const e=l.RV6();l.j41(0,"op-modal-banner",3),l.bIt("buttonClicked",(function OpDatePickerBannerComponent_ng_container_3_op_modal_banner_4_Template_op_modal_banner_buttonClicked_0_listener(t){l.eBV(e);const n=l.XpG(2);return l.Njj(n.openGantt(t))})),l.k0s()}if(2&e){const e=l.XpG(2);l.Y8G("title",e.text.changing_dates_affects_follow_relations)("subtitle",e.text.click_on_show_relations_to_open_gantt)("actionButton",e.text.show_relations_button)}}function OpDatePickerBannerComponent_ng_container_3_Template(e,t){if(1&e&&(l.qex(0),l.DNE(1,OpDatePickerBannerComponent_ng_container_3_op_modal_banner_1_Template,1,3,"op-modal-banner",1),l.nI1(2,"async"),l.nI1(3,"async"),l.DNE(4,OpDatePickerBannerComponent_ng_container_3_op_modal_banner_4_Template,1,3,"op-modal-banner",0),l.nI1(5,"async"),l.bVm()),2&e){const e=l.XpG();l.R7$(),l.Y8G("ngIf",!0===l.bMT(2,2,e.hasPrecedingRelations$)&&!1===l.bMT(3,4,e.hasFollowingRelations$)&&!e.isChild),l.R7$(3),l.Y8G("ngIf",!0===l.bMT(5,6,e.hasFollowingRelations$)||e.isChild)}}class OpDatePickerBannerComponent{get isParent(){return this.dateModalRelations.isParent}get isChild(){return this.dateModalRelations.isChild}constructor(e,t,n,i){this.dateModalRelations=e,this.injector=t,this.I18n=n,this.state=i,this.scheduleManually=!1,this.hasRelations$=this.dateModalRelations.hasRelations$,this.hasPrecedingRelations$=this.dateModalRelations.precedingWorkPackages$.pipe((0,o.T)((e=>e?.length>0))),this.hasFollowingRelations$=this.dateModalRelations.followingWorkPackages$.pipe((0,o.T)((e=>e?.length>0))),this.text={automatically_scheduled_parent:this.I18n.t("js.work_packages.datepicker_modal.automatically_scheduled_parent"),manually_scheduled:this.I18n.t("js.work_packages.datepicker_modal.manually_scheduled"),start_date_limited_by_relations:this.I18n.t("js.work_packages.datepicker_modal.start_date_limited_by_relations"),changing_dates_affects_follow_relations:this.I18n.t("js.work_packages.datepicker_modal.changing_dates_affects_follow_relations"),click_on_show_relations_to_open_gantt:this.I18n.t("js.work_packages.datepicker_modal.click_on_show_relations_to_open_gantt",{button_name:this.I18n.t("js.work_packages.datepicker_modal.show_relations")}),show_relations_button:this.I18n.t("js.work_packages.datepicker_modal.show_relations")}}openGantt(e){e.preventDefault(),this.dateModalRelations.getInvolvedWorkPackageIds().pipe((0,r.s)(1)).subscribe((e=>{const t={c:["id","subject","type","status","assignee","project","startDate","dueDate"],t:"id:asc",tv:!0,hi:!0,f:[{n:"id",o:"=",v:e}]},n=this.state.href("gantt.partitioned.list",{query_id:null,projects:null,projectPath:null,query_props:JSON.stringify(t)});window.open(n,"_blank")}))}static{this.ɵfac=function OpDatePickerBannerComponent_Factory(e){return new(e||OpDatePickerBannerComponent)(l.rXU(a.O),l.rXU(l.zZn),l.rXU(i.W),l.rXU(s.dw))}}static{this.ɵcmp=l.VBU({type:OpDatePickerBannerComponent,selectors:[["op-datepicker-banner"]],inputs:{scheduleManually:"scheduleManually"},decls:4,vars:5,consts:[["type","warning","actionButtonClasses","icon-view-timeline",3,"title","subtitle","actionButton","buttonClicked",4,"ngIf"],["type","info","actionButtonClasses","icon-view-timeline",3,"title","subtitle","actionButton","buttonClicked",4,"ngIf"],[4,"ngIf"],["type","warning","actionButtonClasses","icon-view-timeline",3,"buttonClicked","title","subtitle","actionButton"],["type","info","actionButtonClasses","icon-view-timeline",3,"buttonClicked","title","subtitle","actionButton"]],template:function OpDatePickerBannerComponent_Template(e,t){1&e&&(l.DNE(0,OpDatePickerBannerComponent_op_modal_banner_0_Template,1,3,"op-modal-banner",0),l.nI1(1,"async"),l.DNE(2,OpDatePickerBannerComponent_op_modal_banner_2_Template,1,3,"op-modal-banner",1)(3,OpDatePickerBannerComponent_ng_container_3_Template,6,8,"ng-container",2)),2&e&&(l.Y8G("ngIf",t.scheduleManually&&l.bMT(1,3,t.hasRelations$)),l.R7$(2),l.Y8G("ngIf",!t.scheduleManually&&t.isParent),l.R7$(),l.Y8G("ngIf",!t.scheduleManually&&!t.isParent))},dependencies:[c.bT,p.O,c.Jj],encapsulation:2,changeDetection:0})}}},17564:(e,t,n)=>{"use strict";n.d(t,{s:()=>OpBasicRangeDatePickerComponent});var i=n(89204),o=n(68559),r=n(61816),s=n(34456),a=n(9585),l=n(32420),c=n(83045),p=n(37749),d=n(46227),u=n(36652),h=n(60316);const m=["input"];function OpBasicRangeDatePickerComponent_input_0_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"input",3,0),o.bIt("ngModelChange",(function OpBasicRangeDatePickerComponent_input_0_Template_input_ngModelChange_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.changeValueFromInputDebounced(t))}))("focus",(function OpBasicRangeDatePickerComponent_input_0_Template_input_focus_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.showDatePicker())})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("ngClass",e.inputClassNames)("id",e.id)("name",e.name)("required",e.required)("disabled",e.disabled)("ngModel",e.stringValue),o.BMQ("data-value",e.value)("data-action",e.dataAction)("name",e.name)}}function OpBasicRangeDatePickerComponent_ng_container_1_Template(e,t){if(1&e){const e=o.RV6();o.qex(0),o.j41(1,"input",4),o.bIt("ngModelChange",(function OpBasicRangeDatePickerComponent_ng_container_1_Template_input_ngModelChange_1_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.changeValueFromInputDebounced([t,n.value[1]||""]))})),o.k0s(),o.nrm(2,"span",5),o.j41(3,"input",6),o.bIt("ngModelChange",(function OpBasicRangeDatePickerComponent_ng_container_1_Template_input_ngModelChange_3_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.changeValueFromInputDebounced([n.value[0]||"",t]))})),o.k0s(),o.nrm(4,"input",7),o.bVm()}if(2&e){const e=o.XpG();o.R7$(),o.Mz_("id","",e.id,"-start"),o.Mz_("name","",e.name,"-start"),o.Y8G("ngClass",e.inputClassNames)("required",e.required)("disabled",e.disabled)("ngModel",e.value[0]||""),o.R7$(),o.Y8G("textContent",e.text.spacer),o.R7$(),o.Mz_("id","",e.id,"-end"),o.Mz_("name","",e.name,"-end"),o.Y8G("ngClass",e.inputClassNames)("required",e.required)("disabled",e.disabled)("ngModel",e.value[1]||""),o.R7$(),o.Y8G("id",e.id)("name",e.name)("ngModel",e.stringValue),o.BMQ("data-value",e.stringValue)("name",e.name)("data-action",e.dataAction)}}class OpBasicRangeDatePickerComponent{set value(e){this._value="string"==typeof e?e.split(/\s-\s/):e,this.stringValue=this.resolveDateArrayToString(this._value)}get value(){return this._value}constructor(e,t,n,i,r,s){this.I18n=e,this.timezoneService=t,this.injector=n,this.cdRef=i,this.elementRef=r,this.deviceService=s,this.className=!0,this.mobile=!1,this.valueChange=new o.bkB,this._value=[],this.id="flatpickr-input-"+ +new Date,this.name="",this.required=!1,this.disabled=!1,this.minimalDate=null,this.inputClassNames="",this.inDialog=!1,this.dataAction="",this.stringValue="",this.text={date:this.I18n.t("js.work_packages.properties.date"),placeholder:this.I18n.t("js.placeholders.default"),spacer:this.I18n.t("js.filter.value_spacer")},this.changeValueFromInputDebounced=(0,d.debounce)(this.changeValueFromInput.bind(this),16),this.onChange=e=>{},this.onTouched=e=>{},(0,p.w)(this)}ngOnInit(){this.mobile=this.deviceService.isMobile}ngAfterViewInit(){this.mobile||this.initializeDatePicker()}changeValueFromInput(e){const t="string"==typeof e?this.resolveDateStringToArray(e):e;this.onChange(t),this.onTouched(t),this.writeValue(t),this.cdRef.detectChanges(),t.find((e=>!(0,a.BY)(e)))||this.valueChange.emit(t)}showDatePicker(){this.datePickerInstance?.show()}initializeDatePicker(){var e,t=this;this.datePickerInstance=new c.l(this.injector,this.id,this.value||"",{allowInput:!0,mode:"range",showMonths:2,onReady:(e,t,n)=>{n.calendarContainer.classList.add("op-datepicker-modal--flatpickr-instance")},onChange:(e,t)=>{if(2===e.length){const e=this.resolveDateStringToArray(t);this.writeValue(e),this.onChange(e),this.onTouched(e)}this.cdRef.detectChanges()},onDayCreate:(e=(0,i.A)((function*(e,n,i,o){(0,a.ce)(o,!0,yield t.datePickerInstance?.isNonWorkingDay(o.dateObj),!!t.minimalDate&&o.dateObj<=t.minimalDate)})),function onDayCreate(t,n,i,o){return e.apply(this,arguments)}),static:this.inDialog},this.input.nativeElement)}writeValue(e){this.value=e}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}resolveDateStringToArray(e){return e.split(" - ").map((e=>e.trim()))}resolveDateArrayToString(e){return e.join(" - ")}static{this.ɵfac=function OpBasicRangeDatePickerComponent_Factory(e){return new(e||OpBasicRangeDatePickerComponent)(o.rXU(r.W),o.rXU(l.D),o.rXU(o.zZn),o.rXU(o.gRc),o.rXU(o.aKT),o.rXU(u.g))}}static{this.ɵcmp=o.VBU({type:OpBasicRangeDatePickerComponent,selectors:[["op-basic-range-date-picker"]],viewQuery:function OpBasicRangeDatePickerComponent_Query(e,t){if(1&e&&o.GBs(m,5),2&e){let e;o.mGM(e=o.lsd())&&(t.input=e.first)}},hostVars:4,hostBindings:function OpBasicRangeDatePickerComponent_HostBindings(e,t){2&e&&o.AVh("op-basic-range-datepicker",t.className)("op-basic-range-datepicker_mobile",t.mobile)},inputs:{value:"value",id:"id",name:"name",required:"required",disabled:"disabled",minimalDate:"minimalDate",inputClassNames:"inputClassNames",inDialog:"inDialog",dataAction:"dataAction"},outputs:{valueChange:"valueChange"},features:[o.Jv_([{provide:s.kq,useExisting:(0,o.Rfq)((()=>OpBasicRangeDatePickerComponent)),multi:!0}])],decls:2,vars:2,consts:[["input",""],["type","text","autocomplete","off","class","spot-input op-basic-range-datepicker--input","data-test-selector","op-basic-range-date-picker",3,"ngClass","id","name","required","disabled","ngModel","ngModelChange","focus",4,"ngIf"],[4,"ngIf"],["type","text","autocomplete","off","data-test-selector","op-basic-range-date-picker",1,"spot-input","op-basic-range-datepicker--input",3,"ngModelChange","focus","ngClass","id","name","required","disabled","ngModel"],["type","date","data-test-selector","op-basic-range-date-picker-start",1,"spot-input",3,"ngModelChange","ngClass","id","name","required","disabled","ngModel"],[1,"op-basic-range-datepicker--spacer",3,"textContent"],["type","date","data-test-selector","op-basic-range-date-picker-end",1,"spot-input",3,"ngModelChange","ngClass","id","name","required","disabled","ngModel"],["type","hidden","data-test-selector","op-basic-range-date-picker--value",3,"id","name","ngModel"]],template:function OpBasicRangeDatePickerComponent_Template(e,t){1&e&&o.DNE(0,OpBasicRangeDatePickerComponent_input_0_Template,2,9,"input",1)(1,OpBasicRangeDatePickerComponent_ng_container_1_Template,5,23,"ng-container",2),2&e&&(o.Y8G("ngIf",!t.mobile),o.R7$(),o.Y8G("ngIf",t.mobile))},dependencies:[s.me,s.BC,s.YS,s.vS,h.YU,h.bT],styles:[".op-datepicker-modal{display:flex;flex-direction:column;height:100%}@media (min-width: 1000px) and (min-height: 500px){.op-datepicker-modal{height:unset;min-height:475px;width:100vw;max-width:320px}.op-datepicker-modal_wide{max-width:600px}}.op-datepicker-modal--banner{margin-bottom:1rem}.op-datepicker-modal--banner:empty{visibility:hidden}.op-datepicker-modal--toggle-actions-container{display:grid;grid-template-columns:auto auto 1fr;grid-column-gap:2rem;margin:0 1rem}.op-datepicker-modal--toggle-actions-container .spot-form-field--input:has(spot-switch){margin-bottom:0!important}.op-datepicker-modal--dates-container{display:grid;grid-template-columns:1fr 1fr 150px;grid-gap:1rem;margin:1rem 1rem 0}.op-datepicker-modal--date-field_current,.op-datepicker-modal--date-field_current:hover{border:2px solid var(--control-checked-color);margin:-1px}.op-datepicker-modal--date-container{display:inline-grid}.op-datepicker-modal--hidden-link{visibility:hidden}.op-datepicker-modal--flatpickr-instance.inline{margin:.5rem auto 0!important;overflow:hidden}.op-datepicker-modal--stretch-content{flex-grow:1;flex-shrink:1;overflow-y:auto}.op-datepicker-modal--stretch-content.spot-container{margin-top:0}@media screen and (max-width: 543px){.op-datepicker-modal{width:calc(100vw - 2rem);margin-bottom:0}.op-datepicker-modal--flatpickr-instance{align-self:center}.op-datepicker-modal--dates-container{grid-template-columns:1fr 1fr}.op-datepicker-modal--toggle-actions-container{display:grid;grid-template-columns:1fr;grid-row-gap:1rem}.op-datepicker-modal--date-form:only-child{grid-column:1/3}}.flatpickr-wrapper{width:100%}\n",".op-basic-range-datepicker_mobile{display:flex;flex-direction:column;align-items:center}.op-basic-range-datepicker--input{min-width:12rem}.op-basic-range-datepicker--spacer{padding:0 .5rem}\n"],encapsulation:2,changeDetection:0})}}},58192:(e,t,n)=>{"use strict";n.d(t,{r:()=>OpBasicSingleDatePickerComponent});var i=n(89204),o=n(68559),r=n(61816),s=n(34456),a=n(9585),l=n(32420),c=n(83045),p=n(37749),d=n(36652),u=n(60316);const h=["input"];function OpBasicSingleDatePickerComponent_input_0_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"input",3,0),o.bIt("input",(function OpBasicSingleDatePickerComponent_input_0_Template_input_input_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.changeValueFromInput(t.target.value))}))("focus",(function OpBasicSingleDatePickerComponent_input_0_Template_input_focus_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.showDatePicker())})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("ngClass",e.inputClassNames)("ngModel",e.value)("id",e.id)("name",e.name)("required",e.required)("disabled",e.disabled),o.BMQ("data-value",e.value)("data-action",e.dataAction)("name",e.name)("data-remote-field-key",e.remoteFieldKey)}}function OpBasicSingleDatePickerComponent_ng_container_1_Template(e,t){if(1&e){const e=o.RV6();o.qex(0),o.j41(1,"input",4),o.bIt("ngModelChange",(function OpBasicSingleDatePickerComponent_ng_container_1_Template_input_ngModelChange_1_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.changeValueFromInput(t))})),o.k0s(),o.bVm()}if(2&e){const e=o.XpG();o.R7$(),o.Y8G("ngClass",e.inputClassNames)("id",e.id)("name",e.name)("required",e.required)("disabled",e.disabled)("ngModel",e.value),o.BMQ("data-value",e.value)("data-action",e.dataAction)("name",e.name)}}class OpBasicSingleDatePickerComponent{set value(e){this._value=e}get value(){return this._value}constructor(e,t,n,i,r,s){this.I18n=e,this.timezoneService=t,this.injector=n,this.cdRef=i,this.elementRef=r,this.deviceService=s,this.valueChange=new o.bkB,this.picked=new o.bkB,this._value="",this.id="flatpickr-input-"+ +new Date,this.name="",this.required=!1,this.disabled=!1,this.minimalDate=null,this.inputClassNames="",this.remoteFieldKey=null,this.inDialog=!1,this.dataAction="",this.mobile=!1,this.text={date:this.I18n.t("js.work_packages.properties.date"),placeholder:this.I18n.t("js.placeholders.default")},this.onChange=e=>{},this.onTouched=e=>{},(0,p.w)(this)}ngOnInit(){this.mobile=this.deviceService.isMobile}ngAfterViewInit(){this.mobile||this.initializeDatePicker()}ngOnDestroy(){this.datePickerInstance?.destroy()}changeValueFromInput(e){(0,a.BY)(e)&&(this.onTouched(e),this.onChange(e),this.writeValue(e),this.datePickerInstance?.setDates(e),this.valueChange.emit(e))}showDatePicker(){this.datePickerInstance?.show()}initializeDatePicker(){var e,t=this;this.datePickerInstance=new c.l(this.injector,this.id,this.value||"",{allowInput:!0,mode:"single",showMonths:1,onReady:(e,t,n)=>{n.calendarContainer.classList.add("op-datepicker-modal--flatpickr-instance")},onChange:(e,t)=>{if(this.writeValue(t),t.length>0){const e=this.timezoneService.formattedISODate(t);this.valueChange.emit(e),this.onTouched(e),this.onChange(e),this.writeValue(e),this.picked.emit()}this.cdRef.detectChanges()},onDayCreate:(e=(0,i.A)((function*(e,n,i,o){(0,a.ce)(o,!0,yield t.datePickerInstance?.isNonWorkingDay(o.dateObj),!!t.minimalDate&&o.dateObj<=t.minimalDate)})),function onDayCreate(t,n,i,o){return e.apply(this,arguments)}),static:this.inDialog},this.input.nativeElement)}writeValue(e){this.value=e,this.datePickerInstance?.setDates(this.value)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}static{this.ɵfac=function OpBasicSingleDatePickerComponent_Factory(e){return new(e||OpBasicSingleDatePickerComponent)(o.rXU(r.W),o.rXU(l.D),o.rXU(o.zZn),o.rXU(o.gRc),o.rXU(o.aKT),o.rXU(d.g))}}static{this.ɵcmp=o.VBU({type:OpBasicSingleDatePickerComponent,selectors:[["op-basic-single-date-picker"]],viewQuery:function OpBasicSingleDatePickerComponent_Query(e,t){if(1&e&&o.GBs(h,5),2&e){let e;o.mGM(e=o.lsd())&&(t.input=e.first)}},inputs:{value:"value",id:"id",name:"name",required:"required",disabled:"disabled",minimalDate:"minimalDate",inputClassNames:"inputClassNames",remoteFieldKey:"remoteFieldKey",inDialog:"inDialog",dataAction:"dataAction"},outputs:{valueChange:"valueChange",picked:"picked"},features:[o.Jv_([{provide:s.kq,useExisting:(0,o.Rfq)((()=>OpBasicSingleDatePickerComponent)),multi:!0}])],decls:2,vars:2,consts:[["input",""],["type","text","autocomplete","off","class","spot-input","data-filter--filters-form-target","singleDay",3,"ngClass","ngModel","id","name","required","disabled","input","focus",4,"ngIf"],[4,"ngIf"],["type","text","autocomplete","off","data-filter--filters-form-target","singleDay",1,"spot-input",3,"input","focus","ngClass","ngModel","id","name","required","disabled"],["type","date","data-filter--filters-form-target","singleDay",1,"spot-input",3,"ngModelChange","ngClass","id","name","required","disabled","ngModel"]],template:function OpBasicSingleDatePickerComponent_Template(e,t){1&e&&o.DNE(0,OpBasicSingleDatePickerComponent_input_0_Template,2,10,"input",1)(1,OpBasicSingleDatePickerComponent_ng_container_1_Template,2,9,"ng-container",2),2&e&&(o.Y8G("ngIf",!t.mobile),o.R7$(),o.Y8G("ngIf",t.mobile))},dependencies:[s.me,s.BC,s.YS,s.vS,u.YU,u.bT],styles:[".op-datepicker-modal{display:flex;flex-direction:column;height:100%}@media (min-width: 1000px) and (min-height: 500px){.op-datepicker-modal{height:unset;min-height:475px;width:100vw;max-width:320px}.op-datepicker-modal_wide{max-width:600px}}.op-datepicker-modal--banner{margin-bottom:1rem}.op-datepicker-modal--banner:empty{visibility:hidden}.op-datepicker-modal--toggle-actions-container{display:grid;grid-template-columns:auto auto 1fr;grid-column-gap:2rem;margin:0 1rem}.op-datepicker-modal--toggle-actions-container .spot-form-field--input:has(spot-switch){margin-bottom:0!important}.op-datepicker-modal--dates-container{display:grid;grid-template-columns:1fr 1fr 150px;grid-gap:1rem;margin:1rem 1rem 0}.op-datepicker-modal--date-field_current,.op-datepicker-modal--date-field_current:hover{border:2px solid var(--control-checked-color);margin:-1px}.op-datepicker-modal--date-container{display:inline-grid}.op-datepicker-modal--hidden-link{visibility:hidden}.op-datepicker-modal--flatpickr-instance.inline{margin:.5rem auto 0!important;overflow:hidden}.op-datepicker-modal--stretch-content{flex-grow:1;flex-shrink:1;overflow-y:auto}.op-datepicker-modal--stretch-content.spot-container{margin-top:0}@media screen and (max-width: 543px){.op-datepicker-modal{width:calc(100vw - 2rem);margin-bottom:0}.op-datepicker-modal--flatpickr-instance{align-self:center}.op-datepicker-modal--dates-container{grid-template-columns:1fr 1fr}.op-datepicker-modal--toggle-actions-container{display:grid;grid-template-columns:1fr;grid-row-gap:1rem}.op-datepicker-modal--date-form:only-child{grid-column:1/3}}.flatpickr-wrapper{width:100%}\n"],encapsulation:2,changeDetection:0})}}},83045:(e,t,n)=>{"use strict";n.d(t,{l:()=>DatePicker});var i=n(89204),o=n(24398),r=n(39545),s=n(96096),a=n(72688),l=n(61816),c=n(1758),p=n(74037);var d=n(42032);class DatePicker{constructor(e,t,n,i,o){this.injector=e,this.datepickerElemIdentifier=t,this.date=n,this.options=i,this.datepickerTarget=o,this.datepickerFormat="Y-m-d",this.initialize(i)}initialize(e){this.weekdaysPromise=this.weekdaysService.loadWeekdays().toPromise().then((()=>{this.datepickerInstance&&this.datepickerInstance.redraw()}));const t=_.extend({},this.defaultOptions,e);let n;n=this.datepickerTarget?(0,s.A)(this.datepickerTarget,t):(0,s.A)(this.datepickerElemIdentifier,t),this.datepickerInstance=Array.isArray(n)?n[0]:n}isNonWorkingDay(e){var t=this;return(0,i.A)((function*(){return t.weekdaysService.isNonWorkingDay(e)||(yield t.daysService.isNonWorkingDay$(e))}))()}clear(){this.datepickerInstance.clear()}destroy(){this.hide(),this.datepickerInstance?.destroy()}hide(){this.isOpen&&this.datepickerInstance.close()}show(){this.datepickerInstance.open()}setDates(e){this.datepickerInstance.setDate(e)}setOption(e,t){this.datepickerInstance.set(e,t)}get isOpen(){return this.datepickerInstance.isOpen}get defaultOptions(){const e=this.configurationService.startOfWeek();return{weekNumbers:!0,getWeek:e=>r(e).format("W"),dateFormat:this.datepickerFormat,defaultDate:this.date,locale:{weekdays:{shorthand:this.I18n.t("date.abbr_day_names"),longhand:this.I18n.t("date.day_names")},months:{shorthand:this.I18n.t("date.abbr_month_names").slice(1),longhand:this.I18n.t("date.month_names").slice(1)},firstDayOfWeek:e,weekAbbreviation:this.I18n.t("date.abbr_week"),rangeSeparator:" - "}}}}(0,o.Cg)([(0,c.O)(),(0,o.Sn)("design:type",a.s)],DatePicker.prototype,"configurationService",void 0),(0,o.Cg)([(0,c.O)(),(0,o.Sn)("design:type",p.I)],DatePicker.prototype,"weekdaysService",void 0),(0,o.Cg)([(0,c.O)(),(0,o.Sn)("design:type",d.o)],DatePicker.prototype,"daysService",void 0),(0,o.Cg)([(0,c.O)(),(0,o.Sn)("design:type",l.W)],DatePicker.prototype,"I18n",void 0)},9585:(e,t,n)=>{"use strict";n.d(t,{BY:()=>validDate,_U:()=>parseDate,_W:()=>setDates,ce:()=>onDayCreate,i$:()=>mappedDate,iH:()=>areDatesEqual});var i=n(6923);function mappedDate(e){return""===e?null:e}function parseDate(e){return e instanceof Date?new Date(e.setHours(0,0,0,0)):""===e?"":new Date(i(e).toDate().setHours(0,0,0,0))}function validDate(e){return e instanceof Date||""===e||!!/^\d{4}-\d{2}-\d{2}$/.exec(e)}function areDatesEqual(e,t){const n=parseDate(e),i=parseDate(t);return"string"!=typeof n&&"string"!=typeof i&&n.getTime()===i.getTime()}function keepCurrentlyActiveMonth(e,t,n){e.datepickerInstance.currentMonth=t,e.datepickerInstance.currentYear=n}function comparableDate(e){return e&&"string"!=typeof e?"number"==typeof e?e:e.getTime():null}function setDates(e,t,n){const{currentMonth:i,currentYear:o,selectedDates:r}=t.datepickerInstance,[s,a]=_.castArray(e),[l,c]=r;if(!(r.length>0&&comparableDate(s)===comparableDate(l)&&comparableDate(a)===comparableDate(c))){if(t.setDates(e),n){const e=n.getMonth(),r=n.getFullYear(),s=e-i+12*(r-o);Math.abs(s)>1?(t.datepickerInstance.currentMonth=e,t.datepickerInstance.currentYear=r):keepCurrentlyActiveMonth(t,i,o)}else keepCurrentlyActiveMonth(t,i,o);t.datepickerInstance.redraw()}}function onDayCreate(e,t,n,i){e.setAttribute("data-iso-date",e.dateObj.toISOString()),i?e.classList.add("flatpickr-disabled"):t&&n?e.classList.add("flatpickr-non-working-day_enabled"):!t&&n&&e.classList.add("flatpickr-non-working-day")}},34342:(e,t,n)=>{"use strict";n.d(t,{c:()=>OpModalSingleDatePickerComponent});var i=n(89204),o=n(68559),r=n(61816),s=n(34456),a=n(9585),l=n(32420),c=n(83045),p=n(37749),d=n(46227),u=n(21863),h=n(60316),m=n(41497),g=n(75636),_=n(18240),f=n(93338),b=n(88294),k=n(73704);const v=["flatpickrTarget"],C=[[["","slot","trigger"]],[["","slot","extra-fields"]]],y=["[slot=trigger]","[slot=extra-fields]"],_c3=e=>({"remote-field--input":e});function OpModalSingleDatePickerComponent_ng_template_2_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"input",14),o.bIt("ngModelChange",(function OpModalSingleDatePickerComponent_ng_template_2_Template_input_ngModelChange_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.changeValueFromInputDebounced(t))}))("click",(function OpModalSingleDatePickerComponent_ng_template_2_Template_input_click_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.onInputClick(t))}))("focus",(function OpModalSingleDatePickerComponent_ng_template_2_Template_input_focus_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.opened=!0)})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("id",e.id)("ngModel",e.value),o.BMQ("data-value",e.value)}}function OpModalSingleDatePickerComponent_spot_selector_field_5_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"spot-selector-field",15)(1,"spot-switch",16),o.mxI("ngModelChange",(function OpModalSingleDatePickerComponent_spot_selector_field_5_Template_spot_switch_ngModelChange_1_listener(t){o.eBV(e);const n=o.XpG();return o.DH7(n.ignoreNonWorkingDays,t)||(n.ignoreNonWorkingDays=t),o.Njj(t)})),o.bIt("ngModelChange",(function OpModalSingleDatePickerComponent_spot_selector_field_5_Template_spot_switch_ngModelChange_1_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.changeNonWorkingDays())})),o.k0s()()}if(2&e){const e=o.XpG();o.Y8G("reverseLabel",!0)("label",e.text.ignoreNonWorkingDays.title),o.R7$(),o.R50("ngModel",e.ignoreNonWorkingDays)}}class OpModalSingleDatePickerComponent{set value(e){this._value=e,this.writeWorkingValue(e)}get value(){return this._value}set opened(e){this._opened!==!!e&&(this._opened=!!e,this._opened?this.initializeDatepickerAfterOpen():this.closed.emit())}get opened(){return this._opened}constructor(e,t,n,i,r,s){this.I18n=e,this.timezoneService=t,this.injector=n,this.cdRef=i,this.elementRef=r,this.spotDropModalTeleportationService=s,this.closed=new o.bkB,this.valueChange=new o.bkB,this._value="",this.id="flatpickr-input-"+ +new Date,this.name="",this.remoteFieldKey="",this.required=!1,this.minimalDate=null,this._opened=!1,this.showIgnoreNonWorkingDays=!1,this.ignoreNonWorkingDays=!1,this.workingValue="",this.workingDate=null,this.useDefaultTrigger=!1,this.text={apply:this.I18n.t("js.modals.button_apply"),cancel:this.I18n.t("js.button_cancel"),date:this.I18n.t("js.work_packages.properties.date"),placeholder:this.I18n.t("js.placeholders.default"),today:this.I18n.t("js.label_today"),ignoreNonWorkingDays:{title:this.I18n.t("js.work_packages.datepicker_modal.ignore_non_working_days.title")}},this.changeValueFromInputDebounced=(0,d.debounce)(this.changeValueFromInput.bind(this),16),this.onChange=e=>{},this.onTouched=e=>{},(0,p.w)(this)}ngOnInit(){this.applyLabel=this.applyLabel||this.text.apply}ngAfterContentInit(){const e=this.elementRef.nativeElement.querySelector("[slot='trigger']");this.useDefaultTrigger=null===e}onInputClick(e){e.stopPropagation()}save(e){e.target.reportValidity()&&(e.preventDefault(),this.valueChange.emit(this.workingValue),this.onChange(this.workingValue),this.writeValue(this.workingValue),this.opened=!1,this.workingValue="",this.cdRef.detectChanges())}setToday(){const e=(0,a._U)(new Date);this.writeWorkingValue(this.timezoneService.formattedISODate(e)),this.enforceManualChangesToDatepicker(e)}changeNonWorkingDays(){this.initializeDatepickerAfterOpen(),this.cdRef.detectChanges()}changeValueFromInput(e){this.valueChange.emit(e),this.onChange(e),this.writeValue(e);const t=(0,a._U)(e||"");if(""!==t){const e=this.timezoneService.formattedISODate(t);this.writeWorkingValue(e),this.enforceManualChangesToDatepicker(t),this.onTouched(e)}this.cdRef.detectChanges()}enforceManualChangesToDatepicker(e){const t=(0,a._U)(this.workingDate||"");(0,a._W)(t,this.datePickerInstance,e)}initializeDatepickerAfterOpen(){this.spotDropModalTeleportationService.afterRenderOnce$(!0).subscribe((()=>{this.initializeDatepicker()}))}initializeDatepicker(){var e=this;this.datePickerInstance?.destroy();const t=(0,a._U)(this.value||new Date);var n;this.writeWorkingValue(this.timezoneService.formattedISODate(t)),this.datePickerInstance=new c.l(this.injector,this.id,this.workingDate||"",{mode:"single",showMonths:1,inline:!0,onReady:(e,t,n)=>{n.calendarContainer.classList.add("op-datepicker-modal--flatpickr-instance"),this.cdRef.detectChanges()},onChange:e=>{if(e.length>0){const t=this.timezoneService.formattedISODate(e[0]);this.writeWorkingValue(t),this.enforceManualChangesToDatepicker(e[0]),this.onTouched(t)}this.cdRef.detectChanges()},onDayCreate:(n=(0,i.A)((function*(t,n,i,o){(0,a.ce)(o,!e.ignoreNonWorkingDays,yield e.datePickerInstance?.isNonWorkingDay(o.dateObj),!!e.minimalDate&&o.dateObj<=e.minimalDate)})),function onDayCreate(e,t,i,o){return n.apply(this,arguments)})},this.flatpickrTarget.nativeElement)}writeWorkingValue(e){const t=new Date(e),n=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds());this.workingValue=e,this.workingDate=n}writeValue(e){this.writeWorkingValue(e),this.value=e}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}static{this.ɵfac=function OpModalSingleDatePickerComponent_Factory(e){return new(e||OpModalSingleDatePickerComponent)(o.rXU(r.W),o.rXU(l.D),o.rXU(o.zZn),o.rXU(o.gRc),o.rXU(o.aKT),o.rXU(u.A))}}static{this.ɵcmp=o.VBU({type:OpModalSingleDatePickerComponent,selectors:[["op-modal-single-date-picker"]],viewQuery:function OpModalSingleDatePickerComponent_Query(e,t){if(1&e&&o.GBs(v,5),2&e){let e;o.mGM(e=o.lsd())&&(t.flatpickrTarget=e.first)}},inputs:{value:"value",id:"id",name:"name",remoteFieldKey:"remoteFieldKey",required:"required",minimalDate:"minimalDate",applyLabel:"applyLabel",opened:"opened",showIgnoreNonWorkingDays:"showIgnoreNonWorkingDays",ignoreNonWorkingDays:"ignoreNonWorkingDays"},outputs:{closed:"closed",valueChange:"valueChange"},features:[o.Jv_([{provide:s.kq,useExisting:(0,o.Rfq)((()=>OpModalSingleDatePickerComponent)),multi:!0}])],ngContentSelectors:y,decls:17,vars:18,consts:[["flatpickrTarget",""],["data-test-selector","opce-modal-single-date-picker",3,"closed","opened"],["slot","trigger",3,"ngIf"],["slot","body"],["data-test-selector","op-datepicker-modal","tabindex","0","cdkFocusInitial","","cdkTrapFocus","",1,"spot-container","op-datepicker-modal",3,"submit","cdkTrapFocusAutoCapture"],[3,"reverseLabel","label",4,"ngIf"],[3,"label","required"],["slot","input","name","date",1,"op-datepicker-modal--date-field",3,"ngModelChange","ngModel","required","showClearButton"],["slot","action","type","button",1,"spot-link",3,"click","textContent"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button","data-test-selector","op-datepicker-modal--action",1,"button","spot-action-bar--action",3,"click","textContent"],["type","submit","data-test-selector","op-datepicker-modal--action",1,"button","-primary","spot-action-bar--action",3,"textContent"],["hidden","",3,"name","value","ngClass"],["type","text",1,"spot-input",3,"ngModelChange","click","focus","id","ngModel"],[3,"reverseLabel","label"],["slot","input","name","ignoreNonWorkingDays","data-test-selector","op-datepicker-modal--include-non-working-days",3,"ngModelChange","ngModel"]],template:function OpModalSingleDatePickerComponent_Template(e,t){if(1&e){const e=o.RV6();o.NAR(C),o.j41(0,"spot-drop-modal",1),o.bIt("closed",(function OpModalSingleDatePickerComponent_Template_spot_drop_modal_closed_0_listener(){return o.eBV(e),o.Njj(t.opened=!1)})),o.SdG(1,0,["slot","trigger"]),o.DNE(2,OpModalSingleDatePickerComponent_ng_template_2_Template,1,3,"ng-template",2),o.qex(3,3),o.j41(4,"form",4),o.bIt("submit",(function OpModalSingleDatePickerComponent_Template_form_submit_4_listener(n){return o.eBV(e),o.Njj(t.save(n))})),o.DNE(5,OpModalSingleDatePickerComponent_spot_selector_field_5_Template,2,3,"spot-selector-field",5),o.SdG(6,1),o.j41(7,"spot-form-field",6)(8,"spot-text-field",7),o.bIt("ngModelChange",(function OpModalSingleDatePickerComponent_Template_spot_text_field_ngModelChange_8_listener(n){return o.eBV(e),o.Njj(t.writeWorkingValue(n))})),o.k0s(),o.j41(9,"button",8),o.bIt("click",(function OpModalSingleDatePickerComponent_Template_button_click_9_listener(){return o.eBV(e),o.Njj(t.setToday())})),o.k0s()(),o.nrm(10,"div",null,0),o.j41(12,"div",9)(13,"div",10)(14,"button",11),o.bIt("click",(function OpModalSingleDatePickerComponent_Template_button_click_14_listener(){return o.eBV(e),o.Njj(t.opened=!1)})),o.k0s(),o.nrm(15,"button",12),o.k0s()()(),o.bVm(),o.k0s(),o.nrm(16,"input",13)}2&e&&(o.Y8G("opened",t.opened),o.R7$(2),o.Y8G("ngIf",t.useDefaultTrigger),o.R7$(2),o.Y8G("cdkTrapFocusAutoCapture",!0),o.R7$(),o.Y8G("ngIf",t.showIgnoreNonWorkingDays),o.R7$(2),o.Y8G("label",t.text.date)("required",t.required),o.R7$(),o.Y8G("ngModel",t.workingValue)("required",t.required)("showClearButton",!0),o.R7$(),o.Y8G("textContent",t.text.today),o.R7$(5),o.Y8G("textContent",t.text.cancel),o.R7$(),o.Y8G("textContent",t.applyLabel),o.R7$(),o.Y8G("name",t.name)("value",t.value)("ngClass",o.eq3(16,_c3,!!t.remoteFieldKey)),o.BMQ("data-remote-field-key",t.remoteFieldKey))},dependencies:[s.qT,s.me,s.BC,s.cb,s.YS,s.vS,s.cV,h.YU,h.bT,m.kB,g.c,_.l,f.m,b.U,k.P],styles:[".op-datepicker-modal{display:flex;flex-direction:column;height:100%}@media (min-width: 1000px) and (min-height: 500px){.op-datepicker-modal{height:unset;min-height:475px;width:100vw;max-width:320px}.op-datepicker-modal_wide{max-width:600px}}.op-datepicker-modal--banner{margin-bottom:1rem}.op-datepicker-modal--banner:empty{visibility:hidden}.op-datepicker-modal--toggle-actions-container{display:grid;grid-template-columns:auto auto 1fr;grid-column-gap:2rem;margin:0 1rem}.op-datepicker-modal--toggle-actions-container .spot-form-field--input:has(spot-switch){margin-bottom:0!important}.op-datepicker-modal--dates-container{display:grid;grid-template-columns:1fr 1fr 150px;grid-gap:1rem;margin:1rem 1rem 0}.op-datepicker-modal--date-field_current,.op-datepicker-modal--date-field_current:hover{border:2px solid var(--control-checked-color);margin:-1px}.op-datepicker-modal--date-container{display:inline-grid}.op-datepicker-modal--hidden-link{visibility:hidden}.op-datepicker-modal--flatpickr-instance.inline{margin:.5rem auto 0!important;overflow:hidden}.op-datepicker-modal--stretch-content{flex-grow:1;flex-shrink:1;overflow-y:auto}.op-datepicker-modal--stretch-content.spot-container{margin-top:0}@media screen and (max-width: 543px){.op-datepicker-modal{width:calc(100vw - 2rem);margin-bottom:0}.op-datepicker-modal--flatpickr-instance{align-self:center}.op-datepicker-modal--dates-container{grid-template-columns:1fr 1fr}.op-datepicker-modal--toggle-actions-container{display:grid;grid-template-columns:1fr;grid-row-gap:1rem}.op-datepicker-modal--date-form:only-child{grid-column:1/3}}.flatpickr-wrapper{width:100%}\n","@media screen and (max-width: 543px){.spot-drop-modal--body{height:auto!important}}\n"],encapsulation:2})}}},91784:(e,t,n)=>{"use strict";n.d(t,{p:()=>OpDatePickerSchedulingToggleComponent});var i=n(68559),o=n(61816),r=n(34456),s=n(75636),a=n(73704);class OpDatePickerSchedulingToggleComponent{constructor(e,t){this.I18n=e,this.cdRef=t,this.text={scheduling:{title:this.I18n.t("js.scheduling.manual")}},this.onChange=e=>{},this.onTouched=e=>{}}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}writeValue(e){this.scheduleManually=e,this.cdRef.markForCheck()}onToggle(e){this.writeValue(e),this.onChange(e),this.onTouched(e)}static{this.ɵfac=function OpDatePickerSchedulingToggleComponent_Factory(e){return new(e||OpDatePickerSchedulingToggleComponent)(i.rXU(o.W),i.rXU(i.gRc))}}static{this.ɵcmp=i.VBU({type:OpDatePickerSchedulingToggleComponent,selectors:[["op-datepicker-scheduling-toggle"]],inputs:{scheduleManually:"scheduleManually"},features:[i.Jv_([{provide:r.kq,useExisting:(0,i.Rfq)((()=>OpDatePickerSchedulingToggleComponent)),multi:!0}])],decls:2,vars:3,consts:[[3,"reverseLabel","label"],["slot","input","name","scheduling","data-test-selector","op-datepicker-modal--scheduling-action",3,"ngModelChange","ngModel"]],template:function OpDatePickerSchedulingToggleComponent_Template(e,t){1&e&&(i.j41(0,"spot-selector-field",0)(1,"spot-switch",1),i.bIt("ngModelChange",(function OpDatePickerSchedulingToggleComponent_Template_spot_switch_ngModelChange_1_listener(e){return t.onToggle(e)})),i.k0s()()),2&e&&(i.Y8G("reverseLabel",!0)("label",t.text.scheduling.title),i.R7$(),i.Y8G("ngModel",t.scheduleManually))},dependencies:[r.BC,r.vS,s.c,a.P],encapsulation:2,changeDetection:0})}}},42446:(e,t,n)=>{"use strict";n.d(t,{O:()=>DateModalRelationsService});var i=n(14593),o=n(89282),r=n(51567),s=n(36647),a=n(70271),l=n(90778),c=n(86301),p=n(64334),d=n(56042),u=n(19999),h=n(97366),m=n(9585),g=n(68559);class DateModalRelationsService{setChangeset(e){this.changeset$.next(e),this.changeset=e}constructor(e){this.apiV3Service=e,this.changeset$=new d.m,this.precedingWorkPackages$=this.changeset$.pipe((0,r.p)((e=>!(0,h.A)(e.pristineResource))),(0,s.n)((e=>this.apiV3Service.work_packages.signalled((0,o.K7)("precedes","=",[e.id]),["elements/id","elements/dueDate","elements/date"]))),(0,a.T)((e=>e._embedded.elements||[])),(0,l.U)([]),(0,c.t)(1)),this.followingWorkPackages$=this.changeset$.pipe((0,r.p)((e=>!(0,h.A)(e.pristineResource))),(0,s.n)((e=>this.apiV3Service.work_packages.signalled((0,o.K7)("follows","=",[e.id]),["elements/id"]))),(0,a.T)((e=>e._embedded.elements||[])),(0,l.U)([]),(0,c.t)(1)),this.hasRelations$=(0,u.z)([this.precedingWorkPackages$,this.followingWorkPackages$]).pipe((0,a.T)((([e,t])=>e.length>0||t.length>0||this.isParent||this.isChild)))}getMinimalDateFromPreceeding(){return this.precedingWorkPackages$.pipe((0,p.s)(1),(0,a.T)((e=>this.minimalDateFromPrecedingRelationship(e))))}minimalDateFromPrecedingRelationship(e){if(0===e.length)return null;let t=null;return e.forEach((e=>{if(!e.dueDate&&!e.date)return;const n=e.dueDate||e.date,i=(0,m._U)(n);(!t||t<i)&&(t=""===i?null:i)})),t}get isChild(){return this.ancestors.length>0}get ancestors(){return this.changeset.projectedResource.getAncestors()||[]}get isParent(){return this.children.length>0}get children(){return this.changeset.projectedResource.children||[]}getInvolvedWorkPackageIds(){return(0,u.z)([this.precedingWorkPackages$,this.followingWorkPackages$]).pipe((0,a.T)((([e,t])=>[this.changeset.pristineResource,...e,...t,...this.children,...this.ancestors].map((e=>e.id)))))}static{this.ɵfac=function DateModalRelationsService_Factory(e){return new(e||DateModalRelationsService)(g.KVO(i.n))}}static{this.ɵprov=g.jDH({token:DateModalRelationsService,factory:DateModalRelationsService.ɵfac})}}},23723:(e,t,n)=>{"use strict";n.d(t,{v:()=>DateModalSchedulingService});var i=n(42446),o=n(68559);class DateModalSchedulingService{constructor(e){this.dateModalRelations=e,this.scheduleManually=!1}setChangeset(e){this.changeset=e,this.scheduleManually=!!this.changeset.value("scheduleManually")}get isSchedulable(){return this.scheduleManually||!this.dateModalRelations.isParent}isDayDisabled(e,t){return!this.isSchedulable||!this.scheduleManually&&!!t&&e.dateObj<=t}static{this.ɵfac=function DateModalSchedulingService_Factory(e){return new(e||DateModalSchedulingService)(o.KVO(i.O))}}static{this.ɵprov=o.jDH({token:DateModalSchedulingService,factory:DateModalSchedulingService.ɵfac})}}},82028:(e,t,n)=>{"use strict";n.d(t,{U:()=>OpDatePickerSheetComponent});var i=n(89204),o=n(68559),r=n(61816),s=n(9585),a=n(32420),l=n(83045),c=n(36652);const p=["flatpickrTarget"];class OpDatePickerSheetComponent{constructor(e,t,n,i,r,s){this.I18n=e,this.timezoneService=t,this.injector=n,this.cdRef=i,this.elementRef=r,this.deviceService=s,this.className=!0,this.ignoreNonWorkingDays=!0,this.isDisabled=e=>!1,this.datesSelected=new o.bkB}ngAfterViewInit(){this.initializeDatepicker()}ngOnChanges(e){e.dates&&!e.dates.isFirstChange()&&this.datePickerInstance.setDates(e.dates.currentValue),e.mode&&!e.mode.isFirstChange()&&this.initializeDatepicker()}initializeDatepicker(){var e,t=this;this.datePickerInstance?.destroy(),this.datePickerInstance=new l.l(this.injector,"#flatpickr-input",this.dates,{mode:this.mode,showMonths:this.deviceService.isMobile||"single"===this.mode?1:2,inline:!0,onChange:e=>{const t=e.map((e=>this.timezoneService.formattedISODate(e)));this.datesSelected.emit(t)},onDayCreate:(e=(0,i.A)((function*(e,n,i,o){(0,s.ce)(o,t.ignoreNonWorkingDays,yield t.datePickerInstance?.isNonWorkingDay(o.dateObj),t.isDisabled(o))})),function onDayCreate(t,n,i,o){return e.apply(this,arguments)})},this.flatpickrTarget.nativeElement)}static{this.ɵfac=function OpDatePickerSheetComponent_Factory(e){return new(e||OpDatePickerSheetComponent)(o.rXU(r.W),o.rXU(a.D),o.rXU(o.zZn),o.rXU(o.gRc),o.rXU(o.aKT),o.rXU(c.g))}}static{this.ɵcmp=o.VBU({type:OpDatePickerSheetComponent,selectors:[["op-datepicker-sheet"]],viewQuery:function OpDatePickerSheetComponent_Query(e,t){if(1&e&&o.GBs(p,5),2&e){let e;o.mGM(e=o.lsd())&&(t.flatpickrTarget=e.first)}},hostVars:2,hostBindings:function OpDatePickerSheetComponent_HostBindings(e,t){2&e&&o.AVh("op-datepicker-sheet",t.className)},inputs:{dates:"dates",mode:"mode",ignoreNonWorkingDays:"ignoreNonWorkingDays",isDisabled:"isDisabled"},outputs:{datesSelected:"datesSelected"},features:[o.OA$],decls:2,vars:0,consts:[["flatpickrTarget",""],["id","flatpickr-input","hidden",""]],template:function OpDatePickerSheetComponent_Template(e,t){1&e&&o.nrm(0,"input",1,0)},styles:[".op-datepicker-modal{display:flex;flex-direction:column;height:100%}@media (min-width: 1000px) and (min-height: 500px){.op-datepicker-modal{height:unset;min-height:475px;width:100vw;max-width:320px}.op-datepicker-modal_wide{max-width:600px}}.op-datepicker-modal--banner{margin-bottom:1rem}.op-datepicker-modal--banner:empty{visibility:hidden}.op-datepicker-modal--toggle-actions-container{display:grid;grid-template-columns:auto auto 1fr;grid-column-gap:2rem;margin:0 1rem}.op-datepicker-modal--toggle-actions-container .spot-form-field--input:has(spot-switch){margin-bottom:0!important}.op-datepicker-modal--dates-container{display:grid;grid-template-columns:1fr 1fr 150px;grid-gap:1rem;margin:1rem 1rem 0}.op-datepicker-modal--date-field_current,.op-datepicker-modal--date-field_current:hover{border:2px solid var(--control-checked-color);margin:-1px}.op-datepicker-modal--date-container{display:inline-grid}.op-datepicker-modal--hidden-link{visibility:hidden}.op-datepicker-modal--flatpickr-instance.inline{margin:.5rem auto 0!important;overflow:hidden}.op-datepicker-modal--stretch-content{flex-grow:1;flex-shrink:1;overflow-y:auto}.op-datepicker-modal--stretch-content.spot-container{margin-top:0}@media screen and (max-width: 543px){.op-datepicker-modal{width:calc(100vw - 2rem);margin-bottom:0}.op-datepicker-modal--flatpickr-instance{align-self:center}.op-datepicker-modal--dates-container{grid-template-columns:1fr 1fr}.op-datepicker-modal--toggle-actions-container{display:grid;grid-template-columns:1fr;grid-row-gap:1rem}.op-datepicker-modal--date-form:only-child{grid-column:1/3}}.flatpickr-wrapper{width:100%}\n"],encapsulation:2,changeDetection:0})}}},72825:(e,t,n)=>{"use strict";n.d(t,{X:()=>OpDatePickerWorkingDaysToggleComponent});var i=n(68559),o=n(61816),r=n(34456),s=n(75636),a=n(73704);class OpDatePickerWorkingDaysToggleComponent{constructor(e,t){this.I18n=e,this.cdRef=t,this.disabled=!1,this.text={ignoreNonWorkingDays:{title:this.I18n.t("js.work_packages.datepicker_modal.ignore_non_working_days.title")}},this.onChange=e=>{},this.onTouched=e=>{}}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}onToggle(e){const t=!e;this.writeValue(t),this.onChange(t),this.onTouched(t)}writeValue(e){this.ignoreNonWorkingDays=e,this.cdRef.markForCheck()}static{this.ɵfac=function OpDatePickerWorkingDaysToggleComponent_Factory(e){return new(e||OpDatePickerWorkingDaysToggleComponent)(i.rXU(o.W),i.rXU(i.gRc))}}static{this.ɵcmp=i.VBU({type:OpDatePickerWorkingDaysToggleComponent,selectors:[["op-datepicker-working-days-toggle"]],inputs:{ignoreNonWorkingDays:"ignoreNonWorkingDays",disabled:"disabled"},features:[i.Jv_([{provide:r.kq,useExisting:(0,i.Rfq)((()=>OpDatePickerWorkingDaysToggleComponent)),multi:!0}])],decls:2,vars:4,consts:[[3,"reverseLabel","label"],["slot","input","name","weekdays_only","data-test-selector","op-datepicker-modal--include-non-working-days",3,"ngModelChange","disabled","ngModel"]],template:function OpDatePickerWorkingDaysToggleComponent_Template(e,t){1&e&&(i.j41(0,"spot-selector-field",0)(1,"spot-switch",1),i.bIt("ngModelChange",(function OpDatePickerWorkingDaysToggleComponent_Template_spot_switch_ngModelChange_1_listener(e){return t.onToggle(e)})),i.k0s()()),2&e&&(i.Y8G("reverseLabel",!0)("label",t.text.ignoreNonWorkingDays.title),i.R7$(),i.Y8G("disabled",t.disabled)("ngModel",!t.ignoreNonWorkingDays))},dependencies:[r.BC,r.vS,s.c,a.P],encapsulation:2,changeDetection:0})}}},8620:(e,t,n)=>{"use strict";n.d(t,{D:()=>OpWpMultiDateFormComponent});var i=n(89204),o=n(68559),r=n(61816),s=n(51339),a=(n(38429),n(32420)),l=n(51567),c=n(9114),p=n(70271),d=n(36647),u=n(52575),h=n(84205),m=n(63617),g=n(14876),_=n(18537),f=n(14593),b=n(42446),k=n(9585),v=n(74037),C=n(87879),y=n(36652),w=n(83045),T=n(99496),S=n(97366),j=n(23723),P=n(34456),I=n(60316),x=n(18240),R=n(88294),F=n(6811),M=n(91784),O=n(72825);const D=["modalContainer"],G=["durationField"],E=["flatpickrTarget"],_c3=e=>({"op-datepicker-modal--date-field_current":e}),_c4=e=>({"op-datepicker-modal--hidden-link":e});class OpWpMultiDateFormComponent extends T.p{constructor(e,t,n,i,r,s,a,u,_,f,b){super(),this.injector=e,this.cdRef=t,this.apiV3Service=n,this.I18n=i,this.timezoneService=r,this.halEditing=s,this.dateModalScheduling=a,this.dateModalRelations=u,this.deviceService=_,this.weekdayService=f,this.focusHelper=b,this.className=!0,this.classNameWide=!0,this.fieldName="",this.cancel=new o.bkB,this.save=new o.bkB,this.text={save:this.I18n.t("js.button_save"),cancel:this.I18n.t("js.button_cancel"),startDate:this.I18n.t("js.work_packages.properties.startDate"),endDate:this.I18n.t("js.work_packages.properties.dueDate"),duration:this.I18n.t("js.work_packages.properties.duration"),placeholder:this.I18n.t("js.placeholders.default"),today:this.I18n.t("js.label_today"),days:e=>this.I18n.t("js.units.day",{count:e})},this.scheduleManually=!1,this.ignoreNonWorkingDays=!1,this.htmlId="",this.dates={start:null,end:null},this.startDateChanged$=new h.B,this.startDateDebounced$=this.debouncedInput(this.startDateChanged$,"start"),this.endDateChanged$=new h.B,this.endDateDebounced$=this.debouncedInput(this.endDateChanged$,"end"),this.datepickerChanged$=new h.B,this.modalPositioned=!1,this.dateUpdates$=(0,m.h)(this.startDateDebounced$,this.endDateDebounced$,this.datepickerChanged$).pipe(this.untilDestroyed(),(0,l.p)((()=>!!this.datePickerInstance))).subscribe((([e,t])=>{null!==t&&this.handleSingleDateUpdate(e,t),null===t&&"duration"!==e&&this.clearWithDuration(e),null!==t&&"duration"!==e&&this.toggleCurrentActivatedField(),this.cdRef.detectChanges()})),this.durationChanges$=new h.B,this.durationDebounced$=this.durationChanges$.pipe(this.untilDestroyed(),(0,c.s)((e=>e?(0,g.O)(500):(0,g.O)(0))),(0,p.T)((e=>""===e?null:Math.abs(parseInt(e,10)))),(0,l.p)((e=>null===e||!Number.isNaN(e))),(0,l.p)((e=>e!==this.duration))).subscribe((e=>this.applyDurationChange(e))),this.durationFocused=!1,this.ignoreNonWorkingDaysWritable=!0,this.formUpdates$=new h.B,this.minimalSchedulingDate=null,this.formUpdates$.pipe(this.untilDestroyed(),(0,d.n)((e=>this.apiV3Service.work_packages.withOptionalId("new"===this.changeset.id?null:this.changeset.id).form.forPayload({...e,lockVersion:this.changeset.value("lockVersion"),ignoreNonWorkingDays:this.ignoreNonWorkingDays,scheduleManually:this.scheduleManually})))).subscribe((e=>this.updateDatesFromForm(e)))}ngOnInit(){this.htmlId=`wp-datepicker-${this.fieldName}`,this.dateModalScheduling.setChangeset(this.changeset),this.dateModalRelations.setChangeset(this.changeset),this.scheduleManually=!!this.changeset.value("scheduleManually"),this.ignoreNonWorkingDays=!!this.changeset.value("ignoreNonWorkingDays"),this.changeset.getForm().then((e=>{this.ignoreNonWorkingDaysWritable=!!e.schema.ignoreNonWorkingDays.writable,this.cdRef.detectChanges()})),this.setDurationDaysFromUpstream(this.changeset.value("duration")),this.dates.start=this.changeset.value("startDate"),this.dates.end=this.changeset.value("dueDate"),this.setCurrentActivatedField(this.initialActivatedField)}ngAfterViewInit(){const init=()=>{this.initializeDatepicker(),"duration"===this.initialActivatedField&&this.focusHelper.focus(this.durationField.nativeElement)};(0,S.A)(this.changeset.pristineResource)?init():this.dateModalRelations.getMinimalDateFromPreceeding().subscribe((e=>{this.minimalSchedulingDate=e,init()}))}changeSchedulingMode(){!1!==this.scheduleManually||this.ignoreNonWorkingDaysWritable||(this.ignoreNonWorkingDays=!!this.changeset.value("ignoreNonWorkingDays")),this.datePickerInstance?.datepickerInstance.redraw(),this.cdRef.detectChanges()}changeNonWorkingDays(){this.datePickerInstance?.datepickerInstance.redraw(),this.dates.start&&this.duration&&this.formUpdates$.next({startDate:this.dates.start,duration:this.durationAsIso8601}),this.dates.start&&!this.dates.end&&this.formUpdates$.next({startDate:this.dates.start}),this.dates.end&&!this.dates.start&&this.formUpdates$.next({dueDate:this.dates.end}),this.cdRef.detectChanges()}doSave(e){e.preventDefault(),this.changeset.setValue("scheduleManually",this.scheduleManually),this.changeset.setValue("ignoreNonWorkingDays",this.ignoreNonWorkingDays),this.isSchedulable&&(this.changeset.setValue("startDate",(0,k.i$)(this.dates.start)),this.changeset.setValue("dueDate",(0,k.i$)(this.dates.end)),this.changeset.setValue("duration",this.durationAsIso8601)),this.save.emit()}doCancel(){this.cancel.emit()}updateDate(e,t){if((null===t||(0,k.BY)(t))&&this.datePickerInstance){this.dates[e]=(0,k.i$)(t);const n=(0,k._U)(t||"")||void 0;this.enforceManualChangesToDatepicker(n),this.cdRef.detectChanges()}}setCurrentActivatedField(e){this.currentlyActivatedDateField=e}toggleCurrentActivatedField(){this.currentlyActivatedDateField="start"===this.currentlyActivatedDateField?"end":"start"}isStateOfCurrentActivatedField(e){return this.currentlyActivatedDateField===e}setToday(e){this.datepickerChanged$.next([e,new Date])}showTodayLink(){return this.isSchedulable}get isSchedulable(){return this.scheduleManually||!this.dateModalRelations.isParent}showFieldAsActive(e){return this.isStateOfCurrentActivatedField(e)&&this.isSchedulable}handleDurationFocusIn(){this.durationFocused=!0,this.setCurrentActivatedField("duration")}handleDurationFocusOut(){setTimeout((()=>{this.durationFocused=!1,this.cdRef.detectChanges()}))}get displayedDuration(){return this.duration?this.text.days(this.duration):""}applyDurationChange(e){this.duration=e,this.cdRef.detectChanges(),null!==e?this.dates.start?this.formUpdates$.next({startDate:this.dates.start,duration:this.durationAsIso8601}):this.dates.end&&this.formUpdates$.next({dueDate:this.dates.end,duration:this.durationAsIso8601}):this.updateDate("end",null)}get durationAsIso8601(){return this.duration?this.timezoneService.toISODuration(this.duration,"days"):null}clearWithDuration(e){this.duration=null,this.dates[e]=null,this.enforceManualChangesToDatepicker()}initializeDatepicker(){var e,t=this;this.datePickerInstance?.destroy(),this.datePickerInstance=new w.l(this.injector,"#flatpickr-input",[this.dates.start||"",this.dates.end||""],{mode:"range",showMonths:this.deviceService.isMobile?1:2,inline:!0,onReady:(e,t,n)=>{n.calendarContainer.classList.add("op-datepicker-modal--flatpickr-instance"),this.modalPositioned||(this.modalPositioned=!0),this.ensureHoveredSelection(n.calendarContainer)},onChange:(e,t,n)=>{const i=this.currentlyActivatedDateField;if(2===e.length&&!this.duration)return this.setDatesAndDeriveDuration(e[0],e[1]),void this.toggleCurrentActivatedField();const{latestSelectedDateObj:o}=n;this.datepickerChanged$.next([i,o])},onDayCreate:(e=(0,i.A)((function*(e,n,i,o){(0,k.ce)(o,t.ignoreNonWorkingDays,yield t.datePickerInstance?.isNonWorkingDay(o.dateObj),t.isDayDisabled(o,t.minimalSchedulingDate))})),function onDayCreate(t,n,i,o){return e.apply(this,arguments)})},this.flatpickrTarget.nativeElement)}enforceManualChangesToDatepicker(e){let t=(0,k._U)(this.dates.start||""),n=(0,k._U)(this.dates.end||"");t&&n&&(t>n&&this.isStateOfCurrentActivatedField("start")?(n=t,this.dates.end=this.timezoneService.formattedISODate(n)):n<t&&this.isStateOfCurrentActivatedField("end")&&(t=n,this.dates.start=this.timezoneService.formattedISODate(t)));const i=[t,n];(0,k._W)(i,this.datePickerInstance,e)}setDatesAndDeriveDuration(e,t){this.dates.start=this.timezoneService.formattedISODate(e),this.dates.end=this.timezoneService.formattedISODate(t),this.formUpdates$.next({startDate:this.dates.start,dueDate:this.dates.end})}handleSingleDateUpdate(e,t){"duration"!==e?this.dates.start&&this.dates.end?this.replaceDatesWithNewSelection(e,t):(this.moveActiveDate(e,t),this.duration?this.deriveMissingDateFromDuration(e):this.dates.start&&this.dates.end&&this.formUpdates$.next({startDate:this.dates.start,dueDate:this.dates.end}),this.enforceManualChangesToDatepicker(t)):this.durationActiveDateSelected(t)}durationActiveDateSelected(e){const t=this.timezoneService.formattedISODate(e);!this.duration&&this.dates.start?(this.setDaysInOrder(this.dates.start,t),this.setCurrentActivatedField("start")):(this.setDaysInOrder(t,this.dates.end),this.setCurrentActivatedField("end")),this.dates.start&&this.duration?this.formUpdates$.next({startDate:this.dates.start,duration:this.durationAsIso8601}):this.dates.start&&this.dates.end&&this.formUpdates$.next({startDate:this.dates.start,dueDate:this.dates.end})}setDaysInOrder(e,t){const n=e?(0,k._U)(e):null,i=t?(0,k._U)(t):null;n&&i&&n>i?(this.dates.start=t,this.dates.end=e):(this.dates.start=e,this.dates.end=t)}deriveMissingDateFromDuration(e){"start"===e&&this.dates.start&&this.formUpdates$.next({startDate:this.dates.start,duration:this.durationAsIso8601}),"end"===e&&this.dates.end&&this.formUpdates$.next({dueDate:this.dates.end,duration:this.durationAsIso8601})}moveActiveDate(e,t){const n=this.dates.start?(0,k._U)(this.dates.start):null,i=this.dates.end?(0,k._U)(this.dates.end):null;this.dates[e]=this.timezoneService.formattedISODate(t),"end"===e&&n&&n>t&&(this.duration=null,this.dates.start=null,this.enforceManualChangesToDatepicker(t)),"start"===e&&i&&i<t&&(this.duration=null,this.dates.end=null,this.enforceManualChangesToDatepicker(t))}replaceDatesWithNewSelection(e,t){const n=(0,k._U)(this.dates.start||""),i=(0,k._U)(this.dates.end||"");if(t<n)"start"===e?this.applyNewDates([t]):(this.duration=null,this.applyNewDates(["",t]));else if(t>i)"end"===e?this.applyNewDates([n,t]):(this.duration=null,this.applyNewDates([t]));else if((0,k.iH)(t,n)||(0,k.iH)(t,i))this.applyNewDates([t,t]);else{const o="start"===e?[t,i]:[n,t];this.applyNewDates(o)}}applyNewDates([e,t]){this.dates.start=e?this.timezoneService.formattedISODate(e):null,this.dates.end=t?this.timezoneService.formattedISODate(t):null,(0,k._W)([e,t],this.datePickerInstance),this.dates.start&&this.dates.end&&this.formUpdates$.next({startDate:this.dates.start,dueDate:this.dates.end}),this.dates.start&&!this.dates.end&&this.duration&&this.formUpdates$.next({startDate:this.dates.start,duration:this.durationAsIso8601}),this.dates.end&&!this.dates.start&&this.duration&&this.formUpdates$.next({dueDate:this.dates.end,duration:this.durationAsIso8601})}get initialActivatedField(){switch(this.fieldName){case"startDate":return"start";case"dueDate":return"end";case"duration":return"duration";default:return this.dates.start&&!this.dates.end?"end":"start"}}isDayDisabled(e,t){return!this.isSchedulable||!this.scheduleManually&&!!t&&e.dateObj<=t}updateDatesFromForm(e){const t=e.payload;this.dates.start=t.startDate,this.dates.end=t.dueDate,this.ignoreNonWorkingDays=t.ignoreNonWorkingDays,this.setDurationDaysFromUpstream(t.duration);const n=(0,k._U)(this.dates.start);this.enforceManualChangesToDatepicker(n),this.cdRef.detectChanges()}setDurationDaysFromUpstream(e){const t=e?this.timezoneService.toDays(e):null;this.duration=t&&0!==t?t:null}debouncedInput(e,t){return e.pipe(this.untilDestroyed(),(0,l.p)((e=>e!==this.dates[t])),(0,u.B)(500),(0,l.p)((e=>(0,k.BY)(e))),(0,p.T)((e=>""===e?null:(0,k._U)(e))),(0,p.T)((e=>[t,e])))}ensureHoveredSelection(e){(0,_.R)(e,"mouseenter").pipe(this.untilDestroyed()).subscribe((()=>e.classList.remove("flatpickr-container-suppress-hover"))),(0,_.R)(e,"mouseleave").pipe(this.untilDestroyed(),(0,l.p)((()=>!(this.dates.start&&this.dates.end)))).subscribe((()=>e.classList.add("flatpickr-container-suppress-hover")))}static{this.ɵfac=function OpWpMultiDateFormComponent_Factory(e){return new(e||OpWpMultiDateFormComponent)(o.rXU(o.zZn),o.rXU(o.gRc),o.rXU(f.n),o.rXU(r.W),o.rXU(a.D),o.rXU(s.p),o.rXU(j.v),o.rXU(b.O),o.rXU(y.g),o.rXU(v.I),o.rXU(C.k))}}static{this.ɵcmp=o.VBU({type:OpWpMultiDateFormComponent,selectors:[["op-wp-multi-date-form"]],viewQuery:function OpWpMultiDateFormComponent_Query(e,t){if(1&e&&(o.GBs(D,5),o.GBs(G,5,o.aKT),o.GBs(E,5)),2&e){let e;o.mGM(e=o.lsd())&&(t.modalContainer=e.first),o.mGM(e=o.lsd())&&(t.durationField=e.first),o.mGM(e=o.lsd())&&(t.flatpickrTarget=e.first)}},hostVars:4,hostBindings:function OpWpMultiDateFormComponent_HostBindings(e,t){2&e&&o.AVh("op-datepicker-modal",t.className)("op-datepicker-modal_wide",t.classNameWide)},inputs:{changeset:"changeset",fieldName:"fieldName"},outputs:{cancel:"cancel",save:"save"},features:[o.Jv_([b.O,j.v]),o.Vt3],decls:23,vars:39,consts:[["modalContainer",""],["durationField",""],["flatpickrTarget",""],["data-test-selector","op-datepicker-modal","data-indicator-name","modal","tabindex","0",1,"op-datepicker-modal","op-datepicker-modal_wide",3,"submit"],[1,"op-datepicker-modal--banner",3,"scheduleManually"],[1,"spot-container","op-datepicker-modal--stretch-content"],[1,"op-datepicker-modal--toggle-actions-container"],["name","scheduleManually",3,"ngModelChange","ngModel"],["name","ignoreNonWorkingDays",3,"ngModelChange","disabled","ngModel"],[1,"op-datepicker-modal--dates-container"],["data-test-selector","datepicker-start-date",3,"label"],["slot","input","name","startDate","data-test-selector","op-datepicker-modal--start-date-field",1,"op-datepicker-modal--date-field",3,"ngModelChange","focusin","ngClass","ngModel","disabled","showClearButton"],["slot","action","type","button",1,"spot-link",3,"click","ngClass","textContent"],["data-test-selector","datepicker-end-date",3,"label"],["slot","input","name","endDate","data-test-selector","op-datepicker-modal--end-date-field",1,"op-datepicker-modal--date-field",3,"ngModelChange","focusin","ngClass","ngModel","disabled","showClearButton"],["data-test-selector","datepicker-duration",3,"label"],["slot","input","name","duration","data-test-selector","op-datepicker-modal--duration-field","pattern","\\d*","inputmode","numeric",1,"op-datepicker-modal--date-field",3,"ngModelChange","focusin","focusout","ngClass","ngModel","showClearButton","disabled"],["id","flatpickr-input","hidden",""],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button","data-test-selector","op-datepicker-modal--action",1,"spot-modal--cancel-button","button","spot-action-bar--action",3,"click","textContent"],["type","submit","data-test-selector","op-datepicker-modal--action",1,"button","-primary","spot-action-bar--action",3,"textContent"]],template:function OpWpMultiDateFormComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"form",3,0),o.bIt("submit",(function OpWpMultiDateFormComponent_Template_form_submit_0_listener(n){return o.eBV(e),o.Njj(t.doSave(n))})),o.nrm(2,"op-datepicker-banner",4),o.j41(3,"div",5)(4,"div",6)(5,"op-datepicker-scheduling-toggle",7),o.mxI("ngModelChange",(function OpWpMultiDateFormComponent_Template_op_datepicker_scheduling_toggle_ngModelChange_5_listener(n){return o.eBV(e),o.DH7(t.scheduleManually,n)||(t.scheduleManually=n),o.Njj(n)})),o.bIt("ngModelChange",(function OpWpMultiDateFormComponent_Template_op_datepicker_scheduling_toggle_ngModelChange_5_listener(){return o.eBV(e),o.Njj(t.changeSchedulingMode())})),o.k0s(),o.j41(6,"op-datepicker-working-days-toggle",8),o.mxI("ngModelChange",(function OpWpMultiDateFormComponent_Template_op_datepicker_working_days_toggle_ngModelChange_6_listener(n){return o.eBV(e),o.DH7(t.ignoreNonWorkingDays,n)||(t.ignoreNonWorkingDays=n),o.Njj(n)})),o.bIt("ngModelChange",(function OpWpMultiDateFormComponent_Template_op_datepicker_working_days_toggle_ngModelChange_6_listener(){return o.eBV(e),o.Njj(t.changeNonWorkingDays())})),o.k0s()(),o.j41(7,"div",9)(8,"spot-form-field",10)(9,"spot-text-field",11),o.bIt("ngModelChange",(function OpWpMultiDateFormComponent_Template_spot_text_field_ngModelChange_9_listener(n){return o.eBV(e),o.Njj(t.startDateChanged$.next(n))}))("focusin",(function OpWpMultiDateFormComponent_Template_spot_text_field_focusin_9_listener(){return o.eBV(e),o.Njj(t.setCurrentActivatedField("start"))})),o.k0s(),o.j41(10,"button",12),o.bIt("click",(function OpWpMultiDateFormComponent_Template_button_click_10_listener(){return o.eBV(e),o.Njj(t.setToday("start"))})),o.k0s()(),o.j41(11,"spot-form-field",13)(12,"spot-text-field",14),o.bIt("ngModelChange",(function OpWpMultiDateFormComponent_Template_spot_text_field_ngModelChange_12_listener(n){return o.eBV(e),o.Njj(t.endDateChanged$.next(n))}))("focusin",(function OpWpMultiDateFormComponent_Template_spot_text_field_focusin_12_listener(){return o.eBV(e),o.Njj(t.setCurrentActivatedField("end"))})),o.k0s(),o.j41(13,"button",12),o.bIt("click",(function OpWpMultiDateFormComponent_Template_button_click_13_listener(){return o.eBV(e),o.Njj(t.setToday("end"))})),o.k0s()(),o.j41(14,"spot-form-field",15)(15,"spot-text-field",16,1),o.bIt("ngModelChange",(function OpWpMultiDateFormComponent_Template_spot_text_field_ngModelChange_15_listener(n){return o.eBV(e),o.Njj(t.durationChanges$.next(n))}))("focusin",(function OpWpMultiDateFormComponent_Template_spot_text_field_focusin_15_listener(){return o.eBV(e),o.Njj(t.handleDurationFocusIn())}))("focusout",(function OpWpMultiDateFormComponent_Template_spot_text_field_focusout_15_listener(){return o.eBV(e),o.Njj(t.handleDurationFocusOut())})),o.k0s()()(),o.nrm(17,"input",17,2),o.k0s(),o.j41(19,"div",18)(20,"div",19)(21,"button",20),o.bIt("click",(function OpWpMultiDateFormComponent_Template_button_click_21_listener(){return o.eBV(e),o.Njj(t.doCancel())})),o.k0s(),o.nrm(22,"button",21),o.k0s()()()}2&e&&(o.BMQ("id",t.htmlId),o.R7$(2),o.Y8G("scheduleManually",t.scheduleManually),o.R7$(3),o.R50("ngModel",t.scheduleManually),o.R7$(),o.Y8G("disabled",!(t.scheduleManually||t.ignoreNonWorkingDaysWritable)),o.R50("ngModel",t.ignoreNonWorkingDays),o.R7$(2),o.Y8G("label",t.text.startDate),o.R7$(),o.Y8G("ngClass",o.eq3(29,_c3,t.showFieldAsActive("start")))("ngModel",t.dates.start)("disabled",!t.isSchedulable)("showClearButton","start"===t.currentlyActivatedDateField),o.BMQ("data-qa-highlighted",t.showFieldAsActive("start")||void 0),o.R7$(),o.Y8G("ngClass",o.eq3(31,_c4,!t.showTodayLink()))("textContent",t.text.today),o.R7$(),o.Y8G("label",t.text.endDate),o.R7$(),o.Y8G("ngClass",o.eq3(33,_c3,t.showFieldAsActive("end")))("ngModel",t.dates.end)("disabled",!t.isSchedulable)("showClearButton","end"===t.currentlyActivatedDateField),o.BMQ("data-qa-highlighted",t.showFieldAsActive("end")||void 0),o.R7$(),o.Y8G("ngClass",o.eq3(35,_c4,!t.showTodayLink()))("textContent",t.text.today),o.R7$(),o.Y8G("label",t.text.duration),o.R7$(),o.Y8G("ngClass",o.eq3(37,_c3,t.showFieldAsActive("duration")))("ngModel",t.durationFocused?t.duration:t.displayedDuration)("showClearButton","duration"===t.currentlyActivatedDateField)("disabled",!t.isSchedulable),o.BMQ("data-qa-highlighted",t.showFieldAsActive("duration")||void 0),o.R7$(6),o.Y8G("textContent",t.text.cancel),o.R7$(),o.Y8G("textContent",t.text.save))},dependencies:[P.qT,P.BC,P.cb,P.R_,P.vS,P.cV,I.YU,x.l,R.U,F.J,M.p,O.X],styles:[".op-datepicker-modal{display:flex;flex-direction:column;height:100%}@media (min-width: 1000px) and (min-height: 500px){.op-datepicker-modal{height:unset;min-height:475px;width:100vw;max-width:320px}.op-datepicker-modal_wide{max-width:600px}}.op-datepicker-modal--banner{margin-bottom:1rem}.op-datepicker-modal--banner:empty{visibility:hidden}.op-datepicker-modal--toggle-actions-container{display:grid;grid-template-columns:auto auto 1fr;grid-column-gap:2rem;margin:0 1rem}.op-datepicker-modal--toggle-actions-container .spot-form-field--input:has(spot-switch){margin-bottom:0!important}.op-datepicker-modal--dates-container{display:grid;grid-template-columns:1fr 1fr 150px;grid-gap:1rem;margin:1rem 1rem 0}.op-datepicker-modal--date-field_current,.op-datepicker-modal--date-field_current:hover{border:2px solid var(--control-checked-color);margin:-1px}.op-datepicker-modal--date-container{display:inline-grid}.op-datepicker-modal--hidden-link{visibility:hidden}.op-datepicker-modal--flatpickr-instance.inline{margin:.5rem auto 0!important;overflow:hidden}.op-datepicker-modal--stretch-content{flex-grow:1;flex-shrink:1;overflow-y:auto}.op-datepicker-modal--stretch-content.spot-container{margin-top:0}@media screen and (max-width: 543px){.op-datepicker-modal{width:calc(100vw - 2rem);margin-bottom:0}.op-datepicker-modal--flatpickr-instance{align-self:center}.op-datepicker-modal--dates-container{grid-template-columns:1fr 1fr}.op-datepicker-modal--toggle-actions-container{display:grid;grid-template-columns:1fr;grid-row-gap:1rem}.op-datepicker-modal--date-form:only-child{grid-column:1/3}}.flatpickr-wrapper{width:100%}\n"],encapsulation:2,changeDetection:0})}}},24972:(e,t,n)=>{"use strict";n.d(t,{k:()=>OpWpSingleDateFormComponent});var i=n(89204),o=n(68559),r=n(61816),s=n(83045),a=n(51339),l=(n(38429),n(72688)),c=n(32420),p=n(9114),d=n(84205),u=n(14876),h=n(14593),m=n(42446),g=n(9585),_=n(99496),f=n(97366),b=n(23723),k=n(6923),v=n(34456),C=n(60316),y=n(18240),w=n(88294),T=n(6811),S=n(91784),j=n(72825);const P=["flatpickrTarget"],I=["modalContainer"],_c2=e=>({"op-datepicker-modal--date-field_current":e}),_c3=e=>({"op-datepicker-modal--hidden-link":e});class OpWpSingleDateFormComponent extends _.p{constructor(e,t,n,i,r,s,a,l,c){super(),this.configurationService=e,this.apiV3Service=t,this.cdRef=n,this.injector=i,this.I18n=r,this.timezoneService=s,this.halEditing=a,this.dateModalScheduling=l,this.dateModalRelations=c,this.className=!0,this.value="",this.cancel=new o.bkB,this.save=new o.bkB,this.text={save:this.I18n.t("js.button_save"),cancel:this.I18n.t("js.button_cancel"),date:this.I18n.t("js.work_packages.properties.date"),placeholder:this.I18n.t("js.placeholders.default"),today:this.I18n.t("js.label_today")},this.scheduleManually=!1,this.ignoreNonWorkingDays=!1,this.htmlId="",this.date=null,this.dateChangedManually$=new d.B,this.debounceDelay=0}ngOnInit(){if(this.dateModalRelations.setChangeset(this.changeset),this.dateModalScheduling.setChangeset(this.changeset),this.scheduleManually=!!this.changeset.value("scheduleManually"),this.ignoreNonWorkingDays=!!this.changeset.value("ignoreNonWorkingDays"),!k(this.value).isValid())return this.value="",void(this.date="");this.date=this.timezoneService.formattedISODate(this.value)}ngAfterViewInit(){(0,f.A)(this.changeset.pristineResource)?this.initializeDatepicker(null):this.dateModalRelations.getMinimalDateFromPreceeding().subscribe((e=>{this.initializeDatepicker(e)})),this.dateChangedManually$.pipe((0,p.s)((()=>(0,u.O)(this.debounceDelay)))).subscribe((()=>{this.debounceDelay=800,this.updateDate(this.date)}))}changeSchedulingMode(){this.datePickerInstance?.datepickerInstance.redraw(),this.cdRef.detectChanges()}get isSchedulable(){return this.scheduleManually||!this.dateModalRelations.isParent}isDayDisabled(e,t){return!this.isSchedulable||!this.scheduleManually&&!!t&&e.dateObj<=t}changeNonWorkingDays(){this.datePickerInstance?.datepickerInstance.redraw(),this.cdRef.detectChanges()}doSave(e){e.preventDefault(),this.changeset.setValue("scheduleManually",this.scheduleManually),this.changeset.setValue("ignoreNonWorkingDays",this.ignoreNonWorkingDays),this.isSchedulable&&this.changeset.setValue("date",(0,g.i$)(this.date)),this.save.emit()}doCancel(){this.cancel.emit()}updateDate(e){if(null!==e&&(e.length>=8||0===e.length)&&(0,g.BY)(e)&&this.datePickerInstance){const t=(0,g._U)(e)||void 0;this.enforceManualChangesToDatepicker(t)}}setToday(){const e=(0,g._U)(new Date);this.date=this.timezoneService.formattedISODate(e),this.enforceManualChangesToDatepicker(e)}initializeDatepicker(e){var t,n=this;this.datePickerInstance?.destroy(),this.datePickerInstance=new s.l(this.injector,"#flatpickr-input",this.date||"",{mode:"single",showMonths:1,inline:!0,onReady:(e,t,n)=>{n.calendarContainer.classList.add("op-datepicker-modal--flatpickr-instance")},onChange:e=>{e.length>0&&(this.date=this.timezoneService.formattedISODate(e[0]),this.enforceManualChangesToDatepicker(e[0])),this.cdRef.detectChanges()},onDayCreate:(t=(0,i.A)((function*(t,i,o,r){(0,g.ce)(r,n.ignoreNonWorkingDays,yield n.datePickerInstance?.isNonWorkingDay(r.dateObj),n.isDayDisabled(r,e))})),function onDayCreate(e,n,i,o){return t.apply(this,arguments)})},this.flatpickrTarget.nativeElement)}enforceManualChangesToDatepicker(e){const t=(0,g._U)(this.date||"");(0,g._W)(t,this.datePickerInstance,e),t&&(this.date=this.timezoneService.formattedISODate(t))}updateDatesFromForm(e){const t=e.payload;this.date=t.date,this.ignoreNonWorkingDays=t.ignoreNonWorkingDays;const n=(0,g._U)(t.date);this.enforceManualChangesToDatepicker(n)}static{this.ɵfac=function OpWpSingleDateFormComponent_Factory(e){return new(e||OpWpSingleDateFormComponent)(o.rXU(l.s),o.rXU(h.n),o.rXU(o.gRc),o.rXU(o.zZn),o.rXU(r.W),o.rXU(c.D),o.rXU(a.p),o.rXU(b.v),o.rXU(m.O))}}static{this.ɵcmp=o.VBU({type:OpWpSingleDateFormComponent,selectors:[["op-wp-single-date-form"]],viewQuery:function OpWpSingleDateFormComponent_Query(e,t){if(1&e&&(o.GBs(P,5),o.GBs(I,5)),2&e){let e;o.mGM(e=o.lsd())&&(t.flatpickrTarget=e.first),o.mGM(e=o.lsd())&&(t.modalContainer=e.first)}},hostVars:2,hostBindings:function OpWpSingleDateFormComponent_HostBindings(e,t){2&e&&o.AVh("op-wp-single-date-form",t.className)},inputs:{value:"value",changeset:"changeset"},outputs:{cancel:"cancel",save:"save"},features:[o.Jv_([m.O,b.v]),o.Vt3],decls:15,vars:16,consts:[["modalContainer",""],["flatpickrTarget",""],["data-test-selector","op-datepicker-modal","data-indicator-name","modal","tabindex","0",1,"spot-container","op-datepicker-modal",3,"submit"],[1,"op-datepicker-modal--banner",3,"scheduleManually"],[1,"spot-container","op-datepicker-modal--stretch-content"],["name","scheduleManually",1,"spot-form-field",3,"ngModelChange","ngModel"],["name","ignoreNonWorkingDays",1,"spot-form-field",3,"ngModelChange","ngModel"],[3,"label"],["slot","input","name","date",1,"op-datepicker-modal--date-field",3,"ngModelChange","ngClass","ngModel","showClearButton"],["slot","action","type","button",1,"spot-link",3,"click","ngClass","textContent"],["id","flatpickr-input","hidden",""],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button","data-test-selector","op-datepicker-modal--action",1,"spot-modal--cancel-button","button","spot-action-bar--action",3,"click","textContent"],["type","submit","data-test-selector","op-datepicker-modal--action",1,"button","-primary","spot-action-bar--action",3,"textContent"]],template:function OpWpSingleDateFormComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"form",2,0),o.bIt("submit",(function OpWpSingleDateFormComponent_Template_form_submit_0_listener(n){return o.eBV(e),o.Njj(t.doSave(n))})),o.nrm(2,"op-datepicker-banner",3),o.j41(3,"div",4)(4,"op-datepicker-scheduling-toggle",5),o.mxI("ngModelChange",(function OpWpSingleDateFormComponent_Template_op_datepicker_scheduling_toggle_ngModelChange_4_listener(n){return o.eBV(e),o.DH7(t.scheduleManually,n)||(t.scheduleManually=n),o.Njj(n)})),o.bIt("ngModelChange",(function OpWpSingleDateFormComponent_Template_op_datepicker_scheduling_toggle_ngModelChange_4_listener(){return o.eBV(e),o.Njj(t.changeSchedulingMode())})),o.k0s(),o.j41(5,"op-datepicker-working-days-toggle",6),o.mxI("ngModelChange",(function OpWpSingleDateFormComponent_Template_op_datepicker_working_days_toggle_ngModelChange_5_listener(n){return o.eBV(e),o.DH7(t.ignoreNonWorkingDays,n)||(t.ignoreNonWorkingDays=n),o.Njj(n)})),o.bIt("ngModelChange",(function OpWpSingleDateFormComponent_Template_op_datepicker_working_days_toggle_ngModelChange_5_listener(){return o.eBV(e),o.Njj(t.changeNonWorkingDays())})),o.k0s(),o.j41(6,"spot-form-field",7)(7,"spot-text-field",8),o.mxI("ngModelChange",(function OpWpSingleDateFormComponent_Template_spot_text_field_ngModelChange_7_listener(n){return o.eBV(e),o.DH7(t.date,n)||(t.date=n),o.Njj(n)})),o.bIt("ngModelChange",(function OpWpSingleDateFormComponent_Template_spot_text_field_ngModelChange_7_listener(){return o.eBV(e),o.Njj(t.dateChangedManually$.next())})),o.k0s(),o.j41(8,"button",9),o.bIt("click",(function OpWpSingleDateFormComponent_Template_button_click_8_listener(){return o.eBV(e),o.Njj(t.setToday())})),o.k0s()(),o.nrm(9,"input",10,1),o.k0s(),o.j41(11,"div",11)(12,"div",12)(13,"button",13),o.bIt("click",(function OpWpSingleDateFormComponent_Template_button_click_13_listener(){return o.eBV(e),o.Njj(t.doCancel())})),o.k0s(),o.nrm(14,"button",14),o.k0s()()()}2&e&&(o.BMQ("id",t.htmlId),o.R7$(2),o.Y8G("scheduleManually",t.scheduleManually),o.R7$(2),o.R50("ngModel",t.scheduleManually),o.R7$(),o.R50("ngModel",t.ignoreNonWorkingDays),o.R7$(),o.Y8G("label",t.text.date),o.R7$(),o.Y8G("ngClass",o.eq3(12,_c2,t.isSchedulable)),o.R50("ngModel",t.date),o.Y8G("showClearButton",!0),o.R7$(),o.Y8G("ngClass",o.eq3(14,_c3,!t.isSchedulable))("textContent",t.text.today),o.R7$(5),o.Y8G("textContent",t.text.cancel),o.R7$(),o.Y8G("textContent",t.text.save))},dependencies:[v.qT,v.BC,v.cb,v.vS,v.cV,C.YU,y.l,w.U,T.J,S.p,j.X],styles:[".op-wp-single-date-form{height:100%}.op-wp-single-date-form .op-modal-banner{grid-template-columns:auto max-content!important}.op-wp-single-date-form .op-modal-banner .spot-icon,.op-wp-single-date-form .op-modal-banner .op-modal-banner--subtitle{display:none}\n",".op-datepicker-modal{display:flex;flex-direction:column;height:100%}@media (min-width: 1000px) and (min-height: 500px){.op-datepicker-modal{height:unset;min-height:475px;width:100vw;max-width:320px}.op-datepicker-modal_wide{max-width:600px}}.op-datepicker-modal--banner{margin-bottom:1rem}.op-datepicker-modal--banner:empty{visibility:hidden}.op-datepicker-modal--toggle-actions-container{display:grid;grid-template-columns:auto auto 1fr;grid-column-gap:2rem;margin:0 1rem}.op-datepicker-modal--toggle-actions-container .spot-form-field--input:has(spot-switch){margin-bottom:0!important}.op-datepicker-modal--dates-container{display:grid;grid-template-columns:1fr 1fr 150px;grid-gap:1rem;margin:1rem 1rem 0}.op-datepicker-modal--date-field_current,.op-datepicker-modal--date-field_current:hover{border:2px solid var(--control-checked-color);margin:-1px}.op-datepicker-modal--date-container{display:inline-grid}.op-datepicker-modal--hidden-link{visibility:hidden}.op-datepicker-modal--flatpickr-instance.inline{margin:.5rem auto 0!important;overflow:hidden}.op-datepicker-modal--stretch-content{flex-grow:1;flex-shrink:1;overflow-y:auto}.op-datepicker-modal--stretch-content.spot-container{margin-top:0}@media screen and (max-width: 543px){.op-datepicker-modal{width:calc(100vw - 2rem);margin-bottom:0}.op-datepicker-modal--flatpickr-instance{align-self:center}.op-datepicker-modal--dates-container{grid-template-columns:1fr 1fr}.op-datepicker-modal--toggle-actions-container{display:grid;grid-template-columns:1fr;grid-row-gap:1rem}.op-datepicker-modal--date-form:only-child{grid-column:1/3}}.flatpickr-wrapper{width:100%}\n"],encapsulation:2,changeDetection:0})}}},46874:(e,t,n)=>{"use strict";n.d(t,{f:()=>DynamicFormComponent});var i=n(68559),o=n(74385),r=n(61816),s=n(73014),a=n(89475),l=n(61318),c=n(72650),p=n(59452),d=n(70271),u=n(30501);class FormsService{constructor(e){this._httpClient=e}submit$(e,t,n,i,o){const r=this.formatModelToSubmit(e.getRawValue(),o),s=n?"patch":i||"post",a=n?`${t}/${n}`:t;return this._httpClient[s](a,r,{withCredentials:!0,responseType:"json"}).pipe((0,l.W)((t=>{throw 422==t.status&&this.handleBackendFormValidationErrors(t,e),t})))}validateForm$(e,t,n){const i=this.formatModelToSubmit(e.value,n);return this._httpClient.post(`${t}/form`,i,{withCredentials:!0,responseType:"json"}).pipe((0,d.T)((e=>this.getFormattedErrors(Object.values(e?._embedded?.validationErrors)))),(0,d.T)((t=>this.setFormValidationErrors(t,e))))}formatModelToSubmit(e,t={}){let{_links:n,...i}=e;const o=n||Object.keys(t).filter((e=>!!t[e]?.type&&"_links"===t[e]?.location)).reduce(((t,n)=>{const{[n]:o,...r}=i;return i=r,{...t,[n]:e[n]}}),{}),r=Object.keys(o).reduce(((e,t)=>{const n=o[t];return{...e,[t]:Array.isArray(n)?n.map((e=>({href:e?.href||e?._links?.self?.href||null}))):{href:n?.href||n?._links?.self?.href||null}}}),{});return{...i,_links:r}}formatModelToEdit(e={}){const{_links:t,_meta:n,...i}=e,o=Object.keys(i).filter((e=>this.isValue(i[e]))).reduce(((e,t)=>({...e,[t]:i[t]})),{});return{...o,_meta:n,...this.getFormattedResourcesModel(t)}}handleBackendFormValidationErrors(e,t){const n=e?.error?._embedded?.errors?e?.error?._embedded?.errors:[e.error],i=this.getFormattedErrors(n);this.setFormValidationErrors(i,t)}setFormValidationErrors(e,t){e.forEach((e=>{const n=t.get(e.key)||t.get("_links")?.get(e.key);n?.setErrors({[e.key]:{message:e.message}})}))}getAllFormValidationErrors(e,t){const n=Object.values(e),i=Array.isArray(t)?t:[t];return this.getFormattedErrors(n).filter((e=>!t||i.includes(e.key))).reduce(((e,{key:t,message:n})=>({...e,[t]:{message:n}})),{})}getFormattedErrors(e){return e.map((e=>({key:e._embedded.details.attribute,message:e.message})))}getFormattedResourcesModel(e={}){return Object.keys(e).reduce(((t,n)=>{const i=e[n],o=Array.isArray(i)?i.map((e=>({...e,name:e?.name||e?.title}))):{...i,name:i?.name||i?.title};return t={...t,...this.isValue(o)&&{[n]:o}}}),{})}isValue(e){return![null,void 0,""].includes(e)}static{this.ɵfac=function FormsService_Factory(e){return new(e||FormsService)(i.KVO(u.Qq))}}static{this.ɵprov=i.jDH({token:FormsService,factory:FormsService.ɵfac,providedIn:"root"})}}class DynamicFieldsService{constructor(e,t,n){this.httpClient=e,this.I18n=t,this.formsService=n,this.selectDefaultValue={name:"-",_links:{self:{href:null}}},this.inputsCatalogue=[{config:{type:"textInput",templateOptions:{type:"text"}},useForFields:["String"]},{config:{type:"textInput",templateOptions:{type:"password"}},useForFields:["Password"]},{config:{type:"textInput",templateOptions:{type:"text"}},useForFields:["Link"]},{config:{type:"integerInput",templateOptions:{type:"number",locale:this.I18n.locale}},useForFields:["Integer","Float"]},{config:{type:"booleanInput",templateOptions:{type:"checkbox"}},useForFields:["Boolean"]},{config:{type:"dateInput"},useForFields:["Date","DateTime"]},{config:{type:"userInput"},useForFields:["User"]},{config:{type:"formattableInput",className:"",templateOptions:{editorType:"full",noWrapLabel:!0}},useForFields:["Formattable"]},{config:{type:"selectInput",defaultValue:this.selectDefaultValue,templateOptions:{locale:this.I18n.locale,bindLabel:"name",searchable:!0,virtualScroll:!0,clearOnBackspace:!1,clearSearchOnAdd:!1,hideSelected:!1,text:{add_new_action:this.I18n.t("js.label_create")}},expressionProperties:{"templateOptions.clearable":(e,t,n)=>!n.templateOptions?.required}},useForFields:["Priority","Status","Type","Version","TimeEntriesActivity","Category","CustomOption"]},{config:{type:"projectInput",defaultValue:this.selectDefaultValue,templateOptions:{locale:this.I18n.locale,bindLabel:"name"},expressionProperties:{"templateOptions.clearable":(e,t,n)=>!n.templateOptions?.required}},useForFields:["Project"]},{config:{type:"selectProjectStatusInput",defaultValue:this.selectDefaultValue,templateOptions:{locale:this.I18n.locale,bindLabel:"name",searchable:!0},expressionProperties:{"templateOptions.clearable":(e,t,n)=>!n.templateOptions?.required}},useForFields:["ProjectStatus"]}]}getConfig(e,t){const n=e._attributeGroups?.map((e=>({name:e.name,fieldsFilter:t=>e.attributes?.includes(t.templateOptions?.property)}))),i=this.getFieldsSchemasWithKey(e).map((e=>this.getFormlyFieldConfig(e,t))).filter((e=>null!==e));return this.getFormlyFormWithFieldGroups(n,i)}getModel(e){return this.formsService.formatModelToEdit(e)}getFormlyFormWithFieldGroups(e=[],t=[]){return[...(t=t.reduce(((e,t)=>t.fieldGroup?[...e,...t.fieldGroup]:[...e,t]),[])).filter((t=>e.every((e=>!e.fieldsFilter||!e.fieldsFilter(t))))),...this.getDynamicFormFieldGroups(e,t)]}getFieldsSchemasWithKey(e){return Object.keys(e).map((t=>({...e[t],key:this.getAttributeKey(e[t],t)}))).filter((e=>this.isFieldSchema(e)&&e.writable))}getAttributeKey(e,t){return"_meta"===e.location?`${e.location}.${t}`:t}isFieldSchema(e){return!!e?.type}getFormlyFieldConfig(e,t){const{key:n,name:i,required:o,hasDefault:r,minLength:s,maxLength:a}=e,l=this.getFieldTypeConfig(e);if(!l)return null;const{templateOptions:c,...p}=l,d=this.getFieldProperty(n),u=d&&(t[d]||t._links&&t._links[d]),h=this.getFieldOptions(e,u);return{...p,key:n,wrappers:["op-dynamic-field-wrapper"],className:`op-form--field ${p?.className||""}`,templateOptions:{property:d,required:o,label:i,hasDefault:r,...null!=u&&{payloadValue:u},...s&&{minLength:s},...a&&{maxLength:a},...c,...h&&{options:h},allowedValuesHref:e?._links?.allowedValues?.href}}}getFieldTypeConfig(e){const t=e.type.replace("[]",""),n=this.inputsCatalogue.find((e=>e.useForFields.includes(t)));if(!n)return console.warn(`Could not find a input definition for a field with the following type: ${t}. The full field configuration is`,e),null;const i=n.config;let o;return"integerInput"===i.type||"selectInput"===i.type||"selectProjectStatusInput"===i.type||"userInput"===i.type?o={className:e.name,templateOptions:{...i.templateOptions,...this.isMultiSelectField(e)&&{multiple:!0}}}:"formattableInput"===i.type&&(o={templateOptions:{...i.templateOptions,rtl:e.options?.rtl,name:e.name}}),{...i,...o}}getFieldOptions(e,t){const n=e._embedded?.allowedValues||e._links?.allowedValues;let i;if(n){if(Array.isArray(n)){const e=n[0]?._links?.self?.title?this.formatAllowedValues(n):n;i=(0,p.of)(e)}else n.href&&(i=this.httpClient.get(function addParamToHref(e,t){const n=new URL(e,window.location.origin);return Object.keys(t).forEach((e=>{n.searchParams.set(e,t[e])})),n.pathname+n.search}(n.href,{pageSize:"-1"})).pipe((0,d.T)((e=>e._embedded.elements)),(0,d.T)((e=>this.formatAllowedValues(e)))));return i?.pipe((0,d.T)((e=>this.prependCurrentValue(e,t))),(0,d.T)((t=>this.prependDefaultValue(t,e))))}}formatAllowedValues(e){return e.map((e=>({...e,name:e._links?.self?.title})))}getFieldProperty(e){return e.split(".").pop()}getDynamicFormFieldGroups(e=[],t=[]){return e.reduce(((e,n)=>{let i=this.getDefaultFieldGroupSettings(n,t);return n.settings&&(i={...i,templateOptions:{...i.templateOptions,...n.settings.templateOptions&&n.settings.templateOptions},expressionProperties:{...i.expressionProperties,...n.settings.expressionProperties&&n.settings.expressionProperties}}),i?.fieldGroup?.length&&(e=[...e,i]),e}),[])}getDefaultFieldGroupSettings(e,t){return{wrappers:["op-dynamic-field-group-wrapper"],fieldGroupClassName:"op-form--fieldset",templateOptions:{label:e.name,isFieldGroup:!0,collapsibleFieldGroups:!0,collapsibleFieldGroupsCollapsed:!0},fieldGroup:this.getGroupFields(e,t),expressionProperties:{"templateOptions.collapsibleFieldGroupsCollapsed":this.collapsibleFieldGroupsCollapsedExpressionProperty}}}getGroupFields(e,t){return t.filter((t=>!(!t.key||!this.getFieldProperty(t.key))&&(!e.fieldsFilter||e.fieldsFilter(t))))}collapsibleFieldGroupsCollapsedExpressionProperty(e,t,n){return!("formly-group"!==n.type||!n.templateOptions?.collapsibleFieldGroups||!n.templateOptions?.collapsibleFieldGroupsCollapsed)&&!n.fieldGroup?.some((e=>e.formControl?.errors&&!e.hide&&n.options?.parentForm?.submitted))}prependCurrentValue(e,t){return!t?.href||e.some((e=>e?._links?.self?.href===t.href))?e:[{name:t.title,_links:{self:t}},...e]}prependDefaultValue(e,t){return t.required||this.isMultiSelectField(t)?e:[this.selectDefaultValue,...e]}isMultiSelectField(e){return e?.type?.startsWith("[]")}static{this.ɵfac=function DynamicFieldsService_Factory(e){return new(e||DynamicFieldsService)(i.KVO(u.Qq),i.KVO(r.W),i.KVO(FormsService))}}static{this.ɵprov=i.jDH({token:DynamicFieldsService,factory:DynamicFieldsService.ɵfac})}}var h=n(99496),m=n(48908),g=n(34456);class DynamicFormService{constructor(e,t,n){this._httpClient=e,this._dynamicFieldsService=t,this._formsService=n}registerForm(e){this.dynamicForm=e}getSettingsFromBackend$(e,t,n={}){const i=t?`/${t}`:"",o=e?.endsWith("/form")?"":"/form",r=`${e}${i}${o}`;return this._httpClient.post(r,n,{withCredentials:!0,responseType:"json"}).pipe((0,d.T)((e=>this.getSettings(e))))}getSettings(e){this.formSchema=e._embedded?.schema;const t=e._embedded?.payload;return{form:new g.J3({}),fields:this._dynamicFieldsService.getConfig(this.formSchema,t),model:this._dynamicFieldsService.getModel(t)}}formatModelToEdit(e){return this._formsService.formatModelToEdit(e)}validateForm$(e,t){return this._formsService.validateForm$(e,t,this.formSchema)}submit$(e,t,n,i){return this._formsService.submit$(e,t,n,i,this.formSchema)}static{this.ɵfac=function DynamicFormService_Factory(e){return new(e||DynamicFormService)(i.KVO(u.Qq),i.KVO(DynamicFieldsService),i.KVO(FormsService))}}static{this.ɵprov=i.jDH({token:DynamicFormService,factory:DynamicFormService.ɵfac})}}var _=n(12313),f=n(60316);function DynamicFormComponent_form_0_div_2_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",5)(1,"button",6),i.EFF(2),i.k0s(),i.j41(3,"button",7),i.bIt("click",(function DynamicFormComponent_form_0_div_2_Template_button_click_3_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.handleCancel())})),i.EFF(4),i.k0s()()}if(2&e){const e=i.XpG(2);i.R7$(),i.Y8G("disabled",e.inFlight),i.R7$(),i.SpI(" ",e.text.save," "),i.R7$(2),i.SpI(" ",e.text.cancel," ")}}function DynamicFormComponent_form_0_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"form",2),i.bIt("submit",(function DynamicFormComponent_form_0_Template_form_submit_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.submitForm(t.form))})),i.j41(1,"formly-form",3),i.bIt("modelChange",(function DynamicFormComponent_form_0_Template_formly_form_modelChange_1_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.onModelChange(t))})),i.k0s(),i.DNE(2,DynamicFormComponent_form_0_div_2_Template,5,3,"div",4),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("formGroup",e.form),i.R7$(),i.Y8G("form",e.form)("model",e.innerModel)("fields",e.fields),i.R7$(),i.Y8G("ngIf",e.handleSubmit)}}function DynamicFormComponent_formly_form_1_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"formly-form",8),i.bIt("modelChange",(function DynamicFormComponent_formly_form_1_Template_formly_form_modelChange_0_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.onModelChange(t))})),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("form",e.form)("model",e.innerModel)("fields",e.fields)}}class DynamicFormComponent extends h.p{set model(e){if(!this.innerModel&&!e)return;const t=this.dynamicFormService.formatModelToEdit(e);this.form.patchValue(t)}get model(){return this.form.getRawValue()}set dynamicForm(e){this.dynamicFormService.registerForm(e)}constructor(e,t,n,o,r,s,a){super(),this.dynamicFormService=e,this.dynamicFieldsService=t,this.I18n=n,this.pathHelperService=o,this.toastService=r,this.changeDetectorRef=s,this.confirmDialogService=a,this.formHttpMethod="post",this.initialPayload={},this.showNotifications=!0,this.showValidationErrorsOn="submit",this.handleSubmit=!0,this.modelChange=new i.bkB,this.submitted=new i.bkB,this.errored=new i.bkB,this.text={save:this.I18n.t("js.button_save"),cancel:this.I18n.t("js.button_cancel"),load_error_message:this.I18n.t("js.forms.load_error_message"),successful_update:this.I18n.t("js.notice_successful_update"),successful_create:this.I18n.t("js.notice_successful_create"),job_started:this.I18n.t("js.notice_job_started")},this.noSettingsSourceErrorMessage="DynamicFormComponent needs a settings, formUrl or resourcePath @Input\n  in order to fetch its setting. Please provide one.",this.noPathToSubmitToError="DynamicForm needs a resourcePath or formUrl @Input in order to be submitted \n  and validated. Please provide one."}setDisabledState(e){e?this.form.disable():this.form.enable()}ngOnChanges(e){(e.settings||e.resourcePath||e.resourceId||e.formUrl||e.formHttpMethod||e.dynamicFormGroup||e.initialPayload||e.fieldsSettingsPipe||e.fieldGroups)&&this.initializeDynamicForm(this.settings,this.resourcePath,this.resourceId,this.formUrl,this.initialPayload)}onModelChange(e){this.modelChange.emit(e)}submitForm(e){if(this.handleSubmit){if(!this.formEndpoint)throw new Error(this.noPathToSubmitToError);this.inFlight=!0,this.dynamicFormService.submit$(e,this.formEndpoint,this.resourceId,this.formHttpMethod).pipe((0,a.j)((()=>this.inFlight=!1))).subscribe((e=>{this.submitted.emit(e),this.showNotifications&&this.showSuccessNotification(e)}),(e=>{this.errored.emit(e?.error||e),this.showNotifications&&this.toastService.addError(e?.error?.message||e?.message)}))}}validateForm(){if(!this.formEndpoint)throw new Error(this.noPathToSubmitToError);return this.dynamicFormService.validateForm$(this.form,this.formEndpoint)}handleCancel(){this.form.dirty?this.confirmDialogService.confirm({text:{title:this.I18n.t("js.text_are_you_sure"),text:this.I18n.t("js.text_data_lost")}}).then((()=>{this.goBack()})).catch((()=>{})):this.goBack()}goBack(){window.history.back()}initializeDynamicForm(e,t,n,i,o){const r=this.getFormEndPoint(i,t);if(!r)throw new Error(this.noSettingsSourceErrorMessage);r!==this.formEndpoint&&(this.formEndpoint=r),e?this.setupDynamicFormFromSettings(e):this.setupDynamicFormFromBackend(this.formEndpoint,n,o)}getFormEndPoint(e,t){return e?e.endsWith("/form")?e.replace("/form",""):e:t||""}setupDynamicFormFromBackend(e,t,n){this.dynamicFormService.getSettingsFromBackend$(e,t,n).pipe((0,l.W)((e=>{throw this.toastService.addError(this.text.load_error_message),e}))).subscribe((e=>this.setupDynamicForm(e)))}setupDynamicFormFromSettings(e){const t={_embedded:{payload:e?.payload,schema:e?.schema}},n=this.dynamicFormService.getSettings(t);this.setupDynamicForm(n)}setupDynamicForm({fields:e,model:t,form:n}){this.fieldsSettingsPipe&&(e=this.fieldsSettingsPipe(e)),this.fieldGroups&&(e=this.dynamicFieldsService.getFormlyFormWithFieldGroups(this.fieldGroups,e));const i=this.resourceId||(0,_.A)(this.resourcePath||null);t.id=i,this.fields=e,this.innerModel=t,this.form=this.dynamicFormGroup||n,this.changeDetectorRef.detectChanges()}showSuccessNotification(e){const t=(()=>{if(e?.jobId){const t=e?.payload?.title;return`${t||""} ${this.text.job_started}`}return"patch"===this.formHttpMethod?this.text.successful_update:this.text.successful_create})();this.toastService.addSuccess(t)}static{this.ɵfac=function DynamicFormComponent_Factory(e){return new(e||DynamicFormComponent)(i.rXU(DynamicFormService),i.rXU(DynamicFieldsService),i.rXU(r.W),i.rXU(s.B),i.rXU(c.fw),i.rXU(i.gRc),i.rXU(m.g))}}static{this.ɵcmp=i.VBU({type:DynamicFormComponent,selectors:[["op-dynamic-form"]],viewQuery:function DynamicFormComponent_Query(e,t){if(1&e&&i.GBs(o.aF,5),2&e){let e;i.mGM(e=i.lsd())&&(t.dynamicForm=e.first)}},inputs:{formUrl:"formUrl",formHttpMethod:"formHttpMethod",resourcePath:"resourcePath",resourceId:"resourceId",settings:"settings",dynamicFormGroup:"dynamicFormGroup",initialPayload:"initialPayload",model:"model",fieldsSettingsPipe:"fieldsSettingsPipe",fieldGroups:"fieldGroups",showNotifications:"showNotifications",showValidationErrorsOn:"showValidationErrorsOn",handleSubmit:"handleSubmit",helpTextAttributeScope:"helpTextAttributeScope"},outputs:{modelChange:"modelChange",submitted:"submitted",errored:"errored"},features:[i.Jv_([DynamicFormService,DynamicFieldsService]),i.Vt3,i.OA$],decls:2,vars:2,consts:[["data-qa","op-form--container","class","op-form",3,"formGroup","submit",4,"ngIf"],["data-qa","op-form--container","class","op-form--fieldset",3,"form","model","fields","modelChange",4,"ngIf"],["data-qa","op-form--container",1,"op-form",3,"submit","formGroup"],[1,"op-form--fieldset",3,"modelChange","form","model","fields"],["class","op-form--submit",4,"ngIf"],[1,"op-form--submit"],["type","submit",1,"button","-primary",3,"disabled"],["type","button",1,"button",3,"click"],["data-qa","op-form--container",1,"op-form--fieldset",3,"modelChange","form","model","fields"]],template:function DynamicFormComponent_Template(e,t){1&e&&i.DNE(0,DynamicFormComponent_form_0_Template,3,5,"form",0)(1,DynamicFormComponent_formly_form_1_Template,1,3,"formly-form",1),2&e&&(i.Y8G("ngIf",t.form&&t.handleSubmit),i.R7$(),i.Y8G("ngIf",t.form&&!t.handleSubmit))},dependencies:[f.bT,g.qT,g.cb,g.j4,o.aF]})}}},54767:(e,t,n)=>{"use strict";n.d(t,{t:()=>DynamicFormsModule});var i=n(60316),o=n(74385),r=n(44931),s=n(62223),a=n(34456),l=n(68559);class TextInputComponent extends o.PU{static{this.ɵfac=(()=>{let e;return function TextInputComponent_Factory(t){return(e||(e=l.xGo(TextInputComponent)))(t||TextInputComponent)}})()}static{this.ɵcmp=l.VBU({type:TextInputComponent,selectors:[["op-text-input"]],features:[l.Vt3],decls:1,vars:4,consts:[[1,"op-input",3,"type","formControl","formlyAttributes"]],template:function TextInputComponent_Template(e,t){1&e&&l.nrm(0,"input",0),2&e&&(l.Y8G("type",t.to.type)("formControl",t.formControl)("formlyAttributes",t.field),l.BMQ("aria-required",t.to.required))},dependencies:[a.me,a.BC,a.l_,o.ch]})}}class IntegerInputComponent extends o.PU{static{this.ɵfac=(()=>{let e;return function IntegerInputComponent_Factory(t){return(e||(e=l.xGo(IntegerInputComponent)))(t||IntegerInputComponent)}})()}static{this.ɵcmp=l.VBU({type:IntegerInputComponent,selectors:[["op-integer-input"]],features:[l.Vt3],decls:1,vars:5,consts:[[1,"op-input",3,"type","formControl","formlyAttributes"]],template:function IntegerInputComponent_Template(e,t){1&e&&l.nrm(0,"input",0),2&e&&(l.Y8G("type",t.to.type)("formControl",t.formControl)("formlyAttributes",t.field),l.BMQ("aria-required",t.to.required)("lang",t.to.locale))},dependencies:[a.me,a.BC,a.l_,o.ch]})}}function SelectInputComponent_ng_template_2_Template(e,t){if(1&e&&(l.nrm(0,"b",3),l.EFF(1)),2&e){const e=t.searchTerm,n=l.XpG();l.Y8G("textContent",n.to.text.add_new_action),l.R7$(),l.SpI(": ",e," ")}}function SelectInputComponent_ng_template_3_Template(e,t){if(1&e&&(l.j41(0,"div",4),l.EFF(1),l.k0s()),2&e){const e=t.item,n=t.searchTerm;l.Y8G("ngOptionHighlight",n),l.R7$(),l.JRh(e.name)}}class SelectInputComponent extends o.PU{static{this.ɵfac=(()=>{let e;return function SelectInputComponent_Factory(t){return(e||(e=l.xGo(SelectInputComponent)))(t||SelectInputComponent)}})()}static{this.ɵcmp=l.VBU({type:SelectInputComponent,selectors:[["op-select-input"]],features:[l.Vt3],decls:4,vars:16,consts:[[3,"items","formControl","formlyAttributes","multiple","bindLabel","searchable","virtualScroll","clearable","typeahead","clearOnBackspace","clearSearchOnAdd","hideSelected"],["ng-tag-tmp",""],["ng-option-tmp",""],[3,"textContent"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight"]],template:function SelectInputComponent_Template(e,t){1&e&&(l.j41(0,"ng-select",0),l.nI1(1,"async"),l.DNE(2,SelectInputComponent_ng_template_2_Template,2,2,"ng-template",1)(3,SelectInputComponent_ng_template_3_Template,2,2,"ng-template",2),l.k0s()),2&e&&(l.Y8G("items",l.bMT(1,14,null==t.to?null:t.to.options))("formControl",t.formControl)("formlyAttributes",t.field)("multiple",t.to.multiple)("bindLabel",t.to.bindLabel)("searchable",t.to.searchable)("virtualScroll",t.to.virtualScroll)("clearable",t.to.clearable)("typeahead",t.to.typeahead)("clearOnBackspace",t.to.clearOnBackspace)("clearSearchOnAdd",t.to.clearSearchOnAdd)("hideSelected",t.to.hideSelected),l.BMQ("aria-required",t.to.required)("required",t.to.required))},dependencies:[a.BC,a.l_,o.ch,r.G,s.vr,s.Uq,s.BW,i.Jj]})}}var c=n(51196);class ProjectInputComponent extends o.PU{static{this.ɵfac=(()=>{let e;return function ProjectInputComponent_Factory(t){return(e||(e=l.xGo(ProjectInputComponent)))(t||ProjectInputComponent)}})()}static{this.ɵcmp=l.VBU({type:ProjectInputComponent,selectors:[["op-project-input"]],features:[l.Vt3],decls:1,vars:5,consts:[[3,"formControl","formlyAttributes","url"]],template:function ProjectInputComponent_Template(e,t){1&e&&l.nrm(0,"op-project-autocompleter",0),2&e&&(l.Y8G("formControl",t.formControl)("formlyAttributes",t.field)("url",t.to.allowedValuesHref),l.BMQ("aria-required",t.to.required)("required",t.to.required))},dependencies:[a.BC,a.l_,o.ch,c.j],encapsulation:2,changeDetection:0})}}var p=n(73018);function SelectProjectStatusInputComponent_ng_template_2_Template(e,t){if(1&e&&(l.nrm(0,"span",3),l.j41(1,"span",4),l.EFF(2),l.k0s()),2&e){const e=t.item,n=l.XpG();l.Y8G("ngClass",n.cssClass(e)),l.R7$(),l.Y8G("ngClass",n.cssClass(e)),l.R7$(),l.JRh(e.name)}}function SelectProjectStatusInputComponent_ng_template_3_Template(e,t){if(1&e&&(l.nrm(0,"span",3),l.j41(1,"span",4),l.EFF(2),l.k0s()),2&e){const e=t.item,n=l.XpG();l.Y8G("ngClass",n.cssClass(e)),l.R7$(),l.Y8G("ngClass",n.cssClass(e)),l.R7$(),l.JRh(e.name)}}class SelectProjectStatusInputComponent extends o.PU{cssClass(e){return(0,p.U)(e.id)}static{this.ɵfac=(()=>{let e;return function SelectProjectStatusInputComponent_Factory(t){return(e||(e=l.xGo(SelectProjectStatusInputComponent)))(t||SelectProjectStatusInputComponent)}})()}static{this.ɵcmp=l.VBU({type:SelectProjectStatusInputComponent,selectors:[["op-select-project-status-input"]],features:[l.Vt3],decls:4,vars:11,consts:[["bindLabel","name",3,"items","formControl","formlyAttributes","searchable","virtualScroll","clearable","clearOnBackspace","clearSearchOnAdd","hideSelected"],["ng-label-tmp",""],["ng-option-tmp",""],[1,"project-status--bulb","-inline",3,"ngClass"],[1,"project-status--name",3,"ngClass"]],template:function SelectProjectStatusInputComponent_Template(e,t){1&e&&(l.j41(0,"ng-select",0),l.nI1(1,"async"),l.DNE(2,SelectProjectStatusInputComponent_ng_template_2_Template,3,3,"ng-template",1)(3,SelectProjectStatusInputComponent_ng_template_3_Template,3,3,"ng-template",2),l.k0s()),2&e&&l.Y8G("items",l.bMT(1,9,null==t.to?null:t.to.options))("formControl",t.formControl)("formlyAttributes",t.field)("searchable",!0)("virtualScroll",!0)("clearable",!1)("clearOnBackspace",!1)("clearSearchOnAdd",!1)("hideSelected",!0)},dependencies:[i.YU,a.BC,a.l_,o.ch,s.vr,s.Uq,s.ZZ,i.Jj],encapsulation:2})}}class BooleanInputComponent extends o.PU{static{this.ɵfac=(()=>{let e;return function BooleanInputComponent_Factory(t){return(e||(e=l.xGo(BooleanInputComponent)))(t||BooleanInputComponent)}})()}static{this.ɵcmp=l.VBU({type:BooleanInputComponent,selectors:[["op-boolean-input"]],features:[l.Vt3],decls:1,vars:3,consts:[["type","checkbox",3,"formControl","formlyAttributes"]],template:function BooleanInputComponent_Template(e,t){1&e&&l.nrm(0,"input",0),2&e&&(l.Y8G("formControl",t.formControl)("formlyAttributes",t.field),l.BMQ("aria-required",t.to.required))},dependencies:[a.Zm,a.BC,a.l_,o.ch]})}}var d=n(46874),u=n(61816),h=n(20832);class FormattableControlComponent{get ckEditorContext(){return{type:this.templateOptions.editorType,field:this.templateOptions.name,macros:this.templateOptions.property.startsWith("customField")?"none":"resource",options:{rtl:this.templateOptions?.rtl}}}constructor(e){this.I18n=e,this.disabled=!1,this.initializationError=!1,this.onChange=()=>{},this.onTouch=()=>{}}ngOnInit(){this.text={attachmentLabel:this.I18n.t("js.label_formattable_attachment_hint"),save:this.I18n.t("js.inplace.button_save",{attribute:this.templateOptions?.name}),cancel:this.I18n.t("js.inplace.button_cancel",{attribute:this.templateOptions?.name})}}writeValue(e){this.value=e}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouch=e}setDisabledState(e){this.disabled=e,this.syncCKEditorReadonlyMode()}onContentChange(e){const t={raw:e};this.onTouch(),this.onChange(t)}syncCKEditorReadonlyMode(){const{ckEditorInstance:e}=this.editor;e&&(this.disabled?e.enableReadOnlyMode("formattable-control"):e.disableReadOnlyMode("formattable-control"))}onCkeditorSetup(e){this.syncCKEditorReadonlyMode(),this.editor.ckEditorInstance.ui.focusTracker.on("change:isFocused",((e,t,n)=>{n||this.touched||(this.touched=!0,this.onTouch())}))}static{this.ɵfac=function FormattableControlComponent_Factory(e){return new(e||FormattableControlComponent)(l.rXU(u.W))}}static{this.ɵcmp=l.VBU({type:FormattableControlComponent,selectors:[["op-formattable-control"]],viewQuery:function FormattableControlComponent_Query(e,t){if(1&e&&l.GBs(h.Y,7),2&e){let e;l.mGM(e=l.lsd())&&(t.editor=e.first)}},inputs:{templateOptions:"templateOptions"},features:[l.Jv_([{provide:a.kq,useExisting:(0,l.Rfq)((()=>FormattableControlComponent)),multi:!0}])],decls:2,vars:2,consts:[[1,"op-ckeditor--wrapper","op-ckeditor-element"],[3,"contentChanged","initializationFailed","initializeDone","context","content"]],template:function FormattableControlComponent_Template(e,t){1&e&&(l.j41(0,"div",0)(1,"op-ckeditor",1),l.bIt("contentChanged",(function FormattableControlComponent_Template_op_ckeditor_contentChanged_1_listener(e){return t.onContentChange(e)}))("initializationFailed",(function FormattableControlComponent_Template_op_ckeditor_initializationFailed_1_listener(){return t.initializationError=!0}))("initializeDone",(function FormattableControlComponent_Template_op_ckeditor_initializeDone_1_listener(e){return t.onCkeditorSetup(e)})),l.k0s()()),2&e&&(l.R7$(),l.Y8G("context",t.ckEditorContext)("content",null==t.value?null:t.value.raw))},dependencies:[h.Y]})}}class FormattableTextareaInputComponent extends o.PU{static{this.ɵfac=(()=>{let e;return function FormattableTextareaInputComponent_Factory(t){return(e||(e=l.xGo(FormattableTextareaInputComponent)))(t||FormattableTextareaInputComponent)}})()}static{this.ɵcmp=l.VBU({type:FormattableTextareaInputComponent,selectors:[["op-formattable-textarea-input"]],features:[l.Vt3],decls:1,vars:3,consts:[[3,"templateOptions","formControl","formlyAttributes"]],template:function FormattableTextareaInputComponent_Template(e,t){1&e&&l.nrm(0,"op-formattable-control",0),2&e&&l.Y8G("templateOptions",t.to)("formControl",t.formControl)("formlyAttributes",t.field)},dependencies:[a.BC,a.l_,o.ch,FormattableControlComponent],styles:["[_nghost-%COMP%]{overflow:hidden}"]})}}var m=n(11385),g=n(88294),_=n(73704);function DynamicFieldWrapperComponent_spot_form_field_0_Template(e,t){if(1&e&&(l.j41(0,"spot-form-field",3),l.eu8(1,4,0),l.nrm(3,"attribute-help-text",5)(4,"formly-validation-message",6),l.k0s()),2&e){const e=l.XpG();l.Y8G("control",null==e.field?null:e.field.formControl)("label",null==e.to?null:e.to.label)("hidden",null==e.field?null:e.field.hide)("noWrapLabel",null==e.to?null:e.to.noWrapLabel)("required",null==e.to?null:e.to.required)("helpTextAttribute",null==e.to?null:e.to.property)("helpTextAttributeScope",(null==e.to?null:e.to.helpTextAttributeScope)||(null==e.dynamicFormComponent?null:e.dynamicFormComponent.helpTextAttributeScope))("showValidationErrorOn",(null==e.to?null:e.to.showValidationErrorOn)||(null==e.dynamicFormComponent?null:e.dynamicFormComponent.showValidationErrorsOn)),l.BMQ("data-qa-field-name",null==e.to?null:e.to.property),l.R7$(3),l.Y8G("attribute",null==e.to?null:e.to.property)("attributeScope",(null==e.to?null:e.to.helpTextAttributeScope)||(null==e.dynamicFormComponent?null:e.dynamicFormComponent.helpTextAttributeScope)),l.R7$(),l.Y8G("field",e.field)}}function DynamicFieldWrapperComponent_spot_selector_field_1_Template(e,t){if(1&e&&(l.j41(0,"spot-selector-field",7),l.eu8(1,4,0),l.nrm(3,"attribute-help-text",5)(4,"formly-validation-message",6),l.k0s()),2&e){const e=l.XpG();l.Y8G("control",null==e.field?null:e.field.formControl)("label",null==e.to?null:e.to.label)("hidden",null==e.field?null:e.field.hide)("required",null==e.to?null:e.to.required)("showValidationErrorOn",(null==e.to?null:e.to.showValidationErrorOn)||(null==e.dynamicFormComponent?null:e.dynamicFormComponent.showValidationErrorsOn)),l.BMQ("data-qa-field-name",null==e.to?null:e.to.property),l.R7$(3),l.Y8G("attribute",null==e.to?null:e.to.property)("attributeScope",(null==e.to?null:e.to.helpTextAttributeScope)||(null==e.dynamicFormComponent?null:e.dynamicFormComponent.helpTextAttributeScope)),l.R7$(),l.Y8G("field",e.field)}}class DynamicFieldWrapperComponent extends o.cm{constructor(e){super(),this.dynamicFormComponent=e}static{this.ɵfac=function DynamicFieldWrapperComponent_Factory(e){return new(e||DynamicFieldWrapperComponent)(l.rXU(d.f,8))}}static{this.ɵcmp=l.VBU({type:DynamicFieldWrapperComponent,selectors:[["op-dynamic-field-wrapper"]],features:[l.Vt3],decls:2,vars:2,consts:[["fieldComponent",""],[3,"control","label","hidden","noWrapLabel","required","helpTextAttribute","helpTextAttributeScope","showValidationErrorOn",4,"ngIf"],[3,"control","label","hidden","required","showValidationErrorOn",4,"ngIf"],[3,"control","label","hidden","noWrapLabel","required","helpTextAttribute","helpTextAttributeScope","showValidationErrorOn"],["slot","input"],["slot","help-text",1,"spot-form-field--help-text",3,"attribute","attributeScope"],["slot","errors",1,"spot-form-field--error",3,"field"],[3,"control","label","hidden","required","showValidationErrorOn"]],template:function DynamicFieldWrapperComponent_Template(e,t){1&e&&l.DNE(0,DynamicFieldWrapperComponent_spot_form_field_0_Template,5,12,"spot-form-field",1)(1,DynamicFieldWrapperComponent_spot_selector_field_1_Template,5,9,"spot-selector-field",2),2&e&&(l.Y8G("ngIf","booleanInput"!==t.field.type),l.R7$(),l.Y8G("ngIf","booleanInput"===t.field.type))},dependencies:[i.bT,m.e,g.U,_.P,o.Nc],changeDetection:0})}}var f=n(98637),b=n(58192);class DateInputComponent extends o.PU{get class(){return"projects"===this.model?.id&&this.key.toString().startsWith("customField")?"form--date-picker-container -xslim":null}static{this.ɵfac=(()=>{let e;return function DateInputComponent_Factory(t){return(e||(e=l.xGo(DateInputComponent)))(t||DateInputComponent)}})()}static{this.ɵcmp=l.VBU({type:DateInputComponent,selectors:[["op-date-input"]],hostVars:2,hostBindings:function DateInputComponent_HostBindings(e,t){2&e&&l.HbH(t.class)},features:[l.Vt3],decls:1,vars:4,consts:[[3,"required","disabled","formControl","formlyAttributes"]],template:function DateInputComponent_Template(e,t){1&e&&l.nrm(0,"op-basic-single-date-picker",0),2&e&&l.Y8G("required",t.to.required)("disabled",t.to.disabled)("formControl",t.formControl)("formlyAttributes",t.field)},dependencies:[a.BC,a.YS,a.l_,o.ch,b.r],changeDetection:0})}}const _c0=e=>({"op-fieldset_collapsed":e});function DynamicFieldGroupWrapperComponent_fieldset_0_Template(e,t){if(1&e){const e=l.RV6();l.j41(0,"fieldset",3)(1,"legend",4)(2,"button",5),l.bIt("click",(function DynamicFieldGroupWrapperComponent_fieldset_0_Template_button_click_2_listener(){l.eBV(e);const t=l.XpG();return l.Njj(t.to.collapsibleFieldGroupsCollapsed=!t.to.collapsibleFieldGroupsCollapsed)})),l.EFF(3),l.k0s()(),l.j41(4,"div",6),l.eu8(5,null,0),l.k0s()()}if(2&e){const e=l.XpG();l.Y8G("ngClass",l.eq3(2,_c0,e.to.collapsibleFieldGroupsCollapsed)),l.R7$(3),l.SpI(" ",e.to.label," ")}}function DynamicFieldGroupWrapperComponent_fieldset_1_Template(e,t){if(1&e&&(l.j41(0,"fieldset",7)(1,"legend",4),l.EFF(2),l.k0s(),l.j41(3,"div",6),l.eu8(4,null,0),l.k0s()()),2&e){const e=l.XpG();l.R7$(2),l.JRh(e.to.label)}}class DynamicFieldGroupWrapperComponent extends o.cm{static{this.ɵfac=(()=>{let e;return function DynamicFieldGroupWrapperComponent_Factory(t){return(e||(e=l.xGo(DynamicFieldGroupWrapperComponent)))(t||DynamicFieldGroupWrapperComponent)}})()}static{this.ɵcmp=l.VBU({type:DynamicFieldGroupWrapperComponent,selectors:[["op-dynamic-field-group-wrapper"]],features:[l.Vt3],decls:2,vars:2,consts:[["fieldComponent",""],["class","op-fieldset op-fieldset_collapsible",3,"ngClass",4,"ngIf"],["class","op-fieldset",4,"ngIf"],[1,"op-fieldset","op-fieldset_collapsible",3,"ngClass"],[1,"op-fieldset--legend"],["title","Show/hide","type","button",1,"op-fieldset--toggle",3,"click"],[1,"op-fieldset--fields"],[1,"op-fieldset"]],template:function DynamicFieldGroupWrapperComponent_Template(e,t){1&e&&l.DNE(0,DynamicFieldGroupWrapperComponent_fieldset_0_Template,7,4,"fieldset",1)(1,DynamicFieldGroupWrapperComponent_fieldset_1_Template,6,1,"fieldset",2),2&e&&(l.Y8G("ngIf",null==t.to?null:t.to.collapsibleFieldGroups),l.R7$(),l.Y8G("ngIf",!(null!=t.to&&t.to.collapsibleFieldGroups)))},dependencies:[i.YU,i.bT]})}}var k=n(23084),v=n(83998);class FormattableControlModule{static{this.ɵfac=function FormattableControlModule_Factory(e){return new(e||FormattableControlModule)}}static{this.ɵmod=l.$C({type:FormattableControlModule})}static{this.ɵinj=l.G2t({imports:[i.MD,k.b,v.s]})}}("undefined"==typeof ngJitMode||ngJitMode)&&l.Obh(FormattableControlModule,{declarations:[FormattableControlComponent],imports:[i.MD,k.b,v.s],exports:[FormattableControlComponent]});var C=n(34802),y=n(77938);class UserInputComponent extends o.PU{ngOnInit(){this.projectId=this.model?.id}static{this.ɵfac=(()=>{let e;return function UserInputComponent_Factory(t){return(e||(e=l.xGo(UserInputComponent)))(t||UserInputComponent)}})()}static{this.ɵcmp=l.VBU({type:UserInputComponent,selectors:[["op-user-input"]],features:[l.Vt3],decls:1,vars:6,consts:[[3,"formControl","formlyAttributes","url","inviteUserToProject"]],template:function UserInputComponent_Template(e,t){1&e&&l.nrm(0,"op-user-autocompleter",0),2&e&&(l.Y8G("formControl",t.formControl)("formlyAttributes",t.field)("url",t.to.allowedValuesHref)("inviteUserToProject",t.projectId),l.BMQ("aria-required",t.to.required)("required",t.to.required))},dependencies:[a.BC,a.l_,o.ch,y.P],encapsulation:2,changeDetection:0})}}var w=n(72811),T=n(12918);class DynamicFormsModule{static{this.ɵfac=function DynamicFormsModule_Factory(e){return new(e||DynamicFormsModule)}}static{this.ɵmod=l.$C({type:DynamicFormsModule})}static{this.ɵinj=l.G2t({imports:[i.MD,a.X1,w.f,T.m,o.qy.forRoot({types:[{name:"booleanInput",component:BooleanInputComponent},{name:"integerInput",component:IntegerInputComponent},{name:"textInput",component:TextInputComponent},{name:"dateInput",component:DateInputComponent},{name:"selectInput",component:SelectInputComponent},{name:"projectInput",component:ProjectInputComponent},{name:"selectProjectStatusInput",component:SelectProjectStatusInputComponent},{name:"formattableInput",component:FormattableTextareaInputComponent},{name:"userInput",component:UserInputComponent}],wrappers:[{name:"op-dynamic-field-group-wrapper",component:DynamicFieldGroupWrapperComponent},{name:"op-dynamic-field-wrapper",component:DynamicFieldWrapperComponent}]}),C.d,a.YN,s.MQ,r.l,f.t,FormattableControlModule]})}}("undefined"==typeof ngJitMode||ngJitMode)&&l.Obh(DynamicFormsModule,{declarations:[d.f,DynamicFieldGroupWrapperComponent,DynamicFieldWrapperComponent,BooleanInputComponent,IntegerInputComponent,TextInputComponent,SelectInputComponent,ProjectInputComponent,SelectProjectStatusInputComponent,DateInputComponent,FormattableTextareaInputComponent,UserInputComponent],imports:[i.MD,a.X1,w.f,T.m,o.qy,C.d,a.YN,s.MQ,r.l,f.t,FormattableControlModule],exports:[d.f]})},24557:(e,t,n)=>{"use strict";n.d(t,{JS:()=>EditableToolbarTitleComponent,o:()=>m,vM:()=>h});var i=n(24398),o=n(68559),r=n(61816),s=n(7350),a=n(1758),l=n(60316),c=n(34456),p=n(2768),d=n(46765);const u=["editableTitleInput"],_c1=(e,t)=>({"-error":e,"-changed":t}),_c2=(e,t)=>({"-disabled":e,"-small":t});function EditableToolbarTitleComponent_div_0_button_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"button",7),o.bIt("click",(function EditableToolbarTitleComponent_div_0_button_1_Template_button_click_0_listener(t){o.eBV(e);const n=o.XpG(2);return o.Njj(n.save(t,!0))})),o.nrm(1,"op-icon",8),o.k0s()}if(2&e){const e=o.XpG(2);o.BMQ("title",e.text.query_has_changed_click_to_save)}}function EditableToolbarTitleComponent_div_0_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",3),o.bIt("focusout",(function EditableToolbarTitleComponent_div_0_Template_div_focusout_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.saveWhenFocusOutside(t))})),o.DNE(1,EditableToolbarTitleComponent_div_0_button_1_Template,2,1,"button",4),o.j41(2,"input",5,0),o.bIt("focus",(function EditableToolbarTitleComponent_div_0_Template_input_focus_2_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.onFocus(t))}))("blur",(function EditableToolbarTitleComponent_div_0_Template_input_blur_2_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.onBlur())}))("keydown.escape",(function EditableToolbarTitleComponent_div_0_Template_input_keydown_escape_2_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.reset(t))}))("keydown.enter",(function EditableToolbarTitleComponent_div_0_Template_input_keydown_enter_2_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.save(t))})),o.mxI("ngModelChange",(function EditableToolbarTitleComponent_div_0_Template_input_ngModelChange_2_listener(t){o.eBV(e);const n=o.XpG();return o.DH7(n.selectedTitle,t)||(n.selectedTitle=t),o.Njj(t)})),o.k0s(),o.j41(4,"input-shim",6),o.EFF(5),o.k0s()()}if(2&e){const e=o.XpG();o.R7$(),o.Y8G("ngIf",e.showSave),o.R7$(),o.Y8G("opAutofocus",e.initialFocus||void 0),o.R50("ngModel",e.selectedTitle),o.Y8G("disabled",e.inFlight)("ngClass",o.l_i(10,_c1,e.isEmpty,e.showSave)),o.BMQ("name",e.selectableTitleIdentifier)("placeholder",e.text.input_placeholder)("title",e.text.input_title),o.R7$(3),o.Lme("",e.selectedTitle||e.text.input_placeholder,"",e.selectedTitle?"  ":"","")}}function EditableToolbarTitleComponent_h2_1_Template(e,t){if(1&e&&(o.j41(0,"h2",9),o.EFF(1),o.k0s()),2&e){const e=o.XpG();o.Y8G("ngClass",o.l_i(3,_c2,e.disabled,e.smallHeader)),o.BMQ("title",e.selectedTitle),o.R7$(),o.SpI("",e.selectedTitle,"\n")}}const h="op:selectableTitle:trigger",m="editable-toolbar-title";class EditableToolbarTitleComponent{get editableClass(){return this.editable}constructor(e){this.injector=e,this.editable=!0,this.inFlight=!1,this.showSaveCondition=!1,this.initialFocus=!1,this.smallHeader=!1,this.onSave=new o.bkB,this.onEmptySubmit=new o.bkB,this.baseClass=!0,this.selectableTitleIdentifier=m,this.text={click_to_edit:this.I18n.t("js.work_packages.query.click_to_edit_query_name"),press_enter_to_save:this.I18n.t("js.label_press_enter_to_save"),query_has_changed_click_to_save:this.I18n.t("js.label_view_has_changed"),input_title:"",input_placeholder:this.I18n.t("js.work_packages.query.rename_query_placeholder"),confirm_edit_cancel:this.I18n.t("js.work_packages.query.confirm_edit_cancel"),duplicate_query_title:this.I18n.t("js.work_packages.query.errors.duplicate_query_title")}}ngOnInit(){this.text.input_title=`${this.text.click_to_edit} ${this.text.press_enter_to_save}`,jQuery(this.elementRef.nativeElement).on(h,((e,t="")=>{this.inputField&&(this.selectedTitle=t,setTimeout((()=>{this.inputField.nativeElement.focus()}),20),e.stopPropagation())}))}ngOnChanges(e){if(e.inputTitle&&(this.selectedTitle=e.inputTitle.currentValue),e.initialFocus&&e.initialFocus.firstChange&&this.inputField){const e=this.inputField.nativeElement;this.selectInputOnInitalFocus(e)}}onFocus(e){this.toggleToolbarButtonVisibility(!0),this.selectInputOnInitalFocus(e.target)}onBlur(){this.toggleToolbarButtonVisibility(!1)}selectInputOnInitalFocus(e){this.initialFocus&&(e.select(),this.initialFocus=!1)}saveWhenFocusOutside(e){(0,s.m)(this.elementRef.nativeElement,(()=>this.save(e)))}reset(){this.resetInputField(),this.selectedTitle=this.inputTitle}get showSave(){return this.editable&&this.showSaveCondition}save(e,t=!1){e.preventDefault(),this.resetInputField(),this.selectedTitle=this.selectedTitle.trim(),this.isEmpty?this.onEmptyError():(t||this.inputTitle!==this.selectedTitle)&&(this.inputField&&this.inputField.nativeElement.blur(),this.inFlight||(this.inFlight=!0,this.emitSave(this.selectedTitle),setTimeout((()=>this.inFlight=!1),100)))}get isEmpty(){return""===this.selectedTitle}emitSave(e){this.onSave.emit(e)}onEmptyError(){this.onEmptySubmit.emit(),this.focusInputOnError()}focusInputOnError(){if(this.inputField){const e=this.inputField.nativeElement;e.classList.add("-error"),e.focus()}}resetInputField(){if(this.inputField){this.inputField.nativeElement.classList.remove("-error")}}toggleToolbarButtonVisibility(e){jQuery(".toolbar-items").toggleClass("hidden-for-mobile",e)}static{this.ɵfac=function EditableToolbarTitleComponent_Factory(e){return new(e||EditableToolbarTitleComponent)(o.rXU(o.zZn))}}static{this.ɵcmp=o.VBU({type:EditableToolbarTitleComponent,selectors:[["editable-toolbar-title"]],viewQuery:function EditableToolbarTitleComponent_Query(e,t){if(1&e&&o.GBs(u,5),2&e){let e;o.mGM(e=o.lsd())&&(t.inputField=e.first)}},hostVars:4,hostBindings:function EditableToolbarTitleComponent_HostBindings(e,t){2&e&&o.AVh("title-container",t.baseClass)("title-container_editable",t.editableClass)},inputs:{inputTitle:[o.Mj6.None,"title","inputTitle"],editable:"editable",inFlight:"inFlight",showSaveCondition:"showSaveCondition",initialFocus:"initialFocus",smallHeader:"smallHeader"},outputs:{onSave:"onSave",onEmptySubmit:"onEmptySubmit"},features:[o.OA$],decls:2,vars:2,consts:[["editableTitleInput",""],["class","editable-toolbar-title--container",3,"focusout",4,"ngIf"],["class","editable-toolbar-title--fixed",3,"ngClass",4,"ngIf"],[1,"editable-toolbar-title--container",3,"focusout"],["type","button","class","spot-link editable-toolbar-title--save",3,"click",4,"ngIf"],["size","1","type","text","aria-required","true",1,"editable-toolbar-title--input","-border-on-hover-only","toolbar--editable-toolbar","ellipsis",3,"focus","blur","keydown.escape","keydown.enter","ngModelChange","opAutofocus","ngModel","disabled","ngClass"],[1,"editable-toolbar-title--input","editable-toolbar-title--input-shim","toolbar--editable-toolbar"],["type","button",1,"spot-link","editable-toolbar-title--save",3,"click"],["icon-classes","icon icon-save icon-no-color"],[1,"editable-toolbar-title--fixed",3,"ngClass"]],template:function EditableToolbarTitleComponent_Template(e,t){1&e&&o.DNE(0,EditableToolbarTitleComponent_div_0_Template,6,13,"div",1)(1,EditableToolbarTitleComponent_h2_1_Template,2,6,"h2",2),2&e&&(o.Y8G("ngIf",t.editable),o.R7$(),o.Y8G("ngIf",!t.editable))},dependencies:[l.YU,l.bT,c.me,c.BC,c.vS,p.B,d.i],styles:['.editable-toolbar-title--container[_ngcontent-%COMP%]{display:grid;align-items:center;grid-template-columns:auto auto 1fr}.editable-toolbar-title--container[_ngcontent-%COMP%]:before, .editable-toolbar-title--container[_ngcontent-%COMP%]:after{display:block;content:""}.editable-toolbar-title--container[_ngcontent-%COMP%]:before{grid-area:1/1}.editable-toolbar-title--container[_ngcontent-%COMP%]:after{grid-area:1/3}.editable-toolbar-title--fixed[_ngcontent-%COMP%]{padding:0;cursor:default}.editable-toolbar-title--save[_ngcontent-%COMP%]{grid-area:1/1}.editable-toolbar-title--save[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before{color:var(--fgColor-default)}.editable-toolbar-title--save[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]:before{color:#2c2c2c}.editable-toolbar-title--input[_ngcontent-%COMP%]{color:var(--fgColor-default)}.editable-toolbar-title--input[_ngcontent-%COMP%]:focus{border-color:var(--fgColor-accent);box-shadow:0 0 0 1px var(--fgColor-accent)}.editable-toolbar-title--input.-changed[_ngcontent-%COMP%]{font-style:italic}.editable-toolbar-title--input[_ngcontent-%COMP%]{display:block;grid-area:1/2;padding-left:5px;width:auto;min-width:1em}.editable-toolbar-title--input-shim[_ngcontent-%COMP%]{visibility:hidden;white-space:pre}input-shim[_ngcontent-%COMP%]{border:1px solid transparent;padding:.375rem;margin:0}']})}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",o.aKT)],EditableToolbarTitleComponent.prototype,"elementRef",void 0),(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",r.W)],EditableToolbarTitleComponent.prototype,"I18n",void 0)},80328:(e,t,n)=>{"use strict";n.d(t,{J:()=>CkeditorAugmentedTextareaComponent});var i=n(89204),o=n(68559),r=n(73014),s=n(36178),a=n(13432),l=n(51567),c=n(33900),p=n(72650),d=n(61816),u=n(20832),h=n(99664),m=n(99496),g=n(18537),f=n(37749),b=n(31749),k=n(60316),v=n(66913);function CkeditorAugmentedTextareaComponent_fieldset_2_Template(e,t){if(1&e&&(o.j41(0,"fieldset",3)(1,"legend",4),o.EFF(2),o.k0s(),o.nrm(3,"op-attachments",5),o.k0s()),2&e){const e=o.XpG();o.R7$(2),o.SpI(" ",e.text.attachments," "),o.R7$(),o.Y8G("resource",e.halResource)("destroyImmediately",!1)}}class CkeditorAugmentedTextareaComponent extends m.p{constructor(e,t,n,i,r,s){super(),this.elementRef=e,this.pathHelper=t,this.halResourceService=n,this.Notifications=i,this.I18n=r,this.states=s,this.removePlugins=[],this.turboMode=!1,this.editorType="full",this.showAttachments=!0,this.saveRequested=new o.bkB,this.editorKeyup=new o.bkB,this.editorBlur=new o.bkB,this.editorFocus=new o.bkB,this.changed=!1,this.inFlight=!1,this.readOnly=!1,this.text={attachments:this.I18n.t("js.label_attachments")},(0,f.w)(this)}ngOnInit(){this.element=this.elementRef.nativeElement,this.halResource=this.resource?this.halResourceService.createHalResource(this.resource,!0):void 0,this.formElement=this.element.closest("form"),this.wrappedTextArea=this.formElement.querySelector(this.textareaSelector),this.wrappedTextArea.style.display="none",this.wrappedTextArea.required=!1,this.initialContent=this.wrappedTextArea.value,this.readOnly=this.wrappedTextArea.disabled,this.context={type:this.editorType,resource:this.halResource,field:this.wrappedTextArea.name,previewContext:this.previewContext,removePlugins:this.removePlugins},this.readOnly?this.context.macros="none":this.macros&&(this.context.macros=this.macros),this.registerFormSubmitListener()}registerFormSubmitListener(){(0,g.R)(this.formElement,"submit").pipe((0,l.p)((()=>!this.inFlight)),this.untilDestroyed()).subscribe((e=>{e.preventDefault(),this.saveForm(e)}))}markEdited(){window.OpenProject.pageWasEdited=!0}saveForm(e){var t=this;return(0,i.A)((function*(){t.saveRequested.emit(),t.inFlight=!0,t.syncToTextarea(),window.OpenProject.pageIsSubmitted=!0,setTimeout((()=>{e?.submitter&&(e.submitter.disabled=!1),t.turboMode?t.formElement.dataset.action||b.gM.submitForm(t.formElement,e?.submitter||void 0):t.formElement.requestSubmit(e?.submitter)}))}))()}setup(e){return jQuery(this.element).data("editor",e),this.setupMarkingReadonlyWhenTextareaIsDisabled(e),this.halResource?.attachments&&(this.setupAttachmentAddedCallback(e),this.setupAttachmentRemovalSignal(e)),this.setLabel(),e}syncToTextarea(){try{this.wrappedTextArea.value=this.ckEditorInstance.getTransformedContent(!0)}catch(e){const t=e?.message||e.toString();throw console.error(`Failed to save CKEditor body to textarea: ${t}.`),this.Notifications.addError(t||this.I18n.t("js.error.internal")),e}}setupAttachmentAddedCallback(e){e.model.on("op:attachment-added",(()=>{this.states.forResource(this.halResource)?.putValue(this.halResource)}))}setupAttachmentRemovalSignal(e){this.attachments=_.clone(this.halResource.attachments.elements),this.states.forResource(this.halResource)?.changes$().pipe((0,c.Q)((0,h.pl)(this)),(0,l.p)((e=>!!e))).subscribe((t=>{const n=_.differenceBy(this.attachments,t.attachments.elements,(e=>e.id)).map((e=>e.downloadLocation.href));n.length&&e.model.fire("op:attachment-removed",n),this.attachments=_.clone(t.attachments.elements)}))}setupMarkingReadonlyWhenTextareaIsDisabled(e){new MutationObserver((t=>{this.readOnly!==this.wrappedTextArea.disabled&&(this.readOnly=this.wrappedTextArea.disabled,this.readOnly?e.enableReadOnlyMode("wrapped-text-area-disabled"):e.disableReadOnlyMode("wrapped-text-area-disabled"))})).observe(this.wrappedTextArea,{attributes:!0}),this.readOnly&&e.enableReadOnlyMode("wrapped-text-area-disabled")}setLabel(){const e=this.textareaSelector.substring(1),t=jQuery(`label[for=${e}]`),n=this.element.querySelector(".ck-content");n.removeAttribute("aria-label"),n.setAttribute("aria-labelledby",e),(0,g.R)(t,"click").pipe(this.untilDestroyed()).subscribe((()=>n.focus()))}static{this.ɵfac=function CkeditorAugmentedTextareaComponent_Factory(e){return new(e||CkeditorAugmentedTextareaComponent)(o.rXU(o.aKT),o.rXU(r.B),o.rXU(s.t),o.rXU(p.fw),o.rXU(d.W),o.rXU(a.D))}}static{this.ɵcmp=o.VBU({type:CkeditorAugmentedTextareaComponent,selectors:[["ng-component"]],viewQuery:function CkeditorAugmentedTextareaComponent_Query(e,t){if(1&e&&o.GBs(u.Y,7),2&e){let e;o.mGM(e=o.lsd())&&(t.ckEditorInstance=e.first)}},inputs:{textareaSelector:"textareaSelector",previewContext:"previewContext",macros:"macros",removePlugins:"removePlugins",resource:"resource",turboMode:"turboMode",editorType:"editorType",showAttachments:"showAttachments"},outputs:{saveRequested:"saveRequested",editorKeyup:"editorKeyup",editorBlur:"editorBlur",editorFocus:"editorFocus"},features:[o.Vt3],decls:3,vars:3,consts:[[1,"op-ckeditor--wrapper"],[3,"initializeDone","contentChanged","saveRequested","editorKeyup","editorBlur","editorFocus","context","content"],["class","form--fieldset",4,"ngIf"],[1,"form--fieldset"],[1,"form--fieldset-legend"],[3,"resource","destroyImmediately"]],template:function CkeditorAugmentedTextareaComponent_Template(e,t){1&e&&(o.j41(0,"div",0)(1,"op-ckeditor",1),o.bIt("initializeDone",(function CkeditorAugmentedTextareaComponent_Template_op_ckeditor_initializeDone_1_listener(e){return t.setup(e)}))("contentChanged",(function CkeditorAugmentedTextareaComponent_Template_op_ckeditor_contentChanged_1_listener(){return t.markEdited()}))("saveRequested",(function CkeditorAugmentedTextareaComponent_Template_op_ckeditor_saveRequested_1_listener(){return t.saveForm()}))("editorKeyup",(function CkeditorAugmentedTextareaComponent_Template_op_ckeditor_editorKeyup_1_listener(){return t.editorKeyup.emit()}))("editorBlur",(function CkeditorAugmentedTextareaComponent_Template_op_ckeditor_editorBlur_1_listener(){return t.editorBlur.emit()}))("editorFocus",(function CkeditorAugmentedTextareaComponent_Template_op_ckeditor_editorFocus_1_listener(){return t.editorFocus.emit()})),o.k0s()(),o.DNE(2,CkeditorAugmentedTextareaComponent_fieldset_2_Template,4,3,"fieldset",2)),2&e&&(o.R7$(),o.Y8G("context",t.context)("content",t.initialContent),o.R7$(),o.Y8G("ngIf",t.showAttachments&&(null==t.halResource?null:t.halResource.attachments)))},dependencies:[k.bT,v.r,u.Y],encapsulation:2,changeDetection:0})}}},44933:(e,t,n)=>{"use strict";n.d(t,{H:()=>CKEditorPreviewService});var i=n(68559);class CKEditorPreviewService{constructor(e,t,n){this.componentFactoryResolver=e,this.appRef=t,this.injector=n}render(e,t){e.innerHTML=t;const n=[];return()=>{n.forEach((e=>{this.appRef.detachView(e.hostView),e.destroy()})),n.length=0,e.innerHTML=""}}static{this.ɵfac=function CKEditorPreviewService_Factory(e){return new(e||CKEditorPreviewService)(i.KVO(i.OM3),i.KVO(i.o8S),i.KVO(i.zZn))}}static{this.ɵprov=i.jDH({token:CKEditorPreviewService,factory:CKEditorPreviewService.ɵfac})}}},12984:(e,t,n)=>{"use strict";n.d(t,{o:()=>CKEditorSetupService});var i=n(89204),o=n(73014),r=n(68559);class CKEditorSetupService{constructor(e){this.PathHelper=e,this.loadedLocale="en"}initialize(){this.prefetch=this.load(),this.watchTopLayer()}create(e,t,n=null){var o=this;return(0,i.A)((function*(){yield o.prefetch;const{type:i}=t,r="constrained"===i?window.OPConstrainedEditor:window.OPClassicEditor;e.classList.add(`ckeditor-type-${i}`);const s=e.querySelector(".document-editor__toolbar"),a=e.querySelector(".document-editor__editable"),l=o.loadedLocale,c=t.options&&t.options.rtl?"ar":"en",p={openProject:o.createConfig(t),removePlugins:t.removePlugins,initialData:n,ui:{poweredBy:{side:"left"}},language:{ui:l,content:c}};return o.createWatchdog(r,a,p).then((t=>{const{editor:n}=t;return s.appendChild(n.ui.view.toolbar.element),jQuery(e).on("op:ckeditor:autosave",(()=>n.config.get("autosave").save(n))).on("op:ckeditor:setData",((e,t)=>n.setData(t))).on("op:ckeditor:clear",(()=>n.setData(" "))).on("op:ckeditor:getData",((e,t)=>t(n.getData({trim:!1})))),t}))}))()}createWatchdog(e,t,n){const i=new window.OPEditorWatchdog;return i.setCreator((()=>e.createCustomized(t,n))),i.setDestructor((e=>e.destroy())),i.create(t,{}).then((()=>i))}load(){var e=this;return(0,i.A)((function*(){yield n.e("src_vendor_ckeditor_ckeditor_js").then(n.t.bind(n,16176,23)),"en"!==I18n.locale&&(yield e.loadLocale())}))()}loadLocale(){var e=this;return(0,i.A)((function*(){try{yield n(98811)(`./${I18n.locale}.js`),e.loadedLocale=I18n.locale}catch(e){console.warn(`Failed to load translation for CKEditor: ${e}`)}}))()}createConfig(e){return"none"===e.macros?e.macros=!1:"resource"===e.macros&&(e.macros=["OPMacroToc","OPMacroEmbeddedTable","OPMacroWpButton"]),{context:e,helpURL:this.PathHelper.textFormattingHelp(),pluginContext:window.OpenProject.pluginContext.value}}watchTopLayer(){const e=["ck-body-wrapper","ck-inspector-"];new MutationObserver((t=>{const n=document.querySelector("dialog[open]");n&&t.forEach((t=>{t.addedNodes.forEach((t=>{t instanceof HTMLElement&&e.some((e=>t.classList.contains(e)))&&n.append(t)}))}))})).observe(document.body,{childList:!0})}static{this.ɵfac=function CKEditorSetupService_Factory(e){return new(e||CKEditorSetupService)(r.KVO(o.B))}}static{this.ɵprov=r.jDH({token:CKEditorSetupService,factory:CKEditorSetupService.ɵfac})}}},20832:(e,t,n)=>{"use strict";n.d(t,{Y:()=>OpCkeditorComponent});var i=n(68559),o=n(72650),r=n(61816),s=n(72688),a=n(12984),l=n(41670),c=n(36819),p=n(99496),d=n(60316);const u=["opCkeditorReplacementContainer"],h=["codeMirrorPane"];function OpCkeditorComponent_div_1_Template(e,t){if(1&e&&(i.j41(0,"div",6)(1,"div",7)(2,"p"),i.nrm(3,"strong",8)(4,"br")(5,"span",8),i.k0s()()()),2&e){const e=i.XpG();i.R7$(3),i.Y8G("textContent",e.text.errorTitle),i.R7$(2),i.Y8G("textContent",e.error)}}class OpCkeditorComponent extends p.p{set content(e){this._content=e||"",this.initialized&&this.ckEditorInstance.setData(this._content)}constructor(e,t,n,o,r){super(),this.elementRef=e,this.Notifications=t,this.I18n=n,this.configurationService=o,this.ckEditorSetup=r,this.initializeDone=new i.bkB,this.contentChanged=new i.bkB,this.initializationFailed=new i.bkB,this.saveRequested=new i.bkB,this.editorKeyup=new i.bkB,this.editorBlur=new i.bkB,this.editorFocus=new i.bkB,this.error=null,this.allowManualMode=!1,this.manualMode=!1,this._content="",this.text={errorTitle:this.I18n.t("js.editor.ckeditor_error")},this.debouncedEmitter=_.debounce((()=>{const e=this.getTransformedContent(!1);this.contentChanged.emit(e)}),1e3,{leading:!0})}getRawData(){let e;if(e=this.manualMode?this.codeMirrorInstance.getValue():this.ckEditorInstance.getData({trim:!1}),null==e)throw new Error("Trying to get content from CKEditor failed, as it returned null.");return this._content=e,e}getTransformedContent(e=!0){try{if(!this.initialized)throw new Error("Tried to access CKEditor instance before initialization.");if(this.componentDestroyed)throw new Error("Component destroyed");return this.ckEditorInstance&&"destroyed"!==this.ckEditorInstance.state?this.getRawData():(console.warn("CKEditor instance is destroyed, returning last content"),this._content)}catch(t){console.error(`Failed to save CKEditor content: ${t}.`);const n=this.I18n.t("js.editor.error_saving_failed",{error:t.toString()||this.I18n.t("js.error.internal")});return e&&this.Notifications.addError(n),this._content}}get content(){return this._content}get initialized(){return void 0!==this.ckEditorInstance}ngOnInit(){try{this.initializeEditor()}catch(e){const t=e.toString();console.error("Failed to setup CKEditor instance: %O",e),this.error=t,this.initializationFailed.emit(t)}}ngOnDestroy(){try{this.watchdog?.destroy()}catch(e){console.error("Failed to destroy CKEditor instance:",e)}}initializeEditor(){this.$element=jQuery(this.elementRef.nativeElement);const e=this.ckEditorSetup.create(this.opCkeditorReplacementContainer.nativeElement,this.context,this.content).catch((e=>{throw e})).then((e=>{this.setupWatchdog(e);const t=e.editor;this.ckEditorInstance=t,t.on("op:source-code-enabled",(()=>this.enableManualMode())),t.on("op:source-code-disabled",(()=>this.disableManualMode())),this.interceptModifiedEnterKeystrokes(t),this.interceptKeyup(t),this.interceptBlur(t);const n=e.editor.model;return n.document.on("change",this.debouncedEmitter),n.on("op:attachment-added",(()=>document.body.dispatchEvent(new DragEvent("dragend")))),n.on("op:attachment-removed",(()=>document.body.dispatchEvent(new DragEvent("dragend")))),this.initializeDone.emit(e.editor),e.editor}));this.$element.data("editor",e)}interceptModifiedEnterKeystrokes(e){e.listenTo(e.editing.view.document,"keydown",((e,t)=>{(t.ctrlKey||t.metaKey)&&t.keyCode===l.c.ENTER&&((0,c.cY)("Sending save request from CKEditor."),this.saveRequested.emit(),e.stop())}),{priority:"highest"})}interceptKeyup(e){e.listenTo(e.editing.view.document,"keyup",(e=>{this.editorKeyup.emit(),e.stop()}),{priority:"highest"})}interceptBlur(e){e.listenTo(e.editing.view.document,"change:isFocused",(()=>{setTimeout((()=>{e.ui.focusTracker.isFocused?this.editorFocus.emit():this.editorBlur.emit()}),0)}),{priority:"highest"})}disableManualMode(){const e=this.getRawData();this.ckEditorInstance.setData(e),this.codeMirrorInstance=null,this.manualMode=!1}enableManualMode(){const e=this.getRawData();Promise.all([n.e("default-node_modules_codemirror_lib_codemirror_js").then(n.t.bind(n,81273,23)),n(69497)("./gfm/gfm.js")]).then((t=>{const n=t[0].default;this.codeMirrorInstance=n(this.$element.find(".ck-editor__source")[0],{lineNumbers:!0,smartIndent:!0,value:e,mode:""}),this.codeMirrorInstance.on("change",this.debouncedEmitter),setTimeout((()=>this.codeMirrorInstance.refresh()),100),this.manualMode=!0}))}setupWatchdog(e){this.watchdog=e,e.on("error",((e,{error:t})=>{this.error=t.message}))}static{this.ɵfac=function OpCkeditorComponent_Factory(e){return new(e||OpCkeditorComponent)(i.rXU(i.aKT),i.rXU(o.fw),i.rXU(r.W),i.rXU(s.s),i.rXU(a.o))}}static{this.ɵcmp=i.VBU({type:OpCkeditorComponent,selectors:[["op-ckeditor"]],viewQuery:function OpCkeditorComponent_Query(e,t){if(1&e&&(i.GBs(u,7),i.GBs(h,5)),2&e){let e;i.mGM(e=i.lsd())&&(t.opCkeditorReplacementContainer=e.first),i.mGM(e=i.lsd())&&(t.codeMirrorPane=e.first)}},inputs:{context:"context",content:"content"},outputs:{initializeDone:"initializeDone",contentChanged:"contentChanged",initializationFailed:"initializationFailed",saveRequested:"saveRequested",editorKeyup:"editorKeyup",editorBlur:"editorBlur",editorFocus:"editorFocus"},features:[i.Vt3],decls:7,vars:1,consts:[["opCkeditorReplacementContainer",""],["class","op-toast -error",4,"ngIf"],[1,"op-ckeditor-source-element","document-editor"],[1,"document-editor__toolbar"],[1,"document-editor__editable-container"],[1,"document-editor__editable"],[1,"op-toast","-error"],[1,"op-toast--content"],[3,"textContent"]],template:function OpCkeditorComponent_Template(e,t){1&e&&(i.qex(0),i.DNE(1,OpCkeditorComponent_div_1_Template,6,2,"div",1),i.j41(2,"div",2,0),i.nrm(4,"div",3),i.j41(5,"div",4),i.nrm(6,"div",5),i.k0s()(),i.bVm()),2&e&&(i.R7$(),i.Y8G("ngIf",t.error))},dependencies:[d.bT],styles:[".op-ckeditor--mode-switch[_ngcontent-%COMP%]{text-align:right}.op-ckeditor--mode-switch[_ngcontent-%COMP%]   button.button[_ngcontent-%COMP%]{margin:0 0 5px}"]})}}},23084:(e,t,n)=>{"use strict";n.d(t,{b:()=>OpenprojectEditorModule});var i=n(68559),o=n(34456),r=n(60316),s=n(6540),a=n(21452),l=n(80328),c=n(20832),p=n(12984),d=n(44933),u=n(20666),h=n(97306),m=n(49410),g=n(94370);function initializeServices(e){return()=>{e.get(p.o).initialize()}}class OpenprojectEditorModule{constructor(e){}static{this.ɵfac=function OpenprojectEditorModule_Factory(e){return new(e||OpenprojectEditorModule)(i.KVO(i.zZn))}}static{this.ɵmod=i.$C({type:OpenprojectEditorModule})}static{this.ɵinj=i.G2t({providers:[u.K,p.o,d.H,{provide:i.hnV,useFactory:initializeServices,deps:[i.zZn],multi:!0}],imports:[o.YN,r.MD,s._,a.p]})}}("undefined"==typeof ngJitMode||ngJitMode)&&i.Obh(OpenprojectEditorModule,{declarations:[l.J,c.Y,h.G,g.l,m.v],imports:[o.YN,r.MD,s._,a.p],exports:[l.J,c.Y]})},35321:(e,t,n)=>{"use strict";n.d(t,{l:()=>EnterpriseBannerComponent});var i=n(99972),o=n(61816),r=n(65277),s=n(51133),a=n(73014),l=n(37749),c=n(38941),p=n(68559),d=n(60316);const _c0=(e,t)=>({"-left-margin":e,"-top-margin":t});function EnterpriseBannerComponent_button_7_Template(e,t){if(1&e){const e=p.RV6();p.j41(0,"button",11),p.bIt("click",(function EnterpriseBannerComponent_button_7_Template_button_click_0_listener(){p.eBV(e);const t=p.XpG();return p.Njj(t.toggleCollapse())})),p.nrm(1,"span",12),p.k0s()}if(2&e){const e=p.XpG();p.R7$(),p.Y8G("ngClass",e.collapsed?"spot-icon_arrow-down1":"spot-icon_arrow-up1")}}function EnterpriseBannerComponent_span_10_Template(e,t){if(1&e&&(p.j41(0,"span",13),p.nrm(1,"strong",14),p.EFF(2),p.k0s()),2&e){const e=p.XpG();p.R7$(),p.Y8G("textContent",e.text.become_hero),p.R7$(),p.SpI(" ",e.text.you_contribute," ")}}function EnterpriseBannerComponent_div_11_a_1_Template(e,t){if(1&e&&(p.j41(0,"a",19),p.nrm(1,"span",20),p.EFF(2),p.k0s()),2&e){const e=p.XpG(2);p.BMQ("href",e.moreInfoLink,p.B4B),p.R7$(2),p.SpI(" ",e.text.more_info_text," ")}}function EnterpriseBannerComponent_div_11_Template(e,t){if(1&e&&(p.j41(0,"div",15),p.DNE(1,EnterpriseBannerComponent_div_11_a_1_Template,3,2,"a",16),p.j41(2,"a",17),p.nrm(3,"span",5),p.EFF(4),p.k0s(),p.j41(5,"a",18),p.EFF(6),p.k0s()()),2&e){const e=p.XpG();p.R7$(),p.Y8G("ngIf",e.moreInfoLink),p.R7$(),p.Y8G("href",e.pricingUrl,p.B4B),p.R7$(2),p.SpI(" ",e.text.upgrade," "),p.R7$(),p.BMQ("href",e.text.more_info_link,p.B4B),p.R7$(),p.SpI(" ",e.text.button_trial," ")}}class EnterpriseBannerComponent{constructor(e,t,n,i,o,s){this.elementRef=e,this.I18n=t,this.bannersService=n,this.opModalService=i,this.injector=o,this.pathHelper=s,this.leftMargin=!1,this.topMargin=!1,this.collapsed=!1,this.pricingUrl=c.at,this.text={enterpriseFeature:this.I18n.t("js.upsale.ee_only"),become_hero:this.I18n.t("js.admin.enterprise.upsale.become_hero"),you_contribute:this.I18n.t("js.admin.enterprise.upsale.you_contribute"),button_trial:this.I18n.t("js.admin.enterprise.upsale.button_start_trial"),upgrade:this.I18n.t("js.admin.enterprise.upsale.button_upgrade"),more_info_link:`${this.pathHelper.appBasePath}/admin/enterprise`,more_info_text:this.I18n.t("js.admin.enterprise.upsale.more_info")},this.image={enterprise_edition:(0,r.d)("enterprise-add-on.svg")},(0,l.w)(this)}ngOnInit(){this.link=this.bannersService.getEnterPriseEditionUrl({referrer:this.opReferrer}),this.collapsed=this.collapsible}toggleCollapse(){this.collapsed=!this.collapsed}static{this.ɵfac=function EnterpriseBannerComponent_Factory(e){return new(e||EnterpriseBannerComponent)(p.rXU(p.aKT),p.rXU(o.W),p.rXU(i.b),p.rXU(s.a),p.rXU(p.zZn),p.rXU(a.B))}}static{this.ɵcmp=p.VBU({type:EnterpriseBannerComponent,selectors:[["op-enterprise-banner"]],inputs:{leftMargin:"leftMargin",topMargin:"topMargin",textMessage:"textMessage",linkMessage:"linkMessage",opReferrer:"opReferrer",moreInfoLink:"moreInfoLink",collapsible:"collapsible"},decls:12,vars:10,consts:[["data-test-selector","op-enterprise-banner",1,"op-enterprise-banner"],[1,"op-toast","-ee-upsale",3,"ngClass"],[1,"hidden-for-mobile","op-enterprise-banner--image",3,"src"],[1,"op-toast--content"],[1,"op-enterprise-banner--header"],[1,"spot-icon","spot-icon_enterprise-addons"],[1,"op-enterprise-banner--title",3,"textContent"],["class","op-enterprise-banner--collapsible-button","type","button",3,"click",4,"ngIf"],[1,"op-enterprise-banner--description",3,"innerHtml"],["class","op-enterprise-banner--description",4,"ngIf"],["class","op-enterprise-banner--buttons",4,"ngIf"],["type","button",1,"op-enterprise-banner--collapsible-button",3,"click"],["aria-hidden","true",1,"spot-icon",3,"ngClass"],[1,"op-enterprise-banner--description"],[3,"textContent"],[1,"op-enterprise-banner--buttons"],["class","op-enterprise-banner--info-button","target","”_blank”",4,"ngIf"],["target","”_blank”",1,"button","-primary",3,"href"],["target","”_blank”",1,"button","-primary"],["target","”_blank”",1,"op-enterprise-banner--info-button"],[1,"spot-icon","spot-icon_external-link"]],template:function EnterpriseBannerComponent_Template(e,t){1&e&&(p.j41(0,"div",0)(1,"div",1),p.nrm(2,"img",2),p.j41(3,"div",3)(4,"div",4),p.nrm(5,"span",5)(6,"span",6),p.DNE(7,EnterpriseBannerComponent_button_7_Template,2,1,"button",7),p.k0s(),p.nrm(8,"br")(9,"span",8),p.DNE(10,EnterpriseBannerComponent_span_10_Template,3,2,"span",9)(11,EnterpriseBannerComponent_div_11_Template,7,5,"div",10),p.k0s()()()),2&e&&(p.R7$(),p.Y8G("ngClass",p.l_i(7,_c0,t.leftMargin,t.topMargin)),p.R7$(),p.Y8G("src",t.image.enterprise_edition,p.B4B),p.R7$(4),p.Y8G("textContent",t.text.enterpriseFeature),p.R7$(),p.Y8G("ngIf",t.collapsible),p.R7$(2),p.Y8G("innerHtml",t.textMessage,p.npT),p.R7$(),p.Y8G("ngIf",!t.collapsed),p.R7$(),p.Y8G("ngIf",!t.collapsed))},dependencies:[d.YU,d.bT],styles:[".op-enterprise-banner--header[_ngcontent-%COMP%]{font-size:20px;line-height:24px;display:grid;grid-template-columns:auto auto 1fr;align-items:center}.op-enterprise-banner--title[_ngcontent-%COMP%]{margin-left:.5rem}.op-enterprise-banner--description[_ngcontent-%COMP%]{display:block;font-family:var(--body-font-family);font-size:.875rem;font-weight:400;font-style:normal;line-height:1.25rem;margin-bottom:.75rem}.op-enterprise-banner--image[_ngcontent-%COMP%]{width:115px;height:75px;padding-right:20px;margin:auto}.op-enterprise-banner--buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.op-enterprise-banner--buttons[_ngcontent-%COMP%]   a.button[_ngcontent-%COMP%]{text-decoration:none}.op-enterprise-banner--info-button[_ngcontent-%COMP%]{padding-top:1rem;padding-right:1.5rem;display:flex;justify-content:center;align-items:center;text-decoration:none}.op-enterprise-banner--info-button[_ngcontent-%COMP%]   .spot-icon[_ngcontent-%COMP%]:before{padding-right:.875rem}.op-enterprise-banner--collapsible-button[_ngcontent-%COMP%]{background:transparent;color:#1a67a3;border:0;padding:.5rem;cursor:pointer;display:flex;justify-content:flex-end}"],changeDetection:0})}}},95393:(e,t,n)=>{"use strict";n.d(t,{U:()=>EnterprisePageComponent});var i=n(61816),o=n(65277),r=n(73014),s=n(38941),a=n(68559),l=n(60316),c=n(74356);const _c0=e=>({"upsale-notification_hide-breadcrumb":e});function EnterprisePageComponent_p_2_Template(e,t){if(1&e&&(a.j41(0,"p"),a.EFF(1),a.k0s()),2&e){const e=a.XpG();a.R7$(),a.JRh(e.feature_description)}}function EnterprisePageComponent_p_3_Template(e,t){if(1&e&&(a.j41(0,"p",12),a.EFF(1),a.nrm(2,"br"),a.EFF(3),a.nrm(4,"br"),a.EFF(5),a.k0s()),2&e){const e=a.XpG();a.R7$(),a.SpI(" ",e.text.benefits_description," "),a.R7$(2),a.SpI(" ",e.text.premium_features_text," "),a.R7$(2),a.SpI(" ",e.text.professional_support_text," ")}}function EnterprisePageComponent_video_5_Template(e,t){if(1&e&&(a.j41(0,"video",13),a.nrm(1,"source",14),a.k0s()),2&e){const e=a.XpG();a.Y8G("autoplay",!0)("loop",!0)("muted",!0),a.R7$(),a.Y8G("src",e.feature_video,a.B4B)}}function EnterprisePageComponent_img_6_Template(e,t){if(1&e&&a.nrm(0,"img",15),2&e){const e=a.XpG();a.Y8G("src",e.feature_image,a.B4B)}}function EnterprisePageComponent_img_7_Template(e,t){if(1&e&&a.nrm(0,"img",16),2&e){const e=a.XpG();a.Y8G("src",e.image.enterprise_edition,a.B4B)}}class EnterprisePageComponent{constructor(e,t,n){this.elementRef=e,this.I18n=t,this.pathHelper=n,this.hide_breadcrumb=!1,this.text={button_contact_us:this.I18n.t("js.admin.enterprise.upsale.button_contact_us"),upgrade:this.I18n.t("js.admin.enterprise.upsale.button_upgrade"),upgrade_link:s.at,contact_link:s._K.en,benefits_description:this.I18n.t("js.admin.enterprise.upsale.benefits.description"),premium_features_text:this.I18n.t("js.admin.enterprise.upsale.benefits.premium_features_text"),professional_support_text:this.I18n.t("js.admin.enterprise.upsale.benefits.professional_support_text"),enterprise_info_html:e=>this.I18n.t("js.admin.enterprise.upsale.enterprise_info_html",{feature_title:e}),upgrade_info:this.I18n.t("js.admin.enterprise.upsale.upgrade_info"),button_contact:this.I18n.t("js.admin.enterprise.upsale.buttons.contact"),button_upgrade:this.I18n.t("js.admin.enterprise.upsale.buttons.upgrade")},this.image={enterprise_edition:(0,o.d)("enterprise-add-on.svg")}}static{this.ɵfac=function EnterprisePageComponent_Factory(e){return new(e||EnterprisePageComponent)(a.rXU(a.aKT),a.rXU(i.W),a.rXU(r.B))}}static{this.ɵcmp=a.VBU({type:EnterprisePageComponent,selectors:[["op-enterprise-page"]],inputs:{feature_more_info:"feature_more_info",feature_video:"feature_video",feature_image:"feature_image",feature_title:"feature_title",feature_description:"feature_description",more_info:"more_info",hide_breadcrumb:"hide_breadcrumb"},decls:17,vars:16,consts:[[1,"upsale-notification",3,"ngClass"],[3,"textContent"],[4,"ngIf"],["class","upsale--feature-reference",4,"ngIf"],[1,"upsale--feature-reference",3,"textContent"],["width","400","playsinline","","class","widget-box--teaser-video",3,"autoplay","loop","muted",4,"ngIf"],["class","widget-box--teaser-image",3,"src",4,"ngIf"],["class","widget-box--teaser-image_default",3,"src",4,"ngIf"],[3,"innerHTML"],["target","”_blank”",1,"button"],["target","_blank",1,"button","-primary"],[1,"spot-icon","spot-icon_enterprise-addons"],[1,"upsale--feature-reference"],["width","400","playsinline","",1,"widget-box--teaser-video",3,"autoplay","loop","muted"],["type","video/mp4",3,"src"],[1,"widget-box--teaser-image",3,"src"],[1,"widget-box--teaser-image_default",3,"src"]],template:function EnterprisePageComponent_Template(e,t){1&e&&(a.j41(0,"div",0),a.nrm(1,"h2",1),a.DNE(2,EnterprisePageComponent_p_2_Template,2,1,"p",2)(3,EnterprisePageComponent_p_3_Template,6,3,"p",3),a.nrm(4,"p",4),a.DNE(5,EnterprisePageComponent_video_5_Template,2,4,"video",5)(6,EnterprisePageComponent_img_6_Template,1,1,"img",6)(7,EnterprisePageComponent_img_7_Template,1,1,"img",7),a.nrm(8,"p",8),a.j41(9,"p"),a.EFF(10),a.k0s(),a.j41(11,"a",9),a.EFF(12),a.k0s(),a.j41(13,"a",10),a.nrm(14,"span",11),a.EFF(15),a.k0s(),a.nrm(16,"opce-free-trial-button"),a.k0s()),2&e&&(a.Y8G("ngClass",a.eq3(14,_c0,t.hide_breadcrumb)),a.R7$(),a.Y8G("textContent",t.feature_title),a.R7$(),a.Y8G("ngIf",t.feature_description),a.R7$(),a.Y8G("ngIf",!t.feature_description),a.R7$(),a.Y8G("textContent",t.more_info),a.R7$(),a.Y8G("ngIf",t.feature_video),a.R7$(),a.Y8G("ngIf",t.feature_image),a.R7$(),a.Y8G("ngIf",!t.feature_image&&!t.feature_video),a.R7$(),a.Y8G("innerHTML",t.text.enterprise_info_html(t.feature_title),a.npT),a.R7$(2),a.JRh(t.text.upgrade_info),a.R7$(),a.BMQ("href",t.text.contact_link,a.B4B),a.R7$(),a.SpI(" ",t.text.button_contact_us," "),a.R7$(),a.BMQ("href",t.text.upgrade_link,a.B4B),a.R7$(2),a.SpI(" ",t.text.upgrade," "))},dependencies:[l.YU,l.bT,c.E],encapsulation:2,changeDetection:0})}}},38429:(e,t,n)=>{"use strict";n.d(t,{b:()=>ResourceChangeset});var i=n(47418);class Changeset{constructor(){this.changes={}}contains(e){return this.changes.hasOwnProperty(e)}get changed(){return _.keys(this.changes)}get all(){return this.changes}reset(...e){e.forEach((e=>{delete this.changes[e]}))}clear(){this.changes={}}set(e,t,n){this.changes[e]={from:n,to:t}}getItem(e){return this.changes[e]}getValue(e){return this.getItem(e)?.to}getPristine(e){return this.changes[e]?.from}}var o=n(36819),r=n(44674),s=n(61039),a=n(97366),l=n(56196);class ResourceChangeset{constructor(e,t,n=null){this.state=t,this.changeset=new Changeset,this.form$=(0,i.hF)(),this.cache={},this.inFlight=!1,this.updatePristineResource(e),this.schemaCache=e.injector.get(r.D),n&&this.form$.putValue(n)}push(){this.state&&this.state.putValue(this)}buildRequestPayload(){return this.getForm().then((()=>this.buildPayloadFromChanges()))}updatePristineResource(e){if(e.__is_changeset_proxy)throw new Error("You're trying to pass proxy object as a pristine resource. This will cause errors");this._pristineResource=e,this.projectedResource=new Proxy(this._pristineResource,{get:(e,t)=>this.proxyGet(t),set:(e,t,n)=>(this.setValue(t,n),!0)})}get pristineResource(){return this._pristineResource}getForm(e=!1){return!this.form$.isPristine()&&!e||this.form$.hasActivePromiseRequest()?(0,l._)(this.form$.values$()):this.updateForm()}updateForm(){const e=this.buildPayloadFromChanges();if(!this.pristineResource.$links.update)return Promise.reject();const t=this.pristineResource.$links.update(e).then((e=>(this.cache={},this.form$.putValue(e),this.setNewDefaults(e),this.push(),e)));return this.form$.putFromPromiseIfPristine((()=>t)),t}isEmpty(){return 0===this.changeset.changed.length}get id(){return this.pristineResource.id.toString()}get href(){return this.pristineResource.href}get changes(){const e={};return _.each(this.changeset.all,((t,n)=>{e[n]=t.to})),e}get changeMap(){return{...this.changeset.all}}get changedAttributes(){return this.changeset.changed}isWritable(e){const t=this.schema.ofProperty(e);return!(!t||!t.writable)}humanName(e){return _.get(this.schema,`${e}.name`,e)}contains(e){return this.changeset.contains(e)}proxyGet(e){return"__is_proxy"===e||this.value(e)}value(e){return this.changeset.contains(e)?this.changeset.getValue(e):this.pristineResource[e]}valueExists(e){return this.changeset.contains(e)||this.pristineResource.hasOwnProperty(e)}setValue(e,t){this.changeset.set(e,t,this.pristineResource[e])}clearValue(...e){this.changeset.reset(...e)}clear(){this.state&&this.state.clear(),this.changeset.clear(),this.cache={},this.form$.clear()}reset(e){this.changeset.reset(e)}isOverridden(e){return this.changes.hasOwnProperty(e)}get schema(){return this.form$.hasValue()?s.K.create(this.form$.value.schema,this.projectedResource):this.schemaCache.of(this.pristineResource)}cacheValue(e,t){return void 0!==this.cache[e]?this.cache[e]:this.cache[e]=t()}get minimalPayload(){return{lockVersion:this.pristineResource.lockVersion,_links:{}}}applyChanges(e){let t=this.pristineResource.$source;return this.form$.value&&(t=this.form$.value.payload.$source),_.each(this.changeset.all,((n,i)=>{if(!this.schema.isAttributeEditable(i))return void(0,o.cY)(`Trying to write ${i} but is not writable in schema`);const r=this.schema.ofProperty(i);r&&t._links[i]?e._links[i]=this.getLinkedValue(n.to,r):e[i]=n.to})),e}buildPayloadFromChanges(){let e;return(0,a.A)(this.pristineResource)?(e=this.form$.value?_.cloneDeep(this.form$.value.payload.$source):_.cloneDeep(this.pristineResource.$source),this.pristineResource.attachments&&(e._links.attachments=this.pristineResource.attachments.elements.map((e=>({href:e.href})))),this.pristineResource.fileLinks&&(e._links.fileLinks=this.pristineResource.fileLinks.elements.map((e=>({href:e.href}))))):e=this.minimalPayload,this.applyChanges(e)}getLinkedValue(e,t){if(_.isNil(e))return{href:null};const n=(t.type||"").startsWith("[]");let i=!1;if((e.forEach||e.elements)&&(i=!0),i&&n){const t=[];if(e){(e.forEach&&e||e.elements).forEach((e=>{e.href&&t.push({href:e.href})}))}return t}return{href:_.get(e,"href",null)}}setNewDefaults(e){_.each(e.payload,((e,t)=>{const n=this.schema.ofProperty(t);n?.writable&&this.setNewDefaultFor(t,e)}))}setNewDefaultFor(e,t){this.valueExists(e)||((0,o.cY)(`Taking over default value from form for ${e}`),this.setValue(e,t))}}},60807:(e,t,n)=>{"use strict";n.d(t,{IB:()=>d,K1:()=>h,Sx:()=>p,UJ:()=>c,nK:()=>u,wJ:()=>DisplayFieldRenderer});var i=n(24398),o=n(61816),r=n(39356),s=n(1758),a=n(44674),l=n(51339);const c="-editable",p="-read-only",d="inline-edit--display-field",u="inline-edit--display-trigger",h="inline-edit--container";class DisplayFieldRenderer{constructor(e,t,n={}){this.injector=e,this.container=t,this.options=n,this.fieldCache={}}render(e,t,n){const[i,o]=this.renderFieldValue(e,t,n);return null===i||this.setSpanAttributes(o,i,t,e,n),o}renderFieldValue(e,t,n){const i=document.createElement("span"),o=this.schema(e,n),r=this.attributeName(t,o),s=o.ofProperty(r);if(!s)return[null,i];const a=this.getField(e,s,r,n);a.render(i,this.getText(a),s.options);const{title:l}=a;return l&&!i.getAttribute("title")&&i.setAttribute("title",l),i.setAttribute("aria-label",this.getAriaLabel(a,o)),[a,i]}getField(e,t,n,i){let o=this.fieldCache[n];return o||(o=this.fieldCache[n]=this.getFieldForCurrentContext(e,n,t)),o.apply(e,t),o.activeChange=i,o}getFieldForCurrentContext(e,t,n){const i={container:this.container,injector:this.injector,options:this.options};return this.displayFieldService.getField(e,t,n,i)}getText(e){return e.isEmpty()?e.placeholder:e.valueString}setSpanAttributes(e,t,n,i,o){e.classList.add(d,n),e.dataset.fieldName=n,e.setAttribute("tabindex","id"===n?"-1":"0"),t.required&&e.classList.add("-required"),t.isEmpty()&&e.classList.add("-placeholder");const r=this.schema(i,o);this.isAttributeEditable(r,n)?(e.classList.add(c),e.setAttribute("role","button")):e.classList.add(p)}isAttributeEditable(e,t){return["startDate","dueDate","date"].includes(t)&&(t="combinedDate"),e.isAttributeEditable(t)}getAriaLabel(e,t){let n;const i=this.getLabelContent(e);if(e.isFormattable&&!e.isEmpty())try{n=_.escape(jQuery(`<div>${i}</div>`).text())}catch(t){console.error("Failed to parse formattable labelContent"),n=`Label for ${e.displayName}`}else n=i;return e.writable&&t.isAttributeEditable(e.name)?this.I18n.t("js.inplace.button_edit",{attribute:`${e.displayName} ${n}`}):`${e.displayName} ${n}`}getLabelContent(e){return e.isEmpty()?this.I18n.t("js.inplace.null_value_label"):e.valueString}attributeName(e,t){return t.mappedName?t.mappedName(e):e}schema(e,t){if(t)return t.schema;if(this.halEditing.typedState(e).hasValue()){return this.halEditing.typedState(e).value.schema}return this.schemaCache.of(e)}}(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",r.w)],DisplayFieldRenderer.prototype,"displayFieldService",void 0),(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",a.D)],DisplayFieldRenderer.prototype,"schemaCache",void 0),(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",l.p)],DisplayFieldRenderer.prototype,"halEditing",void 0),(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",o.W)],DisplayFieldRenderer.prototype,"I18n",void 0)},4930:(e,t,n)=>{"use strict";n.d(t,{W:()=>DisplayFieldComponent});var i=n(39356),o=(n(27514),n(44674)),r=n(68559);const s=["displayFieldContainer"];class DisplayFieldComponent{constructor(e,t,n){this.injector=e,this.displayFieldService=t,this.schemaCache=n,this.containerType="table",this.displayFieldOptions={}}ngOnInit(){this.schemaCache.ensureLoaded(this.resource).then((e=>{const t=this.schemaCache.proxied(this.resource,e);this.fieldName=this.attributeName(this.fieldName,t),this.render(t.ofProperty(this.fieldName))}))}render(e){const t=this.getDisplayFieldInstance(e);t.apply(this.resource,e);const n=this.container.nativeElement;n.hidden=!1,t.isEmpty()?n.textContent="-":t.render(n,t.valueString)}getDisplayFieldInstance(e){if(this.displayClass){const t=new this.displayClass(this.fieldName,this.displayFieldContext);return t.apply(this.resource,e),t}return this.displayFieldService.getField(this.resource,this.fieldName,e,this.displayFieldContext)}attributeName(e,t){return t.mappedName?t.mappedName(e):e}get displayFieldContext(){return{injector:this.injector,container:this.containerType,options:this.displayFieldOptions}}static{this.ɵfac=function DisplayFieldComponent_Factory(e){return new(e||DisplayFieldComponent)(r.rXU(r.zZn),r.rXU(i.w),r.rXU(o.D))}}static{this.ɵcmp=r.VBU({type:DisplayFieldComponent,selectors:[["display-field"]],viewQuery:function DisplayFieldComponent_Query(e,t){if(1&e&&r.GBs(s,5),2&e){let e;r.mGM(e=r.lsd())&&(t.container=e.first)}},inputs:{resource:"resource",fieldName:"fieldName",displayClass:"displayClass",containerType:"containerType",displayFieldOptions:"displayFieldOptions"},decls:2,vars:0,consts:[["displayFieldContainer",""]],template:function DisplayFieldComponent_Template(e,t){1&e&&r.nrm(0,"span",null,0)},encapsulation:2,changeDetection:0})}}},11621:(e,t,n)=>{"use strict";n.d(t,{p:()=>DisplayField,s:()=>a});var i=n(24398),o=n(2406),r=n(61816),s=n(1758);const a="custom-option";class DisplayField extends o.D{constructor(e,t){super(),this.name=e,this.context=t,this.mode=null,this.activeChange=null,this.texts={empty:this.I18n.t("js.label_no_value"),placeholder:this.I18n.t("js.placeholders.default")}}apply(e,t){this.resource=e,this.schema=t}get isFormattable(){return!1}get injector(){return this.context.injector}get value(){return this.schema?this.activeChange?this.activeChange.projectedResource[this.name]:this.attribute:null}get attribute(){return this.resource[this.name]}get type(){return this.constructor.type}get valueString(){return this.value}get placeholder(){return"-"}get label(){return this.schema.name||this.name}get title(){return this.isFormattable?null:this.valueString}render(e,t,n={}){e.textContent=t}renderEmpty(e){const t=document.createElement("div");t.setAttribute("title",this.texts.empty),t.textContent=this.texts.placeholder,t.classList.add(a,"-empty"),e.appendChild(t)}}(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",r.W)],DisplayField.prototype,"I18n",void 0)},39356:(e,t,n)=>{"use strict";n.d(t,{w:()=>DisplayFieldService});var i=n(55328),o=n(11621),r=n(66552);class MultipleLinesCustomOptionsDisplayField extends r.g{render(e,t){const n=this.stringValue;e.setAttribute("title",t),e.textContent=t,e.innerHTML="",0===n.length?this.renderEmpty(e):this.renderValues(n,e)}get valueString(){return this.stringValue.join(", ")}renderValues(e,t){e.forEach((e=>{const n=document.createElement("div");n.classList.add(o.s,"-multiple-lines"),n.setAttribute("title",e),n.textContent=e,t.appendChild(n)}))}}var s=n(24398),a=n(1758),l=n(65896);class MultipleLinesUserFieldModule extends r.g{render(e,t){const n=this.attribute;e.setAttribute("title",t),e.textContent=t,e.innerHTML="",0===n.length?this.renderEmpty(e):this.renderValues(n,e)}renderValues(e,t){this.principalRenderer.renderMultiple(t,e,{hide:!1,link:!1},{hide:!1,size:"medium"},!0)}}(0,s.Cg)([(0,a.O)(),(0,s.Sn)("design:type",l.r)],MultipleLinesUserFieldModule.prototype,"principalRenderer",void 0);class ProgressTextDisplayField extends o.p{get valueString(){return`${Math.round(Number(this.value))}%`}}var c=n(3851),p=n(14600),d=n(36647),u=n(95783),h=n(70271);function renderHierarchyItem(e){const t=e.$links;return(0,p.H)(t.branch()).pipe((0,h.T)((e=>function spansFromAncestors(e){const t=[];return e.elements.filter((e=>!!e.label)).forEach(((e,n,i)=>{const o=document.createElement("span");if(o.textContent=e.label,t.push(o),n<i.length-1){const e=document.createElement("span");e.textContent="/",t.push(e)}else if(null!==e.short){const n=document.createElement("span");n.textContent=`(${e.short})`,n.className="color-fg-subtle",t.push(n)}})),t}(e))),(0,h.T)((e=>{const t=document.createElement("div");return t.className="path",e.forEach((e=>t.appendChild(e))),t})))}class HierarchyItemDisplayField extends u.b{render(e,t){const n=this.attribute;null!==n&&n.name!==this.texts.placeholder?(e.innerHTML="",e.classList.add("hierarchy-items"),this.branch(n).subscribe((t=>{e.appendChild(t)}))):this.renderEmpty(e)}branch(e){const t=e.$link;return(0,p.H)(t.$fetch()).pipe((0,d.n)((e=>renderHierarchyItem(e))))}}var m=n(19999);class MultipleLinesHierarchyItemDisplayField extends r.g{render(e,t){const n=this.attribute;0!==n.length?(e.innerHTML="",e.classList.add("hierarchy-items"),this.branches(n).subscribe((t=>{t.forEach((t=>{e.appendChild(t)}))}))):this.renderEmpty(e)}get valueString(){return this.stringValue.join(", ")}branches(e){return(0,m.z)(e.map((e=>{const t=e.$link;return(0,p.H)(t.$fetch()).pipe((0,d.n)((e=>renderHierarchyItem(e))))})))}}var g=n(68559);class DisplayFieldService extends i.M{getField(e,t,n,i){const o=this.getFieldForContext(e,t,n,i);return o.apply(e,n),o}getFieldForContext(e,t,n,i){const o=["[]CustomOption"].indexOf(n.type)>=0;if("single-view"===i.container&&o)return new MultipleLinesCustomOptionsDisplayField(t,i);const r=["CustomField::Hierarchy::Item"].indexOf(n.type)>=0;if("single-view"===i.container&&r)return new HierarchyItemDisplayField(t,i);const s=["[]CustomField::Hierarchy::Item"].indexOf(n.type)>=0;if("single-view"===i.container&&s)return new MultipleLinesHierarchyItemDisplayField(t,i);const a=["[]Version"].indexOf(n.type)>=0;if("single-view"===i.container&&a)return new MultipleLinesCustomOptionsDisplayField(t,i);const l=["[]User"].indexOf(n.type)>=0;if("single-view"===i.container&&l)return new MultipleLinesUserFieldModule(t,i);if("timeline"===i.container&&"percentageDone"===t)return new ProgressTextDisplayField(t,i);if("table"===i.container&&["startDate","dueDate","date"].includes(t))return new c.H(t,i);return new(this.getSpecificClassFor(e._type,t,n.type))(t,i)}static{this.ɵfac=(()=>{let e;return function DisplayFieldService_Factory(t){return(e||(e=g.xGo(DisplayFieldService)))(t||DisplayFieldService)}})()}static{this.ɵprov=g.jDH({token:DisplayFieldService,factory:DisplayFieldService.ɵfac,providedIn:"root"})}}},94896:(e,t,n)=>{"use strict";n.d(t,{A:()=>CombinedDateDisplayField});var i=n(3851);class CombinedDateDisplayField extends i.H{constructor(){super(...arguments),this.text={placeholder:{startDate:this.I18n.t("js.label_no_start_date"),dueDate:this.I18n.t("js.label_no_due_date"),date:this.I18n.t("js.label_no_date")}}}render(e){"date"!==this.name?this.startDate&&this.startDate===this.dueDate?this.renderSingleDate("dueDate",e):this.startDate||this.dueDate?this.renderDates(e):e.innerHTML=this.customPlaceholder(`${this.text.placeholder.startDate} - ${this.text.placeholder.dueDate}`):this.renderSingleDate("date",e)}isEmpty(){return!1}customPlaceholder(e){return"string"==typeof this.context.options.placeholder?this.context.options.placeholder:e}get startDate(){return this.resource.startDate}get dueDate(){return this.resource.dueDate}renderSingleDate(e,t){t.innerHTML="";const n=this.createDateDisplayField(e);t.appendChild(n)}renderDates(e){e.innerHTML="";const t=this.createDateDisplayField("startDate"),n=this.createDateDisplayField("dueDate"),i=document.createElement("span");i.textContent=" - ",e.appendChild(t),e.appendChild(i),e.appendChild(n)}createDateDisplayField(e){const t=document.createElement("span"),n=new i.H(e,this.context);n.apply(this.resource,this.schema);const o=this.resource[e]?n.valueString:this.customPlaceholder(this.text.placeholder[e]);return n.render(t,o),t}}},3851:(e,t,n)=>{"use strict";n.d(t,{H:()=>DateDisplayField});var i=n(24398),o=n(46116),r=n(30183),s=n(1758),a=n(14593),l=n(32420);class DateDisplayField extends r.B{render(e,t){if(super.render(e,t),this.showSchedulingMode()){const t=document.createElement("span");t.classList.add("icon-context"),this.resource.scheduleManually&&t.classList.add("icon-pin"),e.prepend(t)}if(this.shouldHighlight&&this.canOverdue&&this.resource.status){const t=this.timezoneService.daysFromToday(this.value);this.apiV3Service.statuses.id(this.resource.status.id).get().subscribe((n=>{n.isClosed||e.classList.add(o.H.overdueDate(t))}))}}get canOverdue(){return-1!==["dueDate","date"].indexOf(this.name)}get valueString(){return this.value?this.timezoneService.formattedDate(this.value,this.context.options.dateFormat):""}showSchedulingMode(){return"startDate"===this.name||"date"===this.name}}(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",l.D)],DateDisplayField.prototype,"timezoneService",void 0),(0,i.Cg)([(0,s.O)(),(0,i.Sn)("design:type",a.n)],DateDisplayField.prototype,"apiV3Service",void 0)},30183:(e,t,n)=>{"use strict";n.d(t,{B:()=>HighlightableDisplayField});var i=n(24398),o=n(11621),r=n(62665),s=n(1758);class HighlightableDisplayField extends o.p{get highlightName(){return"date"===this.name?"dueDate":this.name}get shouldHighlight(){if(!1===this.context.options.colorize)return!1;const e=!!this.viewHighlighting&&this.viewHighlighting.shouldHighlightInline(this.highlightName);return"table"!==this.context.container||e}}(0,i.Cg)([(0,s.O)(r.I,null),(0,i.Sn)("design:type",r.I)],HighlightableDisplayField.prototype,"viewHighlighting",void 0)},95783:(e,t,n)=>{"use strict";n.d(t,{b:()=>ResourceDisplayField});var i=n(11621);class ResourceDisplayField extends i.p{get value(){return this.schema?this.attribute&&this.attribute.name:null}}},66552:(e,t,n)=>{"use strict";n.d(t,{g:()=>ResourcesDisplayField});var i=n(11621);class ResourcesDisplayField extends i.p{isEmpty(){return _.isEmpty(this.value)}get stringValue(){const e=this.resource[this.name];return this.schema&&e?e.elements?e.elements.map((e=>e.name)):e.map?e.map((e=>e.name)):e.name?[e.name]:[`error: ${JSON.stringify(e)}`]:[]}render(e,t){const n=this.stringValue;e.innerHTML="",e.setAttribute("title",n.join(", ")),0===n.length?this.renderEmpty(e):this.renderValues(n,e)}renderValues(e,t){const n=document.createDocumentFragment(),i=this.optionDiv(this.valueAbridged(e));if(n.appendChild(i),e.length>2){const t=this.optionDiv(e.length.toString(),"badge","-secondary");n.appendChild(t)}t.appendChild(n)}optionDiv(e,...t){const n=document.createElement("div"),o=document.createElement("span");return n.classList.add(i.s),o.classList.add(...t),o.textContent=e,n.appendChild(o),n}valueAbridged(e){const t=_.take(e,2);return e.length>2&&t.push("... "),t.join(", ")}}},34629:(e,t,n)=>{"use strict";n.d(t,{B:()=>OpExclusionInfoComponent});var i=n(61816),o=n(68559),r=n(93855),s=n(93338);class OpExclusionInfoComponent{constructor(e,t){this.I18n=e,this.cdRef=t,this.opened=!1,this.text={modalTitle:this.I18n.t("js.exclusion_info.modal.title"),modalContent:"",buttonClose:this.I18n.t("js.button_close")}}ngOnInit(){this.text.modalContent=this.I18n.t("js.exclusion_info.modal.content",{status_name:this.statusName||""})}toggleOpen(e){e.stopPropagation(),this.opened=!this.opened,this.cdRef.detectChanges()}static{this.ɵfac=function OpExclusionInfoComponent_Factory(e){return new(e||OpExclusionInfoComponent)(o.rXU(i.W),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:OpExclusionInfoComponent,selectors:[["op-exclusion-info"]],inputs:{statusName:"statusName"},decls:13,vars:4,consts:[[1,"op-exclusion-info",3,"closed","opened"],["slot","trigger","info-icon","","size","small",1,"button--icon","op-exclusion-info--icon",3,"click"],["slot","body",1,"op-exclusion-info--modal"],[1,"op-exclusion-info--modal"],[1,"spot-drop-modal--header"],[1,"spot-drop-modal--header-title"],[1,"spot-drop-modal--content"],[1,"spot-action-bar"],[1,"spot-action-bar--left"],[1,"button",3,"click"]],template:function OpExclusionInfoComponent_Template(e,t){1&e&&(o.j41(0,"spot-drop-modal",0),o.bIt("closed",(function OpExclusionInfoComponent_Template_spot_drop_modal_closed_0_listener(){return t.opened=!1})),o.qSk(),o.j41(1,"svg",1),o.bIt("click",(function OpExclusionInfoComponent_Template_svg_click_1_listener(e){return t.toggleOpen(e)})),o.k0s(),o.joV(),o.qex(2,2),o.j41(3,"div",3)(4,"div",4)(5,"div",5),o.EFF(6),o.k0s()(),o.j41(7,"div",6),o.EFF(8),o.k0s(),o.j41(9,"div",7)(10,"div",8)(11,"button",9),o.bIt("click",(function OpExclusionInfoComponent_Template_button_click_11_listener(e){return t.toggleOpen(e)})),o.EFF(12),o.k0s()()()(),o.bVm(),o.k0s()),2&e&&(o.Y8G("opened",t.opened),o.R7$(6),o.SpI(" ",t.text.modalTitle," "),o.R7$(2),o.SpI(" ",t.text.modalContent," "),o.R7$(4),o.SpI(" ",t.text.buttonClose," "))},dependencies:[r.bQj,s.m],styles:[".op-exclusion-info[_ngcontent-%COMP%]{display:inline-block}.op-exclusion-info--icon[_ngcontent-%COMP%]{margin-left:.25rem;cursor:pointer;color:var(--fgColor-muted)}.op-exclusion-info--icon[_ngcontent-%COMP%]:hover{color:var(--fgColor-default)}@media screen and (min-width: 1011px){.op-exclusion-info--modal[_ngcontent-%COMP%]{width:240px}}.op-exclusion-info--modal[_ngcontent-%COMP%]{margin:.5rem}.op-exclusion-info--modal[_ngcontent-%COMP%]   .spot-drop-modal--header-title[_ngcontent-%COMP%]{line-height:20px}"],changeDetection:0})}}},37248:(e,t,n)=>{"use strict";n.d(t,{BO:()=>a,Ii:()=>EditFieldComponent,Vu:()=>c,au:()=>s,hq:()=>l});var i=n(68559),o=(n(41804),n(61816)),r=n(2406);n(38429);const s=new i.nKC("editing-portal--schema"),a=new i.nKC("editing-portal--handler"),l=new i.nKC("editing-portal--changeset"),c="-editing";class EditFieldComponent extends r.D{constructor(e,t,n,i,o,r,s){super(),this.I18n=e,this.elementRef=t,this.change=n,this.schema=i,this.handler=o,this.cdRef=r,this.injector=s,this.self=this,this.updateFromChangeset(n)}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.initialize(),this.change.state&&this.change.state.values$().pipe(this.untilDestroyed()).subscribe((e=>{if(!e.schema.ofProperty(this.name))return this.handler.deactivate(!1);this.updateFromChangeset(e),this.initialize(),this.cdRef.markForCheck()}))}get overflowingSelector(){return this.$element?this.$element.closest(".__overflowing_element_container").data("overflowingIdentifier"):null}get inFlight(){return this.handler.inFlight}get value(){return this.resource[this.name]}set value(e){this.resource[this.name]=this.parseValue(e)}get placeholder(){return"subject"===this.name?this.I18n.t("js.placeholders.subject"):""}initialize(){}updateFromChangeset(e){this.change=e,this.resource=this.change.projectedResource,this.schema=this.change.schema.ofProperty(this.handler.fieldName)||this.schema,this.name=this.change.schema.mappedName(this.handler.fieldName)}parseValue(e){return e}static{this.ɵfac=function EditFieldComponent_Factory(e){return new(e||EditFieldComponent)(i.rXU(o.W),i.rXU(i.aKT),i.rXU(l),i.rXU(s),i.rXU(a),i.rXU(i.gRc),i.rXU(i.zZn))}}static{this.ɵdir=i.FsC({type:EditFieldComponent,features:[i.Vt3]})}}},27256:(e,t,n)=>{"use strict";n.d(t,{M:()=>EditFieldService});var i=n(55328),o=n(68559);class EditFieldService extends i.M{static{this.ɵfac=(()=>{let e;return function EditFieldService_Factory(t){return(e||(e=o.xGo(EditFieldService)))(t||EditFieldService)}})()}static{this.ɵprov=o.jDH({token:EditFieldService,factory:EditFieldService.ɵfac,providedIn:"root"})}}},76939:(e,t,n)=>{"use strict";n.d(t,{w:()=>EditFormRoutingService});var i=n(68559);class EditFormRoutingService{blockedTransition(e){return!0}static{this.ɵfac=function EditFormRoutingService_Factory(e){return new(e||EditFormRoutingService)}}static{this.ɵprov=i.jDH({token:EditFormRoutingService,factory:EditFormRoutingService.ɵfac})}}},34539:(e,t,n)=>{"use strict";n.d(t,{G:()=>EditFormComponent});var i=n(89204),o=n(68559),r=n(83093),s=n(72688),a=n(47418),l=n(51567),c=n(64334),p=n(70271),d=n(61816),u=n(51053),h=(n(27514),n(97501)),m=n(76939);class GlobalEditFormChangesTrackerService{get thereAreFormsWithUnsavedChanges(){return Array.from(this.activeForms.keys()).some((e=>!e.change.isEmpty()))}constructor(e){this.i18nService=e,this.activeForms=new Map,window.addEventListener("beforeunload",(e=>{this.thereAreFormsWithUnsavedChanges&&(e.preventDefault(),e.returnValue=this.i18nService.t("js.work_packages.confirm_edit_cancel"))}))}addToActiveForms(e){this.activeForms.set(e,!0)}removeFromActiveForms(e){this.activeForms.delete(e)}static{this.ɵfac=function GlobalEditFormChangesTrackerService_Factory(e){return new(e||GlobalEditFormChangesTrackerService)(o.KVO(d.W))}}static{this.ɵprov=o.jDH({token:GlobalEditFormChangesTrackerService,factory:GlobalEditFormChangesTrackerService.ɵfac,providedIn:"root"})}}var g=n(56196);const f=["*"];class EditFormComponent extends u.Rz{constructor(e,t,n,i,r,s,l,c,p,d){super(e),this.injector=e,this.elementRef=t,this.appRef=n,this.$transitions=i,this.ConfigurationService=r,this.editingPortalService=s,this.$state=l,this.I18n=c,this.editFormRouting=p,this.globalEditFormChangesTrackerService=d,this.initializeEditMode=!1,this.skippedFields=[],this.onSavedEmitter=new o.bkB,this.fields={},this.registeredFields=(0,a.hF)();const u=c.t("js.work_packages.confirm_edit_cancel"),h=r.warnOnLeavingUnsaved();this.unregisterListener=i.onBefore({},(e=>{if(this.removeIdleComponents(),this.editing){if(!this.editFormRouting||this.editFormRouting.blockedTransition(e)){if(h&&!window.confirm(u))return!1;this.cancel(!1)}return!0}}))}ngOnInit(){this.editMode=this.initializeEditMode,this.globalEditFormChangesTrackerService.addToActiveForms(this),this.initializeEditMode&&this.start()}ngOnDestroy(){this.unregisterListener(),this.globalEditFormChangesTrackerService.removeFromActiveForms(this)}removeIdleComponents(){this.appRef.components.forEach((e=>{const t=e.hostView.rootNodes[0];document.body.contains(t)||this.appRef.detachView(e.hostView)}))}activateField(e,t,n,o){var r=this;return(0,i.A)((function*(){return r.waitForField(n).then((i=>{i.setActive(!0);const s=i.editContainer.nativeElement;return r.editingPortalService.create(s,r.injector,e,t,n,o)}))}))()}reset(e,t=!1){var n=this;return(0,i.A)((function*(){const i=yield n.waitForField(e);i.reset(),i.deactivate(t)}))()}onSaved(e){this.cancel(!1),this.onSavedEmitter.emit({savedResource:e.resource,isInitial:e.wasNew})}cancel(e=!1){this.editMode=!1,this.closeEditFields("all",e),e&&this.halEditing.reset(this.change)}requireVisible(e){return new Promise(((t,n)=>{const i=setInterval((()=>{void 0!==this.fields[e]&&(clearInterval(i),t())}),50)}))}get editing(){return this.editMode||this.hasActiveFields()}register(e){this.fields[e.fieldName]=e,this.registeredFields.putValue(_.keys(this.fields));(this.editMode&&!this.skipField(e)||this.activeFields[e.fieldName])&&e.activateOnForm(!0)}waitForField(e){return(0,g._)(this.registeredFields.values$().pipe((0,l.p)((t=>t.indexOf(e)>=0)),(0,c.s)(1),(0,p.T)((()=>this.fields[e]))))}start(){_.each(this.fields,(e=>this.activate(e.fieldName)))}focusOnFirstError(){jQuery(this.elementRef.nativeElement).find(`.${u.zI}.-error .${u.qG}`).first().trigger("focus")}skipField(e){const{fieldName:t}=e;if(!(-1!==this.skippedFields.indexOf(t)))return!1;const n=this.resource[t],i=this.change.changes[t];return n&&!i}static{this.ɵfac=function EditFormComponent_Factory(e){return new(e||EditFormComponent)(o.rXU(o.zZn),o.rXU(o.aKT),o.rXU(o.o8S),o.rXU(r.HN),o.rXU(s.s),o.rXU(h.G),o.rXU(r.dw),o.rXU(d.W),o.rXU(m.w,8),o.rXU(GlobalEditFormChangesTrackerService))}}static{this.ɵcmp=o.VBU({type:EditFormComponent,selectors:[["edit-form"],["","edit-form",""]],inputs:{resource:"resource",initializeEditMode:[o.Mj6.None,"inEditMode","initializeEditMode"],skippedFields:"skippedFields"},outputs:{onSavedEmitter:"onSaved"},features:[o.Vt3],ngContentSelectors:f,decls:1,vars:0,template:function EditFormComponent_Template(e,t){1&e&&(o.NAR(),o.SdG(0))},encapsulation:2})}}},51053:(e,t,n)=>{"use strict";n.d(t,{Rz:()=>EditForm,qG:()=>h,zI:()=>u});var i=n(89204),o=n(24398),r=n(13432),s=n(51339),a=n(91691),l=n(1758),c=n(40358),p=n(97366),d=n(16169);const u="inline-edit--active-field",h="inline-edit--field";class EditForm{constructor(e){this.injector=e,this.activeFields={},this.errorsPerAttribute={},this.editMode=!1}onSaved(e){}hasActiveFields(){return!_.isEmpty(this.activeFields)}get change(){return this.halEditing.changeFor(this.resource)}activate(e,t=!1){return this.loadFieldSchema(e,t).then((n=>n.writable||t?this.renderField(e,n):(this.halNotification.showEditingBlockedError(n.name||e),Promise.reject())))}activateWhenNeeded(e){return this.activeFields[e]?Promise.resolve():this.requireVisible(e).then((()=>this.activate(e,!0)))}activateMissingFields(){this.change.getForm().then((e=>{_.each(e.validationErrors,((e,t)=>{"id"!==t&&this.activateWhenNeeded(t)}))}))}submit(){var e=this;return(0,i.A)((function*(){if(e.change.isEmpty()&&!(0,p.A)(e.resource))return e.closeEditFields(),Promise.resolve(e.resource);e.change.inFlight=!0,e.errorsPerAttribute={};const t=_.keys(e.activeFields);return yield Promise.all(_.map(e.activeFields,(e=>e.onSubmit()))),new Promise(((n,i)=>{e.halEditing.save(e.change).then((i=>{e.closeEditFields(t),n(i.resource),e.halNotification.showSave(i.resource,i.wasNew),e.editMode=!1,e.onSaved(i),e.change.inFlight=!1})).catch((t=>(e.halNotification.handleRawError(t,e.resource),t instanceof d.i&&t.resource&&(e.handleSubmissionErrors(t.resource),i()),e.change.inFlight=!1,Promise.reject(t))))}))}))()}closeEditFields(e="all",t=!0){"all"===e&&(e=_.keys(this.activeFields)),e.forEach((e=>{const n=this.activeFields[e];n&&n.deactivate(!1),t&&this.change.reset(e)}))}handleSubmissionErrors(e){this.handleErroneousAttributes(e)}handleErroneousAttributes(e){const t=e.getInvolvedAttributes();this.errorsPerAttribute=e.getMessagesPerAttribute(),0!==t.length&&this.setErrorsForFields(t)}setErrorsForFields(e){const t=e.map((e=>this.requireVisible(e).then((()=>(this.activeFields[e]&&this.activeFields[e].setErrors(this.errorsPerAttribute[e]||[]),this.activateWhenNeeded(e))))));Promise.all(t).then((()=>{setTimeout((()=>this.focusOnFirstError()))})).catch((()=>{console.error("Failed to activate all erroneous fields.")}))}loadFieldSchema(e,t=!1){return new Promise(((n,i)=>{this.loadFormAndCheck(e,t);const o=this.change.schema.ofProperty(e);if(!o)throw new Error;n(o)}))}loadFormAndCheck(e,t=!1){this.change.getForm().then((()=>{const n=this.change.schema.ofProperty(e);n.writable||t||(this.halNotification.showEditingBlockedError(n.name||e),this.closeEditFields([e]))})).catch((t=>{console.error("Failed to build edit field: %o",t),this.halNotification.handleRawError(t,this.resource),this.closeEditFields([e])}))}renderField(e,t){return this.activateField(this,t,e,this.errorsPerAttribute[e]||[]).then((t=>(this.activeFields[e]=t,t))).catch((e=>{console.error(`Failed to render edit field:${e}`),this.halNotification.handleRawError(e)}))}}(0,o.Cg)([(0,l.O)(),(0,o.Sn)("design:type",r.D)],EditForm.prototype,"states",void 0),(0,o.Cg)([(0,l.O)(),(0,o.Sn)("design:type",s.p)],EditForm.prototype,"halEditing",void 0),(0,o.Cg)([(0,l.O)(),(0,o.Sn)("design:type",c.Y)],EditForm.prototype,"halNotification",void 0),(0,o.Cg)([(0,l.O)(),(0,o.Sn)("design:type",a.o)],EditForm.prototype,"halEvents",void 0)},41804:(e,t,n)=>{"use strict";n.d(t,{L:()=>EditFieldHandler});var i=n(84205),o=n(99496);class EditFieldHandler extends o.p{constructor(){super(...arguments),this.onDestroy=new i.B,this._onSubmitHandlers=[],this._onBeforeSubmitHandlers=[]}errorMessageOnLabel(){}onSubmit(){return Promise.all(this._onSubmitHandlers.map((e=>e())))}registerOnSubmit(e){this._onSubmitHandlers.push(e)}onBeforeSubmit(){return this._onBeforeSubmitHandlers.map((e=>e()))}registerOnBeforeSubmit(e){this._onBeforeSubmitHandlers.push(e)}previewContext(e){}}},43063:(e,t,n)=>{"use strict";n.d(t,{u:()=>EditFormPortalComponent});var i=n(68559),o=(n(41804),n(37248)),r=n(35970),s=n(27256),a=(n(38429),n(60316)),l=n(34456),c=n(25827);const _c0=e=>({"-error":e});function EditFormPortalComponent_div_0_ng_container_4_Template(e,t){1&e&&i.eu8(0)}function EditFormPortalComponent_div_0_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",1)(1,"form",2),i.bIt("submit",(function EditFormPortalComponent_div_0_Template_form_submit_1_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.handler.handleUserSubmit())})),i.j41(2,"label",3),i.EFF(3),i.k0s(),i.DNE(4,EditFormPortalComponent_div_0_ng_container_4_Template,1,0,"ng-container",4),i.k0s()()}if(2&e){const e=i.XpG();i.ZvI("inline-edit--active-field inplace-edit ",e.handler.fieldName,""),i.Y8G("ngClass",i.eq3(9,_c0,e.handler.isErrorenous)),i.R7$(2),i.Y8G("for",e.handler.htmlId),i.R7$(),i.Lme(" ",e.handler.fieldLabel," ",e.handler.errorMessageOnLabel()," "),i.R7$(),i.Y8G("ngComponentOutlet",e.componentClass)("ngComponentOutletInjector",e.fieldInjector)}}class EditFormPortalComponent{constructor(e,t,n){this.injector=e,this.editField=t,this.elementRef=n,this.onEditFieldReady=new i.bkB}ngOnInit(){this.editFieldHandler&&this.schemaInput?(this.handler=this.editFieldHandler,this.schema=this.schemaInput,this.change=this.changeInput):(this.handler=this.injector.get(o.BO),this.schema=this.injector.get(o.au),this.change=this.injector.get(o.hq)),this.componentClass=this.editField.getSpecificClassFor(this.change.pristineResource._type,this.handler.fieldName,this.schema.type),this.fieldInjector=(0,r.U)(this.injector,this.change,this.handler,this.schema)}ngOnDestroy(){this.onEditFieldReady.complete()}ngAfterViewInit(){setTimeout((()=>{this.onEditFieldReady.emit()}))}static{this.ɵfac=function EditFormPortalComponent_Factory(e){return new(e||EditFormPortalComponent)(i.rXU(i.zZn),i.rXU(s.M),i.rXU(i.aKT))}}static{this.ɵcmp=i.VBU({type:EditFormPortalComponent,selectors:[["edit-form-portal"]],inputs:{schemaInput:"schemaInput",changeInput:"changeInput",editFieldHandler:"editFieldHandler"},outputs:{onEditFieldReady:"onEditFieldReady"},decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],["role","form","tabindex","-1",3,"submit"],[1,"hidden-for-sighted",3,"for"],[4,"ngComponentOutlet","ngComponentOutletInjector"]],template:function EditFormPortalComponent_Template(e,t){1&e&&i.DNE(0,EditFormPortalComponent_div_0_Template,5,11,"div",0),2&e&&i.Y8G("ngIf",t.handler)},dependencies:[a.YU,a.OI,a.bT,l.qT,l.cb,l.cV,c.ar],encapsulation:2})}}},35970:(e,t,n)=>{"use strict";n.d(t,{U:()=>createLocalInjector});var i=n(37248),o=n(9168);function createLocalInjector(e,t,n,r){const s=new WeakMap;return s.set(i.hq,t),s.set(i.BO,n),s.set(i.au,r),new o.JP(e,s)}},97501:(e,t,n)=>{"use strict";n.d(t,{G:()=>EditingPortalService});var i=n(9168),o=n(43063),r=n(35970),s=n(64334),a=n(73014),l=n(89204),c=n(24398),p=n(41670),d=n(61816),u=n(72688),h=n(87879),m=n(41804),g=n(49763),_=n(36819),f=n(84205),b=n(1758);class HalResourceEditFieldHandler extends m.L{constructor(e,t,n,i,o,r,s){super(),this.injector=e,this.form=t,this.fieldName=n,this.schema=i,this.element=o,this.pathHelper=r,this.withErrors=s,this.$onUserActivate=new f.B,void 0!==s&&this.setErrors(s),this.htmlId=`wp-${this.resource.id}-inline-edit--field-${this.fieldName}`,this.fieldLabel=this.schema.name||this.fieldName}stopPropagation(e){return e.stopPropagation(),!1}get inEditMode(){return this.form.editMode}get inFlight(){return this.form.change.inFlight}focus(e){const t=this.element.querySelector(".inline-edit--field");t?(t.focus(),e&&"INPUT"===t.tagName&&(0,g.K)(t,e)):(0,_.cY)(`Tried to focus on ${this.fieldName}, but element does not (yet) exist.`)}setErrors(e){this.errors=e,this.element.classList.toggle("-error",this.isErrorenous)}handleUserSubmit(){return this.onBeforeSubmit(),this.inFlight||this.form.editMode?Promise.resolve():this.onSubmit().then((()=>this.form.submit())).then((()=>{this.blurActiveField()}))}handleUserKeydown(e,t=!1){var n=this;return(0,l.A)((function*(){return n.inEditMode&&!t?e.which!==p.c.ENTER||(yield n.form.submit(),!1):e.which!==p.c.ESCAPE||(n.handleUserCancel(),!1)}))()}handleUserCancel(){this.reset()}reset(){this.form.change.reset(this.fieldName),this.inEditMode||this.deactivate(!0)}deactivate(e=!1){this.blurActiveField(),delete this.form.activeFields[this.fieldName],this.onDestroy.next(),this.onDestroy.complete(),this.form.reset(this.fieldName,e)}blurActiveField(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}get isErrorenous(){return this.errors.length>0}isChanged(){return this.form.change.contains(this.fieldName)}get resource(){return this.form.resource}get project(){return this.form.change.projectedResource.project}errorMessageOnLabel(){return this.isErrorenous?this.I18n.t("js.inplace.errors.messages_on_field",{messages:this.errors.join(" ")}):""}previewContext(e){return e.previewPath()}}(0,c.Cg)([(0,b.O)(),(0,c.Sn)("design:type",h.k)],HalResourceEditFieldHandler.prototype,"FocusHelper",void 0),(0,c.Cg)([(0,b.O)(),(0,c.Sn)("design:type",u.s)],HalResourceEditFieldHandler.prototype,"ConfigurationService",void 0),(0,c.Cg)([(0,b.O)(),(0,c.Sn)("design:type",d.W)],HalResourceEditFieldHandler.prototype,"I18n",void 0);var k=n(68559);class EditingPortalService{constructor(e,t,n){this.appRef=e,this.componentFactoryResolver=t,this.pathHelper=n}create(e,t,n,a,l,c){const p=this.createDomOutlet(e,t),d=new HalResourceEditFieldHandler(t,n,l,a,e,this.pathHelper,c);d.onDestroy.pipe((0,s.s)(1)).subscribe((()=>p.detach()));const u=(0,r.U)(t,n.change,d,a),h=new i.A8(o.u,null,u);e.innerHTML="";return p.attachComponentPortal(h).instance.onEditFieldReady.pipe((0,s.s)(1)).toPromise().then((()=>d))}createDomOutlet(e,t){return new i.aI(e,this.componentFactoryResolver,this.appRef,t)}static{this.ɵfac=function EditingPortalService_Factory(e){return new(e||EditingPortalService)(k.KVO(k.o8S),k.KVO(k.OM3),k.KVO(a.B))}}static{this.ɵprov=k.jDH({token:EditingPortalService,factory:EditingPortalService.ɵfac,providedIn:"root"})}}},15121:(e,t,n)=>{"use strict";n.d(t,{C:()=>EditFieldControlsComponent});var i=n(68559),o=(n(37248),n(46765));class EditFieldControlsComponent{constructor(){this.onSave=new i.bkB,this.onCancel=new i.bkB}save(){this.onSave.emit()}cancel(){this.onCancel.emit()}static{this.ɵfac=function EditFieldControlsComponent_Factory(e){return new(e||EditFieldControlsComponent)}}static{this.ɵcmp=i.VBU({type:EditFieldControlsComponent,selectors:[["edit-field-controls"]],inputs:{cancelTitle:"cancelTitle",saveTitle:"saveTitle",field:[i.Mj6.None,"fieldController","field"]},outputs:{onSave:"onSave",onCancel:"onCancel"},decls:6,vars:5,consts:[[1,"inplace-edit--dashboard"],[1,"inplace-edit--controls"],["type","button",1,"inplace-edit--control","inplace-edit--control--save",3,"click","disabled","title"],["icon-classes","icon-checkmark icon-no-color",3,"icon-title"],["type","button",1,"inplace-edit--control","inplace-edit--control--cancel",3,"click","title"],["icon-classes","icon-close icon-no-color",3,"icon-title"]],template:function EditFieldControlsComponent_Template(e,t){1&e&&(i.j41(0,"div",0)(1,"div",1)(2,"button",2),i.bIt("click",(function EditFieldControlsComponent_Template_button_click_2_listener(){return t.save()})),i.nrm(3,"op-icon",3),i.k0s(),i.j41(4,"button",4),i.bIt("click",(function EditFieldControlsComponent_Template_button_click_4_listener(){return t.cancel()})),i.nrm(5,"op-icon",5),i.k0s()()()),2&e&&(i.R7$(2),i.Y8G("disabled",t.field.required&&t.field.isEmpty()||void 0)("title",t.saveTitle),i.R7$(),i.Y8G("icon-title",t.saveTitle),i.R7$(),i.Y8G("title",t.cancelTitle),i.R7$(),i.Y8G("icon-title",t.cancelTitle))},dependencies:[o.i],encapsulation:2})}}},23604:(e,t,n)=>{"use strict";n.d(t,{T:()=>EditFieldControlsModule});var i=n(60316),o=n(15121),r=n(34802),s=n(68559);class EditFieldControlsModule{static{this.ɵfac=function EditFieldControlsModule_Factory(e){return new(e||EditFieldControlsModule)}}static{this.ɵmod=s.$C({type:EditFieldControlsModule})}static{this.ɵinj=s.G2t({imports:[i.MD,r.d]})}}("undefined"==typeof ngJitMode||ngJitMode)&&s.Obh(EditFieldControlsModule,{declarations:[o.C],imports:[i.MD,r.d],exports:[o.C]})},72159:(e,t,n)=>{"use strict";n.d(t,{r:()=>FormattableEditFieldComponent});var i=n(37248),o=n(20832),r=n(97366),s=n(68559),a=n(60316),l=n(15121);function FormattableEditFieldComponent_edit_field_controls_3_Template(e,t){if(1&e){const e=s.RV6();s.j41(0,"edit-field-controls",4),s.bIt("onSave",(function FormattableEditFieldComponent_edit_field_controls_3_Template_edit_field_controls_onSave_0_listener(){s.eBV(e);const t=s.XpG();return s.Njj(t.handleUserSubmit())}))("onCancel",(function FormattableEditFieldComponent_edit_field_controls_3_Template_edit_field_controls_onCancel_0_listener(){s.eBV(e);const t=s.XpG();return s.Njj(t.handleUserCancel())})),s.k0s()}if(2&e){const e=s.XpG();s.Y8G("fieldController",e.field)("saveTitle",e.text.save)("cancelTitle",e.text.cancel)}}class FormattableEditFieldComponent extends i.Ii{constructor(){super(...arguments),this.field=this,this.initializationError=!1,this.isPreview=!1,this.previewHtml="",this.cancelled=!1,this.text={},this.ckEditorContext={resource:this.change.pristineResource,field:this.field.name,macros:"none",previewContext:this.previewContext,options:{rtl:this.schema.options&&this.schema.options.rtl},type:"constrained",...this.resource.getEditorContext(this.field.name)}}ngOnInit(){super.ngOnInit(),this.handler.registerOnSubmit((()=>Promise.resolve(this.getCurrentValue()))),this.text={attachmentLabel:this.I18n.t("js.label_formattable_attachment_hint"),save:this.I18n.t("js.inplace.button_save",{attribute:this.schema.name}),cancel:this.I18n.t("js.inplace.button_cancel",{attribute:this.schema.name})}}ngOnDestroy(){if(super.ngOnDestroy(),!this.cancelled)try{this.rawValue=this.editor?.getRawData()}catch(e){console.error(`Failed to save CKEditor state on destroy: ${e}.`)}}onCkeditorSetup(e){(0,r.A)(this.resource)||setTimeout((()=>e.editing.view.focus()))}getCurrentValue(){this.rawValue=this.editor.getTransformedContent()}onContentChange(e){this.rawValue!==e&&(this.rawValue=e)}handleUserSubmit(){return this.getCurrentValue(),this.handler.handleUserSubmit(),!1}handleUserCancel(){this.cancelled=!0,this.handler.handleUserCancel()}get previewContext(){return this.handler.previewContext(this.resource)}reset(){this.editor&&this.editor.initialized&&(this.editor.content=this.rawValue,this.cdRef.markForCheck())}get rawValue(){return this.value&&this.value.raw?this.value.raw:""}set rawValue(e){this.value={raw:e}}isEmpty(){return!(this.value&&this.value.raw)}initialize(){this.initialContent=this.rawValue,(0,r.A)(this.resource)&&this.editor&&this.reset()}static{this.ɵfac=(()=>{let e;return function FormattableEditFieldComponent_Factory(t){return(e||(e=s.xGo(FormattableEditFieldComponent)))(t||FormattableEditFieldComponent)}})()}static{this.ɵcmp=s.VBU({type:FormattableEditFieldComponent,selectors:[["ng-component"]],viewQuery:function FormattableEditFieldComponent_Query(e,t){if(1&e&&s.GBs(o.Y,7),2&e){let e;s.mGM(e=s.lsd())&&(t.editor=e.first)}},features:[s.Vt3],decls:4,vars:3,consts:[[1,"textarea-wrapper"],[1,"op-ckeditor--wrapper","op-ckeditor-element"],[3,"contentChanged","initializationFailed","initializeDone","saveRequested","context","content"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel",4,"ngIf"],[3,"onSave","onCancel","fieldController","saveTitle","cancelTitle"]],template:function FormattableEditFieldComponent_Template(e,t){1&e&&(s.j41(0,"div",0)(1,"div",1)(2,"op-ckeditor",2),s.bIt("contentChanged",(function FormattableEditFieldComponent_Template_op_ckeditor_contentChanged_2_listener(e){return t.onContentChange(e)}))("initializationFailed",(function FormattableEditFieldComponent_Template_op_ckeditor_initializationFailed_2_listener(){return t.initializationError=!0}))("initializeDone",(function FormattableEditFieldComponent_Template_op_ckeditor_initializeDone_2_listener(e){return t.onCkeditorSetup(e)}))("saveRequested",(function FormattableEditFieldComponent_Template_op_ckeditor_saveRequested_2_listener(){return t.handleUserSubmit()})),s.k0s()(),s.DNE(3,FormattableEditFieldComponent_edit_field_controls_3_Template,1,3,"edit-field-controls",3),s.k0s()),2&e&&(s.R7$(2),s.Y8G("context",t.ckEditorContext)("content",t.initialContent),s.R7$(),s.Y8G("ngIf",!(t.handler.inEditMode||t.initializationError)))},dependencies:[a.bT,o.Y,l.C],encapsulation:2,changeDetection:0})}}},83998:(e,t,n)=>{"use strict";n.d(t,{s:()=>FormattableEditFieldModule});var i=n(60316),o=n(72159),r=n(23084),s=n(23604),a=n(68559);class FormattableEditFieldModule{static{this.ɵfac=function FormattableEditFieldModule_Factory(e){return new(e||FormattableEditFieldModule)}}static{this.ɵmod=a.$C({type:FormattableEditFieldModule})}static{this.ɵinj=a.G2t({imports:[i.MD,r.b,s.T]})}}("undefined"==typeof ngJitMode||ngJitMode)&&a.Obh(FormattableEditFieldModule,{declarations:[o.r],imports:[i.MD,r.b,s.T],exports:[o.r]})},8958:(e,t,n)=>{"use strict";n.d(t,{c:()=>EditableAttributeFieldComponent});var i=n(51339),o=n(67369),r=n(61816),s=n(49763),a=n(34539),l=(n(27514),n(99496)),c=n(44674),p=n(60807),d=n(13432),u=n(36819);var h=n(68559),m=n(60316);const g=["displayContainer"],_=["editContainer"],_c2=(e,t,n,i)=>[e,t,n,i];class EditableAttributeFieldComponent extends l.p{constructor(e,t,n,i,o,r,s,a,l){super(),this.states=e,this.injector=t,this.elementRef=n,this.opContextMenu=i,this.halEditing=o,this.schemaCache=r,this.editForm=s,this.cdRef=a,this.I18n=l,this.displayFieldOptions={},this.isDropTarget=!1,this.editFieldContainerClass=p.K1,this.active=!1,this.destroyed=!1}setActive(e=!0){this.active=e,this.componentDestroyed||this.cdRef.detectChanges()}ngOnInit(){this.fieldRenderer=new p.wJ(this.injector,"single-view",this.displayFieldOptions),this.$element=jQuery(this.elementRef.nativeElement),this.editForm?.register(this),this.halEditing.temporaryEditResource(this.resource).values$().pipe(this.untilDestroyed()).subscribe((e=>{this.resource=e,this.render()}))}startDragActivation(e){this.isDropTarget&&this.isEditable&&!this.active&&(this.handleUserActivate(null),e.preventDefault())}render(){const e=this.fieldRenderer.render(this.resource,this.fieldName,null);this.displayContainer.nativeElement.innerHTML="",this.displayContainer.nativeElement.appendChild(e)}deactivate(e=!1){this.editContainer.nativeElement.innerHTML="",this.editContainer.nativeElement.hidden=!0,this.setActive(!1),e&&setTimeout((()=>this.$element.find(`.${p.IB}`).focus()),20)}get isEditable(){return!(!this.editForm||!this.schema.isAttributeEditable(this.fieldName))}activateIfEditable(e){if(function hasSelectionWithin(e){try{const t=window.getSelection(),n=t.toString().length>0,i=e.contains(t.anchorNode);return n&&i}catch(e){return console.error("Failed to test whether in selection ",e),!1}}(e.target))return(0,u.cY)(`Not activating ${this.fieldName} because of active selection within`),!0;return jQuery(e.target).closest(`a:not(.${p.nK}),macro`,this.displayContainer.nativeElement).length>0||(this.handleUserActivate(e),this.opContextMenu.close(),e.preventDefault(),e.stopImmediatePropagation(),!1)}activateOnForm(e=!1){return this.setActive(!0),this.editForm.activate(this.fieldName,e).catch((()=>this.deactivate(!0)))}handleUserActivate(e){if(!this.isEditable)return!1;let t=0;return"click"===e?.type&&(t=(0,s.E)(e)),this.activateOnForm().then((e=>{e&&(e.$onUserActivate.next(),e.focus(t))})),!1}reset(){this.render(),this.deactivate()}get schema(){if(this.halEditing.typedState(this.resource).hasValue()){return this.halEditing.typedState(this.resource).value.schema}return this.schemaCache.of(this.resource)}static{this.ɵfac=function EditableAttributeFieldComponent_Factory(e){return new(e||EditableAttributeFieldComponent)(h.rXU(d.D),h.rXU(h.zZn),h.rXU(h.aKT),h.rXU(o.V),h.rXU(i.p),h.rXU(c.D),h.rXU(a.G,8),h.rXU(h.gRc),h.rXU(r.W))}}static{this.ɵcmp=h.VBU({type:EditableAttributeFieldComponent,selectors:[["op-editable-attribute-field"]],viewQuery:function EditableAttributeFieldComponent_Query(e,t){if(1&e&&(h.GBs(g,7),h.GBs(_,7)),2&e){let e;h.mGM(e=h.lsd())&&(t.displayContainer=e.first),h.mGM(e=h.lsd())&&(t.editContainer=e.first)}},inputs:{fieldName:"fieldName",resource:"resource",wrapperClasses:"wrapperClasses",displayFieldOptions:"displayFieldOptions",isDropTarget:"isDropTarget"},features:[h.Vt3],decls:5,vars:8,consts:[["editContainer",""],["displayContainer",""],[3,"dragover","ngClass"],[3,"hidden"],["tabindex","-1",3,"click","keydown.enter","hidden"]],template:function EditableAttributeFieldComponent_Template(e,t){if(1&e){const e=h.RV6();h.j41(0,"div",2),h.bIt("dragover",(function EditableAttributeFieldComponent_Template_div_dragover_0_listener(n){return h.eBV(e),h.Njj(t.startDragActivation(n))})),h.nrm(1,"div",3,0),h.j41(3,"div",4,1),h.bIt("click",(function EditableAttributeFieldComponent_Template_div_click_3_listener(n){return h.eBV(e),h.Njj(t.activateIfEditable(n))}))("keydown.enter",(function EditableAttributeFieldComponent_Template_div_keydown_enter_3_listener(n){return h.eBV(e),h.Njj(t.activateIfEditable(n))})),h.k0s()()}2&e&&(h.Y8G("ngClass",h.ziG(3,_c2,t.editFieldContainerClass,t.fieldName,t.active?"-active":"",t.wrapperClasses||"-small")),h.R7$(),h.Y8G("hidden",!t.active),h.R7$(2),h.Y8G("hidden",t.active))},dependencies:[m.YU],encapsulation:2,changeDetection:0})}}},51339:(e,t,n)=>{"use strict";n.d(t,{p:()=>HalResourceEditingService});var i=n(89204),o=n(47418),r=n(51567),s=n(70271),a=n(84205),l=n(38429),c=n(65046),p=n(91691),d=n(42410),u=n(97366),h=n(68559);class ChangesetStates extends o.Iq{constructor(){super(),this.name="Changesets",this.changesets=(0,o.Iy)(),this.initializeMembers()}}class ResourceChangesetCommit{constructor(e,t){this.wasNew=!1,this.id=t.id.toString(),this.wasNew=(0,u.A)(e.pristineResource),this.resource=t,this.changes=e.changeMap}}class HalResourceEditingService extends d.l{constructor(e,t,n){super((new ChangesetStates).changesets),this.injector=e,this.halEvents=t,this.hook=n,this.committedChanges=new a.B}save(e){var t=this;return(0,i.A)((function*(){const n=yield e.buildRequestPayload(),i=yield e.pristineResource.$links.updateImmediately(n);return i.retainFrom(e.pristineResource),yield t.onSaved(i),t.complete(e,i)}))()}complete(e,t){const n=new ResourceChangesetCommit(e,t);this.committedChanges.next(n),this.reset(e);const i=n.wasNew?"created":"updated";return this.halEvents.push(n.resource,{eventType:i,commit:n}),n}reset(e){e.clear(),this.clearSome(e.href)}typedState(e){return this.multiState.get(e.href)}edit(e,t){const n=this.multiState.get(e.href),i=this.newChangeset(e,n,t);return n.putValue(i),i}newChangeset(e,t,n){return new(this.hook.call("halResourceChangesetClass",e).pop()||l.b)(e,t,n)}changeFor(e){const t=this.multiState.get(e.href);let n=e;e.state&&(n=e.state.getValueOr(e));const i=t.value;return i&&!i.isEmpty()?i:i?n.hasOwnProperty("lockVersion")&&i.pristineResource.lockVersion<n.lockVersion?this.edit(n):(i.updatePristineResource(n),i):this.edit(n)}temporaryEditResource(e){const t=(0,o.kg)(e.state,this.typedState(e));return(0,o.OC)(t,(e=>e.pipe((0,r.p)((([e,t])=>!!e)),(0,s.T)((([e,t])=>t?(t.updatePristineResource(e),t.projectedResource):e)))))}stopEditing(e){this.multiState.get(e.href).clear()}onSaved(e){return e.state?e.push(e):Promise.resolve()}static{this.ɵfac=function HalResourceEditingService_Factory(e){return new(e||HalResourceEditingService)(h.KVO(h.zZn),h.KVO(p.o),h.KVO(c.R))}}static{this.ɵprov=h.jDH({token:HalResourceEditingService,factory:HalResourceEditingService.ɵfac})}}},2406:(e,t,n)=>{"use strict";n.d(t,{D:()=>Field});var i=n(99496);class Field extends i.p{get displayName(){return this.schema.name||this.name}get value(){return this.resource[this.name]}get type(){return this.constructor.type}get required(){return!!this.schema.required}get writable(){return this.schema.writable&&!1!==this.context.options.writable}get hasDefault(){return this.schema.hasDefault}get options(){return this.schema.options}isEmpty(){return void 0===this.value||null===this.value||""===this.value}get unknownAttribute(){return this.isEmpty()&&!this.schema}}},55328:(e,t,n)=>{"use strict";n.d(t,{M:()=>AbstractFieldService});class AbstractFieldService{constructor(){this.fields={},this.classes={}}fieldType(e){return this.fields[e]}getClassFor(e,t="unknown"){const n=this.fieldType(e)||this.fieldType(t)||this.defaultFieldType;return this.classes[n]}getSpecificClassFor(e,t,n="unknown"){const i=this.fieldType(`${e}-${t}`)||this.fieldType(`${e}-${n}`);return i?this.classes[i]:this.getClassFor(t,n)}addFieldType(e,t,n){return e.fieldType=t,this.register(e,n),this}addSpecificFieldType(e,t,n,i){return t.fieldType=`${e}-${n}`,i=i.map((t=>`${e}-${t}`)),this.register(t,i),this}extendFieldType(e,t){const n=this.classes[e]||this.getClassFor(e);return this.addFieldType(n,e,t)}register(e,t=[]){const n=e.fieldType;t.forEach((e=>this.fields[e]=n)),this.classes[n]=e}}},73018:(e,t,n)=>{"use strict";function projectStatusCodeCssClass(e){return`-${(e=ensureDefaultCode(e)).replace("_","-")}`}function projectStatusI18n(e,t){return e=ensureDefaultCode(e),t.t(`js.grid.widgets.project_status.${e.replace("-","_")}`)}function ensureDefaultCode(e){return e||"not-set"}n.d(t,{O:()=>projectStatusI18n,U:()=>projectStatusCodeCssClass})},84878:(e,t,n)=>{"use strict";n.d(t,{I:()=>AttributeLabelMacroComponent});var i=n(89204),o=n(44674),r=n(51339),s=n(39356),a=n(61816),l=n(69874);var c=n(56196),p=n(68559),d=n(60316),u=n(11385);function AttributeLabelMacroComponent_ng_container_0_Template(e,t){if(1&e&&(p.qex(0),p.nrm(1,"span",1)(2,"attribute-help-text",2),p.bVm()),2&e){const e=p.XpG();p.R7$(),p.Y8G("textContent",e.label),p.R7$(),p.Y8G("attribute",e.attribute)("attributeScope",e.attributeScope)}}function AttributeLabelMacroComponent_span_1_Template(e,t){if(1&e&&(p.j41(0,"span"),p.nrm(1,"i",3)(2,"em",1),p.k0s()),2&e){const e=p.XpG();p.R7$(2),p.Y8G("textContent",e.error)}}class AttributeLabelMacroComponent{constructor(e,t,n,i,o,r,s){this.elementRef=e,this.injector=t,this.resourceLoader=n,this.schemaCache=i,this.displayField=o,this.I18n=r,this.cdRef=s,this.error=null,this.text={help:this.I18n.t("js.editor.macro.attribute_reference.macro_help_tooltip"),not_found:this.I18n.t("js.editor.macro.attribute_reference.not_found"),invalid_attribute:e=>this.I18n.t("js.editor.macro.attribute_reference.invalid_attribute",{name:e})},this.hostTitle=this.text.help,this.resource=null}ngOnInit(){const e=this.elementRef.nativeElement,t=e.dataset.model,n=e.dataset.id,i=e.dataset.attribute;this.attributeScope=function capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}(t),this.loadResourceAttribute(t,n,i)}loadResourceAttribute(e,t,n){var o=this;return(0,i.A)((function*(){try{o.resource=yield(0,c._)(o.resourceLoader.require(e,t))}catch(e){return console.error("Failed to render macro %O",e),void o.markError(o.text.not_found)}if(!o.resource)return void o.markError(o.text.not_found);const i=yield o.schemaCache.ensureLoaded(o.resource);o.attribute=i.attributeFromLocalizedName(n)||n,o.label=i[o.attribute]?.name,o.label||o.markError(o.text.invalid_attribute(n)),o.cdRef.detectChanges()}))()}markError(e){this.error=this.I18n.t("js.editor.macro.error",{message:e}),this.cdRef.detectChanges()}static{this.ɵfac=function AttributeLabelMacroComponent_Factory(e){return new(e||AttributeLabelMacroComponent)(p.rXU(p.aKT),p.rXU(p.zZn),p.rXU(l.G),p.rXU(o.D),p.rXU(s.w),p.rXU(a.W),p.rXU(p.gRc))}}static{this.ɵcmp=p.VBU({type:AttributeLabelMacroComponent,selectors:[["ng-component"]],hostVars:1,hostBindings:function AttributeLabelMacroComponent_HostBindings(e,t){2&e&&p.Mr5("title",t.hostTitle)},features:[p.Jv_([r.p])],decls:2,vars:2,consts:[[4,"ngIf"],[3,"textContent"],[3,"attribute","attributeScope"],[1,"icon","icon-error"]],template:function AttributeLabelMacroComponent_Template(e,t){1&e&&p.DNE(0,AttributeLabelMacroComponent_ng_container_0_Template,3,3,"ng-container",0)(1,AttributeLabelMacroComponent_span_1_Template,3,1,"span",0),2&e&&(p.Y8G("ngIf",t.resource),p.R7$(),p.Y8G("ngIf",t.error))},dependencies:[d.bT,u.e],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}@media screen{[_nghost-%COMP%]{display:inline;background:#dadfe130;border:1px solid transparent;padding:2px}[_nghost-%COMP%]:hover{cursor:default;border-color:var(--fgColor-muted);background:#dadfe1bf}}"],changeDetection:0})}}},69874:(e,t,n)=>{"use strict";n.d(t,{G:()=>AttributeModelLoaderService});var i=n(14593),o=n(56196),r=n(79439),s=n(77919),a=n(51567),l=n(86301),c=n(64334),p=n(98764),d=n(70271),u=n(61816),h=n(47418),m=n(83093),g=n(86866),_=n(68559);class AttributeModelLoaderService{constructor(e,t,n,i){this.apiV3Service=e,this.transitions=t,this.currentProject=n,this.I18n=i,this.text={not_found:this.I18n.t("js.editor.macro.attribute_reference.not_found")},this.cache$=(0,h.Iy)(),t.onStart({},(()=>(this.cache$.clear(),!0)))}require(e,t){const n=`${e}-${t}`,i=this.cache$.get(n);if(i.isPristine()){const n=this.load(e,t).pipe((0,a.p)((e=>!!e)),(0,l.t)(1));return i.clearAndPutFromPromise((0,o._)(n)),n}return i.values$().pipe((0,c.s)(1),(0,p.M)((e=>console.log(`VAL ${e}`)),(e=>console.error(`ERR ${e}`))))}load(e,t){switch(e){case"workPackage":return this.loadWorkPackage(t);case"project":return this.loadProject(t);default:return r.t}}loadProject(e){return(e=e||this.currentProject.id)?this.apiV3Service.projects.id(e).get().pipe((0,c.s)(1)):(0,s.$)(this.text.not_found)}loadWorkPackage(e){return e?/^[1-9]\d*$/.test(e)?this.apiV3Service.work_packages.id(e).get().pipe((0,c.s)(1)):this.apiV3Service.withOptionalProject(this.currentProject.id).work_packages.filterByTypeaheadOrId(e,!1,{pageSize:"1"}).get().pipe((0,c.s)(1),(0,d.T)((e=>e.elements[0]||null))):(0,s.$)(this.text.not_found)}static{this.ɵfac=function AttributeModelLoaderService_Factory(e){return new(e||AttributeModelLoaderService)(_.KVO(i.n),_.KVO(m.HN),_.KVO(g.c),_.KVO(u.W))}}static{this.ɵprov=_.jDH({token:AttributeModelLoaderService,factory:AttributeModelLoaderService.ɵfac,providedIn:"root"})}}},43487:(e,t,n)=>{"use strict";n.d(t,{T:()=>AttributeValueMacroComponent});var i=n(89204),o=n(44674),r=n(51339),s=n(39356),a=n(61816),l=n(69874),c=n(56196),p=n(68559),d=n(60316),u=n(4930);const h=["displayContainer"],_c1=()=>({writable:!1});function AttributeValueMacroComponent_span_0_Template(e,t){if(1&e&&(p.j41(0,"span"),p.nrm(1,"i",2)(2,"em",3),p.k0s()),2&e){const e=p.XpG();p.R7$(2),p.Y8G("textContent",e.error)}}function AttributeValueMacroComponent_display_field_1_Template(e,t){if(1&e&&p.nrm(0,"display-field",4),2&e){const e=p.XpG();p.Y8G("resource",e.resource)("displayFieldOptions",p.lJ4(3,_c1))("fieldName",e.fieldName)}}const m="op-attribute-value-macro";class AttributeValueMacroComponent{constructor(e,t,n,i,o,r,s){this.elementRef=e,this.injector=t,this.resourceLoader=n,this.schemaCache=i,this.displayField=o,this.I18n=r,this.cdRef=s,this.error=null,this.text={help:this.I18n.t("js.editor.macro.attribute_reference.macro_help_tooltip"),placeholder:this.I18n.t("js.placeholders.default"),not_found:this.I18n.t("js.editor.macro.attribute_reference.not_found"),invalid_attribute:e=>this.I18n.t("js.editor.macro.attribute_reference.invalid_attribute",{name:e})},this.hostTitle=this.text.help}ngOnInit(){const e=this.elementRef.nativeElement,t=e.dataset.model,n=e.dataset.id,i=e.dataset.attribute;if(e.classList.add(m),this.isNestedMacro(t,n,i)){const e=this.I18n.t("js.editor.macro.attribute_reference.nested_macro",{model:t,id:n});this.markError(e)}else this.loadAndRender(t,n,i)}isNestedMacro(e,t,n){const i=this.elementRef.nativeElement.parentElement;return!!i?.closest(`.${m}[data-model="${e}"][data-id="${t}"][data-attribute="${n}"]`)}loadAndRender(e,t,n){var o=this;return(0,i.A)((function*(){let i;try{i=yield(0,c._)(o.resourceLoader.require(e,t))}catch(e){return console.error(`Failed to render macro ${e}`),void o.markError(o.text.not_found)}if(!i)return void o.markError(o.text.not_found);const r=yield o.schemaCache.ensureLoaded(i),s=o.schemaCache.proxied(i,r),a=r.attributeFromLocalizedName(n)||o.dateAttribute(i,s,n);s.ofProperty(a)?(o.resource=i,o.fieldName=a):o.markError(o.text.invalid_attribute(n)),o.cdRef.detectChanges()}))()}markError(e){this.error=this.I18n.t("js.editor.macro.error",{message:e}),this.cdRef.detectChanges()}dateAttribute(e,t,n){return"WorkPackage"!==e._type||t.isMilestone||"date"!==n?t.mappedName(n):"combinedDate"}static{this.ɵfac=function AttributeValueMacroComponent_Factory(e){return new(e||AttributeValueMacroComponent)(p.rXU(p.aKT),p.rXU(p.zZn),p.rXU(l.G),p.rXU(o.D),p.rXU(s.w),p.rXU(a.W),p.rXU(p.gRc))}}static{this.ɵcmp=p.VBU({type:AttributeValueMacroComponent,selectors:[["ng-component"]],viewQuery:function AttributeValueMacroComponent_Query(e,t){if(1&e&&p.GBs(h,5),2&e){let e;p.mGM(e=p.lsd())&&(t.displayContainer=e.first)}},hostVars:1,hostBindings:function AttributeValueMacroComponent_HostBindings(e,t){2&e&&p.Mr5("title",t.hostTitle)},features:[p.Jv_([r.p])],decls:2,vars:2,consts:[[4,"ngIf"],["containerType","single-view",3,"resource","displayFieldOptions","fieldName",4,"ngIf"],[1,"icon","icon-error"],[3,"textContent"],["containerType","single-view",3,"resource","displayFieldOptions","fieldName"]],template:function AttributeValueMacroComponent_Template(e,t){1&e&&p.DNE(0,AttributeValueMacroComponent_span_0_Template,3,1,"span",0)(1,AttributeValueMacroComponent_display_field_1_Template,1,4,"display-field",1),2&e&&(p.Y8G("ngIf",t.error),p.R7$(),p.Y8G("ngIf",!!t.resource))},dependencies:[d.bT,u.W],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}@media screen{[_nghost-%COMP%]{display:inline;background:#dadfe130;border:1px solid transparent;padding:2px}[_nghost-%COMP%]:hover{cursor:default;border-color:var(--fgColor-muted);background:#dadfe1bf}}"],changeDetection:0})}}},58945:(e,t,n)=>{"use strict";n.d(t,{Q:()=>WorkPackageQuickinfoMacroComponent});var i=n(14593),o=n(98764),r=n(44674),s=n(51339),a=n(39356),l=n(61816),c=n(94896),p=n(73014),d=n(68559),u=n(60316),h=n(4930);const _c0=()=>({writable:!1});function WorkPackageQuickinfoMacroComponent_ng_container_0_display_field_1_Template(e,t){if(1&e&&d.nrm(0,"display-field",5),2&e){const e=d.XpG().ngIf;d.Y8G("resource",e)("displayFieldOptions",d.lJ4(2,_c0))}}function WorkPackageQuickinfoMacroComponent_ng_container_0_ng_container_6_display_field_2_Template(e,t){if(1&e&&d.nrm(0,"display-field",9),2&e){const e=d.XpG(2).ngIf;d.Y8G("resource",e)("displayFieldOptions",d.lJ4(2,_c0))}}function WorkPackageQuickinfoMacroComponent_ng_container_0_ng_container_6_display_field_3_Template(e,t){if(1&e&&d.nrm(0,"display-field",10),2&e){const e=d.XpG(2).ngIf,t=d.XpG();d.Y8G("resource",e)("displayFieldOptions",d.lJ4(3,_c0))("displayClass",t.combinedDateDisplayField)}}function WorkPackageQuickinfoMacroComponent_ng_container_0_ng_container_6_display_field_4_Template(e,t){if(1&e&&d.nrm(0,"display-field",11),2&e){const e=d.XpG(2).ngIf,t=d.XpG();d.Y8G("resource",e)("displayFieldOptions",d.lJ4(3,_c0))("displayClass",t.combinedDateDisplayField)}}function WorkPackageQuickinfoMacroComponent_ng_container_0_ng_container_6_Template(e,t){if(1&e&&(d.qex(0),d.EFF(1," ("),d.DNE(2,WorkPackageQuickinfoMacroComponent_ng_container_0_ng_container_6_display_field_2_Template,1,3,"display-field",6)(3,WorkPackageQuickinfoMacroComponent_ng_container_0_ng_container_6_display_field_3_Template,1,4,"display-field",7)(4,WorkPackageQuickinfoMacroComponent_ng_container_0_ng_container_6_display_field_4_Template,1,4,"display-field",8),d.EFF(5,") "),d.bVm()),2&e){const e=d.XpG().ngIf;d.R7$(2),d.Y8G("ngIf",!!e.date),d.R7$(),d.Y8G("ngIf",!!e.startDate),d.R7$(),d.Y8G("ngIf",!e.startDate&&!!e.dueDate)}}function WorkPackageQuickinfoMacroComponent_ng_container_0_Template(e,t){if(1&e&&(d.qex(0),d.DNE(1,WorkPackageQuickinfoMacroComponent_ng_container_0_display_field_1_Template,1,3,"display-field",1),d.nrm(2,"display-field",2),d.j41(3,"a",3),d.EFF(4),d.k0s(),d.nrm(5,"display-field",4),d.DNE(6,WorkPackageQuickinfoMacroComponent_ng_container_0_ng_container_6_Template,6,3,"ng-container",0),d.bVm()),2&e){const e=t.ngIf,n=d.XpG();d.R7$(),d.Y8G("ngIf",n.detailed),d.R7$(),d.Y8G("resource",e)("displayFieldOptions",d.lJ4(10,_c0)),d.R7$(),d.Y8G("href",n.workPackageLink,d.B4B),d.BMQ("data-work-package-id",e.id)("data-hover-card-url",n.workPackageHoverCardUrl),d.R7$(),d.SpI(" #",e.id,": "),d.R7$(),d.Y8G("resource",e)("displayFieldOptions",d.lJ4(11,_c0)),d.R7$(),d.Y8G("ngIf",n.detailed&&(!!e.startDate||!!e.dueDate||!!e.date))}}function WorkPackageQuickinfoMacroComponent_span_2_Template(e,t){if(1&e&&(d.j41(0,"span"),d.nrm(1,"i",12)(2,"em",13),d.k0s()),2&e){const e=d.XpG();d.R7$(2),d.Y8G("textContent",e.error)}}class WorkPackageQuickinfoMacroComponent{constructor(e,t,n,i,o,r,s,a){this.elementRef=e,this.injector=t,this.apiV3Service=n,this.schemaCache=i,this.displayField=o,this.pathHelper=r,this.I18n=s,this.cdRef=a,this.error=null,this.text={not_found:this.I18n.t("js.editor.macro.attribute_reference.not_found"),help:this.I18n.t("js.editor.macro.attribute_reference.macro_help_tooltip")},this.hostTitle=this.text.help,this.combinedDateDisplayField=c.A,this.detailed=!1}ngOnInit(){const e=this.elementRef.nativeElement,t=e.dataset.id;this.detailed="true"===e.dataset.detailed,this.workPackageLink=this.pathHelper.workPackagePath(t),this.workPackageHoverCardUrl=this.pathHelper.workPackageHoverCardPath(t),this.workPackage$=this.apiV3Service.work_packages.id(t).get().pipe((0,o.M)({error:e=>this.markError(this.text.not_found)}))}markError(e){console.error(`Failed to render macro ${e}`),this.error=this.I18n.t("js.editor.macro.error",{message:e}),this.cdRef.detectChanges()}static{this.ɵfac=function WorkPackageQuickinfoMacroComponent_Factory(e){return new(e||WorkPackageQuickinfoMacroComponent)(d.rXU(d.aKT),d.rXU(d.zZn),d.rXU(i.n),d.rXU(r.D),d.rXU(a.w),d.rXU(p.B),d.rXU(l.W),d.rXU(d.gRc))}}static{this.ɵcmp=d.VBU({type:WorkPackageQuickinfoMacroComponent,selectors:[["ng-component"]],hostVars:1,hostBindings:function WorkPackageQuickinfoMacroComponent_HostBindings(e,t){2&e&&d.Mr5("title",t.hostTitle)},features:[d.Jv_([s.p])],decls:3,vars:4,consts:[[4,"ngIf"],["containerType","single-view","fieldName","status",3,"resource","displayFieldOptions",4,"ngIf"],["fieldName","type",3,"resource","displayFieldOptions"],["target","_top",1,"op-hover-card--preview-trigger",3,"href"],["fieldName","subject",3,"resource","displayFieldOptions"],["containerType","single-view","fieldName","status",3,"resource","displayFieldOptions"],["fieldName","date","containerType","single-view",3,"resource","displayFieldOptions",4,"ngIf"],["fieldName","startDate","containerType","single-view",3,"resource","displayFieldOptions","displayClass",4,"ngIf"],["fieldName","dueDate","containerType","single-view",3,"resource","displayFieldOptions","displayClass",4,"ngIf"],["fieldName","date","containerType","single-view",3,"resource","displayFieldOptions"],["fieldName","startDate","containerType","single-view",3,"resource","displayFieldOptions","displayClass"],["fieldName","dueDate","containerType","single-view",3,"resource","displayFieldOptions","displayClass"],[1,"icon","icon-error"],[3,"textContent"]],template:function WorkPackageQuickinfoMacroComponent_Template(e,t){1&e&&(d.DNE(0,WorkPackageQuickinfoMacroComponent_ng_container_0_Template,7,12,"ng-container",0),d.nI1(1,"async"),d.DNE(2,WorkPackageQuickinfoMacroComponent_span_2_Template,3,1,"span",0)),2&e&&(d.Y8G("ngIf",d.bMT(1,2,t.workPackage$)),d.R7$(2),d.Y8G("ngIf",t.error))},dependencies:[u.bT,h.W,u.Jj],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}@media screen{[_nghost-%COMP%]{display:inline;background:#dadfe130;border:1px solid transparent;padding:2px}[_nghost-%COMP%]:hover{cursor:default;border-color:var(--fgColor-muted);background:#dadfe1bf}}display-field[_ngcontent-%COMP%]{padding-right:2px}display-field[fieldName=status][_ngcontent-%COMP%]{padding-right:6px}"],changeDetection:0})}}},74785:(e,t,n)=>{"use strict";n.d(t,{X:()=>OpenprojectFieldsModule});var i=n(68559),o=n(60316),r=n(21452),s=n(23084),a=n(6540),l=n(34802),c=n(12918),p=n(72811),d=n(27256),u=n(39356),h=n(37248),m=n(34456),g=n(2768);class TextEditFieldComponent extends h.Ii{constructor(){super(...arguments),this.shouldFocus="subject"===this.name}static{this.ɵfac=(()=>{let e;return function TextEditFieldComponent_Factory(t){return(e||(e=i.xGo(TextEditFieldComponent)))(t||TextEditFieldComponent)}})()}static{this.ɵcmp=i.VBU({type:TextEditFieldComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:1,vars:6,consts:[["type","text",1,"inline-edit--field","op-input",3,"ngModelChange","keydown","opAutofocus","disabled","ngModel","id"]],template:function TextEditFieldComponent_Template(e,t){1&e&&(i.j41(0,"input",0),i.mxI("ngModelChange",(function TextEditFieldComponent_Template_input_ngModelChange_0_listener(e){return i.DH7(t.value,e)||(t.value=e),e})),i.bIt("keydown",(function TextEditFieldComponent_Template_input_keydown_0_listener(e){return t.handler.handleUserKeydown(e)})),i.k0s()),2&e&&(i.Y8G("opAutofocus",t.shouldFocus)("disabled",t.inFlight),i.R50("ngModel",t.value),i.Y8G("id",t.handler.htmlId),i.BMQ("aria-required",t.required)("required",t.required))},dependencies:[m.me,m.BC,m.vS,g.B],encapsulation:2})}}class IntegerEditFieldComponent extends h.Ii{constructor(){super(...arguments),this.locale=I18n.locale}static{this.ɵfac=(()=>{let e;return function IntegerEditFieldComponent_Factory(t){return(e||(e=i.xGo(IntegerEditFieldComponent)))(t||IntegerEditFieldComponent)}})()}static{this.ɵcmp=i.VBU({type:IntegerEditFieldComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:1,vars:6,consts:[["type","number",1,"inline-edit--field","op-input",3,"ngModelChange","keydown","disabled","ngModel","id"]],template:function IntegerEditFieldComponent_Template(e,t){1&e&&(i.j41(0,"input",0),i.mxI("ngModelChange",(function IntegerEditFieldComponent_Template_input_ngModelChange_0_listener(e){return i.DH7(t.value,e)||(t.value=e),e})),i.bIt("keydown",(function IntegerEditFieldComponent_Template_input_keydown_0_listener(e){return t.handler.handleUserKeydown(e)})),i.k0s()),2&e&&(i.Y8G("disabled",t.inFlight),i.R50("ngModel",t.value),i.Y8G("id",t.handler.htmlId),i.BMQ("aria-required",t.required)("required",t.required)("lang",t.locale))},dependencies:[m.me,m.Q0,m.BC,m.vS],encapsulation:2})}}var f=n(89204),b=n(24398),k=n(83093),v=n(14600),C=n(70271),y=n(98764),w=n(1758);class SelectAutocompleterRegisterService{constructor(){this._fields=[]}register(e,t){this._fields.push({attribute:t,component:e})}getAutocompleterOfAttribute(e){const t=_.find(this._fields,(t=>t.attribute===e));return t?t.component:void 0}static{this.ɵfac=function SelectAutocompleterRegisterService_Factory(e){return new(e||SelectAutocompleterRegisterService)}}static{this.ɵprov=i.jDH({token:SelectAutocompleterRegisterService,factory:SelectAutocompleterRegisterService.ɵfac,providedIn:"root"})}}var T=n(89120),S=n(34539),j=n(40358),P=n(72355),I=n(25827);const _c0=(e,t,n,i,o,r,s,a)=>({availableValues:e,appendTo:t,model:n,required:i,disabled:o,id:r,finishedLoading:!0,classes:s,resource:a});class SelectEditFieldComponent extends h.Ii{constructor(){super(...arguments),this.appendTo=null,this.referenceOutputs={onCreate:e=>this.onCreate(e),onChange:e=>this.onChange(e),onAddNew:e=>this.onNewValueAdded(e),onKeydown:e=>this.handler.handleUserKeydown(e,!0),onOpen:()=>this.onOpen(),onClose:()=>this.onClose(),onAfterViewInit:e=>this._autocompleterComponent=e},this.valuesLoaded=!1,this.hiddenOverflowContainer=".__hidden_overflow_container"}get selectedOption(){const e=this.value?this.value.href:null;return _.find(this.availableOptions,(t=>t.href===e))}set selectedOption(e){const t=_.find(this.availableOptions,(t=>t.href===e.href));t&&""===t.href&&(t.href=null),this.value=t||e}ngOnInit(){super.ngOnInit(),this.appendTo=this.overflowingSelector,this.handler.$onUserActivate.pipe(this.untilDestroyed()).subscribe((()=>{this.valuesLoadingPromise.then((()=>{this._autocompleterComponent.openDirectly=!0}))})),this._syncUrlParamsOnChangeIfNeeded(this.handler.fieldName,this.editFormComponent?.editMode)}initialize(){this.text={requiredPlaceholder:this.I18n.t("js.placeholders.selection"),placeholder:this.I18n.t("js.placeholders.default")},this.valuesLoadingPromise=this.change.getForm().then((()=>this.initialValueLoading())).catch((()=>console.error("Failed to load default form")))}initialValueLoading(){return this.valuesLoaded=!1,this.loadValues().toPromise()}autocompleterComponent(){const{type:e}=this.schema;return this.selectAutocompleterRegister.getAutocompleterOfAttribute(e)||T.I}setValues(e){const t=this.sortValues(e);this.availableOptions=this.filterInvalidValues(t),this.addEmptyOption()}loadValues(e){const{allowedValues:t}=this.schema;if(Array.isArray(t))this.setValues(t),this.valuesLoaded=!0;else{if(t&&!this.valuesLoaded)return this.loadValuesFromBackend(e);this.setValues([])}return(0,v.H)(Promise.resolve(this.availableOptions))}loadValuesFromBackend(e){return(0,v.H)(this.loadAllowedValues(e)).pipe((0,C.T)((t=>void 0===t.count||void 0===t.total||!e&&t.total===t.count||!this.value?t.elements:t.elements.concat([this.value]))),(0,y.M)((e=>this.setValues(e))),(0,C.T)((()=>this.availableOptions)))}loadAllowedValues(e){if(!e){const e=this.schema.allowedValues.$link.href;return this.change.cacheValue(e,this.fetchAllowedValueQuery.bind(this))}return this.fetchAllowedValueQuery(e)}fetchAllowedValueQuery(e){const t=this.schema.allowedValues?.$link;return t?t.$fetch(this.allowedValuesFilter(e)):new Promise((()=>{}))}addValue(e){this.availableOptions.push(e)}get currentValueInvalid(){return!!(this.value&&!_.some(this.availableOptions,(e=>e.href===this.value.href))||!this.value&&this.schema.required)}onCreate(e){this.addValue(e),this.selectedOption={name:e.name,href:e.href},this.handler.handleUserSubmit()}onOpen(){jQuery(this.hiddenOverflowContainer).one("scroll",(()=>{this._autocompleterComponent.closeSelect()}))}onClose(){}onChange(e){if(e)return this.selectedOption=e,void this.handler.handleUserSubmit();const t=this.getEmptyOption();t&&(this.selectedOption=t,this.handler.handleUserSubmit())}onNewValueAdded(e){var t=this;return(0,f.A)((function*(){e&&(yield t.change.getForm(!0),t.onChange(e))}))()}addEmptyOption(){if(this.isRequired())return;void 0===this.getEmptyOption()&&this.availableOptions.unshift({name:this.text.placeholder,href:""})}isRequired(){return this.schema.required}sortValues(e){return this.halSorting.sort(e)}filterInvalidValues(e){return e.filter((e=>!!e.name))}allowedValuesFilter(e){return{}}getEmptyOption(){return _.find(this.availableOptions,(e=>e.name===this.text.placeholder))}_syncUrlParamsOnChangeIfNeeded(e,t){"type"===e&&t&&this.handler.registerOnBeforeSubmit((()=>{const e=this.uiRouterGlobals.params.type,t=this.value?.$source?.id;e&&t&&this.$state.go(".",{type:t},{notify:!1})}))}static{this.ɵfac=(()=>{let e;return function SelectEditFieldComponent_Factory(t){return(e||(e=i.xGo(SelectEditFieldComponent)))(t||SelectEditFieldComponent)}})()}static{this.ɵcmp=i.VBU({type:SelectEditFieldComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:1,vars:12,consts:[[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"]],template:function SelectEditFieldComponent_Template(e,t){1&e&&i.nrm(0,"ndc-dynamic",0),2&e&&i.Y8G("ndcDynamicComponent",t.autocompleterComponent())("ndcDynamicInputs",i.lV(3,_c0,t.availableOptions,t.appendTo,t.selectedOption?t.selectedOption:"",t.required,t.inFlight,t.handler.htmlId,"inline-edit--field "+t.handler.fieldName,t.resource))("ndcDynamicOutputs",t.referenceOutputs)},dependencies:[I.Bf,I.dE],encapsulation:2,changeDetection:0})}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",SelectAutocompleterRegisterService)],SelectEditFieldComponent.prototype,"selectAutocompleterRegister",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",j.Y)],SelectEditFieldComponent.prototype,"halNotification",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",P.X)],SelectEditFieldComponent.prototype,"halSorting",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",k.dw)],SelectEditFieldComponent.prototype,"$state",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",k.ok)],SelectEditFieldComponent.prototype,"uiRouterGlobals",void 0),(0,b.Cg)([(0,w.O)(S.G,null,i.$GK.Optional),(0,b.Sn)("design:type",S.G)],SelectEditFieldComponent.prototype,"editFormComponent",void 0);var x=n(61816),R=n(62223),F=n(15121);const multi_select_edit_field_component_c0=e=>({"padding-left.px":e});function MultiSelectEditFieldComponent_ng_template_1_Template(e,t){if(1&e&&i.nrm(0,"span",4),2&e){const e=t.item;i.Y8G("textContent",e.name)("ngStyle",i.eq3(2,multi_select_edit_field_component_c0,16*e.depth))}}function MultiSelectEditFieldComponent_2_ng_template_0_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-invite-user-button",6),i.bIt("invited",(function MultiSelectEditFieldComponent_2_ng_template_0_Template_op_invite_user_button_invited_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.selectedOption=t)})),i.k0s()}if(2&e){const e=i.XpG(2);i.Y8G("projectId",null==e.resource.project?null:e.resource.project.id)}}function MultiSelectEditFieldComponent_2_Template(e,t){1&e&&i.DNE(0,MultiSelectEditFieldComponent_2_ng_template_0_Template,1,1,"ng-template",5)}function MultiSelectEditFieldComponent_edit_field_controls_3_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"edit-field-controls",7),i.bIt("onSave",(function MultiSelectEditFieldComponent_edit_field_controls_3_Template_edit_field_controls_onSave_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.handler.handleUserSubmit())}))("onCancel",(function MultiSelectEditFieldComponent_edit_field_controls_3_Template_edit_field_controls_onCancel_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.handler.handleUserCancel())})),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("fieldController",e.self)("saveTitle",e.text.save)("cancelTitle",e.text.cancel)}}class MultiSelectEditFieldComponent extends h.Ii{constructor(){super(...arguments),this.availableOptions=[],this.text={requiredPlaceholder:this.I18n.t("js.placeholders.selection"),placeholder:this.I18n.t("js.placeholders.default"),save:this.I18n.t("js.inplace.button_save",{attribute:this.schema.name}),cancel:this.I18n.t("js.inplace.button_cancel",{attribute:this.schema.name})},this.appendTo=null,this.currentValueInvalid=!1,this.hiddenOverflowContainer=".__hidden_overflow_container",this.requestFocus=!1}ngOnInit(){this.nullOption={name:this.text.placeholder,href:null},this.showAddNewUserButton="User"===this.schema.type,this.handler.$onUserActivate.pipe(this.untilDestroyed()).subscribe((()=>{this.requestFocus=0===this.availableOptions.length,this.requestFocus||this.openAutocompleteSelectField()})),super.ngOnInit(),this.appendTo=this.overflowingSelector}get value(){const e=this.resource[this.name];return e?e[0]:e}buildSelectedOption(){const e=this.resource[this.name];return e?_.castArray(e).map((e=>this.findValueOption(e))):[]}get selectedOption(){return this._selectedOption}set selectedOption(e){this._selectedOption=e;const mapper=e=>{const t=_.find(this.availableOptions,(t=>t.href===e.href))||this.nullOption;return t&&""===t.href&&(t.href=null),t};this.resource[this.name]=_.castArray(e).map((e=>mapper(e)))}onOpen(){jQuery(this.hiddenOverflowContainer).one("scroll",(()=>{this.ngSelectComponent.close()}))}onClose(){}repositionDropdown(){this.ngSelectComponent&&this.ngSelectComponent.dropdownPanel&&setTimeout((()=>this.ngSelectComponent.dropdownPanel.adjustPosition()),0)}openAutocompleteSelectField(){const e=this;window.setTimeout((()=>{e.ngSelectComponent.open()}),0)}findValueOption(e){let t;return e&&(t=_.find(this.availableOptions,(t=>t.href===e.href))),t||this.nullOption}setValues(e,t=!1){t&&e.sort(((e,t)=>{const n=e.name.toLowerCase(),i=t.name.toLowerCase();return n<i?-1:n>i?1:0})),this.availableOptions=this.filterInvalidValues(e||[]),this._selectedOption=this.buildSelectedOption(),this.checkCurrentValueValidity(),this.availableOptions.length>0&&this.requestFocus&&(this.openAutocompleteSelectField(),this.requestFocus=!1)}initialize(){super.initialize(),this.loadValues()}loadValues(){const{allowedValues:e}=this.schema;if(Array.isArray(e))this.setValues(e);else{if(this.schema.allowedValues)return this.schema.allowedValues.$load().then((e=>{e.count>0&&"Project"===e.elements[0]._type?this.setValues(e.elements,!0):this.setValues(e.elements)}));this.setValues([])}return Promise.resolve()}filterInvalidValues(e){return e.filter((e=>!!e.name))}checkCurrentValueValidity(){this.value?this.currentValueInvalid=!_.some(this.value,(e=>_.some(this.availableOptions,(t=>t.href===e.href)))):this.currentValueInvalid=!!this.schema.required}static{this.ɵfac=(()=>{let e;return function MultiSelectEditFieldComponent_Factory(t){return(e||(e=i.xGo(MultiSelectEditFieldComponent)))(t||MultiSelectEditFieldComponent)}})()}static{this.ɵcmp=i.VBU({type:MultiSelectEditFieldComponent,selectors:[["ng-component"]],viewQuery:function MultiSelectEditFieldComponent_Query(e,t){if(1&e&&i.GBs(R.vr,7),2&e){let e;i.mGM(e=i.lsd())&&(t.ngSelectComponent=e.first)}},features:[i.Vt3],decls:4,vars:16,consts:[["bindLabel","name",3,"ngModelChange","keydown","open","close","add","remove","ngModel","ngClass","required","clearable","disabled","id","items","virtualScroll","clearSearchOnAdd","multiple","closeOnSelect","appendTo","dropdownPosition","hideSelected"],["ng-option-tmp",""],[4,"ngIf"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel",4,"ngIf"],[1,"ng-option-label","ellipsis",3,"textContent","ngStyle"],["ng-footer-tmp",""],[3,"invited","projectId"],[3,"onSave","onCancel","fieldController","saveTitle","cancelTitle"]],template:function MultiSelectEditFieldComponent_Template(e,t){1&e&&(i.j41(0,"ng-select",0),i.mxI("ngModelChange",(function MultiSelectEditFieldComponent_Template_ng_select_ngModelChange_0_listener(e){return i.DH7(t.selectedOption,e)||(t.selectedOption=e),e})),i.bIt("keydown",(function MultiSelectEditFieldComponent_Template_ng_select_keydown_0_listener(e){return t.handler.handleUserKeydown(e,!0)}))("open",(function MultiSelectEditFieldComponent_Template_ng_select_open_0_listener(){return t.onOpen()}))("close",(function MultiSelectEditFieldComponent_Template_ng_select_close_0_listener(){return t.onClose()}))("add",(function MultiSelectEditFieldComponent_Template_ng_select_add_0_listener(){return t.repositionDropdown()}))("remove",(function MultiSelectEditFieldComponent_Template_ng_select_remove_0_listener(){return t.repositionDropdown()})),i.DNE(1,MultiSelectEditFieldComponent_ng_template_1_Template,1,4,"ng-template",1)(2,MultiSelectEditFieldComponent_2_Template,1,0,null,2),i.k0s(),i.DNE(3,MultiSelectEditFieldComponent_edit_field_controls_3_Template,1,3,"edit-field-controls",3)),2&e&&(i.R50("ngModel",t.selectedOption),i.Y8G("ngClass","inline-edit--field -multi-select")("required",t.required)("clearable",!t.required)("disabled",t.inFlight)("id",t.handler.htmlId)("items",t.availableOptions)("virtualScroll",!0)("clearSearchOnAdd",!0)("multiple",!0)("closeOnSelect",!1)("appendTo",t.appendTo)("dropdownPosition","top")("hideSelected",!0),i.R7$(2),i.Y8G("ngIf",t.showAddNewUserButton),i.R7$(),i.Y8G("ngIf",!t.handler.inEditMode))},dependencies:[o.YU,o.bT,o.B3,m.BC,m.YS,m.vS,R.vr,R.Uq,R.q8,F.C],encapsulation:2})}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",x.W)],MultiSelectEditFieldComponent.prototype,"I18n",void 0);class FloatEditFieldComponent extends h.Ii{constructor(){super(...arguments),this.locale=I18n.locale}static{this.ɵfac=(()=>{let e;return function FloatEditFieldComponent_Factory(t){return(e||(e=i.xGo(FloatEditFieldComponent)))(t||FloatEditFieldComponent)}})()}static{this.ɵcmp=i.VBU({type:FloatEditFieldComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:1,vars:6,consts:[["type","number","step","any",1,"inline-edit--field","op-input",3,"ngModelChange","keydown","disabled","ngModel","id"]],template:function FloatEditFieldComponent_Template(e,t){1&e&&(i.j41(0,"input",0),i.mxI("ngModelChange",(function FloatEditFieldComponent_Template_input_ngModelChange_0_listener(e){return i.DH7(t.value,e)||(t.value=e),e})),i.bIt("keydown",(function FloatEditFieldComponent_Template_input_keydown_0_listener(e){return t.handler.handleUserKeydown(e)})),i.k0s()),2&e&&(i.Y8G("disabled",t.inFlight),i.R50("ngModel",t.value),i.Y8G("id",t.handler.htmlId),i.BMQ("aria-required",t.required)("required",t.required)("lang",t.locale))},dependencies:[m.me,m.Q0,m.BC,m.vS],encapsulation:2})}}class BooleanEditFieldComponent extends h.Ii{updateValue(e){this.value=e,this.handler.handleUserSubmit()}static{this.ɵfac=(()=>{let e;return function BooleanEditFieldComponent_Factory(t){return(e||(e=i.xGo(BooleanEditFieldComponent)))(t||BooleanEditFieldComponent)}})()}static{this.ɵcmp=i.VBU({type:BooleanEditFieldComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:1,vars:4,consts:[["type","checkbox",1,"inline-edit--field","inline-edit--boolean-field",3,"change","keydown","checked","disabled","id"]],template:function BooleanEditFieldComponent_Template(e,t){1&e&&(i.j41(0,"input",0),i.bIt("change",(function BooleanEditFieldComponent_Template_input_change_0_listener(){return t.updateValue(!t.value)}))("keydown",(function BooleanEditFieldComponent_Template_input_keydown_0_listener(e){return t.handler.handleUserKeydown(e)})),i.k0s()),2&e&&(i.Y8G("checked",t.value)("disabled",t.inFlight)("id",t.handler.htmlId),i.BMQ("aria-required",t.required))},encapsulation:2})}}var M=n(84205),O=n(23513),D=n(59452),G=n(51567),E=n(91817),A=n(52575),V=n(36647),$=n(61318),B=n(86301),W=n(33900);class DebouncedRequestSwitchmap{constructor(e,t,n=!1,i=250){this.requestHandler=e,this.errorHandler=t,this.preFilterNull=n,this.debounceMs=i,this.input$=new M.B,this.loading$=new M.B,this.lastResult=[],this.output$=(0,O.x)((0,D.of)([]),this.input$.pipe((0,G.p)((e=>!n||null!=e)),(0,E.F)(),(0,A.B)(i),(0,y.M)((e=>{this.lastRequestedValue=e,this.lastResult=[],this.loading$.next(!0)})),(0,V.n)((e=>this.requestHandler(e).pipe((0,$.W)((e=>(this.errorHandler(e),(0,D.of)([])))),(0,y.M)((e=>{this.loading$.next(!1),this.lastResult=e}))))),(0,B.t)(1)))}request(e){this.input$.next(e)}get hasResults(){return this.lastResult.length>0}observe(e){return this.output$.pipe((0,W.Q)(e))}}var N=n(64334),U=n(89282);const work_package_edit_field_component_c0=(e,t,n,i,o,r,s,a,l)=>({availableValues:e,appendTo:t,model:n,required:i,disabled:o,id:r,finishedLoading:s,classes:a,typeahead:l,hideSelected:!0});class WorkPackageEditFieldComponent extends SelectEditFieldComponent{constructor(){super(...arguments),this.requests=new DebouncedRequestSwitchmap((e=>this.loadValues(e)),function errorNotificationHandler(e){return t=>e.handleRawError(t)}(this.halNotification))}initialValueLoading(){return this.valuesLoaded=!1,new Promise((e=>{this.requests.output$.pipe((0,N.s)(1)).subscribe((t=>{e(t)})),this.requests.input$.next("")}))}get typeahead(){return this.requests.input$}fetchAllowedValueQuery(e){return"parent"===this.name?this.schema.allowedValues.$link.$fetch({query:e}):super.fetchAllowedValueQuery(e)}allowedValuesFilter(e){let t=super.allowedValuesFilter(e);if(e){const n=new U.hG;n.add("subjectOrId","**",[e]),t={filters:n.toJson()}}return t}static{this.ɵfac=(()=>{let e;return function WorkPackageEditFieldComponent_Factory(t){return(e||(e=i.xGo(WorkPackageEditFieldComponent)))(t||WorkPackageEditFieldComponent)}})()}static{this.ɵcmp=i.VBU({type:WorkPackageEditFieldComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:2,vars:15,consts:[[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"]],template:function WorkPackageEditFieldComponent_Template(e,t){1&e&&(i.nrm(0,"ndc-dynamic",0),i.nI1(1,"async")),2&e&&i.Y8G("ndcDynamicComponent",t.autocompleterComponent())("ndcDynamicInputs",i.zJS(5,work_package_edit_field_component_c0,[i.bMT(1,3,t.requests.output$),t.appendTo,t.selectedOption?t.selectedOption:"",t.required,t.inFlight,t.handler.htmlId,t.requests.loading$,"inline-edit--field "+t.handler.fieldName,t.typeahead]))("ndcDynamicOutputs",t.referenceOutputs)},dependencies:[I.Bf,I.dE,o.Jj],encapsulation:2})}}var Y=n(39545),X=n(32420),q=n(58192);class DateEditFieldComponent extends h.Ii{constructor(){super(...arguments),this.autofocus=!1}ngOnInit(){super.ngOnInit(),this.autofocus=!this.handler.inEditMode}get value(){return this.formatter(this.resource[this.name])||""}set value(e){this.resource[this.name]=this.parseValue(e)}parseValue(e){return Y(e,"YYYY-MM-DD",!0).isValid()?e:null}onCancel(){this.handler.handleUserCancel(),this.onModalClosed()}formatter(e){if(Y(e,"YYYY-MM-DD",!0).isValid()){const t=this.timezoneService.parseDate(e);return this.timezoneService.formattedISODate(t)}return null}onModalClosed(){this.handler.inEditMode||this.handler.deactivate(!1)}static{this.ɵfac=(()=>{let e;return function DateEditFieldComponent_Factory(t){return(e||(e=i.xGo(DateEditFieldComponent)))(t||DateEditFieldComponent)}})()}static{this.ɵcmp=i.VBU({type:DateEditFieldComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:1,vars:5,consts:[[1,"inline-edit--field",3,"ngModelChange","keydown.escape","keydown.enter","picked","ngModel","id","required","disabled","opAutofocus"]],template:function DateEditFieldComponent_Template(e,t){1&e&&(i.j41(0,"op-basic-single-date-picker",0),i.mxI("ngModelChange",(function DateEditFieldComponent_Template_op_basic_single_date_picker_ngModelChange_0_listener(e){return i.DH7(t.value,e)||(t.value=e),e})),i.bIt("keydown.escape",(function DateEditFieldComponent_Template_op_basic_single_date_picker_keydown_escape_0_listener(){return t.onCancel()}))("keydown.enter",(function DateEditFieldComponent_Template_op_basic_single_date_picker_keydown_enter_0_listener(){return t.handler.handleUserSubmit()}))("picked",(function DateEditFieldComponent_Template_op_basic_single_date_picker_picked_0_listener(){return t.handler.handleUserSubmit()})),i.k0s()),2&e&&(i.R50("ngModel",t.value),i.Y8G("id",t.handler.htmlId)("required",t.required)("disabled",t.inFlight)("opAutofocus",t.autofocus))},dependencies:[m.BC,m.YS,m.vS,q.r,g.B],encapsulation:2,changeDetection:0})}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",X.D)],DateEditFieldComponent.prototype,"timezoneService",void 0);var L=n(72159),H=n(73018),z=n(11439);function ProjectStatusEditFieldComponent_ng_template_1_Template(e,t){if(1&e&&(i.nrm(0,"span",3),i.j41(1,"span",4),i.EFF(2),i.k0s()),2&e){const e=t.item;i.Y8G("ngClass",e.colorClass),i.R7$(),i.Y8G("ngClass",e.colorClass),i.R7$(),i.JRh(e.name)}}function ProjectStatusEditFieldComponent_ng_template_2_Template(e,t){if(1&e&&(i.nrm(0,"span",3),i.j41(1,"span",4),i.EFF(2),i.k0s()),2&e){const e=t.item;i.Y8G("ngClass",e.colorClass),i.R7$(),i.Y8G("ngClass",e.colorClass),i.R7$(),i.JRh(e.name)}}class ProjectStatusEditFieldComponent extends h.Ii{constructor(){super(...arguments),this.availableStatuses=[{href:"not_set",name:(0,H.O)("not_set",this.I18n),colorClass:(0,H.U)("not_set")}],this.hiddenOverflowContainer="#content-wrapper",this.appendToContainer="body"}ngOnInit(){this.currentStatusCode=null===this.resource.status?this.availableStatuses[0].href:this.resource.status.href,this.change.getForm().then((e=>{e.schema.status.allowedValues.forEach((e=>{this.availableStatuses=[...this.availableStatuses,{href:e.href,name:e.name,colorClass:(0,H.U)(e.id)}]}));const t=this;window.setTimeout((()=>{t.ngSelectComponent.open()}),0)}))}onChange(){this.resource.status=this.currentStatusCode===this.availableStatuses[0].href?null:{href:this.currentStatusCode},this.handler.handleUserSubmit()}onOpen(){(0,z.Z)(this.ngSelectComponent),jQuery(this.hiddenOverflowContainer).one("scroll.autocompleteContainer",(()=>{this.ngSelectComponent.close()}))}onClose(){jQuery(this.hiddenOverflowContainer).off("scroll.autocompleteContainer")}static{this.ɵfac=(()=>{let e;return function ProjectStatusEditFieldComponent_Factory(t){return(e||(e=i.xGo(ProjectStatusEditFieldComponent)))(t||ProjectStatusEditFieldComponent)}})()}static{this.ɵcmp=i.VBU({type:ProjectStatusEditFieldComponent,selectors:[["ng-component"]],viewQuery:function ProjectStatusEditFieldComponent_Query(e,t){if(1&e&&i.GBs(R.vr,7),2&e){let e;i.mGM(e=i.lsd())&&(t.ngSelectComponent=e.first)}},features:[i.Vt3],decls:3,vars:5,consts:[["bindLabel","name","bindValue","href",1,"project-status",3,"ngModelChange","open","close","change","items","ngModel","appendTo","hideSelected","disabled"],["ng-label-tmp",""],["ng-option-tmp",""],[1,"project-status--bulb",3,"ngClass"],[1,"project-status--name",3,"ngClass"]],template:function ProjectStatusEditFieldComponent_Template(e,t){1&e&&(i.j41(0,"ng-select",0),i.mxI("ngModelChange",(function ProjectStatusEditFieldComponent_Template_ng_select_ngModelChange_0_listener(e){return i.DH7(t.currentStatusCode,e)||(t.currentStatusCode=e),e})),i.bIt("open",(function ProjectStatusEditFieldComponent_Template_ng_select_open_0_listener(){return t.onOpen()}))("close",(function ProjectStatusEditFieldComponent_Template_ng_select_close_0_listener(){return t.onClose()}))("change",(function ProjectStatusEditFieldComponent_Template_ng_select_change_0_listener(){return t.onChange()})),i.DNE(1,ProjectStatusEditFieldComponent_ng_template_1_Template,3,3,"ng-template",1)(2,ProjectStatusEditFieldComponent_ng_template_2_Template,3,3,"ng-template",2),i.k0s()),2&e&&(i.Y8G("items",t.availableStatuses),i.R50("ngModel",t.currentStatusCode),i.Y8G("appendTo",t.appendToContainer)("hideSelected",!0)("disabled",t.inFlight))},dependencies:[o.YU,m.BC,m.vS,R.vr,R.Uq,R.ZZ]})}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",x.W)],ProjectStatusEditFieldComponent.prototype,"I18n",void 0);class PlainFormattableEditFieldComponent extends h.Ii{constructor(){super(...arguments),this.shouldFocus=!1}get value(){if(!this.schema)return"";const e=this.resource[this.name];return e&&e.raw||""}set value(e){this.resource[this.name]={raw:e}}static{this.ɵfac=(()=>{let e;return function PlainFormattableEditFieldComponent_Factory(t){return(e||(e=i.xGo(PlainFormattableEditFieldComponent)))(t||PlainFormattableEditFieldComponent)}})()}static{this.ɵcmp=i.VBU({type:PlainFormattableEditFieldComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:1,vars:6,consts:[["type","text",1,"inline-edit--field","op-input",3,"ngModelChange","keydown","opAutofocus","disabled","ngModel","id"]],template:function PlainFormattableEditFieldComponent_Template(e,t){1&e&&(i.j41(0,"input",0),i.mxI("ngModelChange",(function PlainFormattableEditFieldComponent_Template_input_ngModelChange_0_listener(e){return i.DH7(t.value,e)||(t.value=e),e})),i.bIt("keydown",(function PlainFormattableEditFieldComponent_Template_input_keydown_0_listener(e){return t.handler.handleUserKeydown(e)})),i.k0s()),2&e&&(i.Y8G("opAutofocus",t.shouldFocus)("disabled",t.inFlight),i.R50("ngModel",t.value),i.Y8G("id",t.handler.htmlId),i.BMQ("aria-required",t.required)("required",t.required))},dependencies:[m.me,m.BC,m.vS,g.B],encapsulation:2})}}var Q=n(12313),K=n(14593),J=n(81944),Z=n(56196);const te_work_package_edit_field_component_c0=(e,t,n,i,o,r,s,a,l)=>({availableValues:e,appendTo:t,model:n,required:i,disabled:o,id:r,finishedLoading:s,classes:a,typeahead:l,hideSelected:!0});class TimeEntryWorkPackageEditFieldComponent extends WorkPackageEditFieldComponent{initialize(){super.initialize(),this.referenceOutputs&&(this.referenceOutputs.modeSwitch=e=>{this.valuesLoaded=!1;const t=this.requests.lastRequestedValue;this.requests.input$.next('_/&"()____'),this.requests.input$.next(t)})}autocompleterComponent(){return J._}isRequired(){return!0}loadAllowedValues(e){return this.recentWorkPackageIds?this.fetchAllowedValueQuery(e):(0,Z._)(this.apiV3Service.time_entries.list({filters:[["user_id","=",["me"]]],sortBy:[["updated_at","desc"]],pageSize:30})).then((t=>(this.recentWorkPackageIds=t.elements.filter((e=>e.workPackage?.href)).map((e=>(0,Q.A)(e.workPackage.href))).filter(((e,t,n)=>n.indexOf(e)===t)),this.fetchAllowedValueQuery(e))))}allowedValuesFilter(e){const t=new U.hG;return"recent"===this._autocompleterComponent.mode&&this.recentWorkPackageIds.length>0&&t.add("id","=",this.recentWorkPackageIds),e&&t.add("subjectOrId","**",[e]),{filters:t.toJson()}}sortValues(e){return"recent"===this._autocompleterComponent.mode?this.sortValuesByRecentIds(e):super.sortValues(e)}sortValuesByRecentIds(e){return e.sort(((e,t)=>this.recentWorkPackageIds.indexOf(e.id)-this.recentWorkPackageIds.indexOf(t.id)))}static{this.ɵfac=(()=>{let e;return function TimeEntryWorkPackageEditFieldComponent_Factory(t){return(e||(e=i.xGo(TimeEntryWorkPackageEditFieldComponent)))(t||TimeEntryWorkPackageEditFieldComponent)}})()}static{this.ɵcmp=i.VBU({type:TimeEntryWorkPackageEditFieldComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:2,vars:15,consts:[[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"]],template:function TimeEntryWorkPackageEditFieldComponent_Template(e,t){1&e&&(i.nrm(0,"ndc-dynamic",0),i.nI1(1,"async")),2&e&&i.Y8G("ndcDynamicComponent",t.autocompleterComponent())("ndcDynamicInputs",i.zJS(5,te_work_package_edit_field_component_c0,[i.bMT(1,3,t.requests.output$),t.appendTo,t.selectedOption?t.selectedOption:"",t.required,t.inFlight,t.handler.htmlId,t.requests.loading$,"inline-edit--field "+t.handler.fieldName,t.typeahead]))("ndcDynamicOutputs",t.referenceOutputs)},dependencies:[I.Bf,I.dE,o.Jj],encapsulation:2})}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",K.n)],TimeEntryWorkPackageEditFieldComponent.prototype,"apiV3Service",void 0);var ee=n(36652);class DatePickerEditFieldComponent extends h.Ii{ngOnInit(){super.ngOnInit(),this.handler.$onUserActivate.pipe(this.untilDestroyed()).subscribe((()=>{this.showDatePickerModal()}))}ngOnDestroy(){super.ngOnDestroy()}showDatePickerModal(){}static{this.ɵfac=(()=>{let e;return function DatePickerEditFieldComponent_Factory(t){return(e||(e=i.xGo(DatePickerEditFieldComponent)))(t||DatePickerEditFieldComponent)}})()}static{this.ɵdir=i.FsC({type:DatePickerEditFieldComponent,features:[i.Vt3]})}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",X.D)],DatePickerEditFieldComponent.prototype,"timezoneService",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",ee.g)],DatePickerEditFieldComponent.prototype,"deviceService",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",i.zZn)],DatePickerEditFieldComponent.prototype,"injector",void 0);var te=n(93338),ne=n(8620),ie=n(24972);function CombinedDateEditFieldComponent_op_wp_single_date_form_3_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-wp-single-date-form",5),i.bIt("save",(function CombinedDateEditFieldComponent_op_wp_single_date_form_3_Template_op_wp_single_date_form_save_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.save())}))("cancel",(function CombinedDateEditFieldComponent_op_wp_single_date_form_3_Template_op_wp_single_date_form_cancel_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.cancel())})),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("value",e.dates)("changeset",e.change)}}function CombinedDateEditFieldComponent_op_wp_multi_date_form_4_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-wp-multi-date-form",6),i.bIt("save",(function CombinedDateEditFieldComponent_op_wp_multi_date_form_4_Template_op_wp_multi_date_form_save_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.save())}))("cancel",(function CombinedDateEditFieldComponent_op_wp_multi_date_form_4_Template_op_wp_multi_date_form_cancel_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.cancel())})),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("value",e.dates)("changeset",e.change)("fieldName",e.name)}}class CombinedDateEditFieldComponent extends DatePickerEditFieldComponent{constructor(){super(...arguments),this.dates="",this.opened=!1,this.text={placeholder:{startDate:this.I18n.t("js.label_no_start_date"),dueDate:this.I18n.t("js.label_no_due_date"),date:this.I18n.t("js.label_no_date")}}}get isMultiDate(){return!this.change.schema.isMilestone}onInputClick(e){e.stopPropagation()}showDatePickerModal(){this.opened=!0}onModalClosed(){this.opened=!1,this.handler.inEditMode||this.handler.deactivate(!1),this.resetDates()}save(){this.handler.handleUserSubmit(),this.onModalClosed()}cancel(){this.handler.reset(),this.onModalClosed()}initialize(){super.initialize(),this.resetDates()}resetDates(){switch(this.name){case"combinedDate":this.dates=`${this.current("startDate")} - ${this.current("dueDate")}`;break;case"startDate":this.dates=`${this.current("startDate")}`;break;case"dueDate":this.dates=`${this.current("dueDate")}`;break;case"date":this.dates=`${this.current("date")}`}}current(e){return this.resource&&this.resource[e]||this.text.placeholder[e]}static{this.ɵfac=(()=>{let e;return function CombinedDateEditFieldComponent_Factory(t){return(e||(e=i.xGo(CombinedDateEditFieldComponent)))(t||CombinedDateEditFieldComponent)}})()}static{this.ɵcmp=i.VBU({type:CombinedDateEditFieldComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:5,vars:4,consts:[["alignment","bottom-center",3,"closed","opened"],["slot","trigger","type","text",1,"spot-input",3,"click","focus","value"],["slot","body"],[3,"value","changeset","save","cancel",4,"ngIf"],[3,"value","changeset","fieldName","save","cancel",4,"ngIf"],[3,"save","cancel","value","changeset"],[3,"save","cancel","value","changeset","fieldName"]],template:function CombinedDateEditFieldComponent_Template(e,t){1&e&&(i.j41(0,"spot-drop-modal",0),i.bIt("closed",(function CombinedDateEditFieldComponent_Template_spot_drop_modal_closed_0_listener(){return t.onModalClosed()})),i.j41(1,"input",1),i.bIt("click",(function CombinedDateEditFieldComponent_Template_input_click_1_listener(e){return t.onInputClick(e)}))("focus",(function CombinedDateEditFieldComponent_Template_input_focus_1_listener(){return t.showDatePickerModal()})),i.k0s(),i.qex(2,2),i.DNE(3,CombinedDateEditFieldComponent_op_wp_single_date_form_3_Template,1,2,"op-wp-single-date-form",3)(4,CombinedDateEditFieldComponent_op_wp_multi_date_form_4_Template,1,3,"op-wp-multi-date-form",4),i.bVm(),i.k0s()),2&e&&(i.Y8G("opened",t.opened),i.R7$(),i.Y8G("value",t.dates),i.R7$(2),i.Y8G("ngIf",t.opened&&!t.isMultiDate),i.R7$(),i.Y8G("ngIf",t.opened&&t.isMultiDate))},dependencies:[o.bT,te.m,ne.D,ie.k],encapsulation:2})}}var oe=n(97564),re=n(16455),se=n(96825),ae=(n(38429),n(41804),n(36178)),le=n(97366),ce=n(30501),pe=n(51196),de=n(53689);function ProjectEditFieldComponent_op_project_autocompleter_0_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-project-autocompleter",2),i.bIt("change",(function ProjectEditFieldComponent_op_project_autocompleter_0_Template_op_project_autocompleter_change_0_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.onModelChange(t))}))("cancel",(function ProjectEditFieldComponent_op_project_autocompleter_0_Template_op_project_autocompleter_cancel_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.handler.handleUserCancel())})),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("ngClass","inline-edit--field "+e.handler.fieldName)("model",e.value)("url",e.url)("filters",e.APIFilters)("focusDirectly",!(e.handler.inEditMode||e.isNew))("openDirectly",!e.isNew)("isInlineContext",!0)}}function ProjectEditFieldComponent_ng_template_1_Template(e,t){1&e&&(i.j41(0,"op-content-loader",3),i.qSk(),i.nrm(1,"rect",4),i.k0s())}class ProjectEditFieldComponent extends h.Ii{constructor(e,t,n,i,o,r,s,a,l,c){super(e,t,n,i,o,r,s),this.I18n=e,this.elementRef=t,this.change=n,this.schema=i,this.handler=o,this.cdRef=r,this.injector=s,this.apiV3Service=a,this.http=l,this.halResourceService=c,this.isNew=(0,le.A)(this.resource)}initialize(){this.schema.allowedValues?this.setUrl():this.loadFormAndSetUrl()}onModelChange(e){if(e){const t={...e},n=this.halResourceService.createHalResourceOfType("project",t);this.value=n}else this.value=null;return this.handler.handleUserSubmit()}get APIFilters(){const e=[{name:"active",operator:"=",values:["t"]}];if((0,le.A)(this.resource)&&this.change.value("type")){const t=(0,Q.A)(this.change.value("type").href);e.push({name:"type_id",operator:"=",values:[t]})}return e}loadFormAndSetUrl(){(0,v.H)(this.change.getForm()).pipe((0,y.M)((()=>this.setUrl())),(0,N.s)(1)).subscribe()}setUrl(){this.url=this.schema.allowedValues.$link.href}static{this.ɵfac=function ProjectEditFieldComponent_Factory(e){return new(e||ProjectEditFieldComponent)(i.rXU(x.W),i.rXU(i.aKT),i.rXU(h.hq),i.rXU(h.au),i.rXU(h.BO),i.rXU(i.gRc),i.rXU(i.zZn),i.rXU(K.n),i.rXU(ce.Qq),i.rXU(ae.t))}}static{this.ɵcmp=i.VBU({type:ProjectEditFieldComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:3,vars:2,consts:[["loadingTemplate",""],["appendTo",".op-wide-autocomplete-wrapper",3,"ngClass","model","url","filters","focusDirectly","openDirectly","isInlineContext","change","cancel",4,"ngIf","ngIfElse"],["appendTo",".op-wide-autocomplete-wrapper",3,"change","cancel","ngClass","model","url","filters","focusDirectly","openDirectly","isInlineContext"],["viewBox","0 0 100 24",1,"project-edit-field--loading-indicator"],["x","0","y","0","width","100%","height","100%","rx","1"]],template:function ProjectEditFieldComponent_Template(e,t){if(1&e&&i.DNE(0,ProjectEditFieldComponent_op_project_autocompleter_0_Template,1,7,"op-project-autocompleter",1)(1,ProjectEditFieldComponent_ng_template_1_Template,2,0,"ng-template",null,0,i.C5r),2&e){const e=i.sdS(2);i.Y8G("ngIf",t.url)("ngIfElse",e)}},dependencies:[o.YU,o.bT,pe.j,de.F],styles:[".project-edit-field--loading-indicator svg{display:block}\n"],encapsulation:2,changeDetection:0})}}class HoursDurationEditFieldComponent extends h.Ii{parser(e,t){return this.inputValue=t.value,t.validity.valid||(e=null===e||""===t.value?null:this.value),Y.duration(e,"hours")}formatter(e){return null===e?null:Number(Y.duration(e).asHours().toFixed(2))}parseValue(e){if(null===e||""===this.inputValue)return null;let t;return t=e.isValid()?e.toISOString():null,t}static{this.ɵfac=(()=>{let e;return function HoursDurationEditFieldComponent_Factory(t){return(e||(e=i.xGo(HoursDurationEditFieldComponent)))(t||HoursDurationEditFieldComponent)}})()}static{this.ɵcmp=i.VBU({type:HoursDurationEditFieldComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:2,vars:5,consts:[["input",""],["type","number","step","any",1,"inline-edit--field","op-input",3,"ngModelChange","keydown","ngModel","disabled","id"]],template:function HoursDurationEditFieldComponent_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"input",1,0),i.bIt("ngModelChange",(function HoursDurationEditFieldComponent_Template_input_ngModelChange_0_listener(n){i.eBV(e);const o=i.sdS(1);return i.Njj(t.value=t.parser(n,o))}))("keydown",(function HoursDurationEditFieldComponent_Template_input_keydown_0_listener(n){return i.eBV(e),i.Njj(t.handler.handleUserKeydown(n))})),i.k0s()}2&e&&(i.Y8G("ngModel",t.formatter(t.value))("disabled",t.inFlight)("id",t.handler.htmlId),i.BMQ("aria-required",t.required)("required",t.required))},dependencies:[m.me,m.Q0,m.BC,m.vS],encapsulation:2,changeDetection:0})}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",X.D)],HoursDurationEditFieldComponent.prototype,"TimezoneService",void 0);var ue=n(77938);function UserEditFieldComponent_op_user_autocompleter_0_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"op-user-autocompleter",1),i.bIt("change",(function UserEditFieldComponent_op_user_autocompleter_0_Template_op_user_autocompleter_change_0_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.onModelChange(t))}))("cancel",(function UserEditFieldComponent_op_user_autocompleter_0_Template_op_user_autocompleter_cancel_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.handler.handleUserCancel())}))("userInvited",(function UserEditFieldComponent_op_user_autocompleter_0_Template_op_user_autocompleter_userInvited_0_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.onModelChange(t))})),i.k0s()}if(2&e){const e=i.XpG();i.ZvI("inline-edit--field ",e.handler.fieldName,""),i.Y8G("url",e.url)("inviteUserToProject",null==e.resource.project?null:e.resource.project.id)("focusDirectly",!(e.handler.inEditMode||e.isNew))("openDirectly",!(e.handler.inEditMode||e.isNew))("model",e.value)("id",e.handler.htmlId)}}class UserEditFieldComponent extends h.Ii{constructor(e,t,n,i,o,r,s,a,l,c){super(e,t,n,i,o,r,s),this.I18n=e,this.elementRef=t,this.change=n,this.schema=i,this.handler=o,this.cdRef=r,this.injector=s,this.apiV3Service=a,this.http=l,this.halResourceService=c,this.isNew=(0,le.A)(this.resource)}initialize(){const e=this.schema.allowedValues;e&&(this.url=e.$link.href)}onModelChange(e){if(e){const t={...e};this.value=this.halResourceService.createHalResourceOfType("user",t)}else this.value=null;return this.handler.handleUserSubmit()}static{this.ɵfac=function UserEditFieldComponent_Factory(e){return new(e||UserEditFieldComponent)(i.rXU(x.W),i.rXU(i.aKT),i.rXU(h.hq),i.rXU(h.au),i.rXU(h.BO),i.rXU(i.gRc),i.rXU(i.zZn),i.rXU(K.n),i.rXU(ce.Qq),i.rXU(ae.t))}}static{this.ɵcmp=i.VBU({type:UserEditFieldComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:1,vars:1,consts:[["appendTo","body",3,"class","url","inviteUserToProject","focusDirectly","openDirectly","model","id","change","cancel","userInvited",4,"ngIf"],["appendTo","body",3,"change","cancel","userInvited","url","inviteUserToProject","focusDirectly","openDirectly","model","id"]],template:function UserEditFieldComponent_Template(e,t){1&e&&i.DNE(0,UserEditFieldComponent_op_user_autocompleter_0_Template,1,9,"op-user-autocompleter",0),2&e&&i.Y8G("ngIf",t.url)},dependencies:[o.bT,ue.P],encapsulation:2,changeDetection:0})}}var he=n(6923);class DaysDurationEditFieldComponent extends DatePickerEditFieldComponent{constructor(){super(...arguments),this.opened=!1}get formattedValue(){return Number(he.duration(this.value).asDays().toFixed(0))}ngOnInit(){super.ngOnInit()}onInputClick(e){e.stopPropagation()}showDatePickerModal(){this.opened=!0}save(){this.handler.handleUserSubmit(),this.opened=!1}cancel(){this.handler.reset(),this.opened=!1}static{this.ɵfac=(()=>{let e;return function DaysDurationEditFieldComponent_Factory(t){return(e||(e=i.xGo(DaysDurationEditFieldComponent)))(t||DaysDurationEditFieldComponent)}})()}static{this.ɵcmp=i.VBU({type:DaysDurationEditFieldComponent,selectors:[["ng-component"]],features:[i.Vt3],decls:3,vars:5,consts:[["alignment","bottom-center",3,"closed","opened"],["type","number","slot","trigger","disabled","disabled",1,"inline-edit--field","op-input",3,"click","focus","ngModel","id"],["slot","body",3,"save","cancel","changeset","fieldName"]],template:function DaysDurationEditFieldComponent_Template(e,t){1&e&&(i.j41(0,"spot-drop-modal",0),i.bIt("closed",(function DaysDurationEditFieldComponent_Template_spot_drop_modal_closed_0_listener(){return t.cancel()})),i.j41(1,"input",1),i.bIt("click",(function DaysDurationEditFieldComponent_Template_input_click_1_listener(e){return t.onInputClick(e)}))("focus",(function DaysDurationEditFieldComponent_Template_input_focus_1_listener(){return t.opened=!0})),i.k0s(),i.j41(2,"op-wp-multi-date-form",2),i.bIt("save",(function DaysDurationEditFieldComponent_Template_op_wp_multi_date_form_save_2_listener(){return t.save()}))("cancel",(function DaysDurationEditFieldComponent_Template_op_wp_multi_date_form_cancel_2_listener(){return t.cancel()})),i.k0s()()),2&e&&(i.Y8G("opened",t.opened),i.R7$(),i.Y8G("ngModel",t.formattedValue)("id",t.handler.htmlId),i.R7$(),i.Y8G("changeset",t.change)("fieldName",t.name))},dependencies:[m.me,m.Q0,m.BC,m.vS,te.m,ne.D],encapsulation:2,changeDetection:0})}}var me=n(73014);class ProgressEditFieldComponent extends h.Ii{ngOnInit(){super.ngOnInit(),this.handler.$onUserActivate.pipe(this.untilDestroyed()).subscribe((()=>{this.showProgressModal()}))}ngOnDestroy(){super.ngOnDestroy()}showProgressModal(){}static{this.ɵfac=(()=>{let e;return function ProgressEditFieldComponent_Factory(t){return(e||(e=i.xGo(ProgressEditFieldComponent)))(t||ProgressEditFieldComponent)}})()}static{this.ɵdir=i.FsC({type:ProgressEditFieldComponent,features:[i.Vt3]})}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",ee.g)],ProgressEditFieldComponent.prototype,"deviceService",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",i.zZn)],ProgressEditFieldComponent.prototype,"injector",void 0);var ge=n(91691),_e=n(72650),fe=n(93855);const be=["frameElement"];class ProgressPopoverEditFieldComponent extends ProgressEditFieldComponent{constructor(e,t,n,i,o,r,s,a,l,c,p,d){super(e,t,n,i,o,r,s),this.I18n=e,this.elementRef=t,this.change=n,this.schema=i,this.handler=o,this.cdRef=r,this.injector=s,this.pathHelper=a,this.halEvents=l,this.toastService=c,this.apiV3Service=p,this.timezoneService=d,this.text={title:this.I18n.t("js.work_packages.progress.title"),button_close:this.I18n.t("js.button_close"),placeholder:"-"},this.opened=!1}ngOnInit(){super.ngOnInit(),this.frameSrc=`${this.pathHelper.workPackageProgressModalPath(this.resource.id)}?field=${this.name}`,this.frameId="work_package_progress_modal"}ngAfterViewInit(){this.frameElement.nativeElement.addEventListener("turbo:submit-end",this.contextBasedListener.bind(this))}ngOnDestroy(){super.ngOnDestroy(),this.frameElement.nativeElement.removeEventListener("turbo:submit-end",this.contextBasedListener.bind(this))}get asHoursOrPercent(){return"percentageDone"===this.name?this.asPercent:this.asHours}get asPercent(){return null===this.value||void 0===this.value?this.text.placeholder:`${this.value}%`}get asHours(){return null===this.value||void 0===this.value?this.text.placeholder:this.timezoneService.formattedChronicDuration(this.value)}formatter(e){return null==e?"":`${this.timezoneService.toHours(e)}`}nullAsEmptyStringFormatter(e){return null==e?"":e}contextBasedListener(e){"new"===this.resource.id?this.propagateSuccessfulCreate(e):this.propagateSuccessfulUpdate(e)}propagateSuccessfulCreate(e){var t=this;return(0,f.A)((function*(){const{fetchResponse:n}=e.detail;if(n.succeeded){const e=yield t.extractJSONFromResponse(n.response.body);t.resource.estimatedTime=e.estimatedTime,t.resource.remainingTime=e.remainingTime,t.resource.percentageDone=e.percentageDone,t.onModalClosed(),t.change.push(),t.cdRef.detectChanges()}}))()}propagateSuccessfulUpdate(e){const{fetchResponse:t}=e.detail;t.succeeded&&(this.halEvents.push(this.resource,{eventType:"updated"}),this.apiV3Service.work_packages.id(this.resource).refresh(),this.onModalClosed(),this.toastService.addSuccess(this.I18n.t("js.notice_successful_update")))}extractJSONFromResponse(e){return(0,f.A)((function*(){const t=yield e.getReader().read();return JSON.parse(new TextDecoder("utf-8").decode(new Uint8Array(t.value)))}))()}updateFrameSrc(){const e=new URL(this.pathHelper.workPackageProgressModalPath(this.resource.id),window.location.origin);e.searchParams.set("field",this.name),e.searchParams.set("work_package[initial][estimated_hours]",this.formatter(this.resource.estimatedTime)),e.searchParams.set("work_package[initial][remaining_hours]",this.formatter(this.resource.remainingTime)),e.searchParams.set("work_package[initial][done_ratio]",this.nullAsEmptyStringFormatter(this.resource.percentageDone)),e.searchParams.set("work_package[initial][status_id]",this.nullAsEmptyStringFormatter(this.resource.status?.id)),e.searchParams.set("work_package[estimated_hours]",this.formatter(this.resource.estimatedTime)),e.searchParams.set("work_package[remaining_hours]",this.formatter(this.resource.remainingTime)),e.searchParams.set("work_package[done_ratio]",this.nullAsEmptyStringFormatter(this.resource.percentageDone)),e.searchParams.set("work_package[status_id]",this.nullAsEmptyStringFormatter(this.resource.status?.id)),"new"===this.resource?.id&&e.searchParams.set("work_package[status_id_touched]","true"),this.frameSrc=e.toString()}onInputClick(e){e.stopPropagation()}showProgressModal(){this.updateFrameSrc(),this.opened=!0,this.cdRef.detectChanges()}onModalClosed(){this.opened=!1,this.frameSrc="",this.handler.inEditMode||this.handler.deactivate(!1)}closeMe(){this.cancel()}cancel(){this.handler.inEditMode||(this.handler.deactivate(!1),this.handler.reset()),this.onModalClosed()}static{this.ɵfac=function ProgressPopoverEditFieldComponent_Factory(e){return new(e||ProgressPopoverEditFieldComponent)(i.rXU(x.W),i.rXU(i.aKT),i.rXU(h.hq),i.rXU(h.au),i.rXU(h.BO),i.rXU(i.gRc),i.rXU(i.zZn),i.rXU(me.B),i.rXU(ge.o),i.rXU(_e.fw),i.rXU(K.n),i.rXU(X.D))}}static{this.ɵcmp=i.VBU({type:ProgressPopoverEditFieldComponent,selectors:[["ng-component"]],viewQuery:function ProgressPopoverEditFieldComponent_Query(e,t){if(1&e&&i.GBs(be,5),2&e){let e;i.mGM(e=i.lsd())&&(t.frameElement=e.first)}},features:[i.Vt3],decls:15,vars:8,consts:[["frameElement",""],["alignment","bottom-start",3,"closed","opened","notFullscreen"],["slot","trigger","type","text",1,"spot-input",3,"click","focus","value","disabled","id"],["slot","body"],[1,"spot-drop-modal--header"],["id","spotModalTitle",1,"spot-drop-modal--header-title",3,"textContent"],["data-test-selector","op-progress-modal--close-icon",1,"button","button_no-margin","-transparent","spot-drop-modal--header-close-button",3,"click"],["x-icon","","size","small",1,"spot-drop-modal--header-close-button-icon"],[1,"spot-drop-modal--content"],["id","work_package_progress_modal"],["viewBox","0 0 180 80"],["height","10","rx","2","ry","2","width","110","x","0","y","0"],["height","10","rx","2","ry","2","width","25","x","120","y","0"],["height","10","rx","2","ry","2","width","25","x","155","y","0"],["height","25%","rx","2","ry","2","width","180","x","0","y","16"]],template:function ProgressPopoverEditFieldComponent_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"spot-drop-modal",1),i.bIt("closed",(function ProgressPopoverEditFieldComponent_Template_spot_drop_modal_closed_0_listener(){return i.eBV(e),i.Njj(t.onModalClosed())})),i.j41(1,"input",2),i.bIt("click",(function ProgressPopoverEditFieldComponent_Template_input_click_1_listener(n){return i.eBV(e),i.Njj(t.onInputClick(n))}))("focus",(function ProgressPopoverEditFieldComponent_Template_input_focus_1_listener(){return i.eBV(e),i.Njj(t.showProgressModal())})),i.k0s(),i.qex(2,3),i.j41(3,"div",4),i.nrm(4,"div",5),i.j41(5,"button",6),i.bIt("click",(function ProgressPopoverEditFieldComponent_Template_button_click_5_listener(){return i.eBV(e),i.Njj(t.closeMe())})),i.qSk(),i.nrm(6,"svg",7),i.k0s()(),i.joV(),i.j41(7,"div",8)(8,"turbo-frame",9,0)(10,"op-content-loader",10),i.qSk(),i.nrm(11,"rect",11)(12,"rect",12)(13,"rect",13)(14,"rect",14),i.k0s()()(),i.bVm(),i.k0s()}2&e&&(i.Y8G("opened",t.opened)("notFullscreen",!0),i.R7$(),i.Y8G("value",t.asHoursOrPercent)("disabled",t.opened||t.inFlight)("id",t.handler.htmlId),i.R7$(3),i.Y8G("textContent",t.text.title),i.R7$(),i.BMQ("aria-label",t.text.button_close),i.R7$(3),i.BMQ("src",t.frameSrc))},dependencies:[fe.bDK,de.F,te.m],styles:["@media screen and (min-width: 1011px){.spot-drop-modal--content[_ngcontent-%COMP%]{width:500px}}"],changeDetection:0})}}function initializeCoreEditFields(e,t){return()=>{e.defaultFieldType="text",e.addFieldType(TextEditFieldComponent,"text",["String"]).addFieldType(IntegerEditFieldComponent,"integer",["Integer"]).addFieldType(ProgressPopoverEditFieldComponent,"progress",["Progress"]).addFieldType(ProjectEditFieldComponent,"project",["Project"]).addFieldType(UserEditFieldComponent,"user",["User"]).addFieldType(SelectEditFieldComponent,"select",["Priority","Status","Type","Version","TimeEntriesActivity","Category","CustomOption","CustomField::Hierarchy::Item"]).addFieldType(MultiSelectEditFieldComponent,"multi-select",["[]CustomOption","[]User","[]Version","[]CustomField::Hierarchy::Item"]).addFieldType(FloatEditFieldComponent,"float",["Float"]).addFieldType(WorkPackageEditFieldComponent,"workPackage",["WorkPackage"]).addFieldType(BooleanEditFieldComponent,"boolean",["Boolean"]).addFieldType(DateEditFieldComponent,"date",["Date"]).addFieldType(L.r,"wiki-textarea",["Formattable"]).addFieldType(se.A,"_comment",["comment"]),e.addSpecificFieldType("WorkPackage",CombinedDateEditFieldComponent,"date",["combinedDate","startDate","dueDate","date"]).addSpecificFieldType("WorkPackage",DaysDurationEditFieldComponent,"duration",["duration"]).addSpecificFieldType("WorkPackage",ProgressPopoverEditFieldComponent,"progress",["estimatedTime","remainingTime","percentageDone"]).addSpecificFieldType("Project",ProjectStatusEditFieldComponent,"status",["status"]).addSpecificFieldType("TimeEntry",PlainFormattableEditFieldComponent,"comment",["comment"]).addSpecificFieldType("TimeEntry",TimeEntryWorkPackageEditFieldComponent,"workPackage",["WorkPackage"]).addSpecificFieldType("TimeEntry",HoursDurationEditFieldComponent,"hours",["hours"]),t.register(oe.e,"Version"),t.register(re.R,"WorkPackage")}}var ke=n(11621);class BooleanDisplayField extends ke.p{get valueString(){return this.translatedValue()}get placeholder(){return this.translatedValue()}translatedValue(){return this.value?this.I18n.t("js.general_text_yes"):this.I18n.t("js.general_text_no")}isEmpty(){return!1}}var ve=n(94896),Ce=n(79421),ye=n(45261);class HierarchyQueryLinkHelperService{constructor(e,t){this.apiV3Service=e,this.pathHelper=t}addHref(e,t){if(t&&t.id&&t.project){const n=t.id.toString();this.apiV3Service.projects.id(t.project).get().subscribe((t=>{const i={c:["id","subject","type","status","estimatedTime","remainingTime","percentageDone"],hi:!0,is:!0,f:[{n:"parent",o:"=",v:[n]}]},o=ye(this.pathHelper.projectWorkPackagesPath(t.identifier)).query({query_props:JSON.stringify(i)}).toString();e.href=o}))}}static{this.ɵfac=function HierarchyQueryLinkHelperService_Factory(e){return new(e||HierarchyQueryLinkHelperService)(i.KVO(K.n),i.KVO(me.B))}}static{this.ɵprov=i.jDH({token:HierarchyQueryLinkHelperService,factory:HierarchyQueryLinkHelperService.ɵfac,providedIn:"root"})}}class ExcludedIconHelperService{constructor(e){this.apiV3Service=e}addIconIfExcludedFromTotals(e,t){t?.status&&this.apiV3Service.statuses.id(t.status).get().subscribe((t=>{t.excludedFromTotals&&this.addExcludedInfoIcon(e,t.name)}))}addExcludedInfoIcon(e,t){const n=document.createElement("opce-exclusion-info");n.setAttribute("status-name",t),e.appendChild(n)}static{this.ɵfac=function ExcludedIconHelperService_Factory(e){return new(e||ExcludedIconHelperService)(i.KVO(K.n))}}static{this.ɵprov=i.jDH({token:ExcludedIconHelperService,factory:ExcludedIconHelperService.ɵfac,providedIn:"root"})}}class CompoundProgressDisplayField extends ke.p{constructor(){super(...arguments),this.derivedText=this.I18n.t("js.label_value_derived_from_children")}render(e,t){e.classList.add("split-time-field"),e.setAttribute("title",t),this.renderActual(e,t),null!==this.derivedValue&&this.hasChildren()&&(this.renderSeparator(e),this.renderDerived(e,this.derivedValueString))}renderActual(e,t){const n=document.createElement("span");n.textContent=t,n.title=this.valueString,n.classList.add("-actual-value"),this.excludedIconHelperService.addIconIfExcludedFromTotals(n,this.resource),e.appendChild(n)}renderDerived(e,t){const n=document.createElement("a");n.textContent=`Σ ${t}`,n.title=`${t} ${this.derivedText}`,n.classList.add("-derived-value",Ce.qk),this.hierarchyQueryLinkHelper.addHref(n,this.resource),e.appendChild(n)}renderSeparator(e){const t=document.createElement("span");t.textContent="·",t.classList.add("-separator"),t.ariaHidden="true",e.appendChild(t)}isEmpty(){const{value:e}=this,t=this.derivedValue;return null===e&&null===t}get value(){return this.resource[this.name]}get valueString(){return this.formatAsPercentage(this.value)}get derivedPropertyName(){return`derived${_.upperFirst(this.name)}`}get derivedValue(){return this.resource[this.derivedPropertyName]}get derivedValueString(){return this.formatAsPercentage(this.derivedValue)}formatAsPercentage(e){return null==e?this.placeholder:`${e}%`}hasChildren(){return!!this.resource.children}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",me.B)],CompoundProgressDisplayField.prototype,"PathHelper",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",K.n)],CompoundProgressDisplayField.prototype,"apiV3Service",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",ExcludedIconHelperService)],CompoundProgressDisplayField.prototype,"excludedIconHelperService",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",HierarchyQueryLinkHelperService)],CompoundProgressDisplayField.prototype,"hierarchyQueryLinkHelper",void 0);var we=n(3851);class DateTimeDisplayField extends ke.p{get valueString(){return this.value?this.timezoneService.formattedDatetime(this.value):""}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",X.D)],DateTimeDisplayField.prototype,"timezoneService",void 0);class DaysDurationDisplayField extends ke.p{get valueString(){return this.timezoneService.formattedDuration(this.value,"days")}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",X.D)],DaysDurationDisplayField.prototype,"timezoneService",void 0);class WorkDisplayField extends ke.p{constructor(){super(...arguments),this.derivedText=this.I18n.t("js.label_value_derived_from_children")}get valueString(){return this.timezoneService.formattedChronicDuration(this.value)}get derivedPropertyName(){return`derived${this.name.charAt(0).toUpperCase()}${this.name.slice(1)}`}get derivedValue(){return this.resource[this.derivedPropertyName]}get derivedValueString(){const e=this.derivedValue;return e?this.timezoneService.formattedChronicDuration(e):this.placeholder}render(e,t){if(this.isEmpty())return void(e.textContent=this.placeholder);e.classList.add("split-time-field"),this.renderActual(e,t);this.derivedValue&&this.hasChildren()&&(this.renderSeparator(e),this.renderDerived(e,this.derivedValueString))}renderActual(e,t){const n=document.createElement("span");this.value?(n.textContent=t,n.title=this.valueString):(n.textContent=this.texts.placeholder,n.title=this.texts.placeholder),n.classList.add("-actual-value"),this.value&&this.excludedIconHelperService.addIconIfExcludedFromTotals(n,this.resource),e.appendChild(n)}renderSeparator(e){const t=document.createElement("span");t.classList.add("-separator"),t.textContent="·",t.ariaHidden="true",e.appendChild(t)}renderDerived(e,t){const n=document.createElement("a");n.textContent=`Σ ${t}`,n.title=`${this.derivedValueString} ${this.derivedText}`,n.classList.add("-derived-value",Ce.qk),this.hierarchyQueryLinkHelper.addHref(n,this.resource),e.appendChild(n)}get title(){return null}isEmpty(){const{value:e}=this,t=this.derivedValue;return!e&&!t}hasChildren(){return!!this.resource.children}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",X.D)],WorkDisplayField.prototype,"timezoneService",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",me.B)],WorkDisplayField.prototype,"PathHelper",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",K.n)],WorkDisplayField.prototype,"apiV3Service",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",ExcludedIconHelperService)],WorkDisplayField.prototype,"excludedIconHelperService",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",HierarchyQueryLinkHelperService)],WorkDisplayField.prototype,"hierarchyQueryLinkHelper",void 0);class FloatDisplayField extends ke.p{get valueString(){return null==this.value?"":this.value.toLocaleString(this.I18n.locale,{useGrouping:!0,maximumFractionDigits:20})}}class ExpressionService{static get UNESCAPED_EXPRESSION(){return"{{"}static get ESCAPED_EXPRESSION(){return"{{ \\$root\\.DOUBLE_LEFT_CURLY_BRACE }}"}static escape(e){return e.replace(new RegExp(this.UNESCAPED_EXPRESSION,"g"),this.ESCAPED_EXPRESSION)}static unescape(e){return e.replace(new RegExp(this.ESCAPED_EXPRESSION,"g"),this.UNESCAPED_EXPRESSION)}}class FormattableDisplayField extends ke.p{render(e,t,n={}){const i=document.createElement("div");i.classList.add("read-value--html","highlight","op-uc-container","op-uc-container_reduced-headings","-multiline"),n.rtl&&i.classList.add("-rtl"),i.innerHTML=t,e.innerHTML="",e.appendChild(i)}get placeholder(){return"description"===this.name?this.I18n.t("js.placeholders.description"):super.placeholder}get isFormattable(){return!0}get value(){if(!this.schema)return null;const e=this.resource[this.name];return e&&e.html?this.unescape(e.html):""}unescape(e){return e?ExpressionService.unescape(e):""}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",i.o8S)],FormattableDisplayField.prototype,"appRef",void 0);var Te=n(46116),Se=n(30183),je=n(27514);class HighlightedResourceDisplayField extends Se.B{render(e,t){super.render(e,t),this.shouldHighlight&&this.addHighlight(e)}get value(){return this.schema?this.attribute&&this.attribute.name:null}addHighlight(e){if(this.attribute instanceof je.q){const t=Te.H.inlineClass(this.name,this.attribute.id);e.classList.add(t)}}}class IdDisplayField extends ke.p{constructor(){super(...arguments),this.text={linkTitle:this.I18n.t("js.work_packages.message_successful_show_in_fullscreen")}}get value(){return(0,le.A)(this.resource)?null:this.resource[this.name]}render(e,t){this.value&&(e.textContent=t)}isEmpty(){return!1}}class IntegerDisplayField extends ke.p{get value(){return parseInt(this.resource[this.name])}isEmpty(){return isNaN(this.value)}}var Pe=n(66309);class WorkPackageDisplayField extends ke.p{constructor(){super(...arguments),this.text={none:this.I18n.t("js.filter.noneElement")}}get value(){return this.resource[this.name]}get title(){return this.isEmpty()?this.text.none:this.value.name}get wpId(){return this.isEmpty()?null:this.value.$loaded?this.value.id:this.value.href.match(/(\d+)$/)[0]}get valueString(){return`#${this.wpId} ${this.title}`}isEmpty(){return!this.value}get unknownAttribute(){return!1}}class LinkedWorkPackageDisplayField extends WorkPackageDisplayField{constructor(){super(...arguments),this.text={linkTitle:this.I18n.t("js.work_packages.message_successful_show_in_fullscreen"),none:this.I18n.t("js.filter.noneElement")},this.uiStateBuilder=new Ce.Xq(this.$state,this.keepTab)}render(e,t){if(this.isEmpty())return void(e.innerText=this.placeholder);const n=this.uiStateBuilder.linkToShow(this.wpId,this.text.linkTitle,this.valueString),i=document.createElement("span");i.textContent=` ${_.truncate(this.title,{length:40})}`,e.innerHTML="",e.appendChild(n),e.appendChild(i)}get writable(){return!1}get valueString(){return`#${this.wpId}`}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",k.dw)],LinkedWorkPackageDisplayField.prototype,"$state",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",Pe.S)],LinkedWorkPackageDisplayField.prototype,"keepTab",void 0);var Ie=n(65896),xe=n(66552);class MultipleUserFieldModule extends xe.g{render(e){const t=this.value;e.style.display="block",e.innerHTML="",e.setAttribute("title",t.map((e=>e.name)).join(", ")),0===t.length?this.renderEmpty(e):this.principalRenderer.renderAbbreviated(e,t)}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",Ie.r)],MultipleUserFieldModule.prototype,"principalRenderer",void 0);class PlainFormattableDisplayField extends ke.p{get value(){if(!this.schema)return null;const e=this.resource[this.name];return e&&e.raw||""}}class ProjectStatusDisplayField extends ke.p{render(e,t){const n=this.value&&this.value.id,i=document.createElement("span");i.classList.add("project-status--bulb",(0,H.U)(n));const o=document.createElement("span");if(o.classList.add("project-status--name",(0,H.U)(n)),o.textContent=(0,H.O)(n,this.I18n),e.innerHTML="",e.appendChild(i),e.appendChild(o),this.writable){const t=document.createElement("span");t.classList.add("project-status--pulldown-icon","icon","icon-pulldown"),e.appendChild(t)}}}var Re=n(95783);class TextDisplayField extends ke.p{}class TypeDisplayField extends HighlightedResourceDisplayField{get shouldHighlight(){return!0}}class UserDisplayField extends ke.p{get value(){return this.schema?this.typeSafeAttribute()?.name||"":null}render(e,t){this.placeholder===t?this.renderEmpty(e):this.principalRenderer.render(e,this.typeSafeAttribute(),{hide:!1,link:!1},{hide:!1,size:"medium",hoverCard:{url:this.typeSafeAttribute()?.url||""}})}typeSafeAttribute(){return this.attribute}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",Ie.r)],UserDisplayField.prototype,"principalRenderer",void 0);class WorkPackageIdDisplayField extends IdDisplayField{constructor(){super(...arguments),this.uiStateBuilder=new Ce.Xq(this.$state,this.keepTab)}render(e,t){if(!this.value)return;const n=this.uiStateBuilder.linkToShow(this.value,t,this.value);e.appendChild(n)}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",k.dw)],WorkPackageIdDisplayField.prototype,"$state",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",Pe.S)],WorkPackageIdDisplayField.prototype,"keepTab",void 0);var Fe=n(85254);class WorkPackageSpentTimeDisplayField extends WorkDisplayField{constructor(){super(...arguments),this.text={linkTitle:this.I18n.t("js.work_packages.message_view_spent_time"),logTime:this.I18n.t("js.button_log_time")}}render(e,t){if(!this.value)return;const n=document.createElement("a");if(n.textContent=t,n.setAttribute("title",this.text.linkTitle),t===this.placeholder?n.setAttribute("class","time-logging--value time-logging--value_empty"):n.setAttribute("class","time-logging--value"),this.resource.project&&this.resource.id){const e=this.resource.id.toString();this.apiV3Service.projects.id(this.resource.project).get().subscribe((t=>{const i=ye(this.PathHelper.projectTimeEntriesPath(t.identifier)).search(`fields[]=WorkPackageId&operators[WorkPackageId]=%3D&values[WorkPackageId]=${e}&set_filter=1`).toString();n.href=i}))}e.innerHTML="",e.appendChild(n),this.appendTimelogLink(e)}appendTimelogLink(e){if(this.timeEntryCreateService&&this.resource.logTime){const t=document.createElement("a");t.setAttribute("class","icon icon-time"),t.setAttribute("href",""),t.setAttribute("title",this.text.logTime),e.appendChild(t),t.addEventListener("click",this.showTimelogWidget.bind(this,this.resource))}}showTimelogWidget(e){this.timeEntryCreateService.create(he(new Date),e,{showWorkPackageField:!1}).catch((()=>{}))}}(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",me.B)],WorkPackageSpentTimeDisplayField.prototype,"PathHelper",void 0),(0,b.Cg)([(0,w.O)(Fe.h,null),(0,b.Sn)("design:type",Fe.h)],WorkPackageSpentTimeDisplayField.prototype,"timeEntryCreateService",void 0),(0,b.Cg)([(0,w.O)(),(0,b.Sn)("design:type",K.n)],WorkPackageSpentTimeDisplayField.prototype,"apiV3Service",void 0);var Me=n(36819),Oe=n(60807);class LinkDisplayField extends ke.p{render(e,t){if(null===this.value||void 0===this.value||""===this.value)return void(e.textContent=this.placeholder);const n=document.createElement("a");n.textContent=t,n.href=this.value,n.rel="noopener noreferrer",n.target=this.target,e.appendChild(n),this.appendEditLink(e)}appendEditLink(e){if(this.resource.updateImmediately){const t=document.createElement("a");t.classList.add("icon","icon-edit",Oe.nK),t.setAttribute("href","#"),e.appendChild(t)}}get target(){const e=window.location.origin;try{if(e!==new URL(this.value,window.location.origin).origin)return"_blank"}catch(e){(0,Me.cY)("Failed to parse origin for URL %O: %O",this.value,e)}return""}}function initializeCoreDisplayFields(e){return()=>{e.defaultFieldType="text",e.addFieldType(TextDisplayField,"text",["String"]).addFieldType(FloatDisplayField,"float",["Float"]).addFieldType(IntegerDisplayField,"integer",["Integer"]).addFieldType(HighlightedResourceDisplayField,"highlight",["Status","Priority"]).addFieldType(TypeDisplayField,"type",["Type"]).addFieldType(Re.b,"resource",["Project","TimeEntriesActivity","Version","Category","CustomField::Hierarchy::Item","CustomOption"]).addFieldType(xe.g,"resources",["[]CustomOption","[]CustomField::Hierarchy::Item"]).addFieldType(xe.g,"resources",["[]Version"]).addFieldType(MultipleUserFieldModule,"users",["[]User"]).addFieldType(FormattableDisplayField,"formattable",["Formattable"]).addFieldType(DaysDurationDisplayField,"duration",["duration"]).addFieldType(WorkDisplayField,"remainingTime",["remainingTime"]).addFieldType(WorkDisplayField,"estimatedTime",["estimatedTime"]).addFieldType(we.H,"date",["Date"]).addFieldType(DateTimeDisplayField,"datetime",["DateTime"]).addFieldType(BooleanDisplayField,"boolean",["Boolean"]).addFieldType(LinkDisplayField,"link",["Link"]).addFieldType(CompoundProgressDisplayField,"progress",["percentageDone"]).addFieldType(LinkedWorkPackageDisplayField,"work_package",["WorkPackage"]).addFieldType(IdDisplayField,"id",["id"]).addFieldType(UserDisplayField,"user",["User"]),e.addSpecificFieldType("WorkPackage",WorkPackageIdDisplayField,"id",["id"]).addSpecificFieldType("WorkPackage",WorkPackageSpentTimeDisplayField,"spentTime",["spentTime"]).addSpecificFieldType("WorkPackage",ve.A,"combinedDate",["combinedDate"]).addSpecificFieldType("TimeEntry",PlainFormattableDisplayField,"comment",["comment"]).addSpecificFieldType("Project",ProjectStatusDisplayField,"status",["status"]).addSpecificFieldType("TimeEntry",WorkPackageDisplayField,"work_package",["workPackage"])}}var De=n(43063),Ge=n(8958),Ee=n(43487),Ae=n(84878),Ve=n(58945),$e=n(4930),Be=n(42572);class BooleanEditFieldModule{static{this.ɵfac=function BooleanEditFieldModule_Factory(e){return new(e||BooleanEditFieldModule)}}static{this.ɵmod=i.$C({type:BooleanEditFieldModule})}static{this.ɵinj=i.G2t({imports:[o.MD]})}}("undefined"==typeof ngJitMode||ngJitMode)&&i.Obh(BooleanEditFieldModule,{declarations:[BooleanEditFieldComponent],imports:[o.MD],exports:[BooleanEditFieldComponent]});class IntegerEditFieldModule{static{this.ɵfac=function IntegerEditFieldModule_Factory(e){return new(e||IntegerEditFieldModule)}}static{this.ɵmod=i.$C({type:IntegerEditFieldModule})}static{this.ɵinj=i.G2t({imports:[o.MD,m.YN]})}}("undefined"==typeof ngJitMode||ngJitMode)&&i.Obh(IntegerEditFieldModule,{declarations:[IntegerEditFieldComponent],imports:[o.MD,m.YN],exports:[IntegerEditFieldComponent]});var We=n(78906);class TextEditFieldModule{static{this.ɵfac=function TextEditFieldModule_Factory(e){return new(e||TextEditFieldModule)}}static{this.ɵmod=i.$C({type:TextEditFieldModule})}static{this.ɵinj=i.G2t({imports:[o.MD,m.YN,We.j]})}}("undefined"==typeof ngJitMode||ngJitMode)&&i.Obh(TextEditFieldModule,{declarations:[TextEditFieldComponent],imports:[o.MD,m.YN,We.j],exports:[TextEditFieldComponent]});class DateEditFieldModule{static{this.ɵfac=function DateEditFieldModule_Factory(e){return new(e||DateEditFieldModule)}}static{this.ɵmod=i.$C({type:DateEditFieldModule})}static{this.ɵinj=i.G2t({imports:[o.MD,l.d]})}}("undefined"==typeof ngJitMode||ngJitMode)&&i.Obh(DateEditFieldModule,{declarations:[DateEditFieldComponent],imports:[o.MD,l.d],exports:[DateEditFieldComponent]});class SelectEditFieldModule{static{this.ɵfac=function SelectEditFieldModule_Factory(e){return new(e||SelectEditFieldModule)}}static{this.ɵmod=i.$C({type:SelectEditFieldModule})}static{this.ɵinj=i.G2t({imports:[o.MD,I.oW]})}}("undefined"==typeof ngJitMode||ngJitMode)&&i.Obh(SelectEditFieldModule,{declarations:[SelectEditFieldComponent],imports:[o.MD,I.oW],exports:[SelectEditFieldComponent]});var Ne=n(83998),Ue=n(23604),Ye=n(34629);class OpenprojectFieldsModule{constructor(e){}static{this.ɵfac=function OpenprojectFieldsModule_Factory(e){return new(e||OpenprojectFieldsModule)(i.KVO(i.zZn))}}static{this.ɵmod=i.$C({type:OpenprojectFieldsModule})}static{this.ɵinj=i.G2t({providers:[{provide:i.hnV,useFactory:initializeCoreEditFields,deps:[d.M,SelectAutocompleterRegisterService],multi:!0},{provide:i.hnV,useFactory:initializeCoreDisplayFields,deps:[u.w],multi:!0}],imports:[o.MD,l.d,c.m,m.YN,R.MQ,a._,s.b,r.p,Be.E,p.f,BooleanEditFieldModule,IntegerEditFieldModule,TextEditFieldModule,DateEditFieldModule,SelectEditFieldModule,Ne.s,Ue.T]})}}("undefined"==typeof ngJitMode||ngJitMode)&&i.Obh(OpenprojectFieldsModule,{declarations:[De.u,HoursDurationEditFieldComponent,ProgressPopoverEditFieldComponent,Ye.B,DaysDurationEditFieldComponent,FloatEditFieldComponent,PlainFormattableEditFieldComponent,MultiSelectEditFieldComponent,CombinedDateEditFieldComponent,ProjectEditFieldComponent,UserEditFieldComponent,WorkPackageEditFieldComponent,TimeEntryWorkPackageEditFieldComponent,S.G,$e.W,Ge.c,ProjectStatusEditFieldComponent,Ee.T,Ae.I,Ve.Q],imports:[o.MD,l.d,c.m,m.YN,R.MQ,a._,s.b,r.p,Be.E,p.f,BooleanEditFieldModule,IntegerEditFieldModule,TextEditFieldModule,DateEditFieldModule,SelectEditFieldModule,Ne.s,Ue.T],exports:[De.u,S.G,Ge.c,$e.W]})},54892:(e,t,n)=>{"use strict";n.d(t,{q:()=>AbstractWidgetComponent});var i=n(68559),o=(n(81704),n(61816)),r=n(38429);class WidgetChangeset extends r.b{}var s=n(99496);class AbstractWidgetComponent extends s.p{get widgetName(){const e=this.resource?.options.name,t=this.resource?.identifier;return this.isEditable?e:this.i18n.t(`js.grid.widgets.${t}.title`,{defaultValue:e})}renameWidget(e){const t=this.setChangesetOptions({name:e});this.resourceChanged.emit(t)}get isEditable(){return!0}constructor(e,t){super(),this.i18n=e,this.injector=t,this.resourceChanged=new i.bkB}setChangesetOptions(e){const t=new WidgetChangeset(this.resource);return t.setValue("options",{...this.resource.options,...e}),t}static{this.ɵfac=function AbstractWidgetComponent_Factory(e){return new(e||AbstractWidgetComponent)(i.rXU(o.W),i.rXU(i.zZn))}}static{this.ɵdir=i.FsC({type:AbstractWidgetComponent,hostVars:8,hostBindings:function AbstractWidgetComponent_HostBindings(e,t){2&e&&i.xc7("grid-column-start",t.gridColumnStart)("grid-column-end",t.gridColumnEnd)("grid-row-start",t.gridRowStart)("grid-row-end",t.gridRowEnd)},inputs:{resource:"resource"},outputs:{resourceChanged:"resourceChanged"},features:[i.Vt3]})}}},67e3:(e,t,n)=>{"use strict";n.d(t,{L:()=>AddSectionDropdownComponent});var i=n(61816),o=n(46687),r=n(55596),s=n(99496),a=n(68559),l=n(60316),c=n(34456);const p=["fallbackOption"];function AddSectionDropdownComponent_option_3_Template(e,t){if(1&e&&a.nrm(0,"option",4),2&e){const e=t.$implicit;a.Y8G("value",e.key)("textContent",e.label)}}class AddSectionDropdownComponent extends s.p{constructor(e,t,n){super(),this.hideSectionService=e,this.elementRef=t,this.I18n=n,this.trackByKey=(0,r.I$)("key"),this.selectable=[],this.active=[],this.placeholder=this.I18n.t("js.placeholders.selection")}ngOnInit(){this.htmlId=this.elementRef.nativeElement.dataset.htmlId,this.hideSectionService.displayed.values$().pipe(this.untilDestroyed()).subscribe((e=>{this.selectable=this.hideSectionService.all.filter((t=>-1===e.indexOf(t.key))).sort(((e,t)=>e.label.localeCompare(t.label))),this.option.nativeElement.selected=!0}))}show(e){this.hideSectionService.show(e)}static{this.ɵfac=function AddSectionDropdownComponent_Factory(e){return new(e||AddSectionDropdownComponent)(a.rXU(o.L),a.rXU(a.aKT),a.rXU(i.W))}}static{this.ɵcmp=a.VBU({type:AddSectionDropdownComponent,selectors:[["opce-add-section-dropdown"]],viewQuery:function AddSectionDropdownComponent_Query(e,t){if(1&e&&a.GBs(p,7),2&e){let e;a.mGM(e=a.lsd())&&(t.option=e.first)}},features:[a.Vt3],decls:4,vars:3,consts:[["fallbackOption",""],[1,"form--select",3,"change","id"],["value","","selected","","disabled","",3,"textContent"],[3,"value","textContent",4,"ngFor","ngForTrackByKey","ngForOf"],[3,"value","textContent"]],template:function AddSectionDropdownComponent_Template(e,t){if(1&e){const e=a.RV6();a.j41(0,"select",1),a.bIt("change",(function AddSectionDropdownComponent_Template_select_change_0_listener(n){return a.eBV(e),a.Njj(t.show(n.target.value))})),a.nrm(1,"option",2,0),a.DNE(3,AddSectionDropdownComponent_option_3_Template,1,2,"option",3),a.k0s()}2&e&&(a.Y8G("id",t.htmlId),a.R7$(),a.Y8G("textContent",t.placeholder),a.R7$(2),a.Y8G("ngForOf",t.selectable))},dependencies:[l.Sq,c.xH,c.y7],encapsulation:2})}}},88056:(e,t,n)=>{"use strict";n.d(t,{r:()=>HideSectionLinkComponent});var i=n(46687),o=n(61816),r=n(68559),s=n(46765);class HideSectionLinkComponent{constructor(e,t,n){this.elementRef=e,this.hideSectionService=t,this.I18n=n,this.displayed=!0,this.text={remove:this.I18n.t("js.label_remove")}}ngOnInit(){this.sectionName=this.elementRef.nativeElement.dataset.sectionName}hideSection(){return this.hideSectionService.hide(this.sectionName),!1}static{this.ɵfac=function HideSectionLinkComponent_Factory(e){return new(e||HideSectionLinkComponent)(r.rXU(r.aKT),r.rXU(i.L),r.rXU(o.W))}}static{this.ɵcmp=r.VBU({type:HideSectionLinkComponent,selectors:[["opce-hide-section-link"]],decls:2,vars:1,consts:[["type","button",1,"spot-link",3,"click","title"],["icon-classes","icon-close icon-small"]],template:function HideSectionLinkComponent_Template(e,t){1&e&&(r.j41(0,"button",0),r.bIt("click",(function HideSectionLinkComponent_Template_button_click_0_listener(){return t.hideSection()})),r.nrm(1,"op-icon",1),r.k0s()),2&e&&r.Y8G("title",t.text.remove)},dependencies:[s.i],encapsulation:2})}}},46687:(e,t,n)=>{"use strict";n.d(t,{L:()=>HideSectionService});var i=n(51730),o=n(47418),r=n(68559);class HideSectionService{constructor(e){this.displayed=(0,o.hF)(),this.all=[];const t=e.get("hideSections");this.all=t.all,this.displayed.putValue(t.active.map((e=>(this.toggleVisibility(e.key,!0),e.key)))),this.removeHiddenOnSubmit()}section(e){return document.querySelector(`section.hide-section[data-section-name="${e}"]`)}hide(e){this.displayed.doModify((t=>t.filter((t=>t!==e)))),this.toggleVisibility(e,!1)}show(e){this.displayed.doModify((t=>[...t,e])),this.toggleVisibility(e,!0)}toggleVisibility(e,t){const n=this.section(e);n&&(n.hidden=!t)}removeHiddenOnSubmit(){jQuery(document.body).on("submit","form",(function(e){const t=jQuery(this),n=t.find("section.hide-section:hidden");return!(!t.data("hideSectionRemoved")&&0!==n.length)||(t.data("hideSectionRemoved",!0),n.remove(),t.trigger("submit"),e.preventDefault(),!1)}))}static{this.ɵfac=function HideSectionService_Factory(e){return new(e||HideSectionService)(r.KVO(i.m))}}static{this.ɵprov=r.jDH({token:HideSectionService,factory:HideSectionService.ɵfac,providedIn:"root"})}}},46765:(e,t,n)=>{"use strict";n.d(t,{i:()=>OpIconComponent});var i=n(68559),o=n(60316);function OpIconComponent_span_1_Template(e,t){if(1&e&&i.nrm(0,"span",2),2&e){const e=i.XpG();i.Y8G("textContent",e.iconTitle)}}class OpIconComponent{constructor(){this.iconTitle=""}static{this.ɵfac=function OpIconComponent_Factory(e){return new(e||OpIconComponent)}}static{this.ɵcmp=i.VBU({type:OpIconComponent,selectors:[["op-icon"]],hostAttrs:[1,"op-icon--wrapper"],inputs:{iconClasses:[i.Mj6.None,"icon-classes","iconClasses"],iconTitle:[i.Mj6.None,"icon-title","iconTitle"]},decls:2,vars:3,consts:[["aria-hidden","true",3,"ngClass"],["class","hidden-for-sighted",3,"textContent",4,"ngIf"],[1,"hidden-for-sighted",3,"textContent"]],template:function OpIconComponent_Template(e,t){1&e&&(i.nrm(0,"i",0),i.DNE(1,OpIconComponent_span_1_Template,1,1,"span",1)),2&e&&(i.Y8G("ngClass",t.iconClasses),i.BMQ("title",t.iconTitle||void 0),i.R7$(),i.Y8G("ngIf",t.iconTitle))},dependencies:[o.YU,o.bT],encapsulation:2})}}},17136:(e,t,n)=>{"use strict";n.d(t,{o:()=>IconModule});var i=n(60316),o=n(46765),r=n(93855),s=n(68559);class IconModule{static{this.ɵfac=function IconModule_Factory(e){return new(e||IconModule)}}static{this.ɵmod=s.$C({type:IconModule})}static{this.ɵinj=s.G2t({imports:[i.MD,r.pRt,r.weG,r.RpT,r.aZK,r.bQj,r.JI9,r.VXk,r.jUF,r.Ydy,r.CPx,r.QxR,r._0w,r.lZr,r.hvu,r.xTw,r._wq,r.O1O,r.BBM,r.Fpx,r.foF,r.Z6b,r.ay5,r.zTh,r.dK,r.WoE,r.o1,r.dgQ,r.uMM,r.F7G,r.bDK,r.ziU,r.GON,r.mPf,r.QX2,r.S26,r.oB3,r.YLs,r.hA5,r.EAK,r.heV,r.OMe,r.RU6,r.Suf,r.zps,r.Q3F,r._Ym,r.bdw,r.WuR,r.Qbw,r.RAZ]})}}("undefined"==typeof ngJitMode||ngJitMode)&&s.Obh(IconModule,{declarations:[o.i],imports:[i.MD,r.pRt,r.weG,r.RpT,r.aZK,r.bQj,r.JI9,r.VXk,r.jUF,r.Ydy,r.CPx,r.QxR,r._0w,r.lZr,r.hvu,r.xTw,r._wq,r.O1O,r.BBM,r.Fpx,r.foF,r.Z6b,r.ay5,r.zTh,r.dK,r.WoE,r.o1,r.dgQ,r.uMM,r.F7G,r.bDK,r.ziU,r.GON,r.mPf,r.QX2,r.S26,r.oB3,r.YLs,r.hA5,r.EAK,r.heV,r.OMe,r.RU6,r.Suf,r.zps,r.Q3F,r._Ym,r.bdw,r.WuR,r.Qbw,r.RAZ],exports:[o.i,r.pRt,r.weG,r.RpT,r.aZK,r.bQj,r.JI9,r.VXk,r.jUF,r.Ydy,r.CPx,r.QxR,r._0w,r.lZr,r.hvu,r.xTw,r._wq,r.O1O,r.BBM,r.Fpx,r.foF,r.Z6b,r.ay5,r.zTh,r.dK,r.WoE,r.o1,r.dgQ,r.uMM,r.F7G,r.bDK,r.ziU,r.QX2,r.GON,r.mPf,r.S26,r.oB3,r.YLs,r.hA5,r.EAK,r.heV,r.OMe,r.RU6,r.Suf,r.zps,r.Q3F,r._Ym,r.bdw,r.WuR,r.Qbw,r.RAZ]})},46786:(e,t,n)=>{"use strict";n.d(t,{l:()=>OpCustomModalOverlayComponent});var i=n(3836),o=n(17732),r=n(68559),s=n(60316),a=n(9168),l=n(41497);function OpCustomModalOverlayComponent_button_3_Template(e,t){if(1&e){const e=r.RV6();r.j41(0,"button",4),r.bIt("click",(function OpCustomModalOverlayComponent_button_3_Template_button_click_0_listener(t){r.eBV(e);const n=r.XpG();return r.Njj(n.close(t))})),r.nrm(1,"span",5),r.k0s()}}function OpCustomModalOverlayComponent_ng_template_5_Template(e,t){}class OpCustomModalOverlayComponent extends i.E{isDefaultTarget(e){return null===e||e.target===o.V.Custom}static{this.ɵfac=(()=>{let e;return function OpCustomModalOverlayComponent_Factory(t){return(e||(e=r.xGo(OpCustomModalOverlayComponent)))(t||OpCustomModalOverlayComponent)}})()}static{this.ɵcmp=r.VBU({type:OpCustomModalOverlayComponent,selectors:[["op-custom-modal-overlay"]],features:[r.Vt3],decls:6,vars:12,consts:[["overlay",""],["tabindex","0","cdkFocusInitial","","cdkTrapFocus","","role","dialog","aria-modal","true","aria-labelledby","spotModalTitle",1,"spot-modal-overlay",3,"mousedown","cdkTrapFocusAutoCapture"],["type","button","class","spot-button spot-modal-overlay--close-button",3,"click",4,"ngIf"],["cdkPortalOutlet",""],["type","button",1,"spot-button","spot-modal-overlay--close-button",3,"click"],[1,"spot-icon","spot-icon_close"]],template:function OpCustomModalOverlayComponent_Template(e,t){if(1&e){const e=r.RV6();r.j41(0,"div",1,0),r.nI1(2,"async"),r.bIt("mousedown",(function OpCustomModalOverlayComponent_Template_div_mousedown_0_listener(n){return r.eBV(e),r.Njj(t.close(n,!1))})),r.DNE(3,OpCustomModalOverlayComponent_button_3_Template,2,0,"button",2),r.nI1(4,"async"),r.DNE(5,OpCustomModalOverlayComponent_ng_template_5_Template,0,0,"ng-template",3),r.k0s()}if(2&e){let e;r.AVh("spot-modal-overlay_active",null!==r.bMT(2,8,t.activeModalInstance$))("spot-modal-overlay_not-full-screen",t.notFullscreen)("spot-modal-overlay_top",t.mobileTopPosition),r.Y8G("cdkTrapFocusAutoCapture",!0),r.R7$(3),r.Y8G("ngIf",!1!==(null==(e=r.bMT(4,10,t.activeModalInstance$))?null:e.showCloseButton))}},dependencies:[s.bT,a.I3,l.kB,s.Jj],encapsulation:2,changeDetection:0})}}},42225:(e,t,n)=>{"use strict";n.d(t,{O:()=>OpModalBannerComponent});var i=n(68559),o=n(60316),r=n(46765);function OpModalBannerComponent_span_1_Template(e,t){1&e&&i.nrm(0,"span",7)}function OpModalBannerComponent_span_2_Template(e,t){1&e&&i.nrm(0,"span",8)}function OpModalBannerComponent_button_7_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",9),i.bIt("click",(function OpModalBannerComponent_button_7_Template_button_click_0_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.buttonClicked.emit(t))})),i.nrm(1,"op-icon",10)(2,"span",11),i.k0s()}if(2&e){const e=i.XpG();i.R7$(),i.Mz_("icon-classes","button--icon ",e.actionButtonClasses,""),i.R7$(),i.Y8G("textContent",e.actionButton)}}class OpModalBannerComponent{constructor(){this.type="info",this.buttonClicked=new i.bkB}static{this.ɵfac=function OpModalBannerComponent_Factory(e){return new(e||OpModalBannerComponent)}}static{this.ɵcmp=i.VBU({type:OpModalBannerComponent,selectors:[["op-modal-banner"]],inputs:{type:"type",title:"title",subtitle:"subtitle",actionButton:"actionButton",actionButtonClasses:"actionButtonClasses"},outputs:{buttonClicked:"buttonClicked"},decls:8,vars:9,consts:[[1,"op-modal-banner",3,"ngClass"],["class","spot-icon spot-icon_info1 hidden-for-mobile",4,"ngIf"],["class","spot-icon spot-icon_warning hidden-for-mobile",4,"ngIf"],[1,"op-modal-banner--text","spot-caption"],[1,"op-modal-banner--title","spot-caption","spot-caption_bold",3,"textContent"],[1,"op-modal-banner--subtitle","hidden-for-mobile",3,"textContent"],["class","op-modal-banner--button button","type","button",3,"click",4,"ngIf"],[1,"spot-icon","spot-icon_info1","hidden-for-mobile"],[1,"spot-icon","spot-icon_warning","hidden-for-mobile"],["type","button",1,"op-modal-banner--button","button",3,"click"],[3,"icon-classes"],[1,"button--text",3,"textContent"]],template:function OpModalBannerComponent_Template(e,t){1&e&&(i.j41(0,"div",0),i.DNE(1,OpModalBannerComponent_span_1_Template,1,0,"span",1)(2,OpModalBannerComponent_span_2_Template,1,0,"span",2),i.j41(3,"p",3),i.nrm(4,"span",4)(5,"br")(6,"span",5),i.k0s(),i.DNE(7,OpModalBannerComponent_button_7_Template,3,3,"button",6),i.k0s()),2&e&&(i.x72("data-test-selector","op-modal-banner-",t.type,""),i.Mz_("ngClass","op-modal-banner_",t.type,""),i.R7$(),i.Y8G("ngIf","info"===t.type),i.R7$(),i.Y8G("ngIf","warning"===t.type),i.R7$(2),i.Y8G("textContent",t.title),i.R7$(2),i.Y8G("textContent",t.subtitle),i.R7$(),i.Y8G("ngIf",!!t.actionButton))},dependencies:[o.YU,o.bT,r.i],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-modal-banner[_ngcontent-%COMP%]{display:grid;grid-template-columns:20px auto max-content;grid-gap:1rem;align-items:center;padding:.75rem 1rem}@media only screen and (max-width: 543px){.op-modal-banner[_ngcontent-%COMP%]{grid-template-columns:auto max-content}}.op-modal-banner[_ngcontent-%COMP%]:first-child{border-top-left-radius:.25rem;border-top-right-radius:.25rem}.op-modal-banner_warning[_ngcontent-%COMP%]{background:var(--bgColor-attention-muted)}.op-modal-banner_info[_ngcontent-%COMP%]{background:var(--bgColor-accent-muted)}.op-modal-banner--button[_ngcontent-%COMP%]{margin:0}"],changeDetection:0})}}},3836:(e,t,n)=>{"use strict";n.d(t,{E:()=>OpModalOverlayComponent});var i=n(9168),o=n(19999),r=n(91817),s=n(51567),a=n(61816),l=n(51133),c=n(17732),p=n(99496),d=n(68559),u=n(60316),h=n(41497);const m=["overlay"];function OpModalOverlayComponent_button_3_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"button",4),d.bIt("click",(function OpModalOverlayComponent_button_3_Template_button_click_0_listener(t){d.eBV(e);const n=d.XpG();return d.Njj(n.close(t))})),d.nrm(1,"span",5),d.k0s()}}function OpModalOverlayComponent_ng_template_5_Template(e,t){}class OpModalOverlayComponent extends p.p{set portalOutletContainer(e){void 0!==e&&(this.portalOutlet=e,this.setupListener())}constructor(e,t,n){super(),this.modalService=e,this.I18n=t,this.cdRef=n,this.notFullscreen=!1,this.mobileTopPosition=!1,this.activeModalData$=this.modalService.activeModalData$,this.activeModalInstance$=this.modalService.activeModalInstance$}setupListener(){(0,o.z)([this.activeModalInstance$,this.activeModalData$.pipe((0,r.F)(),(0,s.p)(this.isDefaultTarget.bind(this)))]).pipe(this.untilDestroyed()).subscribe((([e,t])=>{null===e&&null===t||(null===e||null!==t?null===e&&null!==t&&this.createAndAttachPortalInstance(t):this.detachPortalInstance())}))}isDefaultTarget(e){return null===e||e.target===c.V.Default}close(e,t=!0){(t||e.currentTarget===e.target)&&this.modalService.close()}detachPortalInstance(){const e=this.portalOutlet.attachedRef;e&&e.instance.onClose()&&(e.instance.closingEvent.emit(e.instance),this.portalOutlet.detach(),this.modalService.activeModalInstance$.next(null))}createAndAttachPortalInstance(e){const{modal:t,injector:n,notFullscreen:o,mobileTopPosition:r}=e;this.notFullscreen=o,this.mobileTopPosition=r;const s=new i.A8(t,null,n),a=this.portalOutlet.attach(s).instance;this.modalService.activeModalInstance$.next(a),this.cdRef.detectChanges(),this.overlay.nativeElement.focus(),a&&a.onOpen()}static{this.ɵfac=function OpModalOverlayComponent_Factory(e){return new(e||OpModalOverlayComponent)(d.rXU(l.a),d.rXU(a.W),d.rXU(d.gRc))}}static{this.ɵcmp=d.VBU({type:OpModalOverlayComponent,selectors:[["opce-modal-overlay"]],viewQuery:function OpModalOverlayComponent_Query(e,t){if(1&e&&(d.GBs(i.I3,5),d.GBs(m,7)),2&e){let e;d.mGM(e=d.lsd())&&(t.portalOutletContainer=e.first),d.mGM(e=d.lsd())&&(t.overlay=e.first)}},features:[d.Vt3],decls:6,vars:12,consts:[["overlay",""],["tabindex","0","cdkFocusInitial","","cdkTrapFocus","","role","dialog","aria-modal","true","aria-labelledby","spotModalTitle",1,"spot-modal-overlay",3,"mousedown","cdkTrapFocusAutoCapture"],["type","button","class","spot-button spot-modal-overlay--close-button",3,"click",4,"ngIf"],["cdkPortalOutlet",""],["type","button",1,"spot-button","spot-modal-overlay--close-button",3,"click"],[1,"spot-icon","spot-icon_close"]],template:function OpModalOverlayComponent_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"div",1,0),d.nI1(2,"async"),d.bIt("mousedown",(function OpModalOverlayComponent_Template_div_mousedown_0_listener(n){return d.eBV(e),d.Njj(t.close(n,!1))})),d.DNE(3,OpModalOverlayComponent_button_3_Template,2,0,"button",2),d.nI1(4,"async"),d.DNE(5,OpModalOverlayComponent_ng_template_5_Template,0,0,"ng-template",3),d.k0s()}if(2&e){let e;d.AVh("spot-modal-overlay_active",null!==d.bMT(2,8,t.activeModalInstance$))("spot-modal-overlay_not-full-screen",t.notFullscreen)("spot-modal-overlay_top",t.mobileTopPosition),d.Y8G("cdkTrapFocusAutoCapture",!0),d.R7$(3),d.Y8G("ngIf",!1!==(null==(e=d.bMT(4,10,t.activeModalInstance$))?null:e.showCloseButton))}},dependencies:[u.bT,i.I3,h.kB,u.Jj],encapsulation:2,changeDetection:0})}}},80481:(e,t,n)=>{"use strict";n.d(t,{A:()=>OpModalWrapperAugmentService});var i=n(60316),o=n(51133),r=n(71116),s=n(68559);class OpModalWrapperAugmentService{constructor(e,t,n){this.documentElement=e,this.injector=t,this.opModalService=n,e.addEventListener("turbo:before-render",(()=>n.close()))}setupListener(){const e=this.documentElement.querySelectorAll("[data-augmented-model-wrapper]");for(let t=0;t<e.length;++t)this.wrapElement(jQuery(e[t]))}wrapElement(e){const t=e.data("activationSelector")||".modal-delivery-element--activation-link",n=jQuery(t);e.data("modalInitializeNow")?this.show(e):n.click((t=>{this.show(e),t.preventDefault()}))}show(e){const t=e.data("modalClassName"),n=e.data("modalIframeUrl"),i=e.find(".modal-delivery-element");let o=i.html();n&&(o=this.appendIframe(i,n)),this.opModalService.show(r.T,this.injector,{modalBody:o,modalClassName:t})}appendIframe(e,t){const n=jQuery('<iframe frameborder="0" height="350" allowfullscreen>></iframe>');n.attr("src",t);const i=e.find(".iframe-target-wrapper");return i.find("iframe").length>0||i.append(n),e.html()}static{this.ɵfac=function OpModalWrapperAugmentService_Factory(e){return new(e||OpModalWrapperAugmentService)(s.KVO(i.qQ),s.KVO(s.zZn),s.KVO(o.a))}}static{this.ɵprov=s.jDH({token:OpModalWrapperAugmentService,factory:OpModalWrapperAugmentService.ɵfac,providedIn:"root"})}}},69081:(e,t,n)=>{"use strict";n.d(t,{a:()=>OpModalComponent});var i=n(68559),o=n(99496),r=n(51133),s=n(46227);class OpModalComponent extends o.p{constructor(e,t,n){super(),this.locals=e,this.cdRef=t,this.elementRef=n,this.service=this.locals.service,this.closingEvent=new i.bkB,this.openingEvent=new i.bkB,this.showCloseButton=!0,this.onResize=(0,s.debounce)((()=>this.updateAppHeight()),10),this.updateAppHeight=()=>document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)}ngOnInit(){this.$element=this.elementRef.nativeElement}ngOnDestroy(){this.closingEvent.complete(),this.openingEvent.complete(),window.removeEventListener("resize",this.onResize),window.removeEventListener("orientationchange",this.onResize)}onClose(){return this.afterFocusOn&&this.afterFocusOn.focus(),!0}closeMe(e){this.service.close(),e&&(e.stopPropagation(),e.preventDefault())}onOpen(){this.openingEvent.emit(),this.updateAppHeight(),this.cdRef.detectChanges(),window.addEventListener("resize",this.onResize),window.addEventListener("orientationchange",this.onResize)}get afterFocusOn(){return this.$element}static{this.ɵfac=function OpModalComponent_Factory(e){return new(e||OpModalComponent)(i.rXU(r.Y),i.rXU(i.gRc),i.rXU(i.aKT))}}static{this.ɵdir=i.FsC({type:OpModalComponent,features:[i.Vt3]})}}},21452:(e,t,n)=>{"use strict";n.d(t,{p:()=>OpenprojectModalModule});var i=n(9168),o=n(41497),r=n(78906),s=n(17136),a=n(80481),l=n(42225),c=n(3836),p=n(60316),d=n(46786),u=n(68559);class OpenprojectModalModule{static{this.ɵfac=function OpenprojectModalModule_Factory(e){return new(e||OpenprojectModalModule)}}static{this.ɵmod=u.$C({type:OpenprojectModalModule})}static{this.ɵinj=u.G2t({providers:[a.A],imports:[p.MD,r.j,s.o,i.jc,o.Pd]})}}("undefined"==typeof ngJitMode||ngJitMode)&&u.Obh(OpenprojectModalModule,{declarations:[l.O,c.E,d.l],imports:[p.MD,r.j,s.o,i.jc,o.Pd],exports:[c.E,d.l,l.O]})},51133:(e,t,n)=>{"use strict";n.d(t,{Y:()=>c,a:()=>OpModalService});var i=n(9168),o=n(68559),r=n(75797),s=n(51567),a=n(64334),l=n(17732);const c=new o.nKC("OP_MODAL_LOCALS");class OpModalService{constructor(e){this.injector=e,this.activeModalInstance$=new r.t(null),this.activeModalData$=new r.t(null),window.addEventListener("keydown",(e=>{"Escape"!==e.key||e.defaultPrevented||this.close()}))}showIfNotActive(e,t,n={},i=!1,o=!1,r=l.V.Default){return this.activeModalInstance$.value?null:this.show(e,t,n,i,o,r)}show(e,t,n={},i=!1,o=!1,r=l.V.Default){return this.close(),"global"===t&&(t=this.injector),this.activeModalData$.next({modal:e,injector:this.injectorFor(t,n),notFullscreen:i,mobileTopPosition:o,target:r}),this.activeModalInstance$.pipe((0,s.p)((t=>t instanceof e)),(0,a.s)(1))}close(){this.activeModalData$.next(null)}injectorFor(e,t){const n=new WeakMap;return t.service=this,n.set(c,t),new i.JP(e,n)}static{this.ɵfac=function OpModalService_Factory(e){return new(e||OpModalService)(o.KVO(o.zZn))}}static{this.ɵprov=o.jDH({token:OpModalService,factory:OpModalService.ɵfac,providedIn:"root"})}}},17732:(e,t,n)=>{"use strict";var i;n.d(t,{V:()=>i}),function(e){e[e.Default=1]="Default",e[e.Custom=2]="Custom"}(i||(i={}))},76790:(e,t,n)=>{"use strict";n.d(t,{B:()=>ConfirmDialogModalComponent});var i=n(69081),o=n(51133),r=n(61816),s=n(68559),a=n(60316),l=n(41497);function ConfirmDialogModalComponent_div_3_Template(e,t){1&e&&s.nrm(0,"div",13)}function ConfirmDialogModalComponent_ng_container_6_li_3_Template(e,t){if(1&e&&(s.j41(0,"li",16)(1,"span"),s.EFF(2),s.k0s()()),2&e){const e=t.$implicit;s.R7$(2),s.JRh(e)}}function ConfirmDialogModalComponent_ng_container_6_Template(e,t){if(1&e&&(s.qex(0),s.nrm(1,"span",5),s.j41(2,"ul",14),s.DNE(3,ConfirmDialogModalComponent_ng_container_6_li_3_Template,3,1,"li",15),s.k0s(),s.bVm()),2&e){const e=s.XpG();s.R7$(),s.Y8G("textContent",e.listTitle),s.R7$(2),s.Y8G("ngForOf",e.passedData)}}function ConfirmDialogModalComponent_ng_template_7_span_0_Template(e,t){if(1&e&&(s.j41(0,"span",16),s.nrm(1,"br"),s.j41(2,"strong"),s.EFF(3),s.k0s()()),2&e){const e=t.$implicit;s.R7$(3),s.JRh(e)}}function ConfirmDialogModalComponent_ng_template_7_Template(e,t){if(1&e&&s.DNE(0,ConfirmDialogModalComponent_ng_template_7_span_0_Template,4,1,"span",15),2&e){const e=s.XpG();s.Y8G("ngForOf",e.passedData)}}function ConfirmDialogModalComponent_span_13_Template(e,t){if(1&e&&s.nrm(0,"span"),2&e){const e=t.ngIf;s.ZvI("spot-icon spot-icon_",e,"")}}function ConfirmDialogModalComponent_span_17_Template(e,t){if(1&e&&s.nrm(0,"span"),2&e){const e=t.ngIf;s.ZvI("spot-icon spot-icon_",e,"")}}class ConfirmDialogModalComponent extends i.a{constructor(e,t,n,i){super(t,n,e),this.elementRef=e,this.locals=t,this.cdRef=n,this.I18n=i,this.confirmed=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text"),button_continue:this.I18n.t("js.button_continue"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.icon={continue:void 0,cancel:void 0},this.options=t.options||{},this.dangerHighlighting=_.defaultTo(this.options.dangerHighlighting,!1),this.showListData=_.defaultTo(this.options.showListData,!1),this.refreshOnCancel=_.defaultTo(this.options.refreshOnCancel,!1),this.listTitle=_.defaultTo(this.options.listTitle,""),this.warningText=_.defaultTo(this.options.warningText,""),this.passedData=_.defaultTo(this.options.passedData,[]),this.showClose=_.defaultTo(this.options.showClose,!0),this.divideContent=_.defaultTo(this.options.divideContent,!1),this.text=_.defaults(this.options.text,this.text),this.icon=_.defaults(this.options.icon,this.icon)}confirmAndClose(e){this.confirmed=!0,this.closeMe(e)}close(e){this.closeMe(e),this.refreshOnCancel&&window.location.reload()}static{this.ɵfac=function ConfirmDialogModalComponent_Factory(e){return new(e||ConfirmDialogModalComponent)(s.rXU(s.aKT),s.rXU(o.Y),s.rXU(s.gRc),s.rXU(r.W))}}static{this.ɵcmp=s.VBU({type:ConfirmDialogModalComponent,selectors:[["ng-component"]],features:[s.Vt3],decls:20,vars:12,consts:[["showData",""],["data-indicator-name","modal","tabindex","0","cdkFocusInitial","","cdkTrapFocus","",1,"spot-modal","op-confirm-dialog","loading-indicator--location",3,"cdkTrapFocusAutoCapture"],["id","spotModalTitle",1,"spot-modal--header"],["class","spot-divider",4,"ngIf"],[1,"spot-modal--body","spot-container"],[1,"op-confirm-dialog--text","spot-body-small",3,"textContent"],[4,"ngIf","ngIfElse"],[1,"op-confirm-dialog--text","spot-body-small",3,"innerHtml"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button","data-test-selector","confirmation-modal--cancel",1,"button","spot-modal--cancel-button","spot-action-bar--action",3,"click"],[3,"class",4,"ngIf"],["type","button","data-test-selector","confirmation-modal--confirmed",1,"button","spot-action-bar--action",3,"click","ngClass"],[1,"spot-divider"],[1,"op-confirm-dialog--list"],["class","spot-body-small",4,"ngFor","ngForOf"],[1,"spot-body-small"]],template:function ConfirmDialogModalComponent_Template(e,t){if(1&e){const e=s.RV6();s.j41(0,"div",1)(1,"div",2),s.EFF(2),s.k0s(),s.DNE(3,ConfirmDialogModalComponent_div_3_Template,1,0,"div",3),s.j41(4,"div",4),s.nrm(5,"span",5),s.DNE(6,ConfirmDialogModalComponent_ng_container_6_Template,4,2,"ng-container",6)(7,ConfirmDialogModalComponent_ng_template_7_Template,1,1,"ng-template",null,0,s.C5r),s.nrm(9,"span",7),s.k0s(),s.j41(10,"div",8)(11,"div",9)(12,"button",10),s.bIt("click",(function ConfirmDialogModalComponent_Template_button_click_12_listener(n){return s.eBV(e),s.Njj(t.close(n))})),s.DNE(13,ConfirmDialogModalComponent_span_13_Template,1,3,"span",11),s.j41(14,"span"),s.EFF(15),s.k0s()(),s.j41(16,"button",12),s.bIt("click",(function ConfirmDialogModalComponent_Template_button_click_16_listener(n){return s.eBV(e),s.Njj(t.confirmAndClose(n))})),s.DNE(17,ConfirmDialogModalComponent_span_17_Template,1,3,"span",11),s.j41(18,"span"),s.EFF(19),s.k0s()()()()()}if(2&e){const e=s.sdS(8);s.Y8G("cdkTrapFocusAutoCapture",!0),s.R7$(2),s.JRh(t.text.title),s.R7$(),s.Y8G("ngIf",t.divideContent),s.R7$(2),s.Y8G("textContent",t.text.text),s.R7$(),s.Y8G("ngIf",t.showListData)("ngIfElse",e),s.R7$(3),s.Y8G("innerHtml",t.warningText,s.npT),s.R7$(4),s.Y8G("ngIf",t.icon.cancel),s.R7$(2),s.JRh(t.text.button_cancel),s.R7$(),s.Y8G("ngClass",t.dangerHighlighting?"-danger":"-primary"),s.R7$(),s.Y8G("ngIf",t.icon.continue),s.R7$(2),s.JRh(t.text.button_continue)}},dependencies:[a.YU,a.Sq,a.bT,l.kB],styles:[".op-confirm-dialog--text[_ngcontent-%COMP%]{white-space:pre-wrap}.op-confirm-dialog--list[_ngcontent-%COMP%]{margin-left:var(--list-side-margin)!important}"],changeDetection:0})}}},48908:(e,t,n)=>{"use strict";n.d(t,{g:()=>ConfirmDialogService});var i=n(76790),o=n(51133),r=n(68559);class ConfirmDialogService{constructor(e,t){this.opModalService=e,this.injector=t,document.addEventListener("submit",(e=>{const t=e.target,n=t.dataset.augmentedConfirmDialog;return!n||(this.augmentFormSubmit(t,JSON.parse(n)),e.preventDefault(),!1)}))}confirm(e){return new Promise(((t,n)=>{this.opModalService.show(i.B,this.injector,{options:e}).subscribe((e=>e.closingEvent.subscribe((()=>{e.confirmed?t():n()}))))}))}augmentFormSubmit(e,t){this.confirm(t).then((()=>{e.removeAttribute("data-augmented-confirm-dialog"),e.submit()})).catch((()=>{}))}static{this.ɵfac=function ConfirmDialogService_Factory(e){return new(e||ConfirmDialogService)(r.KVO(o.a),r.KVO(r.zZn))}}static{this.ɵprov=r.jDH({token:ConfirmDialogService,factory:ConfirmDialogService.ɵfac})}}},20666:(e,t,n)=>{"use strict";n.d(t,{K:()=>EditorMacrosService});var i=n(51133),o=n(37330),r=n(97306),s=n(94370),a=n(49410),l=n(17732),c=n(68559);class EditorMacrosService{constructor(e,t){this.opModalService=e,this.injector=t}configureWorkPackageButton(e,t){return new Promise(((n,i)=>{this.opModalService.show(o.G,this.injector,{type:e,classes:t}).subscribe((e=>e.closingEvent.subscribe((()=>{e.changed&&n({type:e.type,classes:e.classes})}))))}))}configureWikiPageInclude(e){return new Promise(((t,n)=>{const i=e||"";this.opModalService.show(r.G,this.injector,{page:i}).subscribe((e=>e.closingEvent.subscribe((()=>{e.changed&&t(e.page)}))))}))}editCodeBlock(e,t){return new Promise(((n,i)=>{const o=document.querySelector("opce-custom-modal-overlay")?l.V.Custom:l.V.Default;this.opModalService.show(s.l,this.injector,{content:e,languageClass:t},!1,!1,o).subscribe((e=>e.closingEvent.subscribe((()=>{e.changed&&n({languageClass:e.languageClass,content:e.content})}))))}))}configureChildPages(e,t){return new Promise(((n,i)=>{this.opModalService.show(a.v,this.injector,{page:e,includeParent:t}).subscribe((e=>e.closingEvent.subscribe((()=>{e.changed&&n({page:e.page,includeParent:e.includeParent})}))))}))}static{this.ɵfac=function EditorMacrosService_Factory(e){return new(e||EditorMacrosService)(c.KVO(i.a),c.KVO(c.zZn))}}static{this.ɵprov=c.jDH({token:EditorMacrosService,factory:EditorMacrosService.ɵfac})}}},49410:(e,t,n)=>{"use strict";n.d(t,{v:()=>ChildPagesMacroModalComponent});var i=n(69081),o=n(51133),r=n(61816),s=n(68559),a=n(34456);const l=["selectedPageInput"];class ChildPagesMacroModalComponent extends i.a{constructor(e,t,n,i){super(t,n,e),this.elementRef=e,this.locals=t,this.cdRef=n,this.I18n=i,this.changed=!1,this.showClose=!0,this.page="",this.includeParent=!1,this.text={title:this.I18n.t("js.editor.macro.child_pages.button"),hint:this.I18n.t("js.editor.macro.child_pages.hint"),page:this.I18n.t("js.editor.macro.child_pages.page"),include_parent:this.I18n.t("js.editor.macro.child_pages.include_parent"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.selectedPage=this.page=this.locals.page,this.selectedIncludeParent=this.includeParent=this.locals.includeParent}applyAndClose(e){this.changed=!0,this.page=this.selectedPage,this.includeParent=this.selectedIncludeParent,this.closeMe(e)}ngAfterViewInit(){this.selectedPageInput.nativeElement.focus()}updateIncludeParent(e){this.selectedIncludeParent=e}static{this.ɵfac=function ChildPagesMacroModalComponent_Factory(e){return new(e||ChildPagesMacroModalComponent)(s.rXU(s.aKT),s.rXU(o.Y),s.rXU(s.gRc),s.rXU(r.W))}}static{this.ɵcmp=s.VBU({type:ChildPagesMacroModalComponent,selectors:[["ng-component"]],viewQuery:function ChildPagesMacroModalComponent_Query(e,t){if(1&e&&s.GBs(l,7),2&e){let e;s.mGM(e=s.lsd())&&(t.selectedPageInput=e.first)}},features:[s.Vt3],decls:25,vars:9,consts:[["selectedPageInput",""],["parentIncludedInput",""],[1,"spot-modal",3,"submit"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"spot-modal--body","spot-container","form"],[1,"form--fieldset"],[3,"textContent"],[1,"form--field"],["for","selected-page",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["tabindex","2","type","text","id","selected-page","name","selected-page","placeholder","my-project:my-page",1,"form--select",3,"change","value"],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["tabindex","3","type","checkbox","id","include-parent","name","include-parent",1,"form--check-box",3,"ngModelChange","ngModel"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button","tabindex","4",1,"spot-modal--cancel-button","button","button_no-margin","spot-action-bar--action",3,"click","textContent"],["tabindex","3",1,"spot-modal--submit-button","button","button_no-margin","-primary","spot-action-bar--action",3,"textContent"]],template:function ChildPagesMacroModalComponent_Template(e,t){if(1&e){const e=s.RV6();s.j41(0,"form",2),s.bIt("submit",(function ChildPagesMacroModalComponent_Template_form_submit_0_listener(n){return s.eBV(e),s.Njj(t.applyAndClose(n))})),s.j41(1,"div",3),s.EFF(2),s.k0s(),s.nrm(3,"div",4),s.j41(4,"div",5)(5,"fieldset",6),s.nrm(6,"legend",7),s.j41(7,"div",8),s.nrm(8,"label",9),s.j41(9,"div",10)(10,"div",11)(11,"input",12,0),s.bIt("change",(function ChildPagesMacroModalComponent_Template_input_change_11_listener(n){return s.eBV(e),s.Njj(t.selectedPage=n.target.value)})),s.k0s()()()(),s.j41(13,"div",8)(14,"div",10)(15,"label",13)(16,"div",14)(17,"input",15,1),s.bIt("ngModelChange",(function ChildPagesMacroModalComponent_Template_input_ngModelChange_17_listener(n){return s.eBV(e),s.Njj(t.updateIncludeParent(n))})),s.k0s()(),s.EFF(19),s.k0s()()(),s.nrm(20,"p",7),s.k0s()(),s.j41(21,"div",16)(22,"div",17)(23,"button",18),s.bIt("click",(function ChildPagesMacroModalComponent_Template_button_click_23_listener(n){return s.eBV(e),s.Njj(t.closeMe(n))})),s.k0s(),s.nrm(24,"button",19),s.k0s()()()}2&e&&(s.R7$(2),s.JRh(t.text.title),s.R7$(4),s.Y8G("textContent",t.text.page),s.R7$(2),s.Y8G("textContent",t.text.page),s.R7$(3),s.Y8G("value",t.selectedPage),s.R7$(6),s.Y8G("ngModel",t.selectedIncludeParent),s.R7$(2),s.SpI(" ",t.text.include_parent," "),s.R7$(),s.Y8G("textContent",t.text.hint),s.R7$(3),s.Y8G("textContent",t.text.button_cancel),s.R7$(),s.Y8G("textContent",t.text.button_save))},dependencies:[a.qT,a.Zm,a.BC,a.cb,a.vS,a.cV],encapsulation:2})}}},94370:(e,t,n)=>{"use strict";n.d(t,{l:()=>CodeBlockMacroModalComponent});var i=n(69081),o=n(51133),r=n(61816),s=n(68559),a=n(34456);const l=["codeMirrorPane"];class CodeBlockMacroModalComponent extends i.a{constructor(e,t,n,i){super(t,n,e),this.elementRef=e,this.locals=t,this.cdRef=n,this.I18n=i,this.changed=!1,this.showClose=!0,this._language="",this.debouncedLanguageLoader=_.debounce((()=>this.loadLanguageAsMode(this.language)),300),this.text={title:this.I18n.t("js.editor.macro.code_block.title"),language:this.I18n.t("js.editor.macro.code_block.language"),language_hint:this.I18n.t("js.editor.macro.code_block.language_hint"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.languageClass=t.languageClass||"language-text",this.content=t.content;const o=/language-(\w+)/.exec(this.languageClass);this.language=o?o[1]:"text"}applyAndClose(e){this.content=this.codeMirrorInstance.getValue();const t=this.language||"text";this.languageClass=`language-${t}`,this.changed=!0,this.closeMe(e)}ngAfterViewInit(){n.e("default-node_modules_codemirror_lib_codemirror_js").then(n.t.bind(n,81273,23)).then((e=>{const t=e.default;this.codeMirrorInstance=t.fromTextArea(this.codeMirrorPane.nativeElement,{lineNumbers:!0,smartIndent:!0,autofocus:!0,value:this.content,mode:""})}))}get language(){return this._language}set language(e){this._language=e,this.debouncedLanguageLoader()}loadLanguageAsMode(e){if(!e||"text"===e)return this.updateCodeMirrorMode("");n(69497)(`./${e}/${e}.js`).then((()=>{this.updateCodeMirrorMode(e)})).catch((t=>{console.error(`Failed to load language ${e}: ${t}`),this.updateCodeMirrorMode("")}))}updateCodeMirrorMode(e){const t=this.codeMirrorInstance;t&&t.setOption("mode",e)}updateLanguage(e){e?/^\w+$/.exec(e)?this.language=e:console.error(`Not updating non-matching language: ${e}`):this.language=""}static{this.ɵfac=function CodeBlockMacroModalComponent_Factory(e){return new(e||CodeBlockMacroModalComponent)(s.rXU(s.aKT),s.rXU(o.Y),s.rXU(s.gRc),s.rXU(r.W))}}static{this.ɵcmp=s.VBU({type:CodeBlockMacroModalComponent,selectors:[["ng-component"]],viewQuery:function CodeBlockMacroModalComponent_Query(e,t){if(1&e&&s.GBs(l,7),2&e){let e;s.mGM(e=s.lsd())&&(t.codeMirrorPane=e.first)}},features:[s.Vt3],decls:19,vars:7,consts:[["codeMirrorPane",""],["selectedLanguage",""],[1,"spot-modal",3,"submit"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"spot-modal--body","spot-container"],["name","codemirror-element","id","codemirror-element",3,"ngModel"],[1,"form--field"],["for","selected-language",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["tabindex","2","type","text","id","selected-language","name","selected-language",1,"form--select",3,"ngModelChange","ngModel"],[3,"textContent"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["tabindex","4","type","button",1,"spot-modal--cancel-button","button","button_no-margin","spot-action-bar--action",3,"click","textContent"],["tabindex","3",1,"spot-modal--submit-button","button","button_no-margin","-primary","spot-action-bar--action",3,"textContent"]],template:function CodeBlockMacroModalComponent_Template(e,t){if(1&e){const e=s.RV6();s.j41(0,"form",2),s.bIt("submit",(function CodeBlockMacroModalComponent_Template_form_submit_0_listener(n){return s.eBV(e),s.Njj(t.applyAndClose(n))})),s.j41(1,"div",3),s.EFF(2),s.k0s(),s.nrm(3,"div",4),s.j41(4,"div",5),s.nrm(5,"textarea",6,0)(7,"hr"),s.j41(8,"div",7),s.nrm(9,"label",8),s.j41(10,"div",9)(11,"div",10)(12,"input",11,1),s.bIt("ngModelChange",(function CodeBlockMacroModalComponent_Template_input_ngModelChange_12_listener(n){return s.eBV(e),s.Njj(t.updateLanguage(n))})),s.k0s()()(),s.nrm(14,"p",12),s.k0s()(),s.j41(15,"div",13)(16,"div",14)(17,"button",15),s.bIt("click",(function CodeBlockMacroModalComponent_Template_button_click_17_listener(n){return s.eBV(e),s.Njj(t.closeMe(n))})),s.k0s(),s.nrm(18,"button",16),s.k0s()()()}2&e&&(s.R7$(2),s.JRh(t.text.title),s.R7$(3),s.Y8G("ngModel",t.content),s.R7$(4),s.Y8G("textContent",t.text.language),s.R7$(3),s.Y8G("ngModel",t.language),s.R7$(2),s.Y8G("textContent",t.text.language_hint),s.R7$(3),s.Y8G("textContent",t.text.button_cancel),s.R7$(),s.Y8G("textContent",t.text.button_save))},dependencies:[a.qT,a.me,a.BC,a.cb,a.vS,a.cV],encapsulation:2})}}},97306:(e,t,n)=>{"use strict";n.d(t,{G:()=>WikiIncludePageMacroModalComponent});var i=n(69081),o=n(51133),r=n(61816),s=n(68559),a=n(34456);const l=["selectedPageInput"];class WikiIncludePageMacroModalComponent extends i.a{constructor(e,t,n,i){super(t,n,e),this.elementRef=e,this.locals=t,this.cdRef=n,this.I18n=i,this.changed=!1,this.showClose=!0,this.page="",this.text={title:this.I18n.t("js.editor.macro.wiki_page_include.button"),hint:this.I18n.t("js.editor.macro.wiki_page_include.hint"),page:this.I18n.t("js.editor.macro.wiki_page_include.page"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.selectedPage=this.page=this.locals.page}applyAndClose(e){this.changed=!0,this.page=this.selectedPage,this.closeMe(e)}ngAfterViewInit(){this.selectedPageInput.nativeElement.focus()}static{this.ɵfac=function WikiIncludePageMacroModalComponent_Factory(e){return new(e||WikiIncludePageMacroModalComponent)(s.rXU(s.aKT),s.rXU(o.Y),s.rXU(s.gRc),s.rXU(r.W))}}static{this.ɵcmp=s.VBU({type:WikiIncludePageMacroModalComponent,selectors:[["ng-component"]],viewQuery:function WikiIncludePageMacroModalComponent_Query(e,t){if(1&e&&s.GBs(l,7),2&e){let e;s.mGM(e=s.lsd())&&(t.selectedPageInput=e.first)}},features:[s.Vt3],decls:21,vars:9,consts:[["selectedPageInput",""],[1,"spot-modal",3,"submit"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"spot-modal--body","spot-container"],[1,"form--fieldset"],[3,"textContent"],[1,"form--field"],["for","selected-page",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["tabindex","2","type","text","id","selected-page","name","selected-page",1,"form--select",3,"change","value"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["tabindex","4",1,"spot-modal--cancel-button","button","button_no-margin","spot-action-bar--action",3,"click","textContent"],["tabindex","3",1,"spot-modal--submit-button","button","button_no-margin","-primary","spot-action-bar--action",3,"click","textContent"]],template:function WikiIncludePageMacroModalComponent_Template(e,t){if(1&e){const e=s.RV6();s.j41(0,"form",1),s.bIt("submit",(function WikiIncludePageMacroModalComponent_Template_form_submit_0_listener(n){return s.eBV(e),s.Njj(t.applyAndClose(n))})),s.j41(1,"div",2),s.EFF(2),s.k0s(),s.nrm(3,"div",3),s.j41(4,"div",4)(5,"fieldset",5),s.nrm(6,"legend",6),s.j41(7,"div",7),s.nrm(8,"label",8),s.j41(9,"div",9)(10,"div",10)(11,"input",11,0),s.bIt("change",(function WikiIncludePageMacroModalComponent_Template_input_change_11_listener(n){return s.eBV(e),s.Njj(t.selectedPage=n.target.value)})),s.k0s()()(),s.nrm(13,"p",6),s.j41(14,"p")(15,"kbd"),s.EFF(16,"project-identifier:my-wiki-page"),s.k0s()()()()(),s.j41(17,"div",12)(18,"div",13)(19,"button",14),s.bIt("click",(function WikiIncludePageMacroModalComponent_Template_button_click_19_listener(n){return s.eBV(e),s.Njj(t.closeMe(n))})),s.k0s(),s.j41(20,"button",15),s.bIt("click",(function WikiIncludePageMacroModalComponent_Template_button_click_20_listener(n){return s.eBV(e),s.Njj(t.applyAndClose(n))})),s.k0s()()()()}2&e&&(s.R7$(2),s.JRh(t.text.title),s.R7$(4),s.Y8G("textContent",t.text.page),s.R7$(2),s.Y8G("textContent",t.text.page),s.R7$(3),s.Y8G("value",t.selectedPage),s.R7$(2),s.Y8G("textContent",t.text.hint),s.R7$(6),s.Y8G("textContent",t.text.button_cancel),s.BMQ("title",t.text.button_cancel),s.R7$(),s.Y8G("textContent",t.text.button_save),s.BMQ("title",t.text.button_save))},dependencies:[a.qT,a.cb,a.cV],encapsulation:2})}}},37330:(e,t,n)=>{"use strict";n.d(t,{G:()=>WpButtonMacroModalComponent});var i=n(69081),o=n(51133),r=n(61816),s=n(86866),a=n(14593),l=n(68559),c=n(60316),p=n(34456);const d=["typeSelect"];function WpButtonMacroModalComponent_option_14_Template(e,t){if(1&e&&l.nrm(0,"option",12),2&e){const e=t.$implicit,n=l.XpG();l.Y8G("textContent",e.name)("selected",n.selectedType===e.name)("value",e.name)}}class WpButtonMacroModalComponent extends i.a{constructor(e,t,n,i,o,r){super(t,o,e),this.elementRef=e,this.locals=t,this.currentProject=n,this.apiV3Service=i,this.cdRef=o,this.I18n=r,this.changed=!1,this.showClose=!0,this.type="",this.classes="",this.text={title:this.I18n.t("js.editor.macro.work_package_button.button"),none:this.I18n.t("js.label_none"),selected_type:this.I18n.t("js.editor.macro.work_package_button.type"),button_style:this.I18n.t("js.editor.macro.work_package_button.button_style"),button_style_hint:this.I18n.t("js.editor.macro.work_package_button.button_style_hint"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.selectedType=this.type=this.locals.type,this.classes=this.locals.classes,this.buttonStyle="button"===this.classes,this.apiV3Service.withOptionalProject(this.currentProject.identifier).work_packages.form.post({}).subscribe((e=>{this.availableTypes=e.schema.type.allowedValues,this.cdRef.detectChanges()}))}applyAndClose(e){this.changed=!0,this.classes=this.buttonStyle?"button":"",this.type=this.selectedType,this.closeMe(e)}ngAfterViewInit(){this.typeSelect.nativeElement.focus()}static{this.ɵfac=function WpButtonMacroModalComponent_Factory(e){return new(e||WpButtonMacroModalComponent)(l.rXU(l.aKT),l.rXU(o.Y),l.rXU(s.c),l.rXU(a.n),l.rXU(l.gRc),l.rXU(r.W))}}static{this.ɵcmp=l.VBU({type:WpButtonMacroModalComponent,selectors:[["ng-component"]],viewQuery:function WpButtonMacroModalComponent_Query(e,t){if(1&e&&l.GBs(d,7),2&e){let e;l.mGM(e=l.lsd())&&(t.typeSelect=e.first)}},features:[l.Vt3],decls:26,vars:11,consts:[["typeSelect",""],["data-indicator-name","modal",1,"spot-modal","spot-modal_autoheight","loading-indicator--location",3,"submit"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"spot-modal--body","spot-container","form"],[1,"form--fieldset"],[3,"textContent"],[1,"form--field"],["for","selected-type",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["id","selected-type","tabindex","1","name","selected-type",1,"form--select",3,"change"],[3,"textContent","selected","value"],[3,"textContent","selected","value",4,"ngFor","ngForOf"],[1,"form--field","-wide-label"],[1,"form--field-container","-vertical"],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["type","checkbox","tabindex","2","id","wp_button_macro_style","name","button_style",3,"change","checked"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["tabindex","4","type","button",1,"spot-modal--cancel-button","button","button_no-margin","spot-action-bar--action",3,"click","textContent"],["tabindex","3",1,"spot-modal--submit-button","button","button_no-margin","-primary","spot-action-bar--action",3,"textContent"]],template:function WpButtonMacroModalComponent_Template(e,t){if(1&e){const e=l.RV6();l.j41(0,"form",1),l.bIt("submit",(function WpButtonMacroModalComponent_Template_form_submit_0_listener(n){return l.eBV(e),l.Njj(t.applyAndClose(n))})),l.j41(1,"div",2),l.EFF(2),l.k0s(),l.nrm(3,"div",3),l.j41(4,"div",4)(5,"fieldset",5),l.nrm(6,"legend",6),l.j41(7,"div",7),l.nrm(8,"label",8),l.j41(9,"div",9)(10,"div",10)(11,"select",11,0),l.bIt("change",(function WpButtonMacroModalComponent_Template_select_change_11_listener(n){return l.eBV(e),l.Njj(t.selectedType=n.target.value)})),l.nrm(13,"option",12),l.DNE(14,WpButtonMacroModalComponent_option_14_Template,1,3,"option",13),l.k0s()()()()(),l.j41(15,"div",14)(16,"div",15)(17,"label",16)(18,"div",17)(19,"input",18),l.bIt("change",(function WpButtonMacroModalComponent_Template_input_change_19_listener(n){return l.eBV(e),l.Njj(t.buttonStyle=n.target.checked)})),l.k0s()(),l.EFF(20),l.k0s()()(),l.nrm(21,"p",6),l.k0s(),l.j41(22,"div",19)(23,"div",20)(24,"button",21),l.bIt("click",(function WpButtonMacroModalComponent_Template_button_click_24_listener(n){return l.eBV(e),l.Njj(t.closeMe(n))})),l.k0s(),l.nrm(25,"button",22),l.k0s()()()}2&e&&(l.R7$(2),l.JRh(t.text.title),l.R7$(4),l.Y8G("textContent",t.text.selected_type),l.R7$(2),l.Y8G("textContent",t.text.selected_type),l.R7$(5),l.Y8G("textContent",t.text.none)("selected",!t.selectedType),l.R7$(),l.Y8G("ngForOf",t.availableTypes),l.R7$(5),l.Y8G("checked",t.buttonStyle),l.R7$(),l.SpI(" ",t.text.button_style," "),l.R7$(),l.Y8G("textContent",t.text.button_style_hint),l.R7$(3),l.Y8G("textContent",t.text.button_cancel),l.R7$(),l.Y8G("textContent",t.text.button_save))},dependencies:[c.Sq,p.qT,p.xH,p.y7,p.cb,p.cV],encapsulation:2,changeDetection:0})}}},46635:(e,t,n)=>{"use strict";n.d(t,{Z:()=>QueryGetIcalUrlModalComponent});var i=n(95445),o=n(13432),r=n(40358),s=n(72650),a=n(69081),l=n(51133),c=n(34456),p=n(61816),d=n(11048),u=n(14593),h=n(36777),m=n(68559),g=n(60316),_=n(18240),f=n(88294),b=n(2768);function QueryGetIcalUrlModalComponent_div_14_Template(e,t){if(1&e&&(m.j41(0,"div",14),m.EFF(1),m.k0s()),2&e){const e=m.XpG();m.R7$(),m.SpI(" ",null==e.nameControl||null==e.nameControl.errors?null:e.nameControl.errors.rails," ")}}class QueryGetIcalUrlModalComponent extends a.a{get nameControl(){return this.tokenNameForm.get("name")}constructor(e,t,n,i,o,r,s,a,l,p,d){super(t,r,e),this.elementRef=e,this.locals=t,this.I18n=n,this.states=i,this.querySpace=o,this.cdRef=r,this.wpListService=s,this.halNotification=a,this.toastService=l,this.apiV3Service=p,this.copyToClipboardService=d,this.tokenName="",this.isBusy=!1,this.text={label_ical_sharing:this.I18n.t("js.ical_sharing_modal.title"),description_ical_sharing:this.I18n.t("js.ical_sharing_modal.description"),ical_sharing_warning:this.I18n.t("js.ical_sharing_modal.warning"),token_name:this.I18n.t("js.ical_sharing_modal.token_name_label"),token_name_placeholder:this.I18n.t("js.ical_sharing_modal.token_name_placeholder"),token_name_description_text:this.I18n.t("js.ical_sharing_modal.token_name_description_text"),token_name_already_in_use_error_text:this.I18n.t("js.ical_sharing_modal.token_name_already_in_use_error_text"),button_copy:this.I18n.t("js.ical_sharing_modal.copy_url_label"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.tokenNameForm=new c.J3({name:new c.hs(null,[c.k0.required])})}ngOnInit(){super.ngOnInit(),this.querySpace.query.value?this.query=this.querySpace.query.value:(this.toastService.addError(this.I18n.t("js.ical_sharing_modal.inital_setup_error_message")),setTimeout((()=>{this.closeMe()}),10))}generateAndCopyUrl(){if(this.isBusy)return;const e=this.tokenNameForm.value?.name;this.isBusy=!0;this.apiV3Service.queries.getIcalUrl(this.query,e).then((t=>{this.copyToClipboardService.copy(String(t.icalUrl.href),this.I18n.t("js.ical_sharing_modal.success_message",{name:e})),this.closeMe()})).catch((e=>{this.nameControl?.markAsDirty(),this.nameControl?.setErrors({rails:e.message}),this.cdRef.detectChanges()})).then((()=>{this.isBusy=!1}))}static{this.ɵfac=function QueryGetIcalUrlModalComponent_Factory(e){return new(e||QueryGetIcalUrlModalComponent)(m.rXU(m.aKT),m.rXU(l.Y),m.rXU(p.W),m.rXU(o.D),m.rXU(d.i),m.rXU(m.gRc),m.rXU(i.E),m.rXU(r.Y),m.rXU(s.fw),m.rXU(u.n),m.rXU(h.g))}}static{this.ɵcmp=m.VBU({type:QueryGetIcalUrlModalComponent,selectors:[["ng-component"]],features:[m.Vt3],decls:20,vars:12,consts:[[1,"spot-modal","loading-indicator--location","op-query-get-ical-url",3,"submit","formGroup"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"spot-modal--body","spot-container"],["tabindex","0",1,"-warning","op-toast"],["role","alert","aria-atomic","true",1,"op-toast--content"],["showValidationErrorOn","change",3,"label","required"],["formControlName","name","slot","input","opAutofocus","",3,"placeholder"],["slot","errors","class","spot-form-field--error",4,"ngIf"],["slot","description",3,"innerHtml"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button",1,"button","button_no-margin","spot-modal--cancel-button","spot-action-bar--action",3,"click","textContent"],["type","submit",1,"button","button_no-margin","-primary","-with-icon","icon-copy","spot-action-bar--action",3,"click","textContent","disabled"],["slot","errors",1,"spot-form-field--error"]],template:function QueryGetIcalUrlModalComponent_Template(e,t){1&e&&(m.j41(0,"form",0),m.bIt("submit",(function QueryGetIcalUrlModalComponent_Template_form_submit_0_listener(){return t.generateAndCopyUrl()})),m.j41(1,"div",1),m.EFF(2),m.k0s(),m.nrm(3,"div",2),m.j41(4,"div",3)(5,"div",4)(6,"div",5)(7,"p")(8,"span"),m.EFF(9),m.k0s()()()(),m.j41(10,"p"),m.EFF(11),m.k0s(),m.j41(12,"spot-form-field",6),m.nrm(13,"spot-text-field",7),m.DNE(14,QueryGetIcalUrlModalComponent_div_14_Template,2,1,"div",8),m.nrm(15,"span",9),m.k0s()(),m.j41(16,"div",10)(17,"div",11)(18,"button",12),m.bIt("click",(function QueryGetIcalUrlModalComponent_Template_button_click_18_listener(e){return t.closeMe(e)})),m.k0s(),m.j41(19,"button",13),m.bIt("click",(function QueryGetIcalUrlModalComponent_Template_button_click_19_listener(){return t.generateAndCopyUrl()})),m.k0s()()()()),2&e&&(m.Y8G("formGroup",t.tokenNameForm),m.R7$(2),m.JRh(t.text.label_ical_sharing),m.R7$(7),m.JRh(t.text.ical_sharing_warning),m.R7$(2),m.SpI(" ",t.text.description_ical_sharing," "),m.R7$(),m.Y8G("label",t.text.token_name)("required",!0),m.R7$(),m.Y8G("placeholder",t.text.token_name_placeholder),m.R7$(),m.Y8G("ngIf",null==t.nameControl||null==t.nameControl.errors?null:t.nameControl.errors.rails),m.R7$(),m.Y8G("innerHtml",t.text.token_name_description_text,m.npT),m.R7$(3),m.Y8G("textContent",t.text.button_cancel),m.R7$(),m.Y8G("textContent",t.text.button_copy)("disabled",t.isBusy))},dependencies:[g.bT,c.qT,c.BC,c.cb,_.l,f.U,b.B,c.j4,c.JD],encapsulation:2,changeDetection:0})}}},71116:(e,t,n)=>{"use strict";n.d(t,{T:()=>DynamicContentModalComponent});var i=n(51133),o=n(69081),r=n(61816),s=n(68559);class DynamicContentModalComponent extends o.a{constructor(e,t,n,i){super(t,n,e),this.elementRef=e,this.locals=t,this.cdRef=n,this.I18n=i}ngOnInit(){super.ngOnInit();const e=this.$element.children[0],t=this.locals.modalClassName||"";e.classList.add(...t.split(" ")),e.innerHTML=this.locals.modalBody;const n=document.querySelector(".spot-modal").querySelector("[dynamic-content-modal-close-button]");n?.addEventListener("click",(()=>this.closeMe()))}ngOnDestroy(){super.ngOnDestroy()}static{this.ɵfac=function DynamicContentModalComponent_Factory(e){return new(e||DynamicContentModalComponent)(s.rXU(s.aKT),s.rXU(i.Y),s.rXU(s.gRc),s.rXU(r.W))}}static{this.ɵcmp=s.VBU({type:DynamicContentModalComponent,selectors:[["ng-component"]],features:[s.Vt3],decls:1,vars:0,consts:[["data-indicator-name","modal",1,"spot-modal","dynamic-content-modal--wrapper","loading-indicator--location"]],template:function DynamicContentModalComponent_Template(e,t){1&e&&s.nrm(0,"div",0)},encapsulation:2,changeDetection:0})}}},78:(e,t,n)=>{"use strict";n.d(t,{l:()=>PasswordConfirmationModalComponent});var i=n(76790),o=n(68559),r=n(34456);const s=["passwordConfirmationField"];class PasswordConfirmationModalComponent extends i.B{constructor(){super(...arguments),this.password_confirmation=null,this.additionalText={field_description:I18n.t("js.password_confirmation.field_description"),confirm_button:I18n.t("js.button_confirm"),password:I18n.t("js.label_password"),cancel_button:I18n.t("js.button_cancel")}}ngOnInit(){super.ngOnInit(),this.text.title=I18n.t("js.password_confirmation.title"),this.showClose=!1}confirmAndClose(e){this.passwordValuePresent()&&super.confirmAndClose(e)}onOpen(){super.onOpen(),this.passwordConfirmationField.nativeElement.focus()}passwordValuePresent(){return null!==this.password_confirmation&&this.password_confirmation.length>0}static{this.ɵfac=(()=>{let e;return function PasswordConfirmationModalComponent_Factory(t){return(e||(e=o.xGo(PasswordConfirmationModalComponent)))(t||PasswordConfirmationModalComponent)}})()}static{this.ɵcmp=o.VBU({type:PasswordConfirmationModalComponent,selectors:[["ng-component"]],viewQuery:function PasswordConfirmationModalComponent_Query(e,t){if(1&e&&o.GBs(s,7),2&e){let e;o.mGM(e=o.lsd())&&(t.passwordConfirmationField=e.first)}},features:[o.Vt3],decls:16,vars:8,consts:[["passwordConfirmationField",""],["data-indicator-name","modal",1,"spot-modal","form","-vertical","confirm-form-submit--modal","password-confirm-dialog--modal","loading-indicator--location",3,"submit"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"spot-modal--body","spot-container","form"],[1,"form--field","-required"],["for","request_for_confirmation_password",1,"form--label","-bold",3,"textContent"],[1,"form--field-container"],[1,"form--text-field-container"],["type","password","id","request_for_confirmation_password","name","request_for_confirmation_password",1,"form--text-field",3,"ngModelChange","ngModel"],[1,"form--field-instructions",3,"textContent"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button",1,"button","button_no-margin","spot-modal--cancel-button","spot-action-bar--action",3,"click","textContent"],["type","submit","data-test-selector","confirmation-modal--confirmed",1,"button","button_no-margin","-primary","spot-action-bar--action",3,"textContent","disabled"]],template:function PasswordConfirmationModalComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"form",1),o.bIt("submit",(function PasswordConfirmationModalComponent_Template_form_submit_0_listener(n){return o.eBV(e),o.Njj(t.confirmAndClose(n))})),o.j41(1,"div",2),o.EFF(2),o.k0s(),o.nrm(3,"div",3),o.j41(4,"div",4)(5,"div",5),o.nrm(6,"label",6),o.j41(7,"div",7)(8,"div",8)(9,"input",9,0),o.mxI("ngModelChange",(function PasswordConfirmationModalComponent_Template_input_ngModelChange_9_listener(n){return o.eBV(e),o.DH7(t.password_confirmation,n)||(t.password_confirmation=n),o.Njj(n)})),o.k0s()()(),o.nrm(11,"div",10),o.k0s()(),o.j41(12,"div",11)(13,"div",12)(14,"button",13),o.bIt("click",(function PasswordConfirmationModalComponent_Template_button_click_14_listener(){return o.eBV(e),o.Njj(t.closeMe())})),o.k0s(),o.nrm(15,"button",14),o.k0s()()()}2&e&&(o.R7$(2),o.JRh(t.text.title),o.R7$(4),o.Y8G("textContent",t.additionalText.password),o.BMQ("aria-label",t.additionalText.field_description),o.R7$(3),o.R50("ngModel",t.password_confirmation),o.R7$(2),o.Y8G("textContent",t.additionalText.field_description),o.R7$(3),o.Y8G("textContent",t.additionalText.cancel_button),o.R7$(),o.Y8G("textContent",t.additionalText.confirm_button)("disabled",!t.passwordValuePresent()))},dependencies:[r.qT,r.me,r.BC,r.cb,r.vS,r.cV],encapsulation:2,changeDetection:0})}}},74311:(e,t,n)=>{"use strict";n.d(t,{g:()=>SaveQueryModalComponent});var i=n(40358),o=n(72650),r=n(69081),s=n(51133),a=n(61816),l=n(11048),c=n(95445),p=n(13432),d=n(68559),u=n(34456),h=n(7467);const m=["queryNameField"];class SaveQueryModalComponent extends r.a{constructor(e,t,n,i,o,r,s,a,l){super(t,a,e),this.elementRef=e,this.locals=t,this.I18n=n,this.states=i,this.querySpace=o,this.wpListService=r,this.halNotification=s,this.cdRef=a,this.toastService=l,this.queryName="",this.isStarred=!1,this.isPublic=!1,this.isBusy=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text"),save_as:this.I18n.t("js.label_save_as"),label_name:this.I18n.t("js.modals.label_name"),label_visibility_settings:this.I18n.t("js.label_visibility_settings"),button_save:this.I18n.t("js.modals.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")}}setValues(e){this.isStarred=e.isStarred,this.isPublic=e.isPublic}onOpen(){this.queryNameField.nativeElement.focus()}get afterFocusOn(){return document.getElementById("work-packages-settings-button")}saveQueryAs(e){if(e.preventDefault(),this.isBusy||!this.queryName)return;this.isBusy=!0;const t=this.querySpace.query.value;t.public=this.isPublic,this.wpListService.create(t,this.queryName).then((t=>this.isStarred&&!t.starred?this.wpListService.toggleStarred(t).then((()=>this.closeMe(e))):(this.closeMe(e),Promise.resolve(!0)))).catch((e=>this.halNotification.handleRawError(e))).then((()=>this.isBusy=!1))}static{this.ɵfac=function SaveQueryModalComponent_Factory(e){return new(e||SaveQueryModalComponent)(d.rXU(d.aKT),d.rXU(s.Y),d.rXU(a.W),d.rXU(p.D),d.rXU(l.i),d.rXU(c.E),d.rXU(i.Y),d.rXU(d.gRc),d.rXU(o.fw))}}static{this.ɵcmp=d.VBU({type:SaveQueryModalComponent,selectors:[["ng-component"]],viewQuery:function SaveQueryModalComponent_Query(e,t){if(1&e&&d.GBs(m,7),2&e){let e;d.mGM(e=d.lsd())&&(t.queryNameField=e.first)}},features:[d.Vt3],decls:19,vars:10,consts:[["queryNameField",""],["data-indicator-name","modal","name","modalSaveForm",1,"spot-modal","loading-indicator--location",3,"submit"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],["name","modalSaveForm",1,"spot-modal--body","spot-container"],[1,"form--field","-required"],["for","save-query-name",1,"form--label","-bold",3,"textContent"],[1,"form--field-container"],[1,"form--text-field-container"],["type","text","name","save-query-name","id","save-query-name","required","",1,"form--text-field",3,"ngModelChange","ngModel"],[1,"spot-subheader-extra-small"],[3,"onChange","isSave","isStarred","isPublic"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button",1,"button","button_no-margin","spot-modal--cancel-button","spot-action-bar--action",3,"click","textContent"],[1,"button","button_no-margin","-primary","-with-icon","icon-save","spot-action-bar--action",3,"textContent","disabled"]],template:function SaveQueryModalComponent_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"form",1),d.bIt("submit",(function SaveQueryModalComponent_Template_form_submit_0_listener(n){return d.eBV(e),d.Njj(t.saveQueryAs(n))})),d.j41(1,"h1",2),d.EFF(2),d.k0s(),d.nrm(3,"div",3),d.j41(4,"div",4)(5,"div",5),d.nrm(6,"label",6),d.j41(7,"div",7)(8,"div",8)(9,"input",9,0),d.mxI("ngModelChange",(function SaveQueryModalComponent_Template_input_ngModelChange_9_listener(n){return d.eBV(e),d.DH7(t.queryName,n)||(t.queryName=n),d.Njj(n)})),d.k0s()()()(),d.nrm(11,"div",3),d.j41(12,"h2",10),d.EFF(13),d.k0s(),d.j41(14,"query-sharing-form",11),d.bIt("onChange",(function SaveQueryModalComponent_Template_query_sharing_form_onChange_14_listener(n){return d.eBV(e),d.Njj(t.setValues(n))})),d.k0s()(),d.j41(15,"div",12)(16,"div",13)(17,"button",14),d.bIt("click",(function SaveQueryModalComponent_Template_button_click_17_listener(n){return d.eBV(e),d.Njj(t.closeMe(n))})),d.k0s(),d.nrm(18,"button",15),d.k0s()()()}2&e&&(d.R7$(2),d.JRh(t.text.save_as),d.R7$(4),d.Y8G("textContent",t.text.label_name),d.R7$(3),d.R50("ngModel",t.queryName),d.R7$(4),d.JRh(t.text.label_visibility_settings),d.R7$(),d.Y8G("isSave",!0)("isStarred",t.isStarred)("isPublic",t.isPublic),d.R7$(3),d.Y8G("textContent",t.text.button_cancel),d.R7$(),d.Y8G("textContent",t.text.button_save)("disabled",t.isBusy||!t.queryName))},dependencies:[u.qT,u.me,u.BC,u.cb,u.YS,u.vS,u.cV,h.C],encapsulation:2})}}},7467:(e,t,n)=>{"use strict";n.d(t,{C:()=>QuerySharingFormComponent});var i=n(13432),o=n(67820),r=n(68559),s=n(61816),a=n(11048),l=n(34456);class QuerySharingFormComponent{constructor(e,t,n,i){this.states=e,this.querySpace=t,this.authorisationService=n,this.I18n=i,this.onChange=new r.bkB,this.text={showInMenu:this.I18n.t("js.label_star_query"),visibleForOthers:this.I18n.t("js.label_public_query"),showInMenuText:this.I18n.t("js.work_packages.query.star_text"),visibleForOthersText:this.I18n.t("js.work_packages.query.public_text")}}get canStar(){return this.isSave||this.authorisationService.can("query","star")||this.authorisationService.can("query","unstar")}get canPublish(){const e=this.querySpace.queryForm.value;return this.authorisationService.can("query","updateImmediately")&&e.schema.public.writable}updateStarred(e){this.isStarred=e,this.changed()}updatePublic(e){this.isPublic=e,this.changed()}changed(){this.onChange.emit({isStarred:!!this.isStarred,isPublic:!!this.isPublic})}static{this.ɵfac=function QuerySharingFormComponent_Factory(e){return new(e||QuerySharingFormComponent)(r.rXU(i.D),r.rXU(a.i),r.rXU(o._),r.rXU(s.W))}}static{this.ɵcmp=r.VBU({type:QuerySharingFormComponent,selectors:[["query-sharing-form"]],inputs:{isSave:"isSave",isStarred:"isStarred",isPublic:"isPublic"},outputs:{onChange:"onChange"},decls:14,vars:8,consts:[[1,"form--field"],[1,"form--field-container","-vertical"],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["type","checkbox","name","is_public","id","show-public",1,"form--check-box",3,"ngModelChange","ngModel","disabled"],[1,"form--field-instructions","-no-margin",3,"textContent"],["type","checkbox","name","show_in_menu","id","show-in-menu",1,"form--check-box",3,"ngModelChange","ngModel","disabled"]],template:function QuerySharingFormComponent_Template(e,t){1&e&&(r.j41(0,"div",0)(1,"div",1)(2,"label",2)(3,"div",3)(4,"input",4),r.bIt("ngModelChange",(function QuerySharingFormComponent_Template_input_ngModelChange_4_listener(e){return t.updatePublic(e)})),r.k0s()(),r.EFF(5),r.k0s(),r.nrm(6,"div",5),r.k0s()(),r.j41(7,"div",0)(8,"div",1)(9,"label",2)(10,"div",3)(11,"input",6),r.bIt("ngModelChange",(function QuerySharingFormComponent_Template_input_ngModelChange_11_listener(e){return t.updateStarred(e)})),r.k0s()(),r.EFF(12),r.k0s(),r.nrm(13,"div",5),r.k0s()()),2&e&&(r.R7$(4),r.Y8G("ngModel",t.isPublic)("disabled",!t.canPublish),r.R7$(),r.SpI(" ",t.text.visibleForOthers," "),r.R7$(),r.Y8G("textContent",t.text.visibleForOthersText),r.R7$(5),r.Y8G("ngModel",t.isStarred)("disabled",!t.canStar),r.R7$(),r.SpI(" ",t.text.showInMenu," "),r.R7$(),r.Y8G("textContent",t.text.showInMenuText))},dependencies:[l.Zm,l.BC,l.vS],encapsulation:2})}}},38640:(e,t,n)=>{"use strict";n.d(t,{J:()=>QuerySharingModalComponent});var i=n(95445),o=n(13432),r=n(40358),s=n(72650),a=n(69081),l=n(51133),c=n(61816),p=n(11048),d=n(68559),u=n(7467);class QuerySharingModalComponent extends a.a{constructor(e,t,n,i,o,r,s,a,l){super(t,r,e),this.elementRef=e,this.locals=t,this.I18n=n,this.states=i,this.querySpace=o,this.cdRef=r,this.wpListService=s,this.halNotification=a,this.toastService=l,this.isStarred=!1,this.isPublic=!1,this.isBusy=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text"),save_as:this.I18n.t("js.label_save_as"),label_name:this.I18n.t("js.modals.label_name"),label_visibility_settings:this.I18n.t("js.label_visibility_settings"),button_save:this.I18n.t("js.modals.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")}}ngOnInit(){super.ngOnInit(),this.query=this.querySpace.query.value,this.isStarred=this.query.starred,this.isPublic=this.query.public}setValues(e){this.isStarred=e.isStarred,this.isPublic=e.isPublic}get afterFocusOn(){return document.getElementById("work-packages-settings-button")}saveQuery(e){if(this.isBusy)return;this.isBusy=!0;const t=[];this.query.public!==this.isPublic&&(this.query.public=this.isPublic,t.push(this.wpListService.save(this.query))),this.query.starred!==this.isStarred&&t.push(this.wpListService.toggleStarred(this.query)),Promise.all(t).then((()=>{this.closeMe(e),this.isBusy=!1})).catch((()=>{this.toastService.addError(this.I18n.t("js.error.query_saving")),this.isBusy=!1}))}static{this.ɵfac=function QuerySharingModalComponent_Factory(e){return new(e||QuerySharingModalComponent)(d.rXU(d.aKT),d.rXU(l.Y),d.rXU(c.W),d.rXU(o.D),d.rXU(p.i),d.rXU(d.gRc),d.rXU(i.E),d.rXU(r.Y),d.rXU(s.fw))}}static{this.ɵcmp=d.VBU({type:QuerySharingModalComponent,selectors:[["ng-component"]],features:[d.Vt3],decls:9,vars:7,consts:[["data-indicator-name","modal",1,"spot-modal","loading-indicator--location"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"spot-modal--body","spot-container",3,"onChange","isSave","isStarred","isPublic"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],[1,"button","button_no-margin","spot-modal--cancel-button","spot-action-bar--action",3,"click","textContent","disabled"],[1,"button","button_no-margin","-primary","-with-icon","icon-save","spot-action-bar--action",3,"click","textContent"]],template:function QuerySharingModalComponent_Template(e,t){1&e&&(d.j41(0,"div",0)(1,"div",1),d.EFF(2),d.k0s(),d.nrm(3,"div",2),d.j41(4,"query-sharing-form",3),d.bIt("onChange",(function QuerySharingModalComponent_Template_query_sharing_form_onChange_4_listener(e){return t.setValues(e)})),d.k0s(),d.j41(5,"div",4)(6,"div",5)(7,"button",6),d.bIt("click",(function QuerySharingModalComponent_Template_button_click_7_listener(e){return t.closeMe(e)})),d.k0s(),d.j41(8,"button",7),d.bIt("click",(function QuerySharingModalComponent_Template_button_click_8_listener(e){return t.saveQuery(e)})),d.k0s()()()()),2&e&&(d.R7$(2),d.JRh(t.text.label_visibility_settings),d.R7$(2),d.Y8G("isSave",!1)("isStarred",t.isStarred)("isPublic",t.isPublic),d.R7$(3),d.Y8G("textContent",t.text.button_cancel)("disabled",t.isBusy),d.R7$(),d.Y8G("textContent",t.text.button_save))},dependencies:[u.C],encapsulation:2})}}},27160:(e,t,n)=>{"use strict";n.d(t,{g:()=>WpDestroyModalComponent});var i=n(95445),o=n(13432),r=n(69081),s=n(51133),a=n(79),l=n(83093),c=n(61816),p=n(30327),d=n(49349),u=n(20734),h=n(57436),m=n(68559),g=n(60316),f=n(34456);function WpDestroyModalComponent_ng_container_4_div_7_li_7_Template(e,t){if(1&e&&(m.j41(0,"li"),m.EFF(1," #"),m.nrm(2,"span",9)(3,"span",9),m.k0s()),2&e){const e=t.$implicit;m.R7$(2),m.Y8G("textContent",e.id),m.R7$(),m.Y8G("textContent",e.subject||"")}}function WpDestroyModalComponent_ng_container_4_div_7_Template(e,t){if(1&e&&(m.j41(0,"div")(1,"p",10),m.nrm(2,"span",11)(3,"strong",9),m.EFF(4,": "),m.nrm(5,"span",9),m.k0s(),m.j41(6,"ul"),m.DNE(7,WpDestroyModalComponent_ng_container_4_div_7_li_7_Template,4,2,"li",12),m.k0s(),m.j41(8,"p"),m.nrm(9,"span",9),m.k0s()()),2&e){const e=m.XpG(2);m.R7$(3),m.Y8G("textContent",e.text.warning),m.R7$(2),m.Y8G("textContent",e.text.hasChildren(e.singleWorkPackage)),m.R7$(2),m.Y8G("ngForOf",e.singleWorkPackageChildren),m.R7$(2),m.Y8G("textContent",e.text.deletesChildren)}}function WpDestroyModalComponent_ng_container_4_Template(e,t){if(1&e&&(m.qex(0),m.j41(1,"p"),m.nrm(2,"span",9),m.j41(3,"strong"),m.EFF(4),m.k0s(),m.j41(5,"span"),m.EFF(6,"?"),m.k0s()(),m.DNE(7,WpDestroyModalComponent_ng_container_4_div_7_Template,10,4,"div",3),m.bVm()),2&e){const e=m.XpG();m.R7$(2),m.Y8G("textContent",e.text.single_text),m.R7$(2),m.Lme(" ",e.singleWorkPackage.subject," #",e.singleWorkPackage.id,""),m.R7$(3),m.Y8G("ngIf",e.singleWorkPackageChildren&&e.singleWorkPackageChildren.length>0)}}function WpDestroyModalComponent_ng_container_5_li_5_strong_5_Template(e,t){if(1&e&&(m.j41(0,"strong"),m.EFF(1),m.k0s()),2&e){const e=m.XpG().$implicit,t=m.XpG(2);m.R7$(),m.SpI(" (+ ",t.text.childCount(e),") ")}}function WpDestroyModalComponent_ng_container_5_li_5_Template(e,t){if(1&e&&(m.j41(0,"li"),m.EFF(1," #"),m.nrm(2,"span",9),m.EFF(3," "),m.nrm(4,"span",9),m.DNE(5,WpDestroyModalComponent_ng_container_5_li_5_strong_5_Template,2,1,"strong",3),m.k0s()),2&e){const e=t.$implicit,n=m.XpG(2);m.R7$(2),m.Y8G("textContent",e.id),m.R7$(2),m.Y8G("textContent",e.subject),m.R7$(),m.Y8G("ngIf",n.children(e).length>0)}}function WpDestroyModalComponent_ng_container_5_Template(e,t){if(1&e&&(m.qex(0),m.j41(1,"p",10),m.nrm(2,"span",11)(3,"strong",9),m.k0s(),m.j41(4,"ul"),m.DNE(5,WpDestroyModalComponent_ng_container_5_li_5_Template,6,3,"li",12),m.k0s(),m.bVm()),2&e){const e=m.XpG();m.R7$(3),m.Y8G("textContent",e.text.bulk_text),m.R7$(2),m.Y8G("ngForOf",e.workPackages)}}function WpDestroyModalComponent_div_6_Template(e,t){if(1&e){const e=m.RV6();m.j41(0,"div")(1,"label",13)(2,"div",14)(3,"input",15),m.mxI("ngModelChange",(function WpDestroyModalComponent_div_6_Template_input_ngModelChange_3_listener(t){m.eBV(e);const n=m.XpG();return m.DH7(n.childrenDeletionConfirmed,t)||(n.childrenDeletionConfirmed=t),m.Njj(t)})),m.k0s()(),m.EFF(4),m.k0s()()}if(2&e){const e=m.XpG();m.R7$(3),m.R50("ngModel",e.childrenDeletionConfirmed),m.R7$(),m.SpI(" ",e.text.label_confirm_children_deletion," ")}}class WpDestroyModalComponent extends r.a{constructor(e,t,n,i,o,r,s,a,l,c,p){super(n,o,e),this.elementRef=e,this.workPackageService=t,this.locals=n,this.I18n=i,this.cdRef=o,this.$state=r,this.states=s,this.wpTableFocus=a,this.wpListService=l,this.notificationService=c,this.backRoutingService=p,this.busy=!1,this.childrenDeletionConfirmed=!1,this.text={label_visibility_settings:this.I18n.t("js.label_visibility_settings"),button_save:this.I18n.t("js.modals.button_save"),confirm:this.I18n.t("js.modals.button_delete"),warning:this.I18n.t("js.label_warning"),cancel:this.I18n.t("js.button_cancel"),close:this.I18n.t("js.close_popup_title"),label_confirm_children_deletion:this.I18n.t("js.modals.destroy_work_package.confirm_deletion_children"),title:"",bulk_text:"",single_text:this.I18n.t("js.modals.destroy_work_package.single_text"),childCount:e=>"",hasChildren:e=>"",deletesChildren:""}}ngOnInit(){super.ngOnInit(),this.workPackages=this.locals.workPackages,this.workPackageLabel=this.I18n.t("js.units.workPackage",{count:this.workPackages.length}),1===this.workPackages.length&&(this.singleWorkPackage=this.workPackages[0],this.singleWorkPackageChildren=this.singleWorkPackage.children),this.text.title=this.I18n.t("js.modals.destroy_work_package.title",{label:this.workPackageLabel}),this.text.bulk_text=this.I18n.t("js.modals.destroy_work_package.bulk_text",{label:this.workPackageLabel,count:this.workPackages.length}),this.text.childCount=e=>{const t=this.children(e).length;return this.I18n.t("js.units.child_work_packages",{count:t})},this.text.hasChildren=e=>{const t=this.text.childCount(e);return this.I18n.t("js.modals.destroy_work_package.has_children",{childUnits:t})},this.text.deletesChildren=this.I18n.t("js.modals.destroy_work_package.deletes_children")}get blockedDueToUnconfirmedChildren(){return this.mustConfirmChildren&&!this.childrenDeletionConfirmed}get mustConfirmChildren(){let e=!1;return this.singleWorkPackage&&this.singleWorkPackageChildren&&(e=this.singleWorkPackageChildren.length>0),e||!!_.find(this.workPackages,(e=>e.children&&e.children.length>0))}confirmDeletion(e){if(this.busy||this.blockedDueToUnconfirmedChildren)return!1;this.busy=!0;const t=this.workPackages.map((e=>e.id)).filter(h.A);return this.workPackageService.performBulkDelete(t,!0).then((()=>{this.busy=!1,this.closeMe(e),this.wpTableFocus.clear("Clearing after destroying work packages"),this.$state.current.data.baseRoute&&this.backRoutingService.goBack(!0)})).catch((()=>{this.busy=!1})),!1}children(e){return e.hasOwnProperty("children")?e.children:[]}static{this.ɵfac=function WpDestroyModalComponent_Factory(e){return new(e||WpDestroyModalComponent)(m.rXU(m.aKT),m.rXU(u.p),m.rXU(s.Y),m.rXU(c.W),m.rXU(m.gRc),m.rXU(l.dw),m.rXU(o.D),m.rXU(a.c),m.rXU(i.E),m.rXU(d.U),m.rXU(p.v))}}static{this.ɵcmp=m.VBU({type:WpDestroyModalComponent,selectors:[["ng-component"]],features:[m.Vt3],decls:13,vars:7,consts:[["data-indicator-name","modal","id","wp_destroy_modal",1,"spot-modal"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-modal--body","spot-container"],[4,"ngIf"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],[1,"button","button_no-margin","spot-modal--cancel-button","spot-action-bar--action",3,"click","textContent"],[1,"button","button_no-margin","-danger","spot-action-bar--action",3,"click"],[1,"spot-icon","spot-icon_delete"],[3,"textContent"],[1,"danger-zone--warning"],[1,"icon-context","icon-error"],[4,"ngFor","ngForOf"],[1,"form--label-with-check-box","-no-ellipsis"],[1,"form--check-box-container"],["type","checkbox","name","confirm-children-deletion","id","confirm-children-deletion",1,"form--check-box",3,"ngModelChange","ngModel"]],template:function WpDestroyModalComponent_Template(e,t){1&e&&(m.j41(0,"div",0)(1,"div",1),m.EFF(2),m.k0s(),m.j41(3,"div",2),m.DNE(4,WpDestroyModalComponent_ng_container_4_Template,8,4,"ng-container",3)(5,WpDestroyModalComponent_ng_container_5_Template,6,2,"ng-container",3)(6,WpDestroyModalComponent_div_6_Template,5,2,"div",3),m.k0s(),m.j41(7,"div",4)(8,"div",5)(9,"button",6),m.bIt("click",(function WpDestroyModalComponent_Template_button_click_9_listener(e){return t.closeMe(e)})),m.k0s(),m.j41(10,"button",7),m.bIt("click",(function WpDestroyModalComponent_Template_button_click_10_listener(e){return t.confirmDeletion(e)})),m.nrm(11,"span",8),m.EFF(12),m.k0s()()()()),2&e&&(m.R7$(2),m.JRh(t.text.title),m.R7$(2),m.Y8G("ngIf",t.singleWorkPackage),m.R7$(),m.Y8G("ngIf",t.workPackages.length>1),m.R7$(),m.Y8G("ngIf",t.mustConfirmChildren),m.R7$(3),m.Y8G("textContent",t.text.cancel),m.R7$(),m.BMQ("disabled",t.busy||t.blockedDueToUnconfirmedChildren||void 0),m.R7$(2),m.SpI(" ",t.text.confirm," "))},dependencies:[g.Sq,g.bT,f.Zm,f.BC,f.vS],encapsulation:2})}}},79727:(e,t,n)=>{"use strict";n.d(t,{h:()=>NoResultsComponent});var i=n(37749),o=n(68559),r=n(60316);function NoResultsComponent_i_0_Template(e,t){1&e&&o.nrm(0,"i",3)}function NoResultsComponent_div_3_Template(e,t){if(1&e&&o.nrm(0,"div",4),2&e){const e=o.XpG();o.Y8G("innerHTML",e.description,o.npT)}}class NoResultsComponent{constructor(e){this.elementRef=e,this.showIcon=!0,this.setHostClass=!0,(0,i.w)(this)}static{this.ɵfac=function NoResultsComponent_Factory(e){return new(e||NoResultsComponent)(o.rXU(o.aKT))}}static{this.ɵcmp=o.VBU({type:NoResultsComponent,selectors:[["op-no-results"]],hostVars:2,hostBindings:function NoResultsComponent_HostBindings(e,t){2&e&&o.AVh("generic-table--no-results-container",t.setHostClass)},inputs:{title:"title",description:"description",showIcon:"showIcon"},decls:4,vars:3,consts:[["class","icon-info1","aria-hidden","true",4,"ngIf"],[1,"generic-table--no-results-title"],["class","generic-table--no-results-description",3,"innerHTML",4,"ngIf"],["aria-hidden","true",1,"icon-info1"],[1,"generic-table--no-results-description",3,"innerHTML"]],template:function NoResultsComponent_Template(e,t){1&e&&(o.DNE(0,NoResultsComponent_i_0_Template,1,0,"i",0),o.j41(1,"span",1),o.EFF(2),o.DNE(3,NoResultsComponent_div_3_Template,1,1,"div",2),o.k0s()),2&e&&(o.Y8G("ngIf",t.showIcon),o.R7$(2),o.SpI(" ",t.title," "),o.R7$(),o.Y8G("ngIf",t.description))},dependencies:[r.bT],encapsulation:2,changeDetection:0})}}},53689:(e,t,n)=>{"use strict";n.d(t,{F:()=>OpContentLoaderComponent});var i=n(68559),o=n(35997);const r=["*"];class OpContentLoaderComponent{constructor(){this.viewBox="0 0 400 130"}ngOnInit(){this.baseUrl=window.appBasePath}static{this.ɵfac=function OpContentLoaderComponent_Factory(e){return new(e||OpContentLoaderComponent)}}static{this.ɵcmp=i.VBU({type:OpContentLoaderComponent,selectors:[["op-content-loader"]],inputs:{viewBox:"viewBox"},ngContentSelectors:r,decls:2,vars:5,consts:[[3,"backgroundColor","foregroundColor","baseUrl","speed","viewBox"]],template:function OpContentLoaderComponent_Template(e,t){1&e&&(i.NAR(),i.j41(0,"content-loader",0),i.SdG(1),i.k0s()),2&e&&i.Y8G("backgroundColor","var(--skeletonLoader-bgColor)")("foregroundColor","var(--bgColor-neutral-muted)")("baseUrl",t.baseUrl)("speed",3)("viewBox",t.viewBox)},dependencies:[o.GC],encapsulation:2,changeDetection:0})}}},62143:(e,t,n)=>{"use strict";n.d(t,{$:()=>OpPrincipalLoadingComponent});var i=n(68559),o=n(53689);class OpPrincipalLoadingComponent{static{this.ɵfac=function OpPrincipalLoadingComponent_Factory(e){return new(e||OpPrincipalLoadingComponent)}}static{this.ɵcmp=i.VBU({type:OpPrincipalLoadingComponent,selectors:[["op-principal-loading-skeleton"]],decls:4,vars:0,consts:[[1,"op-principal-loading-skeleton"],["viewBox","0 0 180 80"],["height","30%","rx","4","ry","4","width","117","x","75","y","30"],["cx","35","cy","42","r","35"]],template:function OpPrincipalLoadingComponent_Template(e,t){1&e&&(i.j41(0,"div",0)(1,"op-content-loader",1),i.qSk(),i.nrm(2,"rect",2)(3,"circle",3),i.k0s()())},dependencies:[o.F],styles:[".op-principal-loading-skeleton[_ngcontent-%COMP%]{width:100%;position:relative;background:var(--body-background);overflow:hidden;height:80px}"],changeDetection:0})}}},75205:(e,t,n)=>{"use strict";n.d(t,{A:()=>OpWPLoadingComponent});var i=n(68559),o=n(53689);class OpWPLoadingComponent{constructor(){this.viewBox="0 0 800 80"}static{this.ɵfac=function OpWPLoadingComponent_Factory(e){return new(e||OpWPLoadingComponent)}}static{this.ɵcmp=i.VBU({type:OpWPLoadingComponent,selectors:[["op-wp-loading-skeleton"]],inputs:{viewBox:"viewBox"},decls:4,vars:1,consts:[[1,"op-wp-loading-skeleton"],[3,"viewBox"],["x","0","y","0","rx","3","ry","3","width","20%","height","35%"],["x","0","y","40%","rx","3","ry","3","width","100%","height","35%"]],template:function OpWPLoadingComponent_Template(e,t){1&e&&(i.j41(0,"div",0)(1,"op-content-loader",1),i.qSk(),i.nrm(2,"rect",2)(3,"rect",3),i.k0s()()),2&e&&(i.R7$(),i.Y8G("viewBox",t.viewBox))},dependencies:[o.F],styles:['.op-wp-loading-skeleton[_ngcontent-%COMP%]{width:calc(100% - 2px);border:1px solid var(--borderColor-default);border-radius:2px;padding:10px;position:relative;box-shadow:1px 1px 3px #d3d3d3;background:var(--body-background);overflow:hidden;height:80px}.op-wp-loading-skeleton[_ngcontent-%COMP%]:after{width:12px;height:100px;background:#fff;content:"";display:block;position:absolute;right:0;top:0}'],changeDetection:0})}}},83786:(e,t,n)=>{"use strict";n.d(t,{Q:()=>OpenprojectContentLoaderModule});var i=n(60316),o=n(53689),r=n(62143),s=n(75205),a=n(35997),l=n(68559);class OpenprojectContentLoaderModule{static{this.ɵfac=function OpenprojectContentLoaderModule_Factory(e){return new(e||OpenprojectContentLoaderModule)}}static{this.ɵmod=l.$C({type:OpenprojectContentLoaderModule})}static{this.ɵinj=l.G2t({imports:[i.MD,a.RU]})}}("undefined"==typeof ngJitMode||ngJitMode)&&l.Obh(OpenprojectContentLoaderModule,{declarations:[o.F,r.$,s.A],imports:[i.MD,a.RU],exports:[o.F,r.$,s.A]})},11284:(e,t,n)=>{"use strict";n.d(t,{i:()=>OpContextMenuTrigger});var i=n(67369),o=n(65661),r=n(80559),s=n(68559);class OpContextMenuTrigger extends o.y{constructor(e,t){super(t),this.elementRef=e,this.opContextMenu=t,this.items=[]}ngAfterViewInit(){this.$element=jQuery(this.elementRef.nativeElement),this.$element.on("click",(e=>{e.preventDefault(),this.opContextMenu.isActive(this)?this.opContextMenu.close():this.open(e)})),r(this.$element[0]).bind("shift+alt+f10",(e=>{this.open(e)}))}positionArgs(e){return{my:"left top",at:"left bottom",of:this.$element,collision:"flipfit"}}static{this.ɵfac=function OpContextMenuTrigger_Factory(e){return new(e||OpContextMenuTrigger)(s.rXU(s.aKT),s.rXU(i.V))}}static{this.ɵdir=s.FsC({type:OpContextMenuTrigger,selectors:[["","opContextMenuTrigger",""]],features:[s.Vt3]})}}},67035:(e,t,n)=>{"use strict";n.d(t,{p:()=>OpSettingsMenuDirective});var i=n(61816),o=n(67820),r=n(11284),s=n(67369),a=n(13432),l=n(95445),c=(n(20045),n(51133)),p=n(16545),d=n(11048),u=n(24557),h=n(38640),m=n(46635),g=n(74311),f=n(32147),b=n(88352),k=n(23906),v=n(85247),C=n(88535),y=n(68559);class OpSettingsMenuDirective extends r.i{constructor(e,t,n,i,o,r,s,a,l,c,p,d,u){super(e,t),this.elementRef=e,this.opContextMenu=t,this.opModalService=n,this.wpListService=i,this.authorisationService=o,this.states=r,this.injector=s,this.querySpace=a,this.wpTableColumns=l,this.urlParamsHelper=c,this.opStaticQueries=p,this.turboRequests=d,this.I18n=u}ngAfterViewInit(){super.ngAfterViewInit(),this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe((e=>{this.query=e})),this.loadingPromise=this.querySpace.queryForm.valuesPromise(),this.querySpace.queryForm.values$().pipe(this.untilDestroyed()).subscribe((e=>{this.form=e}))}open(e){this.loadingPromise.then((()=>{this.buildItems(),this.opContextMenu.show(this,e)}))}get locals(){return{contextMenuId:"settingsDropdown",items:this.items}}positionArgs(e){const t=super.positionArgs(e);return _.assign(t,{my:"right top",at:"right bottom"}),t}onClose(e){e&&this.afterFocusOn.focus()}allowQueryAction(e,t){return this.allowAction(e,"query",t)}allowWorkPackageAction(e,t){return this.allowAction(e,"work_packages",t)}allowFormAction(e,t){return!!this.form.$links[t]||(e.stopPropagation(),!1)}allowAction(e,t,n){return!!this.authorisationService.can(t,n)||(e.stopPropagation(),!1)}buildExportDialogHref(e){const t=this.urlParamsHelper.buildV3GetQueryFromQueryResource(e);t["columns[]"]=this.wpTableColumns.getColumns().map((e=>e.id)),t.title=this.queryTitle(e);const n=new URL(window.location.href),i=n.searchParams.get("query_id");return i&&(t.query_id=i),n.pathname=`${n.pathname}/export_dialog`,n.search=this.urlParamsHelper.buildQueryString(t)||"",n.toString()}queryTitle(e){return(0,f.A)(e)?e.name:this.staticQueryName(e)}staticQueryName(e){return this.opStaticQueries.getStaticName(e)}buildItems(){this.items=[{disabled:!1,linkText:this.I18n.t("js.toolbar.settings.configure_view"),hidden:this.hideTableOptions,icon:"icon-settings",onClick:e=>(this.opContextMenu.close(),this.opModalService.show(p.E,this.injector),!0)},{linkText:this.I18n.t("js.work_packages.query.insert_columns"),hidden:this.hideTableOptions,icon:"icon-columns",class:"hidden-for-mobile",onClick:()=>(this.opModalService.show(p.E,this.injector,{initialTab:"columns"}),!0)},{linkText:this.I18n.t("js.toolbar.settings.sort_by"),hidden:this.hideTableOptions,icon:"icon-sort-by",onClick:()=>(this.opModalService.show(p.E,this.injector,{initialTab:"sort-by"}),!0)},{linkText:this.I18n.t("js.toolbar.settings.group_by"),hidden:this.hideTableOptions,icon:"icon-group-by",class:"hidden-for-mobile",onClick:()=>(this.opModalService.show(p.E,this.injector,{initialTab:"display-settings"}),!0)},{disabled:!this.query.id||this.authorisationService.cannot("query","updateImmediately"),linkText:this.I18n.t("js.toolbar.settings.page_settings"),icon:"icon-edit",onClick:e=>(this.allowQueryAction(e,"update")&&jQuery(`${u.o}`).trigger(u.vM),!0)},{disabled:this.authorisationService.cannot("query","updateImmediately"),linkText:this.I18n.t("js.toolbar.settings.save"),icon:"icon-save",onClick:e=>{const{query:t}=this;return!(0,f.A)(t)&&this.allowQueryAction(e,"updateImmediately")?this.opModalService.show(g.g,this.injector):t.id&&this.allowQueryAction(e,"updateImmediately")&&this.wpListService.save(t),!0}},{disabled:this.form?!this.form.$links.create_new:this.authorisationService.cannot("query","updateImmediately"),linkText:this.I18n.t("js.toolbar.settings.save_as"),icon:"icon-save",onClick:e=>(this.allowFormAction(e,"create_new")&&this.opModalService.show(g.g,this.injector),!0)},{disabled:this.authorisationService.cannot("query","delete"),linkText:this.I18n.t("js.toolbar.settings.delete"),icon:"icon-delete",onClick:e=>(this.allowQueryAction(e,"delete")&&window.confirm(this.I18n.t("js.text_query_destroy_confirmation"))&&this.wpListService.delete(),!0)},{hidden:!this.showCalendarSharingOption,disabled:this.authorisationService.cannot("query","icalUrl"),linkText:this.I18n.t("js.toolbar.settings.share_calendar"),icon:"icon-link",onClick:()=>(this.authorisationService.can("query","icalUrl")&&this.opModalService.show(m.Z,this.injector),!0)},{disabled:this.authorisationService.cannot("work_packages","representations"),linkText:this.I18n.t("js.toolbar.settings.export"),hidden:this.hideTableOptions,icon:"icon-export",onClick:e=>{if(this.allowWorkPackageAction(e,"representations")){const e=this.querySpace.query.value;if(e){const t=this.buildExportDialogHref(e);this.turboRequests.requestStream(t)}}return!0}},{disabled:this.authorisationService.cannot("query","unstar")&&this.authorisationService.cannot("query","star"),linkText:this.I18n.t("js.toolbar.settings.visibility_settings"),icon:"icon-watched",onClick:e=>((this.allowQueryAction(e,"unstar")||this.allowQueryAction(e,"star"))&&this.opModalService.show(h.J,this.injector),!0)},{divider:!0,hidden:!(this.query.results.customFields&&this.form.configureForm)},{hidden:!this.query.results.customFields||this.hideTableOptions,href:this.query.results.customFields&&this.query.results.customFields.href,linkText:this.query.results.customFields&&this.query.results.customFields.name,icon:"icon-custom-fields",onClick:()=>!1}]}static{this.ɵfac=function OpSettingsMenuDirective_Factory(e){return new(e||OpSettingsMenuDirective)(y.rXU(y.aKT),y.rXU(s.V),y.rXU(c.a),y.rXU(l.E),y.rXU(o._),y.rXU(a.D),y.rXU(y.zZn),y.rXU(d.i),y.rXU(b.T),y.rXU(v.j),y.rXU(k.M),y.rXU(C.W),y.rXU(i.W))}}static{this.ɵdir=y.FsC({type:OpSettingsMenuDirective,selectors:[["","opSettingsContextMenu",""]],inputs:{query:[y.Mj6.None,"opSettingsContextMenu-query","query"],hideTableOptions:"hideTableOptions",showCalendarSharingOption:"showCalendarSharingOption"},features:[y.Vt3]})}}},82633:(e,t,n)=>{"use strict";n.d(t,{S:()=>OpTypesContextMenuDirective});var i=n(83093),o=n(67369),r=n(2183),s=n(11284),a=n(75275),l=n(68267),c=n(46116),p=n(68559);class OpTypesContextMenuDirective extends s.i{constructor(e,t,n,i,o){super(e,t),this.elementRef=e,this.opContextMenu=t,this.browserDetector=n,this.wpCreate=i,this.$state=o,this.isOpen=!1}ngAfterViewInit(){super.ngAfterViewInit(),this.active&&this.browserDetector.isMobile&&(this.stateName="work-packages.new")}open(e){this.isOpen=!this.isOpen,this.isOpen?this.wpCreate.getEmptyForm(this.projectIdentifier).then((t=>{this.buildItems(t.schema.type.allowedValues),this.opContextMenu.show(this,e)})):this.opContextMenu.close()}onClose(e=!1){this.isOpen=!1,super.onClose(e)}get locals(){return{items:this.items,contextMenuId:"types-context-menu"}}buildItems(e){this.items=e.map((e=>({disabled:!1,linkText:e.name,href:this.$state.href(this.stateName,{type:e.id}),ariaLabel:e.name,class:c.H.inlineClass("type",e.id),onClick:t=>(this.isOpen=!1,!(0,r.R)(t)&&(this.$state.go(this.stateName,{type:e.id}),!0))})))}static{this.ɵfac=function OpTypesContextMenuDirective_Factory(e){return new(e||OpTypesContextMenuDirective)(p.rXU(p.aKT),p.rXU(o.V),p.rXU(a.l),p.rXU(l.d),p.rXU(i.dw))}}static{this.ɵdir=p.FsC({type:OpTypesContextMenuDirective,selectors:[["","opTypesCreateDropdown",""]],inputs:{projectIdentifier:"projectIdentifier",stateName:"stateName",active:[p.Mj6.None,"dropdownActive","active"]},features:[p.Vt3]})}}},99274:(e,t,n)=>{"use strict";n.d(t,{J:()=>WorkPackageCreateSettingsMenuDirective});var i=n(67369),o=n(11284),r=n(51339),s=n(13432),a=n(68559);class WorkPackageCreateSettingsMenuDirective extends o.i{constructor(e,t,n,i){super(e,t),this.elementRef=e,this.opContextMenu=t,this.states=n,this.halEditing=i}open(e){const t=this.states.workPackages.get("new").value;if(t){this.halEditing.changeFor(t).getForm().then((t=>{this.buildItems(t),this.opContextMenu.show(this,e)}))}}positionArgs(e){const t=super.positionArgs(e);return _.assign(t,{my:"right top",at:"right bottom"}),t}buildItems(e){this.items=[];const t=e.configureForm,n=e.customFields;n&&this.items.push({href:n.href,icon:"icon-custom-fields",linkText:n.name,onClick:()=>!1}),t&&this.items.push({href:t.href,icon:"icon-settings3",linkText:t.name,onClick:()=>!1})}static{this.ɵfac=function WorkPackageCreateSettingsMenuDirective_Factory(e){return new(e||WorkPackageCreateSettingsMenuDirective)(a.rXU(a.aKT),a.rXU(i.V),a.rXU(s.D),a.rXU(r.p))}}static{this.ɵdir=a.FsC({type:WorkPackageCreateSettingsMenuDirective,selectors:[["","wpCreateSettingsMenu",""]],features:[a.Vt3]})}}},56912:(e,t,n)=>{"use strict";n.d(t,{_:()=>WorkPackageGroupToggleDropdownMenuDirective});var i=n(67369),o=n(11284),r=n(61816),s=n(59769),a=n(68559);class WorkPackageGroupToggleDropdownMenuDirective extends o.i{constructor(e,t,n,i){super(e,t),this.elementRef=e,this.opContextMenu=t,this.I18n=n,this.wpViewCollapsedGroups=i}open(e){this.buildItems(),this.opContextMenu.show(this,e)}get locals(){return{items:this.items,contextMenuId:"wp-group-fold-context-menu"}}buildItems(){this.items=[{disabled:this.wpViewCollapsedGroups.allGroupsAreCollapsed,linkText:this.I18n.t("js.button_collapse_all"),icon:"icon-minus2",onClick:e=>(this.wpViewCollapsedGroups.setAllGroupsCollapseStateTo(!0),!0)},{disabled:this.wpViewCollapsedGroups.allGroupsAreExpanded,linkText:this.I18n.t("js.button_expand_all"),icon:"icon-plus",onClick:e=>(this.wpViewCollapsedGroups.setAllGroupsCollapseStateTo(!1),!0)}]}static{this.ɵfac=function WorkPackageGroupToggleDropdownMenuDirective_Factory(e){return new(e||WorkPackageGroupToggleDropdownMenuDirective)(a.rXU(a.aKT),a.rXU(i.V),a.rXU(r.W),a.rXU(s.V))}}static{this.ɵdir=a.FsC({type:WorkPackageGroupToggleDropdownMenuDirective,selectors:[["","wpGroupToggleDropdown",""]],features:[a.Vt3]})}}},57592:(e,t,n)=>{"use strict";n.d(t,{K:()=>WorkPackageStatusDropdownDirective});var i=n(83093),o=n(67369),r=n(11284),s=n(51339),a=(n(68643),n(46116)),l=n(61816),c=n(72650),p=n(91691),d=n(49349),u=n(97366),h=n(68559);class WorkPackageStatusDropdownDirective extends r.i{constructor(e,t,n,i,o,r,s,a){super(e,t),this.elementRef=e,this.opContextMenu=t,this.$state=n,this.workPackageNotificationService=i,this.halEditing=o,this.toastService=r,this.I18n=s,this.halEvents=a}open(e){const t=this.halEditing.changeFor(this.workPackage);t.getForm().then((n=>{const i=n.schema.status.allowedValues;this.buildItems(i);const{writable:o}=t.schema.status;o?this.opContextMenu.show(this,e):this.toastService.addError(this.I18n.t("js.work_packages.message_work_package_status_blocked"))}))}get locals(){return{items:this.items,contextMenuId:"wp-status-context-menu"}}updateStatus(e){const t=this.halEditing.changeFor(this.workPackage);t.projectedResource.status=e,(0,u.A)(this.workPackage)||this.halEditing.save(t).then((()=>{this.workPackageNotificationService.showSave(this.workPackage)})).catch((e=>{this.workPackageNotificationService.showError(e.resource,t.projectedResource)}))}buildItems(e){this.items=e.map((e=>({disabled:!1,linkText:e.name,postIcon:e.isReadonly?"icon-locked":null,postIconTitle:this.I18n.t("js.work_packages.message_work_package_read_only"),class:a.H.inlineClass("status",e.id),onClick:()=>(this.updateStatus(e),!0)})))}static{this.ɵfac=function WorkPackageStatusDropdownDirective_Factory(e){return new(e||WorkPackageStatusDropdownDirective)(h.rXU(h.aKT),h.rXU(o.V),h.rXU(i.dw),h.rXU(d.U),h.rXU(s.p),h.rXU(c.fw),h.rXU(l.W),h.rXU(p.o))}}static{this.ɵdir=h.FsC({type:WorkPackageStatusDropdownDirective,selectors:[["","wpStatusDropdown",""]],inputs:{workPackage:[h.Mj6.None,"wpStatusDropdown-workPackage","workPackage"]},features:[h.Vt3]})}}},46653:(e,t,n)=>{"use strict";n.d(t,{W:()=>IconTriggeredContextMenuComponent});var i=n(89204),o=n(61816),r=n(11284),s=n(67369),a=n(51133),l=n(68559),c=n(46765);class IconTriggeredContextMenuComponent extends r.i{constructor(e,t,n,i,o,r){super(e,t),this.elementRef=e,this.opContextMenu=t,this.opModalService=n,this.injector=i,this.cdRef=o,this.I18n=r}open(e){var t=this;return(0,i.A)((function*(){t.items=yield t.buildItems(),t.opContextMenu.show(t,e)}))()}positionArgs(e){const t=super.positionArgs(e);return _.assign(t,{my:"right top",at:"right bottom"}),t}buildItems(){var e=this;return(0,i.A)((function*(){const t=[];if(e.menuItemsFactory){const n=yield e.menuItemsFactory();return t.concat(n)}return t}))()}static{this.ɵfac=function IconTriggeredContextMenuComponent_Factory(e){return new(e||IconTriggeredContextMenuComponent)(l.rXU(l.aKT),l.rXU(s.V),l.rXU(a.a),l.rXU(l.zZn),l.rXU(l.gRc),l.rXU(o.W))}}static{this.ɵcmp=l.VBU({type:IconTriggeredContextMenuComponent,selectors:[["icon-triggered-context-menu"]],inputs:{menuItemsFactory:"menuItemsFactory"},features:[l.Vt3],decls:2,vars:0,consts:[["href","#"],["icon-classes","icon-show-more-horizontal"]],template:function IconTriggeredContextMenuComponent_Template(e,t){1&e&&(l.j41(0,"a",0),l.nrm(1,"op-icon",1),l.k0s())},dependencies:[c.i],styles:["a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:hover{color:var(--fgColor-muted);text-decoration:none}"]})}}},65661:(e,t,n)=>{"use strict";n.d(t,{y:()=>OpContextMenuHandler});var i=n(99496);class OpContextMenuHandler extends i.p{constructor(e){super(),this.opContextMenu=e,this.items=[]}onClose(e=!1){e&&this.afterFocusOn.trigger("focus")}onOpen(e){e.find(".menu-item").first().trigger("focus")}positionArgs(e){return{my:"left top",at:"right bottom",of:e,collision:"flipfit"}}get locals(){return{items:this.items}}open(e){this.opContextMenu.show(this,e)}get afterFocusOn(){return this.$element}}},23941:(e,t,n)=>{"use strict";n.d(t,{n:()=>OPContextMenuComponent});var i=n(93743),o=n(68559),r=n(60316),s=n(46765);const _c0=e=>({"-empty":e});function OPContextMenuComponent_ng_container_2_li_1_Template(e,t){1&e&&o.nrm(0,"li",5)}function OPContextMenuComponent_ng_container_2_li_2_a_1_op_icon_1_Template(e,t){if(1&e&&o.nrm(0,"op-icon",11),2&e){const e=o.XpG(3).$implicit;o.Mz_("icon-classes","icon-action-menu ",e.icon,"")}}function OPContextMenuComponent_ng_container_2_li_2_a_1_op_icon_3_Template(e,t){if(1&e&&o.nrm(0,"op-icon",12),2&e){const e=o.XpG(3).$implicit;o.Mz_("icon-classes","icon-action-menu-post ",e.postIcon,""),o.Y8G("icon-title",e.postIconTitle||"")}}function OPContextMenuComponent_ng_container_2_li_2_a_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"a",7),o.bIt("click",(function OPContextMenuComponent_ng_container_2_li_2_a_1_Template_a_click_0_listener(t){o.eBV(e);const n=o.XpG(2).$implicit,i=o.XpG();return o.Njj(i.handleClick(n,t))})),o.DNE(1,OPContextMenuComponent_ng_container_2_li_2_a_1_op_icon_1_Template,1,2,"op-icon",8),o.nrm(2,"span",9),o.DNE(3,OPContextMenuComponent_ng_container_2_li_2_a_1_op_icon_3_Template,1,3,"op-icon",10),o.k0s()}if(2&e){const e=o.XpG(2).$implicit;o.AVh("inactive",e.disabled),o.Y8G("ngClass",e.class),o.BMQ("href",e.href,o.B4B)("aria-disabled",e.disabled)("aria-label",e.ariaLabel||e.linkText)("title",e.title||void 0),o.R7$(),o.Y8G("ngIf",e.icon),o.R7$(),o.Y8G("textContent",e.linkText),o.R7$(),o.Y8G("ngIf",e.postIcon)}}function OPContextMenuComponent_ng_container_2_li_2_button_2_op_icon_1_Template(e,t){if(1&e&&o.nrm(0,"op-icon",11),2&e){const e=o.XpG(3).$implicit;o.Mz_("icon-classes","icon-action-menu ",e.icon,"")}}function OPContextMenuComponent_ng_container_2_li_2_button_2_op_icon_3_Template(e,t){if(1&e&&o.nrm(0,"op-icon",12),2&e){const e=o.XpG(3).$implicit;o.Mz_("icon-classes","icon-action-menu-post ",e.postIcon,""),o.Y8G("icon-title",e.postIconTitle||"")}}function OPContextMenuComponent_ng_container_2_li_2_button_2_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"button",7),o.bIt("click",(function OPContextMenuComponent_ng_container_2_li_2_button_2_Template_button_click_0_listener(t){o.eBV(e);const n=o.XpG(2).$implicit,i=o.XpG();return o.Njj(i.handleClick(n,t))})),o.DNE(1,OPContextMenuComponent_ng_container_2_li_2_button_2_op_icon_1_Template,1,2,"op-icon",8),o.nrm(2,"span",9),o.DNE(3,OPContextMenuComponent_ng_container_2_li_2_button_2_op_icon_3_Template,1,3,"op-icon",10),o.k0s()}if(2&e){const e=o.XpG(2).$implicit;o.AVh("inactive",e.disabled),o.Y8G("ngClass",e.class),o.BMQ("aria-disabled",e.disabled)("aria-label",e.ariaLabel||e.linkText)("title",e.title||void 0),o.R7$(),o.Y8G("ngIf",e.icon),o.R7$(),o.Y8G("textContent",e.linkText),o.R7$(),o.Y8G("ngIf",e.postIcon)}}function OPContextMenuComponent_ng_container_2_li_2_Template(e,t){if(1&e&&(o.j41(0,"li"),o.DNE(1,OPContextMenuComponent_ng_container_2_li_2_a_1_Template,4,10,"a",6)(2,OPContextMenuComponent_ng_container_2_li_2_button_2_Template,4,9,"button",6),o.k0s()),2&e){const e=o.XpG().$implicit;o.R7$(),o.Y8G("ngIf",e.href),o.R7$(),o.Y8G("ngIf",!e.href)}}function OPContextMenuComponent_ng_container_2_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,OPContextMenuComponent_ng_container_2_li_1_Template,1,0,"li",3)(2,OPContextMenuComponent_ng_container_2_li_2_Template,3,2,"li",4),o.bVm()),2&e){const e=t.$implicit;o.R7$(),o.Y8G("ngIf",e.divider),o.R7$(),o.Y8G("ngIf",!e.divider)}}class OPContextMenuComponent{constructor(e){this.locals=e,this.items=this.locals.items.filter((e=>!e?.hidden)),this.service=this.locals.service}handleClick(e,t){return!e.disabled&&!e.divider&&(!e.onClick(t)||(this.locals.service.close(),t.preventDefault(),t.stopPropagation(),!1))}static{this.ɵfac=function OPContextMenuComponent_Factory(e){return new(e||OPContextMenuComponent)(o.rXU(i.P))}}static{this.ɵcmp=o.VBU({type:OPContextMenuComponent,selectors:[["ng-component"]],decls:3,vars:6,consts:[["ng-class","{'dropdown-anchor-right': locals.showAnchorRight}",1,"dropdown-relative","dropdown","-overflow-in-view"],["role","menu",1,"dropdown-menu",3,"ngClass"],[4,"ngFor","ngForOf"],["class","dropdown-divider","role","separator",4,"ngIf"],[4,"ngIf"],["role","separator",1,"dropdown-divider"],["class","menu-item","role","menuitem",3,"ngClass","inactive","click",4,"ngIf"],["role","menuitem",1,"menu-item",3,"click","ngClass"],[3,"icon-classes",4,"ngIf"],[3,"textContent"],[3,"icon-title","icon-classes",4,"ngIf"],[3,"icon-classes"],[3,"icon-title","icon-classes"]],template:function OPContextMenuComponent_Template(e,t){1&e&&(o.j41(0,"div",0)(1,"ul",1),o.DNE(2,OPContextMenuComponent_ng_container_2_Template,3,2,"ng-container",2),o.k0s()()),2&e&&(o.BMQ("id",t.locals.contextMenuId),o.R7$(),o.Y8G("ngClass",o.eq3(4,_c0,0===t.items.length)),o.BMQ("aria-label",t.locals.label),o.R7$(),o.Y8G("ngForOf",t.items))},dependencies:[r.YU,r.Sq,r.bT,s.i],encapsulation:2})}}},67369:(e,t,n)=>{"use strict";n.d(t,{V:()=>OPContextMenuService});var i=n(9168),o=n(83093),r=n(93743),s=n(23941),a=n(41670),l=n(87879),c=n(68559);class OPContextMenuService{constructor(e,t,n,i,o){this.componentFactoryResolver=e,this.FocusHelper=t,this.appRef=n,this.$transitions=i,this.injector=o,this.active=null,this.isOpening=!1}register(){const e=document.querySelector(".op-context-menu--overlay");e?.remove();const t=this.portalHostElement=document.createElement("div");t.classList.add("op-context-menu--overlay"),document.body.appendChild(t),this.bodyPortalHost=new i.aI(t,this.componentFactoryResolver,this.appRef,this.injector),this.$transitions.onStart({},(()=>this.close())),jQuery(window).on("keydown",(e=>(this.active&&e.which===a.c.ESCAPE&&this.close(!0),!0)));const n=this,o=document.getElementById("wrapper");o&&(o.addEventListener("click",(e=>{n.active&&!n.portalHostElement.contains(e.target)&&n.close()})),o.addEventListener("scroll",(e=>{n.active&&!n.portalHostElement.contains(e.target)&&n.close()}),!0))}show(e,t,n=s.n){this.close(),this.isOpening=!0;const o=new i.A8(n,null,this.injectorFor(e.locals));this.bodyPortalHost.attach(o),this.portalHostElement.style.display="block",this.active=e,setTimeout((()=>{this.reposition(t),this.active?.onOpen(this.activeMenu),this.isOpening=!1}))}isActive(e){return!!this.active&&this.active===e}close(e=!1){this.isOpening||(this.bodyPortalHost.detach(),this.portalHostElement.style.display="none",this.active?.onClose(e),this.active=null)}reposition(e){this.active&&this.activeMenu.position(this.active.positionArgs(e)).css("visibility","visible")}get activeMenu(){return jQuery(this.portalHostElement).find(".dropdown")}injectorFor(e){const t=new WeakMap;return e.service=this,t.set(r.P,e),new i.JP(this.injector,t)}static{this.ɵfac=function OPContextMenuService_Factory(e){return new(e||OPContextMenuService)(c.KVO(c.OM3),c.KVO(l.k),c.KVO(c.o8S),c.KVO(o.HN),c.KVO(c.zZn))}}static{this.ɵprov=c.jDH({token:OPContextMenuService,factory:OPContextMenuService.ɵfac,providedIn:"root"})}}},93743:(e,t,n)=>{"use strict";n.d(t,{P:()=>i});const i=new(n(68559).nKC)("CONTEXT_MENU_LOCALS")},61944:(e,t,n)=>{"use strict";n.d(t,{T:()=>WorkPackageSingleContextMenuDirective});var i=n(24398),o=n(83093),r=n(2183),s=n(67820),a=n(73014),l=(n(68643),n(65046)),c=n(11284),p=n(67369),d=n(87207),u=n(51133),h=n(36777),m=n(1758),g=n(85254),f=n(27160);class WorkPackageAuthorization{constructor(e,t,n){this.workPackage=e,this.PathHelper=t,this.$state=n,this.project=e.project}linkForAction(e){let t;switch(e.key){case"copy":t=this.copyLink();break;case"copy_link_to_clipboard":t=this.shortLink();break;case"copy_to_other_project":t=this.bulkCopyLink();break;default:t=this.workPackage[e.link].href}return{...e,link:t}}isPermitted(e){return void 0!==this.workPackage[e.link]}permittedActionKeys(e){return e.filter((e=>this.isPermitted(e))).map((e=>e.key))}permittedActionsWithLinks(e){return e.filter((e=>this.isPermitted(e))).map((e=>this.linkForAction(e)))}copyLink(){return 0===this.$state.current.name.indexOf("work-packages.partitioned.list.details")?this.PathHelper.workPackageDetailsCopyPath(this.project.identifier,this.workPackage.id):this.PathHelper.workPackageCopyPath(this.workPackage.id)}shortLink(){return this.PathHelper.workPackageShortPath(this.workPackage.id)}bulkCopyLink(){return`${this.PathHelper.staticBase}/work_packages/move/new?copy=true&ids[]=${this.workPackage.id}`}}var b=n(6923),k=n(88535),v=n(68559);class WorkPackageSingleContextMenuDirective extends c.i{constructor(e,t,n,i,o,r,s,a,l,c){super(o,a),this.HookService=e,this.$state=t,this.injector=n,this.PathHelper=i,this.elementRef=o,this.opModalService=r,this.turboRequests=s,this.opContextMenuService=a,this.authorisationService=l,this.copyToClipboardService=c}open(e){this.workPackage.project.$load().then((()=>{this.authorisationService.initModelAuth("work_package",this.workPackage.$links);const t=new WorkPackageAuthorization(this.workPackage,this.PathHelper,this.$state),n=this.getPermittedActions(t);this.buildItems(n),this.opContextMenu.show(this,e)}))}triggerContextMenuAction(e,t){const{link:n}=e;switch(t){case"copy_to_other_project":window.location.href=`${this.PathHelper.staticBase}/work_packages/move/new?copy=true&ids[]=${this.workPackage.id}`;break;case"copy":this.$state.go("work-packages.copy",{copiedFromWorkPackageId:this.workPackage.id});break;case"delete":this.opModalService.show(f.g,this.injector,{workPackages:[this.workPackage]});break;case"log_time":this.timeEntryCreateService.create(b(new Date),this.workPackage,{showWorkPackageField:!1}).catch((()=>{}));break;case"generate_pdf":this.turboRequests.requestStream(n);break;case"copy_link_to_clipboard":{const e=new URL(String(n),window.location.origin);this.copyToClipboardService.copy(e.toString());break}default:window.location.href=n}}positionArgs(e){const t=super.positionArgs(e);return _.assign(t,{my:"right top",at:"right bottom"}),t}getPermittedActions(e){const t=e.permittedActionsWithLinks(d.P);return _.each(this.getPermittedPluginActions(e),(e=>{const n=e.indexBy?e.indexBy(t):t.length;t.splice(n,0,e)})),t}getPermittedPluginActions(e){const t=this.HookService.call("workPackageSingleContextMenu");return e.permittedActionsWithLinks(t)}buildItems(e){const t=this.workPackage.configureForm;return this.items=e.map((e=>{const{key:t}=e;return{disabled:!1,linkText:I18n.t(`js.button_${t}`),href:e.link,icon:e.icon||`icon-${t}`,onClick:n=>(!e.link||!(0,r.R)(n))&&(this.triggerContextMenuAction(e,t),!0)}})),t&&this.items.push({href:t.href,icon:"icon-settings3",linkText:I18n.t("js.button_configure-form"),onClick:()=>!1}),this.items}static{this.ɵfac=function WorkPackageSingleContextMenuDirective_Factory(e){return new(e||WorkPackageSingleContextMenuDirective)(v.rXU(l.R),v.rXU(o.dw),v.rXU(v.zZn),v.rXU(a.B),v.rXU(v.aKT),v.rXU(u.a),v.rXU(k.W),v.rXU(p.V),v.rXU(s._),v.rXU(h.g))}}static{this.ɵdir=v.FsC({type:WorkPackageSingleContextMenuDirective,selectors:[["","wpSingleContextMenu",""]],inputs:{workPackage:[v.Mj6.None,"wpSingleContextMenu-workPackage","workPackage"]},features:[v.Vt3]})}}(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",g.h)],WorkPackageSingleContextMenuDirective.prototype,"timeEntryCreateService",void 0)},87207:(e,t,n)=>{"use strict";n.d(t,{P:()=>i});const i=[{key:"copy_link_to_clipboard",icon:"icon-clipboard",link:"id"},{key:"log_time",link:"logTime"},{key:"change_project",icon:"icon-move",link:"move"},{key:"duplicate",icon:"icon-copy",link:"copy"},{key:"copy_to_other_project",link:"copy",icon:"icon-project-types"},{key:"delete",link:"delete"},{key:"export-pdf",link:"pdf"},{key:"generate_pdf",link:"generate_pdf",icon:"icon-export-pdf-with-descriptions"},{key:"export-atom",link:"atom"}]},56439:(e,t,n)=>{"use strict";n.d(t,{L:()=>WorkPackageViewContextMenu});var i=n(24398),o=n(72790),r=n(13432),s=n(90941),a=n(29925),l=n(2183),c=n(65661),p=n(67369),d=n(87207),u=n(51133),h=n(83093),m=n(1758),g=n(36777),f=n(85254),b=n(69728),k=n(27160),v=n(97366),C=n(73014),y=n(6923);class WorkPackageViewContextMenu extends c.y{constructor(e,t,n,i={},o=!0){super(e.get(p.V)),this.injector=e,this.workPackageId=t,this.$element=n,this.additionalPositionArgs=i,this.allowSplitScreenActions=o,this.workPackage=this.states.workPackages.get(this.workPackageId).value,this.selectedWorkPackages=this.getSelectedWorkPackages(),this.permittedActions=this.WorkPackageContextMenuHelper.getPermittedActions(this.selectedWorkPackages,d.P,this.allowSplitScreenActions),this.baseRoute=this.$state.current.data.baseRoute||this.$state.current.name,this.items=this.buildItems(),this.copyToClipboardService=e.get(g.g)}get locals(){return{contextMenuId:"work-package-context-menu",label:I18n.t("js.label_work_package_context_menu"),items:this.items}}positionArgs(e){const t=super.positionArgs(e);return _.assign(t,this.additionalPositionArgs),t}triggerContextMenuAction(e){const{link:t}=e,n=this.workPackage.id;switch(e.key){case"delete":this.deleteSelectedWorkPackages();break;case"edit":this.editSelectedWorkPackages(t);break;case"copy":this.copySelectedWorkPackages(t);break;case"copy_link_to_clipboard":{const e=new URL(String(t),window.location.origin);this.copyToClipboardService.copy(e.toString());break}case"copy_to_other_project":window.location.href=`${this.pathHelper.staticBase}/work_packages/move/new?copy=true&ids[]=${n}`;break;case"relation-new-child":this.wpRelationsHierarchyService.addNewChildWp(this.baseRoute,this.workPackage);break;case"log_time":this.logTimeForSelectedWorkPackage();break;case"relations":this.$state.go(`${(0,b.N)(this.$state)}.tabs`,{workPackageId:this.workPackageId,tabIdentifier:"relations"});break;default:window.location.href=t}}deleteSelectedWorkPackages(){const e=this.getSelectedWorkPackages();this.opModalService.show(k.g,this.injector,{workPackages:e})}editSelectedWorkPackages(e){this.getSelectedWorkPackages().length>1&&(window.location.href=e)}copySelectedWorkPackages(e){const t=this.getSelectedWorkPackages();if(t.length>1)return void(window.location.href=e);const n={copiedFromWorkPackageId:t[0].id};this.$state.go(`${this.baseRoute}.copy`,n)}logTimeForSelectedWorkPackage(){this.timeEntryCreateService.create(y(new Date),this.workPackage).catch((()=>{}))}getSelectedWorkPackages(){const e=this.wpTableSelection.getSelectedWorkPackages();return 0===e.length?[this.workPackage]:(-1===e.indexOf(this.workPackage)&&e.push(this.workPackage),e)}buildItems(){const e=this.permittedActions.map((e=>({class:void 0,disabled:!1,linkText:e.text,href:e.href,icon:null!=e.icon?e.icon:`icon-${e.key}`,onClick:t=>(!e.href||!(0,l.R)(t))&&(this.triggerContextMenuAction(e),!0)})));return(0,v.A)(this.workPackage)||(e.unshift({disabled:!1,icon:"icon-view-fullscreen",class:"openFullScreenView",href:this.$state.href("work-packages.show",{workPackageId:this.workPackageId}),linkText:I18n.t("js.button_open_fullscreen"),onClick:e=>!(0,l.R)(e)&&(this.$state.go("work-packages.show",{workPackageId:this.workPackageId}),!0)}),this.allowSplitScreenActions&&e.unshift({disabled:!1,icon:"icon-view-split",class:"detailsViewMenuItem",href:this.$state.href(`${(0,b.N)(this.$state)}.tabs`,{workPackageId:this.workPackageId,tabIdentifier:"overview"}),linkText:I18n.t("js.button_open_details"),onClick:e=>!(0,l.R)(e)&&(this.$state.go(`${(0,b.N)(this.$state)}.tabs`,{workPackageId:this.workPackageId,tabIdentifier:"overview"}),!0)})),e}}(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",r.D)],WorkPackageViewContextMenu.prototype,"states",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",s.F)],WorkPackageViewContextMenu.prototype,"wpRelationsHierarchyService",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",u.a)],WorkPackageViewContextMenu.prototype,"opModalService",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",h.dw)],WorkPackageViewContextMenu.prototype,"$state",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",a.a)],WorkPackageViewContextMenu.prototype,"wpTableSelection",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",o.R)],WorkPackageViewContextMenu.prototype,"WorkPackageContextMenuHelper",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",f.h)],WorkPackageViewContextMenu.prototype,"timeEntryCreateService",void 0),(0,i.Cg)([(0,m.O)(),(0,i.Sn)("design:type",C.B)],WorkPackageViewContextMenu.prototype,"pathHelper",void 0)},95695:(e,t,n)=>{"use strict";n.d(t,{k:()=>OpNonWorkingDaysListComponent});var i=n(99972),o=n(61816),r=n(51133),s=n(73014),a=n(37749),l=n(87997),c=n(41960),p=n(14593),d=n(42032),u=n(25073),h=n(48908),m=n(72650),g=n(6923),f=n(1042),b=n(68559),k=n(60316),v=n(34456),C=n(18240),y=n(88294),w=n(34342);function OpNonWorkingDaysListComponent_full_calendar_0_Template(e,t){if(1&e&&b.nrm(0,"full-calendar",10,0),2&e){const e=b.XpG();b.Y8G("options",e.calendarOptions)}}function OpNonWorkingDaysListComponent_ng_container_1_ng_container_1_Template(e,t){if(1&e&&(b.qex(0),b.nrm(1,"input",12)(2,"input",12),b.bVm()),2&e){const e=b.XpG().$implicit;b.R7$(),b.Mz_("name","settings[non_working_days_attributes][",e.date,"][date]"),b.Y8G("value",e.date),b.R7$(),b.Mz_("name","settings[non_working_days_attributes][",e.date,"][name]"),b.Y8G("value",e.name)}}function OpNonWorkingDaysListComponent_ng_container_1_ng_container_2_Template(e,t){if(1&e&&(b.qex(0),b.nrm(1,"input",12)(2,"input",13),b.bVm()),2&e){const e=b.XpG().$implicit;b.R7$(),b.Mz_("name","settings[non_working_days_attributes][",e.id,"][id]"),b.Y8G("value",e.id),b.R7$(),b.Mz_("name","settings[non_working_days_attributes][",e.id,"][_destroy]")}}function OpNonWorkingDaysListComponent_ng_container_1_Template(e,t){if(1&e&&(b.qex(0),b.DNE(1,OpNonWorkingDaysListComponent_ng_container_1_ng_container_1_Template,3,6,"ng-container",11)(2,OpNonWorkingDaysListComponent_ng_container_1_ng_container_2_Template,3,5,"ng-container",11),b.bVm()),2&e){const e=t.$implicit;b.R7$(),b.Y8G("ngIf",!e.id),b.R7$(),b.Y8G("ngIf",e.id&&e._destroy)}}class OpNonWorkingDaysListComponent{constructor(e,t,n,i,o,r,s,l,p,d,h){this.elementRef=e,this.I18n=t,this.bannersService=n,this.opModalService=i,this.injector=o,this.pathHelper=r,this.apiV3Service=s,this.dayService=l,this.confirmDialogService=p,this.toast=d,this.cdRef=h,this.className=!0,this.modifiedNonWorkingDays=[],this.text={empty_state_header:this.I18n.t("js.admin.working_days.calendar.empty_state_header"),empty_state_description:this.I18n.t("js.admin.working_days.calendar.empty_state_description"),already_added_error:this.I18n.t("js.admin.working_days.already_added_error"),new_date:this.I18n.t("js.admin.working_days.calendar.new_date"),add_non_working_day:this.I18n.t("js.admin.working_days.add_non_working_day"),change_description:this.I18n.t("js.admin.working_days.change_description"),warning:this.I18n.t("js.admin.working_days.warning"),change_button:this.I18n.t("js.admin.working_days.change_button"),change_title:this.I18n.t("js.admin.working_days.change_title"),removed_title:this.I18n.t("js.admin.working_days.removed_title"),non_working_day_name:this.I18n.t("js.modals.label_name"),add:this.I18n.t("js.button_add")},this.form_submitted=!1,this.originalNonWorkingDays=[],this.nonWorkingDays=[],this.originalWorkingDays=[],this.datepickerOpened=!1,this.selectedNonWorkingDayName="",this.calendarOptions={locales:f.A,locale:this.I18n.locale,plugins:[c.A],initialView:"listYear",contentHeight:"auto",headerToolbar:{right:"",center:"",left:"prev,next,title"},events:this.calendarEventsFunction.bind(this),eventDidMount:e=>{const{el:t,event:n}=e,i=document.createElement("td"),o=document.createElement("a");o.title="Delete",o.href="#",o.classList.add("fc-list-day-side-text","op-non-working-days-list--delete-icon"),o.appendChild((0,u.N)("icon","icon-delete")),o.addEventListener("click",(()=>{this.nonWorkingDays=this.nonWorkingDays.map((e=>e.date===n.id?{...e,_destroy:!0}:e)),n.remove(),this.cdRef.detectChanges()})),i.appendChild(o),t.appendChild(i)},noEventsContent:{html:`<table class="fc-list-table"><tbody><th><div class="fc-list-day-cushion"><a class="fc-list-day-text">${this.text.empty_state_header}</a></div></th><tr class="fc-event"><td>${this.text.empty_state_description}</td></tr></tbody></table>`}},(0,a.w)(this),this.listenToFormSubmit()}listenToFormSubmit(){this.elementRef.nativeElement.closest("form").addEventListener("submit",(e=>{if(!this.form_submitted&&(this.nonWorkingDaysModified()||this.workingDaysModified())){this.form_submitted=!0;const t=e.target,n={text:{text:this.text.change_description,title:this.text.change_title,button_continue:this.text.change_button},dangerHighlighting:!0,divideContent:!0,refreshOnCancel:!0,showListData:this.removedNonWorkingDays.length>0,warningText:this.text.warning,passedData:this.removedNonWorkingDays,listTitle:this.text.removed_title};e.preventDefault(),this.confirmDialogService.confirm(n).then((()=>{this.form_submitted=!1,t.submit()}))}}))}ngOnInit(){this.modifiedNonWorkingDays.forEach((e=>{this.nonWorkingDays.push({...e})})),this.cdRef.detectChanges()}ngAfterViewInit(){const e=this.elementRef.nativeElement.closest("form");Array.from(e.querySelectorAll('input[name="settings[working_days][]"]')).forEach((e=>{e.checked&&this.originalWorkingDays.push(e.value)}))}get removedNonWorkingDays(){return this.nonWorkingDays.filter((e=>e._destroy)).map((e=>g(e.date).format("MMMM DD, YYYY")))}calendarEventsFunction(e,t,n){this.dayService.requireNonWorkingYear$(e.start).subscribe((e=>{this.nonWorkingDays=_.uniqBy([...this.nonWorkingDays,...e],(e=>e.date)).filter((e=>!this.nonWorkingDays.find((t=>t.id===e.id&&t._destroy)))),this.originalNonWorkingDays=[...this.nonWorkingDays];const n=this.mapToCalendarEvents(this.nonWorkingDays);t(n),this.cdRef.detectChanges()}),n)}mapToCalendarEvents(e){return e.filter((e=>!0!==e._destroy)).map((e=>({title:e.name,start:e.date,id:e.date})))}addNonWorkingDay(e){const t=this.selectedNonWorkingDayName;if(this.selectedNonWorkingDayName="",!e||""===e||!t||""===t)return;const n={start:e,id:null,name:t,date:e,title:t},i=this.ucCalendar.getApi();i.getEventById(e)?this.toast.addError(this.text.already_added_error):(this.nonWorkingDays=[...this.nonWorkingDays,n],i.addEvent({...n,id:e}))}get workingDays(){const e=[],t=this.elementRef.nativeElement.closest("form");return Array.from(t.querySelectorAll('input[name="settings[working_days][]"]')).forEach((t=>{t.checked&&e.push(t.value)})),e}nonWorkingDaysModified(){return this.removedNonWorkingDays.length>0||this.modifiedNonWorkingDays.length>0||this.nonWorkingDays.length>this.originalNonWorkingDays.length}workingDaysModified(){return _.difference(this.workingDays,this.originalWorkingDays).length>0||_.difference(this.originalWorkingDays,this.workingDays).length>0}static{this.ɵfac=function OpNonWorkingDaysListComponent_Factory(e){return new(e||OpNonWorkingDaysListComponent)(b.rXU(b.aKT),b.rXU(o.W),b.rXU(i.b),b.rXU(r.a),b.rXU(b.zZn),b.rXU(s.B),b.rXU(p.n),b.rXU(d.o),b.rXU(h.g),b.rXU(m.fw),b.rXU(b.gRc))}}static{this.ɵcmp=b.VBU({type:OpNonWorkingDaysListComponent,selectors:[["opce-non-working-days-list"]],viewQuery:function OpNonWorkingDaysListComponent_Query(e,t){if(1&e&&b.GBs(l.x,5),2&e){let e;b.mGM(e=b.lsd())&&(t.ucCalendar=e.first)}},hostVars:2,hostBindings:function OpNonWorkingDaysListComponent_HostBindings(e,t){2&e&&b.AVh("op-non-working-days-list",t.className)},inputs:{modifiedNonWorkingDays:"modifiedNonWorkingDays"},decls:9,vars:14,consts:[["ucCalendar",""],["class","op-non-working-days-list--calendar",3,"options",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"op-non-working-days-list--add-button"],["id","test","name","test",3,"closed","valueChange","showIgnoreNonWorkingDays","opened","required","name","applyLabel"],["slot","extra-fields",3,"required","label"],["name","name","slot","input",3,"ngModelChange","required","ngModel","showClearButton"],["slot","trigger","type","button",1,"spot-link","op-non-working-days-list--add-button",3,"click"],[1,"spot-icon","spot-icon_add"],[3,"textContent"],[1,"op-non-working-days-list--calendar",3,"options"],[4,"ngIf"],["type","hidden",3,"name","value"],["type","hidden","value","true",3,"name"]],template:function OpNonWorkingDaysListComponent_Template(e,t){1&e&&(b.DNE(0,OpNonWorkingDaysListComponent_full_calendar_0_Template,2,1,"full-calendar",1)(1,OpNonWorkingDaysListComponent_ng_container_1_Template,3,2,"ng-container",2),b.j41(2,"div",3)(3,"op-modal-single-date-picker",4),b.bIt("closed",(function OpNonWorkingDaysListComponent_Template_op_modal_single_date_picker_closed_3_listener(){return t.datepickerOpened=!1}))("valueChange",(function OpNonWorkingDaysListComponent_Template_op_modal_single_date_picker_valueChange_3_listener(e){return t.addNonWorkingDay(e)})),b.j41(4,"spot-form-field",5)(5,"spot-text-field",6),b.mxI("ngModelChange",(function OpNonWorkingDaysListComponent_Template_spot_text_field_ngModelChange_5_listener(e){return b.DH7(t.selectedNonWorkingDayName,e)||(t.selectedNonWorkingDayName=e),e})),b.k0s()(),b.j41(6,"button",7),b.bIt("click",(function OpNonWorkingDaysListComponent_Template_button_click_6_listener(){return t.datepickerOpened=!0})),b.nrm(7,"span",8)(8,"span",9),b.k0s()()()),2&e&&(b.Y8G("ngIf",t.calendarOptions),b.R7$(),b.Y8G("ngForOf",t.nonWorkingDays),b.R7$(2),b.Y8G("showIgnoreNonWorkingDays",!1)("opened",t.datepickerOpened)("required",!0)("showIgnoreNonWorkingDays",!1)("name",t.text.add_non_working_day)("applyLabel",t.text.add),b.R7$(),b.Y8G("required",!0)("label",t.text.non_working_day_name),b.R7$(),b.Y8G("required",!0),b.R50("ngModel",t.selectedNonWorkingDayName),b.Y8G("showClearButton",!1),b.R7$(3),b.Y8G("textContent",t.text.add_non_working_day))},dependencies:[k.Sq,k.bT,v.BC,v.YS,v.vS,C.l,y.U,l.x,w.c],styles:[".op-non-working-days-list .fc-list-event-graphic{display:none}.op-non-working-days-list--delete-icon{opacity:0}.op-non-working-days-list--add-button{padding:.5rem 0}.op-non-working-days-list .fc-list-event:hover .op-non-working-days-list--delete-icon{opacity:1}.op-non-working-days-list .fc-list-empty{display:unset!important;background:inherit}.op-non-working-days-list .fc-list-empty-cushion{margin:auto!important}.op-non-working-days-list .fc-list-day-cushion a{cursor:default;color:#000;text-decoration:none}.op-non-working-days-list .fc-list-event-title a{cursor:text}.op-non-working-days-list .fc-toolbar h2{display:inline;margin:.25rem .5rem;padding-top:1px;position:absolute}@media screen and (max-width: 543px){.op-non-working-days-list .op-non-working-days-list--delete-icon{opacity:1}}\n"],encapsulation:2,changeDetection:0})}}},23906:(e,t,n)=>{"use strict";n.d(t,{M:()=>StaticQueriesService});var i=n(61816),o=n(83093),r=n(68559);class StaticQueriesService{constructor(e,t){this.I18n=e,this.$state=t,this.text={work_packages:this.I18n.t("js.label_work_package_plural"),all_open:this.I18n.t("js.work_packages.default_queries.all_open")}}getStaticName(e){if(this.$state.params.query_props){const e=this.$state.params.name;if(e)return this.I18n.t(`js.work_packages.default_queries.${e}`)}return 1===e.filters.length&&"status"===e.filters[0].id&&"o"===e.filters[0].operator.id?this.text.all_open:this.text.work_packages}static{this.ɵfac=function StaticQueriesService_Factory(e){return new(e||StaticQueriesService)(r.KVO(i.W),r.KVO(o.dw))}}static{this.ɵprov=r.jDH({token:StaticQueriesService,factory:StaticQueriesService.ɵfac})}}},13469:(e,t,n)=>{"use strict";n.d(t,{S:()=>OpOptionListComponent});var i=n(68559),o=n(34456),r=n(60316);function OpOptionListComponent_label_0_p_5_Template(e,t){if(1&e&&i.nrm(0,"p",4),2&e){const e=i.XpG().$implicit;i.Y8G("innerHTML",e.description,i.npT)}}function OpOptionListComponent_label_0_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"label")(1,"input",1),i.mxI("ngModelChange",(function OpOptionListComponent_label_0_Template_input_ngModelChange_1_listener(t){i.eBV(e);const n=i.XpG();return i.DH7(n.selected,t)||(n.selected=t),i.Njj(t)})),i.k0s(),i.j41(2,"div")(3,"p",2),i.EFF(4),i.k0s(),i.DNE(5,OpOptionListComponent_label_0_p_5_Template,1,1,"p",3),i.k0s()()}if(2&e){const e=t.$implicit,n=i.XpG();i.HbH(n.getClassListForItem(e)),i.R7$(),i.Y8G("value",e.value),i.R50("ngModel",n.selected),i.Y8G("disabled",e.disabled),i.BMQ("name",n.name),i.R7$(3),i.JRh(e.title),i.R7$(),i.Y8G("ngIf",e.description)}}class OpOptionListComponent{constructor(){this.className=!0,this.options=[],this.name="op-option-list-"+ +new Date,this.selectedChange=new i.bkB,this._selected=null,this.onChange=e=>{},this.onTouched=e=>{}}get selected(){return this._selected}set selected(e){this._selected=e,this.onChange(e)}getClassListForItem(e){return{"op-option-list--item":!0,"op-option-list--item_selected":this.selected===e.value,"op-option-list--item_disabled":!!e.disabled}}writeValue(e){this._selected=e}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}static{this.ɵfac=function OpOptionListComponent_Factory(e){return new(e||OpOptionListComponent)}}static{this.ɵcmp=i.VBU({type:OpOptionListComponent,selectors:[["op-option-list"]],hostVars:2,hostBindings:function OpOptionListComponent_HostBindings(e,t){2&e&&i.AVh("op-option-list",t.className)},inputs:{options:"options",name:"name"},outputs:{selectedChange:"selectedChange"},features:[i.Jv_([{provide:o.kq,useExisting:(0,i.Rfq)((()=>OpOptionListComponent)),multi:!0}])],decls:1,vars:1,consts:[[3,"class",4,"ngFor","ngForOf"],["type","radio",1,"op-option-list--input",3,"ngModelChange","value","ngModel","disabled"],[1,"op-option-list--item-title"],["class","op-option-list--item-description",3,"innerHTML",4,"ngIf"],[1,"op-option-list--item-description",3,"innerHTML"]],template:function OpOptionListComponent_Template(e,t){1&e&&i.DNE(0,OpOptionListComponent_label_0_Template,6,8,"label",0),2&e&&i.Y8G("ngForOf",t.options)},dependencies:[r.Sq,r.bT,o.me,o.Fm,o.BC,o.vS],encapsulation:2})}}},94221:(e,t,n)=>{"use strict";n.d(t,{f:()=>PersistentToggleComponent});var i=n(68559);class PersistentToggleComponent{constructor(e){this.elementRef=e,this.isHidden=!1}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.$targetNotification=this.getTargetNotification(),this.identifier=this.$element.data("identifier"),this.isHidden="true"===window.OpenProject.guardedLocalStorage(this.identifier),this.$targetNotification.prop("hidden",!!this.isHidden),this.$element.parent().find(".persistent-toggle--click-handler").on("click",(()=>this.toggle(!this.isHidden))),this.$targetNotification.find(".op-toast--close").on("click",(()=>this.toggle(!0)))}getTargetNotification(){return this.$element.parent().find(".persistent-toggle--toaster")}toggle(e){this.isHidden=e,window.OpenProject.guardedLocalStorage(this.identifier,(!!e).toString()),e?this.$targetNotification.slideUp(400,(()=>{this.$targetNotification.prop("hidden",!0)})):(this.$targetNotification.slideDown(400),this.$targetNotification.prop("hidden",!1))}static{this.ɵfac=function PersistentToggleComponent_Factory(e){return new(e||PersistentToggleComponent)(i.rXU(i.aKT))}}static{this.ɵcmp=i.VBU({type:PersistentToggleComponent,selectors:[["opce-persistent-toggle"]],decls:0,vars:0,template:function PersistentToggleComponent_Template(e,t){},encapsulation:2})}}},65896:(e,t,n)=>{"use strict";n.d(t,{r:()=>PrincipalRendererService});var i=n(73014),o=n(55939),r=n(14593),s=n(12313);function hrefFromPrincipal(e){if(e.href)return e.href||"";if(e._links){return e._links.self.href||""}return""}var a=n(17732),l=n(68559);class PrincipalRendererService{constructor(e,t,n){this.pathHelper=e,this.apiV3Service=t,this.colors=n}renderAbbreviated(e,t,n=2,i={hide:!1,link:!1},o={hide:!1,size:"medium"}){const r=document.createElement("div"),s=document.createElement("div");r.classList.add("op-principal-list"),s.classList.add("op-principal-list--principals"),r.appendChild(s),e.appendChild(r);const a=_.take(t,n);if(this.renderMultiple(s,a,i,o,!1),t.length>n){const e=document.createElement("span");e.classList.add("op-principal-list--badge","badge","-secondary"),e.textContent=t.length.toString(),r.appendChild(e)}}renderMultiple(e,t,n={hide:!1,link:!1},i={hide:!1,size:"default"},o=!1){for(let r=0;r<t.length;r++){const s=document.createElement("span");if(o&&s.classList.add("op-principal--multi-line"),this.render(s,t[r],n,i),e.appendChild(s),!o&&r<t.length-1){const t=document.createElement("span");t.textContent=", ",t.classList.add("op-principal-list--separator"),e.appendChild(t)}}}render(e,t,n={hide:!1,link:!0},i={hide:!1,size:"default"},o=null){e.dataset.testSelector||(e.dataset.testSelector="op-principal"),e.classList.add("op-principal");const r=function typeFromHref(e){const t=/\/(user|group|placeholder_user|external_user)s\/\d+$/.exec(e);return t?t[1]:null}(hrefFromPrincipal(t));if("user"!==r&&(i.hoverCard=void 0),!i.hide){const n=this.renderAvatar(t,i,r);e.appendChild(n)}if(!n.hide){const i=this.renderName(t,r,n.link,o||t.name,n.classes);e.appendChild(i)}}renderAvatar(e,t,n){const i=this.getInitials(e.name),r=this.colors.colorMode(),s=`${e.id}${e.name}`,a=this.colors.toHsl(s,r),l=document.createElement("div");return l.classList.add("op-principal--avatar"),l.classList.add("op-avatar"),l.classList.add(`op-avatar_${t.size}`),l.classList.add(`op-avatar_${n.replace("_","-")}`),l.classList.add("op-avatar--fallback"),l.title=e.name,l.textContent=i,this.setHoverCardAttributes(l,t,e),"placeholder_user"===n&&r!==o.s.lightHighContrast?(l.style.color=a,l.style.borderColor=a):l.style.background=a,"user"===n&&this.renderUserAvatar(e,l,t),l}renderUserAvatar(e,t,n){const i=this.userAvatarUrl(e);if(!i)return;const o=new Image;o.classList.add("op-principal--avatar"),o.classList.add("op-avatar"),o.classList.add(`op-avatar_${n.size}`),this.setHoverCardAttributes(o,n,e),o.src=i,o.title=e.name,o.alt=e.name,o.onload=()=>{t.replaceWith(o),t=void 0}}userAvatarUrl(e){const t=e.id||(0,s.A)(hrefFromPrincipal(e));return t?this.apiV3Service.users.id(t).avatar.toString():null}userHoverCardUrl(e){const t=e.id||(0,s.A)(hrefFromPrincipal(e));return t?this.pathHelper.userHoverCardPath(t):null}renderName(e,t,n=!0,i="",o=""){if(n){const n=document.createElement("a");return n.textContent=e.name,n.href=this.principalURL(e,t),n.target="_blank",n.classList.add("op-principal--name"),n.title=i,n}const r=document.createElement("span");return r.textContent=e.name,r.classList.add("op-principal--name"),r.title=i,""!==o&&o.split(" ").forEach((e=>{r.classList.add(e)})),r}principalURL(e,t){const n=hrefFromPrincipal(e),i=e.id||(n?(0,s.A)(n):"");switch(t){case"group":return this.pathHelper.groupPath(i);case"placeholder_user":return this.pathHelper.placeholderUserPath(i);case"user":return this.pathHelper.userPath(i);default:throw new Error("Invalid principal type provided")}}getInitials(e){const t=[...e],n=e.lastIndexOf(" "),i=t[0]?.toUpperCase();if(-1===n)return i;const o=e[n+1]?.toUpperCase();return[i,o].join("")}setHoverCardAttributes(e,t,n){const i=t.hoverCard;if(!i?.url){const e=this.userHoverCardUrl(n);if(!i||!e)return;i.url=e}e.classList.add("op-hover-card--preview-trigger"),e.setAttribute("data-hover-card-url",i.url),e.setAttribute("data-hover-card-target",String(i.modalTarget||a.V.Default))}static{this.ɵfac=function PrincipalRendererService_Factory(e){return new(e||PrincipalRendererService)(l.KVO(i.B),l.KVO(r.n),l.KVO(o.e))}}static{this.ɵprov=l.jDH({token:PrincipalRendererService,factory:PrincipalRendererService.ɵfac,providedIn:"root"})}}},54547:(e,t,n)=>{"use strict";n.d(t,{W:()=>OpenprojectPrincipalRenderingModule});var i=n(60316),o=n(48377),r=n(65896),s=n(68559);class OpenprojectPrincipalRenderingModule{constructor(e){this.injector=e}static{this.ɵfac=function OpenprojectPrincipalRenderingModule_Factory(e){return new(e||OpenprojectPrincipalRenderingModule)(s.KVO(s.zZn))}}static{this.ɵmod=s.$C({type:OpenprojectPrincipalRenderingModule})}static{this.ɵinj=s.G2t({providers:[r.r],imports:[i.MD]})}}("undefined"==typeof ngJitMode||ngJitMode)&&s.Obh(OpenprojectPrincipalRenderingModule,{declarations:[o.f],imports:[i.MD],exports:[o.f]})},48377:(e,t,n)=>{"use strict";n.d(t,{f:()=>OpPrincipalComponent});var i=n(61816),o=n(73014),r=n(14593),s=n(32420),a=n(65896),l=n(37749),c=n(24443),p=n(17732),d=n(68559);class OpPrincipalComponent{constructor(e,t,n,i,o,r,s,a){this.elementRef=e,this.PathHelper=t,this.principalRenderer=n,this.principalResourceService=i,this.I18n=o,this.apiV3Service=r,this.timezoneService=s,this.cdRef=a,this.hideAvatar=!1,this.hideName=!1,this.nameClasses="",this.link=!0,this.size="default",this.avatarClasses="",this.hoverCard=!0,this.hoverCardUrl="",this.hoverCardModalTarget="default",this.title="",(0,l.w)(this)}ngOnInit(){if(this.principal.name){const e={hide:this.hideAvatar,size:this.size};this.hoverCard&&(e.hoverCard={url:this.hoverCardUrl,modalTarget:"custom"===this.hoverCardModalTarget?p.V.Custom:p.V.Default}),this.principalRenderer.render(this.elementRef.nativeElement,this.principal,{hide:this.hideName,link:this.link,classes:this.nameClasses},e,""===this.title?null:this.title)}}static{this.ɵfac=function OpPrincipalComponent_Factory(e){return new(e||OpPrincipalComponent)(d.rXU(d.aKT),d.rXU(o.B),d.rXU(a.r),d.rXU(c.V),d.rXU(i.W),d.rXU(r.n),d.rXU(s.D),d.rXU(d.gRc))}}static{this.ɵcmp=d.VBU({type:OpPrincipalComponent,selectors:[["op-principal"]],inputs:{principal:"principal",hideAvatar:"hideAvatar",hideName:"hideName",nameClasses:"nameClasses",link:"link",size:"size",avatarClasses:"avatarClasses",hoverCard:"hoverCard",hoverCardUrl:"hoverCardUrl",hoverCardModalTarget:"hoverCardModalTarget",title:"title"},decls:0,vars:0,template:function OpPrincipalComponent_Template(e,t){},styles:[".cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-principal--timer{display:inline-flex;justify-content:center;align-items:center;box-sizing:content-box;height:16px;line-height:16px;width:16px;border-radius:.5rem;padding:0 .15rem;font-size:.7rem;font-weight:var(--base-text-weight-bold);background:var(--bgColor-accent-emphasis);color:#fff;flex-shrink:0;position:absolute;top:10px;right:3px;background:#8b0000}\n"],encapsulation:2,changeDetection:0})}}},61396:(e,t,n)=>{"use strict";n.d(t,{X:()=>insertInList});const insertInList=(e,t,n,i)=>{const o=i.filter((e=>"urn:openproject-org:api:v3:undisclosed"!==e.href));if(!o.length)return[...n,{id:t.id,name:t.name,href:t._links.self.href,disabled:!1,children:[],position:0}];const r=o[0].href,s=n.find((e=>e.href===r));if(s)return s.children=insertInList(e,t,s.children,o.slice(1)),[...n];const a=e.find((e=>e._links.self.href===r));return a?[...n,{id:a.id,name:a.name,href:a._links.self.href,disabled:!0,children:insertInList(e,t,[],o.slice(1)),position:0}]:[...n]}},81151:(e,t,n)=>{"use strict";n.d(t,{Q:()=>OpProjectIncludeListComponent});var i=n(68559),o=n(61816),r=n(86866),s=n(11073),a=n(73014),l=n(73881),c=n(60316),p=n(50130),d=n(45906),u=n(26579);const h=["op-project-include-list",""],_c1=(e,t)=>({"spot-list--item-action_disabled":e,"spot-list--item-action_active":t});function OpProjectIncludeListComponent_li_0_span_9_Template(e,t){if(1&e&&(i.j41(0,"span"),i.EFF(1),i.k0s()),2&e){const e=i.XpG(2);i.R7$(),i.JRh(e.text.current_project)}}function OpProjectIncludeListComponent_li_0_ng_template_10_span_0_Template(e,t){if(1&e&&(i.j41(0,"span"),i.EFF(1),i.k0s()),2&e){const e=i.XpG(3);i.R7$(),i.JRh(e.text.include_all_selected)}}function OpProjectIncludeListComponent_li_0_ng_template_10_ng_template_1_span_0_Template(e,t){if(1&e&&(i.j41(0,"span"),i.EFF(1),i.k0s()),2&e){const e=i.XpG(4);i.R7$(),i.JRh(e.text.does_not_match_search)}}function OpProjectIncludeListComponent_li_0_ng_template_10_ng_template_1_Template(e,t){if(1&e&&i.DNE(0,OpProjectIncludeListComponent_li_0_ng_template_10_ng_template_1_span_0_Template,2,1,"span",12),2&e){const e=i.XpG(2).$implicit;i.Y8G("ngIf",e.disabled)}}function OpProjectIncludeListComponent_li_0_ng_template_10_Template(e,t){if(1&e&&i.DNE(0,OpProjectIncludeListComponent_li_0_ng_template_10_span_0_Template,2,1,"span",10)(1,OpProjectIncludeListComponent_li_0_ng_template_10_ng_template_1_Template,1,1,"ng-template",null,1,i.C5r),2&e){const e=i.sdS(2),t=i.XpG(2);i.Y8G("ngIf",t.includeSubprojects&&t.parentChecked)("ngIfElse",e)}}function OpProjectIncludeListComponent_li_0_ul_12_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"ul",13),i.bIt("update",(function OpProjectIncludeListComponent_li_0_ul_12_Template_ul_update_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.updateList(t))})),i.k0s()}if(2&e){const e=i.XpG().$implicit,t=i.XpG();i.Y8G("projects",e.children)("selected",t.selected)("includeSubprojects",t.includeSubprojects)("parentChecked",t.parentChecked||t.isChecked(e.href))("searchText",t.searchText)}}function OpProjectIncludeListComponent_li_0_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"li",3)(1,"spot-tooltip",4),i.qex(2,5),i.j41(3,"label",6),i.nI1(4,"async"),i.bIt("keydown.space",(function OpProjectIncludeListComponent_li_0_Template_label_keydown_space_3_listener(){const t=i.eBV(e).$implicit,n=i.XpG();return i.Njj(n.changeSelected(t))})),i.j41(5,"spot-checkbox",7),i.bIt("change",(function OpProjectIncludeListComponent_li_0_Template_spot_checkbox_change_5_listener(){const t=i.eBV(e).$implicit,n=i.XpG();return i.Njj(n.changeSelected(t))})),i.k0s(),i.j41(6,"div",8),i.EFF(7),i.k0s()(),i.bVm(),i.j41(8,"p",9),i.DNE(9,OpProjectIncludeListComponent_li_0_span_9_Template,2,1,"span",10)(10,OpProjectIncludeListComponent_li_0_ng_template_10_Template,3,2,"ng-template",null,0,i.C5r),i.k0s()(),i.DNE(12,OpProjectIncludeListComponent_li_0_ul_12_Template,1,5,"ul",11),i.k0s()}if(2&e){const e=t.$implicit,n=i.sdS(11),o=i.XpG();i.BMQ("data-list-selector",o.projectListItemIdentifier),i.R7$(),i.Y8G("alignment",o.getTooltipAlignment(e))("disabled",!e.disabled),i.R7$(2),i.Y8G("ngClass",i.l_i(18,_c1,e.disabled,i.bMT(4,16,o.searchableProjectListService.activeItemID$)===e.id)),i.BMQ("data-list-selector",o.projectListActionIdentifier)("data-list-disabled",e.disabled||void 0),i.R7$(2),i.Y8G("tabindex",-1)("checked",o.isChecked(e.href)||o.includeSubprojects&&o.parentChecked)("disabled",e.disabled),i.BMQ("data-qa-project-include-id",e.id)("data-qa-project-include-checked",o.isChecked(e.href)||o.includeSubprojects&&o.parentChecked?1:0),i.R7$(),i.Y8G("opSearchHighlight",o.searchText),i.R7$(),i.JRh(e.name),i.R7$(2),i.Y8G("ngIf",e.href===o.currentProjectHref)("ngIfElse",n),i.R7$(3),i.Y8G("ngIf",e.children.length)}}class OpProjectIncludeListComponent{get currentProjectHref(){return this.currentProjectService.apiv3Path}constructor(e,t,n,o){this.I18n=e,this.currentProjectService=t,this.pathHelper=n,this.searchableProjectListService=o,this.classNameList=!0,this.className=!0,this.update=new i.bkB,this.root=!1,this.projects=[],this.selected=[],this.searchText="",this.includeSubprojects=!1,this.parentChecked=!1,this.text={does_not_match_search:this.I18n.t("js.include_projects.tooltip.does_not_match_search"),include_all_selected:this.I18n.t("js.include_projects.tooltip.include_all_selected"),current_project:this.I18n.t("js.include_projects.tooltip.current_project")}}updateList(e){this.update.emit(e)}isChecked(e){return this.selected.includes(e)}changeSelected(e){if(e.disabled)return;const{href:t}=e;this.isChecked(t)?this.updateList(this.selected.filter((e=>e!==t))):this.updateList([...this.selected,t])}getTooltipAlignment(e){return e.position<=1?s.A.BottomLeft:s.A.TopLeft}extendedProjectUrl(e){const t=document.querySelector('meta[name="current_menu_item"]'),n=this.pathHelper.projectPath(e);return t?`${n}?jump=${encodeURIComponent(t.content)}`:n}static{this.ɵfac=function OpProjectIncludeListComponent_Factory(e){return new(e||OpProjectIncludeListComponent)(i.rXU(o.W),i.rXU(r.c),i.rXU(a.B),i.rXU(l.Z))}}static{this.ɵcmp=i.VBU({type:OpProjectIncludeListComponent,selectors:[["","op-project-include-list",""]],hostVars:6,hostBindings:function OpProjectIncludeListComponent_HostBindings(e,t){2&e&&i.AVh("spot-list",t.classNameList)("op-project-include-list",t.className)("op-project-include-list--root",t.root)},inputs:{root:"root",projects:"projects",selected:"selected",searchText:"searchText",includeSubprojects:"includeSubprojects",parentChecked:"parentChecked"},outputs:{update:"update"},attrs:h,decls:1,vars:1,consts:[["otherMessages",""],["searchMatch",""],["class","spot-list--item op-project-include-list--item","data-test-selector","op-project-include-list--item",4,"ngFor","ngForOf"],["data-test-selector","op-project-include-list--item",1,"spot-list--item","op-project-include-list--item"],[1,"op-project-include-list--tooltip",3,"alignment","disabled"],["slot","trigger"],["tabindex","-1",1,"spot-list--item-action","op-project-include-list--item-action",3,"keydown.space","ngClass"],[3,"change","tabindex","checked","disabled"],["data-test-selector","op-project-include-list--item-title",1,"spot-list--item-title","spot-list--item-title_ellipse-text",3,"opSearchHighlight"],["slot","body",1,"spot-body-small"],[4,"ngIf","ngIfElse"],["op-project-include-list","",3,"projects","selected","includeSubprojects","parentChecked","searchText","update",4,"ngIf"],[4,"ngIf"],["op-project-include-list","",3,"update","projects","selected","includeSubprojects","parentChecked","searchText"]],template:function OpProjectIncludeListComponent_Template(e,t){1&e&&i.DNE(0,OpProjectIncludeListComponent_li_0_Template,13,21,"li",2),2&e&&i.Y8G("ngForOf",t.projects)},dependencies:[c.YU,c.Sq,c.bT,p.h,d.H,u.p,OpProjectIncludeListComponent,c.Jj],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}[_nghost-%COMP%], .op-project-include-list[_ngcontent-%COMP%]{flex-shrink:1;flex-basis:100%}.op-project-include-list--root[_nghost-%COMP%], .op-project-include-list.op-project-include-list--root[_ngcontent-%COMP%]{overflow-y:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.op-project-include-list--root[_nghost-%COMP%]::-webkit-scrollbar, .op-project-include-list.op-project-include-list--root[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.op-project-include-list--root[_nghost-%COMP%]::-webkit-scrollbar-track, .op-project-include-list.op-project-include-list--root[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.op-project-include-list--root[_nghost-%COMP%]::-webkit-scrollbar-thumb, .op-project-include-list.op-project-include-list--root[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.op-project-include-list--root[_nghost-%COMP%]:hover, .op-project-include-list.op-project-include-list--root[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.op-project-include-list--root[_nghost-%COMP%]:hover::-webkit-scrollbar-thumb, .op-project-include-list.op-project-include-list--root[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}--tooltip[_nghost-%COMP%], .op-project-include-list--tooltip[_ngcontent-%COMP%]{max-width:100%}"],changeDetection:0})}}},89075:(e,t,n)=>{"use strict";n.d(t,{c:()=>OpProjectIncludeComponent});var i=n(75797),o=n(19999),r=n(70271),s=n(91817),a=n(52575),l=n(1365),c=n(64334),p=n(86301),d=n(51567),u=n(61816),h=n(34120),m=n(80406),g=n(99496),_=n(36178),f=n(86866),b=n(73881),k=n(61396),v=n(10885);const calculatePositions=(e,t=0)=>{let n=t;return[e.map((e=>(e.position=n,n+=1,[e.children,n]=calculatePositions(e.children,n),e))),n]};var C=n(68559),y=n(60316),w=n(34456),T=n(50130),S=n(51832),j=n(18240),P=n(93338),I=n(81151),x=n(44197);const _c0=()=>({standalone:!0}),_c1=e=>({"spot-list_active":e});function OpProjectIncludeComponent_span_3_Template(e,t){if(1&e&&C.nrm(0,"span",11),2&e){const e=t.ngIf;C.Y8G("textContent",e)}}function OpProjectIncludeComponent_form_11_ng_container_3_ul_1_Template(e,t){if(1&e){const e=C.RV6();C.j41(0,"ul",25),C.nI1(1,"async"),C.bIt("update",(function OpProjectIncludeComponent_form_11_ng_container_3_ul_1_Template_ul_update_0_listener(t){C.eBV(e);const n=C.XpG(3);return C.Njj(n.selectedProjects=t)})),C.k0s()}if(2&e){const e=C.XpG(2).ngIf,t=C.XpG();C.Y8G("ngClass",C.eq3(8,_c1,t.textFieldFocused))("projects",e)("selected",t.selectedProjects)("includeSubprojects",C.bMT(1,6,t.includeSubprojects$))("searchText",t.searchableProjectListService.searchText)("root",!0)}}function OpProjectIncludeComponent_form_11_ng_container_3_ng_template_2_Template(e,t){if(1&e&&(C.j41(0,"span",26),C.EFF(1),C.k0s()),2&e){const e=C.XpG(3);C.R7$(),C.SpI(" ",e.text.no_results," ")}}function OpProjectIncludeComponent_form_11_ng_container_3_Template(e,t){if(1&e&&(C.qex(0),C.DNE(1,OpProjectIncludeComponent_form_11_ng_container_3_ul_1_Template,2,10,"ul",24)(2,OpProjectIncludeComponent_form_11_ng_container_3_ng_template_2_Template,2,1,"ng-template",null,1,C.C5r),C.bVm()),2&e){const e=C.sdS(3),t=C.XpG().ngIf;C.R7$(),C.Y8G("ngIf",t.length>0)("ngIfElse",e)}}function OpProjectIncludeComponent_form_11_Template(e,t){if(1&e){const e=C.RV6();C.j41(0,"form",12),C.bIt("submit",(function OpProjectIncludeComponent_form_11_Template_form_submit_0_listener(t){C.eBV(e);const n=C.XpG();return C.Njj(n.onSubmit(t))})),C.j41(1,"spot-text-field",13),C.mxI("ngModelChange",(function OpProjectIncludeComponent_form_11_Template_spot_text_field_ngModelChange_1_listener(t){C.eBV(e);const n=C.XpG();return C.DH7(n.searchableProjectListService.searchText,t)||(n.searchableProjectListService.searchText=t),C.Njj(t)})),C.bIt("keydown",(function OpProjectIncludeComponent_form_11_Template_spot_text_field_keydown_1_listener(t){const n=C.eBV(e).ngIf,i=C.XpG();return C.Njj(i.searchableProjectListService.onKeydown(t,n))}))("inputFocus",(function OpProjectIncludeComponent_form_11_Template_spot_text_field_inputFocus_1_listener(){C.eBV(e);const t=C.XpG();return C.Njj(t.textFieldFocused=!0)}))("inputBlur",(function OpProjectIncludeComponent_form_11_Template_spot_text_field_inputBlur_1_listener(){C.eBV(e);const t=C.XpG();return C.Njj(t.textFieldFocused=!1)})),C.nrm(2,"span",14),C.k0s(),C.DNE(3,OpProjectIncludeComponent_form_11_ng_container_3_Template,4,2,"ng-container",15),C.nI1(4,"async"),C.j41(5,"div",16)(6,"div",17)(7,"label",18)(8,"spot-checkbox",19),C.mxI("ngModelChange",(function OpProjectIncludeComponent_form_11_Template_spot_checkbox_ngModelChange_8_listener(t){C.eBV(e);const n=C.XpG();return C.DH7(n.includeSubprojects,t)||(n.includeSubprojects=t),C.Njj(t)})),C.k0s(),C.j41(9,"span",20),C.EFF(10),C.k0s()()(),C.j41(11,"div",21)(12,"button",22),C.nI1(13,"async"),C.bIt("click",(function OpProjectIncludeComponent_form_11_Template_button_click_12_listener(){C.eBV(e);const t=C.XpG();return C.Njj(t.clearSelection())})),C.EFF(14),C.k0s(),C.j41(15,"button",23),C.nI1(16,"async"),C.EFF(17),C.k0s()()()()}if(2&e){const e=C.XpG(),t=C.sdS(14);C.R7$(),C.Y8G("placeholder",e.text.search_placeholder),C.R50("ngModel",e.searchableProjectListService.searchText),C.Y8G("ngModelOptions",C.lJ4(18,_c0)),C.R7$(2),C.Y8G("ngIf",!1===C.bMT(4,12,e.loading$))("ngIfElse",t),C.R7$(5),C.R50("ngModel",e.includeSubprojects),C.Y8G("ngModelOptions",C.lJ4(19,_c0)),C.R7$(2),C.JRh(e.text.include_subprojects),C.R7$(2),C.Y8G("disabled",C.bMT(13,14,e.loading$)),C.R7$(2),C.SpI(" ",e.text.clear_selection," "),C.R7$(),C.Y8G("disabled",C.bMT(16,16,e.loading$)),C.R7$(2),C.SpI(" ",e.text.apply," ")}}function OpProjectIncludeComponent_ng_template_13_Template(e,t){1&e&&C.nrm(0,"op-loading-project-list",27)}class OpProjectIncludeComponent extends g.p{get displayMode(){return this._displayMode}set displayMode(e){this._displayMode=e,this.displayMode$.next(e)}get includeSubprojects(){return this._includeSubprojects}set includeSubprojects(e){this._includeSubprojects=e,this.includeSubprojects$.next(e)}get selectedProjects(){return this._selectedProjects}set selectedProjects(e){this._selectedProjects=e,this.selectedProjects$.next(e)}constructor(e,t,n,u,h,m){super(),this.I18n=e,this.wpTableFilters=t,this.wpIncludeSubprojects=n,this.halResourceService=u,this.currentProjectService=h,this.searchableProjectListService=m,this.className=!0,this.text={toggle_title:this.I18n.t("js.include_projects.toggle_title"),title:this.I18n.t("js.include_projects.title"),filter_all:this.I18n.t("js.include_projects.selected_filter.all"),filter_selected:this.I18n.t("js.include_projects.selected_filter.selected"),search_placeholder:this.I18n.t("js.include_projects.search_placeholder"),clear_selection:this.I18n.t("js.include_projects.clear_selection"),apply:this.I18n.t("js.include_projects.apply"),include_subprojects:this.I18n.t("js.include_projects.include_subprojects"),no_results:this.I18n.t("js.include_projects.no_results")},this.opened=!1,this.textFieldFocused=!1,this.query$=this.wpTableFilters.querySpace.query.values$(),this.displayModeOptions=[{value:"all",title:this.text.filter_all},{value:"selected",title:this.text.filter_selected}],this._displayMode="all",this.displayMode$=new i.t("all"),this._includeSubprojects=!0,this.includeSubprojects$=new i.t(!0),this._selectedProjects=[],this.selectedProjects$=new i.t([]),this.projectsInFilter$=this.wpTableFilters.live$().pipe(this.untilDestroyed(),(0,r.T)((e=>{const t=e.find((e=>"ProjectQueryFilter"===e._type)),n=(t?.values||[]).map((e=>e.href)),i=this.currentProjectService.apiv3Path;if(n.includes(i))return n;const o=[...n];return i&&o.push(i),o}))),this.numberOfProjectsInFilter$=this.projectsInFilter$.pipe((0,r.T)((e=>e.length))),this.projects$=(0,o.z)([this.searchableProjectListService.allProjects$,this.displayMode$.pipe((0,s.F)()),this.includeSubprojects$.pipe((0,a.B)(20)),this.searchableProjectListService.searchText$.pipe((0,a.B)(200))]).pipe((0,l.Z)((([e,t,n,i])=>this.selectedProjects$.pipe((0,c.s)(1),(0,r.T)((o=>[e,t,n,i,o]))))),(0,r.T)((([e,t,n,i,o])=>[e.filter((e=>{if(i.length){if(!e.name.toLowerCase().includes(i.toLowerCase()))return!1}if("selected"!==t)return!0;if(o.includes(e._links.self.href))return!0;const r=e._links.ancestors.reduce(((e,t)=>e||o.includes(t.href)),!1);return!(!n||!r)})).sort(((e,t)=>e._links.ancestors.length-t._links.ancestors.length)).reduce(((t,n)=>{const{ancestors:i}=n._links;return(0,k.X)(e,n,t,i)}),[]),n])),(0,l.Z)((([e,t])=>this.selectedProjects$.pipe((0,r.T)((n=>[e,t,n]))))),(0,r.T)((([e,t,n])=>{const isDisabled=(e,n)=>!!e.disabled||(e.href===this.currentProjectService.apiv3Path||t&&n),setDisabledStatus=(e,t)=>({...e,disabled:isDisabled(e,t),children:e.children.map((i=>setDisabledStatus(i,t||n.includes(e.href))))});return e.map((e=>setDisabledStatus(e,!1)))})),(0,r.T)((e=>(0,v.h)(e))),(0,r.T)((e=>calculatePositions(e)[0])),(0,p.t)()),this.loading$=this.searchableProjectListService.fetchingProjects$.pipe((0,d.p)((e=>e)),(0,c.s)(1),(0,l.Z)((()=>this.projects$)),(0,l.Z)((()=>this.searchableProjectListService.fetchingProjects$))),this.projects$.pipe(this.untilDestroyed(),(0,d.p)((e=>e.length>0)),(0,c.s)(1)).subscribe((e=>{this.searchableProjectListService.resetActiveResult(e)}))}ngOnInit(){this.query$.pipe((0,r.T)((e=>e.includeSubprojects)),(0,s.F)()).subscribe((e=>{this.includeSubprojects=e}))}toggleIncludeSubprojects(){this.wpIncludeSubprojects.setIncludeSubprojects(!this.wpIncludeSubprojects.current)}toggleOpen(){this.opened=!this.opened,this.opened&&(this.searchableProjectListService.loadAllProjects(),this.projectsInFilter$.pipe((0,c.s)(1)).subscribe((e=>{this.displayMode="all",this.searchableProjectListService.searchText="",this.selectedProjects=e})))}clearSelection(){this.selectedProjects=[this.currentProjectService.apiv3Path||""]}onSubmit(e){e.preventDefault(),this.wpTableFilters.replace("project",(e=>{const t=this.selectedProjects;e.values=t.map((e=>this.halResourceService.createHalResource({href:e},!0)))})),this.wpIncludeSubprojects.update(this.includeSubprojects),this.close()}close(){this.opened=!1}static{this.ɵfac=function OpProjectIncludeComponent_Factory(e){return new(e||OpProjectIncludeComponent)(C.rXU(u.W),C.rXU(h.N),C.rXU(m.G),C.rXU(_.t),C.rXU(f.c),C.rXU(b.Z))}}static{this.ɵcmp=C.VBU({type:OpProjectIncludeComponent,selectors:[["op-project-include"]],hostVars:2,hostBindings:function OpProjectIncludeComponent_HostBindings(e,t){2&e&&C.AVh("op-project-include",t.className)},features:[C.Jv_([b.Z]),C.Vt3],decls:15,vars:12,consts:[["loadingTemplate",""],["noResultsTemplate",""],[1,"op-project-list-modal",3,"closed","opened"],["slot","trigger","type","button","data-test-selector","project-include-button",1,"button",3,"click","title"],["class","badge -secondary",3,"textContent",4,"ngIf"],[1,"spot-icon","spot-icon_dropdown"],["slot","body"],[1,"op-project-list-modal--header","op-project-include--header"],[1,"op-project-list-modal--title"],[3,"ngModelChange","options","ngModel"],["class","spot-container op-project-list-modal--body","data-searchable-list-parent","true",3,"submit",4,"ngIf"],[1,"badge","-secondary",3,"textContent"],["data-searchable-list-parent","true",1,"spot-container","op-project-list-modal--body",3,"submit"],["name","project-include-search","data-test-selector","project-include-search","data-list-focus-catcher-container","true","data-modal-focus-catcher-container","true",3,"ngModelChange","keydown","inputFocus","inputBlur","placeholder","ngModel","ngModelOptions"],["slot","before",1,"spot-icon","spot-icon_search"],[4,"ngIf","ngIfElse"],[1,"spot-action-bar"],[1,"spot-action-bar--left"],[1,"op-project-include--include-all","spot-action-bar--action"],["data-qa-project-include-all-subprojects","1",3,"ngModelChange","ngModel","ngModelOptions"],[1,"op-project-include--include-all-text"],[1,"spot-action-bar--right"],["type","button",1,"button","spot-action-bar--action",3,"click","disabled"],[1,"button","-primary","spot-action-bar--action",3,"disabled"],["class","op-project-include--list","op-project-include-list","","data-test-selector","project-include-list","data-list-root","true",3,"ngClass","projects","selected","includeSubprojects","searchText","root","update",4,"ngIf","ngIfElse"],["op-project-include-list","","data-test-selector","project-include-list","data-list-root","true",1,"op-project-include--list",3,"update","ngClass","projects","selected","includeSubprojects","searchText","root"],[1,"op-project-list-modal--no-results"],["data-test-selector","op-project-include--loading",1,"op-project-list-modal--loading"]],template:function OpProjectIncludeComponent_Template(e,t){if(1&e){const e=C.RV6();C.j41(0,"spot-drop-modal",2),C.bIt("closed",(function OpProjectIncludeComponent_Template_spot_drop_modal_closed_0_listener(){return C.eBV(e),C.Njj(t.opened=!1)})),C.j41(1,"button",3),C.bIt("click",(function OpProjectIncludeComponent_Template_button_click_1_listener(){return C.eBV(e),C.Njj(t.toggleOpen())})),C.EFF(2),C.DNE(3,OpProjectIncludeComponent_span_3_Template,1,1,"span",4),C.nI1(4,"async"),C.nrm(5,"span",5),C.k0s(),C.qex(6,6),C.j41(7,"div",7)(8,"h1",8),C.EFF(9),C.k0s(),C.j41(10,"spot-toggle",9),C.mxI("ngModelChange",(function OpProjectIncludeComponent_Template_spot_toggle_ngModelChange_10_listener(n){return C.eBV(e),C.DH7(t.displayMode,n)||(t.displayMode=n),C.Njj(n)})),C.k0s()(),C.DNE(11,OpProjectIncludeComponent_form_11_Template,18,20,"form",10),C.nI1(12,"async"),C.bVm(),C.DNE(13,OpProjectIncludeComponent_ng_template_13_Template,1,0,"ng-template",null,0,C.C5r),C.k0s()}2&e&&(C.Y8G("opened",t.opened),C.R7$(),C.Y8G("title",t.text.toggle_title),C.R7$(),C.SpI(" ",t.text.toggle_title," "),C.R7$(),C.Y8G("ngIf",C.bMT(4,8,t.numberOfProjectsInFilter$)),C.R7$(6),C.JRh(t.text.title),C.R7$(),C.Y8G("options",t.displayModeOptions),C.R50("ngModel",t.displayMode),C.R7$(),C.Y8G("ngIf",C.bMT(12,10,t.projects$)))},dependencies:[y.YU,y.bT,w.qT,w.BC,w.cb,w.vS,w.cV,T.h,S.k,j.l,P.m,I.Q,x.K,y.Jj],styles:[".op-project-include--include-all[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer}.op-project-include--include-all-text[_ngcontent-%COMP%]{padding-top:1px;margin-left:.5rem}.op-project-include--list[_ngcontent-%COMP%]{min-height:9rem}"],changeDetection:0})}}},10885:(e,t,n)=>{"use strict";n.d(t,{h:()=>recursiveSort});const recursiveSort=e=>e.map((e=>({...e,children:recursiveSort(e.children)}))).sort(((e,t)=>e.name.localeCompare(t.name)))},83365:(e,t,n)=>{"use strict";n.d(t,{f:()=>RemoteFieldUpdaterComponent});var i=n(41670),o=n(68559),r=n(30501);class RemoteFieldUpdaterComponent{constructor(e,t){this.elementRef=e,this.http=t}ngOnInit(){const e=this.elementRef.nativeElement;this.form=e.closest("form"),this.target=this.form.querySelector(".remote-field--target"),this.url=e.dataset.url,this.htmlMode="html"===e.dataset.mode;const t=_.debounce((e=>{const t=[i.c.TAB,i.c.ENTER,i.c.SHIFT];("change"===e.type||e.which&&-1===t.indexOf(e.which))&&this.updater()}),500);this.form.addEventListener("keyup",t),this.form.addEventListener("change",t)}request(e){const t={};return this.htmlMode?t.Accept="text/html":t.Accept="application/json",this.http.get(this.url,{params:e,headers:t,responseType:this.htmlMode?"text":"json",withCredentials:!0})}updater(){const e={};this.form.querySelectorAll(".remote-field--input").forEach((t=>{e[t.dataset.remoteFieldKey]=t.value})),this.request(e).subscribe((e=>{this.htmlMode?this.target.innerHTML=e:_.each(e,((e,t)=>{const n=document.getElementById(t);n instanceof HTMLInputElement?n.value=e:n&&(n.textContent=e)}))}))}static{this.ɵfac=function RemoteFieldUpdaterComponent_Factory(e){return new(e||RemoteFieldUpdaterComponent)(o.rXU(o.aKT),o.rXU(r.Qq))}}static{this.ɵcmp=o.VBU({type:RemoteFieldUpdaterComponent,selectors:[["remote-field-updater"]],decls:0,vars:0,template:function RemoteFieldUpdaterComponent_Template(e,t){},encapsulation:2,changeDetection:0})}}},94193:(e,t,n)=>{"use strict";n.d(t,{a:()=>ResizerComponent});var i=n(68559),o=n(22989),r=n(60316);const s=["*"];function ResizerComponent_div_0_Template(e,t){if(1&e&&i.nrm(0,"div",1),2&e){const e=i.XpG();i.Y8G("ngClass",e.resizerClass)}}class ResizerComponent{constructor(){this.resizeFinished=new i.bkB,this.resizeStarted=new i.bkB,this.move=new i.bkB,this.customHandler=!1,this.cursorClass="nwse-resize",this.resizerClass="resizer"}ngOnDestroy(){this.removeEventListener()}startResize(e){if(e.preventDefault(),e.stopPropagation(),this.isMouseEvent(e)&&0!==e.button)return;const{x:t,y:n}=this.position(e);this.oldX=t,this.startX=t,this.newX=t,this.oldY=n,this.startY=n,this.newY=n,this.setResizeCursor(),this.bindEventListener(),this.resizeStarted.emit(this.buildDelta(e))}position(e){return this.isMouseEvent(e)?{x:e.clientX,y:e.clientY}:{x:e.touches[0].clientX,y:e.touches[0].clientY}}isMouseEvent(e){return e instanceof MouseEvent}onMouseUp(e){this.setAutoCursor(),this.removeEventListener(),this.resizeFinished.emit(this.buildDelta(e))}onMouseMove(e){e.stopPropagation(),this.oldX=this.newX,this.oldY=this.newY;const{x:t,y:n}=this.position(e);this.newX=t,this.newY=n,this.move.emit(this.buildDelta(e))}bindEventListener(){this.mouseMoveHandler=this.onMouseMove.bind(this),this.mouseUpHandler=this.onMouseUp.bind(this),window.addEventListener("mousemove",this.mouseMoveHandler),window.addEventListener("touchmove",this.mouseMoveHandler),window.addEventListener("mouseup",this.mouseUpHandler),window.addEventListener("touchend",this.mouseUpHandler)}removeEventListener(){window.removeEventListener("touchmove",this.mouseMoveHandler),window.removeEventListener("mousemove",this.mouseMoveHandler),window.removeEventListener("mouseup",this.mouseUpHandler),window.removeEventListener("touchend",this.mouseUpHandler)}setResizeCursor(){(0,o.r)(this.cursorClass,"important")}setAutoCursor(){(0,o.r)("auto")}buildDelta(e){return{origin:e,absolute:{x:this.newX-this.startX,y:this.newY-this.startY},relative:{x:this.newX-this.oldX,y:this.newY-this.oldY}}}static{this.ɵfac=function ResizerComponent_Factory(e){return new(e||ResizerComponent)}}static{this.ɵcmp=i.VBU({type:ResizerComponent,selectors:[["op-resizer"]],hostBindings:function ResizerComponent_HostBindings(e,t){1&e&&i.bIt("mousedown",(function ResizerComponent_mousedown_HostBindingHandler(e){return t.startResize(e)}))("touchstart",(function ResizerComponent_touchstart_HostBindingHandler(e){return t.startResize(e)}))},inputs:{customHandler:"customHandler",cursorClass:"cursorClass",resizerClass:"resizerClass"},outputs:{resizeFinished:"resizeFinished",resizeStarted:"resizeStarted",move:"move"},ngContentSelectors:s,decls:2,vars:1,consts:[[3,"ngClass",4,"ngIf"],[3,"ngClass"]],template:function ResizerComponent_Template(e,t){1&e&&(i.NAR(),i.DNE(0,ResizerComponent_div_0_Template,1,1,"div",0),i.SdG(1)),2&e&&i.Y8G("ngIf",!t.customHandler)},dependencies:[r.YU,r.bT],encapsulation:2,changeDetection:0})}}},2214:(e,t,n)=>{"use strict";n.d(t,{H:()=>WpResizerDirective});var i=n(91817),o=n(52575),r=n(83093),s=n(99496),a=n(18537),l=n(2237),c=n(68559),p=n(94193);class WpResizerDirective extends s.p{constructor(e,t,n){super(),this.toggleService=e,this.elementRef=t,this.$transitions=n,this.variableName="--split-screen-width",this.elementMinWidth=550,this.moving=!1,this.resizerClass="work-packages--resizer icon-resizer-vertical-lines"}ngOnInit(){const e=document.getElementsByClassName(this.elementClass);if(this.resizingElement=e[e.length-1],!this.resizingElement)return;const t=this.parseLocalStorageValue();this.elementWidth=t||(this.resizingElement.offsetWidth<this.elementMinWidth?this.elementMinWidth:this.resizingElement.offsetWidth),0===this.elementWidth&&this.resizingElement.parentElement&&(this.elementWidth=this.resizingElement.parentElement.offsetWidth/2),this.setWidthVariable(this.elementWidth),this.element=this.elementRef.nativeElement,this.toggleService.changeData$.pipe((0,i.F)(),this.untilDestroyed(),(0,o.B)(100)).subscribe((()=>{this.applyColumnLayout()})),(0,a.R)(window,"resize",{passive:!0}).pipe(this.untilDestroyed(),(0,o.B)(250)).subscribe((()=>this.applyColumnLayout()))}ngAfterViewInit(){this.resizer=this.elementRef.nativeElement.getElementsByClassName(this.resizerClass)[0],this.applyColumnLayout()}ngOnDestroy(){super.ngOnDestroy()}resizeStart(){const e=this.parseLocalStorageValue(),t=this.resizingElement.offsetWidth;e&&e>t&&(this.elementWidth=t)}resizeEnd(){const e=this.parseLocalStorageValue();e&&(this.elementWidth=e);const t=new Event(this.resizeEvent);window.dispatchEvent(t),this.manageErrorClass(!1)}resizeMove(e){let t;this.elementWidth-=e.relative.x,this.elementWidth<this.elementMinWidth?(t=this.elementMinWidth,this.manageErrorClass(!0)):(t=this.elementWidth,this.manageErrorClass(!1)),window.OpenProject.guardedLocalStorage(this.localStorageKey,`${t}`),this.applyColumnLayout(),this.setWidthVariable(t)}parseLocalStorageValue(){const e=window.OpenProject.guardedLocalStorage(this.localStorageKey),t=parseInt(e||"",10);if("number"==typeof t&&!Number.isNaN(t))return t}applyColumnLayout(e=750){const t=document.querySelectorAll("[data-selector='wp-single-view']")[0];t&&jQuery(t).toggleClass("work-package--single-view_with-columns",t.offsetWidth>e)}manageErrorClass(e){e&&!this.resizer.classList.contains("-error-font")&&this.resizer.classList.add("-error-font"),!e&&this.resizer.classList.contains("-error-font")&&this.resizer.classList.remove("-error-font")}setWidthVariable(e){document.documentElement.style.setProperty(this.variableName,`${e}px`)}static{this.ɵfac=function WpResizerDirective_Factory(e){return new(e||WpResizerDirective)(c.rXU(l.S),c.rXU(c.aKT),c.rXU(r.HN))}}static{this.ɵcmp=c.VBU({type:WpResizerDirective,selectors:[["wp-resizer"]],inputs:{elementClass:"elementClass",resizeEvent:"resizeEvent",localStorageKey:"localStorageKey",variableName:"variableName"},features:[c.Vt3],decls:1,vars:2,consts:[["cursorClass","col-resize",3,"resizeFinished","resizeStarted","move","customHandler","resizerClass"]],template:function WpResizerDirective_Template(e,t){1&e&&(c.j41(0,"op-resizer",0),c.bIt("resizeFinished",(function WpResizerDirective_Template_op_resizer_resizeFinished_0_listener(){return t.resizeEnd()}))("resizeStarted",(function WpResizerDirective_Template_op_resizer_resizeStarted_0_listener(){return t.resizeStart()}))("move",(function WpResizerDirective_Template_op_resizer_move_0_listener(e){return t.resizeMove(e)})),c.k0s()),2&e&&c.Y8G("customHandler",!1)("resizerClass",t.resizerClass)},dependencies:[p.a],encapsulation:2,changeDetection:0})}}},44197:(e,t,n)=>{"use strict";n.d(t,{K:()=>OpLoadingProjectListComponent});var i=n(68559),o=n(53689);class OpLoadingProjectListComponent{static{this.ɵfac=function OpLoadingProjectListComponent_Factory(e){return new(e||OpLoadingProjectListComponent)}}static{this.ɵcmp=i.VBU({type:OpLoadingProjectListComponent,selectors:[["op-loading-project-list"]],decls:10,vars:0,consts:[["viewBox","0 0 200 140"],["x","0","width","100%","height","12","rx","1"],["x","10","y","16","width","100%","height","12","rx","1"],["x","10","y","32","width","100%","height","12","rx","1"],["x","20","y","48","width","100%","height","12","rx","1"],["x","20","y","64","width","100%","height","12","rx","1"],["x","0","y","80","width","100%","height","12","rx","1"],["x","10","y","96","width","100%","height","12","rx","1"],["x","10","y","112","width","100%","height","12","rx","1"],["x","0","y","128","width","100%","height","12","rx","1"]],template:function OpLoadingProjectListComponent_Template(e,t){1&e&&(i.j41(0,"op-content-loader",0),i.qSk(),i.nrm(1,"rect",1)(2,"rect",2)(3,"rect",3)(4,"rect",4)(5,"rect",5)(6,"rect",6)(7,"rect",7)(8,"rect",8)(9,"rect",9),i.k0s())},dependencies:[o.F],encapsulation:2,changeDetection:0})}}},73881:(e,t,n)=>{"use strict";n.d(t,{Z:()=>SearchableProjectListService});var i=n(98435),o=n(75797),r=n(96027),s=n(89475),a=n(64334),l=n(14593),c=n(41670),p=n(86866),d=n(68559),u=n(30501);class SearchableProjectListService{get searchText(){return this._searchText}set searchText(e){this._searchText=e,this.searchText$.next(e)}constructor(e,t,n){this.http=e,this.apiV3Service=t,this.currentProjectService=n,this._searchText="",this.selectedItemID$=new o.t(null),this.searchText$=new o.t(""),this.allProjects$=new o.t([]),this.fetchingProjects$=new o.t(!1)}loadAllProjects(){this.fetchingProjects$.next(!0),(0,r.eS)((e=>{const t=(0,i.Y)({...this.params,...e});return this.http.get(this.apiV3Service.projects.path+t)})).pipe((0,s.j)((()=>this.fetchingProjects$.next(!1)))).subscribe((e=>{this.allProjects$.next(e)}))}get params(){return{filters:[["active","=",["t"]]],pageSize:-1,select:["elements/id","elements/name","elements/identifier","elements/self","elements/ancestors","total","count","pageSize"]}}onKeydown(e,t){this.selectedItemID$.pipe((0,a.s)(1)).subscribe((n=>{switch(e.keyCode){case c.c.UP_ARROW:e.preventDefault(),this.selectPreviousResult(n,t);break;case c.c.DOWN_ARROW:e.preventDefault(),this.selectNextResult(n,t);break;case c.c.ENTER:e.stopPropagation(),e.preventDefault(),this.activateSelectedResult(e)}}))}resetActiveResult(e){const findFirstNonDisabledID=e=>{for(let t=0;t<e.length;t++){if(!e[t].disabled)return e[t].id;const n=findFirstNonDisabledID(e[t].children);if(null!==n)return n}return null};this.selectedItemID$.next(findFirstNonDisabledID(e))}selectPreviousResult(e,t){if(null===e)return;const findLastChild=e=>e?.children?.length?findLastChild(e.children[e.children.length-1]):e,findPreviousID=(e,n,i)=>{for(let o=0;o<n.length;o++){if(n[o].id===e){const e=findLastChild(n[o-1])||n[o-1]||i;return e?e.disabled?findPreviousID(e.id,t):e.id:null}const r=findPreviousID(e,n[o].children,n[o]);if(null!==r)return r}return null},n=findPreviousID(e,t);null!==n?this.selectedItemID$.next(n):this.resetActiveResult(t)}selectNextResult(e,t){if(null===e)return;const findNextID=(e,n,i)=>{for(let o=0;o<n.length;o++){if(n[o].id===e){const e=n[o].children[0]||n[o+1]||i;return e?e.disabled?findNextID(e.id,t):e.id:null}const r=findNextID(e,n[o].children,n[o+1]||i);if(null!==r)return r}return null},n=findNextID(e,t);null!==n?this.selectedItemID$.next(n):this.resetActiveResult(t)}activateSelectedResult(e){const findSearchableListParent=e=>e?"searchableListParent"in e.dataset?e:findSearchableListParent(e.parentElement):null,t=findSearchableListParent(e.currentTarget),n=document.activeElement;t?.querySelector(".spot-list--item-action_active")?.click(),n?.focus()}static{this.ɵfac=function SearchableProjectListService_Factory(e){return new(e||SearchableProjectListService)(d.KVO(u.Qq),d.KVO(l.n),d.KVO(p.c))}}static{this.ɵprov=d.jDH({token:SearchableProjectListService,factory:SearchableProjectListService.ɵfac})}}},60990:(e,t,n)=>{"use strict";n.d(t,{h:()=>FileLinkListItemComponent});var i=n(68559),o=n(61816),r=n(32420),s=n(71639),a=n(65896),l=n(48908),c=n(2319);class FloatingAction{constructor(e,t,n,i){this.iconClass=e,this.title=t,this.action=n,this.href=i}}var p=n(11073),d=n(60316),u=n(45906);const h=["avatar"],m=["op-file-link-list-item",""],_c2=e=>({"spot-list--item-floating-wrapper_disabled op-file-list--item-floating-wrapper__disabled":e}),_c3=(e,t,n)=>({"spot-list--item-action_disabled":e,"op-file-list--item-action_disabled":t,"op-file-list--item-action_faulty-status":n});function FileLinkListItemComponent_div_11_ng_container_1_a_1_Template(e,t){if(1&e&&(i.j41(0,"a",14),i.nrm(1,"span"),i.k0s()),2&e){const e=i.XpG().$implicit;i.Y8G("title",e.title)("href",e.href.url,i.B4B)("target",e.href.target),i.R7$(),i.ZvI("spot-icon spot-icon_",e.iconClass,"")}}function FileLinkListItemComponent_div_11_ng_container_1_button_2_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",15),i.bIt("click",(function FileLinkListItemComponent_div_11_ng_container_1_button_2_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG().$implicit;return i.Njj(t.action())})),i.nrm(1,"span"),i.k0s()}if(2&e){const e=i.XpG().$implicit;i.Y8G("title",e.title),i.R7$(),i.ZvI("spot-icon spot-icon_",e.iconClass,"")}}function FileLinkListItemComponent_div_11_ng_container_1_Template(e,t){if(1&e&&(i.qex(0),i.DNE(1,FileLinkListItemComponent_div_11_ng_container_1_a_1_Template,2,6,"a",12)(2,FileLinkListItemComponent_div_11_ng_container_1_button_2_Template,2,4,"button",13),i.bVm()),2&e){const e=t.$implicit;i.R7$(),i.Y8G("ngIf",!!e.href),i.R7$(),i.Y8G("ngIf",!!e.action)}}function FileLinkListItemComponent_div_11_Template(e,t){if(1&e&&(i.j41(0,"div",10),i.DNE(1,FileLinkListItemComponent_div_11_ng_container_1_Template,3,2,"ng-container",11),i.k0s()),2&e){const e=i.XpG();i.R7$(),i.Y8G("ngForOf",e.floatingActions)}}class FileLinkListItemComponent{constructor(e,t,n,o){this.i18n=e,this.timezoneService=t,this.confirmDialogService=n,this.principalRendererService=o,this.allowEditing=!1,this.disabled=!0,this.removeFileLink=new i.bkB,this.tooltipAlignment=p.A.TopLeft,this.text={title:{openFile:this.i18n.t("js.storages.file_links.open"),openFileLocation:this.i18n.t("js.storages.file_links.open_location"),removeFileLink:this.i18n.t("js.storages.file_links.remove"),downloadFileLink:""},removalTitle:this.i18n.t("js.storages.file_links.remove"),removalButtonLabel:this.i18n.t("js.storages.file_links.remove_short"),removalConfirmation:this.i18n.t("js.storages.file_links.remove_confirmation"),notLoggedInTooltipText:this.i18n.t("js.storages.file_links.tooltip.not_logged_in"),viewNotAllowedTooltipText:this.i18n.t("js.storages.file_links.tooltip.view_not_allowed"),notFoundTooltipText:this.i18n.t("js.storages.file_links.tooltip.not_found")}}get hasTooltip(){return""!==this.tooltip}get clickable(){return!(this.disabled||this.statusIs(s.SV))}get hasFaultyStatus(){return!this.statusIs(s.SL)}get originData(){return this.fileLink.originData}ngOnInit(){this.originData.lastModifiedAt&&(this.infoTimestampText=this.timezoneService.parseDatetime(this.originData.lastModifiedAt).fromNow()),this.fileLinkIcon=(0,c.nF)(this.originData.mimeType),this.tooltip=this.toolTipText(),this.text.title.downloadFileLink=this.i18n.t("js.storages.file_links.download",{fileName:this.fileLink.originData.name})}ngOnChanges(e){e.allowEditing&&(this.floatingActions=this.getFloatingActions())}ngAfterViewInit(){this.originData.lastModifiedByName?this.principalRendererService.render(this.avatar.nativeElement,{name:this.originData.lastModifiedByName,href:"/external_users/1"},{hide:!0,link:!1},{hide:!1,size:"mini"}):this.principalRendererService.render(this.avatar.nativeElement,{name:"Not Available",href:"/placeholder_users/1"},{hide:!0,link:!1},{hide:!1,size:"mini"})}confirmRemoveFileLink(){const e={text:{text:this.text.removalConfirmation,title:this.text.removalTitle,button_continue:this.text.removalButtonLabel},icon:{continue:"remove-link"}};this.confirmDialogService.confirm(e).then((()=>{this.removeFileLink.emit()})).catch((()=>{}))}toolTipText(){if(this.disabled)return this.text.notLoggedInTooltipText;if(!this.fileLink._links.status)return"";switch(this.fileLink._links.status.href){case s.Ng:return this.text.viewNotAllowedTooltipText;case s.Lh:return this.text.notLoggedInTooltipText;case s.SV:return this.text.notFoundTooltipText;default:return""}}statusIs(e){return!!this.fileLink._links.status&&this.fileLink._links.status.href===e}getFloatingActions(){if(this.disabled)return[];if(this.hasFaultyStatus&&this.allowEditing)return[this.removeAction()];const e=[];return(0,c.wd)(this.originData)||e.push(this.downloadAction()),e.push(this.openInLocationAction()),this.allowEditing&&e.push(this.removeAction()),e}removeAction(){return new FloatingAction("remove-link",this.text.title.removeFileLink,(()=>this.confirmRemoveFileLink()))}downloadAction(){return new FloatingAction("download-arrow",this.text.title.downloadFileLink,void 0,{url:this.fileLink._links.staticOriginDownload.href,target:"_self"})}openInLocationAction(){return new FloatingAction("folder-open",this.text.title.openFileLocation,void 0,{url:this.fileLink._links.staticOriginOpenLocation.href,target:"_blank"})}static{this.ɵfac=function FileLinkListItemComponent_Factory(e){return new(e||FileLinkListItemComponent)(i.rXU(o.W),i.rXU(r.D),i.rXU(l.g),i.rXU(a.r))}}static{this.ɵcmp=i.VBU({type:FileLinkListItemComponent,selectors:[["","op-file-link-list-item",""]],viewQuery:function FileLinkListItemComponent_Query(e,t){if(1&e&&i.GBs(h,5),2&e){let e;i.mGM(e=i.lsd())&&(t.avatar=e.first)}},inputs:{fileLink:"fileLink",allowEditing:"allowEditing",disabled:"disabled"},outputs:{removeFileLink:"removeFileLink"},features:[i.OA$],attrs:m,decls:12,vars:19,consts:[["avatar",""],[1,"spot-list--item-floating-wrapper","op-file-list--item-floating-wrapper",3,"disabled","alignment","ngClass"],["slot","body",1,"spot-body-small"],["slot","trigger"],["target","_blank",1,"spot-list--item-action","spot-list--item-action_link","op-file-list--item-action",3,"ngClass","href"],[1,"spot-list--item-title","op-file-list--item-title"],[1,"ellipsis",3,"textContent"],[1,"op-file-list--item-text",3,"textContent"],[1,"op-file-list--item-avatar"],["class","spot-list--item-floating-actions op-file-list--item-floating-actions hidden-for-mobile",4,"ngIf"],[1,"spot-list--item-floating-actions","op-file-list--item-floating-actions","hidden-for-mobile"],[4,"ngFor","ngForOf"],["class","spot-link",3,"title","href","target",4,"ngIf"],["class","spot-link",3,"title","click",4,"ngIf"],[1,"spot-link",3,"title","href","target"],[1,"spot-link",3,"click","title"]],template:function FileLinkListItemComponent_Template(e,t){1&e&&(i.j41(0,"spot-tooltip",1)(1,"p",2),i.EFF(2),i.k0s(),i.qex(3,3),i.j41(4,"a",4)(5,"div",5),i.nrm(6,"span")(7,"span",6),i.k0s(),i.nrm(8,"span",7)(9,"div",8,0),i.k0s(),i.DNE(11,FileLinkListItemComponent_div_11_Template,2,1,"div",9),i.bVm(),i.k0s()),2&e&&(i.Y8G("disabled",!t.hasTooltip)("alignment",t.tooltipAlignment)("ngClass",i.eq3(13,_c2,0===t.floatingActions.length)),i.R7$(2),i.JRh(t.tooltip),i.R7$(2),i.Y8G("ngClass",i.sMw(15,_c3,t.disabled,!t.clickable,t.hasFaultyStatus))("href",t.fileLink._links.staticOriginOpen.href,i.B4B),i.R7$(2),i.STu("spot-icon spot-icon_",t.fileLinkIcon.icon," op-files-tab--icon op-files-tab--icon_",t.fileLinkIcon.clazz,""),i.R7$(),i.Y8G("textContent",t.fileLink.originData.name),i.R7$(),i.Y8G("textContent",t.infoTimestampText),i.R7$(3),i.Y8G("ngIf",t.floatingActions.length>0))},dependencies:[d.YU,d.Sq,d.bT,u.H],encapsulation:2,changeDetection:0})}}},97122:(e,t,n)=>{"use strict";n.d(t,{_:()=>FilePickerBaseModalComponent});var i=n(75797),o=n(36647),r=n(59452),s=n(70271),a=n(61318),l=n(69081),c=n(51133),p=n(16604),d=n(36023);class BreadcrumbsContent{constructor(e){this.crumbs=e}}var u=n(2319),h=n(57223),m=n(68559);class FilePickerBaseModalComponent extends l.a{get storage(){return this.locals.storage}constructor(e,t,n,o,r){super(e,n,t),this.locals=e,this.elementRef=t,this.cdRef=n,this.sortFilesPipe=o,this.storageFilesResourceService=r,this.storageFiles$=new i.t([]),this.breadcrumbs=new BreadcrumbsContent([{text:this.storage.name,icon:(0,u.ky)(this.storage._links.type.href),navigate:()=>{}}]),this.showAlert=new i.t("none"),this.listItems$=this.storageFiles$.pipe((0,s.T)((e=>this.sortFilesPipe.transform(e).map(((e,t)=>this.storageFileToListItem(e,t)))))),this.loading$=new i.t("loading")}ngOnInit(){super.ngOnInit(),this.entryLocation().pipe(this.untilDestroyed(),(0,o.n)((e=>this.storageFilesResourceService.files((0,u.en)(this.storage._links.self,e))))).subscribe({next:e=>{this.currentDirectory=e.parent,this.breadcrumbs=this.makeBreadcrumbs(e.ancestors,e.parent),this.storageFiles$.next(e.files),this.loading$.next("success")},error:e=>{throw this.loading$.next("error"),e}})}ngOnDestroy(){super.ngOnDestroy(),this.storageFilesResourceService.reset()}closeAlert(){this.showAlert.next("none")}enterDirectoryCallback(e){return(0,u.wd)(e)?()=>this.changeLevel(e):()=>{}}changeLevel(e){this.cancelCurrentLoading(),this.loading$.next("loading"),this.loadingSubscription=this.storageFilesResourceService.files((0,u.en)(this.storage._links.self,e.location)).subscribe({next:e=>{this.currentDirectory=e.parent,this.breadcrumbs=this.makeBreadcrumbs(e.ancestors,e.parent),this.storageFiles$.next(e.files),this.loading$.next("success")},error:e=>{throw this.loading$.next("error"),e}})}entryLocation(){return"inactive"===this.locals.projectFolderMode||void 0===this.locals.projectFolderMode?(0,r.of)("/"):"automatic"===this.locals.projectFolderMode&&null===this.locals.projectFolderHref?(this.showAlert.next("managedFolderNotFound"),(0,r.of)("/")):this.storageFilesResourceService.file(this.locals.projectFolderHref).pipe((0,s.T)((e=>e.location)),(0,a.W)((e=>{if(!(500===e.status&&e.error.errorIdentifier===h.XH))throw new Error(e.message);return"automatic"===this.locals.projectFolderMode?this.showAlert.next("managedFolderNoAccess"):this.showAlert.next("noAccess"),(0,r.of)("/")})))}cancelCurrentLoading(){this.loadingSubscription?.unsubscribe()}makeBreadcrumbs(e,t){const n=e.concat(t).map((e=>{const t="/"===e.location;return{icon:t?(0,u.ky)(this.storage._links.type.href):void 0,text:t?this.storage.name:e.name,navigate:()=>this.changeLevel(e)}}));return new BreadcrumbsContent(n)}static{this.ɵfac=function FilePickerBaseModalComponent_Factory(e){return new(e||FilePickerBaseModalComponent)(m.rXU(c.Y),m.rXU(m.aKT),m.rXU(m.gRc),m.rXU(p.O),m.rXU(d.u))}}static{this.ɵdir=m.FsC({type:FilePickerBaseModalComponent,features:[m.Vt3]})}}},544:(e,t,n)=>{"use strict";n.d(t,{T:()=>FilePickerModalComponent});var i=n(70271),o=n(64334),r=n(61816),s=n(32420),a=n(72650),l=n(72688),c=n(51133),p=n(16604),d=n(77159),u=n(2319),h=n(36023),m=n(22061),g=n(97122),_=n(68559),f=n(60316),b=n(28690),k=n(66984),v=n(54972);const _c0=e=>({"-primary":e});function FilePickerModalComponent_div_6_Template(e,t){if(1&e){const e=_.RV6();_.j41(0,"div",18)(1,"div",19)(2,"p"),_.EFF(3),_.nI1(4,"async"),_.k0s(),_.j41(5,"button",20),_.bIt("click",(function FilePickerModalComponent_div_6_Template_button_click_5_listener(){_.eBV(e);const t=_.XpG();return _.Njj(t.closeAlert())})),_.nrm(6,"span",21),_.k0s()()()}if(2&e){const e=_.XpG();_.R7$(3),_.JRh(_.bMT(4,1,e.alertText))}}function FilePickerModalComponent_ng_container_9_Template(e,t){1&e&&_.eu8(0)}function FilePickerModalComponent_ng_container_11_Template(e,t){1&e&&_.eu8(0)}function FilePickerModalComponent_ng_container_13_Template(e,t){1&e&&_.eu8(0)}function FilePickerModalComponent_ng_template_15_ul_0_li_1_Template(e,t){if(1&e&&_.nrm(0,"li",25),2&e){const e=t.$implicit;_.Y8G("content",e)}}function FilePickerModalComponent_ng_template_15_ul_0_Template(e,t){if(1&e&&(_.j41(0,"ul",23),_.DNE(1,FilePickerModalComponent_ng_template_15_ul_0_li_1_Template,1,1,"li",24),_.nI1(2,"async"),_.k0s()),2&e){const e=_.XpG(2);_.R7$(),_.Y8G("ngForOf",_.bMT(2,1,e.listItems$))}}function FilePickerModalComponent_ng_template_15_Template(e,t){if(1&e&&(_.DNE(0,FilePickerModalComponent_ng_template_15_ul_0_Template,3,3,"ul",22),_.nI1(1,"async")),2&e){const e=_.XpG(),t=_.sdS(20);_.Y8G("ngIf",_.bMT(1,2,e.listItems$).length>0)("ngIfElse",t)}}function FilePickerModalComponent_ng_template_17_Template(e,t){1&e&&_.nrm(0,"op-loading-file-list",26)}function FilePickerModalComponent_ng_template_19_Template(e,t){if(1&e&&(_.j41(0,"div",27),_.nrm(1,"span",28)(2,"span",29),_.k0s()),2&e){const e=_.XpG();_.R7$(2),_.Y8G("textContent",e.text.content.empty)}}function FilePickerModalComponent_ng_template_21_Template(e,t){if(1&e&&(_.j41(0,"div",27),_.nrm(1,"span",30)(2,"span",29)(3,"span",31),_.k0s()),2&e){const e=_.XpG();_.R7$(2),_.Y8G("textContent",e.text.content.noConnection(e.storageType)),_.R7$(),_.Y8G("textContent",e.text.content.noConnectionHint(e.storageType))}}function FilePickerModalComponent_div_24_Template(e,t){if(1&e){const e=_.RV6();_.j41(0,"div",32)(1,"button",33),_.bIt("click",(function FilePickerModalComponent_div_24_Template_button_click_1_listener(){_.eBV(e);const t=_.XpG();return _.Njj(t.selectAllOfCurrentLevel())})),_.nrm(2,"span",34)(3,"span",29),_.k0s()()}if(2&e){const e=_.XpG();_.R7$(3),_.Y8G("textContent",e.text.buttons.selectAll)}}class FilePickerModalComponent extends g._{get selectedFileCount(){return this.selection.size}get storageType(){return this.i18n.t((0,u.pU)(this.storage._links.type.href))}get alertText(){return this.showAlert.pipe((0,i.T)((e=>{switch(e){case"noAccess":return this.text.alertNoAccess;case"managedFolderNoAccess":return this.text.alertNoAccessToManagedProjectFolder;case"managedFolderNotFound":return this.text.alertNoManagedProjectFolder;case"none":return"";default:throw new Error("unknown alert type")}})))}constructor(e,t,n,i,o,r,s,a,l,c){super(e,t,n,i,o),this.locals=e,this.elementRef=t,this.cdRef=n,this.sortFilesPipe=i,this.storageFilesResourceService=o,this.i18n=r,this.toastService=s,this.timezoneService=a,this.configuration=l,this.fileLinksResourceService=c,this.text={header:this.i18n.t("js.storages.file_links.select"),alertNoAccess:this.i18n.t("js.storages.files.project_folder_no_access"),alertNoManagedProjectFolder:this.i18n.t("js.storages.files.managed_project_folder_not_available"),alertNoAccessToManagedProjectFolder:this.i18n.t("js.storages.files.managed_project_folder_no_access"),content:{empty:this.i18n.t("js.storages.files.empty_folder"),emptyHint:this.i18n.t("js.storages.files.empty_folder_location_hint"),noConnection:e=>this.i18n.t("js.storages.no_connection",{storageType:e}),noConnectionHint:e=>this.i18n.t("js.storages.information.connection_error",{storageType:e})},buttons:{submit:e=>this.i18n.t("js.storages.file_links.selection",{count:e}),cancel:this.i18n.t("js.button_cancel"),selectAll:this.i18n.t("js.storages.file_links.select_all")},tooltip:{alreadyLinkedFile:this.i18n.t("js.storages.file_links.already_linked_file"),alreadyLinkedDirectory:this.i18n.t("js.storages.file_links.already_linked_directory")},toast:{successFileLinksCreated:e=>this.i18n.t("js.storages.file_links.success_create",{count:e})}},this.showSelectAll=!1,this.selection=new Set,this.fileMap={},this.showSelectAll=this.configuration.activeFeatureFlags.includes("storageFilePickingSelectAll")}createSelectedFileLinks(){const e=Array.from(this.selection).map((e=>this.fileMap[e]));this.fileLinksResourceService.addFileLinks(this.locals.collectionKey,this.locals.addFileLinksHref,this.storage._links.self,e).subscribe((e=>{this.toastService.addSuccess(this.text.toast.successFileLinksCreated(e.count))}),(e=>{this.toastService.addError(e)})),this.service.close()}selectAllOfCurrentLevel(){this.storageFiles$.pipe((0,o.s)(1)).subscribe((e=>{e.forEach((e=>{const t=e.id;this.selection.has(t)||this.isAlreadyLinked(e)||(this.selection.add(t),this.fileMap[t]=e)})),this.storageFiles$.next(e)}))}changeSelection(e){const t=e.id;this.selection.has(t)?this.selection.delete(t):(this.selection.add(t),this.fileMap[t]=e)}storageFileToListItem(e,t){return new m.t(this.timezoneService,e,this.isAlreadyLinked(e),0===t,this.enterDirectoryCallback(e),!1,this.tooltip(e),{selected:this.selection.has(e.id),changeSelection:()=>{this.changeSelection(e)}})}isAlreadyLinked(e){return!!this.locals.fileLinks.find((t=>t.originData.id===e.id))}tooltip(e){if(this.isAlreadyLinked(e))return(0,u.wd)(e)?this.text.tooltip.alreadyLinkedDirectory:this.text.tooltip.alreadyLinkedFile}static{this.ɵfac=function FilePickerModalComponent_Factory(e){return new(e||FilePickerModalComponent)(_.rXU(c.Y),_.rXU(_.aKT),_.rXU(_.gRc),_.rXU(p.O),_.rXU(h.u),_.rXU(r.W),_.rXU(a.fw),_.rXU(s.D),_.rXU(l.s),_.rXU(d.T))}}static{this.ɵcmp=_.VBU({type:FilePickerModalComponent,selectors:[["ng-component"]],features:[_.Vt3],decls:31,vars:24,consts:[["listTemplate",""],["loadingTemplate",""],["emptyTemplate",""],["notFoundTemplate",""],["data-test-selector","op-files-picker-modal",1,"spot-modal","op-file-picker"],[1,"spot-modal--header"],["id","spotModalTitle",1,"spot-modal--header-title"],[1,"spot-divider"],[1,"spot-modal--body","spot-container","op-file-picker--modal-body"],["class","op-toast -warning",4,"ngIf"],[3,"content"],[4,"ngIf","ngIfThen"],[1,"spot-action-bar"],["class","spot-action-bar--left",4,"ngIf"],[1,"spot-action-bar--right"],["type","button",1,"button","spot-modal--cancel-button","spot-action-bar--action",3,"click","textContent"],["type","button","data-test-selector","op-files-picker-modal--confirm",1,"button","spot-action-bar--action",3,"click","ngClass","disabled"],[1,"spot-icon","spot-icon_add-link"],[1,"op-toast","-warning"],[1,"op-toast--content"],[1,"spot-link","op-toast--close",3,"click"],[1,"spot-icon","spot-icon_close"],["class","spot-list spot-list_compact op-file-list op-file-picker--scrollable-content","data-test-selector","op-files-picker-modal--file-list",4,"ngIf","ngIfElse"],["data-test-selector","op-files-picker-modal--file-list",1,"spot-list","spot-list_compact","op-file-list","op-file-picker--scrollable-content"],["class","spot-list--item op-file-list--item","data-test-selector","op-file-list--item","op-storage-file-list-item","",3,"content",4,"ngFor","ngForOf"],["data-test-selector","op-file-list--item","op-storage-file-list-item","",1,"spot-list--item","op-file-list--item",3,"content"],[1,"spot-body-small"],[1,"spot-body-small","spot-body-small_bold","op-file-picker--info"],[1,"spot-icon","spot-icon_folder-open","op-file-picker--info-icon"],[3,"textContent"],[1,"spot-icon","spot-icon_remove-link","op-file-picker--info-icon"],[1,"spot-body-small","op-file-picker--info-sub-text",3,"textContent"],[1,"spot-action-bar--left"],["type","button","data-test-selector","op-files-picker-modal--select-all",1,"spot-link","spot-action-bar--action",3,"click"],[1,"spot-icon","spot-icon_select-all"]],template:function FilePickerModalComponent_Template(e,t){if(1&e){const e=_.RV6();_.j41(0,"div",4)(1,"div",5)(2,"span",6),_.EFF(3),_.k0s()(),_.nrm(4,"div",7),_.j41(5,"div",8),_.DNE(6,FilePickerModalComponent_div_6_Template,7,3,"div",9),_.nI1(7,"async"),_.nrm(8,"spot-breadcrumbs",10),_.DNE(9,FilePickerModalComponent_ng_container_9_Template,1,0,"ng-container",11),_.nI1(10,"async"),_.DNE(11,FilePickerModalComponent_ng_container_11_Template,1,0,"ng-container",11),_.nI1(12,"async"),_.DNE(13,FilePickerModalComponent_ng_container_13_Template,1,0,"ng-container",11),_.nI1(14,"async"),_.DNE(15,FilePickerModalComponent_ng_template_15_Template,2,4,"ng-template",null,0,_.C5r)(17,FilePickerModalComponent_ng_template_17_Template,1,0,"ng-template",null,1,_.C5r)(19,FilePickerModalComponent_ng_template_19_Template,3,1,"ng-template",null,2,_.C5r)(21,FilePickerModalComponent_ng_template_21_Template,4,2,"ng-template",null,3,_.C5r),_.k0s(),_.j41(23,"div",12),_.DNE(24,FilePickerModalComponent_div_24_Template,4,1,"div",13),_.j41(25,"div",14)(26,"button",15),_.bIt("click",(function FilePickerModalComponent_Template_button_click_26_listener(){return _.eBV(e),_.Njj(t.closeMe())})),_.k0s(),_.j41(27,"button",16),_.bIt("click",(function FilePickerModalComponent_Template_button_click_27_listener(){return _.eBV(e),_.Njj(t.createSelectedFileLinks())})),_.nrm(28,"span",17),_.j41(29,"span"),_.EFF(30),_.k0s()()()()()}if(2&e){const e=_.sdS(16),n=_.sdS(18),i=_.sdS(22);_.R7$(3),_.JRh(t.text.header),_.R7$(3),_.Y8G("ngIf","none"!==_.bMT(7,14,t.showAlert)),_.R7$(2),_.Y8G("content",t.breadcrumbs),_.R7$(),_.Y8G("ngIf","success"===_.bMT(10,16,t.loading$))("ngIfThen",e),_.R7$(2),_.Y8G("ngIf","error"===_.bMT(12,18,t.loading$))("ngIfThen",i),_.R7$(2),_.Y8G("ngIf","loading"===_.bMT(14,20,t.loading$))("ngIfThen",n),_.R7$(11),_.Y8G("ngIf",t.showSelectAll),_.R7$(2),_.Y8G("textContent",t.text.buttons.cancel),_.R7$(),_.Y8G("ngClass",_.eq3(22,_c0,t.selectedFileCount>0))("disabled",0===t.selectedFileCount),_.R7$(3),_.JRh(t.text.buttons.submit(t.selectedFileCount))}},dependencies:[f.YU,f.Sq,f.bT,b._,k.S,v.c,f.Jj],encapsulation:2,changeDetection:0})}}},2319:(e,t,n)=>{"use strict";n.d(t,{en:()=>makeFilesCollectionLink,ky:()=>getIconForStorageType,nF:()=>getIconForMimeType,pU:()=>storageLocaleString,wd:()=>isDirectory});var i=n(97172),o=n(71639);function isDirectory(e){return"application/x-op-directory"===e.mimeType}function getIconForMimeType(e){return e&&i.D[e]?i.D[e]:i.D.default}function getIconForStorageType(e){return e&&i.U[e]?i.U[e]:i.U.default}function makeFilesCollectionLink(e,t){const n="/"!==t?`?parent=${t}`:"";return{href:`${e.href}/files${n}`,title:"Storage files"}}const r={[o.Z8]:"js.storages.types.nextcloud",[o.f3]:"js.storages.types.one_drive",default:"js.storages.types.default"};function storageLocaleString(e){return r[e]||r.default}},97172:(e,t,n)=>{"use strict";n.d(t,{D:()=>o,U:()=>r});var i=n(71639);const o={"application/pdf":{icon:"export-pdf-descr",clazz:"pdf"},"image/jpeg":{icon:"image1",clazz:"img"},"image/png":{icon:"image1",clazz:"img"},"image/gif":{icon:"image1",clazz:"img"},"image/svg+xml":{icon:"image1",clazz:"img"},"image/tiff":{icon:"image1",clazz:"img"},"image/bmp":{icon:"image1",clazz:"img"},"image/webp":{icon:"image1",clazz:"img"},"image/heic":{icon:"image1",clazz:"img"},"image/heif":{icon:"image1",clazz:"img"},"image/avif":{icon:"image1",clazz:"img"},"image/cgm":{icon:"image1",clazz:"img"},"text/plain":{icon:"file-text",clazz:"txt"},"text/markdown":{icon:"file-text",clazz:"txt"},"text/html":{icon:"file-text",clazz:"txt"},"application/rtf":{icon:"file-text",clazz:"txt"},"application/xml":{icon:"file-text",clazz:"txt"},"application/xhtml+xml":{icon:"file-text",clazz:"txt"},"application/x-tex":{icon:"file-text",clazz:"txt"},"application/vnd.oasis.opendocument.text":{icon:"file-doc",clazz:"doc"},"application/vnd.oasis.opendocument.text-template":{icon:"file-doc",clazz:"doc"},"application/msword":{icon:"file-doc",clazz:"doc"},"application/vnd.apple.pages":{icon:"file-doc",clazz:"doc"},"application/vnd.stardivision.writer":{icon:"file-doc",clazz:"doc"},"application/x-abiword":{icon:"file-doc",clazz:"doc"},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{icon:"file-doc",clazz:"doc"},"font/otf":{icon:"file-doc",clazz:"doc"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{icon:"file-sheet",clazz:"sheet"},"application/vnd.oasis.opendocument.spreadsheet":{icon:"file-sheet",clazz:"sheet"},"application/vnd.oasis.opendocument.spreadsheet-template":{icon:"file-sheet",clazz:"sheet"},"application/vnd.ms-excel":{icon:"file-sheet",clazz:"sheet"},"application/vnd.stardivision.calc":{icon:"file-sheet",clazz:"sheet"},"application/vnd.apple.numbers":{icon:"file-sheet",clazz:"sheet"},"application/x-starcalc":{icon:"file-sheet",clazz:"sheet"},"application/x-quattro-pro":{icon:"file-sheet",clazz:"sheet"},"application/csv":{icon:"file-sheet",clazz:"sheet"},"application/vnd.oasis.opendocument.presentation":{icon:"file-presentation",clazz:"presentation"},"application/vnd.oasis.opendocument.presentation-template":{icon:"file-presentation",clazz:"presentation"},"application/vnd.apple.keynote":{icon:"file-presentation",clazz:"presentation"},"application/vnd.ms-powerpoint":{icon:"file-presentation",clazz:"presentation"},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{icon:"file-presentation",clazz:"presentation"},"application/vnd.stardivision.impress":{icon:"file-presentation",clazz:"presentation"},"application/mathematica":{icon:"file-presentation",clazz:"presentation"},"video/mp4":{icon:"movie",clazz:"mov"},"video/x-m4v":{icon:"movie",clazz:"mov"},"video/avi":{icon:"movie",clazz:"mov"},"video/quicktime":{icon:"movie",clazz:"mov"},"video/webm":{icon:"movie",clazz:"mov"},"video/mpg":{icon:"movie",clazz:"mov"},"video/x-matroska":{icon:"movie",clazz:"mov"},"video/mp1s":{icon:"movie",clazz:"mov"},"video/mp2p":{icon:"movie",clazz:"mov"},"video/3gpp":{icon:"movie",clazz:"mov"},"video/3gpp-tt":{icon:"movie",clazz:"mov"},"video/3gpp-2":{icon:"movie",clazz:"mov"},"application/x-op-directory":{icon:"folder",clazz:"primary"},default:{icon:"ticket",clazz:"default"}},r={[i.Z8]:"nextcloud-circle",default:"hosting"}},66984:(e,t,n)=>{"use strict";n.d(t,{S:()=>LoadingFileListComponent});var i=n(68559),o=n(53689);class LoadingFileListComponent{static{this.ɵfac=function LoadingFileListComponent_Factory(e){return new(e||LoadingFileListComponent)}}static{this.ɵcmp=i.VBU({type:LoadingFileListComponent,selectors:[["op-loading-file-list"]],decls:6,vars:0,consts:[["viewBox","0 0 928 186"],["x","0","y","4","width","100%","height","32","rx","1"],["x","0","y","40","width","100%","height","32","rx","1"],["x","0","y","76","width","100%","height","32","rx","1"],["x","0","y","112","width","100%","height","32","rx","1"],["x","0","y","148","width","100%","height","32","rx","1"]],template:function LoadingFileListComponent_Template(e,t){1&e&&(i.j41(0,"op-content-loader",0),i.qSk(),i.nrm(1,"rect",1)(2,"rect",2)(3,"rect",3)(4,"rect",4)(5,"rect",5),i.k0s())},dependencies:[o.F],encapsulation:2,changeDetection:0})}}},51152:(e,t,n)=>{"use strict";n.d(t,{o:()=>LocationPickerModalComponent});var i=n(61816),o=n(32420),r=n(51133),s=n(16604),a=n(2319),l=n(36023),c=n(22061),p=n(97122),d=n(70271),u=n(68559),h=n(60316),m=n(28690),g=n(66984),_=n(54972);function LocationPickerModalComponent_div_6_Template(e,t){if(1&e){const e=u.RV6();u.j41(0,"div",20)(1,"div",21)(2,"p"),u.EFF(3),u.nI1(4,"async"),u.k0s(),u.j41(5,"button",22),u.bIt("click",(function LocationPickerModalComponent_div_6_Template_button_click_5_listener(){u.eBV(e);const t=u.XpG();return u.Njj(t.closeAlert())})),u.nrm(6,"span",23),u.k0s()()()}if(2&e){const e=u.XpG();u.R7$(3),u.JRh(u.bMT(4,1,e.alertText))}}function LocationPickerModalComponent_ng_container_9_Template(e,t){1&e&&u.eu8(0)}function LocationPickerModalComponent_ng_container_11_Template(e,t){1&e&&u.eu8(0)}function LocationPickerModalComponent_ng_container_13_Template(e,t){1&e&&u.eu8(0)}function LocationPickerModalComponent_ng_template_15_ul_0_li_1_Template(e,t){if(1&e&&u.nrm(0,"li",27),2&e){const e=t.$implicit;u.Y8G("content",e)}}function LocationPickerModalComponent_ng_template_15_ul_0_Template(e,t){if(1&e&&(u.j41(0,"ul",25),u.DNE(1,LocationPickerModalComponent_ng_template_15_ul_0_li_1_Template,1,1,"li",26),u.nI1(2,"async"),u.k0s()),2&e){const e=u.XpG(2);u.R7$(),u.Y8G("ngForOf",u.bMT(2,1,e.listItems$))}}function LocationPickerModalComponent_ng_template_15_Template(e,t){if(1&e&&(u.DNE(0,LocationPickerModalComponent_ng_template_15_ul_0_Template,3,3,"ul",24),u.nI1(1,"async")),2&e){const e=u.XpG(),t=u.sdS(20);u.Y8G("ngIf",u.bMT(1,2,e.listItems$).length>0)("ngIfElse",t)}}function LocationPickerModalComponent_ng_template_17_Template(e,t){1&e&&u.nrm(0,"op-loading-file-list",28)}function LocationPickerModalComponent_ng_template_19_Template(e,t){if(1&e&&(u.j41(0,"div",29),u.nrm(1,"span",30)(2,"span",16)(3,"span",31),u.k0s()),2&e){const e=u.XpG();u.R7$(2),u.Y8G("textContent",e.text.content.empty),u.R7$(),u.Y8G("textContent",e.text.content.emptyHint)}}function LocationPickerModalComponent_ng_template_21_Template(e,t){if(1&e&&(u.j41(0,"div",29),u.nrm(1,"span",32)(2,"span",16)(3,"span",31),u.k0s()),2&e){const e=u.XpG();u.R7$(2),u.Y8G("textContent",e.text.content.noConnection(e.storageType)),u.R7$(),u.Y8G("textContent",e.text.content.noConnectionHint(e.storageType))}}class LocationPickerModalComponent extends p._{get location(){return this.currentDirectory}get storageType(){return this.i18n.t((0,a.pU)(this.storage._links.type.href))}get filesAtLocation(){return this.storageFiles$.getValue()}get canChooseLocation(){return!!this.currentDirectory&&this.currentDirectory.permissions.some((e=>"writeable"===e))}get canCreateFolder(){return!!this.currentDirectory&&this.currentDirectory.permissions.some((e=>"writeable"===e))}get alertText(){return this.showAlert.pipe((0,d.T)((e=>{switch(e){case"noAccess":return this.text.alertNoAccess;case"managedFolderNoAccess":return this.text.alertNoAccessToManagedProjectFolder;case"managedFolderNotFound":return this.text.alertNoManagedProjectFolder;case"cannotCreateFolder":return this.text.alertCannotCreateFolder;case"none":return"";default:throw new Error("unknown alert type")}})))}constructor(e,t,n,i,o,r,s){super(e,t,n,i,o),this.locals=e,this.elementRef=t,this.cdRef=n,this.sortFilesPipe=i,this.storageFilesResourceService=o,this.i18n=r,this.timezoneService=s,this.submitted=!1,this.text={header:this.i18n.t("js.storages.select_location"),alertNoAccess:this.i18n.t("js.storages.files.project_folder_no_access"),alertNoManagedProjectFolder:this.i18n.t("js.storages.files.managed_project_folder_not_available"),alertNoAccessToManagedProjectFolder:this.i18n.t("js.storages.files.managed_project_folder_no_access"),alertCannotCreateFolder:this.i18n.t("js.storages.files.cannot_create_folder"),content:{empty:this.i18n.t("js.storages.files.empty_folder"),emptyHint:this.i18n.t("js.storages.files.empty_folder_location_hint"),noConnection:e=>this.i18n.t("js.storages.no_connection",{storageType:e}),noConnectionHint:e=>this.i18n.t("js.storages.information.connection_error",{storageType:e})},buttons:{submit:this.i18n.t("js.storages.choose_location"),submitEmptySelection:this.i18n.t("js.storages.file_links.selection_none"),cancel:this.i18n.t("js.button_cancel"),selectAll:this.i18n.t("js.storages.file_links.select_all"),newFolder:this.i18n.t("js.storages.new_folder")},tooltip:{directory_not_writeable:this.i18n.t("js.storages.files.directory_not_writeable"),file_not_selectable:this.i18n.t("js.storages.files.file_not_selectable_location")}}}chooseLocation(){this.submitted=!0,this.service.close()}storageFileToListItem(e,t){return new c.t(this.timezoneService,e,!(0,a.wd)(e),0===t,this.enterDirectoryCallback(e),this.isConstrained(e),this.tooltip(e),void 0)}isConstrained(e){return!e.permissions.some((e=>"writeable"===e))}tooltip(e){return(0,a.wd)(e)?e.permissions.some((e=>"writeable"===e))?void 0:this.text.tooltip.directory_not_writeable:this.text.tooltip.file_not_selectable}createAndNavigateToFolder(){const e=window.prompt(this.text.buttons.newFolder);e&&this.storageFilesResourceService.createFolder(this.locals.createFolderHref,{name:e,parent_id:this.currentDirectory.id}).subscribe({next:e=>this.changeLevel(e),error:e=>this.showAlert.next("cannotCreateFolder")})}static{this.ɵfac=function LocationPickerModalComponent_Factory(e){return new(e||LocationPickerModalComponent)(u.rXU(r.Y),u.rXU(u.aKT),u.rXU(u.gRc),u.rXU(s.O),u.rXU(l.u),u.rXU(i.W),u.rXU(o.D))}}static{this.ɵcmp=u.VBU({type:LocationPickerModalComponent,selectors:[["ng-component"]],features:[u.Vt3],decls:31,vars:22,consts:[["listTemplate",""],["loadingTemplate",""],["emptyTemplate",""],["notFoundTemplate",""],["data-test-selector","op-files-picker-modal",1,"spot-modal","op-file-picker"],[1,"spot-modal--header"],["id","spotModalTitle",1,"spot-modal--header-title"],[1,"spot-divider"],[1,"spot-modal--body","spot-container","op-file-picker--modal-body"],["class","op-toast -warning",4,"ngIf"],[3,"content"],[4,"ngIf","ngIfThen"],[1,"spot-action-bar"],[1,"spot-action-bar--left"],["type","button",1,"button","spot-action-bar--action",3,"click","disabled"],[1,"spot-icon","spot-icon_folder-add","op-files-tab--icon","op-files-tab--icon_forums"],[3,"textContent"],[1,"spot-action-bar--right"],["type","button",1,"button","spot-action-bar--action",3,"click","textContent"],["type","button","data-test-selector","op-files-picker-modal--confirm",1,"button","spot-action-bar--action","-primary",3,"click","disabled","textContent"],[1,"op-toast","-warning"],[1,"op-toast--content"],[1,"spot-link","op-toast--close",3,"click"],[1,"spot-icon","spot-icon_close"],["class","spot-list spot-list_compact op-file-list op-file-picker--scrollable-content","data-test-selector","op-files-picker-modal--file-list",4,"ngIf","ngIfElse"],["data-test-selector","op-files-picker-modal--file-list",1,"spot-list","spot-list_compact","op-file-list","op-file-picker--scrollable-content"],["class","spot-list--item op-file-list--item","data-test-selector","op-file-list--item","op-storage-file-list-item","",3,"content",4,"ngFor","ngForOf"],["data-test-selector","op-file-list--item","op-storage-file-list-item","",1,"spot-list--item","op-file-list--item",3,"content"],["data-test-selector","op-file-list--loading-indicator",1,"spot-body-small"],[1,"spot-body-small","spot-body-small_bold","op-file-picker--info"],[1,"spot-icon","spot-icon_folder-open","op-file-picker--info-icon"],[1,"spot-body-small","op-file-picker--info-sub-text",3,"textContent"],[1,"spot-icon","spot-icon_remove-link","op-file-picker--info-icon"]],template:function LocationPickerModalComponent_Template(e,t){if(1&e){const e=u.RV6();u.j41(0,"div",4)(1,"div",5)(2,"span",6),u.EFF(3),u.k0s()(),u.nrm(4,"div",7),u.j41(5,"div",8),u.DNE(6,LocationPickerModalComponent_div_6_Template,7,3,"div",9),u.nI1(7,"async"),u.nrm(8,"spot-breadcrumbs",10),u.DNE(9,LocationPickerModalComponent_ng_container_9_Template,1,0,"ng-container",11),u.nI1(10,"async"),u.DNE(11,LocationPickerModalComponent_ng_container_11_Template,1,0,"ng-container",11),u.nI1(12,"async"),u.DNE(13,LocationPickerModalComponent_ng_container_13_Template,1,0,"ng-container",11),u.nI1(14,"async"),u.DNE(15,LocationPickerModalComponent_ng_template_15_Template,2,4,"ng-template",null,0,u.C5r)(17,LocationPickerModalComponent_ng_template_17_Template,1,0,"ng-template",null,1,u.C5r)(19,LocationPickerModalComponent_ng_template_19_Template,4,2,"ng-template",null,2,u.C5r)(21,LocationPickerModalComponent_ng_template_21_Template,4,2,"ng-template",null,3,u.C5r),u.k0s(),u.j41(23,"div",12)(24,"div",13)(25,"button",14),u.bIt("click",(function LocationPickerModalComponent_Template_button_click_25_listener(){return u.eBV(e),u.Njj(t.createAndNavigateToFolder())})),u.nrm(26,"span",15)(27,"span",16),u.k0s()(),u.j41(28,"div",17)(29,"button",18),u.bIt("click",(function LocationPickerModalComponent_Template_button_click_29_listener(){return u.eBV(e),u.Njj(t.closeMe())})),u.k0s(),u.j41(30,"button",19),u.bIt("click",(function LocationPickerModalComponent_Template_button_click_30_listener(){return u.eBV(e),u.Njj(t.chooseLocation())})),u.k0s()()()()}if(2&e){const e=u.sdS(16),n=u.sdS(18),i=u.sdS(22);u.R7$(3),u.JRh(t.text.header),u.R7$(3),u.Y8G("ngIf","none"!==u.bMT(7,14,t.showAlert)),u.R7$(2),u.Y8G("content",t.breadcrumbs),u.R7$(),u.Y8G("ngIf","success"===u.bMT(10,16,t.loading$))("ngIfThen",e),u.R7$(2),u.Y8G("ngIf","error"===u.bMT(12,18,t.loading$))("ngIfThen",i),u.R7$(2),u.Y8G("ngIf","loading"===u.bMT(14,20,t.loading$))("ngIfThen",n),u.R7$(12),u.Y8G("disabled",!t.canCreateFolder),u.R7$(2),u.Y8G("textContent",t.text.buttons.newFolder),u.R7$(2),u.Y8G("textContent",t.text.buttons.cancel),u.R7$(),u.Y8G("disabled",!t.canChooseLocation)("textContent",t.text.buttons.submit)}},dependencies:[h.Sq,h.bT,m._,g.S,_.c,h.Jj],encapsulation:2,changeDetection:0})}}},16604:(e,t,n)=>{"use strict";n.d(t,{O:()=>SortFilesPipe});var i=n(2319),o=n(68559);class SortFilesPipe{transform(e){return e.sort(((e,t)=>(0,i.wd)(e)&&(0,i.wd)(t)?e.name.localeCompare(t.name):(0,i.wd)(e)?-1:(0,i.wd)(t)?1:e.name.localeCompare(t.name)))}static{this.ɵfac=function SortFilesPipe_Factory(e){return new(e||SortFilesPipe)}}static{this.ɵpipe=o.EJ8({name:"sortFiles",type:SortFilesPipe,pure:!0})}}},54972:(e,t,n)=>{"use strict";n.d(t,{c:()=>StorageFileListItemComponent});n(22061);var i=n(11073),o=n(68559),r=n(60316),s=n(50130),a=n(45906),l=n(48377);const c=["op-storage-file-list-item",""],_c1=(e,t)=>({"spot-list--item-action_disabled":e,"op-file-list--item-action_view-not-allowed":t});function StorageFileListItemComponent_spot_checkbox_4_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"spot-checkbox",9),o.bIt("checkedChange",(function StorageFileListItemComponent_spot_checkbox_4_Template_spot_checkbox_checkedChange_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.content.checkbox.changeSelection())})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("checked",e.content.disabled||e.content.checkbox.selected)("disabled",e.content.disabled)}}function StorageFileListItemComponent_span_8_Template(e,t){if(1&e&&o.nrm(0,"span",10),2&e){const e=o.XpG();o.Y8G("textContent",e.content.timestamp)}}function StorageFileListItemComponent_op_principal_9_Template(e,t){if(1&e&&o.nrm(0,"op-principal",11),2&e){const e=o.XpG();o.Y8G("principal",e.principal)("hideName",!0)("size","mini")("link",!1)}}function StorageFileListItemComponent_button_10_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"button",12),o.bIt("click",(function StorageFileListItemComponent_button_10_Template_button_click_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.content.enterDirectory())})),o.nrm(1,"span",13),o.k0s()}}class StorageFileListItemComponent{get principal(){return this.content.createdByName?{name:this.content.createdByName,href:"/external_users/1"}:{name:"Not Available",href:"/placeholder_users/1"}}get getTooltipAlignment(){return this.content.isFirst?i.A.BottomLeft:i.A.TopLeft}enterDirectoryOnLabel(e){const t=e.target.className.includes("spot-checkbox");this.content.isDirectory&&!t&&(this.content.enterDirectory(),e.preventDefault(),e.stopPropagation())}static{this.ɵfac=function StorageFileListItemComponent_Factory(e){return new(e||StorageFileListItemComponent)}}static{this.ɵcmp=o.VBU({type:StorageFileListItemComponent,selectors:[["","op-storage-file-list-item",""]],inputs:{content:"content"},attrs:c,decls:11,vars:16,consts:[[3,"alignment","disabled"],["slot","body",1,"spot-body-small"],["slot","trigger","data-test-selector","op-files-picker-modal--list-item",1,"spot-list--item-action",3,"click","ngClass"],[3,"checked","disabled","checkedChange",4,"ngIf"],[1,"spot-list--item-title","op-file-list--item-title"],[3,"textContent"],["class","op-file-list--item-text",3,"textContent",4,"ngIf"],["class","op-file-list--item-avatar",3,"principal","hideName","size","link",4,"ngIf"],["class","spot-link op-file-list--item-button","data-test-selector","op-files-picker-modal--list-item-caret",3,"click",4,"ngIf"],[3,"checkedChange","checked","disabled"],[1,"op-file-list--item-text",3,"textContent"],[1,"op-file-list--item-avatar",3,"principal","hideName","size","link"],["data-test-selector","op-files-picker-modal--list-item-caret",1,"spot-link","op-file-list--item-button",3,"click"],[1,"spot-icon","spot-icon_arrow-right2"]],template:function StorageFileListItemComponent_Template(e,t){1&e&&(o.j41(0,"spot-tooltip",0)(1,"p",1),o.EFF(2),o.k0s(),o.j41(3,"label",2),o.bIt("click",(function StorageFileListItemComponent_Template_label_click_3_listener(e){return t.enterDirectoryOnLabel(e)})),o.DNE(4,StorageFileListItemComponent_spot_checkbox_4_Template,1,2,"spot-checkbox",3),o.j41(5,"div",4),o.nrm(6,"span")(7,"span",5),o.k0s(),o.DNE(8,StorageFileListItemComponent_span_8_Template,1,1,"span",6)(9,StorageFileListItemComponent_op_principal_9_Template,1,4,"op-principal",7)(10,StorageFileListItemComponent_button_10_Template,2,0,"button",8),o.k0s()()),2&e&&(o.Y8G("alignment",t.getTooltipAlignment)("disabled",!t.content.tooltip),o.R7$(2),o.JRh(t.content.tooltip),o.R7$(),o.Y8G("ngClass",o.l_i(13,_c1,t.content.disabled,t.content.isConstrained)),o.R7$(),o.Y8G("ngIf",!!t.content.checkbox),o.R7$(2),o.STu("spot-icon spot-icon_",t.content.icon.icon," op-files-tab--icon op-files-tab--icon_",t.content.icon.clazz,""),o.R7$(),o.Y8G("textContent",t.content.name),o.R7$(),o.Y8G("ngIf",!t.content.isDirectory),o.R7$(),o.Y8G("ngIf",!t.content.isDirectory),o.R7$(),o.Y8G("ngIf",t.content.isDirectory))},dependencies:[r.YU,r.bT,s.h,a.H,l.f],encapsulation:2,changeDetection:0})}}},22061:(e,t,n)=>{"use strict";n.d(t,{t:()=>StorageFileListItem});var i=n(2319);class StorageFileListItem{get name(){return this.storageFile.name}get mimeType(){return this.storageFile.mimeType}get createdByName(){return this.storageFile.createdByName}get timestamp(){return this.storageFile.lastModifiedAt?this.timezoneService.parseDatetime(this.storageFile.lastModifiedAt).fromNow():void 0}get icon(){return(0,i.nF)(this.storageFile.mimeType)}get isDirectory(){return(0,i.wd)(this.storageFile)}constructor(e,t,n,i,o,r,s,a){this.timezoneService=e,this.storageFile=t,this.disabled=n,this.isFirst=i,this.enterDirectory=o,this.isConstrained=r,this.tooltip=s,this.checkbox=a}}},40080:(e,t,n)=>{"use strict";n.d(t,{Z:()=>StorageInformationComponent});var i=n(68559),o=n(60316),r=n(4286);function StorageInformationComponent_div_6_Template(e,t){if(1&e&&(i.j41(0,"div",5),i.nrm(1,"op-storage-login-button",6),i.k0s()),2&e){const e=i.XpG();i.R7$(),i.Y8G("input",e.content.login)}}class StorageInformationComponent{static{this.ɵfac=function StorageInformationComponent_Factory(e){return new(e||StorageInformationComponent)}}static{this.ɵcmp=i.VBU({type:StorageInformationComponent,selectors:[["op-storage-information"]],inputs:{content:"content"},decls:7,vars:6,consts:[[1,"text-box"],[1,"text-box-header"],[3,"textContent"],[1,"text-box-content"],["class","button-box",4,"ngIf"],[1,"button-box"],[1,"op-files-tab--storage-info-box-button",3,"input"]],template:function StorageInformationComponent_Template(e,t){1&e&&(i.nrm(0,"span"),i.j41(1,"div",0)(2,"div",1),i.nrm(3,"span",2),i.k0s(),i.j41(4,"div",3),i.nrm(5,"span",2),i.k0s()(),i.DNE(6,StorageInformationComponent_div_6_Template,2,1,"div",4)),2&e&&(i.ZvI("spot-icon spot-icon_",t.content.iconClass," info-icon-box"),i.R7$(3),i.Y8G("textContent",t.content.header),i.R7$(2),i.Y8G("textContent",t.content.content),i.R7$(),i.Y8G("ngIf",t.content.login))},dependencies:[o.bT,r.q],encapsulation:2,changeDetection:0})}}},88124:(e,t,n)=>{"use strict";n.d(t,{X:()=>StorageInformationService});var i=n(70271),o=n(61816);class StorageInformationBox{constructor(e,t,n,i){this.iconClass=e,this.header=t,this.content=n,this.login=i}}var r=n(63894),s=n(2319),a=n(71639),l=n(68559);class StorageInformationService{constructor(e,t){this.i18n=e,this.currentUserService=t,this.text={fileLinkErrorHeader:this.i18n.t("js.storages.information.live_data_error"),fileLinkErrorContent:e=>this.i18n.t("js.storages.information.live_data_error_description",{storageType:e}),connectionErrorHeader:e=>this.i18n.t("js.storages.no_connection",{storageType:e}),connectionErrorContent:e=>this.i18n.t("js.storages.information.connection_error",{storageType:e}),authorizationFailureHeader:e=>this.i18n.t("js.storages.login_to",{storageType:e}),authorizationFailureContent:e=>this.i18n.t("js.storages.information.not_logged_in",{storageType:e}),loginButton:e=>this.i18n.t("js.storages.login",{storageType:e})}}storageInformation(e,t){return this.currentUserService.isLoggedIn$.pipe((0,i.T)((n=>{if(!n)return[];const i=this.i18n.t((0,s.pU)(e._links.type.href));switch(e._links.authorizationState.href){case a.aq:return[this.failedAuthorizationInformation(e,i)];case a.Jd:return[this.authorizationErrorInformation(i)];case a.L$:return this.hasFileLinkViewErrors(t)?[this.fileLinkErrorInformation(i)]:[];default:return[]}})))}failedAuthorizationInformation(e,t){if(!e._links.authorize)throw new Error("Authorize link is missing!");return new StorageInformationBox("import",this.text.authorizationFailureHeader(t),this.text.authorizationFailureContent(t),{storageId:e.id,storageType:e._links.type.href,authorizationLink:e._links.authorize})}authorizationErrorInformation(e){return new StorageInformationBox("remove-link",this.text.connectionErrorHeader(e),this.text.connectionErrorContent(e))}fileLinkErrorInformation(e){return new StorageInformationBox("error",this.text.fileLinkErrorHeader,this.text.fileLinkErrorContent(e))}hasFileLinkViewErrors(e){return e.filter((e=>e._links.status?.href===a.Lh)).length>0}static{this.ɵfac=function StorageInformationService_Factory(e){return new(e||StorageInformationService)(l.KVO(o.W),l.KVO(r.K))}}static{this.ɵprov=l.jDH({token:StorageInformationService,factory:StorageInformationService.ɵfac})}}},4286:(e,t,n)=>{"use strict";n.d(t,{q:()=>StorageLoginButtonComponent});var i=n(50315),o=n(61816),r=n(2319),s=n(37749),a=n(68559),l=n(76579);class StorageLoginButtonComponent{constructor(e,t,n){this.elementRef=e,this.i18n=t,this.cookieService=n,(0,s.w)(this)}ngOnInit(){const e=this.i18n.t((0,r.pU)(this.input.storageType));this.label=this.i18n.t("js.storages.login",{storageType:e})}login(){const e=(0,i.A)();this.setAuthorizationCallbackCookie(e),window.location.href=StorageLoginButtonComponent.authorizationFailureActionUrl(this.input.authorizationLink.href,e)}setAuthorizationCallbackCookie(e){this.cookieService.set(`oauth_state_${e}`,JSON.stringify({href:window.location.href,storageId:this.input.storageId}),{path:"/",expires:1/24})}static authorizationFailureActionUrl(e,t){return`${e}&state=${t}`}static{this.ɵfac=function StorageLoginButtonComponent_Factory(e){return new(e||StorageLoginButtonComponent)(a.rXU(a.aKT),a.rXU(o.W),a.rXU(l.O))}}static{this.ɵcmp=a.VBU({type:StorageLoginButtonComponent,selectors:[["op-storage-login-button"]],inputs:{input:"input"},decls:4,vars:1,consts:[["type","button",1,"button","button_no-margin",3,"click"],[1,"spot-icon","spot-icon_external-link"]],template:function StorageLoginButtonComponent_Template(e,t){1&e&&(a.j41(0,"button",0),a.bIt("click",(function StorageLoginButtonComponent_Template_button_click_0_listener(){return t.login()})),a.j41(1,"span"),a.EFF(2),a.k0s(),a.nrm(3,"span",1),a.k0s()),2&e&&(a.R7$(2),a.JRh(t.label))},encapsulation:2,changeDetection:0})}}},39176:(e,t,n)=>{"use strict";n.d(t,{P:()=>StorageComponent});var i=n(68559),o=n(19999),r=n(59452),s=n(77919),a=n(64334),l=n(36647),c=n(98764),p=n(70271),d=n(32037),u=n(51567),h=n(61318),m=(n(27514),n(77159)),g=n(71639),_=n(99496),f=n(61816),b=n(51133),k=n(544),v=n(51152),C=n(72650),y=n(36023),w=n(39626),T=n(32420),S=n(73014),j=n(12920),P=n(57436);var I=n(32203),x=n(97366),R=n(26109),F=n(88124),M=n(2319),O=n(97172),D=n(71870),G=n(10304);function convertHttpEvent(e,t){return(0,I.A)(e)&&null!==e.body?e.clone({body:t(e.body)}):e}class NextcloudUploadStrategy{constructor(e){this.http=e}execute(e,t){return t.map((t=>this.uploadSingle(e,t)))}uploadSingle(e,t){const n=new FormData;return n.append("file",t.file,t.file.name),void 0!==t.overwrite&&n.append("overwrite",String(t.overwrite)),this.http.request("post",e,{body:n,headers:{[G.e]:"true"},observe:"events",reportProgress:!0,responseType:"json"}).pipe((0,D.u)(),(0,p.T)((e=>convertHttpEvent(e,(e=>({id:e.file_id,name:e.file_name,size:t.file.size,mimeType:t.file.type}))))))}}class OneDriveUploadStrategy{constructor(e){this.http=e}execute(e,t){return t.map((t=>this.uploadSingle(e,t)))}uploadSingle(e,t){const n=`bytes 0-${t.file.size-1}/${t.file.size}`;return this.http.request("put",e,{body:t.file,headers:{[G.e]:"true","Content-Range":n},observe:"events",reportProgress:!0,responseType:"json"}).pipe((0,D.u)(),(0,p.T)((e=>convertHttpEvent(e,(e=>({id:e.id,name:e.name,size:e.size,mimeType:e.file.mimeType}))))))}}var E=n(30501);class StorageUploadService extends w.u{constructor(e){super(),this.http=e}upload(e,t){if(!this.uploadStrategy)throw new Error("missing strategy");return this.uploadStrategy.execute(e,t)}setUploadStrategy(e){switch(e){case g.Z8:this.uploadStrategy=new NextcloudUploadStrategy(this.http);break;case g.f3:this.uploadStrategy=new OneDriveUploadStrategy(this.http);break;default:throw new Error("unknown storage type")}}static{this.ɵfac=function StorageUploadService_Factory(e){return new(e||StorageUploadService)(i.KVO(E.Qq))}}static{this.ɵprov=i.jDH({token:StorageUploadService,factory:StorageUploadService.ɵfac})}}var A=n(57223),V=n(60316),$=n(60990),B=n(40080);const W=["hiddenFileInput"],_c1=e=>({"op-file-section":!0,"op-file-section--list_dragging":e}),_c2=(e,t,n)=>({"hide-when-print":!0,"op-file-section--drop-box":!0,"op-file-section--drop-box_dragging":e,"op-file-section--drop-box_dragging-over":t,"op-file-section--drop-box_float":n});function StorageComponent_ng_container_0_a_6_Template(e,t){if(1&e&&(i.j41(0,"a",12),i.nI1(1,"async"),i.nI1(2,"async"),i.nrm(3,"span",13),i.k0s()),2&e){const e=i.XpG(2);i.FS9("aria-label",e.text.openStorage(i.bMT(1,3,e.storageType))),i.Y8G("title",e.text.openStorage(i.bMT(2,5,e.storageType)))("href",e.openStorageLink,i.B4B)}}function StorageComponent_ng_container_0_op_storage_information_7_Template(e,t){if(1&e&&i.nrm(0,"op-storage-information",14),2&e){const e=t.$implicit;i.Y8G("content",e)}}function StorageComponent_ng_container_0_ul_10_li_1_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"li",17),i.nI1(1,"async"),i.bIt("removeFileLink",(function StorageComponent_ng_container_0_ul_10_li_1_Template_li_removeFileLink_0_listener(){const t=i.eBV(e).$implicit,n=i.XpG(3);return i.Njj(n.removeFileLink(t))})),i.k0s()}if(2&e){const e=t.$implicit,n=i.XpG(3);i.Y8G("fileLink",e)("disabled",i.bMT(1,3,n.disabled))("allowEditing",n.allowLinking)}}function StorageComponent_ng_container_0_ul_10_Template(e,t){if(1&e&&(i.j41(0,"ul",15),i.DNE(1,StorageComponent_ng_container_0_ul_10_li_1_Template,2,5,"li",16),i.nI1(2,"async"),i.k0s()),2&e){const e=i.XpG(2);i.Y8G("ngClass",i.eq3(4,_c1,e.dragging>0)),i.R7$(),i.Y8G("ngForOf",i.bMT(2,2,e.fileLinks))}}function StorageComponent_ng_container_0_span_12_Template(e,t){if(1&e&&(i.nrm(0,"span",18),i.nI1(1,"async")),2&e){const e=i.XpG(2);i.Y8G("textContent",e.text.emptyList(i.bMT(1,1,e.storageType)))}}function StorageComponent_ng_container_0_input_15_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"input",19,0),i.bIt("change",(function StorageComponent_ng_container_0_input_15_Template_input_change_0_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.onFilePickerChanged())})),i.k0s()}}function StorageComponent_ng_container_0_button_16_span_3_Template(e,t){if(1&e&&(i.nrm(0,"span",23),i.nI1(1,"async")),2&e){const e=i.XpG(3);i.Y8G("textContent",e.text.dropBox.dropFiles(i.bMT(1,1,e.storageType)))}}function StorageComponent_ng_container_0_button_16_span_5_Template(e,t){if(1&e&&(i.nrm(0,"span",23),i.nI1(1,"async")),2&e){const e=i.XpG(3);i.Y8G("textContent",e.text.dropBox.dropClickFiles(i.bMT(1,1,e.storageType)))}}function StorageComponent_ng_container_0_button_16_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",20),i.nI1(1,"async"),i.bIt("dragover",(function StorageComponent_ng_container_0_button_16_Template_button_dragover_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.onDragOver(t))}))("dragleave",(function StorageComponent_ng_container_0_button_16_Template_button_dragleave_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.onDragLeave(t))}))("drop",(function StorageComponent_ng_container_0_button_16_Template_button_drop_0_listener(t){i.eBV(e);const n=i.XpG(2);return i.Njj(n.onDropFiles(t))}))("click",(function StorageComponent_ng_container_0_button_16_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG(2);return i.Njj(t.triggerFileInput())})),i.nrm(2,"span",21),i.DNE(3,StorageComponent_ng_container_0_button_16_span_3_Template,2,3,"span",22),i.nI1(4,"async"),i.DNE(5,StorageComponent_ng_container_0_button_16_span_5_Template,2,3,"span",22),i.nI1(6,"async"),i.k0s()}if(2&e){let e,t,n;const o=i.XpG(2);i.Y8G("ngClass",i.sMw(10,_c2,o.dragging>0,o.draggingOverDropZone,null==(e=i.bMT(1,4,o.fileLinks))?null:e.length)),i.BMQ("aria-label",o.text.dropBox.uploadLabel),i.R7$(3),i.Y8G("ngIf",(null==(t=i.bMT(4,6,o.fileLinks))?null:t.length)>0),i.R7$(2),i.Y8G("ngIf",0===(null==(n=i.bMT(6,8,o.fileLinks))?null:n.length))}}function StorageComponent_ng_container_0_div_18_button_1_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",27),i.bIt("click",(function StorageComponent_ng_container_0_div_18_button_1_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG(3);return i.Njj(t.triggerFileInput())})),i.nrm(1,"span",28)(2,"span",29),i.k0s()}if(2&e){const e=i.XpG(3);i.R7$(2),i.Y8G("textContent",e.text.actions.uploadFile)}}function StorageComponent_ng_container_0_div_18_button_2_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",30),i.bIt("click",(function StorageComponent_ng_container_0_div_18_button_2_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG(3);return i.Njj(t.openLinkFilesDialog())})),i.nrm(1,"span",31)(2,"span",29),i.k0s()}if(2&e){const e=i.XpG(3);i.R7$(2),i.Y8G("textContent",e.text.actions.linkExisting)}}function StorageComponent_ng_container_0_div_18_Template(e,t){if(1&e&&(i.j41(0,"div",24),i.DNE(1,StorageComponent_ng_container_0_div_18_button_1_Template,3,1,"button",25)(2,StorageComponent_ng_container_0_div_18_button_2_Template,3,1,"button",26),i.k0s()),2&e){const e=i.XpG(2);i.R7$(),i.Y8G("ngIf",e.allowUploading),i.R7$(),i.Y8G("ngIf",e.allowLinking)}}function StorageComponent_ng_container_0_Template(e,t){if(1&e&&(i.qex(0),i.j41(1,"div",2),i.nrm(2,"span"),i.nI1(3,"async"),i.nrm(4,"span",3),i.nI1(5,"async"),i.DNE(6,StorageComponent_ng_container_0_a_6_Template,4,7,"a",4),i.k0s(),i.DNE(7,StorageComponent_ng_container_0_op_storage_information_7_Template,1,1,"op-storage-information",5),i.nI1(8,"async"),i.j41(9,"div",6),i.DNE(10,StorageComponent_ng_container_0_ul_10_Template,3,6,"ul",7),i.nI1(11,"async"),i.DNE(12,StorageComponent_ng_container_0_span_12_Template,2,3,"span",8),i.nI1(13,"async"),i.nI1(14,"async"),i.DNE(15,StorageComponent_ng_container_0_input_15_Template,2,0,"input",9)(16,StorageComponent_ng_container_0_button_16_Template,7,14,"button",10),i.nI1(17,"async"),i.DNE(18,StorageComponent_ng_container_0_div_18_Template,3,2,"div",11),i.nI1(19,"async"),i.k0s(),i.bVm()),2&e){let e,t,n,o,r,s;const a=i.XpG();i.R7$(2),i.ZvI("op-tab-content--header-icon spot-icon spot-icon_",a.icon.storageHeader(null==(e=i.bMT(3,11,a.storage))?null:e._links.type.href)," op-files-tab--icon op-files-tab--icon_primary"),i.R7$(2),i.Y8G("textContent",null==(t=i.bMT(5,13,a.storage))?null:t.name),i.R7$(2),i.Y8G("ngIf",a.openStorageLink),i.R7$(),i.Y8G("ngForOf",i.bMT(8,15,a.storageErrors)),i.R7$(3),i.Y8G("ngIf",(null==(n=i.bMT(11,17,a.fileLinks))?null:n.length)>0),i.R7$(2),i.Y8G("ngIf",!a.allowUploading&&0===(null==(o=i.bMT(13,19,a.storageErrors))?null:o.length)&&0===(null==(o=i.bMT(14,21,a.fileLinks))?null:o.length)),i.R7$(3),i.Y8G("ngIf",a.allowUploading),i.R7$(),i.Y8G("ngIf",a.allowUploading&&0===(null==(r=i.bMT(17,23,a.storageErrors))?null:r.length)),i.R7$(2),i.Y8G("ngIf",0===(null==(s=i.bMT(19,25,a.storageErrors))?null:s.length))}}class StorageComponent extends _.p{get addFileLinksHref(){return(0,x.A)(this.resource)?this.pathHelperService.fileLinksPath():this.resource.$links.addFileLink.href}get openStorageLink(){return this.projectStorage._links.openWithConnectionEnsured?.href||this.projectStorage._links.open?.href}constructor(e,t,n,o,r,s,a,l,c,p,d){super(),this.i18n=e,this.cdRef=t,this.toastService=n,this.uploadService=o,this.opModalService=r,this.timezoneService=s,this.pathHelperService=a,this.storagesResourceService=l,this.fileLinkResourceService=c,this.storageInformationService=p,this.storageFilesResourceService=d,this.allowUploading=!0,this.allowLinking=!0,this.fileRemoved=new i.bkB,this.fileAdded=new i.bkB,this.draggingOverDropZone=!1,this.dragging=0,this.icon={storageHeader:e=>O.U[e]||O.U.default},this.text={actions:{linkExisting:this.i18n.t("js.storages.link_existing_files"),uploadFile:this.i18n.t("js.storages.upload_files")},toast:{successFileLinksCreated:e=>this.i18n.t("js.storages.file_links.success_create",{count:e}),uploadFailed:e=>this.i18n.t("js.storages.file_links.upload_error.default",{fileName:e}),uploadFailedNextcloudDetail:this.i18n.t("js.storages.file_links.upload_error.detail.nextcloud"),uploadFailedForbidden:e=>this.i18n.t("js.storages.file_links.upload_error.403",{fileName:e}),uploadFailedSizeLimit:(e,t)=>this.i18n.t("js.storages.file_links.upload_error.413",{fileName:e,storageType:t}),uploadFailedQuota:e=>this.i18n.t("js.storages.file_links.upload_error.507",{fileName:e}),linkingAfterUploadFailed:(e,t)=>this.i18n.t("js.storages.file_links.link_uploaded_file_error",{fileName:e,workPackageId:t}),draggingManyFiles:e=>this.i18n.t("js.storages.files.dragging_many_files",{storageType:e}),draggingFolder:e=>this.i18n.t("js.storages.files.dragging_folder",{storageType:e}),uploadingLabel:this.i18n.t("js.label_upload_notification")},dropBox:{uploadLabel:this.i18n.t("js.storages.upload_files"),dropFiles:e=>this.i18n.t("js.storages.drop_files",{name:e}),dropClickFiles:e=>this.i18n.t("js.storages.drop_or_click_files",{name:e})},emptyList:e=>this.i18n.t("js.storages.file_links.empty",{storageType:e}),openStorage:e=>this.i18n.t("js.storages.open_storage",{storageType:e})},this.onGlobalDragLeave=e=>{this.dragging=Math.max(this.dragging-1,0),this.cdRef.detectChanges()},this.onGlobalDragEnd=e=>{this.dragging=0,this.cdRef.detectChanges()},this.onGlobalDragEnter=e=>{this.dragging=2,this.cdRef.detectChanges()}}ngOnInit(){this.storage=this.storagesResourceService.requireEntity(this.projectStorage._links.storage.href),this.fileLinks=this.storage.pipe((0,a.s)(1),(0,l.n)((()=>this.collectionKey().pipe((0,l.n)((e=>(0,x.A)(this.resource)?this.fileLinkResourceService.collection(e):this.fileLinkResourceService.requireCollection(e))),(0,c.M)((e=>{(0,x.A)(this.resource)&&(this.resource.fileLinks={elements:e.map((e=>e._links?.self))})})))))),this.fileLinks.subscribe({error:e=>this.toastService.addError(e)}),this.disabled=(0,o.z)([this.storage,this.fileLinks]).pipe((0,p.T)((([e,t])=>this.hasFileLinkViewErrors(t)||e._links.authorizationState.href!==g.L$))),this.storageType=this.storage.pipe((0,p.T)((e=>this.i18n.t((0,M.pU)(e._links.type.href))))),this.storage.pipe((0,a.s)(1)).subscribe((e=>{this.uploadService.setUploadStrategy(e._links.type.href)})),this.storageErrors=(0,o.z)([this.storage,this.fileLinks]).pipe(this.untilDestroyed(),(0,l.n)((([e,t])=>this.storageInformationService.storageInformation(e,t)))),document.body.addEventListener("dragenter",this.onGlobalDragEnter),document.body.addEventListener("dragleave",this.onGlobalDragLeave),document.body.addEventListener("dragend",this.onGlobalDragEnd),document.body.addEventListener("drop",this.onGlobalDragEnd)}ngOnDestroy(){document.body.removeEventListener("dragenter",this.onGlobalDragEnter),document.body.removeEventListener("dragleave",this.onGlobalDragLeave),document.body.removeEventListener("dragend",this.onGlobalDragEnd),document.body.removeEventListener("drop",this.onGlobalDragEnd)}removeFileLink(e){this.collectionKey().pipe((0,l.n)((t=>this.fileLinkResourceService.remove(t,e)))).subscribe({next:()=>{this.fileRemoved.emit()},error:e=>this.toastService.addError(e)})}openLinkFilesDialog(){(0,o.z)([this.storage,this.fileLinks,this.collectionKey()]).pipe((0,d.$)()).subscribe((([e,t,n])=>{const i={addFileLinksHref:this.addFileLinksHref,projectFolderHref:this.projectStorage._links.projectFolder?.href||null,projectFolderMode:this.projectStorage.projectFolderMode,storage:e,collectionKey:n,fileLinks:t};this.opModalService.show(k.T,"global",i)}))}triggerFileInput(){this.filePicker.nativeElement.click()}onFilePickerChanged(){const e=this.filePicker.nativeElement.files;null!==e&&(this.storageFileUpload(e[0]),this.filePicker.nativeElement.value="")}storageFileUpload(e){this.storage.pipe((0,l.n)((e=>this.selectUploadLocation(e))),(0,l.n)((t=>this.resolveUploadConflicts(e,t.files,t.location)))).subscribe((e=>{this.uploadAndCreateFileLink(e)}))}selectUploadLocation(e){const t={projectFolderHref:this.projectStorage._links.projectFolder?.href,projectFolderMode:this.projectStorage.projectFolderMode,createFolderHref:`${this.projectStorage._links.storage.href}/folders`,storage:e};return this.opModalService.show(v.o,"global",t).pipe((0,l.n)((e=>e.closingEvent)),(0,u.p)((e=>e.submitted)),(0,d.$)(),(0,p.T)((e=>({location:e.location.id,files:e.filesAtLocation}))))}resolveUploadConflicts(e,t,n){return t.find((t=>t.name===e.name))?this.opModalService.show(j._,"global",{fileName:e.name}).pipe((0,l.n)((e=>e.closingEvent)),(0,u.p)((e=>null!==e.overwrite)),(0,a.s)(1),(0,p.T)((t=>({file:e,location:n,overwrite:t.overwrite})))):(0,r.of)({file:e,location:n,overwrite:null})}uploadAndCreateFileLink(e){let t=!1;this.storage.pipe((0,l.n)((t=>{const n=this.uploadResourceLink(t,e.file.name,e.location);return this.storageFilesResourceService.uploadLink(n)})),(0,l.n)((t=>this.uploadAndNotify(t,e.file,e.overwrite))),(0,h.W)((e=>(t=!0,(0,s.$)(e)))),(0,l.n)((e=>this.createFileLinkData(e))),(0,c.M)((e=>{null===e&&this.collectionKey().pipe((0,l.n)((e=>this.fileLinkResourceService.fetchCollection(e)))).subscribe()})),(0,u.p)(P.A),(0,l.n)((e=>(0,o.z)([this.storage.pipe((0,d.$)()),this.collectionKey()]).pipe((0,l.n)((([t,n])=>this.fileLinkResourceService.addFileLinks(n,this.addFileLinksHref,t._links.self,[e]))))))).subscribe({next:e=>{this.toastService.addSuccess(this.text.toast.successFileLinksCreated(e.count)),this.fileAdded.emit()},error:n=>{t?this.handleUploadError(n,e.file.name):this.toastService.addError(this.text.toast.linkingAfterUploadFailed(e.file.name,this.resource.id)),console.error(n)}})}handleUploadError(e,t){if(500!==e.status||e.error.errorIdentifier!==A.Rj)switch(e.status){case 403:this.toastService.addError(this.text.toast.uploadFailedForbidden(t));break;case 413:this.storage.pipe((0,d.$)()).subscribe((e=>{const n=this.i18n.t((0,M.pU)(e._links.type.href)),i=this.text.toast.uploadFailedSizeLimit(t,n);this.toastService.addError(i)}));break;case 507:this.toastService.addError(this.text.toast.uploadFailedQuota(t));break;default:this.storage.pipe((0,d.$)()).subscribe((e=>{const n=e._links.type.href===g.Z8?this.text.toast.uploadFailedNextcloudDetail:[];this.toastService.addError(this.text.toast.uploadFailed(t),n)}))}else this.toastService.addError(e)}uploadAndNotify(e,t,n){const{href:i}=e._links.destination,o=[{file:t,overwrite:null!==n?n:void 0}],r=this.uploadService.upload(i,o)[0];return this.toastService.addUpload(this.text.toast.uploadingLabel,[[t,r]]),r.pipe((0,u.p)(I.A),(0,p.T)((e=>e.body)),(0,p.T)((e=>{if(null===e)throw new Error("Upload data is null.");return e})))}createFileLinkData(e){return this.fileLinks.pipe((0,a.s)(1),(0,p.T)((t=>{if(t.find((t=>function compareId(e,t){return String(e)===String(t)}(t.originData.id,e.id))))return null;const n=this.timezoneService.parseDate(new Date).toISOString();return{id:e.id,name:e.name,mimeType:e.mimeType,size:e.size,createdAt:n,lastModifiedAt:n}})))}uploadResourceLink(e,t,n){const i=this.resource.project.id,o=e._links.prepareUpload.filter((e=>i===e.payload.projectId.toString()));if(0===o.length)throw new Error("Cannot upload to this storage. Missing permissions in project.");return{href:o[0].href,method:o[0].method,title:o[0].title,payload:{projectId:o[0].payload.projectId,parent:n,fileName:t}}}hasFileLinkViewErrors(e){return e.filter((e=>e._links.status?.href===g.Lh)).length>0}collectionKey(){return(0,x.A)(this.resource)?(0,r.of)("new"):this.storage.pipe((0,d.$)(),(0,p.T)((e=>this.fileLinkSelfLink(e))))}fileLinkSelfLink(e){const t=this.resource.$links.fileLinks;return`${t?.href}?pageSize=-1&filters=[{"storage":{"operator":"=","values":["${e.id}"]}}]`}onDropFiles(e){if(null===e.dataTransfer)return;this.draggingOverDropZone=!1,this.dragging=0;const t=e.dataTransfer.files,n=1!==t.length,i=e.dataTransfer.items[0].webkitGetAsEntry()?.isDirectory;n||i?this.storageType.pipe((0,d.$)()).subscribe((e=>{const t=n?this.text.toast.draggingManyFiles(e):this.text.toast.draggingFolder(e);this.toastService.addError(t)})):this.storageFileUpload(t[0])}onDragOver(e){null!==e.dataTransfer&&e.dataTransfer.types.indexOf("Files")>=0&&(e.dataTransfer.dropEffect="copy",this.draggingOverDropZone=!0)}onDragLeave(e){this.draggingOverDropZone=!1}static{this.ɵfac=function StorageComponent_Factory(e){return new(e||StorageComponent)(i.rXU(f.W),i.rXU(i.gRc),i.rXU(C.fw),i.rXU(w.u),i.rXU(b.a),i.rXU(T.D),i.rXU(S.B),i.rXU(R.m),i.rXU(m.T),i.rXU(F.X),i.rXU(y.u))}}static{this.ɵcmp=i.VBU({type:StorageComponent,selectors:[["op-storage"]],viewQuery:function StorageComponent_Query(e,t){if(1&e&&i.GBs(W,5),2&e){let e;i.mGM(e=i.lsd())&&(t.filePicker=e.first)}},inputs:{resource:"resource",projectStorage:"projectStorage",allowUploading:"allowUploading",allowLinking:"allowLinking"},outputs:{fileRemoved:"fileRemoved",fileAdded:"fileAdded"},features:[i.Jv_([{provide:w.u,useClass:StorageUploadService}]),i.Vt3],decls:1,vars:1,consts:[["hiddenFileInput",""],[4,"ngIf"],[1,"op-tab-content--header"],[1,"op-tab-content--header-text",3,"textContent"],["class","op-tab-content--header-action spot-link","target","_blank",3,"aria-label","title","href",4,"ngIf"],["class","op-files-tab--storage-info-box","data-test-selector","op-storage--information",3,"content",4,"ngFor","ngForOf"],[1,"op-file-section"],["class","spot-list spot-list_compact op-file-list","data-test-selector","file-list",3,"ngClass",4,"ngIf"],["class","op-file-section--empty-list-hint",3,"textContent",4,"ngIf"],["type","file","id","upload_files","name","upload_files","hidden","",3,"change",4,"ngIf"],["data-test-selector","op-storage--drop-box","type","button",3,"ngClass","dragover","dragleave","drop","click",4,"ngIf"],["class","op-file-section--actions",4,"ngIf"],["target","_blank",1,"op-tab-content--header-action","spot-link",3,"aria-label","title","href"],[1,"spot-icon","spot-icon_external-link"],["data-test-selector","op-storage--information",1,"op-files-tab--storage-info-box",3,"content"],["data-test-selector","file-list",1,"spot-list","spot-list_compact","op-file-list",3,"ngClass"],["class","spot-list--item op-file-list--item","data-test-selector","file-list--item","op-file-link-list-item","",3,"fileLink","disabled","allowEditing","removeFileLink",4,"ngFor","ngForOf"],["data-test-selector","file-list--item","op-file-link-list-item","",1,"spot-list--item","op-file-list--item",3,"removeFileLink","fileLink","disabled","allowEditing"],[1,"op-file-section--empty-list-hint",3,"textContent"],["type","file","id","upload_files","name","upload_files","hidden","",3,"change"],["data-test-selector","op-storage--drop-box","type","button",3,"dragover","dragleave","drop","click","ngClass"],[1,"spot-icon","spot-icon_upload-arrow","op-file-section--drop-box-icon"],["class","op-file-section--drop-box-text",3,"textContent",4,"ngIf"],[1,"op-file-section--drop-box-text",3,"textContent"],[1,"op-file-section--actions"],["type","button","class","spot-link","data-test-selector","op-storage--upload-file-button",3,"click",4,"ngIf"],["type","button","class","spot-link","data-test-selector","op-storage--link-existing-file-button",3,"click",4,"ngIf"],["type","button","data-test-selector","op-storage--upload-file-button",1,"spot-link",3,"click"],[1,"spot-icon","spot-icon_upload-arrow"],[3,"textContent"],["type","button","data-test-selector","op-storage--link-existing-file-button",1,"spot-link",3,"click"],[1,"spot-icon","spot-icon_add-link"]],template:function StorageComponent_Template(e,t){1&e&&i.DNE(0,StorageComponent_ng_container_0_Template,20,27,"ng-container",1),2&e&&i.Y8G("ngIf",t.resource)},dependencies:[V.YU,V.Sq,V.bT,$.h,B.Z,V.Jj],encapsulation:2,changeDetection:0})}}},71639:(e,t,n)=>{"use strict";n.d(t,{Jd:()=>a,L$:()=>r,Lh:()=>d,Ng:()=>c,SL:()=>l,SV:()=>p,Z8:()=>i,aq:()=>s,f3:()=>o});const i="urn:openproject-org:api:v3:storages:Nextcloud",o="urn:openproject-org:api:v3:storages:OneDrive",r="urn:openproject-org:api:v3:storages:authorization:Connected",s="urn:openproject-org:api:v3:storages:authorization:FailedAuthorization",a="urn:openproject-org:api:v3:storages:authorization:Error",l="urn:openproject-org:api:v3:file-links:permission:ViewAllowed",c="urn:openproject-org:api:v3:file-links:permission:ViewNotAllowed",p="urn:openproject-org:api:v3:file-links:NotFound",d="urn:openproject-org:api:v3:file-links:Error"},12920:(e,t,n)=>{"use strict";n.d(t,{_:()=>UploadConflictModalComponent});var i=n(61816),o=n(69081),r=n(51133),s=n(68559);class UploadConflictModalComponent extends o.a{constructor(e,t,n,i){super(e,t,n),this.locals=e,this.cdRef=t,this.elementRef=n,this.i18n=i,this.overwrite=null,this.text={header:this.i18n.t("js.storages.files.already_existing_header"),body:()=>this.i18n.t("js.storages.files.already_existing_body",{fileName:this.locals.fileName}),buttons:{keepBoth:this.i18n.t("js.storages.files.upload_keep_both"),replace:this.i18n.t("js.storages.files.upload_replace"),cancel:this.i18n.t("js.button_cancel")}}}close(e){this.overwrite=e,this.service.close()}static{this.ɵfac=function UploadConflictModalComponent_Factory(e){return new(e||UploadConflictModalComponent)(s.rXU(r.Y),s.rXU(s.gRc),s.rXU(s.aKT),s.rXU(i.W))}}static{this.ɵcmp=s.VBU({type:UploadConflictModalComponent,selectors:[["ng-component"]],features:[s.Vt3],decls:10,vars:5,consts:[[1,"spot-modal"],[1,"spot-modal--header"],["id","spotModalTitle",1,"spot-modal--header-title",3,"textContent"],[1,"spot-modal--body","spot-container"],[1,"spot-body-small",3,"textContent"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button",1,"button","spot-action-bar--action",3,"click","textContent"],["type","button",1,"button","spot-action-bar--action","-primary",3,"click","textContent"]],template:function UploadConflictModalComponent_Template(e,t){1&e&&(s.j41(0,"div",0)(1,"div",1),s.nrm(2,"span",2),s.k0s(),s.j41(3,"div",3),s.nrm(4,"span",4),s.k0s(),s.j41(5,"div",5)(6,"div",6)(7,"button",7),s.bIt("click",(function UploadConflictModalComponent_Template_button_click_7_listener(){return t.closeMe()})),s.k0s(),s.j41(8,"button",7),s.bIt("click",(function UploadConflictModalComponent_Template_button_click_8_listener(){return t.close(!1)})),s.k0s(),s.j41(9,"button",8),s.bIt("click",(function UploadConflictModalComponent_Template_button_click_9_listener(){return t.close(!0)})),s.k0s()()()()),2&e&&(s.R7$(2),s.Y8G("textContent",t.text.header),s.R7$(2),s.Y8G("textContent",t.text.body()),s.R7$(3),s.Y8G("textContent",t.text.buttons.cancel),s.R7$(),s.Y8G("textContent",t.text.buttons.keepBoth),s.R7$(),s.Y8G("textContent",t.text.buttons.replace))},encapsulation:2,changeDetection:0})}}},27091:(e,t,n)=>{"use strict";n.d(t,{i:()=>PaginationInstance});class PaginationInstance{constructor(e,t,n){this.page=e,this.total=t,this.perPage=n}getLowerPageBound(){return this.perPage*(this.page-1)+1}getUpperPageBound(e){return Math.min(this.perPage*this.page,e)}nextPage(){this.page+=1}previousPage(){this.page-=1}}},81965:(e,t,n)=>{"use strict";n.d(t,{m:()=>PaginationService});var i=n(72688),o=n(68559);const r=6,s=1;class PaginationService{constructor(e){this.configuration=e,this.loadPaginationOptions()}getCachedPerPage(e){const t=this.localStoragePerPage,n=e?.length||0;return null!==t&&t>0&&(0===n||-1!==e?.indexOf(t))?t:n>0?e[0]:20}get localStoragePerPage(){const e=window.OpenProject.guardedLocalStorage("pagination.perPage");return void 0!==e?parseInt(e,10):null}getPaginationOptions(){return this.paginationOptions}getPerPage(){return this.localStoragePerPage||this.paginationOptions.perPage}getMaxVisiblePageOptions(){return _.get(this.paginationOptions,"maxVisiblePageOptions",r)}getOptionsTruncationSize(){return _.get(this.paginationOptions,"optionsTruncationSize",s)}setPerPage(e){window.OpenProject.guardedLocalStorage("pagination.perPage",e.toString()),this.paginationOptions.perPage=e}getPerPageOptions(){return this.paginationOptions.perPageOptions}setPerPageOptions(e){this.paginationOptions.perPageOptions=e}loadPaginationOptions(){this.paginationOptions={perPage:this.getCachedPerPage(this.configuration.perPageOptions),perPageOptions:this.configuration.perPageOptions,maxVisiblePageOptions:r,optionsTruncationSize:s}}static{this.ɵfac=function PaginationService_Factory(e){return new(e||PaginationService)(o.KVO(i.s))}}static{this.ɵprov=o.jDH({token:PaginationService,factory:PaginationService.ɵfac})}}},13813:(e,t,n)=>{"use strict";n.d(t,{w:()=>TablePaginationComponent});var i=n(68559),o=n(61816),r=n(99496),s=n(27091),a=n(81965),l=n(60316),c=n(46765);const p=["tablePagination",""],_c1=e=>({"op-pagination--item_current":e});function TablePaginationComponent_div_0_ng_container_6_li_1_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"li",15)(1,"button",16),i.bIt("click",(function TablePaginationComponent_div_0_ng_container_6_li_1_Template_button_click_1_listener(){const t=i.eBV(e).$implicit,n=i.XpG(3);return i.Njj(n.showPage(t))})),i.k0s()()}if(2&e){const e=t.$implicit;i.R7$(),i.Y8G("textContent",e)}}function TablePaginationComponent_div_0_ng_container_6_Template(e,t){if(1&e&&(i.qex(0),i.DNE(1,TablePaginationComponent_div_0_ng_container_6_li_1_Template,2,1,"li",13),i.j41(2,"li",14),i.EFF(3,"…"),i.k0s(),i.bVm()),2&e){const e=i.XpG(2);i.R7$(),i.Y8G("ngForOf",e.prePageNumbers)}}function TablePaginationComponent_div_0_ng_container_7_li_1_em_1_Template(e,t){if(1&e&&(i.j41(0,"em"),i.EFF(1),i.k0s()),2&e){const e=i.XpG().$implicit;i.R7$(),i.JRh(e)}}function TablePaginationComponent_div_0_ng_container_7_li_1_button_2_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",16),i.bIt("click",(function TablePaginationComponent_div_0_ng_container_7_li_1_button_2_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG().$implicit,n=i.XpG(3);return i.Njj(n.showPage(t))})),i.k0s()}if(2&e){const e=i.XpG().$implicit;i.Y8G("textContent",e)}}function TablePaginationComponent_div_0_ng_container_7_li_1_Template(e,t){if(1&e&&(i.j41(0,"li",19),i.DNE(1,TablePaginationComponent_div_0_ng_container_7_li_1_em_1_Template,2,1,"em",6)(2,TablePaginationComponent_div_0_ng_container_7_li_1_button_2_Template,1,1,"button",20),i.k0s()),2&e){const e=t.$implicit,n=i.XpG(3);i.Y8G("ngClass",i.eq3(3,_c1,e===n.pagination.page)),i.R7$(),i.Y8G("ngIf",e===n.pagination.page),i.R7$(),i.Y8G("ngIf",e!==n.pagination.page)}}function TablePaginationComponent_div_0_ng_container_7_li_2_Template(e,t){1&e&&(i.j41(0,"li",14),i.EFF(1,"…"),i.k0s())}function TablePaginationComponent_div_0_ng_container_7_Template(e,t){if(1&e&&(i.qex(0),i.DNE(1,TablePaginationComponent_div_0_ng_container_7_li_1_Template,3,5,"li",17)(2,TablePaginationComponent_div_0_ng_container_7_li_2_Template,2,0,"li",18),i.bVm()),2&e){const e=i.XpG(2);i.R7$(),i.Y8G("ngForOf",e.pageNumbers),i.R7$(),i.Y8G("ngIf",e.postPageNumbers.length)}}function TablePaginationComponent_div_0_ng_container_8_li_1_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"li",15)(1,"button",16),i.bIt("click",(function TablePaginationComponent_div_0_ng_container_8_li_1_Template_button_click_1_listener(){const t=i.eBV(e).$implicit,n=i.XpG(3);return i.Njj(n.showPage(t))})),i.k0s()()}if(2&e){const e=t.$implicit;i.R7$(),i.Y8G("textContent",e)}}function TablePaginationComponent_div_0_ng_container_8_Template(e,t){if(1&e&&(i.qex(0),i.DNE(1,TablePaginationComponent_div_0_ng_container_8_li_1_Template,2,1,"li",13),i.bVm()),2&e){const e=i.XpG(2);i.R7$(),i.Y8G("ngForOf",e.postPageNumbers)}}function TablePaginationComponent_div_0_span_14_Template(e,t){if(1&e&&i.nrm(0,"span",21),2&e){const e=i.XpG(2);i.Y8G("textContent",e.text.no_other_page)}}function TablePaginationComponent_div_0_li_15_Template(e,t){if(1&e&&(i.j41(0,"li",22),i.nrm(1,"op-icon",23)(2,"span",9),i.k0s()),2&e){const e=i.XpG(2);i.R7$(2),i.Y8G("textContent",e.infoText)}}function TablePaginationComponent_div_0_div_16_li_3_span_1_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"span")(1,"button",27),i.bIt("click",(function TablePaginationComponent_div_0_div_16_li_3_span_1_Template_button_click_1_listener(){i.eBV(e);const t=i.XpG().$implicit,n=i.XpG(3);return i.Njj(n.selectPerPage(t))})),i.k0s()()}if(2&e){const e=i.XpG().$implicit;i.R7$(),i.Y8G("textContent",e)}}function TablePaginationComponent_div_0_div_16_li_3_span_2_Template(e,t){if(1&e&&(i.j41(0,"span"),i.EFF(1),i.k0s()),2&e){const e=i.XpG().$implicit;i.R7$(),i.JRh(e)}}function TablePaginationComponent_div_0_div_16_li_3_Template(e,t){if(1&e&&(i.j41(0,"li",19),i.DNE(1,TablePaginationComponent_div_0_div_16_li_3_span_1_Template,2,1,"span",6)(2,TablePaginationComponent_div_0_div_16_li_3_span_2_Template,2,1,"span",6),i.k0s()),2&e){const e=t.$implicit,n=i.XpG(3);i.Y8G("ngClass",i.eq3(3,_c1,e===n.pagination.perPage)),i.R7$(),i.Y8G("ngIf",e!==n.pagination.perPage),i.R7$(),i.Y8G("ngIf",e===n.pagination.perPage)}}function TablePaginationComponent_div_0_div_16_Template(e,t){if(1&e&&(i.j41(0,"div",24)(1,"ul",25),i.nrm(2,"li",26),i.DNE(3,TablePaginationComponent_div_0_div_16_li_3_Template,3,5,"li",17),i.k0s()()),2&e){const e=i.XpG(2);i.R7$(2),i.FS9("title",e.text.per_page),i.Y8G("textContent",e.text.per_page),i.R7$(),i.Y8G("ngForOf",e.perPageOptions)}}function TablePaginationComponent_div_0_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",1)(1,"nav",2)(2,"ul",3)(3,"li",4)(4,"button",5),i.bIt("click",(function TablePaginationComponent_div_0_Template_button_click_4_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.showPage(t.pagination.page-1))})),i.EFF(5," < "),i.k0s()(),i.DNE(6,TablePaginationComponent_div_0_ng_container_6_Template,4,1,"ng-container",6)(7,TablePaginationComponent_div_0_ng_container_7_Template,3,2,"ng-container",6)(8,TablePaginationComponent_div_0_ng_container_8_Template,2,1,"ng-container",6),i.j41(9,"li",4)(10,"button",7),i.bIt("click",(function TablePaginationComponent_div_0_Template_button_click_10_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.showPage(t.pagination.page+1))})),i.EFF(11," > "),i.k0s()(),i.j41(12,"li",8),i.nrm(13,"span",9),i.DNE(14,TablePaginationComponent_div_0_span_14_Template,1,1,"span",10),i.k0s(),i.DNE(15,TablePaginationComponent_div_0_li_15_Template,3,1,"li",11),i.k0s()(),i.DNE(16,TablePaginationComponent_div_0_div_16_Template,4,3,"div",12),i.k0s()}if(2&e){const e=i.XpG();i.R7$(3),i.Y8G("hidden",1===e.pagination.page||!e.showPageSelections),i.R7$(),i.BMQ("aria-label",e.text.label_previous),i.R7$(2),i.Y8G("ngIf",e.prePageNumbers.length>0),i.R7$(),i.Y8G("ngIf",e.pageNumbers.length>1),i.R7$(),i.Y8G("ngIf",e.postPageNumbers.length),i.R7$(),i.Y8G("hidden",!(e.pagination.total&&e.pagination.page<e.pageNumbers[e.pageNumbers.length-1])),i.R7$(),i.BMQ("aria-label",e.text.label_next),i.R7$(3),i.Y8G("textContent",e.currentRange),i.R7$(),i.Y8G("ngIf",1===e.pageNumbers.length),i.R7$(),i.Y8G("ngIf",e.infoText),i.R7$(),i.Y8G("ngIf",e.showPerPageOptions())}}class TablePaginationComponent extends r.p{constructor(e,t,n){super(),this.paginationService=e,this.cdRef=t,this.I18n=n,this.hideForSinglePageResults=!1,this.showPerPage=!0,this.showPageSelections=!0,this.updateResults=new i.bkB,this.text={label_previous:this.I18n.t("js.pagination.pages.previous"),label_next:this.I18n.t("js.pagination.pages.next"),per_page:this.I18n.t("js.label_per_page"),no_other_page:this.I18n.t("js.pagination.no_other_page")},this.currentRange="",this.pageNumbers=[],this.postPageNumbers=[],this.prePageNumbers=[],this.perPageOptions=[]}ngOnInit(){const e=this.paginationService.getPaginationOptions();this.perPageOptions=e.perPageOptions,this.pagination=new s.i(1,parseInt(this.totalEntries,10),e.perPage)}update(){this.updateCurrentRangeLabel(),this.updatePageNumbers(),this.cdRef.detectChanges()}selectPerPage(e){this.pagination.perPage=e,this.paginationService.setPerPage(e),this.showPage(1)}showPage(e){this.pagination.page=e,this.updateCurrentRangeLabel(),this.updatePageNumbers(),this.onUpdatedPage(),this.cdRef.detectChanges()}onUpdatedPage(){this.updateResults.emit(this.pagination)}get isVisible(){return!this.hideForSinglePageResults||this.pagination.total>this.pagination.perPage}updateCurrentRangeLabel(){if(this.pagination.total){const e=this.pagination.total,t=this.pagination.getLowerPageBound(),n=this.pagination.getUpperPageBound(this.pagination.total);this.currentRange=`(${t} - ${n}/${e})`}else this.currentRange="(0 - 0/0)"}updatePageNumbers(){if(!this.showPageSelections)return this.pageNumbers=[],void(this.postPageNumbers=[]);const e=this.paginationService.getMaxVisiblePageOptions(),t=this.paginationService.getOptionsTruncationSize(),n=[],{perPage:i}=this.pagination,o=this.pagination.page;if(i){for(let e=1;e<=Math.ceil(this.pagination.total/i);e++)n.push(e);const r=Math.min(o-Math.ceil(e/2),n.length-e);this.prePageNumbers=this.truncatePageNums(n,o>=e&&n.length>=e+2*t,0,r,t),this.postPageNumbers=this.truncatePageNums(n,n.length>=e+2*t,e,n.length,0)}this.pageNumbers=n}showPerPageOptions(){return this.showPerPage&&this.perPageOptions.length>0&&this.pagination.total>this.perPageOptions[0]}truncatePageNums(e,t,n,i,o){if(t){const t=this.paginationService.getOptionsTruncationSize(),r=e.splice(n,i);return r.length>=2*t&&r.splice(o,r.length-t),r}return[]}static{this.ɵfac=function TablePaginationComponent_Factory(e){return new(e||TablePaginationComponent)(i.rXU(a.m),i.rXU(i.gRc),i.rXU(o.W))}}static{this.ɵcmp=i.VBU({type:TablePaginationComponent,selectors:[["","tablePagination",""]],inputs:{totalEntries:"totalEntries",hideForSinglePageResults:"hideForSinglePageResults",showPerPage:"showPerPage",showPageSelections:"showPageSelections",infoText:"infoText"},outputs:{updateResults:"updateResults"},features:[i.Vt3],attrs:p,decls:1,vars:1,consts:[["class","op-pagination",4,"ngIf"],[1,"op-pagination"],[1,"op-pagination--pages"],[1,"op-pagination--items","op-pagination--items_start"],[1,"op-pagination--item",3,"hidden"],["type","button","rel","prev start",1,"op-pagination--item-link","op-pagination--item-link_prev",3,"click"],[4,"ngIf"],["type","button","rel","next",1,"op-pagination--item-link","op-pagination--item-link_next",3,"click"],[1,"op-pagination--range"],[3,"textContent"],["id","op-pagination-empty-text","tabindex","0","class","hidden-for-sighted",3,"textContent",4,"ngIf"],["class","op-pagination--info",4,"ngIf"],["class","op-pagination--options",4,"ngIf"],["class","op-pagination--item",4,"ngFor","ngForOf"],[1,"op-pagination--space"],[1,"op-pagination--item"],["type","button","rel","next",1,"op-pagination--item-link",3,"click","textContent"],["class","op-pagination--item",3,"ngClass",4,"ngFor","ngForOf"],["class","op-pagination--space",4,"ngIf"],[1,"op-pagination--item",3,"ngClass"],["class","op-pagination--item-link","type","button","rel","next",3,"textContent","click",4,"ngIf"],["id","op-pagination-empty-text","tabindex","0",1,"hidden-for-sighted",3,"textContent"],[1,"op-pagination--info"],["icon-classes","icon-info1 icon-context"],[1,"op-pagination--options"],[1,"op-pagination--items","op-pagination--items_end"],[1,"op-pagination--label",3,"textContent","title"],["type","button",1,"op-pagination--item-link",3,"click","textContent"]],template:function TablePaginationComponent_Template(e,t){1&e&&i.DNE(0,TablePaginationComponent_div_0_Template,17,11,"div",0),2&e&&i.Y8G("ngIf",t.pagination&&t.isVisible&&t.pagination.total)},dependencies:[l.YU,l.Sq,l.bT,c.i],encapsulation:2,changeDetection:0})}}},82724:(e,t,n)=>{"use strict";n.d(t,{V:()=>ContentTabsComponent});var i=n(51730),o=n(83093),r=n(61816),s=n(74406),a=n(68559),l=n(60316),c=n(88955),p=n(36783);const d=[[["","slot","actions"]]],u=["[slot=actions]"];function ContentTabsComponent_li_5_a_1_Template(e,t){if(1&e){const e=a.RV6();a.j41(0,"a",16),a.bIt("click",(function ContentTabsComponent_li_5_a_1_Template_a_click_0_listener(t){a.eBV(e);const n=a.XpG().$implicit,i=a.XpG();return a.Njj(i.clickTab(n,t))})),a.k0s()}if(2&e){const e=a.XpG().$implicit,t=a.XpG();a.AVh("op-tab-row--link_selected",e.id===t.currentTabId)("op-tab-row--link_disabled",void 0!==e.disable),a.Y8G("href",e.path,a.B4B)("textContent",e.name),a.BMQ("aria-selected",e.id===t.currentTabId)("title",t.tabTitle(e))}}function ContentTabsComponent_li_5_a_2_ng_container_2_op_tab_count_1_Template(e,t){if(1&e&&a.nrm(0,"op-tab-count",22),2&e){const e=a.XpG().ngIf,t=a.XpG(2).$implicit;a.Y8G("count",e),a.BMQ("data-test-selector","tab-counter-"+t.name)}}function ContentTabsComponent_li_5_a_2_ng_container_2_span_2_Template(e,t){if(1&e&&(a.j41(0,"span",23),a.EFF(1),a.k0s()),2&e){const e=a.XpG().ngIf;a.R7$(),a.SpI(" (",e,")")}}function ContentTabsComponent_li_5_a_2_ng_container_2_Template(e,t){if(1&e&&(a.qex(0),a.DNE(1,ContentTabsComponent_li_5_a_2_ng_container_2_op_tab_count_1_Template,1,2,"op-tab-count",20)(2,ContentTabsComponent_li_5_a_2_ng_container_2_span_2_Template,2,1,"span",21),a.bVm()),2&e){const e=t.ngIf,n=a.XpG(2).$implicit;a.R7$(),a.Y8G("ngIf",n.showCountAsBubble),a.R7$(),a.Y8G("ngIf",e>0&&!n.showCountAsBubble)}}function ContentTabsComponent_li_5_a_2_Template(e,t){if(1&e){const e=a.RV6();a.j41(0,"a",17),a.bIt("click",(function ContentTabsComponent_li_5_a_2_Template_a_click_0_listener(t){a.eBV(e);const n=a.XpG().$implicit,i=a.XpG();return a.Njj(i.clickTab(n,t))})),a.nrm(1,"span",18),a.DNE(2,ContentTabsComponent_li_5_a_2_ng_container_2_Template,3,2,"ng-container",19),a.nI1(3,"async"),a.k0s()}if(2&e){const e=a.XpG().$implicit,t=a.XpG();a.AVh("op-tab-row--link_disabled",void 0!==e.disable),a.Y8G("uiSref",e.route)("uiParams",e.routeParams),a.BMQ("aria-selected",e.id===t.currentTabId)("title",t.tabTitle(e)),a.R7$(),a.Y8G("textContent",e.name),a.R7$(),a.Y8G("ngIf",a.bMT(3,8,t.counter(e)))}}function ContentTabsComponent_li_5_Template(e,t){if(1&e){const e=a.RV6();a.j41(0,"li",13),a.bIt("dragenter",(function ContentTabsComponent_li_5_Template_li_dragenter_0_listener(){const t=a.eBV(e).$implicit,n=a.XpG();return a.Njj(n.startDebouncedTabActivation(t))}))("dragleave",(function ContentTabsComponent_li_5_Template_li_dragleave_0_listener(){a.eBV(e);const t=a.XpG();return a.Njj(t.cancelDebouncedTabActivation())})),a.DNE(1,ContentTabsComponent_li_5_a_1_Template,1,8,"a",14)(2,ContentTabsComponent_li_5_a_2_Template,4,10,"a",15),a.k0s()}if(2&e){const e=t.$implicit,n=a.XpG();a.BMQ("data-tab-id",e.id)("data-qa-tab-id",e.id)("data-qa-tab-selected",e.id===n.currentTabId||void 0)("data-qa-tab-disabled",e.disable||void 0),a.R7$(),a.Y8G("ngIf",!e.route),a.R7$(),a.Y8G("ngIf",e.route)}}class ContentTabsComponent extends s.f{constructor(e,t,n,i,o,r){super(t,i,r),this.elementRef=e,this.$state=t,this.gon=n,this.I18n=o,this.injector=r,this.classes=["content--tabs","scrollable-tabs"];const s=JSON.parse(this.gon.get("contentTabs").tabs),a=JSON.parse(this.gon.get("contentTabs").selected);this.tabs=s.map((e=>({id:e.name,name:this.I18n.t(`js.${e.label}`,{defaultValue:e.label}),path:e.path}))),this.currentTabId=a.name}static{this.ɵfac=function ContentTabsComponent_Factory(e){return new(e||ContentTabsComponent)(a.rXU(a.aKT),a.rXU(o.dw),a.rXU(i.m),a.rXU(a.gRc),a.rXU(r.W),a.rXU(a.zZn))}}static{this.ɵcmp=a.VBU({type:ContentTabsComponent,selectors:[["opce-content-tabs"]],features:[a.Vt3],ngContentSelectors:u,decls:14,vars:5,consts:[["scrollContainer",""],["scrollPane",""],["scrollLeftBtn",""],["scrollRightBtn",""],[1,"op-scrollable-tabs",3,"ngClass"],[1,"op-scrollable-tabs--tab-container"],[1,"op-tab-row",3,"scroll"],["class","op-tab-row--tab",3,"dragenter","dragleave",4,"ngFor","ngForOf","ngForTrackBy"],[1,"op-scrollable-tabs--button","op-scrollable-tabs--button_left",3,"click","hidden"],[1,"icon-arrow-left2"],[1,"op-scrollable-tabs--button","op-scrollable-tabs--button_right",3,"click","hidden"],[1,"icon-arrow-right2"],[1,"op-scrollable-tabs--actions"],[1,"op-tab-row--tab",3,"dragenter","dragleave"],["class","op-tab-row--link","role","tab",3,"href","op-tab-row--link_selected","op-tab-row--link_disabled","textContent","click",4,"ngIf"],["role","tab","class","op-tab-row--link","uiSrefActive","op-tab-row--link_selected","href","",3,"uiSref","uiParams","op-tab-row--link_disabled","click",4,"ngIf"],["role","tab",1,"op-tab-row--link",3,"click","href","textContent"],["role","tab","uiSrefActive","op-tab-row--link_selected","href","",1,"op-tab-row--link",3,"click","uiSref","uiParams"],[3,"textContent"],[4,"ngIf"],[3,"count",4,"ngIf"],["data-test-selector","tab-count",4,"ngIf"],[3,"count"],["data-test-selector","tab-count"]],template:function ContentTabsComponent_Template(e,t){if(1&e){const e=a.RV6();a.NAR(d),a.j41(0,"div",4)(1,"div",5,0)(3,"ul",6,1),a.bIt("scroll",(function ContentTabsComponent_Template_ul_scroll_3_listener(){return a.eBV(e),a.Njj(t.onScroll())})),a.DNE(5,ContentTabsComponent_li_5_Template,3,6,"li",7),a.k0s(),a.j41(6,"div",8,2),a.bIt("click",(function ContentTabsComponent_Template_div_click_6_listener(){return a.eBV(e),a.Njj(t.scrollLeft())})),a.nrm(8,"span",9),a.k0s(),a.j41(9,"div",10,3),a.bIt("click",(function ContentTabsComponent_Template_div_click_9_listener(){return a.eBV(e),a.Njj(t.scrollRight())})),a.nrm(11,"span",11),a.k0s()(),a.j41(12,"ul",12),a.SdG(13),a.k0s()()}2&e&&(a.Y8G("ngClass",t.classes),a.R7$(5),a.Y8G("ngForOf",t.tabs)("ngForTrackBy",t.trackById),a.R7$(),a.Y8G("hidden",t.hideLeftButton),a.R7$(3),a.Y8G("hidden",t.hideRightButton))},dependencies:[l.YU,l.Sq,l.bT,c.UISref,c.AnchorUISref,c.UISrefActive,c.UISrefStatus,p.I,l.Jj],styles:["content-tabs[_ngcontent-%COMP%]{min-height:73px;display:block}"],changeDetection:0})}}},99014:(e,t,n)=>{"use strict";n.d(t,{q:()=>OpenprojectTabsModule});var i=n(60316),o=n(88955),r=n(78906),s=n(72811),a=n(82724),l=n(74406),c=n(36783),p=n(17136),d=n(68559);class OpenprojectTabsModule{static{this.ɵfac=function OpenprojectTabsModule_Factory(e){return new(e||OpenprojectTabsModule)}}static{this.ɵmod=d.$C({type:OpenprojectTabsModule})}static{this.ɵinj=d.G2t({imports:[i.MD,r.j,p.o,s.f,o.UIRouterModule]})}}("undefined"==typeof ngJitMode||ngJitMode)&&d.Obh(OpenprojectTabsModule,{declarations:[l.f,a.V,c.I],imports:[i.MD,r.j,p.o,s.f,o.UIRouterModule],exports:[l.f]})},74406:(e,t,n)=>{"use strict";n.d(t,{f:()=>ScrollableTabsComponent});var i=n(24398),o=n(68559),r=n(55596),s=n(83093),a=n(71870),l=n(99496),c=n(1758),p=n(60316),d=n(88955),u=n(36783);const h=["scrollContainer"],m=["scrollPane"],g=["scrollRightBtn"],_=["scrollLeftBtn"],f=[[["","slot","actions"]]],b=["[slot=actions]"];function ScrollableTabsComponent_li_5_a_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"a",16),o.bIt("click",(function ScrollableTabsComponent_li_5_a_1_Template_a_click_0_listener(t){o.eBV(e);const n=o.XpG().$implicit,i=o.XpG();return o.Njj(i.clickTab(n,t))})),o.k0s()}if(2&e){const e=o.XpG().$implicit,t=o.XpG();o.AVh("op-tab-row--link_selected",e.id===t.currentTabId)("op-tab-row--link_disabled",void 0!==e.disable),o.Y8G("href",e.path,o.B4B)("textContent",e.name),o.BMQ("aria-selected",e.id===t.currentTabId)("title",t.tabTitle(e))}}function ScrollableTabsComponent_li_5_a_2_ng_container_2_op_tab_count_1_Template(e,t){if(1&e&&o.nrm(0,"op-tab-count",22),2&e){const e=o.XpG().ngIf,t=o.XpG(2).$implicit;o.Y8G("count",e),o.BMQ("data-test-selector","tab-counter-"+t.name)}}function ScrollableTabsComponent_li_5_a_2_ng_container_2_span_2_Template(e,t){if(1&e&&(o.j41(0,"span",23),o.EFF(1),o.k0s()),2&e){const e=o.XpG().ngIf;o.R7$(),o.SpI(" (",e,")")}}function ScrollableTabsComponent_li_5_a_2_ng_container_2_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,ScrollableTabsComponent_li_5_a_2_ng_container_2_op_tab_count_1_Template,1,2,"op-tab-count",20)(2,ScrollableTabsComponent_li_5_a_2_ng_container_2_span_2_Template,2,1,"span",21),o.bVm()),2&e){const e=t.ngIf,n=o.XpG(2).$implicit;o.R7$(),o.Y8G("ngIf",n.showCountAsBubble),o.R7$(),o.Y8G("ngIf",e>0&&!n.showCountAsBubble)}}function ScrollableTabsComponent_li_5_a_2_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"a",17),o.bIt("click",(function ScrollableTabsComponent_li_5_a_2_Template_a_click_0_listener(t){o.eBV(e);const n=o.XpG().$implicit,i=o.XpG();return o.Njj(i.clickTab(n,t))})),o.nrm(1,"span",18),o.DNE(2,ScrollableTabsComponent_li_5_a_2_ng_container_2_Template,3,2,"ng-container",19),o.nI1(3,"async"),o.k0s()}if(2&e){const e=o.XpG().$implicit,t=o.XpG();o.AVh("op-tab-row--link_disabled",void 0!==e.disable),o.Y8G("uiSref",e.route)("uiParams",e.routeParams),o.BMQ("aria-selected",e.id===t.currentTabId)("title",t.tabTitle(e)),o.R7$(),o.Y8G("textContent",e.name),o.R7$(),o.Y8G("ngIf",o.bMT(3,8,t.counter(e)))}}function ScrollableTabsComponent_li_5_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"li",13),o.bIt("dragenter",(function ScrollableTabsComponent_li_5_Template_li_dragenter_0_listener(){const t=o.eBV(e).$implicit,n=o.XpG();return o.Njj(n.startDebouncedTabActivation(t))}))("dragleave",(function ScrollableTabsComponent_li_5_Template_li_dragleave_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.cancelDebouncedTabActivation())})),o.DNE(1,ScrollableTabsComponent_li_5_a_1_Template,1,8,"a",14)(2,ScrollableTabsComponent_li_5_a_2_Template,4,10,"a",15),o.k0s()}if(2&e){const e=t.$implicit,n=o.XpG();o.BMQ("data-tab-id",e.id)("data-qa-tab-id",e.id)("data-qa-tab-selected",e.id===n.currentTabId||void 0)("data-qa-tab-disabled",e.disable||void 0),o.R7$(),o.Y8G("ngIf",!e.route),o.R7$(),o.Y8G("ngIf",e.route)}}class ScrollableTabsComponent extends l.p{constructor(e,t,n){super(),this.$state=e,this.cdRef=t,this.injector=n,this.currentTabId=null,this.tabs=[],this.classes=[],this.hideLeftButton=!0,this.hideRightButton=!0,this.tabSelected=new o.bkB,this.trackById=(0,r.I$)("id"),this.counters={},this.dragTargetStack=0}ngAfterViewInit(){this.container=this.scrollContainer.nativeElement,this.pane=this.scrollPane.nativeElement,this.updateScrollableArea(),this.uiRouterGlobals.params$?.pipe(this.untilDestroyed()).subscribe((e=>{e.tabIdentifier&&(this.currentTabId=e.tabIdentifier)}))}ngOnChanges(e){this.pane&&this.updateScrollableArea()}counter(e){return e.counter?(this.counters[e.id]||(this.counters[e.id]=e.counter(this.injector).pipe((0,a.u)())),this.counters[e.id]):null}updateScrollableArea(){this.determineScrollButtonVisibility(),null!=this.currentTabId&&this.scrollIntoVisibleArea(this.currentTabId)}clickTab(e,t){this.currentTabId=e.id,this.tabSelected.emit(e),e.path||t.preventDefault()}startDebouncedTabActivation(e){this.dragTargetStack+=1,null!==this.debouncedTabActivationTimeout&&this.clearDebouncedTabActivation(),this.debouncedTabActivationTimeout=setTimeout((()=>{this.currentTabId=e.id,this.tabSelected.emit(e);const t=this.$state.includes("**.details.*")?this.$state.$current.name:e.route;t&&this.$state.go(t,e.routeParams),this.debouncedTabActivationTimeout=null}),300)}cancelDebouncedTabActivation(){this.dragTargetStack-=1,0===this.dragTargetStack&&this.clearDebouncedTabActivation()}clearDebouncedTabActivation(){null!==this.debouncedTabActivationTimeout&&(clearTimeout(this.debouncedTabActivationTimeout),this.debouncedTabActivationTimeout=null)}onScroll(){this.determineScrollButtonVisibility()}determineScrollButtonVisibility(){this.hideLeftButton=this.pane.scrollLeft<=0,this.hideRightButton=this.pane.scrollWidth-this.pane.scrollLeft<=this.container.clientWidth,this.cdRef.detectChanges()}scrollRight(){this.pane.scrollLeft+=this.container.clientWidth}scrollLeft(){this.pane.scrollLeft-=this.container.clientWidth}tabTitle(e){return"string"==typeof e.disable?e.disable:e.name}scrollIntoVisibleArea(e){const t=jQuery(this.pane).find(`[data-tab-id=${e}]`),n=t.position().left+Number(t.outerWidth());this.pane.scrollLeft+this.container.clientWidth<n&&(this.pane.scrollLeft=n-this.container.clientWidth+40)}static{this.ɵfac=function ScrollableTabsComponent_Factory(e){return new(e||ScrollableTabsComponent)(o.rXU(s.dw),o.rXU(o.gRc),o.rXU(o.zZn))}}static{this.ɵcmp=o.VBU({type:ScrollableTabsComponent,selectors:[["op-scrollable-tabs"]],viewQuery:function ScrollableTabsComponent_Query(e,t){if(1&e&&(o.GBs(h,7),o.GBs(m,7),o.GBs(g,7),o.GBs(_,7)),2&e){let e;o.mGM(e=o.lsd())&&(t.scrollContainer=e.first),o.mGM(e=o.lsd())&&(t.scrollPane=e.first),o.mGM(e=o.lsd())&&(t.scrollRightBtn=e.first),o.mGM(e=o.lsd())&&(t.scrollLeftBtn=e.first)}},inputs:{currentTabId:"currentTabId",tabs:"tabs",classes:"classes",hideLeftButton:"hideLeftButton",hideRightButton:"hideRightButton"},outputs:{tabSelected:"tabSelected"},features:[o.Vt3,o.OA$],ngContentSelectors:b,decls:14,vars:5,consts:[["scrollContainer",""],["scrollPane",""],["scrollLeftBtn",""],["scrollRightBtn",""],[1,"op-scrollable-tabs",3,"ngClass"],[1,"op-scrollable-tabs--tab-container"],[1,"op-tab-row",3,"scroll"],["class","op-tab-row--tab",3,"dragenter","dragleave",4,"ngFor","ngForOf","ngForTrackBy"],[1,"op-scrollable-tabs--button","op-scrollable-tabs--button_left",3,"click","hidden"],[1,"icon-arrow-left2"],[1,"op-scrollable-tabs--button","op-scrollable-tabs--button_right",3,"click","hidden"],[1,"icon-arrow-right2"],[1,"op-scrollable-tabs--actions"],[1,"op-tab-row--tab",3,"dragenter","dragleave"],["class","op-tab-row--link","role","tab",3,"href","op-tab-row--link_selected","op-tab-row--link_disabled","textContent","click",4,"ngIf"],["role","tab","class","op-tab-row--link","uiSrefActive","op-tab-row--link_selected","href","",3,"uiSref","uiParams","op-tab-row--link_disabled","click",4,"ngIf"],["role","tab",1,"op-tab-row--link",3,"click","href","textContent"],["role","tab","uiSrefActive","op-tab-row--link_selected","href","",1,"op-tab-row--link",3,"click","uiSref","uiParams"],[3,"textContent"],[4,"ngIf"],[3,"count",4,"ngIf"],["data-test-selector","tab-count",4,"ngIf"],[3,"count"],["data-test-selector","tab-count"]],template:function ScrollableTabsComponent_Template(e,t){if(1&e){const e=o.RV6();o.NAR(f),o.j41(0,"div",4)(1,"div",5,0)(3,"ul",6,1),o.bIt("scroll",(function ScrollableTabsComponent_Template_ul_scroll_3_listener(){return o.eBV(e),o.Njj(t.onScroll())})),o.DNE(5,ScrollableTabsComponent_li_5_Template,3,6,"li",7),o.k0s(),o.j41(6,"div",8,2),o.bIt("click",(function ScrollableTabsComponent_Template_div_click_6_listener(){return o.eBV(e),o.Njj(t.scrollLeft())})),o.nrm(8,"span",9),o.k0s(),o.j41(9,"div",10,3),o.bIt("click",(function ScrollableTabsComponent_Template_div_click_9_listener(){return o.eBV(e),o.Njj(t.scrollRight())})),o.nrm(11,"span",11),o.k0s()(),o.j41(12,"ul",12),o.SdG(13),o.k0s()()}2&e&&(o.Y8G("ngClass",t.classes),o.R7$(5),o.Y8G("ngForOf",t.tabs)("ngForTrackBy",t.trackById),o.R7$(),o.Y8G("hidden",t.hideLeftButton),o.R7$(3),o.Y8G("hidden",t.hideRightButton))},dependencies:[p.YU,p.Sq,p.bT,d.UISref,d.AnchorUISref,d.UISrefActive,d.UISrefStatus,u.I,p.Jj],styles:[".op-tab-row--link[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{pointer-events:none}"],changeDetection:0})}}(0,i.Cg)([(0,c.O)(),(0,i.Sn)("design:type",s.ok)],ScrollableTabsComponent.prototype,"uiRouterGlobals",void 0)},36783:(e,t,n)=>{"use strict";n.d(t,{I:()=>TabCountComponent});var i=n(68559),o=n(60316);function TabCountComponent_ng_container_0_span_1_Template(e,t){if(1&e&&i.nrm(0,"span",2),2&e){const e=i.XpG(2);i.Y8G("textContent",e.count)}}function TabCountComponent_ng_container_0_Template(e,t){if(1&e&&(i.qex(0),i.DNE(1,TabCountComponent_ng_container_0_span_1_Template,1,1,"span",1),i.bVm()),2&e){const e=i.XpG();i.R7$(),i.Y8G("ngIf",e.count>0)}}class TabCountComponent{static{this.ɵfac=function TabCountComponent_Factory(e){return new(e||TabCountComponent)}}static{this.ɵcmp=i.VBU({type:TabCountComponent,selectors:[["op-tab-count"]],inputs:{count:"count"},decls:1,vars:1,consts:[[4,"ngIf"],["class","op-tab-count",3,"textContent",4,"ngIf"],[1,"op-tab-count",3,"textContent"]],template:function TabCountComponent_Template(e,t){1&e&&i.DNE(0,TabCountComponent_ng_container_0_Template,2,1,"ng-container",0),2&e&&i.Y8G("ngIf",t.count)},dependencies:[o.bT],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-tab-count[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;align-items:center;box-sizing:content-box;height:16px;line-height:16px;width:16px;border-radius:.5rem;padding:0 .15rem;font-size:.7rem;font-weight:var(--base-text-weight-bold);background:var(--bgColor-accent-emphasis);color:#fff;flex-shrink:0;margin-left:5px;vertical-align:text-bottom}"],changeDetection:0})}}},16452:(e,t,n)=>{"use strict";n.d(t,{U:()=>TimeEntryCreateModalComponent,k:()=>l});var i=n(68559),o=n(51339),r=n(96124),s=n(60316),a=n(43406);function TimeEntryCreateModalComponent_button_10_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",14),i.bIt("click",(function TimeEntryCreateModalComponent_button_10_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.destroy())})),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("textContent",e.text.delete),i.BMQ("title",e.text.delete)}}function TimeEntryCreateModalComponent_button_12_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",15),i.bIt("click",(function TimeEntryCreateModalComponent_button_12_Template_button_click_0_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.closeMe(t))})),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("textContent",e.text.cancel),i.BMQ("title",e.text.cancel)}}function TimeEntryCreateModalComponent_button_13_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",16),i.bIt("click",(function TimeEntryCreateModalComponent_button_13_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.saveEntry())})),i.k0s()}if(2&e){const e=i.XpG();i.Y8G("textContent",e.text.save)("disabled",e.formInFlight),i.BMQ("title",e.text.save)}}const l=new i.nKC("SHOW_USER_HOVER_CARD");class TimeEntryCreateModalComponent extends r.w{get deleteAllowed(){return!1}setModifiedEntry(e){this.createdEntry=e.savedResource,this.reloadWorkPackageAndClose()}static{this.ɵfac=(()=>{let e;return function TimeEntryCreateModalComponent_Factory(t){return(e||(e=i.xGo(TimeEntryCreateModalComponent)))(t||TimeEntryCreateModalComponent)}})()}static{this.ɵcmp=i.VBU({type:TimeEntryCreateModalComponent,selectors:[["ng-component"]],features:[i.Jv_([o.p,{provide:l,useValue:!1}]),i.Vt3],decls:14,vars:7,consts:[["editForm",""],["data-indicator-name","modal",1,"spot-modal","spot-modal_allow-overflow","loading-indicator--location"],[1,"spot-modal--header"],[1,"spot-icon","spot-icon_time"],["id","spotModalTitle",3,"textContent"],[1,"spot-divider"],[1,"spot-modal--body","spot-container"],[3,"modifiedEntry","changeset","showWorkPackageField","showUserField"],[1,"spot-action-bar"],[1,"spot-action-bar--left"],["class","button button_no-margin -danger spot-action-bar--action",3,"textContent","click",4,"ngIf"],[1,"spot-action-bar--right"],["class","button button_no-margin spot-modal--cancel-button spot-action-bar--action",3,"textContent","click",4,"ngIf"],["class","button -primary button_no-margin spot-action-bar--action",3,"textContent","disabled","click",4,"ngIf"],[1,"button","button_no-margin","-danger","spot-action-bar--action",3,"click","textContent"],[1,"button","button_no-margin","spot-modal--cancel-button","spot-action-bar--action",3,"click","textContent"],[1,"button","-primary","button_no-margin","spot-action-bar--action",3,"click","textContent","disabled"]],template:function TimeEntryCreateModalComponent_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",1)(1,"div",2),i.nrm(2,"span",3)(3,"span",4),i.k0s(),i.nrm(4,"div",5),i.j41(5,"div",6)(6,"te-form",7,0),i.bIt("modifiedEntry",(function TimeEntryCreateModalComponent_Template_te_form_modifiedEntry_6_listener(n){return i.eBV(e),i.Njj(t.setModifiedEntry(n))})),i.k0s()(),i.j41(8,"div",8)(9,"div",9),i.DNE(10,TimeEntryCreateModalComponent_button_10_Template,1,2,"button",10),i.k0s(),i.j41(11,"div",11),i.DNE(12,TimeEntryCreateModalComponent_button_12_Template,1,2,"button",12)(13,TimeEntryCreateModalComponent_button_13_Template,1,3,"button",13),i.k0s()()()}2&e&&(i.R7$(3),i.Y8G("textContent",t.text.title),i.R7$(3),i.Y8G("changeset",t.changeset)("showWorkPackageField",t.showWorkPackageField)("showUserField",t.showUserField),i.R7$(4),i.Y8G("ngIf",t.deleteAllowed),i.R7$(2),i.Y8G("ngIf",t.saveAllowed),i.R7$(),i.Y8G("ngIf",t.saveAllowed))},dependencies:[s.bT,a.t],encapsulation:2,changeDetection:0})}}},85254:(e,t,n)=>{"use strict";n.d(t,{h:()=>TimeEntryCreateService});var i=n(51133),o=n(36178),r=n(61816),s=n(64334),a=n(70271),l=n(51339),c=n(16452),p=n(14593),d=n(44674),u=n(68559);class TimeEntryCreateService{constructor(e,t,n,i,o,r,s){this.opModalService=e,this.injector=t,this.halResource=n,this.apiV3Service=i,this.schemaCache=o,this.halEditing=r,this.i18n=s}create(e,t,n={}){return new Promise(((i,o)=>{this.createNewTimeEntry(e,t).subscribe((e=>{this.opModalService.show(c.U,this.injector,{...n,changeset:e}).subscribe((e=>{e.closingEvent.pipe((0,s.s)(1)).subscribe((()=>{e.createdEntry?i({entry:e.createdEntry,action:"create"}):o()}))}))}))}))}createNewTimeEntry(e,t,n=!1){const i={spentOn:e.format("YYYY-MM-DD"),ongoing:n};return t&&(i._links={workPackage:{href:t.href}}),this.apiV3Service.time_entries.form.post(i).pipe((0,a.T)((e=>this.fromCreateForm(e))))}fromCreateForm(e){const t=this.initializeNewResource(e);return this.halEditing.edit(t,e)}initializeNewResource(e){const t=this.halResource.createHalResourceOfType("TimeEntry",e.payload.$plain());return t.$links.schema={href:"new"},t._type="TimeEntry",t.id="new",t.hours="PT1H",t.update=t.$links.update=e.$links.self,t.updateImmediately=t.$links.updateImmediately=e=>this.apiV3Service.time_entries.post(e).toPromise(),t.state.putValue(t),this.schemaCache.update(t,e.schema),t}static{this.ɵfac=function TimeEntryCreateService_Factory(e){return new(e||TimeEntryCreateService)(u.KVO(i.a),u.KVO(u.zZn),u.KVO(o.t),u.KVO(p.n),u.KVO(d.D),u.KVO(l.p),u.KVO(r.W))}}static{this.ɵprov=u.jDH({token:TimeEntryCreateService,factory:TimeEntryCreateService.ɵfac})}}},56800:(e,t,n)=>{"use strict";n.d(t,{a:()=>TimeEntryEditModalComponent});var i=n(96124),o=n(68559),r=n(60316),s=n(43406);function TimeEntryEditModalComponent_button_10_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"button",14),o.bIt("click",(function TimeEntryEditModalComponent_button_10_Template_button_click_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.destroy())})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("textContent",e.text.delete),o.BMQ("title",e.text.delete)}}function TimeEntryEditModalComponent_button_12_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"button",15),o.bIt("click",(function TimeEntryEditModalComponent_button_12_Template_button_click_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.closeMe(t))})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("textContent",e.text.cancel),o.BMQ("title",e.text.cancel)}}function TimeEntryEditModalComponent_button_13_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"button",16),o.bIt("click",(function TimeEntryEditModalComponent_button_13_Template_button_click_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.saveEntry())})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("textContent",e.text.save)("disabled",e.formInFlight),o.BMQ("title",e.text.save)}}class TimeEntryEditModalComponent extends i.w{ngOnInit(){super.ngOnInit()}setModifiedEntry(e){this.modifiedEntry=e.savedResource,this.reloadWorkPackageAndClose()}get saveAllowed(){return!!this.entry.update}get deleteAllowed(){return!!this.entry.delete}destroy(){window.confirm(this.text.areYouSure)&&(this.destroyedEntry=this.entry,this.service.close())}static{this.ɵfac=(()=>{let e;return function TimeEntryEditModalComponent_Factory(t){return(e||(e=o.xGo(TimeEntryEditModalComponent)))(t||TimeEntryEditModalComponent)}})()}static{this.ɵcmp=o.VBU({type:TimeEntryEditModalComponent,selectors:[["ng-component"]],features:[o.Vt3],decls:14,vars:7,consts:[["editForm",""],["data-indicator-name","modal",1,"spot-modal","spot-modal_allow-overflow","loading-indicator--location"],[1,"spot-modal--header"],[1,"spot-icon","spot-icon_time"],["id","spotModalTitle",3,"textContent"],[1,"spot-divider"],[1,"spot-modal--body","spot-container"],[3,"modifiedEntry","changeset","showWorkPackageField","showUserField"],[1,"spot-action-bar"],[1,"spot-action-bar--left"],["class","button button_no-margin -danger spot-action-bar--action",3,"textContent","click",4,"ngIf"],[1,"spot-action-bar--right"],["class","button button_no-margin spot-modal--cancel-button spot-action-bar--action",3,"textContent","click",4,"ngIf"],["class","button -primary button_no-margin spot-action-bar--action",3,"textContent","disabled","click",4,"ngIf"],[1,"button","button_no-margin","-danger","spot-action-bar--action",3,"click","textContent"],[1,"button","button_no-margin","spot-modal--cancel-button","spot-action-bar--action",3,"click","textContent"],[1,"button","-primary","button_no-margin","spot-action-bar--action",3,"click","textContent","disabled"]],template:function TimeEntryEditModalComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",1)(1,"div",2),o.nrm(2,"span",3)(3,"span",4),o.k0s(),o.nrm(4,"div",5),o.j41(5,"div",6)(6,"te-form",7,0),o.bIt("modifiedEntry",(function TimeEntryEditModalComponent_Template_te_form_modifiedEntry_6_listener(n){return o.eBV(e),o.Njj(t.setModifiedEntry(n))})),o.k0s()(),o.j41(8,"div",8)(9,"div",9),o.DNE(10,TimeEntryEditModalComponent_button_10_Template,1,2,"button",10),o.k0s(),o.j41(11,"div",11),o.DNE(12,TimeEntryEditModalComponent_button_12_Template,1,2,"button",12)(13,TimeEntryEditModalComponent_button_13_Template,1,3,"button",13),o.k0s()()()}2&e&&(o.R7$(3),o.Y8G("textContent",t.text.title),o.R7$(3),o.Y8G("changeset",t.changeset)("showWorkPackageField",t.showWorkPackageField)("showUserField",t.showUserField),o.R7$(4),o.Y8G("ngIf",t.deleteAllowed),o.R7$(2),o.Y8G("ngIf",t.saveAllowed),o.R7$(),o.Y8G("ngIf",t.saveAllowed))},dependencies:[r.bT,s.t],encapsulation:2,changeDetection:0})}}},22842:(e,t,n)=>{"use strict";n.d(t,{r:()=>TimeEntryEditService});var i=n(89204),o=n(51133),r=n(36178),s=n(61816),a=n(64334),l=n(51339),c=n(14593),p=n(56800),d=n(39545),u=n(44674),h=n(32420),m=n(95122),g=n(68559);class TimeEntryEditService{constructor(e,t,n,i,o,r,s,a,l){this.opModalService=e,this.injector=t,this.apiV3Service=n,this.halResource=i,this.schemaCache=o,this.timezoneService=r,this.timeEntryService=s,this.halEditing=a,this.i18n=l}edit(e,t={}){return this.createChangeset(e).then((e=>this.editChange(e,t)))}editChange(e,t={}){return new Promise(((n,i)=>{this.opModalService.show(p.a,this.injector,{...t,changeset:e}).subscribe((e=>{e.closingEvent.pipe((0,a.s)(1)).subscribe((()=>{e.destroyedEntry?e.destroyedEntry.delete().then((()=>{n({entry:e.destroyedEntry,action:"destroy"})})):e.modifiedEntry?n({entry:e.modifiedEntry,action:"update"}):n({entry:e.entry,action:"unchanged"})}))}))}))}stopTimerAndEdit(e){var t=this;return(0,i.A)((function*(){yield t.schemaCache.ensureLoaded(e);const n=t.halEditing.edit(e),i=d().diff(d(e.createdAt),"hours",!0),o=t.timezoneService.toISODuration(i,"hours");return n.setValue("hours",o),n.setValue("ongoing",!1),t.editChange(n).then((e=>{"unchanged"!==e.action&&t.timeEntryService.timer$.next(null)}))}))()}createChangeset(e){return this.apiV3Service.time_entries.id(e).form.post(e).toPromise().then((t=>this.halEditing.edit(e,t)))}static{this.ɵfac=function TimeEntryEditService_Factory(e){return new(e||TimeEntryEditService)(g.KVO(o.a),g.KVO(g.zZn),g.KVO(c.n),g.KVO(r.t),g.KVO(u.D),g.KVO(h.D),g.KVO(m.O),g.KVO(l.p),g.KVO(s.W))}}static{this.ɵprov=g.jDH({token:TimeEntryEditService,factory:TimeEntryEditService.ɵfac})}}},26533:(e,t,n)=>{"use strict";n.d(t,{z:()=>TriggerActionsEntryComponent});var i=n(24398),o=n(68559),r=n(1758),s=n(22842),a=n(61816),l=n(72650),c=n(51339),p=n(14593),d=n(36647),u=n(46765);class TriggerActionsEntryComponent{constructor(e){this.injector=e,this.text={edit:this.i18n.t("js.button_edit"),delete:this.i18n.t("js.button_delete"),error:this.i18n.t("js.error.internal"),areYouSure:this.i18n.t("js.text_are_you_sure")}}editTimeEntry(){this.loadEntry().subscribe((e=>{this.timeEntryEditService.edit(e).then((()=>{window.location.reload()})).catch((()=>{}))}))}deleteTimeEntry(){window.confirm(this.text.areYouSure)&&this.loadEntry().pipe((0,d.n)((e=>this.apiv3Service.time_entries.id(e).delete()))).subscribe((()=>window.location.reload()),(e=>this.toastService.addError(e||this.text.error)))}loadEntry(){const e=this.elementRef.nativeElement.dataset.entry;return this.apiv3Service.time_entries.id(e).get()}static{this.ɵfac=function TriggerActionsEntryComponent_Factory(e){return new(e||TriggerActionsEntryComponent)(o.rXU(o.zZn))}}static{this.ɵcmp=o.VBU({type:TriggerActionsEntryComponent,selectors:[["opce-time-entry-trigger-actions"]],features:[o.Jv_([c.p,s.r])],decls:4,vars:2,consts:[[1,"no-decoration-on-hover",3,"click","title"],["icon-classes","icon-context icon-edit"],["icon-classes","icon-context icon-delete"]],template:function TriggerActionsEntryComponent_Template(e,t){1&e&&(o.j41(0,"a",0),o.bIt("click",(function TriggerActionsEntryComponent_Template_a_click_0_listener(){return t.editTimeEntry()})),o.nrm(1,"op-icon",1),o.k0s(),o.j41(2,"a",0),o.bIt("click",(function TriggerActionsEntryComponent_Template_a_click_2_listener(){return t.deleteTimeEntry()})),o.nrm(3,"op-icon",2),o.k0s()),2&e&&(o.Y8G("title",t.text.edit),o.R7$(2),o.Y8G("title",t.text.delete))},dependencies:[u.i],encapsulation:2,changeDetection:0})}}(0,i.Cg)([(0,r.O)(),(0,i.Sn)("design:type",s.r)],TriggerActionsEntryComponent.prototype,"timeEntryEditService",void 0),(0,i.Cg)([(0,r.O)(),(0,i.Sn)("design:type",p.n)],TriggerActionsEntryComponent.prototype,"apiv3Service",void 0),(0,i.Cg)([(0,r.O)(),(0,i.Sn)("design:type",l.fw)],TriggerActionsEntryComponent.prototype,"toastService",void 0),(0,i.Cg)([(0,r.O)(),(0,i.Sn)("design:type",o.aKT)],TriggerActionsEntryComponent.prototype,"elementRef",void 0),(0,i.Cg)([(0,r.O)(),(0,i.Sn)("design:type",a.W)],TriggerActionsEntryComponent.prototype,"i18n",void 0),(0,i.Cg)([(0,r.O)(),(0,i.Sn)("design:type",o.gRc)],TriggerActionsEntryComponent.prototype,"cdRef",void 0)},43406:(e,t,n)=>{"use strict";n.d(t,{t:()=>TimeEntryFormComponent});var i=n(51339),o=n(61816),r=n(68559),s=n(34539),a=n(99496),l=(n(38429),n(60316)),c=n(8958);const p=["editForm"],_c1=e=>({"-required":e});function TimeEntryFormComponent_ng_container_3_Template(e,t){if(1&e&&(r.qex(0),r.nrm(1,"div",4),r.j41(2,"div",7),r.nrm(3,"op-editable-attribute-field",6),r.k0s(),r.bVm()),2&e){const e=r.XpG();r.R7$(),r.Y8G("ngClass",r.eq3(5,_c1,e.isRequired("user")))("textContent",e.schema.user.name),r.R7$(2),r.Y8G("resource",e.entry)("wrapperClasses","-tiny")("fieldName","user")}}function TimeEntryFormComponent_ng_container_10_Template(e,t){if(1&e&&(r.qex(0),r.nrm(1,"div",4),r.j41(2,"div",7),r.nrm(3,"op-editable-attribute-field",10),r.k0s(),r.bVm()),2&e){const e=r.XpG();r.R7$(),r.Y8G("ngClass",r.eq3(4,_c1,e.isRequired("workPackage")))("textContent",e.schema.workPackage.name),r.R7$(2),r.Y8G("resource",e.entry)("fieldName","workPackage")}}function TimeEntryFormComponent_op_editable_attribute_field_13_Template(e,t){if(1&e&&r.nrm(0,"op-editable-attribute-field",10),2&e){const e=r.XpG();r.Y8G("resource",e.entry)("fieldName","activity")}}function TimeEntryFormComponent_i_14_Template(e,t){if(1&e&&r.nrm(0,"i",12),2&e){const e=r.XpG();r.Y8G("textContent",e.text.wpRequired)}}function TimeEntryFormComponent_ng_container_18_Template(e,t){if(1&e&&(r.qex(0),r.nrm(1,"div",4),r.j41(2,"div",7),r.nrm(3,"op-editable-attribute-field",13),r.k0s(),r.bVm()),2&e){const e=t.$implicit,n=r.XpG();r.R7$(),r.Y8G("ngClass",r.eq3(5,_c1,n.isRequired(e.key)))("textContent",e.label),r.R7$(2),r.Y8G("resource",n.entry)("fieldName",e.key)("wrapperClasses","Date"===e.type?"-tiny":null)}}class TimeEntryFormComponent extends a.p{constructor(e,t,n){super(),this.halEditing=e,this.cdRef=t,this.i18n=n,this.showWorkPackageField=!0,this.showUserField=!0,this.modifiedEntry=new r.bkB,this.text={wpRequired:this.i18n.t("js.time_entry.work_package_required")},this.workPackageSelected=!1,this.customFields=[]}ngOnInit(){this.halEditing.temporaryEditResource(this.changeset.projectedResource).values$().pipe(this.untilDestroyed()).subscribe((e=>{e&&e.workPackage&&(this.workPackageSelected=!0,this.cdRef.markForCheck())})),this.schema=this.changeset.schema,this.workPackageSelected=!!this.changeset?.value("workPackage"),this.setCustomFields(),this.cdRef.detectChanges()}get entry(){return this.changeset.projectedResource}signalModifiedEntry(e){this.modifiedEntry.emit(e)}save(){return this.editForm.submit()}get inEditMode(){return!0}isRequired(e){return"workPackage"===e||this.schema.ofProperty(e).required}setCustomFields(){Object.entries(this.schema).forEach((([e,t])=>{/customField\d+/.exec(e)&&this.isACustomField(t)&&this.customFields.push({key:e,label:t.name||"",type:t.type})}))}isACustomField(e){return!!e.type}static{this.ɵfac=function TimeEntryFormComponent_Factory(e){return new(e||TimeEntryFormComponent)(r.rXU(i.p),r.rXU(r.gRc),r.rXU(o.W))}}static{this.ɵcmp=r.VBU({type:TimeEntryFormComponent,selectors:[["te-form"]],viewQuery:function TimeEntryFormComponent_Query(e,t){if(1&e&&r.GBs(p,7),2&e){let e;r.mGM(e=r.lsd())&&(t.editForm=e.first)}},inputs:{changeset:"changeset",showWorkPackageField:"showWorkPackageField",showUserField:"showUserField"},outputs:{modifiedEntry:"modifiedEntry"},features:[r.Vt3],decls:19,vars:31,consts:[["editForm",""],[3,"onSaved","resource","inEditMode"],[1,"attributes-map"],[4,"ngIf"],[1,"attributes-map--key",3,"ngClass","textContent"],[1,"attributes-map--value","attributes-map--value_overflow"],[3,"resource","wrapperClasses","fieldName"],[1,"attributes-map--value"],[3,"resource","fieldName",4,"ngIf"],[3,"textContent",4,"ngIf"],[3,"resource","fieldName"],[4,"ngFor","ngForOf"],[3,"textContent"],[3,"resource","fieldName","wrapperClasses"]],template:function TimeEntryFormComponent_Template(e,t){if(1&e){const e=r.RV6();r.j41(0,"edit-form",1,0),r.bIt("onSaved",(function TimeEntryFormComponent_Template_edit_form_onSaved_0_listener(n){return r.eBV(e),r.Njj(t.signalModifiedEntry(n))})),r.j41(2,"div",2),r.DNE(3,TimeEntryFormComponent_ng_container_3_Template,4,7,"ng-container",3),r.nrm(4,"div",4),r.j41(5,"div",5),r.nrm(6,"op-editable-attribute-field",6),r.k0s(),r.nrm(7,"div",4),r.j41(8,"div",7),r.nrm(9,"op-editable-attribute-field",6),r.k0s(),r.DNE(10,TimeEntryFormComponent_ng_container_10_Template,4,6,"ng-container",3),r.nrm(11,"div",4),r.j41(12,"div",7),r.DNE(13,TimeEntryFormComponent_op_editable_attribute_field_13_Template,1,2,"op-editable-attribute-field",8)(14,TimeEntryFormComponent_i_14_Template,1,1,"i",9),r.k0s(),r.nrm(15,"div",4),r.j41(16,"div",7),r.nrm(17,"op-editable-attribute-field",10),r.k0s(),r.DNE(18,TimeEntryFormComponent_ng_container_18_Template,4,7,"ng-container",11),r.k0s()()}2&e&&(r.Y8G("resource",t.entry)("inEditMode",t.inEditMode),r.R7$(3),r.Y8G("ngIf",t.showUserField&&t.schema.user.writable),r.R7$(),r.Y8G("ngClass",r.eq3(23,_c1,t.isRequired("spentOn")))("textContent",t.schema.spentOn.name),r.R7$(2),r.Y8G("resource",t.entry)("wrapperClasses","-tiny")("fieldName","spentOn"),r.R7$(),r.Y8G("ngClass",r.eq3(25,_c1,t.isRequired("hours")))("textContent",t.schema.hours.name),r.R7$(2),r.Y8G("resource",t.entry)("wrapperClasses","-tiny")("fieldName","hours"),r.R7$(),r.Y8G("ngIf",t.showWorkPackageField),r.R7$(),r.Y8G("ngClass",r.eq3(27,_c1,t.isRequired("activity")))("textContent",t.schema.activity.name),r.R7$(2),r.Y8G("ngIf",t.workPackageSelected),r.R7$(),r.Y8G("ngIf",!t.workPackageSelected),r.R7$(),r.Y8G("ngClass",r.eq3(29,_c1,t.isRequired("comment")))("textContent",t.schema.comment.name),r.R7$(2),r.Y8G("resource",t.entry)("fieldName","comment"),r.R7$(),r.Y8G("ngForOf",t.customFields))},dependencies:[l.YU,l.Sq,l.bT,s.G,c.c],encapsulation:2,changeDetection:0})}}},91812:(e,t,n)=>{"use strict";n.d(t,{d:()=>OpenprojectTimeEntriesModule});var i=n(34802),o=n(21452),r=n(74785),s=n(16452),a=n(56800),l=n(43406),c=n(26533),p=n(95122),d=n(60316),u=n(99286),h=n(24935),m=n(68559);class OpenprojectTimeEntriesModule{static{this.ɵfac=function OpenprojectTimeEntriesModule_Factory(e){return new(e||OpenprojectTimeEntriesModule)}}static{this.ɵmod=m.$C({type:OpenprojectTimeEntriesModule})}static{this.ɵinj=m.G2t({providers:[p.O],imports:[d.MD,i.d,o.p,r.X]})}}("undefined"==typeof ngJitMode||ngJitMode)&&m.Obh(OpenprojectTimeEntriesModule,{declarations:[a.a,s.U,l.t,c.z,u.R,h.D],imports:[d.MD,i.d,o.p,r.X]})},95122:(e,t,n)=>{"use strict";n.d(t,{O:()=>TimeEntryTimerService});var i=n(51567),o=n(70271),r=n(98764),s=n(14593),a=n(89282),l=n(75797),c=n(68559);class TimeEntryTimerService{constructor(e,t){this.injector=e,this.apiV3Service=t,this.timer$=new l.t(void 0),this.activeTimer$=this.timer$.asObservable().pipe((0,i.p)((e=>void 0!==e))),setTimeout((()=>this.refresh().subscribe()),100),this.activeTimer$.subscribe((e=>{this.removeTimer(),e&&this.renderTimer()}))}refresh(){const e=new a.hG;return e.add("ongoing","=",!0),this.apiV3Service.time_entries.filtered(e).get().pipe((0,o.T)((e=>e.elements.pop()||null)),(0,r.M)((e=>this.timer$.next(e))))}renderTimer(){const e=document.createElement("span"),t=document.createElement("span");e.classList.add("op-principal--timer"),t.classList.add("spot-icon","spot-icon_time","spot-icon_1_25"),e.appendChild(t);const n=document.querySelector(".op-top-menu-user-avatar");n?.appendChild(e)}removeTimer(){const e=document.querySelector(".op-principal--timer");e?.remove()}static{this.ɵfac=function TimeEntryTimerService_Factory(e){return new(e||TimeEntryTimerService)(c.KVO(c.zZn),c.KVO(s.n))}}static{this.ɵprov=c.jDH({token:TimeEntryTimerService,factory:TimeEntryTimerService.ɵfac})}}},96124:(e,t,n)=>{"use strict";n.d(t,{w:()=>TimeEntryBaseModal});var i=n(24398),o=n(69081),r=n(51133),s=n(61816),a=(n(43406),n(1758)),l=n(14593),c=n(68559);const p=["editForm"];class TimeEntryBaseModal extends o.a{constructor(e,t,n,i,o){super(t,n,e),this.elementRef=e,this.locals=t,this.cdRef=n,this.i18n=i,this.injector=o,this.text={title:this.i18n.t("js.time_entry.title"),cancel:this.i18n.t("js.button_cancel"),close:this.i18n.t("js.button_close"),save:this.i18n.t("js.button_save"),delete:this.i18n.t("js.button_delete"),areYouSure:this.i18n.t("js.text_are_you_sure")}}ngOnInit(){super.ngOnInit(),this.changeset=this.locals.changeset}get entry(){return this.changeset.projectedResource}get showWorkPackageField(){return!1!==this.locals.showWorkPackageField}get showUserField(){return!1!==this.locals.showUserField}saveEntry(){this.formInFlight=!0,this.editForm.save().then((()=>this.reloadWorkPackageAndClose())).catch((()=>{this.formInFlight=!1,this.cdRef.detectChanges()}))}get saveAllowed(){return!0}get deleteAllowed(){return!0}reloadWorkPackageAndClose(){this.service.close(),this.formInFlight=!1,this.entry.workPackage&&this.apiV3Service.work_packages.id(this.entry.workPackage).refresh(),this.cdRef.detectChanges()}static{this.ɵfac=function TimeEntryBaseModal_Factory(e){return new(e||TimeEntryBaseModal)(c.rXU(c.aKT),c.rXU(r.Y),c.rXU(c.gRc),c.rXU(s.W),c.rXU(c.zZn))}}static{this.ɵdir=c.FsC({type:TimeEntryBaseModal,viewQuery:function TimeEntryBaseModal_Query(e,t){if(1&e&&c.GBs(p,7),2&e){let e;c.mGM(e=c.lsd())&&(t.editForm=e.first)}},features:[c.Vt3]})}}(0,i.Cg)([(0,a.O)(),(0,i.Sn)("design:type",l.n)],TimeEntryBaseModal.prototype,"apiV3Service",void 0)},24935:(e,t,n)=>{"use strict";n.d(t,{D:()=>StopExistingTimerModalComponent});var i=n(69081),o=n(51133),r=n(14876),s=n(70271),a=n(51567),l=n(25070),c=n(61816),p=n(83093),d=n(68559),u=n(88955),h=n(60316);const _c0=e=>({workPackageId:e});class StopExistingTimerModalComponent extends i.a{constructor(e,t,n,i,o){super(t,n,e),this.elementRef=e,this.locals=t,this.cdRef=n,this.state=i,this.I18n=o,this.className=!0,this.confirmed=!1,this.elapsed$=(0,r.O)(0,1e3).pipe((0,s.T)((()=>this.active)),(0,a.p)((e=>null!==e)),(0,s.T)((e=>(0,l.R)(e.createdAt)))),this.text={title:this.I18n.t("js.timer.start_new_timer"),button_cancel:this.I18n.t("js.button_cancel"),button_stop:this.I18n.t("js.timer.button_stop"),timer_already_running:this.I18n.t("js.timer.timer_already_running"),tracking_time:this.I18n.t("js.timer.tracking_time")}}ngOnInit(){super.ngOnInit(),this.active=this.locals.timer}saveAndClose(){this.confirmed=!0,this.closeMe()}static{this.ɵfac=function StopExistingTimerModalComponent_Factory(e){return new(e||StopExistingTimerModalComponent)(d.rXU(d.aKT),d.rXU(o.Y),d.rXU(d.gRc),d.rXU(p.dw),d.rXU(c.W))}}static{this.ɵcmp=d.VBU({type:StopExistingTimerModalComponent,selectors:[["ng-component"]],hostVars:2,hostBindings:function StopExistingTimerModalComponent_HostBindings(e,t){2&e&&d.AVh("op-timer-stop-modal",t.className)},features:[d.Vt3],decls:18,vars:13,consts:[["data-test-selector","op-stop-existing-timer-modal",1,"spot-modal"],[1,"spot-modal--header"],["id","spotModalTitle",1,"spot-modal--header-title"],[1,"spot-modal--subheader",3,"textContent"],[1,"spot-divider"],[1,"spot-modal--body","spot-container","spot-body-small"],["uiSref","work-packages.show",3,"click","uiParams"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button",1,"button","spot-modal--cancel-button","spot-action-bar--action",3,"click","textContent"],["type","button","data-test-selector","op-files-picker-modal--confirm",1,"button","-primary","spot-action-bar--action",3,"click","textContent"]],template:function StopExistingTimerModalComponent_Template(e,t){1&e&&(d.j41(0,"div",0)(1,"div",1)(2,"span",2),d.EFF(3),d.k0s()(),d.nrm(4,"p",3)(5,"div",4),d.j41(6,"div",5)(7,"p")(8,"strong"),d.EFF(9),d.nI1(10,"async"),d.k0s(),d.nrm(11,"br"),d.j41(12,"a",6),d.bIt("click",(function StopExistingTimerModalComponent_Template_a_click_12_listener(){return t.closeMe()})),d.EFF(13),d.k0s()()(),d.j41(14,"div",7)(15,"div",8)(16,"button",9),d.bIt("click",(function StopExistingTimerModalComponent_Template_button_click_16_listener(){return t.closeMe()})),d.k0s(),d.j41(17,"button",10),d.bIt("click",(function StopExistingTimerModalComponent_Template_button_click_17_listener(){return t.saveAndClose()})),d.k0s()()()()),2&e&&(d.R7$(3),d.JRh(t.text.title),d.R7$(),d.Y8G("textContent",t.text.timer_already_running),d.R7$(5),d.Lme("",t.text.tracking_time,": ",d.bMT(10,9,t.elapsed$),""),d.R7$(3),d.Y8G("uiParams",d.eq3(11,_c0,t.active.workPackage.id)),d.R7$(),d.Lme(" #",t.active.workPackage.id,": ",t.active.workPackage.name," "),d.R7$(3),d.Y8G("textContent",t.text.button_cancel),d.R7$(),d.Y8G("textContent",t.text.button_stop))},dependencies:[u.UISref,u.AnchorUISref,h.Jj],encapsulation:2,changeDetection:0})}}},99286:(e,t,n)=>{"use strict";n.d(t,{R:()=>TimerAccountMenuComponent});var i=n(89204),o=n(95122),r=n(99496),s=n(14876),a=n(36647),l=n(56196),c=n(51567),p=n(70271),d=n(25070),u=n(61816),h=n(22842),m=n(51339),g=n(44674),_=n(32420),f=n(72650),b=n(68559),k=n(60316),v=n(88955);const _c0=e=>({workPackageId:e});function TimerAccountMenuComponent_ng_container_0_Template(e,t){if(1&e){const e=b.RV6();b.qex(0),b.j41(1,"span",1),b.EFF(2),b.nI1(3,"async"),b.j41(4,"a",2),b.bIt("click",(function TimerAccountMenuComponent_ng_container_0_Template_a_click_4_listener(){b.eBV(e);const t=b.XpG();return b.Njj(t.stopTimer())})),b.nrm(5,"span",3),b.EFF(6),b.k0s()(),b.j41(7,"a",4),b.EFF(8),b.k0s(),b.nrm(9,"div",5),b.bVm()}if(2&e){const e=t.ngIf,n=b.XpG();b.R7$(2),b.Lme(" ",n.text.tracking,": ",b.bMT(3,6,n.elapsed$)," "),b.R7$(4),b.SpI(" ",n.text.stop," "),b.R7$(),b.Y8G("uiParams",b.eq3(8,_c0,e.workPackage.id)),b.R7$(),b.Lme(" #",e.workPackage.id,": ",e.workPackage.name," ")}}class TimerAccountMenuComponent extends r.p{constructor(e,t,n,i,o,r,l,u,h){super(),this.elementRef=e,this.timeEntryService=t,this.cdRef=n,this.I18n=i,this.timeEntryEditService=o,this.halEditing=r,this.schemaCache=l,this.timezoneService=u,this.toastService=h,this.className=!0,this.timer$=this.timeEntryService.activeTimer$,this.elapsed$=(0,s.O)(0,1e3).pipe((0,a.n)((()=>this.timer$)),(0,c.p)((e=>null!==e)),(0,p.T)((e=>(0,d.R)(e.createdAt)))),this.text={tracking:this.I18n.t("js.time_entry.tracking"),stop:this.I18n.t("js.time_entry.stop"),timer_already_stopped:this.I18n.t("js.timer.timer_already_stopped")}}ngOnInit(){const e=this.elementRef.nativeElement.parentElement;e.hidden=!0,this.timer$.subscribe((t=>{e.hidden=!t,this.cdRef.detectChanges()}))}stopTimer(){var e=this;return(0,i.A)((function*(){const t=yield(0,l._)(e.timeEntryService.refresh());return t?e.timeEntryEditService.stopTimerAndEdit(t):e.toastService.addWarning(e.text.timer_already_stopped)}))()}static{this.ɵfac=function TimerAccountMenuComponent_Factory(e){return new(e||TimerAccountMenuComponent)(b.rXU(b.aKT),b.rXU(o.O),b.rXU(b.gRc),b.rXU(u.W),b.rXU(h.r),b.rXU(m.p),b.rXU(g.D),b.rXU(_.D),b.rXU(f.fw))}}static{this.ɵcmp=b.VBU({type:TimerAccountMenuComponent,selectors:[["op-timer-account-menu"]],hostVars:2,hostBindings:function TimerAccountMenuComponent_HostBindings(e,t){2&e&&b.AVh("op-timer-account-menu",t.className)},features:[b.Jv_([h.r,m.p]),b.Vt3],decls:2,vars:3,consts:[[4,"ngIf"],[1,"op-timer-account-menu--timer"],["data-test-selector","op-timer-account-menu-stop",1,"op-timer-account-menu--timer-icon",3,"click"],[1,"spot-icon","spot-icon_inline","spot-icon_time-tracking-stop","spot-icon_1_25"],["uiSref","work-packages.show",1,"op-timer-account-menu--wp-details",3,"uiParams"],[1,"spot-divider"]],template:function TimerAccountMenuComponent_Template(e,t){1&e&&(b.DNE(0,TimerAccountMenuComponent_ng_container_0_Template,10,10,"ng-container",0),b.nI1(1,"async")),2&e&&b.Y8G("ngIf",b.bMT(1,1,t.timer$))},dependencies:[k.bT,v.UISref,v.AnchorUISref,k.Jj],styles:[".cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-timer-account-menu{max-width:270px;display:block;font-family:var(--body-font-family);font-size:.875rem;font-weight:400;font-style:normal;line-height:1.25rem}.op-timer-account-menu--timer{display:flex;align-items:center;padding:0 10px;font-family:var(--body-font-family);font-size:.875rem;font-weight:700;font-style:normal;line-height:1.25rem;line-height:2rem}.op-timer-account-menu--timer-icon{margin-left:auto}.op-timer-account-menu--wp-details{padding:0 10px;display:inline-block;width:270px;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}\n"],encapsulation:2,changeDetection:0})}}},80166:(e,t,n)=>{"use strict";n.d(t,{d:()=>ToastComponent});var i=n(75797),o=n(72354),r=n(89475),s=n(64334),a=n(61816),l=n(72650),c=n(68559),p=n(60316),d=n(7086);const _c0=e=>({"-hidden":e});function ToastComponent_ng_container_2_div_2_Template(e,t){1&e&&(c.j41(0,"div",8),c.nrm(1,"div")(2,"div"),c.k0s())}function ToastComponent_ng_container_2_Template(e,t){if(1&e&&(c.qex(0),c.nrm(1,"p",6),c.DNE(2,ToastComponent_ng_container_2_div_2_Template,3,0,"div",7),c.nI1(3,"async"),c.bVm()),2&e){const e=c.XpG();c.R7$(),c.Y8G("textContent",e.toast.message),c.R7$(),c.Y8G("ngIf",c.bMT(3,2,e.loading$))}}function ToastComponent_p_3_a_3_Template(e,t){if(1&e){const e=c.RV6();c.j41(0,"a",10),c.bIt("click",(function ToastComponent_p_3_a_3_Template_a_click_0_listener(){c.eBV(e);const t=c.XpG(2);return c.Njj(t.executeTarget())})),c.k0s()}if(2&e){const e=c.XpG(2);c.Y8G("textContent",e.toast.link.text)}}function ToastComponent_p_3_Template(e,t){if(1&e&&(c.j41(0,"p"),c.nrm(1,"span",6)(2,"span",6),c.DNE(3,ToastComponent_p_3_a_3_Template,1,1,"a",9),c.k0s()),2&e){const e=c.XpG();c.R7$(),c.Y8G("textContent",e.toast.message),c.R7$(),c.Y8G("textContent"," "),c.R7$(),c.Y8G("ngIf",e.toast.link)}}function ToastComponent_div_5_div_1_Template(e,t){if(1&e){const e=c.RV6();c.j41(0,"div")(1,"a",13),c.bIt("click",(function ToastComponent_div_5_div_1_Template_a_click_1_listener(){c.eBV(e);const t=c.XpG(2);return c.Njj(t.show=!0)})),c.nrm(2,"span",14),c.k0s(),c.j41(3,"a",13),c.bIt("click",(function ToastComponent_div_5_div_1_Template_a_click_3_listener(){c.eBV(e);const t=c.XpG(2);return c.Njj(t.show=!1)})),c.nrm(4,"span",15),c.k0s(),c.nrm(5,"span",6),c.k0s()}if(2&e){const e=c.XpG(2);c.R7$(),c.Y8G("hidden",e.show),c.R7$(2),c.Y8G("hidden",!e.show),c.R7$(2),c.Y8G("textContent",e.uploadText)}}function ToastComponent_div_5_ul_3_op_toasters_upload_progress_1_Template(e,t){if(1&e){const e=c.RV6();c.j41(0,"op-toasters-upload-progress",18),c.bIt("uploadSuccess",(function ToastComponent_div_5_ul_3_op_toasters_upload_progress_1_Template_op_toasters_upload_progress_uploadSuccess_0_listener(){c.eBV(e);const t=c.XpG(3);return c.Njj(t.onUploadSuccess())}))("uploadError",(function ToastComponent_div_5_ul_3_op_toasters_upload_progress_1_Template_op_toasters_upload_progress_uploadError_0_listener(){c.eBV(e);const t=c.XpG(3);return c.Njj(t.remove())})),c.k0s()}if(2&e){const e=t.$implicit;c.Y8G("file",e[0])("upload",e[1])}}function ToastComponent_div_5_ul_3_Template(e,t){if(1&e&&(c.j41(0,"ul",16),c.DNE(1,ToastComponent_div_5_ul_3_op_toasters_upload_progress_1_Template,1,2,"op-toasters-upload-progress",17),c.k0s()),2&e){const e=c.XpG(2);c.R7$(),c.Y8G("ngForOf",e.data)}}function ToastComponent_div_5_Template(e,t){if(1&e&&(c.j41(0,"div"),c.DNE(1,ToastComponent_div_5_div_1_Template,6,3,"div",2),c.j41(2,"div",11),c.DNE(3,ToastComponent_div_5_ul_3_Template,2,1,"ul",12),c.k0s()()),2&e){const e=c.XpG();c.R7$(),c.Y8G("ngIf",e.canBeHidden),c.R7$(),c.Y8G("ngClass",c.eq3(3,_c0,!e.show&&e.canBeHidden)),c.R7$(),c.Y8G("ngIf",e.data&&e.data.length>0)}}function ToastComponent_div_6_Template(e,t){1&e&&c.nrm(0,"div")}function ToastComponent_div_7_li_2_Template(e,t){if(1&e&&c.nrm(0,"li",6),2&e){const e=t.$implicit;c.Y8G("textContent",e)}}function ToastComponent_div_7_Template(e,t){if(1&e&&(c.j41(0,"div")(1,"ul",19),c.DNE(2,ToastComponent_div_7_li_2_Template,1,1,"li",20),c.k0s()()),2&e){const e=c.XpG();c.R7$(2),c.Y8G("ngForOf",e.data)}}function ToastComponent_button_8_Template(e,t){if(1&e){const e=c.RV6();c.j41(0,"button",21),c.bIt("click",(function ToastComponent_button_8_Template_button_click_0_listener(){c.eBV(e);const t=c.XpG();return c.Njj(t.remove())})),c.nrm(1,"span",22),c.k0s()}if(2&e){const e=c.XpG();c.Y8G("title",e.text.close_popup)}}class ToastComponent{constructor(e,t){this.I18n=e,this.toastService=t,this.text={close_popup:this.I18n.t("js.close_popup_title")},this.uploadCount=0,this.show=!1,this.canBeHidden=!1,this.removable=!0,this.loading$=new i.t(!1)}ngOnInit(){if(this.type=this.toast.type,this.icon=this.toast.icon?`toast-icon icon-${this.toast.icon}`:"",this.removable=!["upload","loading"].includes(this.type),"upload"===this.type){const e=this.data;this.removable=!1,this.canBeHidden=e&&e.length>5}"loading"===this.type&&(this.removable=!1,this.loading$.next(!0),this.data.pipe((0,s.s)(1),(0,o.w)(2e4),(0,r.j)((()=>{this.loading$.next(!1),this.remove()}))).subscribe())}get data(){return this.toast.data}remove(){this.toastService.remove(this.toast)}executeTarget(){this.toast.link&&(this.toast.link.target(),this.remove())}onUploadSuccess(){this.uploadCount+=1}get uploadText(){const e=this.data.length;return this.I18n.t("js.label_upload_counter",{done:this.uploadCount,count:e})}static{this.ɵfac=function ToastComponent_Factory(e){return new(e||ToastComponent)(c.rXU(a.W),c.rXU(l.fw))}}static{this.ɵcmp=c.VBU({type:ToastComponent,selectors:[["op-toast"]],inputs:{toast:"toast"},decls:9,vars:11,consts:[["tabindex","0"],["role","alert","aria-atomic","true",1,"op-toast--content"],[4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["type","button","class","spot-link op-toast--close",3,"title","click",4,"ngIf"],[3,"textContent"],["class","op-loading-indicator op-loading-indicator_embedded",4,"ngIf"],[1,"op-loading-indicator","op-loading-indicator_embedded"],["class","op-toast--target-link",3,"textContent","click",4,"ngIf"],[1,"op-toast--target-link",3,"click","textContent"],[3,"ngClass"],["class","op-toast--uploads",4,"ngIf"],[3,"click","hidden"],[1,"spot-icon","spot-icon_arrow-right2"],[1,"spot-icon","spot-icon_arrow-down1"],[1,"op-toast--uploads"],[3,"file","upload","uploadSuccess","uploadError",4,"ngFor","ngForOf"],[3,"uploadSuccess","uploadError","file","upload"],[1,"op-toast--errors"],[3,"textContent",4,"ngFor","ngForOf"],["type","button",1,"spot-link","op-toast--close",3,"click","title"],[1,"spot-icon","spot-icon_1","spot-icon_close"]],template:function ToastComponent_Template(e,t){1&e&&(c.j41(0,"div",0)(1,"div",1),c.DNE(2,ToastComponent_ng_container_2_Template,4,4,"ng-container",2)(3,ToastComponent_p_3_Template,4,3,"p",2),c.j41(4,"div",3),c.DNE(5,ToastComponent_div_5_Template,4,5,"div",4)(6,ToastComponent_div_6_Template,1,0,"div",4)(7,ToastComponent_div_7_Template,3,1,"div",4),c.k0s(),c.DNE(8,ToastComponent_button_8_Template,2,1,"button",5),c.k0s()()),2&e&&(c.STu("op-toast -",t.type," ",t.icon,""),c.R7$(2),c.Y8G("ngIf","loading"===t.type),c.R7$(),c.Y8G("ngIf","loading"!==t.type),c.R7$(),c.Y8G("ngSwitch",t.type),c.R7$(),c.Y8G("ngSwitchCase","upload"),c.R7$(),c.Y8G("ngSwitchCase","success"),c.R7$(),c.Y8G("ngSwitchCase","error"),c.R7$(),c.Y8G("ngIf",t.removable))},dependencies:[p.YU,p.Sq,p.bT,p.ux,p.e1,d.S,p.Jj],encapsulation:2,changeDetection:0})}}},72650:(e,t,n)=>{"use strict";n.d(t,{fw:()=>ToastService});var i=n(64334),o=n(47418),r=n(30501),s=n(61816),a=n(72688),l=n(3901),c=n(57223),p=n(68559);class ToastService{constructor(e,t){this.configurationService=e,this.I18n=t,this.stack=(0,o.hF)([]),jQuery(window).on("op:toasters:add",((e,t)=>{this.add(t)}))}get current(){return this.stack}add(e,t=5e3){return function removeSuccessFlashMessages(){jQuery(".op-toast.-success").remove()}(),this.stack.doModify((t=>{const n=[e].concat(t);return _.remove(n,((e,t)=>t>0&&this.removeOnAdd(e))),n})),"success"===e.type&&this.configurationService.autoHidePopups()&&setTimeout((()=>this.remove(e)),t),e}removeOnAdd(e){return["success","error","loading"].includes(e.type)}addError(e,t=[]){let n,i;if(i="string"==typeof t?[t]:[...t],e instanceof r.yz){if(0===e.status)return console.error("Request cancelled or failed otherwise: %O",e),null;n=(0,c.cd)(e.error)?e.error.message:e.message,e.error?._embedded?.errors&&(i=[...i,...e.error._embedded.errors.map((e=>e.message))])}else n=e;const o=this.createToast(n,"error");return o.data=i,this.add(o)}addWarning(e){return this.add(this.createToast(e,"warning"))}addSuccess(e){return this.add(this.createToast(e,"success"))}addNotice(e){return this.add(this.createToast(e,"info"))}addUpload(e,t){if(!t.length)throw new Error("Cannot create an upload toast without uploads!");const n=this.add({data:t,type:"upload",message:e});return(0,l.A)(t.map((e=>e[1]))).pipe((0,i.s)(1)).subscribe((()=>{setTimeout((()=>this.remove(n)),700)})),n}addLoading(e){return this.add(this.createLoadingToast(this.I18n.t("js.ajax.updating"),e))}remove(e){this.stack.doModify((t=>(_.remove(t,(t=>t===e)),t)))}clear(){this.stack.putValue([])}createToast(e,t){return"string"==typeof e?{message:e,type:t}:{message:e.message,type:t,link:e.link,icon:e.icon,data:e.data}}createLoadingToast(e,t){const n=this.createToast(e,"loading");return n.data=t,n}static{this.ɵfac=function ToastService_Factory(e){return new(e||ToastService)(p.KVO(a.s),p.KVO(s.W))}}static{this.ɵprov=p.jDH({token:ToastService,factory:ToastService.ɵfac,providedIn:"root"})}}},82757:(e,t,n)=>{"use strict";n.d(t,{j:()=>ToastsContainerComponent});var i=n(99496),o=n(72650),r=n(68559),s=n(60316),a=n(80166);function ToastsContainerComponent_op_toast_2_Template(e,t){if(1&e&&r.nrm(0,"op-toast",3),2&e){const e=t.$implicit;r.Y8G("toast",e)}}class ToastsContainerComponent extends i.p{constructor(e,t){super(),this.toastService=e,this.cdRef=t,this.stack=[]}ngOnInit(){this.toastService.current.values$("Subscribing to changes in the toaster stack").pipe(this.untilDestroyed()).subscribe((e=>{this.stack=e,this.cdRef.detectChanges()}))}static{this.ɵfac=function ToastsContainerComponent_Factory(e){return new(e||ToastsContainerComponent)(r.rXU(o.fw),r.rXU(r.gRc))}}static{this.ɵcmp=r.VBU({type:ToastsContainerComponent,selectors:[["opce-toasts-container"]],features:[r.Vt3],decls:3,vars:1,consts:[[1,"op-toast--wrapper"],[1,"op-toast--casing"],[3,"toast",4,"ngFor","ngForOf"],[3,"toast"]],template:function ToastsContainerComponent_Template(e,t){1&e&&(r.j41(0,"div",0)(1,"div",1),r.DNE(2,ToastsContainerComponent_op_toast_2_Template,1,1,"op-toast",2),r.k0s()()),2&e&&(r.R7$(2),r.Y8G("ngForOf",t.stack))},dependencies:[s.Sq,a.d],encapsulation:2,changeDetection:0})}}},7086:(e,t,n)=>{"use strict";n.d(t,{S:()=>UploadProgressComponent});var i=n(68559),o=n(30501),r=n(75797),s=n(19999),a=n(36819),l=n(99496),c=n(60316),p=n(46765);const d=["progressBar"],u=["progressPercentage"];function UploadProgressComponent_span_7_op_icon_1_Template(e,t){1&e&&i.nrm(0,"op-icon",8)}function UploadProgressComponent_span_7_op_icon_2_Template(e,t){1&e&&i.nrm(0,"op-icon",9)}function UploadProgressComponent_span_7_Template(e,t){if(1&e&&(i.j41(0,"span",5),i.DNE(1,UploadProgressComponent_span_7_op_icon_1_Template,1,0,"op-icon",6)(2,UploadProgressComponent_span_7_op_icon_2_Template,1,0,"op-icon",7),i.k0s()),2&e){const e=i.XpG();i.R7$(),i.Y8G("ngIf",e.error),i.R7$(),i.Y8G("ngIf",e.completed)}}class UploadProgressComponent extends l.p{constructor(){super(...arguments),this.uploadError=new i.bkB,this.uploadSuccess=new i.bkB,this.error=!1,this.completed=!1,this.viewInitialized=new r.t(!1)}set value(e){this.progressBar.nativeElement.value=e,this.progressPercentage.nativeElement.innerText=`${e}%`,100===e&&(this.progressBar.nativeElement.style.display="none")}ngOnInit(){(0,s.z)([this.upload,this.viewInitialized]).pipe(this.untilDestroyed()).subscribe((([e,t])=>{if(t)switch(e.type){case o.hv.Sent:this.value=5,(0,a.cY)(`Uploading file "${this.file.name}" of size ${this.file.size}.`);break;case o.hv.UploadProgress:this.updateProgress(e);break;case o.hv.Response:(0,a.cY)(`File ${this.fileName} was fully uploaded.`),this.value=100,this.completed=!0,this.uploadSuccess.emit();break;case o.hv.DownloadProgress:case o.hv.ResponseHeader:break;default:console.warn(`unknown event type: ${e.type}`)}}),(e=>this.handleError(e)))}ngAfterViewInit(){this.viewInitialized.next(!0)}get fileName(){return this.file&&this.file.name}updateProgress(e){e.total?this.value=Math.round(e.loaded/e.total*100):this.value=10}handleError(e){this.error=!0,this.uploadError.emit(e)}static{this.ɵfac=(()=>{let e;return function UploadProgressComponent_Factory(t){return(e||(e=i.xGo(UploadProgressComponent)))(t||UploadProgressComponent)}})()}static{this.ɵcmp=i.VBU({type:UploadProgressComponent,selectors:[["op-toasters-upload-progress"]],viewQuery:function UploadProgressComponent_Query(e,t){if(1&e&&(i.GBs(d,5),i.GBs(u,5)),2&e){let e;i.mGM(e=i.lsd())&&(t.progressBar=e.first),i.mGM(e=i.lsd())&&(t.progressPercentage=e.first)}},inputs:{file:"file",upload:"upload"},outputs:{uploadError:"uploadError",uploadSuccess:"uploadSuccess"},features:[i.Vt3],decls:8,vars:2,consts:[["progressBar",""],["progressPercentage",""],[1,"filename",3,"textContent"],["max","100","value","0"],["class","upload-completed",4,"ngIf"],[1,"upload-completed"],["icon-classes","icon-close",4,"ngIf"],["icon-classes","icon-checkmark",4,"ngIf"],["icon-classes","icon-close"],["icon-classes","icon-checkmark"]],template:function UploadProgressComponent_Template(e,t){1&e&&(i.j41(0,"li"),i.nrm(1,"span",2)(2,"progress",3,0),i.j41(4,"p",null,1),i.EFF(6,"0%"),i.k0s(),i.DNE(7,UploadProgressComponent_span_7_Template,3,2,"span",4),i.k0s()),2&e&&(i.R7$(),i.Y8G("textContent",t.fileName),i.R7$(6),i.Y8G("ngIf",t.completed||t.error))},dependencies:[c.bT,p.i],encapsulation:2,changeDetection:0})}}},45085:(e,t,n)=>{"use strict";n.d(t,{F:()=>UserLinkComponent});n(6758);var i=n(61816),o=n(68559),r=n(60316);function UserLinkComponent_a_0_Template(e,t){if(1&e&&o.nrm(0,"a",2),2&e){const e=o.XpG();o.Y8G("textContent",e.name),o.BMQ("href",e.href,o.B4B)("title",e.label)}}function UserLinkComponent_ng_container_1_Template(e,t){if(1&e&&(o.qex(0),o.EFF(1),o.eu8(2),o.bVm()),2&e){const e=o.XpG();o.R7$(),o.SpI(" ",e.name," ")}}class UserLinkComponent{constructor(e){this.I18n=e}get href(){return this.user&&this.user.showUserPath}get name(){return this.user&&this.user.name}get label(){return this.I18n.t("js.label_author",{user:this.name})}static{this.ɵfac=function UserLinkComponent_Factory(e){return new(e||UserLinkComponent)(o.rXU(i.W))}}static{this.ɵcmp=o.VBU({type:UserLinkComponent,selectors:[["op-user-link"]],inputs:{user:"user"},decls:2,vars:2,consts:[[3,"textContent",4,"ngIf"],[4,"ngIf"],[3,"textContent"]],template:function UserLinkComponent_Template(e,t){1&e&&o.DNE(0,UserLinkComponent_a_0_Template,1,3,"a",0)(1,UserLinkComponent_ng_container_1_Template,3,1,"ng-container",1),2&e&&(o.Y8G("ngIf",t.href),o.R7$(),o.Y8G("ngIf",!t.href))},dependencies:[r.bT],encapsulation:2,changeDetection:0})}}},85058:(e,t,n)=>{"use strict";n.d(t,{n:()=>AlternativeSearchService});var i=n(61816),o=n(68559);class AlternativeSearchService{constructor(e){this.I18n=e,this.specialSearchStrings={percentComplete:this.I18n.t("js.work_packages.properties.percentComplete"),percentCompleteAlternative:this.I18n.t("js.work_packages.properties.percentCompleteAlternative"),work:this.I18n.t("js.work_packages.properties.work"),workAlternative:this.I18n.t("js.work_packages.properties.workAlternative"),remainingWork:this.I18n.t("js.work_packages.properties.remainingWork"),remainingWorkAlternative:this.I18n.t("js.work_packages.properties.remainingWorkAlternative")},this.alternativeNames={[this.specialSearchStrings.percentCompleteAlternative]:this.specialSearchStrings.percentComplete,[this.specialSearchStrings.workAlternative]:this.specialSearchStrings.work,[this.specialSearchStrings.remainingWorkAlternative]:this.specialSearchStrings.remainingWork},this.searchFunction=(e,t)=>{const n=e.toLowerCase(),i=t.name.toLowerCase(),o=Object.keys(this.alternativeNames).some((e=>e.toLowerCase().includes(n)&&t.name===this.alternativeNames[e]));return i.includes(n)||o}}static{this.ɵfac=function AlternativeSearchService_Factory(e){return new(e||AlternativeSearchService)(o.KVO(i.W))}}static{this.ɵprov=o.jDH({token:AlternativeSearchService,factory:AlternativeSearchService.ɵfac,providedIn:"root"})}}},2768:(e,t,n)=>{"use strict";n.d(t,{B:()=>AutofocusDirective});var i=n(87879),o=n(68559);class AutofocusDirective{constructor(e,t){this.FocusHelper=e,this.elementRef=t,this.condition=!0}ngAfterViewInit(){this.updateFocus()}updateFocus(){(this.condition||""===this.condition)&&this.FocusHelper.focus(this.elementRef.nativeElement)}static{this.ɵfac=function AutofocusDirective_Factory(e){return new(e||AutofocusDirective)(o.rXU(i.k),o.rXU(o.aKT))}}static{this.ɵdir=o.FsC({type:AutofocusDirective,selectors:[["","opAutofocus",""]],inputs:{condition:[o.Mj6.None,"opAutofocus","condition"]}})}}},7350:(e,t,n)=>{"use strict";function insideOrSelf(e,t){return e===t||e.contains(t)}function whenOutside(e,t){setTimeout((()=>{insideOrSelf(e,document.activeElement)||t()}),20)}n.d(t,{m:()=>whenOutside,s:()=>insideOrSelf})},87879:(e,t,n)=>{"use strict";n.d(t,{k:()=>FocusHelperService});var i=n(64),o=n(68559);class FocusHelperService{focus(e){setTimeout((()=>{const t=(0,i.R)(e)[0]||e;t?.focus()}),20)}static{this.ɵfac=function FocusHelperService_Factory(e){return new(e||FocusHelperService)}}static{this.ɵprov=o.jDH({token:FocusHelperService,factory:FocusHelperService.ɵfac,providedIn:"root"})}}},87715:(e,t,n)=>{"use strict";n.d(t,{x:()=>FocusWithinDirective});var i=n(75797),o=n(67535),r=n(99496),s=n(68559);class FocusWithinDirective extends r.p{constructor(e){super(),this.elementRef=e}ngOnInit(){const e=jQuery(this.elementRef.nativeElement),t=new i.t(!1);t.pipe(this.untilDestroyed(),(0,o.Z)(50)).subscribe((t=>{e.toggleClass("-focus",t)}));e[0].addEventListener("focus",(function(){t.next(!0)}),!0);e[0].addEventListener("blur",(function(){t.next(!1)}),!0),setTimeout((()=>{e.addClass("op-focus-within"),e.find(this.selector).addClass("op-focus-within")}),0)}static{this.ɵfac=function FocusWithinDirective_Factory(e){return new(e||FocusWithinDirective)(s.rXU(s.aKT))}}static{this.ɵdir=s.FsC({type:FocusWithinDirective,selectors:[["","opFocusWithin",""]],inputs:{selector:"selector"},features:[s.Vt3]})}}},78906:(e,t,n)=>{"use strict";n.d(t,{j:()=>FocusModule});var i=n(60316),o=n(87715),r=n(2768),s=n(68559);class FocusModule{static{this.ɵfac=function FocusModule_Factory(e){return new(e||FocusModule)}}static{this.ɵmod=s.$C({type:FocusModule})}static{this.ɵinj=s.G2t({imports:[i.MD]})}}("undefined"==typeof ngJitMode||ngJitMode)&&s.Obh(FocusModule,{declarations:[r.B,o.x],imports:[i.MD],exports:[r.B,o.x]})},26579:(e,t,n)=>{"use strict";n.d(t,{p:()=>OpSearchHighlightDirective});var i=n(68559);class OpSearchHighlightDirective{constructor(e){this.elementRef=e,this.query=""}ngAfterViewChecked(){let e=this.elementRef.nativeElement;const t=e.querySelector(".op-search-highlight");if(t&&this.query&&t.innerHTML.toLocaleLowerCase()===this.query.toLocaleLowerCase())return;if(e=this.cleanUpOldHighlighting(e),!this.query)return;const n=Array.from(e.childNodes).find((e=>e.nodeType===e.TEXT_NODE)),i=n?.textContent||"";if(!i)return;const o=this.query.toLowerCase(),r=i.toLowerCase().indexOf(o);if(r<0)return;const s=i.slice(0,r),a=i.slice(r,r+o.length),l=i.slice(r+o.length),c=document.createElement("span");c.innerHTML=`${_.escape(s)}<span class="op-search-highlight">${_.escape(a)}</span>${_.escape(l)}`,e.replaceChild(c,n)}cleanUpOldHighlighting(e){if(e.children.length>0){const t=Array.from(e.children,(({textContent:e})=>e?.trim())).join("");e.innerHTML="",e.innerText=t}return e}static{this.ɵfac=function OpSearchHighlightDirective_Factory(e){return new(e||OpSearchHighlightDirective)(i.rXU(i.aKT))}}static{this.ɵdir=i.FsC({type:OpSearchHighlightDirective,selectors:[["","opSearchHighlight",""]],inputs:{query:[i.Mj6.None,"opSearchHighlight","query"]}})}}},1758:(e,t,n)=>{"use strict";n.d(t,{O:()=>InjectField});n(99585);var i=n(36819);function InjectField(e,t=null,n){return(o,r)=>{delete o[r]&&Object.defineProperty(o,r,{get(){if(e)return this.injector.get(e,t,n);const i=Reflect.getMetadata("design:type",o,r);return this.injector.get(i,t,n)},set(){(0,i.cY)(`Trying to set InjectField property ${r}`)}})}}},55596:(e,t,n)=>{"use strict";n.d(t,{I$:()=>trackByProperty,K0:()=>compareByHrefOrString,Mz:()=>compareByHref,S0:()=>trackByHref,bO:()=>compareByAttribute,cg:()=>trackByName,kz:()=>trackByHrefAndProperty,lV:()=>halHref});var i=n(27514);function halHref(e,t){return t.href}function compareByAttribute(...e){return(t,n)=>{const i=!t&&!n,o=!!t&&!!n&&e.every((e=>t[e]===n[e]));return i||!!t&&!!n&&o}}function trackByName(e,t){return _.get(t,"name")}function trackByHref(e,t){return _.get(t,"href")}function trackByProperty(e){return(t,n)=>_.get(n,e)}function trackByHrefAndProperty(e){return(t,n)=>{const i=_.get(n,"href")||"",o=_.get(n,e,"none");return`${i}#${e}=${o}`}}function compareByHref(e,t){return!e&&!t||!!e&&!!t&&e.href===t.href}function compareByHrefOrString(e,t){if(e instanceof i.q&&t instanceof i.q)return compareByHref(e,t);return!e&&!t||e===t}},99496:(e,t,n)=>{"use strict";n.d(t,{p:()=>UntilDestroyedMixin});var i=n(99664),o=n(68559);class UntilDestroyedMixin extends i.Nh{constructor(){super(...arguments),this.componentDestroyed=!1}ngOnDestroy(){this.componentDestroyed=!0,super.ngOnDestroy()}untilDestroyed(){return(0,i.rL)(this)}static{this.ɵfac=(()=>{let e;return function UntilDestroyedMixin_Factory(t){return(e||(e=o.xGo(UntilDestroyedMixin)))(t||UntilDestroyedMixin)}})()}static{this.ɵdir=o.FsC({type:UntilDestroyedMixin,features:[o.Vt3]})}}},89282:(e,t,n)=>{"use strict";n.d(t,{K7:()=>ApiV3Filter,hG:()=>ApiV3FilterBuilder});const i=["f"],o=["t"];class ApiV3FilterBuilder{constructor(){this.filterMap={}}add(e,t,n){const r=!0===n?o:!1===n?i:n;return this.filterMap[e]={operator:t,values:r},this}remove(e){delete this.filterMap[e]}static toFilterObject(e){const t={};return e.forEach((e=>{_.each(e,((e,n)=>{t[n]=e}))})),t}static fromFilterObject(e){const t=new ApiV3FilterBuilder;return Object.keys(e).forEach((n=>{const i=e[n];t.add(n,i.operator,i.values)})),t}merge(e,...t){const n=_.pickBy(ApiV3FilterBuilder.toFilterObject(e),((e,n)=>t.includes(n)));this.filterMap={...this.filterMap,...n}}get filters(){const e=[];return _.each(this.filterMap,((t,n)=>{e.push({[n]:t})})),e}toJson(){return JSON.stringify(this.filters)}toParams(e={}){const t={filters:this.toJson(),...e};return new URLSearchParams(t).toString()}clone(){const e=new ApiV3FilterBuilder;return this.filters.forEach((t=>{Object.keys(t).forEach((n=>{e.add(n,t[n].operator,t[n].values)}))})),e}}function ApiV3Filter(e,t,n){return(new ApiV3FilterBuilder).add(e,t,n)}},36819:(e,t,n)=>{"use strict";n.d(t,{bw:()=>whenDebugging,cY:()=>debugLog,li:()=>timeOutput});var i=n(45312);function whenDebugging(e){i.c.production||e()}function debugLog(e,...t){whenDebugging((()=>console.log(`[DEBUG] ${e}`,...t)))}function timeOutput(e,t){if(!i.c.production){const n=performance.now(),i=t(),o=performance.now();return console.log(`%c${e} completed in ${o-n} milliseconds.`,"color:#00A093;"),i}return t()}},22989:(e,t,n)=>{"use strict";function setBodyCursor(e,t=""){document.body.style.setProperty("cursor",e,t)}n.d(t,{r:()=>setBodyCursor})},36831:(e,t,n)=>{"use strict";n.d(t,{A:()=>DomAutoscrollService});var i=n(69);class DomAutoscrollService{constructor(e,t){this.down=!1,this.elements=e,this.scrollWhenOutside=t.scrollWhenOutside||!1,this.maxSpeed=t.maxSpeed||5,this.margin=t.margin||10,this.scrollWhenOutside=t.scrollWhenOutside||!1,this.autoScroll=t.autoScroll,this.point={},this.pointCB=(0,i.Qt)(this.point),this.init()}init(){jQuery(window).on("mousemove.domautoscroll touchmove.domautoscroll",(e=>{this.down&&(this.pointCB(e),this.onMove(e))})),jQuery(window).on("mousedown.domautoscroll touchstart.domautoscroll",(()=>{this.down=!0})),jQuery(window).on("mouseup.domautoscroll touchend.domautoscroll",(()=>this.onUp())),jQuery(window).on("scroll.domautoscroll",(e=>this.setScroll(e)))}destroy(){jQuery(window).off(".domautoscroll"),this.elements=[],this.cleanAnimation()}add(e){Array.isArray(e)?(this.elements=this.elements.concat(e),this.elements=Array.from(new Set(this.elements))):this.elements.push(e)}onUp(){this.down=!1,cancelAnimationFrame(this.animationFrame),cancelAnimationFrame(this.windowAnimationFrame)}setScroll(e){for(let t=0;t<this.elements.length;t++)if(this.elements[t]===e.target){this.scrolling=!0;break}this.scrolling&&requestAnimationFrame((()=>{this.scrolling=!1}))}cleanAnimation(){cancelAnimationFrame(this.animationFrame),cancelAnimationFrame(this.windowAnimationFrame)}getTarget(e){if(!e)return[];const recurseParents=e=>[...this.elements.includes(e)?[e]:[],...e.parentElement?recurseParents(e.parentElement):[]];return recurseParents(e)}getElementsUnderPoint(){const e=[];for(let t=0;t<this.elements.length;t++)this.inside(this.point,this.elements[t])&&e.push(this.elements[t]);return e}onMove(e){if(!this.autoScroll())return;if(e.dispatched)return;let t=[];null!==e.target&&t.push(e.target);const{body:n}=document;t.length>0&&t[0].parentNode===n?t=this.getElementsUnderPoint():(t=this.getTarget(t[0]),0===t.length&&(t=this.getElementsUnderPoint())),this.current=t,0===this.current.length&&(this.current=[this.outerScrollContainer]),cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(this.scrollTick.bind(this))}setOuterScrollContainer(e){this.outerScrollContainer=e}scrollTick(){0!==this.current.length&&(this.current.forEach((e=>{e&&this.scrollAutomatically(e)})),cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(this.scrollTick.bind(this)))}scrollAutomatically(e){const t=(0,i.Sj)(e),n=(()=>this.point.x<t.left+this.margin?-this.maxSpeed:this.point.x>t.right-this.margin?this.maxSpeed:0)(),o=(()=>this.point.y<t.top+this.margin?-this.maxSpeed:this.point.y>t.bottom-this.margin?this.maxSpeed:0)();setTimeout((()=>{o&&this.scrollY(e,o),n&&this.scrollX(e,n)}))}scrollY(e,t){e===window?window.scrollTo(e.pageXOffset,e.pageYOffset+t):e.scrollTop+=t}scrollX(e,t){e===window?window.scrollTo(e.pageXOffset+t,e.pageYOffset):e.scrollLeft+=t}inside(e,t,n){return n?e.y>n.top&&e.y<n.bottom&&e.x>n.left&&e.x<n.right:(0,i.Ph)(e,t)}}},13344:(e,t,n)=>{"use strict";function findIndex(e){if(!e.parentElement)return-1;return Array.from(e.parentElement.children).indexOf(e)}function reinsert(e,t,n){const i="string"==typeof t?parseInt(t,10):t,o=e.parentNode?Array.from(e.parentNode.children).indexOf(e):null,r=Array.from(n.children),s=(()=>{if(null!=o&&o>=0){return o>i?r[i]:r[i+1]}return r[i]})();s?n.insertBefore(e,s):n.appendChild(e)}n.d(t,{S:()=>findIndex,l:()=>reinsert})},21162:(e,t,n)=>{"use strict";n.d(t,{W:()=>DragAndDropService});var i=n(89204),o=n(60316),r=n(36831),s=n(13344),a=n(68559);class DragAndDropService{constructor(e,t){this.document=e,this.injector=t,this.drake=null,this.members=[],this.escapeListener=e=>{this.drake&&"Escape"===e.key&&this.drake.cancel(!0)},this.document.documentElement.addEventListener("keydown",this.escapeListener)}ngOnDestroy(){this.document.documentElement.removeEventListener("keydown",this.escapeListener),this.autoscroll&&this.autoscroll.destroy(),this.drake&&this.drake.destroy()}remove(e){this.initialized&&(_.remove(this.drake.containers,(t=>t===e)),_.remove(this.members,(t=>t.dragContainer===e)))}member(e){return _.find(this.members,(t=>t.dragContainer===e))}get initialized(){return null!==this.drake}register(e){this.members.push(e);const{scrollContainers:t}=e;this.autoscroll?this.autoscroll.add(t):this.setupAutoscroll(t);const{dragContainer:n}=e;null===this.drake?this.initializeDrake([n]):this.drake.containers.push(n)}addScrollContainer(e){this.autoscroll?this.autoscroll.add(e):this.setupAutoscroll([e]),this.autoscroll.setOuterScrollContainer(e)}setupAutoscroll(e){this.autoscroll=new r.A(e,{margin:100,maxSpeed:10,scrollWhenOutside:!0,autoScroll:()=>this.drake&&this.drake.dragging})}getMember(e){return this.members.find((t=>t.dragContainer===e))}initializeDrake(e){this.drake=dragula(e,{moves:(e,t,n,i)=>{const o=this.getMember(t);return!!o&&o.moves(e,t,n,i)},accepts:(e,t)=>{const n=this.getMember(t);return!n||!n.accepts||n.accepts(e,t)},invalid:()=>!1,direction:"vertical",copy:!1,revertOnSpill:!0,removeOnSpill:!1,mirrorContainer:document.body,ignoreInputTextSelection:!0}),this.drake.on("drag",(e=>{e.dataset.sourceIndex=(0,s.S)(e).toString()})),this.drake.on("over",((e,t)=>{const n=t.closest(".drop-zone");n&&n.classList.add("-dragged-over")})),this.drake.on("out",((e,t)=>{const n=t.closest(".drop-zone");n&&n.classList.remove("-dragged-over")})),this.drake.on("cloned",((e,t)=>{const n=this.member(t.parentElement);n&&n.onCloned&&n.onCloned(e,t)})),this.drake.on("drop",((e,t,n,i)=>{try{this.handleDrop(e,t,n,i)}catch(t){console.error("Failed to handle drop of %O, %O",e,t)}})),this.drake.on("shadow",((e,t)=>{const n=this.member(t);n&&n.onShadowInserted&&n.onShadowInserted(e)})),this.drake.on("cancel",((e,t)=>{const n=this.member(t);n&&n.onCancel&&n.onCancel(e)}))}handleDrop(e,t,n,o){var r=this;return(0,i.A)((function*(){const i=r.member(t),a=r.member(n);if(!i||!a)return;if(i===a)return void i.onMoved(e,t,n,o);(yield i.onAdded(e,t,n,o))?a.onRemoved(e,t,n,o):(0,s.l)(e,e.dataset.sourceIndex||-1,n)}))()}static{this.ɵfac=function DragAndDropService_Factory(e){return new(e||DragAndDropService)(a.KVO(o.qQ),a.KVO(a.zZn))}}static{this.ɵprov=a.jDH({token:DragAndDropService,factory:DragAndDropService.ɵfac})}}},64:(e,t,n)=>{"use strict";n.d(t,{R:()=>findAllFocusableElementsWithin});const i=['a[href]:not([tabindex^="-"])','area[href]:not([tabindex^="-"])','input:not([type="hidden"]):not([type="radio"]):not([disabled]):not([tabindex^="-"])','input[type="radio"]:not([disabled]):not([tabindex^="-"])','select:not([disabled]):not([tabindex^="-"])','textarea:not([disabled]):not([tabindex^="-"])','button:not([disabled]):not([tabindex^="-"])','iframe:not([tabindex^="-"])','audio[controls]:not([tabindex^="-"])','video[controls]:not([tabindex^="-"])','[contenteditable]:not([tabindex^="-"])','[tabindex]:not([tabindex^="-"]):not(.cdk-focus-trap-anchor)'];function findAllFocusableElementsWithin(e){return e.querySelectorAll(i.toString())}},65277:(e,t,n)=>{"use strict";function imagePath(e){return`${n.p}assets/images/${e}`}n.d(t,{d:()=>imagePath})},41670:(e,t,n)=>{"use strict";var i;n.d(t,{c:()=>i}),function(e){e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT_ARROW=37]="LEFT_ARROW",e[e.UP_ARROW=38]="UP_ARROW",e[e.RIGHT_ARROW=39]="RIGHT_ARROW",e[e.DOWN_ARROW=40]="DOWN_ARROW",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.KEY_0=48]="KEY_0",e[e.KEY_1=49]="KEY_1",e[e.KEY_2=50]="KEY_2",e[e.KEY_3=51]="KEY_3",e[e.KEY_4=52]="KEY_4",e[e.KEY_5=53]="KEY_5",e[e.KEY_6=54]="KEY_6",e[e.KEY_7=55]="KEY_7",e[e.KEY_8=56]="KEY_8",e[e.KEY_9=57]="KEY_9",e[e.KEY_A=65]="KEY_A",e[e.KEY_B=66]="KEY_B",e[e.KEY_C=67]="KEY_C",e[e.KEY_D=68]="KEY_D",e[e.KEY_E=69]="KEY_E",e[e.KEY_F=70]="KEY_F",e[e.KEY_G=71]="KEY_G",e[e.KEY_H=72]="KEY_H",e[e.KEY_I=73]="KEY_I",e[e.KEY_J=74]="KEY_J",e[e.KEY_K=75]="KEY_K",e[e.KEY_L=76]="KEY_L",e[e.KEY_M=77]="KEY_M",e[e.KEY_N=78]="KEY_N",e[e.KEY_O=79]="KEY_O",e[e.KEY_P=80]="KEY_P",e[e.KEY_Q=81]="KEY_Q",e[e.KEY_R=82]="KEY_R",e[e.KEY_S=83]="KEY_S",e[e.KEY_T=84]="KEY_T",e[e.KEY_U=85]="KEY_U",e[e.KEY_V=86]="KEY_V",e[e.KEY_W=87]="KEY_W",e[e.KEY_X=88]="KEY_X",e[e.KEY_Y=89]="KEY_Y",e[e.KEY_Z=90]="KEY_Z",e[e.LEFT_META=91]="LEFT_META",e[e.RIGHT_META=92]="RIGHT_META",e[e.SELECT=93]="SELECT",e[e.NUMPAD_0=96]="NUMPAD_0",e[e.NUMPAD_1=97]="NUMPAD_1",e[e.NUMPAD_2=98]="NUMPAD_2",e[e.NUMPAD_3=99]="NUMPAD_3",e[e.NUMPAD_4=100]="NUMPAD_4",e[e.NUMPAD_5=101]="NUMPAD_5",e[e.NUMPAD_6=102]="NUMPAD_6",e[e.NUMPAD_7=103]="NUMPAD_7",e[e.NUMPAD_8=104]="NUMPAD_8",e[e.NUMPAD_9=105]="NUMPAD_9",e[e.MULTIPLY=106]="MULTIPLY",e[e.ADD=107]="ADD",e[e.SUBTRACT=109]="SUBTRACT",e[e.DECIMAL=110]="DECIMAL",e[e.DIVIDE=111]="DIVIDE",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUM_LOCK=144]="NUM_LOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.SEMICOLON=186]="SEMICOLON",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.DASH=189]="DASH",e[e.PERIOD=190]="PERIOD",e[e.FORWARD_SLASH=191]="FORWARD_SLASH",e[e.GRAVE_ACCENT=192]="GRAVE_ACCENT",e[e.OPEN_BRACKET=219]="OPEN_BRACKET",e[e.BACK_SLASH=220]="BACK_SLASH",e[e.CLOSE_BRACKET=221]="CLOSE_BRACKET",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE"}(i||(i={}))},2183:(e,t,n)=>{"use strict";function isClickedWithModifier(e){const t=e.ctrlKey||e.shiftKey||e.metaKey,n=1===e.button;return t||n}n.d(t,{R:()=>isClickedWithModifier})},25073:(e,t,n)=>{"use strict";function opIconElement(...e){const t=document.createElement("i");return t.setAttribute("aria-hidden","true"),t.classList.add(...e),t}n.d(t,{N:()=>opIconElement})},8655:(e,t,n)=>{"use strict";n.d(t,{D:()=>randomString});const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function randomString(e=16){return new Array(e).fill(null).map((()=>i.charAt(Math.floor(Math.random()*i.length)))).join("")}},22387:(e,t,n)=>{"use strict";n.d(t,{E:()=>DebouncedEventEmitter});var i=n(68559),o=n(84205),r=n(52575),s=n(33900);class DebouncedEventEmitter{constructor(e,t=250){this.emitter=new i.bkB,this.debouncer=new o.B,this.debouncer.pipe((0,r.B)(t),(0,s.Q)(e)).subscribe((e=>this.emitter.emit(e)))}emit(e){this.debouncer.next(e)}subscribe(e,t,n){return this.emitter.subscribe(e,t,n)}}},49763:(e,t,n)=>{"use strict";n.d(t,{E:()=>getPosition,K:()=>setPosition});var i=n(36819);function setPosition(e,t){try{e.setSelectionRange(t,t)}catch(e){(0,i.cY)("Failed to set click position for edit field.",e)}}function getPosition(e){const t=e.originalEvent;try{if(t.rangeParent){const e=document.createRange();return e.setStart(t.rangeParent,t.rangeOffset),e.startOffset}const n=document;return n.caretRangeFromPoint?n.caretRangeFromPoint(e.clientX,e.clientY).startOffset:0}catch(e){return(0,i.cY)("Failed to get click position for edit field.",e),0}}},915:(e,t,n)=>{"use strict";function videoPath(e){return`${n.p}assets/videos/${e}`}n.d(t,{J:()=>videoPath})},34802:(e,t,n)=>{"use strict";n.d(t,{d:()=>OpSharedModule});var i=n(34456),o=n(41497),r=n(83093),s=n(62223),a=n(50854),l=n(9168),c=n(60316),p=n(44931),d=n(46147),u=n(25827),h=n(88955),m=n(12918),g=n(1845),_=n(42572),f=n(17136),b=n(72811),k=n(46653),v=n(86866),C=n(94530),y=n(58397),w=n(23941),T=n(54547),S=n(78906),j=n(35321),P=n(95393),I=n(74356),x=n(98157),R=n(13813),F=n(23906),M=n(36777),O=n(86757),D=n(2731),G=n(80166),E=n(89204),A=n(68559),V=n(61816),$=n(9585),B=n(32420),W=n(83045),N=n(84205),U=n(63617),Y=n(18537),X=n(99496),q=n(51567),L=n(52575),H=n(70271),z=n(36652),Q=n(74037),K=n(87879),J=n(21863),Z=n(18240),ee=n(93338),te=n(88294);const ne=["modalContainer"],ie=["flatpickrTarget"],_c2=e=>({"op-datepicker-modal--date-field_current":e});class OpMultiDatePickerComponent extends X.p{set opened(e){this._opened!==!!e&&(this._opened=!!e,this._opened?this.initializeDatepickerAfterOpen():(this.datePickerInstance?.destroy(),this.closed.emit()))}get opened(){return this._opened}get datesString(){return this.value?.[0]&&this.value?.[1]?`${this.value[0]} - ${this.value[1]}`:this.text.placeholder}constructor(e,t,n,i,o,r,s,a){super(),this.injector=e,this.cdRef=t,this.I18n=n,this.timezoneService=i,this.deviceService=o,this.weekdayService=r,this.focusHelper=s,this.spotDropModalTeleportationService=a,this.id="flatpickr-input-"+ +new Date,this.name="",this.fieldName="",this.value=[],this._opened=!1,this.valueChange=new A.bkB,this.closed=new A.bkB,this.text={apply:this.I18n.t("js.modals.button_apply"),cancel:this.I18n.t("js.button_cancel"),startDate:this.I18n.t("js.work_packages.properties.startDate"),endDate:this.I18n.t("js.work_packages.properties.dueDate"),placeholder:this.I18n.t("js.placeholders.default"),today:this.I18n.t("js.label_today"),days:e=>this.I18n.t("js.units.day",{count:e}),ignoreNonWorkingDays:{title:this.I18n.t("js.work_packages.datepicker_modal.ignore_non_working_days.title")}},this.ignoreNonWorkingDays=!0,this.htmlId="",this.dates={start:null,end:null},this.startDateChanged$=new N.B,this.startDateDebounced$=this.debouncedInput(this.startDateChanged$,"start"),this.endDateChanged$=new N.B,this.endDateDebounced$=this.debouncedInput(this.endDateChanged$,"end"),this.datepickerChanged$=new N.B,this.ignoreNonWorkingDaysWritable=!0,this.onChange=e=>{},this.onTouched=()=>{},(0,U.h)(this.startDateDebounced$,this.endDateDebounced$,this.datepickerChanged$).pipe(this.untilDestroyed(),(0,q.p)((()=>!!this.datePickerInstance))).subscribe((([e,t])=>{null!==t&&this.handleSingleDateUpdate(e,t),this.cdRef.detectChanges()}))}ngOnInit(){this.applyLabel=this.applyLabel||this.text.apply,this.htmlId=`wp-datepicker-${this.fieldName}`,this.dates.start=this.value?.[0],this.dates.end=this.value?.[1],this.setCurrentActivatedField(this.initialActivatedField)}onInputClick(e){e.stopPropagation()}close(){this.opened=!1}changeNonWorkingDays(){this.initializeDatepicker(),this.cdRef.detectChanges()}save(e){e.preventDefault();const t=[this.dates.start||"",this.dates.end||""];this.value=t,this.valueChange.emit(t),this.onChange(t),this.close()}updateDate(e,t){if((null===t||(0,$.BY)(t))&&this.datePickerInstance){this.dates[e]=(0,$.i$)(t);const n=(0,$._U)(t||"")||void 0;this.enforceManualChangesToDatepicker(n),this.cdRef.detectChanges()}}setCurrentActivatedField(e){this.currentlyActivatedDateField=e}toggleCurrentActivatedField(){this.currentlyActivatedDateField="start"===this.currentlyActivatedDateField?"end":"start"}isStateOfCurrentActivatedField(e){return this.currentlyActivatedDateField===e}setToday(e){this.datepickerChanged$.next([e,new Date]);const t="start"===e?"end":"start";this.setCurrentActivatedField(t)}showFieldAsActive(e){return this.isStateOfCurrentActivatedField(e)}initializeDatepickerAfterOpen(){this.spotDropModalTeleportationService.afterRenderOnce$(!0).subscribe((()=>{this.initializeDatepicker()}))}initializeDatepicker(e){var t,n=this;this.datePickerInstance?.destroy(),this.datePickerInstance=new W.l(this.injector,this.id,[this.dates.start||"",this.dates.end||""],{mode:"range",showMonths:this.deviceService.isMobile?1:2,inline:!0,onReady:(e,t,n)=>{n.calendarContainer.classList.add("op-datepicker-modal--flatpickr-instance"),this.ensureHoveredSelection(n.calendarContainer)},onChange:(e,t,n)=>{if(this.onTouched(),2===e.length)return this.setDates(e[0],e[1]),this.toggleCurrentActivatedField(),void this.cdRef.detectChanges();const{latestSelectedDateObj:i}=n,o=this.currentlyActivatedDateField;this.handleSingleDateUpdate(o,i),this.cdRef.detectChanges()},onDayCreate:(t=(0,E.A)((function*(t,i,o,r){(0,$.ce)(r,n.ignoreNonWorkingDays,yield n.datePickerInstance?.isNonWorkingDay(r.dateObj),n.isDayDisabled(r,e))})),function onDayCreate(e,n,i,o){return t.apply(this,arguments)})},this.flatpickrTarget.nativeElement)}enforceManualChangesToDatepicker(e){let t=(0,$._U)(this.dates.start||""),n=(0,$._U)(this.dates.end||"");t&&n&&(t>n&&this.isStateOfCurrentActivatedField("start")?(n=t,this.dates.end=this.timezoneService.formattedISODate(n)):n<t&&this.isStateOfCurrentActivatedField("end")&&(t=n,this.dates.start=this.timezoneService.formattedISODate(t)));const i=[t,n];(0,$._W)(i,this.datePickerInstance,e)}setDates(e,t){this.dates.start=this.timezoneService.formattedISODate(e),this.dates.end=this.timezoneService.formattedISODate(t)}handleSingleDateUpdate(e,t){"duration"!==e&&(this.replaceDatesWithNewSelection(e,t),this.enforceManualChangesToDatepicker(t))}replaceDatesWithNewSelection(e,t){const n=(0,$._U)(this.dates.start||""),i=(0,$._U)(this.dates.end||"");if(t<n)"start"===e?this.applyNewDates([t]):this.applyNewDates(["",t]);else if(t>i)"end"===e?this.applyNewDates([n,t]):this.applyNewDates([t]);else if((0,$.iH)(t,n)||(0,$.iH)(t,i))this.applyNewDates([t,t]);else{const o="start"===e?[t,i]:[n,t];this.applyNewDates(o)}}applyNewDates([e,t]){this.dates.start=e?this.timezoneService.formattedISODate(e):null,this.dates.end=t?this.timezoneService.formattedISODate(t):null,(0,$._W)([e,t],this.datePickerInstance)}get initialActivatedField(){switch(this.fieldName){case"startDate":return"start";case"dueDate":return"end";case"duration":return"duration";default:return this.dates.start&&!this.dates.end?"end":"start"}}isDayDisabled(e,t){return!!t&&e.dateObj<=t}debouncedInput(e,t){return e.pipe(this.untilDestroyed(),(0,q.p)((e=>e!==this.dates[t])),(0,L.B)(500),(0,q.p)((e=>(0,$.BY)(e))),(0,H.T)((e=>""===e?null:(0,$._U)(e))),(0,H.T)((e=>[t,e])))}ensureHoveredSelection(e){(0,Y.R)(e,"mouseenter").pipe(this.untilDestroyed()).subscribe((()=>e.classList.remove("flatpickr-container-suppress-hover"))),(0,Y.R)(e,"mouseleave").pipe(this.untilDestroyed(),(0,q.p)((()=>!(this.dates.start&&this.dates.end)))).subscribe((()=>e.classList.add("flatpickr-container-suppress-hover")))}writeValue(e){const t=(e||[]).map((e=>this.timezoneService.formattedISODate(e)));t[0]===this.dates.start&&t[1]===this.dates.end||(this.value=t,this.dates.start=this.value[0],this.dates.end=this.value[1])}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}static{this.ɵfac=function OpMultiDatePickerComponent_Factory(e){return new(e||OpMultiDatePickerComponent)(A.rXU(A.zZn),A.rXU(A.gRc),A.rXU(V.W),A.rXU(B.D),A.rXU(z.g),A.rXU(Q.I),A.rXU(K.k),A.rXU(J.A))}}static{this.ɵcmp=A.VBU({type:OpMultiDatePickerComponent,selectors:[["op-multi-date-picker"]],viewQuery:function OpMultiDatePickerComponent_Query(e,t){if(1&e&&(A.GBs(ne,5),A.GBs(ie,5)),2&e){let e;A.mGM(e=A.lsd())&&(t.modalContainer=e.first),A.mGM(e=A.lsd())&&(t.flatpickrTarget=e.first)}},inputs:{id:"id",name:"name",fieldName:"fieldName",value:"value",applyLabel:"applyLabel",opened:"opened"},outputs:{valueChange:"valueChange",closed:"closed"},features:[A.Jv_([{provide:i.kq,useExisting:(0,A.Rfq)((()=>OpMultiDatePickerComponent)),multi:!0}]),A.Vt3],decls:18,vars:26,consts:[["flatpickrTarget",""],["data-test-selector","op-multi-date-picker",3,"closed","opened"],["slot","trigger","type","text",1,"spot-input",3,"click","focus","id","value"],["slot","body","data-test-selector","op-datepicker-modal","tabindex","0","cdkFocusInitial","","cdkTrapFocus","",1,"op-datepicker-modal","op-datepicker-modal_wide",3,"submit","cdkTrapFocusAutoCapture"],[1,"spot-container","op-datepicker-modal--stretch-content"],[1,"op-datepicker-modal--dates-container"],[3,"label"],["slot","input","name","startDate",1,"op-datepicker-modal--date-field",3,"ngModelChange","focusin","ngClass","ngModel","showClearButton"],["slot","action","type","button",1,"spot-link",3,"click","textContent"],["slot","input","name","endDate",1,"op-datepicker-modal--date-field",3,"ngModelChange","focusin","ngClass","ngModel","showClearButton"],["id","flatpickr-input","hidden",""],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button","data-test-selector","op-datepicker-modal--action",1,"spot-modal--cancel-button","button","spot-action-bar--action",3,"click","textContent"],["type","submit","data-test-selector","op-datepicker-modal--action",1,"button","-primary","spot-action-bar--action",3,"textContent"],["hidden","",3,"id","name","value"]],template:function OpMultiDatePickerComponent_Template(e,t){if(1&e){const e=A.RV6();A.j41(0,"spot-drop-modal",1),A.bIt("closed",(function OpMultiDatePickerComponent_Template_spot_drop_modal_closed_0_listener(){return A.eBV(e),A.Njj(t.close())})),A.j41(1,"input",2),A.bIt("click",(function OpMultiDatePickerComponent_Template_input_click_1_listener(n){return A.eBV(e),A.Njj(t.onInputClick(n))}))("focus",(function OpMultiDatePickerComponent_Template_input_focus_1_listener(){return A.eBV(e),A.Njj(t.opened=!0)})),A.k0s(),A.j41(2,"form",3),A.bIt("submit",(function OpMultiDatePickerComponent_Template_form_submit_2_listener(n){return A.eBV(e),A.Njj(t.save(n))})),A.j41(3,"div",4)(4,"div",5)(5,"spot-form-field",6)(6,"spot-text-field",7),A.bIt("ngModelChange",(function OpMultiDatePickerComponent_Template_spot_text_field_ngModelChange_6_listener(n){return A.eBV(e),A.Njj(t.startDateChanged$.next(n))}))("focusin",(function OpMultiDatePickerComponent_Template_spot_text_field_focusin_6_listener(){return A.eBV(e),A.Njj(t.setCurrentActivatedField("start"))})),A.k0s(),A.j41(7,"button",8),A.bIt("click",(function OpMultiDatePickerComponent_Template_button_click_7_listener(){return A.eBV(e),A.Njj(t.setToday("start"))})),A.k0s()(),A.j41(8,"spot-form-field",6)(9,"spot-text-field",9),A.bIt("ngModelChange",(function OpMultiDatePickerComponent_Template_spot_text_field_ngModelChange_9_listener(n){return A.eBV(e),A.Njj(t.endDateChanged$.next(n))}))("focusin",(function OpMultiDatePickerComponent_Template_spot_text_field_focusin_9_listener(){return A.eBV(e),A.Njj(t.setCurrentActivatedField("end"))})),A.k0s(),A.j41(10,"button",8),A.bIt("click",(function OpMultiDatePickerComponent_Template_button_click_10_listener(){return A.eBV(e),A.Njj(t.setToday("end"))})),A.k0s()()(),A.nrm(11,"input",10,0),A.k0s(),A.j41(13,"div",11)(14,"div",12)(15,"button",13),A.bIt("click",(function OpMultiDatePickerComponent_Template_button_click_15_listener(){return A.eBV(e),A.Njj(t.close())})),A.k0s(),A.nrm(16,"button",14),A.k0s()()()(),A.nrm(17,"input",15)}2&e&&(A.Y8G("opened",t.opened),A.R7$(),A.Y8G("id",t.id)("value",t.datesString),A.BMQ("data-value",t.value),A.R7$(),A.Y8G("cdkTrapFocusAutoCapture",!0),A.R7$(3),A.Y8G("label",t.text.startDate),A.R7$(),A.Y8G("ngClass",A.eq3(22,_c2,t.showFieldAsActive("start")))("ngModel",t.dates.start)("showClearButton","start"===t.currentlyActivatedDateField),A.BMQ("data-qa-highlighted",t.showFieldAsActive("start")||void 0),A.R7$(),A.Y8G("textContent",t.text.today),A.R7$(),A.Y8G("label",t.text.endDate),A.R7$(),A.Y8G("ngClass",A.eq3(24,_c2,t.showFieldAsActive("end")))("ngModel",t.dates.end)("showClearButton","end"===t.currentlyActivatedDateField),A.BMQ("data-qa-highlighted",t.showFieldAsActive("end")||void 0),A.R7$(),A.Y8G("textContent",t.text.today),A.R7$(5),A.Y8G("textContent",t.text.cancel),A.R7$(),A.Y8G("textContent",t.applyLabel),A.R7$(),A.Y8G("id",t.id)("name",t.name)("value",t.value))},dependencies:[c.YU,i.qT,i.BC,i.cb,i.vS,i.cV,Z.l,ee.m,te.U,o.kB],styles:[".op-datepicker-modal{display:flex;flex-direction:column;height:100%}@media (min-width: 1000px) and (min-height: 500px){.op-datepicker-modal{height:unset;min-height:475px;width:100vw;max-width:320px}.op-datepicker-modal_wide{max-width:600px}}.op-datepicker-modal--banner{margin-bottom:1rem}.op-datepicker-modal--banner:empty{visibility:hidden}.op-datepicker-modal--toggle-actions-container{display:grid;grid-template-columns:auto auto 1fr;grid-column-gap:2rem;margin:0 1rem}.op-datepicker-modal--toggle-actions-container .spot-form-field--input:has(spot-switch){margin-bottom:0!important}.op-datepicker-modal--dates-container{display:grid;grid-template-columns:1fr 1fr 150px;grid-gap:1rem;margin:1rem 1rem 0}.op-datepicker-modal--date-field_current,.op-datepicker-modal--date-field_current:hover{border:2px solid var(--control-checked-color);margin:-1px}.op-datepicker-modal--date-container{display:inline-grid}.op-datepicker-modal--hidden-link{visibility:hidden}.op-datepicker-modal--flatpickr-instance.inline{margin:.5rem auto 0!important;overflow:hidden}.op-datepicker-modal--stretch-content{flex-grow:1;flex-shrink:1;overflow-y:auto}.op-datepicker-modal--stretch-content.spot-container{margin-top:0}@media screen and (max-width: 543px){.op-datepicker-modal{width:calc(100vw - 2rem);margin-bottom:0}.op-datepicker-modal--flatpickr-instance{align-self:center}.op-datepicker-modal--dates-container{grid-template-columns:1fr 1fr}.op-datepicker-modal--toggle-actions-container{display:grid;grid-template-columns:1fr;grid-row-gap:1rem}.op-datepicker-modal--date-form:only-child{grid-column:1/3}}.flatpickr-wrapper{width:100%}\n"],encapsulation:2,changeDetection:0})}}var oe=n(82757),re=n(7086),se=n(94193),ae=n(68481),le=n(79727),ce=n(24557),pe=n(94221),de=n(67e3),ue=n(88056),he=n(83365),me=n(13469),ge=n(89075),_e=n(81151),fe=n(44197),be=n(95695),ke=n(24398),ve=n(86748),Ce=n(94564),ye=n(57678),we=n(51132);let Te=class ViewsStore extends ye.D_{constructor(){super((0,we.gB)())}};Te=(0,ke.Cg)([(0,ye.g7)({name:"views"}),(0,ke.Sn)("design:paramtypes",[])],Te);var Se=n(94529),je=n(1758);let Pe=class ViewsResourceService extends Se.L{createStore(){return new Te}basePath(){return this.apiV3Service.views.path}static{this.ɵfac=(()=>{let e;return function ViewsResourceService_Factory(t){return(e||(e=A.xGo(ViewsResourceService)))(t||ViewsResourceService)}})()}static{this.ɵprov=A.jDH({token:ViewsResourceService,factory:ViewsResourceService.ɵfac})}};(0,ke.Cg)([(0,je.O)(),(0,ke.Sn)("design:type",Ce.d)],Pe.prototype,"actions$",void 0),Pe=(0,ke.Cg)([ve.qm],Pe);var Ie=n(83786),xe=n(21452),Re=n(87997),Fe=n(34342),Me=n(8620),Oe=n(24972),De=n(6811),Ge=n(91784),Ee=n(72825),Ae=n(17564),Ve=n(58192);class OpBasicDatePickerModule{constructor(e){this.injector=e}static{this.ɵfac=function OpBasicDatePickerModule_Factory(e){return new(e||OpBasicDatePickerModule)(A.KVO(A.zZn))}}static{this.ɵmod=A.$C({type:OpBasicDatePickerModule})}static{this.ɵinj=A.G2t({providers:[V.W],imports:[i.YN,i.X1,c.MD]})}}("undefined"==typeof ngJitMode||ngJitMode)&&A.Obh(OpBasicDatePickerModule,{declarations:[Ae.s,Ve.r],imports:[i.YN,i.X1,c.MD],exports:[Ae.s,Ve.r]});var $e=n(82028);class OpDatePickerModule{static{this.ɵfac=function OpDatePickerModule_Factory(e){return new(e||OpDatePickerModule)}}static{this.ɵmod=A.$C({type:OpDatePickerModule})}static{this.ɵinj=A.G2t({providers:[V.W],imports:[i.YN,i.X1,c.MD,o.Pd,m.m,OpBasicDatePickerModule,xe.p,OpBasicDatePickerModule]})}}("undefined"==typeof ngJitMode||ngJitMode)&&A.Obh(OpDatePickerModule,{declarations:[De.J,Ge.p,Ee.X,Fe.c,Me.D,Oe.k,$e.U],imports:[i.YN,i.X1,c.MD,o.Pd,m.m,OpBasicDatePickerModule,xe.p],exports:[Fe.c,Me.D,Oe.k,OpBasicDatePickerModule,$e.U]});var Be=n(62046);class OpSharedModule{constructor(e){!function bootstrapModule(e){const t=e.get(v.c),n=e.get(r.ok);window.ErrorReporter.addHook((()=>({project:t.identifier||"global","router state":n.current.name||"unknown"})))}(e)}static{this.ɵfac=function OpSharedModule_Factory(e){return new(e||OpSharedModule)(A.KVO(A.zZn))}}static{this.ɵmod=A.$C({type:OpSharedModule})}static{this.ɵinj=A.G2t({providers:[M.g,F.M,Pe],imports:[h.UIRouterModule,c.MD,i.YN,m.m,o.Pd,l.jc,a.ad,d.d0,g.l,i.YN,s.MQ,p.l,T.W,Ie.Q,_.E,xe.p,S.j,f.o,b.f,Re.E,OpDatePickerModule,h.UIRouterModule,c.MD,i.YN,l.jc,a.ad,o.Pd,f.o,b.f,i.YN,p.l,T.W,_.E,Ie.Q,m.m,OpDatePickerModule,S.j,u.oW]})}}("undefined"==typeof ngJitMode||ngJitMode)&&A.Obh(OpSharedModule,{declarations:[oe.j,G.d,re.S,D.U,w.n,k.W,O._,ae.x,se.a,R.w,C.t,y.y,le.h,ce.JS,pe.f,ue.r,de.L,he.f,j.l,P.U,I.E,x.t,me.S,ge.c,_e.Q,fe.K,be.k,OpMultiDatePickerComponent,Be.J],imports:[h.UIRouterModule,c.MD,i.YN,m.m,o.Pd,l.jc,a.ad,d.d0,g.l,i.YN,s.MQ,p.l,T.W,Ie.Q,_.E,xe.p,S.j,f.o,b.f,Re.E,OpDatePickerModule],exports:[h.UIRouterModule,c.MD,i.YN,l.jc,a.ad,o.Pd,f.o,b.f,i.YN,p.l,T.W,_.E,Ie.Q,m.m,OpDatePickerModule,S.j,D.U,oe.j,G.d,re.S,D.U,se.a,R.w,C.t,y.y,w.n,k.W,le.h,ce.JS,j.l,P.U,I.E,u.oW,me.S,ge.c,_e.Q,fe.K,OpMultiDatePickerComponent,be.k]})},28690:(e,t,n)=>{"use strict";n.d(t,{_:()=>SpotBreadcrumbsComponent});var i=n(68559),o=n(60316);const _c0=(e,t,n)=>({"spot-breadcrumbs--crumb_root":e,"spot-breadcrumbs--crumb_parent":t,"spot-breadcrumbs--crumb_grandparent":n});function SpotBreadcrumbsComponent_ng_container_0_div_1_span_2_Template(e,t){if(1&e&&i.nrm(0,"span"),2&e){const e=i.XpG(2).$implicit;i.ZvI("spot-icon spot-icon_",e.icon,"")}}function SpotBreadcrumbsComponent_ng_container_0_div_1_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",4)(1,"button",5),i.bIt("click",(function SpotBreadcrumbsComponent_ng_container_0_div_1_Template_button_click_1_listener(){i.eBV(e);const t=i.XpG().$implicit;return i.Njj(t.navigate())})),i.DNE(2,SpotBreadcrumbsComponent_ng_container_0_div_1_span_2_Template,1,3,"span",6),i.nrm(3,"span",7)(4,"span",8),i.k0s(),i.nrm(5,"span",9),i.k0s()}if(2&e){const e=i.XpG(),t=e.$implicit,n=e.index,o=e.first,r=i.XpG();i.Y8G("ngClass",i.sMw(4,_c0,o,n===r.content.crumbs.length-2,n===r.content.crumbs.length-3)),i.R7$(),i.Y8G("title",t.text),i.R7$(),i.Y8G("ngIf",t.icon),i.R7$(),i.Y8G("textContent",t.text)}}function SpotBreadcrumbsComponent_ng_container_0_div_2_Template(e,t){1&e&&(i.j41(0,"div",10),i.nrm(1,"span",9),i.k0s())}function SpotBreadcrumbsComponent_ng_container_0_div_3_span_1_Template(e,t){if(1&e&&i.nrm(0,"span"),2&e){const e=i.XpG(2).$implicit;i.ZvI("spot-icon spot-icon_",e.icon,"")}}function SpotBreadcrumbsComponent_ng_container_0_div_3_Template(e,t){if(1&e&&(i.j41(0,"div",11),i.DNE(1,SpotBreadcrumbsComponent_ng_container_0_div_3_span_1_Template,1,3,"span",6),i.nrm(2,"span",7),i.k0s()),2&e){const e=i.XpG().$implicit;i.R7$(),i.Y8G("ngIf",e.icon),i.R7$(),i.Y8G("textContent",e.text)}}function SpotBreadcrumbsComponent_ng_container_0_Template(e,t){if(1&e&&(i.qex(0),i.DNE(1,SpotBreadcrumbsComponent_ng_container_0_div_1_Template,6,8,"div",1)(2,SpotBreadcrumbsComponent_ng_container_0_div_2_Template,2,0,"div",2)(3,SpotBreadcrumbsComponent_ng_container_0_div_3_Template,3,2,"div",3),i.bVm()),2&e){const e=t.index,n=t.last,o=t.first,r=i.XpG();i.R7$(),i.Y8G("ngIf",o&&!n||e===r.content.crumbs.length-2||e===r.content.crumbs.length-3),i.R7$(),i.Y8G("ngIf",1===e&&r.content.crumbs.length>4),i.R7$(),i.Y8G("ngIf",n)}}class SpotBreadcrumbsComponent{constructor(){this.className=!0}static{this.ɵfac=function SpotBreadcrumbsComponent_Factory(e){return new(e||SpotBreadcrumbsComponent)}}static{this.ɵcmp=i.VBU({type:SpotBreadcrumbsComponent,selectors:[["spot-breadcrumbs"]],hostVars:2,hostBindings:function SpotBreadcrumbsComponent_HostBindings(e,t){2&e&&i.AVh("spot-breadcrumbs",t.className)},inputs:{content:"content"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],["class","spot-breadcrumbs--crumb","data-test-selector","op-breadcrumb",3,"ngClass",4,"ngIf"],["class","spot-breadcrumbs--crumb spot-breadcrumbs--crumb_collapsed",4,"ngIf"],["class","spot-breadcrumbs--crumb spot-breadcrumbs--crumb_last","data-test-selector","op-breadcrumb",4,"ngIf"],["data-test-selector","op-breadcrumb",1,"spot-breadcrumbs--crumb",3,"ngClass"],["type","button",1,"spot-link","spot-breadcrumbs--crumb-action-item",3,"click","title"],[3,"class",4,"ngIf"],[1,"spot-breadcrumbs--crumb-action-item-text",3,"textContent"],[1,"spot-breadcrumbs--crumb-action-item-dots"],[1,"spot-breadcrumbs--crumb-divider","spot-icon","spot-icon_arrow-right5"],[1,"spot-breadcrumbs--crumb","spot-breadcrumbs--crumb_collapsed"],["data-test-selector","op-breadcrumb",1,"spot-breadcrumbs--crumb","spot-breadcrumbs--crumb_last"]],template:function SpotBreadcrumbsComponent_Template(e,t){1&e&&i.DNE(0,SpotBreadcrumbsComponent_ng_container_0_Template,4,3,"ng-container",0),2&e&&i.Y8G("ngForOf",t.content.crumbs)},dependencies:[o.YU,o.Sq,o.bT],encapsulation:2,changeDetection:0})}}},50130:(e,t,n)=>{"use strict";n.d(t,{h:()=>SpotCheckboxComponent});var i=n(68559),o=n(34456);const r=["input"];class SpotCheckboxComponent{constructor(e){this.cdRef=e,this.className=!0,this.tabindex=0,this.disabled=!1,this.name="spot-checkbox-"+ +new Date,this.checked=!1,this.checkedChange=new i.bkB,this.onChange=e=>{},this.onTouched=e=>{}}onStateChange(){const e=this.input.nativeElement.checked;this.checkedChange.emit(e),this.onChange(e),this.onTouched(e)}writeValue(e){setTimeout((()=>{this.input.nativeElement.indeterminate=null===e,this.checked=!!e,this.cdRef.detectChanges()}))}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}static{this.ɵfac=function SpotCheckboxComponent_Factory(e){return new(e||SpotCheckboxComponent)(i.rXU(i.gRc))}}static{this.ɵcmp=i.VBU({type:SpotCheckboxComponent,selectors:[["spot-checkbox"]],viewQuery:function SpotCheckboxComponent_Query(e,t){if(1&e&&i.GBs(r,5),2&e){let e;i.mGM(e=i.lsd())&&(t.input=e.first)}},hostVars:2,hostBindings:function SpotCheckboxComponent_HostBindings(e,t){2&e&&i.AVh("spot-checkbox",t.className)},inputs:{tabindex:"tabindex",disabled:"disabled",name:"name",checked:"checked"},outputs:{checkedChange:"checkedChange"},features:[i.Jv_([{provide:o.kq,useExisting:(0,i.Rfq)((()=>SpotCheckboxComponent)),multi:!0}])],decls:3,vars:4,consts:[["input",""],["type","checkbox",1,"spot-checkbox--input",3,"change","disabled","checked","tabindex"],[1,"spot-checkbox--fake"]],template:function SpotCheckboxComponent_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"input",1,0),i.bIt("change",(function SpotCheckboxComponent_Template_input_change_0_listener(){return i.eBV(e),i.Njj(t.onStateChange())})),i.k0s(),i.nrm(2,"span",2)}2&e&&(i.Y8G("disabled",t.disabled)("checked",t.checked)("tabindex",t.tabindex),i.BMQ("name",t.name))},encapsulation:2,changeDetection:0})}}},21451:(e,t,n)=>{"use strict";n.d(t,{Q:()=>SpotDropModalPortalComponent});var i=n(21863),o=n(99496),r=n(68559),s=n(60316);function SpotDropModalPortalComponent_ng_container_0_Template(e,t){1&e&&r.eu8(0)}class SpotDropModalPortalComponent extends o.p{constructor(e,t,n){super(),this.cdRef=e,this.template$=t,this.elementRef=n,this.className=!0,this.template=null}ngOnInit(){this.template$.templateRef$.pipe(this.untilDestroyed()).subscribe((e=>{this.template=e,this.cdRef.detectChanges(),this.template$.hasRendered$.next(!!this.elementRef.nativeElement.children.length)}))}static{this.ɵfac=function SpotDropModalPortalComponent_Factory(e){return new(e||SpotDropModalPortalComponent)(r.rXU(r.gRc),r.rXU(i.A),r.rXU(r.aKT))}}static{this.ɵcmp=r.VBU({type:SpotDropModalPortalComponent,selectors:[["opce-spot-drop-modal-portal"]],hostVars:2,hostBindings:function SpotDropModalPortalComponent_HostBindings(e,t){2&e&&r.AVh("spot-drop-modal-portal",t.className)},features:[r.Vt3],decls:1,vars:1,consts:[[4,"ngTemplateOutlet"]],template:function SpotDropModalPortalComponent_Template(e,t){1&e&&r.DNE(0,SpotDropModalPortalComponent_ng_container_0_Template,1,0,"ng-container",0),2&e&&r.Y8G("ngTemplateOutlet",t.template)},dependencies:[s.T3],encapsulation:2,changeDetection:0})}}},21863:(e,t,n)=>{"use strict";n.d(t,{A:()=>SpotDropModalTeleportationService});var i=n(75797),o=n(84205),r=n(91817),s=n(51567),a=n(64334),l=n(68559);class SpotDropModalTeleportationService{constructor(){this.templateRef$=new i.t(null),this.hasRendered$=new o.B,this.hasRenderedFiltered$=this.hasRendered$.pipe((0,r.F)())}afterRenderOnce$(e=!0){return this.hasRenderedFiltered$.pipe((0,s.p)((t=>t===e)),(0,a.s)(1))}activate(e){this.templateRef$.next(e)}clear(){this.templateRef$.next(null)}static{this.ɵfac=function SpotDropModalTeleportationService_Factory(e){return new(e||SpotDropModalTeleportationService)}}static{this.ɵprov=l.jDH({token:SpotDropModalTeleportationService,factory:SpotDropModalTeleportationService.ɵfac,providedIn:"root"})}}},93338:(e,t,n)=>{"use strict";n.d(t,{m:()=>SpotDropModalComponent});var i=n(89204),o=n(68559),r=n(41670),s=n(61816),a=n(64),l=n(21863),c=n(51567),p=n(64334),d=n(46227),u=n(18278),h=n(60316),m=n(41497);const g=["anchor"],_=["body"],f=["focusGrabber"],b=[[["","slot","trigger"]],[["","slot","body"]]],k=["[slot=trigger]","[slot=body]"],_c5=()=>["spot-drop-modal--body","spot-container"];function SpotDropModalComponent_ng_template_3_div_0_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",5,2),o.bIt("click",(function SpotDropModalComponent_ng_template_3_div_0_Template_div_click_0_listener(t){o.eBV(e);const n=o.XpG(2);return o.Njj(n.onBodyClick(t))})),o.SdG(2,1),o.j41(3,"button",6),o.bIt("click",(function SpotDropModalComponent_ng_template_3_div_0_Template_button_click_3_listener(){o.eBV(e);const t=o.XpG(2);return o.Njj(t.close())})),o.nrm(4,"span",7),o.k0s()()}if(2&e){const e=o.XpG(2);o.AVh("spot-drop-modal--body_not-full-screen",e.notFullscreen),o.Y8G("ngClass",o.lJ4(5,_c5)),o.BMQ("id",e.id),o.R7$(3),o.BMQ("aria-label",e.text.close)}}function SpotDropModalComponent_ng_template_3_Template(e,t){if(1&e&&o.DNE(0,SpotDropModalComponent_ng_template_3_div_0_Template,5,6,"div",4),2&e){const e=o.XpG();o.Y8G("ngIf",e.opened)}}class SpotDropModalComponent{set opened(e){this._opened!==e&&(e?this.open():this.close())}get opened(){return this._opened}constructor(e,t,n,i){this.i18n=e,this.elementRef=t,this.cdRef=n,this.teleportationService=i,this.className=!0,this.allowRepositioning=!0,this.notFullscreen=!1,this.alignment="bottom-start",this._opened=!1,this.closed=new o.bkB,this.id=`drop-modal-${Math.round(1e4*Math.random())}`,this.text={close:this.i18n.t("js.spot.drop_modal.close"),focus_grab:this.i18n.t("js.spot.drop_modal.focus_grab")},this.onGlobalClick=this.close.bind(this),this.escapeCallback=e=>{e.keyCode===r.c.ESCAPE&&this.close()},this.onEscape=(0,d.debounce)(this.escapeCallback.bind(this),10),this.onResize=(0,d.debounce)(this.resizeCallback.bind(this),10),this.updateAppHeight=()=>{document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)}}open(){var e=this;this._opened=!0,this.updateAppHeight(),this.teleportationService.hasRenderedFiltered$.pipe((0,c.p)((e=>!!e)),(0,p.s)(1)).subscribe((()=>{this.cdRef.detectChanges();const t=this.elementRef.nativeElement,n=this.anchor.nativeElement;this.cleanupFloatingUI=(0,u.ll)(t,n,(0,i.A)((function*(){const{x:i,y:o}=yield(0,u.rD)(t,n,{placement:e.alignment,middleware:e.allowRepositioning?[(0,u.UU)({mainAxis:!0,crossAxis:!0,fallbackAxisSideDirection:"start"}),(0,u.BN)({limiter:(0,u.ER)()})]:[]});Object.assign(n.style,{left:`${i}px`,top:`${o}px`})}))),setTimeout((()=>{document.body.addEventListener("click",this.onGlobalClick),document.body.addEventListener("keydown",this.onEscape),window.addEventListener("resize",this.onResize),window.addEventListener("orientationchange",this.onResize);const e=document.querySelectorAll("[data-modal-focus-catcher-container='true']")[0];e?(0,a.R)(e)[0]?.focus():(0,a.R)(document.querySelector(".spot-drop-modal-portal"))[1]?.focus()}))})),this.teleportationService.activate(this.body)}close(){this._opened=!1,this.closed.emit(),document.body.removeEventListener("click",this.onGlobalClick),document.body.removeEventListener("keydown",this.onEscape),window.removeEventListener("resize",this.onResize),window.removeEventListener("orientationchange",this.onResize),this.teleportationService.clear(),this.cdRef.detectChanges(),this.focusGrabber.nativeElement.focus()}ngOnDestroy(){this.opened&&this.teleportationService.clear(),document.body.removeEventListener("click",this.onGlobalClick),document.body.removeEventListener("keydown",this.onEscape),window.removeEventListener("resize",this.onResize),window.removeEventListener("orientationchange",this.onResize),this.cleanupFloatingUI?.()}onBodyClick(e){e.stopPropagation()}resizeCallback(){this.updateAppHeight()}static{this.ɵfac=function SpotDropModalComponent_Factory(e){return new(e||SpotDropModalComponent)(o.rXU(s.W),o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(l.A))}}static{this.ɵcmp=o.VBU({type:SpotDropModalComponent,selectors:[["spot-drop-modal"]],viewQuery:function SpotDropModalComponent_Query(e,t){if(1&e&&(o.GBs(g,5),o.GBs(_,5),o.GBs(f,5)),2&e){let e;o.mGM(e=o.lsd())&&(t.anchor=e.first),o.mGM(e=o.lsd())&&(t.body=e.first),o.mGM(e=o.lsd())&&(t.focusGrabber=e.first)}},hostVars:4,hostBindings:function SpotDropModalComponent_HostBindings(e,t){2&e&&o.AVh("spot-drop-modal",t.className)("spot-drop-modal_opened",t.opened)},inputs:{allowRepositioning:"allowRepositioning",notFullscreen:"notFullscreen",alignment:"alignment",opened:"opened"},outputs:{closed:"closed"},ngContentSelectors:k,decls:5,vars:1,consts:[["focusGrabber",""],["body",""],["anchor",""],["tabindex","0"],["cdkTrapFocus","","tabindex","0",3,"ngClass","spot-drop-modal--body_not-full-screen","click",4,"ngIf"],["cdkTrapFocus","","tabindex","0",3,"click","ngClass"],["type","button",1,"spot-drop-modal--close-button","spot-button",3,"click"],[1,"spot-icon","spot-icon_close"]],template:function SpotDropModalComponent_Template(e,t){1&e&&(o.NAR(b),o.SdG(0),o.nrm(1,"span",3,0),o.DNE(3,SpotDropModalComponent_ng_template_3_Template,1,1,"ng-template",null,1,o.C5r)),2&e&&(o.R7$(),o.BMQ("aria-label",t.text.focus_grab))},dependencies:[h.YU,h.bT,m.kB],encapsulation:2,changeDetection:0})}}},40169:(e,t,n)=>{"use strict";n.d(t,{x:()=>SpotFormBindingDirective});var i=n(68559),o=n(34456);const r={provide:o.vO,useExisting:(0,i.Rfq)((()=>SpotFormBindingDirective))};class SpotFormBindingDirective extends o.vO{get control(){return this.form}viewToModelUpdate(){}static{this.ɵfac=(()=>{let e;return function SpotFormBindingDirective_Factory(t){return(e||(e=i.xGo(SpotFormBindingDirective)))(t||SpotFormBindingDirective)}})()}static{this.ɵdir=i.FsC({type:SpotFormBindingDirective,selectors:[["","spotFormBinding",""]],inputs:{form:[i.Mj6.None,"spotFormBinding","form"]},exportAs:["ngForm"],features:[i.Jv_([r]),i.Vt3]})}}},88294:(e,t,n)=>{"use strict";n.d(t,{U:()=>SpotFormFieldComponent});var i=n(34456),o=n(61816),r=n(68559),s=n(60316);const a=[[["","slot","help-text"]],[["","slot","description"]],[["","slot","action"]],[["","slot","errors"]],[["","slot","input"]]],l=["[slot=help-text]","[slot=description]","[slot=action]","[slot=errors]","[slot=input]"];function SpotFormFieldComponent_ng_container_0_span_3_Template(e,t){if(1&e&&(r.j41(0,"span",9),r.EFF(1),r.k0s()),2&e){const e=r.XpG(2);r.R7$(),r.SpI(" ",e.text.invalid," ")}}function SpotFormFieldComponent_ng_container_0_span_5_Template(e,t){1&e&&(r.j41(0,"span",10),r.EFF(1,"*"),r.k0s())}function SpotFormFieldComponent_ng_container_0_ng_container_7_ng_container_1_Template(e,t){1&e&&r.eu8(0)}function SpotFormFieldComponent_ng_container_0_ng_container_7_Template(e,t){if(1&e&&(r.qex(0),r.DNE(1,SpotFormFieldComponent_ng_container_0_ng_container_7_ng_container_1_Template,1,0,"ng-container",11),r.bVm()),2&e){r.XpG(2);const e=r.sdS(2);r.R7$(),r.Y8G("ngTemplateOutlet",e)}}function SpotFormFieldComponent_ng_container_0_ng_container_8_ng_container_1_Template(e,t){1&e&&r.eu8(0)}function SpotFormFieldComponent_ng_container_0_ng_container_8_Template(e,t){if(1&e&&(r.qex(0),r.DNE(1,SpotFormFieldComponent_ng_container_0_ng_container_8_ng_container_1_Template,1,0,"ng-container",11),r.bVm()),2&e){r.XpG(2);const e=r.sdS(2);r.R7$(),r.Y8G("ngTemplateOutlet",e)}}function SpotFormFieldComponent_ng_container_0_div_11_Template(e,t){if(1&e&&(r.j41(0,"div",12),r.SdG(1,3),r.k0s()),2&e){const e=r.XpG(2);r.Y8G("id",e.errorsID)}}function SpotFormFieldComponent_ng_container_0_Template(e,t){if(1&e&&(r.qex(0),r.j41(1,"label",2)(2,"div",3),r.DNE(3,SpotFormFieldComponent_ng_container_0_span_3_Template,2,1,"span",4),r.EFF(4),r.DNE(5,SpotFormFieldComponent_ng_container_0_span_5_Template,2,0,"span",5),r.SdG(6),r.k0s(),r.DNE(7,SpotFormFieldComponent_ng_container_0_ng_container_7_Template,2,1,"ng-container",1),r.k0s(),r.DNE(8,SpotFormFieldComponent_ng_container_0_ng_container_8_Template,2,1,"ng-container",1),r.j41(9,"div",6),r.SdG(10,1),r.k0s(),r.DNE(11,SpotFormFieldComponent_ng_container_0_div_11_Template,2,1,"div",7),r.j41(12,"div",8),r.SdG(13,2),r.k0s(),r.bVm()),2&e){const e=r.XpG();r.R7$(3),r.Y8G("ngIf",e.showErrorMessage),r.R7$(),r.SpI(" ",e.label," "),r.R7$(),r.Y8G("ngIf",e.required),r.R7$(2),r.Y8G("ngIf",!e.noWrapLabel),r.R7$(),r.Y8G("ngIf",e.noWrapLabel),r.R7$(),r.Y8G("id",e.descriptionID),r.R7$(2),r.Y8G("ngIf",e.showErrorMessage)}}function SpotFormFieldComponent_ng_template_1_Template(e,t){if(1&e&&(r.j41(0,"div",13),r.SdG(1,4),r.k0s()),2&e){const e=r.XpG();r.BMQ("aria-describedby",e.describedByID)}}class SpotFormFieldComponent{get errorClassName(){return this.showErrorMessage}get errorsID(){return`${this.internalID}-errors`}get descriptionID(){return`${this.internalID}-description`}get describedByID(){return this.showErrorMessage?this.errorsID:this.descriptionID}get formControl(){return this.ngControl?.control||this.control}get showErrorMessage(){return!!this.formControl&&("submit"===this.showValidationErrorOn?this.formControl.invalid&&this._formGroupDirective?.submitted:"blur"===this.showValidationErrorOn?this.formControl.invalid&&this.formControl.touched:"change"===this.showValidationErrorOn&&(this.formControl.invalid&&this.formControl.dirty))}constructor(e,t){this._formGroupDirective=e,this.I18n=t,this.className=!0,this.label="",this.noWrapLabel=!1,this.required=!1,this.showValidationErrorOn="submit",this.hidden=!1,this.internalID="spot-form-field-"+ +new Date,this.text={invalid:this.I18n.t("js.label_invalid")}}static{this.ɵfac=function SpotFormFieldComponent_Factory(e){return new(e||SpotFormFieldComponent)(r.rXU(i.j4,8),r.rXU(o.W))}}static{this.ɵcmp=r.VBU({type:SpotFormFieldComponent,selectors:[["spot-form-field"]],contentQueries:function SpotFormFieldComponent_ContentQueries(e,t,n){if(1&e&&r.wni(n,i.vO,5),2&e){let e;r.mGM(e=r.lsd())&&(t.ngControl=e.first)}},hostVars:4,hostBindings:function SpotFormFieldComponent_HostBindings(e,t){2&e&&r.AVh("spot-form-field",t.className)("spot-form-field_invalid",t.errorClassName)},inputs:{label:"label",noWrapLabel:"noWrapLabel",required:"required",showValidationErrorOn:"showValidationErrorOn",control:"control",hidden:"hidden"},ngContentSelectors:l,decls:3,vars:1,consts:[["inputTemplate",""],[4,"ngIf"],[1,"spot-form-field--label-wrap"],[1,"spot-form-field--label"],["class","hidden-for-sighted",4,"ngIf"],["class","spot-form-field--label-indicator",4,"ngIf"],[1,"spot-form-field--description",3,"id"],["class","spot-form-field--errors",3,"id",4,"ngIf"],[1,"spot-form-field--actions"],[1,"hidden-for-sighted"],[1,"spot-form-field--label-indicator"],[4,"ngTemplateOutlet"],[1,"spot-form-field--errors",3,"id"],[1,"spot-form-field--input"]],template:function SpotFormFieldComponent_Template(e,t){1&e&&(r.NAR(a),r.DNE(0,SpotFormFieldComponent_ng_container_0_Template,14,7,"ng-container",1)(1,SpotFormFieldComponent_ng_template_1_Template,2,1,"ng-template",null,0,r.C5r)),2&e&&r.Y8G("ngIf",!t.hidden)},dependencies:[s.bT,s.T3],encapsulation:2})}}},73704:(e,t,n)=>{"use strict";n.d(t,{P:()=>SpotSelectorFieldComponent});var i=n(34456),o=n(68559),r=n(60316);const s=[[["","slot","input"]],[["","slot","description"]],[["","slot","help-text"]],[["","slot","errors"]]],a=["[slot=input]","[slot=description]","[slot=help-text]","[slot=errors]"],_c2=e=>({"spot-selector-field--label-wrap_reversed":e}),_c3=e=>({"spot-selector-field--input_reversed":e}),_c4=e=>({"spot-selector-field--label_regular":e});function SpotSelectorFieldComponent_ng_container_0_div_4_span_1_Template(e,t){1&e&&(o.j41(0,"span",9),o.EFF(1,"Invalid"),o.k0s())}function SpotSelectorFieldComponent_ng_container_0_div_4_span_3_Template(e,t){1&e&&(o.j41(0,"span",10),o.EFF(1,"*"),o.k0s())}function SpotSelectorFieldComponent_ng_container_0_div_4_Template(e,t){if(1&e&&(o.j41(0,"div",6),o.DNE(1,SpotSelectorFieldComponent_ng_container_0_div_4_span_1_Template,2,0,"span",7),o.EFF(2),o.DNE(3,SpotSelectorFieldComponent_ng_container_0_div_4_span_3_Template,2,0,"span",8),o.SdG(4,2),o.k0s()),2&e){const e=o.XpG(2);o.Y8G("ngClass",o.eq3(4,_c4,"regular"===e.labelWeight)),o.R7$(),o.Y8G("ngIf",e.showErrorMessage),o.R7$(),o.SpI(" ",e.label," "),o.R7$(),o.Y8G("ngIf",e.required)}}function SpotSelectorFieldComponent_ng_container_0_div_7_Template(e,t){if(1&e&&(o.j41(0,"div",11),o.SdG(1,3),o.k0s()),2&e){const e=o.XpG(2);o.Y8G("id",e.errorsID)}}function SpotSelectorFieldComponent_ng_container_0_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"label",1)(2,"div",2),o.SdG(3),o.k0s(),o.DNE(4,SpotSelectorFieldComponent_ng_container_0_div_4_Template,5,6,"div",3),o.k0s(),o.j41(5,"div",4),o.SdG(6,1),o.k0s(),o.DNE(7,SpotSelectorFieldComponent_ng_container_0_div_7_Template,2,1,"div",5),o.bVm()),2&e){const e=o.XpG();o.R7$(),o.Y8G("ngClass",o.eq3(6,_c2,e.reverseLabel)),o.R7$(),o.Y8G("ngClass",o.eq3(8,_c3,e.reverseLabel)),o.BMQ("aria-describedby",e.describedByID),o.R7$(2),o.Y8G("ngIf",e.label),o.R7$(),o.Y8G("id",e.descriptionID),o.R7$(2),o.Y8G("ngIf",e.showErrorMessage)}}class SpotSelectorFieldComponent{get errorClassName(){return this.showErrorMessage}get errorsID(){return`${this.internalID}-errors`}get descriptionID(){return`${this.internalID}-description`}get describedByID(){return this.showErrorMessage?this.errorsID:this.descriptionID}get formControl(){return this.ngControl?.control||this.control}get showErrorMessage(){return!!this.formControl&&("submit"===this.showValidationErrorOn?this.formControl.invalid&&this.formGroupDirective?.submitted:"blur"===this.showValidationErrorOn?this.formControl.invalid&&this.formControl.touched:"change"===this.showValidationErrorOn&&(this.formControl.invalid&&this.formControl.dirty))}constructor(e){this.formGroupDirective=e,this.className=!0,this.classNameCheckbox=!0,this.label="",this.reverseLabel=!1,this.labelWeight="bold",this.required=!1,this.showValidationErrorOn="submit",this.hidden=!1,this.internalID="spot-selector-field-"+ +new Date}static{this.ɵfac=function SpotSelectorFieldComponent_Factory(e){return new(e||SpotSelectorFieldComponent)(o.rXU(i.j4,8))}}static{this.ɵcmp=o.VBU({type:SpotSelectorFieldComponent,selectors:[["spot-selector-field"]],contentQueries:function SpotSelectorFieldComponent_ContentQueries(e,t,n){if(1&e&&o.wni(n,i.vO,5),2&e){let e;o.mGM(e=o.lsd())&&(t.ngControl=e.first)}},hostVars:6,hostBindings:function SpotSelectorFieldComponent_HostBindings(e,t){2&e&&o.AVh("spot-form-field",t.className)("spot-selector-field",t.classNameCheckbox)("spot-form-field_invalid",t.errorClassName)},inputs:{label:"label",reverseLabel:"reverseLabel",labelWeight:"labelWeight",required:"required",showValidationErrorOn:"showValidationErrorOn",control:"control",hidden:"hidden"},ngContentSelectors:a,decls:1,vars:1,consts:[[4,"ngIf"],[1,"spot-form-field--label-wrap","spot-selector-field--label-wrap",3,"ngClass"],[1,"spot-form-field--input","spot-selector-field--input",3,"ngClass"],["class","spot-form-field--label spot-selector-field--label",3,"ngClass",4,"ngIf"],[1,"spot-form-field--description",3,"id"],["class","spot-form-field--errors",3,"id",4,"ngIf"],[1,"spot-form-field--label","spot-selector-field--label",3,"ngClass"],["class","Hidden for sighted",4,"ngIf"],["class","spot-form-field--label-indicator",4,"ngIf"],[1,"Hidden","for","sighted"],[1,"spot-form-field--label-indicator"],[1,"spot-form-field--errors",3,"id"]],template:function SpotSelectorFieldComponent_Template(e,t){1&e&&(o.NAR(s),o.DNE(0,SpotSelectorFieldComponent_ng_container_0_Template,8,10,"ng-container",0)),2&e&&o.Y8G("ngIf",!t.hidden)},dependencies:[r.YU,r.bT],encapsulation:2})}}},75636:(e,t,n)=>{"use strict";n.d(t,{c:()=>SpotSwitchComponent});var i=n(68559),o=n(34456),r=n(37749);const s=["input"];class SpotSwitchComponent{constructor(e,t){this.elementRef=e,this.cdRef=t,this.className=!0,this.tabindex=0,this.disabled=!1,this.name="spot-switch-"+ +new Date,this.checked=!1,this.checkedChange=new i.bkB,this.onChange=e=>{},this.onTouched=e=>{},(0,r.w)(this)}onStateChange(){const e=this.input.nativeElement.checked;this.checkedChange.emit(e),this.onChange(e),this.onTouched(e)}writeValue(e){this.checked=!!e,this.cdRef.markForCheck()}onToggle(e){this.writeValue(e),this.onChange(e),this.onTouched(e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}static{this.ɵfac=function SpotSwitchComponent_Factory(e){return new(e||SpotSwitchComponent)(i.rXU(i.aKT),i.rXU(i.gRc))}}static{this.ɵcmp=i.VBU({type:SpotSwitchComponent,selectors:[["spot-switch"]],viewQuery:function SpotSwitchComponent_Query(e,t){if(1&e&&i.GBs(s,5),2&e){let e;i.mGM(e=i.lsd())&&(t.input=e.first)}},hostVars:2,hostBindings:function SpotSwitchComponent_HostBindings(e,t){2&e&&i.AVh("spot-switch",t.className)},inputs:{tabindex:"tabindex",disabled:"disabled",name:"name",checked:"checked"},outputs:{checkedChange:"checkedChange"},features:[i.Jv_([{provide:o.kq,useExisting:(0,i.Rfq)((()=>SpotSwitchComponent)),multi:!0}])],decls:3,vars:6,consts:[["input",""],["type","checkbox",1,"spot-switch--input",3,"ngModelChange","disabled","tabindex","ngModel","value"],["data-test-selector","spot-switch-handle",1,"spot-switch--fake"]],template:function SpotSwitchComponent_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"input",1,0),i.bIt("ngModelChange",(function SpotSwitchComponent_Template_input_ngModelChange_0_listener(n){return i.eBV(e),i.Njj(t.onToggle(n))})),i.k0s(),i.nrm(2,"span",2)}2&e&&(i.Y8G("disabled",t.disabled)("tabindex",t.tabindex)("ngModel",t.checked)("value",t.checked),i.BMQ("name",t.name),i.R7$(2),i.BMQ("data-qa-active",t.checked||void 0))},dependencies:[o.Zm,o.BC,o.vS],encapsulation:2,changeDetection:0})}}},18240:(e,t,n)=>{"use strict";n.d(t,{l:()=>SpotTextFieldComponent});var i=n(68559),o=n(34456),r=n(60316);const s=["input"],a=[[["","slot","before"]],[["","slot","after"]]],l=["[slot=before]","[slot=after]"];function SpotTextFieldComponent_button_3_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"button",3),i.bIt("click",(function SpotTextFieldComponent_button_3_Template_button_click_0_listener(){i.eBV(e);const t=i.XpG();return i.Njj(t.valueChanged(""))})),i.nrm(1,"span",4),i.k0s()}}class SpotTextFieldComponent{onParentClick(){this.input.nativeElement.focus()}valueChanged(e){this.writeValue(e),this.onChange(e),this.onTouched(e)}constructor(e){this.cdRef=e,this.className=!0,this.focused=!1,this.name="spot-text-field-"+ +new Date,this.disabled=!1,this.showClearButton=!0,this.placeholder="",this.value="",this.required=!1,this.inputmode="text",this.inputFocus=new i.bkB,this.inputBlur=new i.bkB,this.onChange=e=>{},this.onTouched=e=>{}}onInputFocus(e){this.focused=!0,this.inputFocus.next(e)}onInputBlur(e){this.focused=!1,this.inputBlur.next(e)}writeValue(e){this.value=e||"",this.cdRef.markForCheck()}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}static{this.ɵfac=function SpotTextFieldComponent_Factory(e){return new(e||SpotTextFieldComponent)(i.rXU(i.gRc))}}static{this.ɵcmp=i.VBU({type:SpotTextFieldComponent,selectors:[["spot-text-field"]],viewQuery:function SpotTextFieldComponent_Query(e,t){if(1&e&&i.GBs(s,5),2&e){let e;i.mGM(e=i.lsd())&&(t.input=e.first)}},hostVars:6,hostBindings:function SpotTextFieldComponent_HostBindings(e,t){1&e&&i.bIt("click",(function SpotTextFieldComponent_click_HostBindingHandler(){return t.onParentClick()})),2&e&&i.AVh("spot-text-field",t.className)("spot-text-field_focused",t.focused)("spot-text-field_disabled",t.disabled)},inputs:{name:"name",disabled:"disabled",showClearButton:"showClearButton",placeholder:"placeholder",value:"value",required:"required",pattern:"pattern",inputmode:"inputmode"},outputs:{inputFocus:"inputFocus",inputBlur:"inputBlur"},features:[i.Jv_([{provide:o.kq,useExisting:(0,i.Rfq)((()=>SpotTextFieldComponent)),multi:!0}])],ngContentSelectors:l,decls:5,vars:8,consts:[["input",""],[1,"spot-text-field--input",3,"ngModelChange","focus","blur","disabled","placeholder","required","ngModel"],["type","button","class","spot-text-field--clear-button",3,"click",4,"ngIf"],["type","button",1,"spot-text-field--clear-button",3,"click"],[1,"spot-icon","spot-icon_close"]],template:function SpotTextFieldComponent_Template(e,t){if(1&e){const e=i.RV6();i.NAR(a),i.SdG(0),i.j41(1,"input",1,0),i.bIt("ngModelChange",(function SpotTextFieldComponent_Template_input_ngModelChange_1_listener(n){return i.eBV(e),i.Njj(t.valueChanged(n))}))("focus",(function SpotTextFieldComponent_Template_input_focus_1_listener(n){return i.eBV(e),i.Njj(t.onInputFocus(n))}))("blur",(function SpotTextFieldComponent_Template_input_blur_1_listener(n){return i.eBV(e),i.Njj(t.onInputBlur(n))})),i.k0s(),i.DNE(3,SpotTextFieldComponent_button_3_Template,2,0,"button",2),i.SdG(4,1)}2&e&&(i.R7$(),i.Y8G("disabled",t.disabled)("placeholder",t.placeholder)("required",t.required)("ngModel",t.value),i.BMQ("name",t.name)("pattern",t.pattern)("inputmode",t.inputmode),i.R7$(2),i.Y8G("ngIf",t.showClearButton&&""!==t.value&&!t.disabled))},dependencies:[o.me,o.BC,o.YS,o.vS,r.bT],encapsulation:2})}}},51832:(e,t,n)=>{"use strict";n.d(t,{k:()=>SpotToggleComponent});var i=n(68559),o=n(34456),r=n(60316);const _c0=(e,t)=>({button:!0,"-disabled":e,"form--field-inline-button":!0,"-active":t,"spot-toggle--button":!0});function SpotToggleComponent_label_0_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"label",1)(1,"input",2),i.bIt("ngModelChange",(function SpotToggleComponent_label_0_Template_input_ngModelChange_1_listener(t){i.eBV(e);const n=i.XpG();return i.Njj(n.onToggle(t))})),i.k0s(),i.EFF(2),i.k0s()}if(2&e){const e=t.$implicit,n=i.XpG();i.Y8G("ngClass",i.l_i(8,_c0,n.disabled,n.value===e.value)),i.BMQ("data-qa-disabled",n.disabled||void 0)("data-qa-active-toggle",n.value===e.value),i.R7$(),i.Y8G("disabled",n.disabled)("name",n.name)("value",e.value)("ngModel",n.value),i.R7$(),i.SpI(" ",e.title,"\n")}}class SpotToggleComponent{constructor(e){this.cdRef=e,this.classNameOld=!0,this.className=!0,this.options=[],this.disabled=!1,this.name="spot-toggle-"+ +new Date,this.valueChange=new i.bkB,this.onChange=e=>{},this.onTouched=e=>{}}writeValue(e){this.value=e,this.cdRef.markForCheck()}onToggle(e){this.writeValue(e),this.onChange(e),this.onTouched(e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}static{this.ɵfac=function SpotToggleComponent_Factory(e){return new(e||SpotToggleComponent)(i.rXU(i.gRc))}}static{this.ɵcmp=i.VBU({type:SpotToggleComponent,selectors:[["spot-toggle"]],hostVars:4,hostBindings:function SpotToggleComponent_HostBindings(e,t){2&e&&i.AVh("form--field-inline-buttons-container",t.classNameOld)("spot-toggle",t.className)},inputs:{options:"options",disabled:"disabled",name:"name",value:"value"},outputs:{valueChange:"valueChange"},features:[i.Jv_([{provide:o.kq,useExisting:(0,i.Rfq)((()=>SpotToggleComponent)),multi:!0}])],decls:1,vars:1,consts:[["data-test-selector","spot-toggle--option",3,"ngClass",4,"ngFor","ngForOf"],["data-test-selector","spot-toggle--option",3,"ngClass"],["type","radio",1,"spot-toggle--option-input",3,"ngModelChange","disabled","name","value","ngModel"]],template:function SpotToggleComponent_Template(e,t){1&e&&i.DNE(0,SpotToggleComponent_label_0_Template,3,11,"label",0),2&e&&i.Y8G("ngForOf",t.options)},dependencies:[o.me,o.Fm,o.BC,o.vS,r.YU,r.Sq],encapsulation:2,changeDetection:0})}}},45906:(e,t,n)=>{"use strict";n.d(t,{H:()=>SpotTooltipComponent});var i=n(11073),o=n(68559),r=n(60316);const s=[[["","slot","trigger"]],[["","slot","body"]]],a=["[slot=trigger]","[slot=body]"],_c2=e=>["spot-tooltip--body","spot-container",e];function SpotTooltipComponent_div_1_Template(e,t){if(1&e&&(o.j41(0,"div",1),o.SdG(1,1),o.k0s()),2&e){const e=o.XpG();o.Y8G("ngClass",o.eq3(1,_c2,e.alignmentClass))}}class SpotTooltipComponent{constructor(){this.className=!0,this.dark=!1,this.disabled=!1,this.alignment=i.A.BottomCenter}get alignmentClass(){return`spot-tooltip--body_${this.alignment}`}static{this.ɵfac=function SpotTooltipComponent_Factory(e){return new(e||SpotTooltipComponent)}}static{this.ɵcmp=o.VBU({type:SpotTooltipComponent,selectors:[["spot-tooltip"]],hostVars:4,hostBindings:function SpotTooltipComponent_HostBindings(e,t){2&e&&o.AVh("spot-tooltip",t.className)("spot-tooltip_dark",t.dark)},inputs:{dark:"dark",disabled:"disabled",alignment:"alignment"},ngContentSelectors:a,decls:2,vars:1,consts:[[3,"ngClass",4,"ngIf"],[3,"ngClass"]],template:function SpotTooltipComponent_Template(e,t){1&e&&(o.NAR(s),o.SdG(0),o.DNE(1,SpotTooltipComponent_div_1_Template,2,3,"div",0)),2&e&&(o.R7$(),o.Y8G("ngIf",!t.disabled))},dependencies:[r.YU,r.bT],encapsulation:2,changeDetection:0})}}},11073:(e,t,n)=>{"use strict";var i;n.d(t,{A:()=>o}),function(e){e.TopLeft="top-left",e.TopCenter="top-center",e.TopRight="top-right",e.RightTop="right-top",e.RightCenter="right-center",e.RightBottom="right-bottom",e.BottomLeft="bottom-left",e.BottomCenter="bottom-center",e.BottomRight="bottom-right",e.LeftTop="left-top",e.LeftCenter="left-center",e.LeftBottom="left-bottom"}(i||(i={}));const o=i},12918:(e,t,n)=>{"use strict";n.d(t,{m:()=>OpSpotModule});var i=n(34456),o=n(60316),r=n(41497),s=n(61816),a=n(50130),l=n(75636),c=n(51832),p=n(18240),d=n(68559);function SpotFilterChipComponent_button_0_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"button",3),d.bIt("click",(function SpotFilterChipComponent_button_0_Template_button_click_0_listener(){d.eBV(e);const t=d.XpG();return d.Njj(t.remove.emit())})),d.nrm(1,"span",4),d.k0s()}if(2&e){const e=d.XpG();d.Y8G("disabled",e.disabled),d.BMQ("aria-label",e.text.remove)}}function SpotFilterChipComponent_span_2_Template(e,t){if(1&e&&d.nrm(0,"span",5),2&e){const e=d.XpG();d.Y8G("ngClass",e.iconClasses)}}class SpotFilterChipComponent{get iconClasses(){return["spot-icon",`spot-icon_${this.icon}`]}constructor(e){this.i18n=e,this.className=!0,this.disabled=!1,this.removable=!0,this.title="",this.icon="",this.remove=new d.bkB,this.text={remove:this.i18n.t("js.spot.filter_chip.remove")}}static{this.ɵfac=function SpotFilterChipComponent_Factory(e){return new(e||SpotFilterChipComponent)(d.rXU(s.W))}}static{this.ɵcmp=d.VBU({type:SpotFilterChipComponent,selectors:[["spot-filter-chip"]],hostVars:4,hostBindings:function SpotFilterChipComponent_HostBindings(e,t){2&e&&d.AVh("spot-filter-chip",t.className)("spot-filter-chip_disabled",t.disabled)},inputs:{disabled:"disabled",removable:"removable",title:"title",icon:"icon"},outputs:{remove:"remove"},decls:4,vars:3,consts:[["class","spot-filter-chip--remove","type","button",3,"disabled","click",4,"ngIf"],[1,"spot-filter-chip--title"],[3,"ngClass",4,"ngIf"],["type","button",1,"spot-filter-chip--remove",3,"click","disabled"],[1,"spot-icon","spot-icon_close"],[3,"ngClass"]],template:function SpotFilterChipComponent_Template(e,t){1&e&&(d.DNE(0,SpotFilterChipComponent_button_0_Template,2,2,"button",0),d.j41(1,"div",1),d.DNE(2,SpotFilterChipComponent_span_2_Template,1,1,"span",2),d.EFF(3),d.k0s()),2&e&&(d.Y8G("ngIf",t.removable),d.R7$(2),d.Y8G("ngIf",t.icon),d.R7$(),d.SpI(" ",t.title,"\n"))},dependencies:[o.YU,o.bT],encapsulation:2})}}var u=n(93338),h=n(45906),m=n(88294),g=n(40169),_=n(28690),f=n(73704),b=n(21451);class OpSpotModule{static{this.ɵfac=function OpSpotModule_Factory(e){return new(e||OpSpotModule)}}static{this.ɵmod=d.$C({type:OpSpotModule})}static{this.ɵinj=d.G2t({providers:[s.W],imports:[i.YN,i.X1,o.MD,r.Pd]})}}("undefined"==typeof ngJitMode||ngJitMode)&&d.Obh(OpSpotModule,{declarations:[_._,a.h,l.c,c.k,p.l,SpotFilterChipComponent,u.m,b.Q,b.Q,m.U,g.x,h.H,f.P],imports:[i.YN,i.X1,o.MD,r.Pd],exports:[_._,a.h,l.c,c.k,p.l,SpotFilterChipComponent,u.m,b.Q,b.Q,m.U,g.x,h.H,f.P]})},45312:(e,t,n)=>{"use strict";n.d(t,{c:()=>i});const i={production:!0}},86449:(e,t,n)=>{"use strict";var i=n(80436),o=n(68559),r=n(41497),s=n(30501),a=n(34456),l=n(11284),c=n(13432),p=n(74785),d=n(34802),u=n(12918);class OpDragScrollDirective{constructor(e){this.elementRef=e}ngOnInit(){const e=jQuery(this.elementRef.nativeElement);let t,n,i=!1;e.on("mousedown",(e=>{setTimeout((()=>{i=!0,t=e.clientX,n=e.clientY}),50,!1)})),e.on("mouseup",(()=>{i=!1})),e.on("mousemove",(o=>{i&&(e.trigger("op:dragscroll",{x:o.clientX-t,y:o.clientY-n}),t=o.clientX,n=o.clientY)}))}static{this.ɵfac=function OpDragScrollDirective_Factory(e){return new(e||OpDragScrollDirective)(o.rXU(o.aKT))}}static{this.ɵdir=o.FsC({type:OpDragScrollDirective,selectors:[["op-drag-scroll"]]})}}var h=n(53156),m=n(6540),g=n(23084),f=n(25827),b=n(65046),k=n(21452),v=n(57654),C=n(50854),y=n(54892),w=n(61816),T=n(86866),S=n(63894),j=n(63077),P=n(60316),I=n(22685),x=n(89204);n(81704);class GridArea{constructor(e,t,n,i){this.startRow=e,this.endRow=t,this.startColumn=n,this.endColumn=i}get gridStartRow(){return 2*this.startRow}get gridEndRow(){return 2*this.endRow-1}get gridStartColumn(){return 2*this.startColumn}get gridEndColumn(){return 2*this.endColumn-1}get guid(){return this.storedGuid||(this.storedGuid=this.newGuid()),this.storedGuid}newGuid(){function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return`${s4()+s4()}-${s4()}-${s4()}-${s4()}-${s4()}${s4()}${s4()}`}}class GridWidgetArea extends GridArea{constructor(e){super(e.startRow,e.endRow,e.startColumn,e.endColumn),this.widget=e}reset(){this.startRow=this.widget.startRow,this.endRow=this.widget.endRow,this.startColumn=this.widget.startColumn,this.endColumn=this.widget.endColumn}moveRight(){this.startColumn++,this.endColumn++}moveLeft(){this.startColumn--,this.endColumn--}growColumn(){this.endColumn++}overlaps(e){return this.rowOverlaps(e)&&this.columnOverlaps(e)}rowOverlaps(e){return this.startRow<e.endRow&&this.endRow>=e.endRow||this.startRow<=e.startRow&&this.endRow>e.startRow||this.startRow>e.startRow&&this.endRow<e.endRow}columnOverlaps(e){return this.startColumn<e.endColumn&&this.endColumn>=e.endColumn||this.startColumn<=e.startColumn&&this.endColumn>e.startColumn||this.startColumn>e.startColumn&&this.endColumn<e.endColumn}startColumnOverlaps(e){return this.startColumn<e.startColumn&&this.endColumn>e.startColumn&&this.rowOverlaps(e)}get unchangedSize(){return this.startColumn===this.widget.startColumn&&this.endColumn===this.widget.endColumn&&this.startRow===this.widget.startRow&&this.endRow===this.widget.endRow}writeAreaChangeToWidget(){this.widget.startRow=this.startRow,this.widget.endRow=this.endRow,this.widget.startColumn=this.startColumn,this.widget.endColumn=this.endColumn}copyDimensionsTo(e){e.startRow=this.startRow,e.startColumn=this.startColumn,e.endRow=this.endRow,e.endColumn=this.endColumn}}class GridGap extends GridArea{constructor(e,t,n,i,o){super(e,t,n,i),this.type=o}get gridStartRow(){return this.isRow?2*this.startRow-1:2*this.startRow}get gridEndRow(){return this.isRow?2*this.endRow-2:2*this.endRow-1}get gridStartColumn(){return this.isRow?2*this.startColumn:2*this.startColumn-1}get gridEndColumn(){return this.isRow?2*this.endColumn-1:2*this.endColumn-2}get isRow(){return"row"===this.type}get isColumn(){return"column"===this.type}}var R=n(72650),F=n(75797),M=n(56196),O=n(14593),D=n(73588),G=n(70271);class GridAreaService{constructor(e,t,n){this.apiV3Service=e,this.toastService=t,this.i18n=n,this.$schema=new F.t(null),this.numColumns=0,this.numRows=0,this.mousedOverArea=null,this.$mousedOverArea=new F.t(this.mousedOverArea),this.helpMode=!1}set gridResource(e){this.resource=e,this.fetchSchema(),this.numRows=this.resource.rowCount,this.numColumns=this.resource.columnCount,this.buildAreas(!0)}get gridResource(){return this.resource}setMousedOverArea(e){this.mousedOverArea=e,this.$mousedOverArea.next(e)}cleanupUnusedAreas(){let e=_.range(this.numRows,0,-1);this.widgetAreas.forEach((t=>{e=e.filter((e=>e!==t.startRow))})),e.forEach((e=>{this.numRows>1&&this.removeRow(e)}));let t=_.range(this.numColumns,0,-1);this.widgetAreas.forEach((e=>{t=t.filter((t=>t!==e.startColumn))})),t.forEach((e=>{this.numColumns>1&&this.removeColumn(e)}))}buildAreas(e=!1){this.gridAreas=this.buildGridAreas(),this.gridGaps=this.buildGridGaps(),this.gridAreaIds=this.buildGridAreaIds(),e&&(this.widgetAreas=this.buildGridWidgetAreas())}rebuildAndPersist(){var e=this;return(0,x.A)((function*(){const t=yield e.persist();return e.buildAreas(!1),t}))()}persist(){return this.numRows=(this.widgetAreas.map((e=>e.endRow)).sort(((e,t)=>e-t)).pop()||2)-1,this.resource.rowCount=this.numRows,this.resource.columnCount=this.numColumns,this.writeAreaChangesToWidgets(),this.saveGrid(this.resource,this.schema)}saveWidgetChangeset(e){const t=D.i.extractPayload(this.resource,this.schema),n=t.widgets.find((t=>t.id===e.pristineResource.id));Object.assign(n,e.changes),t.id=this.resource.id,this.saveGrid(t)}isGap(e){return e instanceof GridGap}get isSingleCell(){return 1===this.numRows&&1===this.numColumns&&0===this.widgetResources.length}get inHelpMode(){return this.helpMode||this.isSingleCell}toggleHelpMode(){this.helpMode=!this.helpMode}scrollPlaceholderIntoView(){const e=jQuery(".grid--area.-placeholder");e[0].scrollIntoViewIfNeeded&&setTimeout((()=>e[0].scrollIntoViewIfNeeded()))}saveGrid(e,t){var n=this;return(0,x.A)((function*(){const i=n.apiV3Service.grids.id(e).patch(e,t).pipe((0,G.T)((e=>(n.assignAreasWidget(e),n.toastService.addSuccess(n.i18n.t("js.notice_successful_update")),e))));return(0,M._)(i)}))()}assignAreasWidget(e){this.resource.widgets=e.widgets;const t=this.widgetAreas.map((e=>e.widget.id));this.widgetAreas.forEach((n=>{let i;i=n.widget.id?e.widgets.find((e=>e.id===n.widget.id)):e.widgets.find((e=>!t.includes(e.id)&&e.identifier===n.widget.identifier&&e.startRow===n.widget.startRow&&e.startColumn===n.widget.startColumn)),n.widget=i}))}buildGridAreas(){const e=[];for(let t=1;t<=this.numRows+1;t++)e.push(...this.buildGridAreasRow(t));return e}buildGridGaps(){const e=[];if(this.isSingleCell)return e;for(let t=1;t<=this.numRows+1;t++)e.push(...this.buildGridGapRow(t));return e}buildGridAreasRow(e){const t=[];for(let n=1;n<=this.numColumns;n++){const i=new GridArea(e,e+1,n,n+1);t.push(i)}return t}buildGridGapRow(e){const t=[];for(let n=1;n<=this.numColumns;n++)t.push(new GridGap(e,e+1,n,n+1,"row"));if(e<=this.numRows)for(let n=1;n<=this.numColumns+1;n++)t.push(new GridGap(e,e+1,n,n+1,"column"));return t}buildGridWidgetAreas(){return this.widgetResources.map((e=>new GridWidgetArea(e)))}writeAreaChangesToWidgets(){this.widgetAreas.forEach((e=>{e.writeAreaChangeToWidget()}))}addColumn(e,t){this.numColumns++;const n=[];for(let i=1;i<=this.numRows;i++){if(i===t)continue;const o=this.rowWidgets(i).sort(((e,t)=>e.startColumn-t.startColumn)).find((n=>!(n.startRow<t&&n.endRow>t)&&(n.startColumn===e+1||n.endColumn===e+1||n.startColumn<=e&&n.endColumn>e)));o&&(n.push(o),o.endColumn++)}this.moveSubsequentRowWidgets(this.widgetAreas.filter((e=>!n.includes(e))),e)}addRow(e,t){this.numRows++;const n=[];for(let i=1;i<=this.numColumns;i++){if(i===t)continue;const o=this.columnWidgets(i).sort(((e,t)=>e.startRow-t.startRow)).find((n=>!(n.startColumn<t&&n.endColumn>t)&&(n.startRow===e+1||n.endRow===e+1||n.startRow<=e&&n.endRow>e)));o&&(n.push(o),o.endRow++)}this.moveSubsequentColumnWidgets(this.widgetAreas.filter((e=>!n.includes(e))),e)}removeColumn(e){this.numColumns--,this.widgetAreas.forEach((t=>{t.startColumn<=e&&t.endColumn>=e+1&&t.endColumn--})),this.widgetAreas.filter((t=>t.startColumn>e)).forEach((e=>{e.startColumn--,e.endColumn--}))}removeRow(e){this.numRows--,this.widgetAreas.forEach((t=>{t.startRow<=e&&t.endRow>=e+1&&t.endRow--})),this.widgetAreas.filter((t=>t.startRow>e)).forEach((e=>{e.startRow--,e.endRow--}))}resetAreas(e=null){this.widgetAreas.filter((t=>!e||t.guid!==e.guid)).forEach((e=>e.reset())),this.numRows=this.resource.rowCount,this.numColumns=this.resource.columnCount}get isEditable(){return void 0!==this.gridResource.updateImmediately}buildGridAreaIds(){return this.gridAreas.filter((e=>!this.isGap(e))).map((e=>e.guid))}fetchSchema(){this.apiV3Service.grids.id(this.resource).form.post({}).subscribe((e=>{this.schema=e.schema,this.$schema.next(e.schema)}))}removeWidget(e){let t=this.resource.widgets.findIndex((t=>t.id===e.id));this.resource.widgets.splice(t,1),t=this.widgetAreas.findIndex((t=>t.widget.id===e.id)),this.widgetAreas.splice(t,1),this.cleanupUnusedAreas(),this.rebuildAndPersist()}get widgetResources(){return this.resource&&this.resource.widgets||[]}rowWidgets(e){return this.widgetAreas.filter((t=>t.startRow===e))}moveSubsequentRowWidgets(e,t){e.forEach((e=>{e.startColumn>t&&(e.startColumn++,e.endColumn++)}))}columnWidgets(e){return this.widgetAreas.filter((t=>t.startColumn===e))}moveSubsequentColumnWidgets(e,t){e.forEach((e=>{e.startRow>t&&(e.startRow++,e.endRow++)}))}static{this.ɵfac=function GridAreaService_Factory(e){return new(e||GridAreaService)(o.KVO(O.n),o.KVO(R.fw),o.KVO(w.W))}}static{this.ɵprov=o.jDH({token:GridAreaService,factory:GridAreaService.ɵfac})}}class GridRemoveWidgetService{constructor(e){this.layout=e}area(e){this.widget(e.widget)}widget(e){this.layout.removeWidget(e)}static{this.ɵfac=function GridRemoveWidgetService_Factory(e){return new(e||GridRemoveWidgetService)(o.KVO(GridAreaService))}}static{this.ɵprov=o.jDH({token:GridRemoveWidgetService,factory:GridRemoveWidgetService.ɵfac})}}class WidgetAbstractMenuComponent{constructor(e,t,n,i){this.injector=e,this.i18n=t,this.remove=n,this.layout=i}get menuItemsFactory(){return this.buildItems.bind(this)}buildItems(){var e=this;return(0,x.A)((function*(){return[e.removeItem]}))()}get removeItem(){return{linkText:this.i18n.t("js.grid.remove"),onClick:()=>(this.remove.widget(this.resource),!0)}}get hasMenu(){return this.layout.isEditable}static{this.ɵfac=function WidgetAbstractMenuComponent_Factory(e){return new(e||WidgetAbstractMenuComponent)(o.rXU(o.zZn),o.rXU(w.W),o.rXU(GridRemoveWidgetService),o.rXU(GridAreaService))}}static{this.ɵdir=o.FsC({type:WidgetAbstractMenuComponent,inputs:{resource:"resource"}})}}var E=n(46653);function WidgetMenuComponent_icon_triggered_context_menu_0_Template(e,t){if(1&e&&o.nrm(0,"icon-triggered-context-menu",1),2&e){const e=o.XpG();o.Y8G("menuItemsFactory",e.menuItemsFactory)}}class WidgetMenuComponent extends WidgetAbstractMenuComponent{static{this.ɵfac=(()=>{let e;return function WidgetMenuComponent_Factory(t){return(e||(e=o.xGo(WidgetMenuComponent)))(t||WidgetMenuComponent)}})()}static{this.ɵcmp=o.VBU({type:WidgetMenuComponent,selectors:[["widget-menu"]],features:[o.Vt3],decls:1,vars:1,consts:[[3,"menuItemsFactory",4,"ngIf"],[3,"menuItemsFactory"]],template:function WidgetMenuComponent_Template(e,t){1&e&&o.DNE(0,WidgetMenuComponent_icon_triggered_context_menu_0_Template,1,1,"icon-triggered-context-menu",0),2&e&&o.Y8G("ngIf",t.hasMenu)},dependencies:[P.bT,E.W],styles:["[_nghost-%COMP%]{align-self:center}\n\n/*# sourceMappingURL=widget-menu.component.css.map*/"]})}}var A=n(24557);const V=[[["","slot","prepend"]],[["","slot","menu"]]],$=["[slot=prepend]","[slot=menu]"],_c2=e=>({"-editable":e});class WidgetHeaderComponent{constructor(e){this.layout=e,this.editable=!0,this.onRenamed=new o.bkB}renamed(e){this.onRenamed.emit(e)}get isRenameable(){return this.editable&&this.layout.isEditable}static{this.ɵfac=function WidgetHeaderComponent_Factory(e){return new(e||WidgetHeaderComponent)(o.rXU(GridAreaService))}}static{this.ɵcmp=o.VBU({type:WidgetHeaderComponent,selectors:[["widget-header"]],inputs:{name:"name",editable:"editable"},outputs:{onRenamed:"onRenamed"},ngContentSelectors:$,decls:4,vars:5,consts:[["data-test-selector","op-widget-box--header",1,"op-widget-box--header",3,"ngClass"],[1,"op-widget-box--header-title",3,"onSave","title","editable"]],template:function WidgetHeaderComponent_Template(e,t){1&e&&(o.NAR(V),o.j41(0,"h3",0),o.SdG(1),o.j41(2,"editable-toolbar-title",1),o.bIt("onSave",(function WidgetHeaderComponent_Template_editable_toolbar_title_onSave_2_listener(e){return t.renamed(e)})),o.k0s(),o.SdG(3,1),o.k0s()),2&e&&(o.Y8G("ngClass",o.eq3(3,_c2,t.isRenameable)),o.R7$(2),o.Y8G("title",t.name)("editable",t.isRenameable))},dependencies:[P.YU,A.JS],styles:[".op-widget-box--header.-editable[_ngcontent-%COMP%]{margin-top:0}.op-widget-box--header-title[_ngcontent-%COMP%]{padding-right:5px}"],changeDetection:0})}}const wp_calendar_component_c0=e=>({hasCapability:e});function WidgetWpCalendarComponent_ng_container_2_div_1_Template(e,t){if(1&e&&(o.j41(0,"div",5),o.nrm(1,"span",6),o.k0s()),2&e){const e=o.XpG(2);o.R7$(),o.Y8G("textContent",e.text.missing_permission)}}function WidgetWpCalendarComponent_ng_container_2_op_wp_calendar_2_Template(e,t){1&e&&o.nrm(0,"op-wp-calendar",7),2&e&&o.Y8G("showMeetings",!0)("static",!0)}function WidgetWpCalendarComponent_ng_container_2_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,WidgetWpCalendarComponent_ng_container_2_div_1_Template,2,1,"div",3)(2,WidgetWpCalendarComponent_ng_container_2_op_wp_calendar_2_Template,1,2,"op-wp-calendar",4),o.bVm()),2&e){const e=t.ngIf;o.R7$(),o.Y8G("ngIf",!1===e.hasCapability),o.R7$(),o.Y8G("ngIf",!0===e.hasCapability)}}class WidgetWpCalendarComponent extends y.q{constructor(e,t,n,i){super(e,t),this.I18n=e,this.injector=t,this.currentProject=n,this.currentUser=i,this.text={missing_permission:this.I18n.t("js.grid.widgets.missing_permission")},this.hasCapability$=this.currentUser.hasCapabilities$("work_packages/read",this.currentProject.id)}get projectIdentifier(){return this.currentProject.identifier}static{this.ɵfac=function WidgetWpCalendarComponent_Factory(e){return new(e||WidgetWpCalendarComponent)(o.rXU(w.W),o.rXU(o.zZn),o.rXU(T.c),o.rXU(S.K))}}static{this.ɵcmp=o.VBU({type:WidgetWpCalendarComponent,selectors:[["ng-component"]],features:[o.nM4([j.Y]),o.Vt3],decls:4,vars:7,consts:[[3,"onRenamed","name"],["slot","menu",3,"resource"],[4,"ngIf"],["class","op-toast -error",4,"ngIf"],[3,"showMeetings","static",4,"ngIf"],[1,"op-toast","-error"],[3,"textContent"],[3,"showMeetings","static"]],template:function WidgetWpCalendarComponent_Template(e,t){1&e&&(o.j41(0,"widget-header",0),o.bIt("onRenamed",(function WidgetWpCalendarComponent_Template_widget_header_onRenamed_0_listener(e){return t.renameWidget(e)})),o.nrm(1,"widget-menu",1),o.k0s(),o.DNE(2,WidgetWpCalendarComponent_ng_container_2_Template,3,2,"ng-container",2),o.nI1(3,"async")),2&e&&(o.Y8G("name",t.widgetName),o.R7$(),o.Y8G("resource",t.resource),o.R7$(),o.Y8G("ngIf",o.eq3(5,wp_calendar_component_c0,o.bMT(3,3,t.hasCapability$))))},dependencies:[P.bT,I.E,WidgetMenuComponent,WidgetHeaderComponent,P.Jj],encapsulation:2,changeDetection:0})}}var B=n(73014),W=n(32420),N=n(43329),U=n(24398),Y=n(51133),X=n(69081),q=n(72688),L=n(80366),H=n(49349),z=n(6923);class TimeEntriesCurrentUserConfigurationModalService{getOrderedDaysData(e,t=z.weekdays(!0),n=z.localeData().firstDayOfWeek()){const i=n-1,o=Array.from(e),r=i>=0?o.splice(0,i):o.splice(i),s=i>=0?[...o,...r]:[...r,...o];return s.map(((e,n)=>({weekDay:t[n],checked:e,originalIndex:this.getOriginalIndex(i,n,s.length)})))}getOriginalIndex(e,t,n){let i=t+e;return i<0?i=n-1:i>=n&&(i=0),i}getCheckedValuesInOriginalOrder(e){const t=e.sort(((e,t)=>e.originalIndex<t.originalIndex?-1:1)).map((e=>e.checked));return this.validDays(t)}validDays(e){return e.every((e=>!e))?Array.from({length:7},(()=>!0)):e}static{this.ɵfac=function TimeEntriesCurrentUserConfigurationModalService_Factory(e){return new(e||TimeEntriesCurrentUserConfigurationModalService)}}static{this.ɵprov=o.jDH({token:TimeEntriesCurrentUserConfigurationModalService,factory:TimeEntriesCurrentUserConfigurationModalService.ɵfac})}}function TimeEntriesCurrentUserConfigurationModalComponent_div_5_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",9),o.nrm(1,"label",10),o.j41(2,"span",11)(3,"span",12)(4,"input",13),o.mxI("ngModelChange",(function TimeEntriesCurrentUserConfigurationModalComponent_div_5_Template_input_ngModelChange_4_listener(t){const n=o.eBV(e).$implicit;return o.DH7(n.checked,t)||(n.checked=t),o.Njj(t)})),o.k0s()()()()}if(2&e){const e=t.$implicit,n=t.index;o.R7$(),o.Y8G("textContent",e.weekDay)("htmlFor","day_"+n),o.R7$(3),o.Y8G("id","day_"+n),o.R50("ngModel",e.checked)}}class TimeEntriesCurrentUserConfigurationModalComponent extends X.a{constructor(e,t,n,i,o,r,s,a,l,c){super(e,s,l),this.locals=e,this.I18n=t,this.injector=n,this.appRef=i,this.loadingIndicator=o,this.notificationService=r,this.cdRef=s,this.configuration=a,this.elementRef=l,this.timeEntriesCurrentUserConfigurationModalService=c,this.text={displayedDays:this.I18n.t("js.grid.widgets.time_entries_current_user.displayed_days"),closePopup:this.I18n.t("js.close_popup_title"),applyButton:this.I18n.t("js.modals.button_apply"),cancelButton:this.I18n.t("js.modals.button_cancel")}}ngOnInit(){const e=this.locals.options.days;this.daysOriginalCheckedValues=e.length>0?e:Array.from({length:7},(()=>!0)),this.days=this.timeEntriesCurrentUserConfigurationModalService.getOrderedDaysData(this.daysOriginalCheckedValues)}saveChanges(){const e=this.timeEntriesCurrentUserConfigurationModalService.getCheckedValuesInOriginalOrder(this.days);this.options={days:e},this.service.close()}static{this.ɵfac=function TimeEntriesCurrentUserConfigurationModalComponent_Factory(e){return new(e||TimeEntriesCurrentUserConfigurationModalComponent)(o.rXU(Y.Y),o.rXU(w.W),o.rXU(o.zZn),o.rXU(o.o8S),o.rXU(L.FX),o.rXU(H.U),o.rXU(o.gRc),o.rXU(q.s),o.rXU(o.aKT),o.rXU(TimeEntriesCurrentUserConfigurationModalService))}}static{this.ɵcmp=o.VBU({type:TimeEntriesCurrentUserConfigurationModalComponent,selectors:[["ng-component"]],features:[o.Jv_([TimeEntriesCurrentUserConfigurationModalService]),o.Vt3],decls:10,vars:4,consts:[["data-indicator-name","modal","tabindex","0",1,"spot-modal"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"spot-modal--body","spot-container"],["class","form--field -trailing-label",4,"ngFor","ngForOf"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],[1,"button","button_no-margin","spot-modal--cancel-button","spot-action-bar--action",3,"click","textContent"],[1,"button","button_no-margin","-primary","spot-action-bar--action",3,"click","textContent"],[1,"form--field","-trailing-label"],[1,"form--label",3,"textContent","htmlFor"],[1,"form--field-container"],[1,"form--check-box-container"],["type","checkbox","name","days",1,"form--check-box",3,"ngModelChange","id","ngModel"]],template:function TimeEntriesCurrentUserConfigurationModalComponent_Template(e,t){1&e&&(o.j41(0,"div",0)(1,"div",1),o.EFF(2),o.k0s(),o.nrm(3,"div",2),o.j41(4,"div",3),o.DNE(5,TimeEntriesCurrentUserConfigurationModalComponent_div_5_Template,5,4,"div",4),o.k0s(),o.j41(6,"div",5)(7,"div",6)(8,"button",7),o.bIt("click",(function TimeEntriesCurrentUserConfigurationModalComponent_Template_button_click_8_listener(e){return t.closeMe(e)})),o.k0s(),o.j41(9,"button",8),o.bIt("click",(function TimeEntriesCurrentUserConfigurationModalComponent_Template_button_click_9_listener(){return t.saveChanges()})),o.k0s()()()()),2&e&&(o.R7$(2),o.JRh(t.text.displayedDays),o.R7$(3),o.Y8G("ngForOf",t.days),o.R7$(3),o.Y8G("textContent",t.text.cancelButton),o.R7$(),o.Y8G("textContent",t.text.applyButton))},dependencies:[a.Zm,a.BC,a.vS,P.Sq],encapsulation:2})}}var Q=n(1758);function WidgetTimeEntriesCurrentUserMenuComponent_icon_triggered_context_menu_0_Template(e,t){if(1&e&&o.nrm(0,"icon-triggered-context-menu",1),2&e){const e=o.XpG();o.Y8G("menuItemsFactory",e.menuItemsFactory)}}class WidgetTimeEntriesCurrentUserMenuComponent extends WidgetAbstractMenuComponent{constructor(){super(...arguments),this.onConfigured=new o.bkB}buildItems(){var e=this;return(0,x.A)((function*(){return[e.removeItem,e.configureItem]}))()}get configureItem(){return{linkText:this.i18n.t("js.grid.configure"),onClick:()=>(this.opModalService.show(TimeEntriesCurrentUserConfigurationModalComponent,this.injector,this.locals).subscribe((e=>e.closingEvent.subscribe((()=>{e.options&&this.onConfigured.emit(e.options)})))),!0)}}get locals(){return{options:this.resource.options}}static{this.ɵfac=(()=>{let e;return function WidgetTimeEntriesCurrentUserMenuComponent_Factory(t){return(e||(e=o.xGo(WidgetTimeEntriesCurrentUserMenuComponent)))(t||WidgetTimeEntriesCurrentUserMenuComponent)}})()}static{this.ɵcmp=o.VBU({type:WidgetTimeEntriesCurrentUserMenuComponent,selectors:[["widget-time-entries-current-user-menu"]],outputs:{onConfigured:"onConfigured"},features:[o.Vt3],decls:1,vars:1,consts:[[3,"menuItemsFactory",4,"ngIf"],[3,"menuItemsFactory"]],template:function WidgetTimeEntriesCurrentUserMenuComponent_Template(e,t){1&e&&o.DNE(0,WidgetTimeEntriesCurrentUserMenuComponent_icon_triggered_context_menu_0_Template,1,1,"icon-triggered-context-menu",0),2&e&&o.Y8G("ngIf",t.hasMenu)},dependencies:[P.bT,E.W],encapsulation:2})}}(0,U.Cg)([(0,Q.O)(),(0,U.Sn)("design:type",Y.a)],WidgetTimeEntriesCurrentUserMenuComponent.prototype,"opModalService",void 0);class WidgetTimeEntriesCurrentUserComponent extends y.q{constructor(e,t,n,i,o){super(n,e),this.injector=e,this.timezone=t,this.i18n=n,this.pathHelper=i,this.cdr=o,this.entries=[]}ngOnInit(){this.displayedDays=this.resource.options.days}updateEntries(e){this.entries=e.elements,this.cdr.detectChanges()}get total(){const e=this.entries.reduce(((e,t)=>e+this.timezone.toHours(t.hours)),0);return e>0?this.i18n.t("js.units.hour",{count:e}):this.i18n.t("js.placeholders.default")}get isEditable(){return!1}updateConfiguration(e){this.resourceChanged.emit(this.setChangesetOptions(e)),this.displayedDays=[...e.days]}formatNumber(e){return this.i18n.toNumber(e,{precision:2})}static{this.ɵfac=function WidgetTimeEntriesCurrentUserComponent_Factory(e){return new(e||WidgetTimeEntriesCurrentUserComponent)(o.rXU(o.zZn),o.rXU(W.D),o.rXU(w.W),o.rXU(B.B),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:WidgetTimeEntriesCurrentUserComponent,selectors:[["ng-component"]],features:[o.Vt3],decls:8,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"onConfigured","resource"],[3,"entries","displayedDays"],[1,"total-hours"],[3,"textContent"]],template:function WidgetTimeEntriesCurrentUserComponent_Template(e,t){1&e&&(o.j41(0,"widget-header",0)(1,"widget-time-entries-current-user-menu",1),o.bIt("onConfigured",(function WidgetTimeEntriesCurrentUserComponent_Template_widget_time_entries_current_user_menu_onConfigured_1_listener(e){return t.updateConfiguration(e)})),o.k0s()(),o.j41(2,"op-time-entries-calendar",2),o.bIt("entries",(function WidgetTimeEntriesCurrentUserComponent_Template_op_time_entries_calendar_entries_2_listener(e){return t.updateEntries(e)})),o.k0s(),o.qex(3),o.j41(4,"div",3)(5,"p"),o.EFF(6,"Total: "),o.nrm(7,"span",4),o.k0s()(),o.bVm()),2&e&&(o.Y8G("name",t.widgetName)("editable",t.isEditable),o.R7$(),o.Y8G("resource",t.resource),o.R7$(),o.Y8G("displayedDays",t.displayedDays),o.R7$(5),o.Y8G("textContent",t.total))},dependencies:[N.n,WidgetTimeEntriesCurrentUserMenuComponent,WidgetHeaderComponent],encapsulation:2,changeDetection:0})}}class GridWidgetsService{constructor(e){this.Hook=e}get registered(){let e=[];return _.each(this.Hook.call("gridWidgets"),(t=>{e=e.concat(t)})),e}static{this.ɵfac=function GridWidgetsService_Factory(e){return new(e||GridWidgetsService)(o.KVO(b.R))}}static{this.ɵprov=o.jDH({token:GridWidgetsService,factory:GridWidgetsService.ɵfac})}}n(80923);class GridMoveService{constructor(e){this.layout=e}down(e,t){const n=[];let i=this.layout.widgetAreas.slice(0);for(t&&(i=i.filter((e=>e.guid!==t.guid))),i.sort(((e,t)=>t.startRow-e.startRow));null!==e;)n.push(e),i=i.filter((t=>t.guid!==e.guid)),e=this.moveOneDown(n,i)}moveOneDown(e,t){const n=this.firstAreaToMove(e,t);if(n){const e=n[0],t=n[1],i=e.widget.height;return e.startRow=t.endRow,e.endRow=e.startRow+i,this.layout.numRows<e.endRow-1&&(this.layout.numRows=e.endRow-1),e}return null}firstAreaToMove(e,t){let n=null,i=null;if(t.forEach((t=>{e.forEach((e=>{e.overlaps(t)&&(n=e,i=t)}))})),null!==i){let t=n;return e.forEach((e=>{e.endRow>t.endRow&&i.columnOverlaps(e)&&(t=e)})),[i,t]}return null}static{this.ɵfac=function GridMoveService_Factory(e){return new(e||GridMoveService)(o.KVO(GridAreaService))}}static{this.ɵprov=o.jDH({token:GridMoveService,factory:GridMoveService.ɵfac})}}var K=n(53674),J=n(91817),Z=n(51567);class GridDragAndDropService{constructor(e,t){this.layout=e,this.move=t,this.setupMousedOverAreaSubscription()}ngOnDestroy(){this.mousedOverAreaObserver.unsubscribe()}setupMousedOverAreaSubscription(){this.mousedOverAreaObserver=this.layout.$mousedOverArea.pipe((0,K.c)(10),(0,J.F)(),(0,Z.p)((e=>this.currentlyDragging&&!!e&&!this.layout.isGap(e)&&(this.placeholderArea.startRow!==e.startRow||this.placeholderArea.startColumn!==e.startColumn)))).subscribe((e=>{this.updateArea(e),this.layout.scrollPlaceholderIntoView()}))}updateArea(e){this.layout.resetAreas(this.draggedArea),this.moveAreasOnDragging(e)}moveAreasOnDragging(e){if(!this.placeholderArea)return;const t=this.draggedArea;this.copyPositionButRestrict(e,this.placeholderArea),this.move.down(this.placeholderArea,t)}get currentlyDragging(){return!!this.draggedArea}isDropOnlyArea(e){return!this.currentlyDragging&&e.endRow===this.layout.numRows+2}isDragged(e){return this.currentlyDragging&&this.draggedArea.guid===e.guid}isPassive(e){return this.currentlyDragging&&!this.isDragged(e)}get isDraggable(){return this.layout.isEditable}start(e){this.placeholderArea=new GridWidgetArea(e.widget),this.draggedHeight=document.getElementById(e.guid).offsetHeight-2,this.draggedArea=e}abort(){document.dispatchEvent(new Event("mouseup")),this.draggedArea=null,this.placeholderArea=null,this.layout.resetAreas()}drop(){this.draggedArea&&(this.placeholderArea.copyDimensionsTo(this.draggedArea),this.draggedArea.unchangedSize||(this.layout.writeAreaChangesToWidgets(),this.layout.cleanupUnusedAreas(),this.layout.rebuildAndPersist()),this.draggedArea=null,this.placeholderArea=null)}copyPositionButRestrict(e,t){t.startRow=e.startRow,e.startRow===this.layout.numRows+1?t.endRow=this.layout.numRows+2:e.startRow+t.widget.height>this.layout.numRows+1?t.endRow=this.layout.numRows+1:t.endRow=e.startRow+t.widget.height,t.startColumn=e.startColumn,e.startColumn+t.widget.width>this.layout.numColumns+1?t.endColumn=this.layout.numColumns+1:t.endColumn=e.startColumn+t.widget.width}static{this.ɵfac=function GridDragAndDropService_Factory(e){return new(e||GridDragAndDropService)(o.KVO(GridAreaService),o.KVO(GridMoveService))}}static{this.ɵprov=o.jDH({token:GridDragAndDropService,factory:GridDragAndDropService.ɵfac})}}class GridResizeService{constructor(e,t,n){this.layout=e,this.move=t,this.drag=n}end(e){this.resizedArea&&(this.resizedArea=null,e.unchangedSize||(this.layout.writeAreaChangesToWidgets(),this.layout.cleanupUnusedAreas(),this.layout.rebuildAndPersist()))}abort(){this.resizedArea&&(this.layout.resetAreas(),this.resizedArea=null)}start(e){this.resizedArea=e;const t=this.layout.gridAreas.filter((e=>{const t=e.startRow===this.resizedArea.startRow&&e.startColumn>=this.resizedArea.startColumn,n=e.startRow>this.resizedArea.startRow&&e.startColumn>=this.resizedArea.startColumn&&this.layout.widgetAreas.some((t=>t.startRow===e.startRow&&(t.endColumn<=this.resizedArea.startColumn||t.startColumn>=e.endColumn)));return t||n}));this.targetIds=t.map((e=>e.guid))}moving(){this.resizedArea&&this.layout.mousedOverArea&&this.targetIds.includes(this.layout.mousedOverArea.guid)&&(this.layout.resetAreas(),this.resizedArea.endRow=this.layout.mousedOverArea.endRow,this.resizedArea.endColumn=this.layout.mousedOverArea.endColumn,this.move.down(this.resizedArea,this.resizedArea))}isTarget(e){const t=e.guid;return this.resizedArea&&this.targetIds.includes(t)}isResized(e){return this.resizedArea&&this.resizedArea.guid===e.guid}isPassive(e){return this.currentlyResizing&&!this.isResized(e)}get currentlyResizing(){return!!this.resizedArea}get isResizable(){return!this.drag.currentlyDragging&&this.isAllowed}get isAllowed(){return this.layout.gridResource.updateImmediately}static{this.ɵfac=function GridResizeService_Factory(e){return new(e||GridResizeService)(o.KVO(GridAreaService),o.KVO(GridMoveService),o.KVO(GridDragAndDropService))}}static{this.ɵprov=o.jDH({token:GridResizeService,factory:GridResizeService.ɵfac})}}var ee=n(99972),te=n(38941),ne=n(64334),ie=n(35321);function AddGridWidgetModalComponent_op_enterprise_banner_5_Template(e,t){if(1&e&&o.nrm(0,"op-enterprise-banner",10),2&e){const e=o.XpG();o.Y8G("linkMessage",e.text.upsale_link)("textMessage",e.text.upsale_text)("moreInfoLink",e.text.more_info_link)}}function AddGridWidgetModalComponent_li_7_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"li",11)(1,"button",12),o.bIt("click",(function AddGridWidgetModalComponent_li_7_Template_button_click_1_listener(t){const n=o.eBV(e).$implicit,i=o.XpG();return o.Njj(i.select(t,n))})),o.k0s()()}if(2&e){const e=t.$implicit;o.R7$(),o.Y8G("id",e.identifier)("textContent",e.title)}}class AddGridWidgetModalComponent extends X.a{constructor(e,t,n,i,o,r,s){super(t,n,e),this.elementRef=e,this.locals=t,this.cdRef=n,this.widgetsService=i,this.i18n=o,this.bannerService=r,this.loadingIndicator=s,this.text={title:this.i18n.t("js.grid.add_widget"),close_popup:this.i18n.t("js.button_close"),upsale_link:this.i18n.t("js.grid.upsale.link"),upsale_text:this.i18n.t("js.grid.upsale.text"),cancel_button:this.i18n.t("js.button_cancel"),more_info_link:te.y$.graphWidgets},this.eeShowBanners=!1}ngOnInit(){super.ngOnInit(),this.eeShowBanners=this.bannerService.eeShowBanners,this.fetchSchema()}get selectable(){return this.eligibleWidgets.sort(((e,t)=>e.title.localeCompare(t.title)))}select(e,t){this.chosenWidget=t,this.closeMe(e)}trackWidgetBy(e){return e.identifier}fetchSchema(){const e=this.locals.$schema;this.schema=e.value,this.schema||(this.loadingIndicator.modal.start(),e.pipe((0,Z.p)(Boolean),(0,ne.s)(1)).subscribe((e=>{this.schema=e,this.loadingIndicator.modal.stop(),this.cdRef.detectChanges()})))}get eligibleWidgets(){if(this.schema){const e=this.schema.widgets.allowedValues.map((e=>e.identifier));return this.widgetsService.registered.filter((t=>e.includes(t.identifier)))}return[]}static{this.ɵfac=function AddGridWidgetModalComponent_Factory(e){return new(e||AddGridWidgetModalComponent)(o.rXU(o.aKT),o.rXU(Y.Y),o.rXU(o.gRc),o.rXU(GridWidgetsService),o.rXU(w.W),o.rXU(ee.b),o.rXU(L.FX))}}static{this.ɵcmp=o.VBU({type:AddGridWidgetModalComponent,selectors:[["ng-component"]],features:[o.Vt3],decls:12,vars:5,consts:[["data-indicator-name","modal",1,"spot-modal","loading-indicator--location"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"ngdialog-body","spot-modal--body","spot-container"],["class","grid--add-widget-ee","opReferrer","grids#add-widget",3,"linkMessage","textMessage","moreInfoLink",4,"ngIf"],[1,"spot-list"],["class","spot-list--item","data-test-selector","op-grid--addable-widget",4,"ngFor","ngForOf","ngForTrackBy"],[1,"spot-action-bar","hidden-for-mobile"],[1,"spot-action-bar--right"],["type","button",1,"button","button_no-margin","spot-modal--cancel-button","spot-action-bar--action",3,"click"],["opReferrer","grids#add-widget",1,"grid--add-widget-ee",3,"linkMessage","textMessage","moreInfoLink"],["data-test-selector","op-grid--addable-widget",1,"spot-list--item"],["type","button",1,"spot-list--item-action",3,"click","id","textContent"]],template:function AddGridWidgetModalComponent_Template(e,t){1&e&&(o.j41(0,"div",0)(1,"div",1),o.EFF(2),o.k0s(),o.nrm(3,"div",2),o.j41(4,"div",3),o.DNE(5,AddGridWidgetModalComponent_op_enterprise_banner_5_Template,1,3,"op-enterprise-banner",4),o.j41(6,"ul",5),o.DNE(7,AddGridWidgetModalComponent_li_7_Template,2,2,"li",6),o.k0s()(),o.j41(8,"div",7)(9,"div",8)(10,"button",9),o.bIt("click",(function AddGridWidgetModalComponent_Template_button_click_10_listener(){return t.closeMe()})),o.EFF(11),o.k0s()()()()),2&e&&(o.R7$(2),o.JRh(t.text.title),o.R7$(3),o.Y8G("ngIf",t.eeShowBanners),o.R7$(2),o.Y8G("ngForOf",t.selectable)("ngForTrackBy",t.trackWidgetBy),o.R7$(4),o.SpI(" ",t.text.cancel_button," "))},dependencies:[P.Sq,P.bT,ie.l],encapsulation:2,changeDetection:0})}}var oe=n(36178);class GridAddWidgetService{constructor(e,t,n,i,o,r,s,a){this.opModalService=e,this.injector=t,this.halResource=n,this.layout=i,this.drag=o,this.move=r,this.resize=s,this.i18n=a,this.text={add:this.i18n.t("js.grid.add_widget")}}isAddable(e){return!this.drag.currentlyDragging&&!this.resize.currentlyResizing&&(this.layout.mousedOverArea===e||this.layout.isSingleCell||this.layout.inHelpMode)&&this.isAllowed}widget(e){var t=this;return this.select(e).then(function(){var n=(0,x.A)((function*(n){t.layout.isGap(e)&&t.addLine(e);const i=new GridWidgetArea(n);return t.setMaxWidth(i),yield t.persist(i),n}));return function(e){return n.apply(this,arguments)}}()).catch((()=>null))}get addText(){return this.text.add}select(e){return new Promise(((t,n)=>{this.opModalService.show(AddGridWidgetModalComponent,this.injector,{$schema:this.layout.$schema}).subscribe((i=>{i.closingEvent.subscribe((()=>{const o=i.chosenWidget;if(!o)return void n();const r={_type:"GridWidget",identifier:o.identifier,startRow:e.startRow,endRow:e.endRow,startColumn:e.startColumn,endColumn:e.endColumn,options:o.properties||{}},s=this.halResource.createHalResource(r);s.grid=this.layout.gridResource,t(s)}))}))}))}addLine(e){e.isRow?this.layout.addRow(e.startRow-1,e.startColumn):e.isColumn&&this.layout.addColumn(e.startColumn-1,e.startRow)}setMaxWidth(e){e.endColumn=this.layout.numColumns+1,this.layout.widgetAreas.forEach((t=>{e.startColumnOverlaps(t)&&(e.endColumn=t.startColumn)}))}persist(e){var t=this;return(0,x.A)((function*(){return e.writeAreaChangeToWidget(),t.layout.widgetAreas.push(e),t.layout.widgetResources.push(e.widget),t.layout.rebuildAndPersist()}))()}get isAllowed(){return this.layout.gridResource&&this.layout.gridResource.updateImmediately}static{this.ɵfac=function GridAddWidgetService_Factory(e){return new(e||GridAddWidgetService)(o.KVO(Y.a),o.KVO(o.zZn),o.KVO(oe.t),o.KVO(GridAreaService),o.KVO(GridDragAndDropService),o.KVO(GridMoveService),o.KVO(GridResizeService),o.KVO(w.W))}}static{this.ɵprov=o.jDH({token:GridAddWidgetService,factory:GridAddWidgetService.ɵfac})}}const re=["tabInner"];class WpGraphConfigurationSettingsTabComponent{onSave(){this.tabInner.onSave()}static{this.ɵfac=function WpGraphConfigurationSettingsTabComponent_Factory(e){return new(e||WpGraphConfigurationSettingsTabComponent)}}static{this.ɵcmp=o.VBU({type:WpGraphConfigurationSettingsTabComponent,selectors:[["op-wp-graph-configuration-settings-tab"]],viewQuery:function WpGraphConfigurationSettingsTabComponent_Query(e,t){if(1&e&&o.GBs(re,7),2&e){let e;o.mGM(e=o.lsd())&&(t.tabInner=e.first)}},features:[o.nM4([j.Y])],decls:2,vars:0,consts:[["tabInner",""]],template:function WpGraphConfigurationSettingsTabComponent_Template(e,t){1&e&&o.nrm(0,"op-settings-tab-inner",null,0)},encapsulation:2})}}const se=["tabInner"];class WpGraphConfigurationFiltersTabComponent{onSave(){this.tabInner.onSave()}static{this.ɵfac=function WpGraphConfigurationFiltersTabComponent_Factory(e){return new(e||WpGraphConfigurationFiltersTabComponent)}}static{this.ɵcmp=o.VBU({type:WpGraphConfigurationFiltersTabComponent,selectors:[["op-wp-graph-configuration-filters-tab"]],viewQuery:function WpGraphConfigurationFiltersTabComponent_Query(e,t){if(1&e&&o.GBs(se,7),2&e){let e;o.mGM(e=o.lsd())&&(t.tabInner=e.first)}},features:[o.nM4([j.Y])],decls:2,vars:0,consts:[["tabInner",""]],template:function WpGraphConfigurationFiltersTabComponent_Template(e,t){1&e&&o.nrm(0,"op-filters-tab-inner",null,0)},encapsulation:2})}}class WpGraphConfiguration{constructor(e,t,n){this.queryParams=e,this.chartOptions=t,this.chartType=n,this.queries=[],this.chartType=this.chartType||"bar"}static queryCreationParams(e,t){return{public:t,name:e.t("js.grid.widgets.work_packages_graph.title"),showHierarchies:!1,_links:{groupBy:{href:"/api/v3/queries/group_bys/status"}}}}}var ae=n(36647);class WpGraphConfigurationService{constructor(e,t,n,i){this.I18n=e,this.apiv3Service=t,this.notificationService=n,this.currentProject=i,this._globalScope=!1,this._forms={}}persistAndReload(){return this.persistChanges().then((()=>this.reloadQueries()))}persistChanges(){const e=this.queries.map((e=>this.saveQuery(e)));return Promise.all(e)}get datasets(){return this.queries.map((e=>({groups:e.results.groups,queryProps:"",label:e.name})))}reloadQueries(){return this.configuration.queries.length=0,this.loadQueries()}ensureQueryAndLoad(){return 0===this.queryParams.length?(0,M._)(this.createInitial()).then((e=>(this.queryParams.push({id:e.id}),this.loadQueries()))):this.loadQueries()}createInitial(){return this.apiv3Service.queries.form.loadWithParams({pageSize:0},void 0,this.projectIdentifier(),WpGraphConfiguration.queryCreationParams(this.I18n,this.isPublicQuery())).pipe((0,ae.n)((([e,t])=>this.apiv3Service.queries.post(t,e))))}loadQueries(){const e=this.queryParams.map((e=>this.loadQuery(e)));return Promise.all(e)}loadQuery(e){return(0,M._)(this.apiv3Service.queries.find({pageSize:0,...e.props},e.id,this.projectIdentifier())).then((t=>{e.name&&(t.name=e.name),this.configuration.queries.push(t)}))}saveQuery(e){var t=this;return(0,x.A)((function*(){return t.formFor(e).then((n=>t.apiv3Service.queries.id(e).patch(e,n).toPromise()))}))()}projectIdentifier(){return this.globalScope?null:this.currentProject.identifier}isPublicQuery(){return!!this.projectIdentifier()}get configuration(){return this._configuration}set configuration(e){this._configuration=e,this._formsPromise=null}get globalScope(){return this._globalScope}set globalScope(e){this._globalScope=e,this._formsPromise=null}formFor(e){var t=this;return(0,x.A)((function*(){return t.loadForms().then((()=>t._forms[e.id]))}))()}get tabs(){const e=[{id:"graph-settings",name:this.I18n.t("js.chart.tabs.graph_settings"),componentClass:WpGraphConfigurationSettingsTabComponent}],t=this.configuration.queries.map((e=>({id:e.id,name:this.I18n.t("js.work_packages.query.filters"),componentClass:WpGraphConfigurationFiltersTabComponent})));return e.concat(t)}loadForms(){if(!this._formsPromise){const e=this.configuration.queries.map((e=>(0,M._)(this.apiv3Service.queries.form.load(e)).then((([t])=>{this._forms[e.id]=t})).catch((e=>this.notificationService.handleRawError(e)))));this._formsPromise=Promise.all(e)}return this._formsPromise}get chartType(){return this._configuration.chartType}set chartType(e){this._configuration.chartType=e}get queries(){return this._configuration.queries}get chartOptions(){return this._configuration.chartOptions}get queryParams(){return this._configuration.queryParams}static{this.ɵfac=function WpGraphConfigurationService_Factory(e){return new(e||WpGraphConfigurationService)(o.KVO(w.W),o.KVO(O.n),o.KVO(H.U),o.KVO(T.c))}}static{this.ɵprov=o.jDH({token:WpGraphConfigurationService,factory:WpGraphConfigurationService.ɵfac})}}var le=n(49999),ce=n(79727),pe=n(73235);const wp_embedded_graph_component_c0=e=>({height:e});function WorkPackageEmbeddedGraphComponent_canvas_2_Template(e,t){if(1&e&&(o.j41(0,"canvas",4),o.EFF(1),o.k0s()),2&e){const e=o.XpG();o.Y8G("datasets",e.chartData)("labels",e.chartLabels)("plugins",e.chartPlugins)("type",e.mappedChartType)("options",e.internalChartOptions),o.R7$(),o.SpI(" ",e.chartDescription," ")}}function WorkPackageEmbeddedGraphComponent_op_no_results_3_Template(e,t){if(1&e&&o.nrm(0,"op-no-results",5),2&e){const e=o.XpG();o.Y8G("title",e.text.noResults)}}class WorkPackageEmbeddedGraphComponent{constructor(e){this.i18n=e,this.chartType="bar",this.error=null,this.chartHeight="100%",this.chartLabels=[],this.chartData=[],this.chartPlugins=[le.default],this.initialized=!1,this.text={noResults:this.i18n.t("js.work_packages.no_results.title")}}ngOnChanges(e){e.datasets?(this.setChartOptions(),this.updateChartData(),e.datasets.firstChange||(this.initialized=!0)):e.chartType&&this.setChartOptions()}updateChartData(){let e=_.uniq(this.datasets.reduce(((e,t)=>{const n=(t.groups||[]).map((e=>e.value));return e.concat(n)}),[]));const t=this.datasets.map((t=>{const n=(t.groups||[]).reduce(((e,t)=>({...e,[t.value]:t.count})),{});return{label:t.label,data:e.map((e=>n[e]||0))}}));e=e.map((e=>null===e?this.i18n.t("js.placeholders.default"):e)),this.setHeight(),this.chartLabels.length=0,this.chartLabels.push(...e),this.chartData.length=0,this.chartData.push(...t)}setChartOptions(){const e=getComputedStyle(document.body).getPropertyValue("--body-font-color"),t=getComputedStyle(document.body).getPropertyValue("--borderColor-default"),n=getComputedStyle(document.body).getPropertyValue("--overlay-backdrop-bgColor"),i={color:e,responsive:!0,maintainAspectRatio:!1,indexAxis:"horizontalBar"===this.chartType?"y":"x",scales:{r:{angleLines:{color:this.isRadarChart()?t:"transparent"},grid:{color:this.isRadarChart()?t:"transparent"},pointLabels:{color:this.isRadarChart()?e:"transparent"},ticks:{color:this.isRadarChart()?e:"transparent",backdropColor:this.isRadarChart()?n:"transparent"}},y:{ticks:{color:this.isBarChart()?e:"transparent"},grid:{color:this.isBarChart()?t:"transparent"},border:{color:this.isBarChart()?e:"transparent"}},x:{ticks:{color:this.isBarChart()?e:"transparent"},grid:{color:this.isBarChart()?t:"transparent"},border:{color:this.isBarChart()?e:"transparent"}}},plugins:{legend:{display:this.datasets.length>1},datalabels:{anchor:"center",align:"bar"===this.chartType?"top":"center",color:e}}};this.internalChartOptions={...i,...this.chartOptions}}get hasDataToDisplay(){return this.chartData.length>0&&this.chartData.some((e=>e.data.length>0))}get mappedChartType(){return"horizontalBar"===this.chartType?"bar":this.chartType}get chartDescription(){return _.map(this.chartLabels,((e,t)=>{if(1===this.chartData.length){return`${this.chartData[0].data[t]} ${e}`}return`${e}: ${_.map(this.chartData,(e=>`${e.data[t]} ${e.label}`)).join(", ")}`})).join("; ")}setHeight(){if("horizontalBar"===this.chartType&&this.datasets&&this.datasets[0]){const e=[];this.datasets.forEach((t=>t.groups.forEach((t=>{e.includes(t.value)||e.push(t.value)}))));let t=40*e.length;this.datasets.length>1&&(t+=40),t+=40,this.chartHeight=`${t}px`}else this.chartHeight="100%"}isBarChart(){return"bar"===this.chartType||"horizontalBar"===this.chartType||"line"===this.chartType}isRadarChart(){return"radar"===this.chartType||"polarArea"===this.chartType}static{this.ɵfac=function WorkPackageEmbeddedGraphComponent_Factory(e){return new(e||WorkPackageEmbeddedGraphComponent)(o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:WorkPackageEmbeddedGraphComponent,selectors:[["op-wp-embedded-graph"]],inputs:{datasets:"datasets",chartOptions:"chartOptions",chartType:"chartType"},features:[o.OA$],decls:4,vars:5,consts:[["graphContainer",""],[1,"op-wp-embedded-graph","work-packages-embedded-view--container","loading-indicator--location",3,"ngStyle"],["baseChart","",3,"datasets","labels","plugins","type","options",4,"ngIf"],[3,"title",4,"ngIf"],["baseChart","",3,"datasets","labels","plugins","type","options"],[3,"title"]],template:function WorkPackageEmbeddedGraphComponent_Template(e,t){1&e&&(o.j41(0,"div",1,0),o.DNE(2,WorkPackageEmbeddedGraphComponent_canvas_2_Template,2,6,"canvas",2)(3,WorkPackageEmbeddedGraphComponent_op_no_results_3_Template,1,1,"op-no-results",3),o.k0s()),2&e&&(o.Y8G("ngStyle",o.eq3(3,wp_embedded_graph_component_c0,t.chartHeight)),o.R7$(2),o.Y8G("ngIf",t.hasDataToDisplay),o.R7$(),o.Y8G("ngIf",!t.hasDataToDisplay&&t.initialized))},dependencies:[P.bT,P.B3,ce.h,pe.j9],styles:[".op-wp-embedded-graph.work-packages-embedded-view--container[_ngcontent-%COMP%]{height:100%;max-height:500px;position:relative}"]})}}var de=n(21449),ue=n(74406);const he=["tabContentOutlet"];function WpGraphConfigurationModalComponent_ng_container_5_ng_container_1_Template(e,t){1&e&&o.eu8(0)}function WpGraphConfigurationModalComponent_ng_container_5_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,WpGraphConfigurationModalComponent_ng_container_5_ng_container_1_Template,1,0,"ng-container",12),o.bVm()),2&e){const e=o.XpG();o.R7$(),o.Y8G("ngComponentOutlet",e.prependModalComponent)("ngComponentOutletInjector",e.injector)}}function WpGraphConfigurationModalComponent_op_scrollable_tabs_6_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"op-scrollable-tabs",13),o.bIt("tabSelected",(function WpGraphConfigurationModalComponent_op_scrollable_tabs_6_Template_op_scrollable_tabs_tabSelected_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.switchTo(t))})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("tabs",e.availableTabs)("currentTabId",null==e.tabPortalHost.currentTab?null:e.tabPortalHost.currentTab.id)}}const me=new o.nKC("WpTableConfigurationModalPrependComponent");class WpGraphConfigurationModalComponent extends X.a{constructor(e,t,n,i,o,r,s,a,l,c,p,d){super(e,l,p),this.locals=e,this.prependModalComponent=t,this.I18n=n,this.injector=i,this.appRef=o,this.componentFactoryResolver=r,this.loadingIndicator=s,this.notificationService=a,this.cdRef=l,this.configurationService=c,this.elementRef=p,this.graphConfiguration=d,this.text={title:this.I18n.t("js.chart.modal_title"),closePopup:this.I18n.t("js.close_popup_title"),applyButton:this.I18n.t("js.modals.button_apply"),cancelButton:this.I18n.t("js.modals.button_cancel")}}ngOnInit(){this.$element=this.elementRef.nativeElement,this.loadingIndicator.indicator("modal").promise=this.graphConfiguration.loadForms().then((()=>{this.tabPortalHost=new de.z(this.graphConfiguration.tabs,this.tabContentOutlet.nativeElement,this.componentFactoryResolver,this.appRef,this.injector);const e=this.locals.initialTab,t=this.availableTabs.find((t=>t.id===e));this.cdRef.markForCheck(),this.switchTo(t||this.availableTabs[0])}))}ngOnDestroy(){this.tabPortalHost.dispose()}get availableTabs(){return this.tabPortalHost.availableTabs}get currentTab(){return this.tabPortalHost.currentTab}switchTo(e){this.tabPortalHost.switchTo(e)}saveChanges(){this.tabPortalHost.activeComponents.forEach((e=>{e.onSave()})),this.configuration=this.graphConfiguration.configuration,this.service.close()}onClose(){return this.afterFocusOn.focus(),!0}get afterFocusOn(){return this.$element}static{this.ɵfac=function WpGraphConfigurationModalComponent_Factory(e){return new(e||WpGraphConfigurationModalComponent)(o.rXU(Y.Y),o.rXU(me,8),o.rXU(w.W),o.rXU(o.zZn),o.rXU(o.o8S),o.rXU(o.OM3),o.rXU(L.FX),o.rXU(H.U),o.rXU(o.gRc),o.rXU(q.s),o.rXU(o.aKT),o.rXU(WpGraphConfigurationService))}}static{this.ɵcmp=o.VBU({type:WpGraphConfigurationModalComponent,selectors:[["ng-component"]],viewQuery:function WpGraphConfigurationModalComponent_Query(e,t){if(1&e&&o.GBs(he,7),2&e){let e;o.mGM(e=o.lsd())&&(t.tabContentOutlet=e.first)}},features:[o.Vt3],decls:13,vars:5,consts:[["tabContentOutlet",""],["data-indicator-name","modal",1,"spot-modal","spot-modal_wide","wp-table--configuration-modal","loading-indicator--location"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"spot-modal--body","spot-container"],[4,"ngIf"],[3,"tabs","currentTabId","tabSelected",4,"ngIf"],[1,"tab-content"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],[1,"button","button_no-margin","spot-modal--cancel-button","spot-action-bar--action",3,"click","textContent"],["data-test-selector","spot-modal-wp-table-configuration-save-button",1,"button","button_no-margin","-primary","spot-action-bar--action",3,"click","textContent"],[4,"ngComponentOutlet","ngComponentOutletInjector"],[3,"tabSelected","tabs","currentTabId"]],template:function WpGraphConfigurationModalComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",1)(1,"div",2),o.EFF(2),o.k0s(),o.nrm(3,"div",3),o.j41(4,"div",4),o.DNE(5,WpGraphConfigurationModalComponent_ng_container_5_Template,2,2,"ng-container",5)(6,WpGraphConfigurationModalComponent_op_scrollable_tabs_6_Template,1,2,"op-scrollable-tabs",6),o.nrm(7,"div",7,0),o.k0s(),o.j41(9,"div",8)(10,"div",9)(11,"button",10),o.bIt("click",(function WpGraphConfigurationModalComponent_Template_button_click_11_listener(n){return o.eBV(e),o.Njj(t.closeMe(n))})),o.k0s(),o.j41(12,"button",11),o.bIt("click",(function WpGraphConfigurationModalComponent_Template_button_click_12_listener(){return o.eBV(e),o.Njj(t.saveChanges())})),o.k0s()()()()}2&e&&(o.R7$(2),o.JRh(t.text.title),o.R7$(3),o.Y8G("ngIf",!!t.prependModalComponent),o.R7$(),o.Y8G("ngIf",t.tabPortalHost),o.R7$(5),o.Y8G("textContent",t.text.cancelButton),o.R7$(),o.Y8G("textContent",t.text.applyButton))},dependencies:[P.OI,P.bT,f.ar,ue.f],encapsulation:2,changeDetection:0})}}class WidgetWpSetMenuComponent extends WidgetAbstractMenuComponent{constructor(){super(...arguments),this.onConfigured=new o.bkB}buildItems(){var e=this;return(0,x.A)((function*(){const t=[e.removeItem];return(yield e.configurationAllowed())&&t.push(e.configureItem),t}))()}get configureItem(){return{linkText:this.i18n.t("js.toolbar.settings.configure_view"),onClick:()=>(this.opModalService.show(this.configurationComponent,this.injector,this.locals).subscribe((e=>e.closingEvent.subscribe((()=>{e instanceof WpGraphConfigurationModalComponent&&this.onConfigured.emit(e.configuration)})))),!0)}}configurationAllowed(){return Promise.resolve(!0)}get locals(){return{}}static{this.ɵfac=(()=>{let e;return function WidgetWpSetMenuComponent_Factory(t){return(e||(e=o.xGo(WidgetWpSetMenuComponent)))(t||WidgetWpSetMenuComponent)}})()}static{this.ɵdir=o.FsC({type:WidgetWpSetMenuComponent,outputs:{onConfigured:"onConfigured"},features:[o.Vt3]})}}function WidgetWpGraphMenuComponent_icon_triggered_context_menu_0_Template(e,t){if(1&e&&o.nrm(0,"icon-triggered-context-menu",1),2&e){const e=o.XpG();o.Y8G("menuItemsFactory",e.menuItemsFactory)}}(0,U.Cg)([(0,Q.O)(),(0,U.Sn)("design:type",Y.a)],WidgetWpSetMenuComponent.prototype,"opModalService",void 0);class WidgetWpGraphMenuComponent extends WidgetWpSetMenuComponent{constructor(){super(...arguments),this.configurationComponent=WpGraphConfigurationModalComponent}static{this.ɵfac=(()=>{let e;return function WidgetWpGraphMenuComponent_Factory(t){return(e||(e=o.xGo(WidgetWpGraphMenuComponent)))(t||WidgetWpGraphMenuComponent)}})()}static{this.ɵcmp=o.VBU({type:WidgetWpGraphMenuComponent,selectors:[["widget-wp-graph-menu"]],features:[o.Vt3],decls:1,vars:1,consts:[[3,"menuItemsFactory",4,"ngIf"],[3,"menuItemsFactory"]],template:function WidgetWpGraphMenuComponent_Template(e,t){1&e&&o.DNE(0,WidgetWpGraphMenuComponent_icon_triggered_context_menu_0_Template,1,1,"icon-triggered-context-menu",0),2&e&&o.Y8G("ngIf",t.hasMenu)},dependencies:[P.bT,E.W],encapsulation:2})}}class WidgetWpGraphComponent extends y.q{constructor(e,t,n,i){super(e,t),this.i18n=e,this.injector=t,this.cdr=n,this.graphConfiguration=i,this.datasets=[]}ngOnInit(){this.initializeConfiguration(),this.loadQueriesInitially()}set chartType(e){this.resource.options.chartType=e}updateGraph(e){this.graphConfiguration.persistAndReload().then((()=>{if(this.repaint(),this.resource.options.chartType!==this.graphConfiguration.chartType){const e=this.setChangesetOptions({chartType:this.graphConfiguration.chartType});this.resourceChanged.emit(e)}}))}repaint(){this.datasets=this.graphConfiguration.datasets,this.cdr.detectChanges()}initializeConfiguration(){const e=[];this.resource.options.queryId&&e.push({id:this.resource.options.queryId}),this.graphConfiguration.configuration=new WpGraphConfiguration(e,this.resource.options.chartOptions,this.resource.options.chartType)}loadQueriesInitially(){this.graphConfiguration.ensureQueryAndLoad().then((()=>{if(!this.resource.options.queryId){const e=this.setChangesetOptions({queryId:this.graphConfiguration.queryParams[0].id});this.resourceChanged.emit(e)}this.repaint()}))}get chartOptions(){return this.graphConfiguration.chartOptions}get chartType(){return this.graphConfiguration.chartType}static{this.ɵfac=function WidgetWpGraphComponent_Factory(e){return new(e||WidgetWpGraphComponent)(o.rXU(w.W),o.rXU(o.zZn),o.rXU(o.gRc),o.rXU(WpGraphConfigurationService))}}static{this.ɵcmp=o.VBU({type:WidgetWpGraphComponent,selectors:[["widget-wp-graph"]],features:[o.Jv_([WpGraphConfigurationService]),o.Vt3],decls:3,vars:4,consts:[[3,"onRenamed","name"],["slot","menu",3,"onConfigured","resource"],[1,"grid--widget-content","-no-overflow",3,"datasets","chartType"]],template:function WidgetWpGraphComponent_Template(e,t){1&e&&(o.j41(0,"widget-header",0),o.bIt("onRenamed",(function WidgetWpGraphComponent_Template_widget_header_onRenamed_0_listener(e){return t.renameWidget(e)})),o.j41(1,"widget-wp-graph-menu",1),o.bIt("onConfigured",(function WidgetWpGraphComponent_Template_widget_wp_graph_menu_onConfigured_1_listener(e){return t.updateGraph(e)})),o.k0s()(),o.nrm(2,"op-wp-embedded-graph",2)),2&e&&(o.Y8G("name",t.widgetName),o.R7$(),o.Y8G("resource",t.resource),o.R7$(),o.Y8G("datasets",t.datasets)("chartType",t.chartType))},dependencies:[WorkPackageEmbeddedGraphComponent,WidgetWpGraphMenuComponent,WidgetHeaderComponent],styles:["wp-embedded-table[_ngcontent-%COMP%]{overflow:auto}"],changeDetection:0})}}var ge=n(75275),_e=n(94193);const grid_component_c0=(e,t,n)=>({"-dragged":e,"-passive":t,"-resizing":n}),grid_component_c1=(e,t,n,i,o)=>({"-drop-target":e,"-drop-only":t,"-resize-target":n,"-addable":i,"-help-mode":o}),grid_component_c2=(e,t,n,i)=>({"-addable":e,"-help-mode":t,"-row":n,"-column":i});function GridComponent_div_1_span_2_Template(e,t){if(1&e&&o.nrm(0,"span",10),2&e){const e=o.XpG(2);o.Y8G("hidden",e.isMobileDevice)}}function GridComponent_div_1_op_resizer_4_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"op-resizer",11),o.bIt("resizeFinished",(function GridComponent_div_1_op_resizer_4_Template_op_resizer_resizeFinished_0_listener(){o.eBV(e);const t=o.XpG().$implicit,n=o.XpG();return o.Njj(n.resize.end(t))}))("resizeStarted",(function GridComponent_div_1_op_resizer_4_Template_op_resizer_resizeStarted_0_listener(){o.eBV(e);const t=o.XpG().$implicit,n=o.XpG();return o.Njj(n.resize.start(t))}))("move",(function GridComponent_div_1_op_resizer_4_Template_op_resizer_move_0_listener(){o.eBV(e);const t=o.XpG(2);return o.Njj(t.resize.moving())})),o.j41(1,"div",12),o.nrm(2,"i",13),o.k0s()()}2&e&&o.Y8G("customHandler",!0)}function GridComponent_div_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",5)(1,"div",6),o.bIt("cdkDragStarted",(function GridComponent_div_1_Template_div_cdkDragStarted_1_listener(){const t=o.eBV(e).$implicit,n=o.XpG();return o.Njj(n.drag.start(t))}))("cdkDragDropped",(function GridComponent_div_1_Template_div_cdkDragDropped_1_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.drag.drop())})),o.DNE(2,GridComponent_div_1_span_2_Template,1,1,"span",7),o.nrm(3,"ndc-dynamic",8),o.k0s(),o.DNE(4,GridComponent_div_1_op_resizer_4_Template,3,1,"op-resizer",9),o.k0s()}if(2&e){const e=t.$implicit,n=o.XpG();o.xc7("grid-row-start",e.gridStartRow)("grid-row-end",e.gridEndRow)("grid-column-start",e.gridStartColumn)("grid-column-end",e.gridEndColumn),o.Y8G("ngClass",o.sMw(18,grid_component_c0,n.drag.isDragged(e),n.drag.isPassive(e)||n.resize.isPassive(e),n.resize.isResized(e)))("id",e.guid)("cdkDropListData",e)("cdkDropListConnectedTo",n.layout.gridAreaIds),o.R7$(),o.Y8G("cdkDragDisabled",n.isMobileDevice||!n.drag.isDraggable),o.R7$(),o.Y8G("ngIf",n.drag.isDraggable),o.R7$(),o.Y8G("ndcDynamicComponent",n.widgetComponent(e))("ndcDynamicInputs",n.widgetComponentInput(e))("ndcDynamicOutputs",n.widgetComponentOutput(e)),o.R7$(),o.Y8G("ngIf",n.resize.isResizable)}}function GridComponent_div_2_div_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",16),o.bIt("click",(function GridComponent_div_2_div_1_Template_div_click_0_listener(){o.eBV(e);const t=o.XpG().$implicit,n=o.XpG();return o.Njj(n.addWidget(t))})),o.k0s()}if(2&e){const e=o.XpG(2);o.Y8G("title",e.add.addText)}}function GridComponent_div_2_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",14),o.bIt("mouseover",(function GridComponent_div_2_Template_div_mouseover_0_listener(){const t=o.eBV(e).$implicit,n=o.XpG();return o.Njj(n.layout.setMousedOverArea(t))})),o.DNE(1,GridComponent_div_2_div_1_Template,1,1,"div",15),o.k0s()}if(2&e){const e=t.$implicit,n=o.XpG();o.xc7("grid-row-start",e.gridStartRow)("grid-row-end",e.gridEndRow)("grid-column-start",e.gridStartColumn)("grid-column-end",e.gridEndColumn),o.Y8G("ngClass",o.s1E(13,grid_component_c1,n.drag.currentlyDragging,n.drag.isDropOnlyArea(e),n.resize.isTarget(e),n.add.isAddable(e),n.layout.inHelpMode))("id",e.guid)("cdkDropListData",e)("cdkDropListConnectedTo",n.layout.gridAreaIds),o.R7$(),o.Y8G("ngIf",n.add.isAllowed)}}function GridComponent_div_3_div_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",19),o.bIt("click",(function GridComponent_div_3_div_1_Template_div_click_0_listener(){o.eBV(e);const t=o.XpG().$implicit,n=o.XpG();return o.Njj(n.addWidget(t))})),o.k0s()}if(2&e){const e=o.XpG(2);o.Y8G("title",e.add.addText)}}function GridComponent_div_3_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",17),o.bIt("mouseover",(function GridComponent_div_3_Template_div_mouseover_0_listener(){const t=o.eBV(e).$implicit,n=o.XpG();return o.Njj(n.layout.setMousedOverArea(t))})),o.DNE(1,GridComponent_div_3_div_1_Template,1,1,"div",18),o.k0s()}if(2&e){const e=t.$implicit,n=o.XpG();o.xc7("grid-row-start",e.gridStartRow)("grid-row-end",e.gridEndRow)("grid-column-start",e.gridStartColumn)("grid-column-end",e.gridEndColumn),o.Y8G("ngClass",o.ziG(11,grid_component_c2,n.add.isAddable(e),n.layout.inHelpMode,e.isRow,e.isColumn))("id",e.guid),o.R7$(),o.Y8G("ngIf",n.add.isAllowed)}}function GridComponent_div_4_Template(e,t){if(1&e&&(o.j41(0,"div",20),o.nrm(1,"div",21),o.k0s()),2&e){const e=o.XpG();o.xc7("grid-row-start",e.drag.placeholderArea.gridStartRow)("grid-row-end",e.drag.placeholderArea.gridEndRow)("grid-column-start",e.drag.placeholderArea.gridStartColumn)("grid-column-end",e.drag.placeholderArea.gridEndColumn)("min-height",e.drag.draggedHeight,"px")}}const fe=[GridAreaService,GridMoveService,GridDragAndDropService,GridResizeService,GridAddWidgetService,GridRemoveWidgetService];class GridComponent{constructor(e,t,n,i,o,r,s,a,l){this.sanitization=e,this.widgetsService=t,this.drag=n,this.resize=i,this.layout=o,this.add=r,this.remove=s,this.browserDetector=a,this.cdRef=l,this.uiWidgets=[],this.GRID_AREA_HEIGHT="auto",this.GRID_GAP_DIMENSION="20px",this.component=WidgetWpGraphComponent}ngOnInit(){this.layout.gridResource=this.grid}ngOnDestroy(){this.uiWidgets.forEach((e=>e.destroy()))}handleKeyboardEvent(e){"Escape"!==e.key||(this.drag.currentlyDragging?this.drag.abort():this.resize.currentlyResizing&&this.resize.abort())}addWidget(e){this.add.widget(e).then((()=>this.cdRef.detectChanges()))}widgetComponent(e){const{widget:t}=e;if(!t)return null;const n=this.widgetsService.registered.find((e=>e.identifier===t.identifier));return n?n.component:null}widgetComponentInput(e){return{resource:e.widget}}widgetComponentOutput(e){return{resourceChanged:this.layout.saveWidgetChangeset.bind(this.layout)}}get gridColumnStyle(){return this.gridStyle(this.layout.numColumns,`calc((100% - ${this.GRID_GAP_DIMENSION} * ${this.layout.numColumns+1}) / ${this.layout.numColumns})`)}get gridRowStyle(){return this.gridStyle(this.layout.numRows,this.GRID_AREA_HEIGHT)}identifyGridArea(e,t){return t.guid}get isHeadersDisplayed(){return this.layout.isEditable}get isMobileDevice(){return this.browserDetector.isMobile}gridStyle(e,t){let n="";for(let i=0;i<e;i++)n+=`${this.GRID_GAP_DIMENSION} ${t} `;return n+=`${this.GRID_GAP_DIMENSION}`,this.sanitization.bypassSecurityTrustStyle(n)}static{this.ɵfac=function GridComponent_Factory(e){return new(e||GridComponent)(o.rXU(i.up),o.rXU(GridWidgetsService),o.rXU(GridDragAndDropService),o.rXU(GridResizeService),o.rXU(GridAreaService),o.rXU(GridAddWidgetService),o.rXU(GridRemoveWidgetService),o.rXU(ge.l),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:GridComponent,selectors:[["grid"]],hostBindings:function GridComponent_HostBindings(e,t){1&e&&o.bIt("keyup",(function GridComponent_keyup_HostBindingHandler(e){return t.handleKeyboardEvent(e)}),!1,o.tSv)},inputs:{grid:"grid"},decls:5,vars:11,consts:[[1,"grid--container"],["class","grid--area -widgeted","cdkDropList","",3,"ngClass","grid-row-start","grid-row-end","grid-column-start","grid-column-end","id","cdkDropListData","cdkDropListConnectedTo",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--area hidden-for-mobile","cdkDropList","",3,"ngClass","grid-row-start","grid-row-end","grid-column-start","grid-column-end","id","cdkDropListData","cdkDropListConnectedTo","mouseover",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--area -gap hidden-for-mobile",3,"ngClass","grid-row-start","grid-row-end","grid-column-start","grid-column-end","id","mouseover",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--area -widgeted -placeholder",3,"grid-row-start","grid-row-end","grid-column-start","grid-column-end","min-height",4,"ngIf"],["cdkDropList","",1,"grid--area","-widgeted",3,"ngClass","id","cdkDropListData","cdkDropListConnectedTo"],["cdkDrag","",1,"grid--area-content","widget-box",3,"cdkDragStarted","cdkDragDropped","cdkDragDisabled"],["class","grid--area-drag-handle\n                   icon\n                   icon-drag-handle\n                   hidden-for-mobile","cdkDragHandle","",3,"hidden",4,"ngIf"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"],[3,"customHandler","resizeFinished","resizeStarted","move",4,"ngIf"],["cdkDragHandle","",1,"grid--area-drag-handle","icon","icon-drag-handle","hidden-for-mobile",3,"hidden"],[3,"resizeFinished","resizeStarted","move","customHandler"],[1,"grid--resizer"],["aria-hidden","true",1,"icon-resizer-bottom-right","hidden-for-mobile"],["cdkDropList","",1,"grid--area","hidden-for-mobile",3,"mouseover","ngClass","id","cdkDropListData","cdkDropListConnectedTo"],["class","grid--widget-add",3,"title","click",4,"ngIf"],[1,"grid--widget-add",3,"click","title"],[1,"grid--area","-gap","hidden-for-mobile",3,"mouseover","ngClass","id"],["class","grid--widget-add -gap",3,"title","click",4,"ngIf"],[1,"grid--widget-add","-gap",3,"click","title"],[1,"grid--area","-widgeted","-placeholder"],[1,"widget-box"]],template:function GridComponent_Template(e,t){1&e&&(o.j41(0,"div",0),o.DNE(1,GridComponent_div_1_Template,5,22,"div",1)(2,GridComponent_div_2_Template,2,19,"div",2)(3,GridComponent_div_3_Template,2,16,"div",3)(4,GridComponent_div_4_Template,2,10,"div",4),o.k0s()),2&e&&(o.xc7("grid-template-columns",t.gridColumnStyle)("grid-template-rows",t.gridRowStyle),o.R7$(),o.Y8G("ngForOf",t.layout.widgetAreas)("ngForTrackBy",t.identifyGridArea),o.R7$(),o.Y8G("ngForOf",t.layout.gridAreas)("ngForTrackBy",t.identifyGridArea),o.R7$(),o.Y8G("ngForOf",t.layout.gridGaps)("ngForTrackBy",t.identifyGridArea),o.R7$(),o.Y8G("ngIf",t.drag.placeholderArea))},dependencies:[C.O7,C.T1,C.Fb,P.YU,P.Sq,P.bT,_e.a,f.Bf,f.dE],encapsulation:2})}}function WidgetDocumentsComponent_op_no_results_3_Template(e,t){if(1&e&&o.nrm(0,"op-no-results",5),2&e){const e=o.XpG();o.Y8G("title",e.text.noResults)}}function WidgetDocumentsComponent_ng_container_4_span_3_Template(e,t){if(1&e&&(o.j41(0,"span"),o.EFF(1),o.k0s()),2&e){const e=o.XpG().$implicit,t=o.XpG();o.R7$(),o.Lme(" (",t.text.project,": ",e.project.name,") ")}}function WidgetDocumentsComponent_ng_container_4_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"h4",6),o.nrm(2,"a",7),o.DNE(3,WidgetDocumentsComponent_ng_container_4_span_3_Template,2,2,"span",8),o.k0s(),o.j41(4,"p",9),o.nrm(5,"em",10),o.k0s(),o.nrm(6,"div",11),o.bVm()),2&e){const e=t.$implicit,n=o.XpG();o.R7$(2),o.Y8G("href",n.documentPath(e),o.B4B)("textContent",e.title),o.R7$(),o.Y8G("ngIf",!n.currentProject.identifier),o.R7$(2),o.Y8G("textContent",n.documentCreated(e)),o.R7$(),o.Y8G("innerHtml",n.documentDescription(e),o.npT)}}class WidgetDocumentsComponent extends y.q{constructor(e,t,n,i,o,r,s,a,l){super(i,s),this.halResource=e,this.pathHelper=t,this.apiV3Service=n,this.i18n=i,this.timezone=o,this.domSanitizer=r,this.injector=s,this.currentProject=a,this.cdr=l,this.text={noResults:this.i18n.t("js.grid.widgets.documents.no_results"),project:this.i18n.t("js.label_project")},this.entries=[],this.entriesLoaded=!1}ngOnInit(){this.halResource.get(this.documentsUrl).subscribe((e=>{this.entries=e.elements,this.entriesLoaded=!0,this.cdr.detectChanges()}))}get isEditable(){return!1}documentPath(e){return`${this.pathHelper.appBasePath}/documents/${e.id}`}documentCreated(e){return this.timezone.formattedDatetime(e.createdAt)}documentDescription(e){return this.domSanitizer.sanitize(o.WPN.HTML,e.description.html)}get noEntries(){return!this.entries.length&&this.entriesLoaded}get documentsUrl(){const e=JSON.stringify([["updated_at","desc"]]);let t=`${this.apiV3Service.documents.toPath()}?sortBy=${e}&pageSize=10`;if(this.currentProject.id){t+=`&filters=${JSON.stringify([{project_id:{operator:"=",values:[this.currentProject.id.toString()]}}])}`}return t}static{this.ɵfac=function WidgetDocumentsComponent_Factory(e){return new(e||WidgetDocumentsComponent)(o.rXU(oe.t),o.rXU(B.B),o.rXU(O.n),o.rXU(w.W),o.rXU(W.D),o.rXU(i.up),o.rXU(o.zZn),o.rXU(T.c),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:WidgetDocumentsComponent,selectors:[["ng-component"]],features:[o.Vt3],decls:5,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"title"],[1,"document-category-elements--header"],[3,"href","textContent"],[4,"ngIf"],[1,"document-category-elements--date"],[3,"textContent"],[1,"wiki","grid--widget-limited-text","op-uc-container",3,"innerHtml"]],template:function WidgetDocumentsComponent_Template(e,t){1&e&&(o.j41(0,"widget-header",0),o.nrm(1,"widget-menu",1),o.k0s(),o.j41(2,"div",2),o.DNE(3,WidgetDocumentsComponent_op_no_results_3_Template,1,1,"op-no-results",3)(4,WidgetDocumentsComponent_ng_container_4_Template,7,5,"ng-container",4),o.k0s()),2&e&&(o.Y8G("name",t.widgetName)("editable",t.isEditable),o.R7$(),o.Y8G("resource",t.resource),o.R7$(2),o.Y8G("ngIf",t.noEntries),o.R7$(),o.Y8G("ngForOf",t.entries))},dependencies:[P.Sq,P.bT,ce.h,WidgetMenuComponent,WidgetHeaderComponent],encapsulation:2,changeDetection:0})}}var be=n(12313),ke=n(48377);function WidgetNewsComponent_op_no_results_3_Template(e,t){if(1&e&&o.nrm(0,"op-no-results",6),2&e){const e=o.XpG();o.Y8G("title",e.text.noResults)}}function WidgetNewsComponent_li_5_op_principal_1_Template(e,t){if(1&e&&o.nrm(0,"op-principal",13),2&e){const e=o.XpG().$implicit;o.Y8G("principal",e.author)("hideName",!0)}}function WidgetNewsComponent_li_5_div_6_Template(e,t){if(1&e&&o.nrm(0,"div",14),2&e){const e=o.XpG().$implicit,t=o.XpG();o.Y8G("innerHTML",t.text.addedBy(e),o.npT)}}function WidgetNewsComponent_li_5_p_7_Template(e,t){if(1&e&&o.nrm(0,"p",15),2&e){const e=o.XpG().$implicit;o.Y8G("textContent",e.summary)}}function WidgetNewsComponent_li_5_Template(e,t){if(1&e&&(o.j41(0,"li",7),o.DNE(1,WidgetNewsComponent_li_5_op_principal_1_Template,1,2,"op-principal",8),o.j41(2,"div",9),o.nrm(3,"a",10),o.EFF(4,": "),o.nrm(5,"a",10),o.k0s(),o.DNE(6,WidgetNewsComponent_li_5_div_6_Template,1,1,"div",11)(7,WidgetNewsComponent_li_5_p_7_Template,1,1,"p",12),o.k0s()),2&e){const e=t.$implicit,n=o.XpG();o.R7$(),o.Y8G("ngIf",e.author),o.R7$(2),o.Y8G("href",n.newsProjectPath(e),o.B4B)("textContent",n.newsProjectName(e)),o.R7$(2),o.Y8G("href",n.newsPath(e),o.B4B)("textContent",e.title),o.R7$(),o.Y8G("ngIf",e.author),o.R7$(),o.Y8G("ngIf",e.summary)}}class WidgetNewsComponent extends y.q{constructor(e,t,n,i,o,r,s){super(t,n),this.pathHelper=e,this.i18n=t,this.injector=n,this.timezone=i,this.currentProject=o,this.apiV3Service=r,this.cdr=s,this.text={at:this.i18n.t("js.grid.widgets.news.at"),noResults:this.i18n.t("js.grid.widgets.news.no_results"),addedBy:e=>this.i18n.t("js.label_added_time_by",{author:this.newsAuthorName(e),age:this.newsCreated(e),authorLink:this.newsAuthorPath(e)})},this.entries=[],this.entriesLoaded=!1}ngOnInit(){this.apiV3Service.news.list(this.newsDmParams).subscribe((e=>this.setupNews(e.elements)))}setupNews(e){this.entries=e,this.entriesLoaded=!0,this.cdr.detectChanges()}get isEditable(){return!1}newsPath(e){return this.pathHelper.newsPath(e.id)}newsProjectPath(e){return this.pathHelper.projectPath((0,be.A)(e.project?.href))}newsProjectName(e){return e.project?.name}newsAuthorName(e){return e.author?.name}newsAuthorPath(e){return this.pathHelper.userPath(e.author?.id)}newsCreated(e){return this.timezone.formattedDatetime(e.createdAt)}get noEntries(){return!this.entries.length&&this.entriesLoaded}get newsDmParams(){const e={sortBy:[["created_at","desc"]],pageSize:3};return this.currentProject.id&&(e.filters=[["project_id","=",[this.currentProject.id]]]),e}static{this.ɵfac=function WidgetNewsComponent_Factory(e){return new(e||WidgetNewsComponent)(o.rXU(B.B),o.rXU(w.W),o.rXU(o.zZn),o.rXU(W.D),o.rXU(T.c),o.rXU(O.n),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:WidgetNewsComponent,selectors:[["ng-component"]],features:[o.Vt3],decls:6,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[1,"widget-box--arrow-links"],["class","widget-box--arrow-multiline",4,"ngFor","ngForOf"],[3,"title"],[1,"widget-box--arrow-multiline"],["class","widget-box--avatar news-author-avatar hidden-for-mobile",3,"principal","hideName",4,"ngIf"],[1,"widget-box--project"],[3,"href","textContent"],["class","widget-box--author news-author",3,"innerHTML",4,"ngIf"],["class","widget-box--additional-info",3,"textContent",4,"ngIf"],[1,"widget-box--avatar","news-author-avatar","hidden-for-mobile",3,"principal","hideName"],[1,"widget-box--author","news-author",3,"innerHTML"],[1,"widget-box--additional-info",3,"textContent"]],template:function WidgetNewsComponent_Template(e,t){1&e&&(o.j41(0,"widget-header",0),o.nrm(1,"widget-menu",1),o.k0s(),o.j41(2,"div",2),o.DNE(3,WidgetNewsComponent_op_no_results_3_Template,1,1,"op-no-results",3),o.j41(4,"ul",4),o.DNE(5,WidgetNewsComponent_li_5_Template,8,7,"li",5),o.k0s()()),2&e&&(o.Y8G("name",t.widgetName)("editable",t.isEditable),o.R7$(),o.Y8G("resource",t.resource),o.R7$(2),o.Y8G("ngIf",t.noEntries),o.R7$(2),o.Y8G("ngForOf",t.entries))},dependencies:[P.Sq,P.bT,ke.f,ce.h,WidgetMenuComponent,WidgetHeaderComponent],encapsulation:2,changeDetection:0})}}var ve=n(85247),Ce=n(11048),ye=n(83093),we=n(47470),Te=n(95083),Se=n(16545);function WidgetWpTableMenuComponent_icon_triggered_context_menu_0_Template(e,t){if(1&e&&o.nrm(0,"icon-triggered-context-menu",1),2&e){const e=o.XpG();o.Y8G("menuItemsFactory",e.menuItemsFactory)}}class WidgetWpTableMenuComponent extends WidgetWpSetMenuComponent{constructor(){super(...arguments),this.configurationComponent=Se.E}configurationAllowed(){return(0,M._)(this.currentUser.hasCapabilities$("queries/create",null))}static{this.ɵfac=(()=>{let e;return function WidgetWpTableMenuComponent_Factory(t){return(e||(e=o.xGo(WidgetWpTableMenuComponent)))(t||WidgetWpTableMenuComponent)}})()}static{this.ɵcmp=o.VBU({type:WidgetWpTableMenuComponent,selectors:[["widget-wp-table-menu"]],features:[o.Vt3],decls:1,vars:1,consts:[[3,"menuItemsFactory",4,"ngIf"],[3,"menuItemsFactory"]],template:function WidgetWpTableMenuComponent_Template(e,t){1&e&&o.DNE(0,WidgetWpTableMenuComponent_icon_triggered_context_menu_0_Template,1,1,"icon-triggered-context-menu",0),2&e&&o.Y8G("ngIf",t.hasMenu)},dependencies:[P.bT,E.W],encapsulation:2})}}function WidgetWpTableComponent_wp_embedded_table_2_Template(e,t){if(1&e&&o.nrm(0,"wp-embedded-table",3),2&e){const e=o.XpG();o.Y8G("queryId",e.queryId)("configuration",e.configuration)}}(0,U.Cg)([(0,Q.O)(),(0,U.Sn)("design:type",S.K)],WidgetWpTableMenuComponent.prototype,"currentUser",void 0);class WidgetWpTableComponent extends y.q{constructor(e,t,n,i,o,r){super(e,t),this.i18n=e,this.injector=t,this.urlParamsHelper=n,this.state=i,this.querySpace=o,this.apiV3Service=r,this.inFlight=!1,this.configuration={actionsColumnEnabled:!1,columnMenuEnabled:!1,hierarchyToggleEnabled:!0,contextMenuEnabled:!1}}ngOnInit(){this.resource.options.queryId?this.queryId=this.resource.options.queryId:this.createInitial().subscribe((e=>{const t=this.setChangesetOptions({queryId:e.id});this.resourceChanged.emit(t),this.queryId=e.id})),this.query$=this.querySpace.query.values$(),this.query$.pipe((0,we.i)(2),this.untilDestroyed()).subscribe((e=>{this.ensureFormAndSaveQuery(e)}))}get widgetName(){return this.resource.options.name}static get identifier(){return"work_packages_table"}ensureFormAndSaveQuery(e){this.queryForm?this.saveQuery(e,this.queryForm):this.apiV3Service.queries.form.load(e).subscribe((([t,n])=>{this.queryForm=t,this.saveQuery(e,t)}))}saveQuery(e,t){this.inFlight=!0,this.apiV3Service.queries.id(e).patch(e,this.queryForm).subscribe((()=>this.inFlight=!1),(()=>this.inFlight=!1))}createInitial(){const e=this.state.params.projectPath,t={pageSize:0,...this.resource.options.queryProps};return this.apiV3Service.queries.form.loadWithParams(t,void 0,e,this.queryCreationParams()).pipe((0,ae.n)((([e,t])=>this.apiV3Service.queries.post(t,e).pipe((0,G.T)((e=>(delete this.resource.options.queryProps,e)))))))}queryCreationParams(){return{hidden:!0,public:!!this.state.params.projectPath}}static{this.ɵfac=function WidgetWpTableComponent_Factory(e){return new(e||WidgetWpTableComponent)(o.rXU(w.W),o.rXU(o.zZn),o.rXU(ve.j),o.rXU(ye.dw),o.rXU(Ce.i),o.rXU(O.n))}}static{this.ɵcmp=o.VBU({type:WidgetWpTableComponent,selectors:[["widget-wp-table"]],features:[o.nM4([j.Y]),o.Vt3],decls:3,vars:3,consts:[[3,"onRenamed","name"],["slot","menu",3,"resource"],[3,"queryId","configuration",4,"ngIf"],[3,"queryId","configuration"]],template:function WidgetWpTableComponent_Template(e,t){1&e&&(o.j41(0,"widget-header",0),o.bIt("onRenamed",(function WidgetWpTableComponent_Template_widget_header_onRenamed_0_listener(e){return t.renameWidget(e)})),o.nrm(1,"widget-wp-table-menu",1),o.k0s(),o.DNE(2,WidgetWpTableComponent_wp_embedded_table_2_Template,1,2,"wp-embedded-table",2)),2&e&&(o.Y8G("name",t.widgetName),o.R7$(),o.Y8G("resource",t.resource),o.R7$(),o.Y8G("ngIf",t.queryId))},dependencies:[P.bT,Te.Z,WidgetWpTableMenuComponent,WidgetHeaderComponent],styles:["wp-embedded-table[_ngcontent-%COMP%]{overflow:auto}"],changeDetection:0})}}var je=n(59452);class GridInitializationService{constructor(e,t){this.apiV3Service=e,this.halResourceService=t}initialize(e){return this.apiV3Service.grids.list({filters:[["scope","=",[e]]]}).pipe((0,ae.n)((t=>0===t.total?this.myPageForm(e):(0,je.of)(t.elements[0]))))}myPageForm(e){const t={_links:{scope:{href:e}}};return this.apiV3Service.grids.form.post(t).pipe((0,ae.n)((e=>{const t=e.payload.$source,n=this.halResourceService.createHalResource(t);return 0===n.widgets.length&&(n.rowCount=1,n.columnCount=1),this.apiV3Service.grids.post(n,e.schema)})))}static{this.ɵfac=function GridInitializationService_Factory(e){return new(e||GridInitializationService)(o.KVO(O.n),o.KVO(oe.t))}}static{this.ɵprov=o.jDH({token:GridInitializationService,factory:GridInitializationService.ɵfac})}}class WidgetWpTableQuerySpaceComponent extends y.q{onResourceChanged(e){this.resourceChanged.emit(e)}static{this.ɵfac=(()=>{let e;return function WidgetWpTableQuerySpaceComponent_Factory(t){return(e||(e=o.xGo(WidgetWpTableQuerySpaceComponent)))(t||WidgetWpTableQuerySpaceComponent)}})()}static{this.ɵcmp=o.VBU({type:WidgetWpTableQuerySpaceComponent,selectors:[["ng-component"]],features:[o.Vt3],decls:1,vars:1,consts:[[3,"resourceChanged","resource"]],template:function WidgetWpTableQuerySpaceComponent_Template(e,t){1&e&&(o.j41(0,"widget-wp-table",0),o.bIt("resourceChanged",(function WidgetWpTableQuerySpaceComponent_Template_widget_wp_table_resourceChanged_0_listener(e){return t.onResourceChanged(e)})),o.k0s()),2&e&&o.Y8G("resource",t.resource)},dependencies:[WidgetWpTableComponent],styles:[".op-wp-table-qs[_ngcontent-%COMP%]   widget-wp-table[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}"]})}}var Pe=n(34120),Ie=n(28702);class QuerySpacedTabComponent{constructor(e,t,n){this.I18n=e,this.wpStatesInitialization=t,this.wpGraphConfiguration=n}initializeQuerySpace(){return this.wpGraphConfiguration.formFor(this.query).then((e=>{this.wpStatesInitialization.initialize(this.query,this.query.results),this.wpStatesInitialization.updateStatesFromForm(this.query,e)}))}}var xe=n(12717),Re=n(37313);function WpGraphConfigurationFiltersTabInnerComponent_op_query_filters_0_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"op-query-filters",1),o.bIt("filtersChanged",(function WpGraphConfigurationFiltersTabInnerComponent_op_query_filters_0_Template_op_query_filters_filtersChanged_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.filters=t)})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("filters",e.filters)}}class WpGraphConfigurationFiltersTabInnerComponent extends QuerySpacedTabComponent{constructor(e,t,n,i,o){super(e,i,o),this.I18n=e,this.wpTableFilters=t,this.wpFiltersService=n,this.wpStatesInitialization=i,this.wpGraphConfiguration=o,this.filters=[],this.text={multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect")}}ngOnInit(){this.initializeQuerySpace().then((()=>{this.wpTableFilters.onReady().then((()=>{this.filters=this.wpTableFilters.current}))}))}onSave(){this.filters&&(this.wpTableFilters.replaceIfComplete(this.filters),this.wpTableFilters.applyToQuery(this.wpGraphConfiguration.queries[0]))}get query(){return this.wpGraphConfiguration.queries[0]}static{this.ɵfac=function WpGraphConfigurationFiltersTabInnerComponent_Factory(e){return new(e||WpGraphConfigurationFiltersTabInnerComponent)(o.rXU(w.W),o.rXU(Pe.N),o.rXU(xe.a),o.rXU(Ie.V),o.rXU(WpGraphConfigurationService))}}static{this.ɵcmp=o.VBU({type:WpGraphConfigurationFiltersTabInnerComponent,selectors:[["op-filters-tab-inner"]],features:[o.Vt3],decls:1,vars:1,consts:[[3,"filters","filtersChanged",4,"ngIf"],[3,"filtersChanged","filters"]],template:function WpGraphConfigurationFiltersTabInnerComponent_Template(e,t){1&e&&o.DNE(0,WpGraphConfigurationFiltersTabInnerComponent_op_query_filters_0_Template,1,1,"op-query-filters",0),2&e&&o.Y8G("ngIf",!!t.filters)},dependencies:[P.bT,Re.l],encapsulation:2})}}var Fe=n(1750);const settings_tab_inner_component_c0=()=>({standalone:!0});function WpGraphConfigurationSettingsTabInnerComponent_option_7_Template(e,t){if(1&e&&o.nrm(0,"option",9),2&e){const e=t.$implicit;o.Y8G("ngValue",e)("textContent",e.name)}}function WpGraphConfigurationSettingsTabInnerComponent_option_13_Template(e,t){if(1&e&&o.nrm(0,"option",9),2&e){const e=t.$implicit;o.Y8G("ngValue",e)("textContent",e.label)}}class WpGraphConfigurationSettingsTabInnerComponent extends QuerySpacedTabComponent{constructor(e,t,n,i){super(e,n,i),this.I18n=e,this.wpTableGroupBy=t,this.wpStatesInitialization=n,this.wpGraphConfiguration=i,this.availableGroups=[],this.text={group_by:this.I18n.t("js.chart.axis_criteria"),chart_type:this.I18n.t("js.chart.type")}}onSave(){this.wpGraphConfiguration.chartType=this.currentChartType.identifier,this.wpGraphConfiguration.queries.forEach((e=>{this.wpTableGroupBy.applyToQuery(e)}))}get currentGroup(){return this.wpTableGroupBy.current}set currentGroup(e){this.wpTableGroupBy.update(e)}ngOnInit(){this.initializeQuerySpace().then((()=>{this.wpTableGroupBy.onReady().then((()=>{this.initializeAvailableGroups(),this.initializeAvailableChartType()}))}))}initializeAvailableGroups(){let{available:e}=this.wpTableGroupBy;const{current:t}=this.wpTableGroupBy;t&&(e=e.filter((e=>e.id!==t.id)),e=e.concat(t)),this.availableGroups=_.sortBy(e,"name")}initializeAvailableChartType(){this.availableChartTypes=_.sortBy([{identifier:"horizontalBar",label:this.I18n.t("js.chart.types.horizontal_bar")},{identifier:"bar",label:this.I18n.t("js.chart.types.bar")},{identifier:"line",label:this.I18n.t("js.chart.types.line")},{identifier:"pie",label:this.I18n.t("js.chart.types.pie")},{identifier:"doughnut",label:this.I18n.t("js.chart.types.doughnut")},{identifier:"radar",label:this.I18n.t("js.chart.types.radar")},{identifier:"polarArea",label:this.I18n.t("js.chart.types.polar_area")}],"label"),this.currentChartType=this.availableChartTypes.find((e=>e.identifier===this.wpGraphConfiguration.configuration.chartType))||this.availableChartTypes[0]}get query(){return this.wpGraphConfiguration.queries[0]}static{this.ɵfac=function WpGraphConfigurationSettingsTabInnerComponent_Factory(e){return new(e||WpGraphConfigurationSettingsTabInnerComponent)(o.rXU(w.W),o.rXU(Fe.W),o.rXU(Ie.V),o.rXU(WpGraphConfigurationService))}}static{this.ɵcmp=o.VBU({type:WpGraphConfigurationSettingsTabInnerComponent,selectors:[["op-settings-tab-inner"]],features:[o.Vt3],decls:14,vars:10,consts:[[1,"form"],[1,"form--field"],["for","selected_grouping",1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--select-container","-middle"],["id","selected_grouping",1,"form--select",3,"ngModelChange","ngModel","ngModelOptions"],[3,"ngValue","textContent",4,"ngFor","ngForOf"],["for","selected_chart_type",1,"form--label",3,"textContent"],["id","selected_chart_type",1,"form--select",3,"ngModelChange","ngModel","ngModelOptions"],[3,"ngValue","textContent"]],template:function WpGraphConfigurationSettingsTabInnerComponent_Template(e,t){1&e&&(o.j41(0,"div")(1,"form",0)(2,"div",1),o.nrm(3,"label",2),o.j41(4,"div",3)(5,"div",4)(6,"select",5),o.mxI("ngModelChange",(function WpGraphConfigurationSettingsTabInnerComponent_Template_select_ngModelChange_6_listener(e){return o.DH7(t.currentGroup,e)||(t.currentGroup=e),e})),o.DNE(7,WpGraphConfigurationSettingsTabInnerComponent_option_7_Template,1,2,"option",6),o.k0s()()()(),o.j41(8,"div",1),o.nrm(9,"label",7),o.j41(10,"div",3)(11,"div",4)(12,"select",8),o.mxI("ngModelChange",(function WpGraphConfigurationSettingsTabInnerComponent_Template_select_ngModelChange_12_listener(e){return o.DH7(t.currentChartType,e)||(t.currentChartType=e),e})),o.DNE(13,WpGraphConfigurationSettingsTabInnerComponent_option_13_Template,1,2,"option",6),o.k0s()()()()()()),2&e&&(o.R7$(3),o.Y8G("textContent",t.text.group_by),o.R7$(3),o.R50("ngModel",t.currentGroup),o.Y8G("ngModelOptions",o.lJ4(8,settings_tab_inner_component_c0)),o.R7$(),o.Y8G("ngForOf",t.availableGroups),o.R7$(2),o.Y8G("textContent",t.text.chart_type),o.R7$(3),o.R50("ngModel",t.currentChartType),o.Y8G("ngModelOptions",o.lJ4(9,settings_tab_inner_component_c0)),o.R7$(),o.Y8G("ngForOf",t.availableChartTypes))},dependencies:[P.Sq,a.qT,a.xH,a.y7,a.wz,a.BC,a.cb,a.vS,a.cV],encapsulation:2})}}const Me=["wpEmbeddedGraphMulti"],Oe=["wpEmbeddedGraphSingle"];function WorkPackageOverviewGraphComponent_option_1_Template(e,t){if(1&e&&(o.j41(0,"option",6),o.EFF(1),o.k0s()),2&e){const e=t.$implicit;o.Y8G("ngValue",e.key),o.R7$(),o.JRh(e.label)}}function WorkPackageOverviewGraphComponent_div_2_Template(e,t){if(1&e&&(o.j41(0,"div",7),o.nrm(1,"div",8),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.Y8G("textContent",e.error)}}function WorkPackageOverviewGraphComponent_op_wp_embedded_graph_3_Template(e,t){if(1&e&&o.nrm(0,"op-wp-embedded-graph",9,0),2&e){const e=o.XpG();o.Y8G("datasets",e.datasets)("chartOptions",e.chartOptions)}}function WorkPackageOverviewGraphComponent_op_wp_embedded_graph_4_Template(e,t){if(1&e&&o.nrm(0,"op-wp-embedded-graph",9,1),2&e){const e=o.XpG();o.Y8G("datasets",e.datasets)("chartOptions",e.chartOptions)}}class WorkPackageOverviewGraphComponent{constructor(e,t,n,i){this.elementRef=e,this.I18n=t,this.graphConfigurationService=n,this.cdr=i,this.groupBy="status",this.chartOptions={maintainAspectRatio:!1},this.datasets=[],this.displayModeSingle=!0,this.error=null,this.availableGroupBy=[{label:t.t("js.work_packages.properties.category"),key:"category"},{label:t.t("js.work_packages.properties.type"),key:"type"},{label:t.t("js.work_packages.properties.status"),key:"status"},{label:t.t("js.work_packages.properties.priority"),key:"priority"},{label:t.t("js.work_packages.properties.author"),key:"author"},{label:t.t("js.work_packages.properties.assignee"),key:"assignee"}]}ngOnInit(){const e=this.elementRef.nativeElement;this.initialFilters=JSON.parse(e.getAttribute("initial-filters")||"null"),this.globalScope="true"===e.getAttribute("global-scope"),this.setQueryProps()}setQueryProps(){this.datasets=[];const e=this.graphParams;this.graphConfigurationService.configuration=new WpGraphConfiguration(e,{},"horizontalBar"),this.graphConfigurationService.globalScope=this.globalScope,this.graphConfigurationService.reloadQueries().then((()=>{this.datasets=this.sortedDatasets(this.graphConfigurationService.datasets,e),this.cdr.detectChanges()})).catch((()=>{this.error=this.I18n.t("js.chart.errors.could_not_load"),this.cdr.detectChanges()}))}get graphParams(){const e=[];return"status"===this.groupBy?(this.displayModeSingle=!0,e.push({name:this.I18n.t("js.label_all"),props:this.propsBoth})):(this.displayModeSingle=!1,e.push({name:this.I18n.t("js.label_open_work_packages"),props:this.propsOpen}),e.push({name:this.I18n.t("js.label_closed_work_packages"),props:this.propsClosed})),e}sortedDatasets(e,t){const n=t.map((e=>e.name));return e.slice().sort(((e,t)=>n.indexOf(e.label)-n.indexOf(t.label)))}get propsBoth(){return this.baseProps()}get propsOpen(){return this.baseProps({status:{operator:"o",values:[]}})}get propsClosed(){return this.baseProps({status:{operator:"c",values:[]}})}baseProps(e){const t=[];return Array.isArray(this.initialFilters)?t.push(...this.initialFilters):t.push({subprojectId:{operator:"*",values:[]}}),e&&t.push(e),{"columns[]":[],filters:JSON.stringify(t),group_by:this.groupBy,pageSize:0}}get displaySingle(){return this.displayModeSingle}get displayMulti(){return!this.displayModeSingle}get currentGraph(){return this.displaySingle?this.embeddedGraphSingle:this.embeddedGraphMulti}static{this.ɵfac=function WorkPackageOverviewGraphComponent_Factory(e){return new(e||WorkPackageOverviewGraphComponent)(o.rXU(o.aKT),o.rXU(w.W),o.rXU(WpGraphConfigurationService),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:WorkPackageOverviewGraphComponent,selectors:[["opce-wp-overview-graph"]],viewQuery:function WorkPackageOverviewGraphComponent_Query(e,t){if(1&e&&(o.GBs(Me,5),o.GBs(Oe,5)),2&e){let e;o.mGM(e=o.lsd())&&(t.embeddedGraphMulti=e.first),o.mGM(e=o.lsd())&&(t.embeddedGraphSingle=e.first)}},inputs:{initialFilters:"initialFilters",globalScope:"globalScope",groupBy:"groupBy",chartOptions:"chartOptions"},features:[o.Jv_([WpGraphConfigurationService])],decls:5,vars:5,consts:[["wpEmbeddedGraphMulti",""],["wpEmbeddedGraphSingle",""],[3,"ngModelChange","ngModel"],[3,"ngValue",4,"ngFor","ngForOf"],["class","op-toast -error",4,"ngIf"],[3,"datasets","chartOptions",4,"ngIf"],[3,"ngValue"],[1,"op-toast","-error"],[1,"op-toast--content",3,"textContent"],[3,"datasets","chartOptions"]],template:function WorkPackageOverviewGraphComponent_Template(e,t){1&e&&(o.j41(0,"select",2),o.mxI("ngModelChange",(function WorkPackageOverviewGraphComponent_Template_select_ngModelChange_0_listener(e){return o.DH7(t.groupBy,e)||(t.groupBy=e),e})),o.bIt("ngModelChange",(function WorkPackageOverviewGraphComponent_Template_select_ngModelChange_0_listener(){return t.setQueryProps()})),o.DNE(1,WorkPackageOverviewGraphComponent_option_1_Template,2,2,"option",3),o.k0s(),o.DNE(2,WorkPackageOverviewGraphComponent_div_2_Template,2,1,"div",4)(3,WorkPackageOverviewGraphComponent_op_wp_embedded_graph_3_Template,2,2,"op-wp-embedded-graph",5)(4,WorkPackageOverviewGraphComponent_op_wp_embedded_graph_4_Template,2,2,"op-wp-embedded-graph",5)),2&e&&(o.R50("ngModel",t.groupBy),o.R7$(),o.Y8G("ngForOf",t.availableGroupBy),o.R7$(),o.Y8G("ngIf",t.error),o.R7$(),o.Y8G("ngIf",t.displayMulti),o.R7$(),o.Y8G("ngIf",t.displaySingle))},dependencies:[P.Sq,P.bT,a.xH,a.y7,a.wz,a.BC,a.vS,WorkPackageEmbeddedGraphComponent],styles:["wp-embedded-graph[_ngcontent-%COMP%]{margin-top:20px;display:block}"],changeDetection:0})}}var De=n(99014);class OpenprojectWorkPackageGraphsModule{constructor(){}static{this.ɵfac=function OpenprojectWorkPackageGraphsModule_Factory(e){return new(e||OpenprojectWorkPackageGraphsModule)}}static{this.ɵmod=o.$C({type:OpenprojectWorkPackageGraphsModule})}static{this.ɵinj=o.G2t({imports:[d.d,k.p,h.W,pe.FR,De.q]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenprojectWorkPackageGraphsModule,{declarations:[WpGraphConfigurationModalComponent,WpGraphConfigurationFiltersTabComponent,WpGraphConfigurationFiltersTabInnerComponent,WpGraphConfigurationSettingsTabComponent,WpGraphConfigurationSettingsTabInnerComponent,WorkPackageEmbeddedGraphComponent,WorkPackageOverviewGraphComponent],imports:[d.d,k.p,h.W,pe.FR,De.q],exports:[WpGraphConfigurationModalComponent,WorkPackageEmbeddedGraphComponent,WorkPackageOverviewGraphComponent]}),o.wjB(WpGraphConfigurationFiltersTabComponent,[WpGraphConfigurationFiltersTabInnerComponent],[]),o.wjB(WpGraphConfigurationSettingsTabComponent,[WpGraphConfigurationSettingsTabInnerComponent],[]);var Ge=n(51339),Ee=n(11385),Ae=n(34539),Ve=n(8958);function WidgetProjectDescriptionComponent_edit_form_4_Template(e,t){if(1&e&&(o.j41(0,"edit-form",5),o.nrm(1,"op-editable-attribute-field",6),o.k0s()),2&e){const e=t.ngIf;o.Y8G("resource",e),o.R7$(),o.Y8G("resource",e)}}class WidgetProjectDescriptionComponent extends y.q{constructor(e,t,n,i,o){super(e,t),this.i18n=e,this.injector=t,this.apiV3Service=n,this.currentProject=i,this.cdRef=o}ngOnInit(){this.currentProject.id&&(this.project$=this.apiV3Service.projects.id(this.currentProject.id).get(),this.cdRef.detectChanges())}get isEditable(){return!1}static{this.ɵfac=function WidgetProjectDescriptionComponent_Factory(e){return new(e||WidgetProjectDescriptionComponent)(o.rXU(w.W),o.rXU(o.zZn),o.rXU(O.n),o.rXU(T.c),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:WidgetProjectDescriptionComponent,selectors:[["ng-component"]],features:[o.Jv_([Ge.p]),o.Vt3],decls:6,vars:7,consts:[[3,"name","editable"],["slot","prepend","attribute","description",3,"attributeScope"],["slot","menu",3,"resource"],[1,"grid--widget-content","-allow-inner-overflow"],[3,"resource",4,"ngIf"],[3,"resource"],["fieldName","description",3,"resource"]],template:function WidgetProjectDescriptionComponent_Template(e,t){1&e&&(o.j41(0,"widget-header",0),o.nrm(1,"attribute-help-text",1)(2,"widget-menu",2),o.k0s(),o.j41(3,"div",3),o.DNE(4,WidgetProjectDescriptionComponent_edit_form_4_Template,2,2,"edit-form",4),o.nI1(5,"async"),o.k0s()),2&e&&(o.Y8G("name",t.widgetName)("editable",t.isEditable),o.R7$(),o.Y8G("attributeScope","Project"),o.R7$(),o.Y8G("resource",t.resource),o.R7$(2),o.Y8G("ngIf",o.bMT(5,5,t.project$)))},dependencies:[P.bT,Ee.e,Ae.G,Ve.c,WidgetMenuComponent,WidgetHeaderComponent,P.Jj],encapsulation:2,changeDetection:0})}}class WidgetWpOverviewComponent extends y.q{static{this.ɵfac=(()=>{let e;return function WidgetWpOverviewComponent_Factory(t){return(e||(e=o.xGo(WidgetWpOverviewComponent)))(t||WidgetWpOverviewComponent)}})()}static{this.ɵcmp=o.VBU({type:WidgetWpOverviewComponent,selectors:[["ng-component"]],features:[o.Vt3],decls:3,vars:3,consts:[[3,"onRenamed","name"],["slot","menu",3,"resource"],[1,"grid--widget-content","-no-overflow",3,"groupBy"]],template:function WidgetWpOverviewComponent_Template(e,t){1&e&&(o.j41(0,"widget-header",0),o.bIt("onRenamed",(function WidgetWpOverviewComponent_Template_widget_header_onRenamed_0_listener(e){return t.renameWidget(e)})),o.nrm(1,"widget-menu",1),o.k0s(),o.nrm(2,"opce-wp-overview-graph",2)),2&e&&(o.Y8G("name",t.widgetName),o.R7$(),o.Y8G("resource",t.resource),o.R7$(),o.Y8G("groupBy","type"))},dependencies:[WorkPackageOverviewGraphComponent,WidgetMenuComponent,WidgetHeaderComponent],encapsulation:2,changeDetection:0})}}var $e=n(41804),Be=n(38429),We=n(44674);class CustomTextEditFieldService extends $e.L{constructor(e,t,n,i){super(),this.elementRef=e,this.injector=t,this.halResource=n,this.schemaCache=i,this.fieldName="text"}initialize(e){this.initializeChangeset(e),this.valueChanged$=new F.t(e.options.text)}reinitialize(e){this.initializeChangeset(e)}handleUserSubmit(){return this.update()}reset(e=""){let t=e;e.length>0&&(t+="\n"),this.changeset.setValue(this.fieldName,{raw:t})}get schema(){return{name:I18n.t("js.grid.widgets.custom_text.title"),writable:!0,required:!1,type:"Formattable",hasDefault:!1}}update(){var e=this;return(0,x.A)((function*(){return e.onSubmit().then((()=>{e.valueChanged$.next(e.rawText),e.deactivate()}))}))()}get rawText(){return _.get(this.textValue,"raw","")}get htmlText(){return _.get(this.textValue,"html","")}get textValue(){return this.changeset.value(this.fieldName)}handleUserCancel(){this.deactivate()}deactivate(){this.changeset.clear(),this.active=!1}activate(){this.active=!0}get inEditMode(){return!1}get inFlight(){return this.changeset.inFlight}focus(){const e=this.elementRef.nativeElement.querySelector(".inplace-editing--trigger-container");e&&e.focus()}setErrors(){}handleUserKeydown(){}isChanged(){return!this.changeset.isEmpty()}stopPropagation(){return!1}initializeChangeset(e){const t="customtext-schema",n=e.grid,i={id:`${n.id}_custom_text`,text:e.options.text,getEditorContext:()=>({type:"full",macros:"resource"}),canAddAttachments:e.grid.canAddAttachments,_links:{addAttachment:n.addAttachment,attachments:n.attachments,schema:{href:t}}};n.prepareAttachment&&(i._links.prepareAttachment=n.prepareAttachment);const o=this.halResource.createHalResource(i,!0),r={text:this.schema,_links:{self:{href:t}}},s=this.halResource.createHalResource(r,!0);this.schemaCache.update(o,s),this.changeset=new Be.b(o)}static{this.ɵfac=function CustomTextEditFieldService_Factory(e){return new(e||CustomTextEditFieldService)(o.KVO(o.aKT),o.KVO(o.zZn),o.KVO(oe.t),o.KVO(We.D))}}static{this.ɵprov=o.jDH({token:CustomTextEditFieldService,factory:CustomTextEditFieldService.ɵfac})}}var Ne=n(66913),Ue=n(43063);const Ye=["displayContainer"],custom_text_component_c1=e=>({"inline-edit--container":e});function WidgetCustomTextComponent_ng_template_2_div_2_Template(e,t){if(1&e&&o.nrm(0,"div",12),2&e){const e=o.XpG(2);o.Y8G("innerHTML",e.customText,o.npT)}}function WidgetCustomTextComponent_ng_template_2_div_3_Template(e,t){if(1&e&&o.nrm(0,"div",13),2&e){const e=o.XpG(2);o.Y8G("innerHTML",e.placeholderText,o.npT)}}function WidgetCustomTextComponent_ng_template_2_Template(e,t){if(1&e&&(o.j41(0,"span",9,1),o.DNE(2,WidgetCustomTextComponent_ng_template_2_div_2_Template,1,1,"div",10)(3,WidgetCustomTextComponent_ng_template_2_div_3_Template,1,1,"div",11),o.k0s()),2&e){const e=o.XpG();o.R7$(2),o.Y8G("ngIf",!e.textEmpty),o.R7$(),o.Y8G("ngIf",e.textEmpty)}}function WidgetCustomTextComponent_edit_form_portal_6_Template(e,t){if(1&e&&o.nrm(0,"edit-form-portal",14),2&e){const e=o.XpG();o.Y8G("schemaInput",e.schema)("changeInput",e.changeset)("editFieldHandler",e.handler)}}function WidgetCustomTextComponent_fieldset_7_Template(e,t){if(1&e&&(o.j41(0,"fieldset",15)(1,"legend",16),o.EFF(2),o.k0s(),o.nrm(3,"op-attachments",17),o.k0s()),2&e){const e=o.XpG(),t=o.sdS(3);o.R7$(2),o.SpI(" ",t.attachments," "),o.R7$(),o.Y8G("resource",e.resource.grid)}}function WidgetCustomTextComponent_div_8_button_1_ng_container_1_Template(e,t){1&e&&o.eu8(0)}function WidgetCustomTextComponent_div_8_button_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"button",21),o.bIt("click",(function WidgetCustomTextComponent_div_8_button_1_Template_button_click_0_listener(t){o.eBV(e);const n=o.XpG(2);return o.Njj(n.activate(t))})),o.DNE(1,WidgetCustomTextComponent_div_8_button_1_ng_container_1_Template,1,0,"ng-container",22),o.k0s()}if(2&e){const e=o.XpG(2),t=o.sdS(3);o.Y8G("ngClass",e.inplaceEditClasses),o.R7$(),o.Y8G("ngTemplateOutlet",t)}}function WidgetCustomTextComponent_div_8_ng_container_2_ng_container_1_Template(e,t){1&e&&o.eu8(0)}function WidgetCustomTextComponent_div_8_ng_container_2_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,WidgetCustomTextComponent_div_8_ng_container_2_ng_container_1_Template,1,0,"ng-container",22),o.bVm()),2&e){o.XpG(2);const e=o.sdS(3);o.R7$(),o.Y8G("ngTemplateOutlet",e)}}function WidgetCustomTextComponent_div_8_Template(e,t){if(1&e&&(o.j41(0,"div",18),o.DNE(1,WidgetCustomTextComponent_div_8_button_1_Template,2,2,"button",19)(2,WidgetCustomTextComponent_div_8_ng_container_2_Template,2,1,"ng-container",20),o.k0s()),2&e){const e=o.XpG();o.Y8G("ngClass",o.eq3(3,custom_text_component_c1,e.isTextEditable)),o.R7$(),o.Y8G("ngIf",e.isTextEditable),o.R7$(),o.Y8G("ngIf",!e.isTextEditable)}}class WidgetCustomTextComponent extends y.q{constructor(e,t,n,i,o,r,s){super(e,t),this.I18n=e,this.injector=t,this.handler=n,this.cdr=i,this.sanitization=o,this.appRef=r,this.layout=s,this.text={attachments:this.I18n.t("js.label_attachments")}}ngOnInit(){this.setupVariables(!0),this.handler.valueChanged$.pipe(this.untilDestroyed(),(0,Z.p)((e=>e!==this.resource.options.text))).subscribe((e=>{const t=this.setChangesetOptions({text:{raw:e}});this.resourceChanged.emit(t)}))}ngOnChanges(e){e.resource.currentValue.options.text.raw!==this.currentRawText&&(this.setupVariables(),this.cdr.detectChanges())}activate(e){this.clickedElementIsLinkWithinDisplayContainer(e)||this.resource.grid.updateAttachments().then((()=>{this.handler.activate(),this.cdr.detectChanges()}))}get placeholderText(){return this.I18n.t("js.grid.widgets.work_packages_overview.placeholder")}get inplaceEditClasses(){let e="inplace-editing--container inline-edit--display-field -editable";return this.textEmpty&&(e+=" -placeholder"),e}get schema(){return this.handler.schema}get changeset(){return this.handler.changeset}get active(){return this.handler.active}get textEmpty(){return!this.currentRawText.length}get isTextEditable(){return this.layout.isEditable}setupVariables(e=!1){this.memorizeRawText(),e?this.handler.initialize(this.resource):this.handler.reinitialize(this.resource),this.memorizeCustomText()}memorizeRawText(){this.currentRawText=this.resource.options.text.raw}memorizeCustomText(){this.customText=this.sanitization.bypassSecurityTrustHtml(this.handler.htmlText)}clickedElementIsLinkWithinDisplayContainer(e){return this.displayContainer.nativeElement.contains(e.target.closest("a,macro"))}static{this.ɵfac=function WidgetCustomTextComponent_Factory(e){return new(e||WidgetCustomTextComponent)(o.rXU(w.W),o.rXU(o.zZn),o.rXU(CustomTextEditFieldService),o.rXU(o.gRc),o.rXU(i.up),o.rXU(o.o8S),o.rXU(GridAreaService))}}static{this.ɵcmp=o.VBU({type:WidgetCustomTextComponent,selectors:[["ng-component"]],viewQuery:function WidgetCustomTextComponent_Query(e,t){if(1&e&&o.GBs(Ye,5),2&e){let e;o.mGM(e=o.lsd())&&(t.displayContainer=e.first)}},features:[o.Jv_([CustomTextEditFieldService]),o.Vt3,o.OA$],decls:9,vars:5,consts:[["text",""],["displayContainer",""],[3,"onRenamed","name"],["slot","menu",3,"resource"],[1,"grid--widget-content","-custom-text","-allow-inner-overflow"],[1,"inline-edit--container","inplace-edit"],[3,"schemaInput","changeInput","editFieldHandler",4,"ngIf"],["class","form--fieldset",4,"ngIf"],["class","inplace-edit--read wiki -no-label",3,"ngClass",4,"ngIf"],[1,"inline-edit--formattable-display-text","-default"],["class","op-uc-container",3,"innerHTML",4,"ngIf"],[3,"innerHTML",4,"ngIf"],[1,"op-uc-container",3,"innerHTML"],[3,"innerHTML"],[3,"schemaInput","changeInput","editFieldHandler"],[1,"form--fieldset"],[1,"form--fieldset-legend"],[3,"resource"],[1,"inplace-edit--read","wiki","-no-label",3,"ngClass"],["type","button",3,"ngClass","click",4,"ngIf"],[4,"ngIf"],["type","button",3,"click","ngClass"],[4,"ngTemplateOutlet"]],template:function WidgetCustomTextComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"widget-header",2),o.bIt("onRenamed",(function WidgetCustomTextComponent_Template_widget_header_onRenamed_0_listener(n){return o.eBV(e),o.Njj(t.renameWidget(n))})),o.nrm(1,"widget-menu",3),o.k0s(),o.DNE(2,WidgetCustomTextComponent_ng_template_2_Template,4,2,"ng-template",null,0,o.C5r),o.j41(4,"div",4)(5,"div",5),o.DNE(6,WidgetCustomTextComponent_edit_form_portal_6_Template,1,3,"edit-form-portal",6)(7,WidgetCustomTextComponent_fieldset_7_Template,4,2,"fieldset",7)(8,WidgetCustomTextComponent_div_8_Template,3,5,"div",8),o.k0s()()}2&e&&(o.Y8G("name",t.widgetName),o.R7$(),o.Y8G("resource",t.resource),o.R7$(5),o.Y8G("ngIf",t.active),o.R7$(),o.Y8G("ngIf",t.active),o.R7$(),o.Y8G("ngIf",!t.active))},dependencies:[P.YU,P.bT,P.T3,Ne.r,Ue.u,WidgetMenuComponent,WidgetHeaderComponent],encapsulation:2,changeDetection:0})}}var Xe=n(22842),qe=n(48908);class WidgetTimeEntriesListComponent extends y.q{constructor(e,t,n,i,o,r){super(n,e),this.injector=e,this.timezone=t,this.i18n=n,this.pathHelper=i,this.confirmDialog=o,this.cdr=r,this.text={edit:this.i18n.t("js.button_edit"),delete:this.i18n.t("js.button_delete"),confirmDelete:{text:this.i18n.t("js.modals.destroy_time_entry.text"),title:this.i18n.t("js.modals.destroy_time_entry.title")},noResults:this.i18n.t("js.grid.widgets.time_entries_list.no_results"),placeholder:this.i18n.t("js.placeholders.default")},this.entries=[],this.entriesLoaded=!1,this.rows=[]}ngOnInit(){var e=this;this.apiV3Service.time_entries.list({filters:this.dmFilters(),pageSize:500}).subscribe(function(){var t=(0,x.A)((function*(t){e.buildEntries(t.elements),t.count>0&&(e.schema=yield(0,M._)(e.loadSchema())),e.entriesLoaded=!0,e.cdr.detectChanges()}));return function(e){return t.apply(this,arguments)}}())}get total(){const e=this.entries.reduce(((e,t)=>e+this.timezone.toHours(t.hours)),0);return this.i18n.t("js.units.hour",{count:e})}get anyEntries(){return!!this.entries.length}activityName(e){return e.activity?e.activity.name:this.text.placeholder}projectName(e){return e.project.name}workPackageName(e){return`#${e.workPackage.id}: ${e.workPackage.name}`}workPackageId(e){return e.workPackage.id}comment(e){return e.comment&&e.comment.raw}hours(e){return this.formatNumber(this.timezone.toHours(e.hours))}workPackagePath(e){return this.pathHelper.workPackagePath((0,be.A)(e.workPackage.href))}get isEditable(){return!1}editTimeEntry(e){this.apiV3Service.time_entries.id(e.id).get().subscribe((e=>{this.timeEntryEditService.edit(e).then((e=>{const t=this.entries.findIndex((t=>t.id===e.entry.id)),n=this.entries;n[t]=e.entry,this.buildEntries(n)})).catch((()=>{}))}))}deleteIfConfirmed(e,t){e.preventDefault(),this.confirmDialog.confirm({text:this.text.confirmDelete,closeByEscape:!0,showClose:!0,closeByDocument:!0,passedData:[`#${(0,be.A)(t.workPackage?.href)} ${t.workPackage?.name}`,`${this.i18n.t("js.units.hour",{count:this.timezone.toHours(t.hours)})} (${t.activity?.name})`],dangerHighlighting:!0}).then((()=>{t.delete().then((()=>{const e=this.entries.filter((e=>t.id!==e.id));this.buildEntries(e)}))})).catch((()=>{}))}buildEntries(e){this.entries=e;const t={};e.forEach((e=>{const n=e.spentOn;t[n]||(t[n]=0),t[n]+=this.timezone.toHours(e.hours)}));const n=e.sort(((e,t)=>t.spentOn.localeCompare(e.spentOn)));this.rows=[];let i=null;n.forEach((e=>{e.spentOn!==i&&(i=e.spentOn,this.rows.push({date:this.timezone.formattedDate(i),sum:this.formatNumber(t[i])})),this.rows.push({date:i,entry:e})}))}formatNumber(e){return this.i18n.toNumber(e,{precision:2})}get noEntries(){return!this.entries.length&&this.entriesLoaded}loadSchema(){return this.apiV3Service.time_entries.schema.get()}static{this.ɵfac=function WidgetTimeEntriesListComponent_Factory(e){return new(e||WidgetTimeEntriesListComponent)(o.rXU(o.zZn),o.rXU(W.D),o.rXU(w.W),o.rXU(B.B),o.rXU(qe.g),o.rXU(o.gRc))}}static{this.ɵdir=o.FsC({type:WidgetTimeEntriesListComponent,features:[o.Vt3]})}}(0,U.Cg)([(0,Q.O)(),(0,U.Sn)("design:type",Xe.r)],WidgetTimeEntriesListComponent.prototype,"timeEntryEditService",void 0),(0,U.Cg)([(0,Q.O)(),(0,U.Sn)("design:type",O.n)],WidgetTimeEntriesListComponent.prototype,"apiV3Service",void 0);var Le=n(46765);function WidgetTimeEntriesProjectComponent_op_no_results_2_Template(e,t){if(1&e&&o.nrm(0,"op-no-results",4),2&e){const e=o.XpG();o.Y8G("title",e.text.noResults)}}function WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_td_1_Template(e,t){if(1&e&&o.nrm(0,"td",26),2&e){const e=o.XpG().$implicit,t=o.XpG(3);o.Y8G("textContent",t.activityName(e.entry))}}function WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_td_2_Template(e,t){if(1&e&&(o.j41(0,"td",27),o.nrm(1,"strong",6),o.k0s()),2&e){const e=o.XpG().$implicit;o.R7$(),o.Y8G("textContent",e.date)}}function WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_td_3_Template(e,t){if(1&e&&(o.j41(0,"td",28),o.EFF(1),o.nrm(2,"a",29),o.k0s()),2&e){const e=o.XpG().$implicit,t=o.XpG(3);o.R7$(),o.SpI(" ",t.projectName(e.entry)," - "),o.R7$(),o.Y8G("href",t.workPackagePath(e.entry),o.B4B)("textContent",t.workPackageName(e.entry))}}function WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_td_4_Template(e,t){if(1&e&&o.nrm(0,"td",30),2&e){const e=o.XpG().$implicit,t=o.XpG(3);o.Y8G("textContent",t.projectName(e.entry))}}function WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_td_5_Template(e,t){if(1&e&&o.nrm(0,"td",31),2&e){const e=o.XpG().$implicit,t=o.XpG(3);o.Y8G("textContent",t.comment(e.entry))}}function WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_td_6_Template(e,t){if(1&e&&o.nrm(0,"td",32),2&e){const e=o.XpG().$implicit,t=o.XpG(3);o.Y8G("textContent",t.hours(e.entry))}}function WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_td_7_Template(e,t){if(1&e&&(o.j41(0,"td",33),o.nrm(1,"em",6),o.k0s()),2&e){const e=o.XpG().$implicit;o.R7$(),o.Y8G("textContent",e.sum)}}function WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_a_9_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"a",34),o.bIt("click",(function WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_a_9_Template_a_click_0_listener(){o.eBV(e);const t=o.XpG().$implicit,n=o.XpG(3);return o.Njj(n.editTimeEntry(t.entry))})),o.nrm(1,"op-icon",35),o.k0s()}if(2&e){const e=o.XpG().$implicit,t=o.XpG(3);o.x72("data-test-selector","edit-time-entry-",e.entry.id,""),o.Y8G("title",t.text.edit)}}function WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_a_10_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"a",34),o.bIt("click",(function WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_a_10_Template_a_click_0_listener(t){o.eBV(e);const n=o.XpG().$implicit,i=o.XpG(3);return o.Njj(i.deleteIfConfirmed(t,n.entry))})),o.nrm(1,"op-icon",36),o.k0s()}if(2&e){const e=o.XpG(4);o.Y8G("title",e.text.delete)}}function WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_Template(e,t){if(1&e&&(o.j41(0,"tr",16),o.DNE(1,WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_td_1_Template,1,1,"td",17)(2,WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_td_2_Template,2,1,"td",18)(3,WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_td_3_Template,3,3,"td",19)(4,WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_td_4_Template,1,1,"td",20)(5,WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_td_5_Template,1,1,"td",21)(6,WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_td_6_Template,1,1,"td",22)(7,WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_td_7_Template,2,1,"td",23),o.j41(8,"td",24),o.DNE(9,WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_a_9_Template,2,3,"a",25)(10,WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_a_10_Template,2,1,"a",25),o.k0s()()),2&e){const e=t.$implicit;o.R7$(),o.Y8G("ngIf",e.entry),o.R7$(),o.Y8G("ngIf",e.sum),o.R7$(),o.Y8G("ngIf",e.entry&&e.entry.workPackage),o.R7$(),o.Y8G("ngIf",e.entry&&!e.entry.workPackage),o.R7$(),o.Y8G("ngIf",e.entry),o.R7$(),o.Y8G("ngIf",e.entry),o.R7$(),o.Y8G("ngIf",e.sum),o.R7$(2),o.Y8G("ngIf",e.entry&&e.entry.updateImmediately),o.R7$(),o.Y8G("ngIf",e.entry&&e.entry.delete)}}function WidgetTimeEntriesProjectComponent_ng_container_3_div_5_Template(e,t){if(1&e&&(o.j41(0,"div",8)(1,"table",9)(2,"colgroup"),o.nrm(3,"col")(4,"col")(5,"col")(6,"col")(7,"col",10),o.k0s(),o.j41(8,"thead",11)(9,"tr")(10,"th")(11,"div",12)(12,"div",13),o.nrm(13,"span",6),o.k0s()()(),o.j41(14,"th")(15,"div",12)(16,"div",13),o.nrm(17,"span",6),o.k0s()()(),o.j41(18,"th")(19,"div",12)(20,"div",13),o.nrm(21,"span",6),o.k0s()()(),o.j41(22,"th")(23,"div",12)(24,"div",13),o.nrm(25,"span",6),o.k0s()()(),o.j41(26,"th"),o.nrm(27,"div",14),o.k0s()()(),o.j41(28,"tbody"),o.DNE(29,WidgetTimeEntriesProjectComponent_ng_container_3_div_5_tr_29_Template,11,9,"tr",15),o.k0s()()()),2&e){const e=o.XpG(2);o.R7$(13),o.Y8G("textContent",e.schema.activity.name),o.R7$(4),o.Y8G("textContent",e.schema.workPackage.name),o.R7$(4),o.Y8G("textContent",e.schema.comment.name),o.R7$(4),o.Y8G("textContent",e.schema.hours.name),o.R7$(4),o.Y8G("ngForOf",e.rows)}}function WidgetTimeEntriesProjectComponent_ng_container_3_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"div",5)(2,"p"),o.EFF(3,"Total: "),o.nrm(4,"span",6),o.k0s()(),o.DNE(5,WidgetTimeEntriesProjectComponent_ng_container_3_div_5_Template,30,5,"div",7),o.bVm()),2&e){const e=o.XpG();o.R7$(4),o.Y8G("textContent",e.total),o.R7$(),o.Y8G("ngIf",e.entriesLoaded&&e.anyEntries)}}class WidgetTimeEntriesProjectComponent extends WidgetTimeEntriesListComponent{constructor(e,t,n,i,o,r,s){super(e,t,n,i,o,r),this.injector=e,this.timezone=t,this.i18n=n,this.pathHelper=i,this.confirmDialog=o,this.cdr=r,this.currentProject=s}dmFilters(){return[["spentOn",">t-",["7"]],["project_id","=",[this.currentProject.id]]]}static{this.ɵfac=function WidgetTimeEntriesProjectComponent_Factory(e){return new(e||WidgetTimeEntriesProjectComponent)(o.rXU(o.zZn),o.rXU(W.D),o.rXU(w.W),o.rXU(B.B),o.rXU(qe.g),o.rXU(o.gRc),o.rXU(T.c))}}static{this.ɵcmp=o.VBU({type:WidgetTimeEntriesProjectComponent,selectors:[["ng-component"]],features:[o.Jv_([Ge.p,Xe.r]),o.Vt3],decls:4,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[3,"title",4,"ngIf"],[4,"ngIf"],[3,"title"],[1,"total-hours"],[3,"textContent"],["class","generic-table--results-container",4,"ngIf"],[1,"generic-table--results-container"],[1,"generic-table","time-entries"],["data-highlight","false"],[1,"-sticky"],[1,"generic-table--sort-header-outer"],[1,"generic-table--sort-header"],[1,"generic-table--empty-header"],["class","time-entry",4,"ngFor","ngForOf"],[1,"time-entry"],["class","activity",3,"textContent",4,"ngIf"],["colspan","3",4,"ngIf"],["class","subject",4,"ngIf"],["class","subject",3,"textContent",4,"ngIf"],["class","comments",3,"textContent",4,"ngIf"],["class","hours",3,"textContent",4,"ngIf"],["class","hours",4,"ngIf"],[1,"buttons"],[3,"title","click",4,"ngIf"],[1,"activity",3,"textContent"],["colspan","3"],[1,"subject"],[3,"href","textContent"],[1,"subject",3,"textContent"],[1,"comments",3,"textContent"],[1,"hours",3,"textContent"],[1,"hours"],[3,"click","title"],["icon-classes","icon-context icon-edit"],["icon-classes","icon-context icon-delete"]],template:function WidgetTimeEntriesProjectComponent_Template(e,t){1&e&&(o.j41(0,"widget-header",0),o.nrm(1,"widget-menu",1),o.k0s(),o.DNE(2,WidgetTimeEntriesProjectComponent_op_no_results_2_Template,1,1,"op-no-results",2)(3,WidgetTimeEntriesProjectComponent_ng_container_3_Template,6,2,"ng-container",3)),2&e&&(o.Y8G("name",t.widgetName)("editable",t.isEditable),o.R7$(),o.Y8G("resource",t.resource),o.R7$(),o.Y8G("ngIf",t.noEntries),o.R7$(),o.Y8G("ngIf",!t.noEntries))},dependencies:[P.Sq,P.bT,Le.i,ce.h,WidgetMenuComponent,WidgetHeaderComponent],encapsulation:2})}}var He=n(96027);function WidgetSubprojectsComponent_op_no_results_3_Template(e,t){if(1&e&&o.nrm(0,"op-no-results",5),2&e){const e=o.XpG();o.Y8G("title",e.text.noResults)}}function WidgetSubprojectsComponent_span_4_span_2_Template(e,t){1&e&&(o.j41(0,"span"),o.EFF(1,", "),o.k0s())}function WidgetSubprojectsComponent_span_4_Template(e,t){if(1&e&&(o.j41(0,"span"),o.nrm(1,"a",6),o.DNE(2,WidgetSubprojectsComponent_span_4_span_2_Template,2,0,"span",7),o.k0s()),2&e){const e=t.$implicit,n=t.last,i=o.XpG();o.R7$(),o.Y8G("href",i.projectPath(e),o.B4B)("textContent",i.projectName(e)),o.R7$(),o.Y8G("ngIf",!n)}}class WidgetSubprojectsComponent extends y.q{constructor(e,t,n,i,o,r,s,a){super(n,i),this.halResource=e,this.pathHelper=t,this.i18n=n,this.injector=i,this.timezone=o,this.apiV3Service=r,this.currentProject=s,this.cdr=a,this.text={noResults:this.i18n.t("js.grid.widgets.subprojects.no_results")}}ngOnInit(){this.apiV3Service.projects.list(this.projectListParams).subscribe((e=>{this.projects=e.elements,this.cdr.detectChanges()}))}get isEditable(){return!1}projectPath(e){return this.pathHelper.projectPath(e.identifier)}projectName(e){return e.name}get noEntries(){return this.projects&&!this.projects.length}get projectListParams(){return{sortBy:[["name","asc"]],filters:[["parent_id","=",[this.currentProject.id]],["active","=",["t"]]],pageSize:He.yZ}}static{this.ɵfac=function WidgetSubprojectsComponent_Factory(e){return new(e||WidgetSubprojectsComponent)(o.rXU(oe.t),o.rXU(B.B),o.rXU(w.W),o.rXU(o.zZn),o.rXU(W.D),o.rXU(O.n),o.rXU(T.c),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:WidgetSubprojectsComponent,selectors:[["ng-component"]],features:[o.Vt3],decls:5,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"title"],[3,"href","textContent"],[4,"ngIf"]],template:function WidgetSubprojectsComponent_Template(e,t){1&e&&(o.j41(0,"widget-header",0),o.nrm(1,"widget-menu",1),o.k0s(),o.j41(2,"div",2),o.DNE(3,WidgetSubprojectsComponent_op_no_results_3_Template,1,1,"op-no-results",3)(4,WidgetSubprojectsComponent_span_4_Template,3,3,"span",4),o.k0s()),2&e&&(o.Y8G("name",t.widgetName)("editable",t.isEditable),o.R7$(),o.Y8G("resource",t.resource),o.R7$(2),o.Y8G("ngIf",t.noEntries),o.R7$(),o.Y8G("ngForOf",t.projects))},dependencies:[P.Sq,P.bT,ce.h,WidgetMenuComponent,WidgetHeaderComponent],encapsulation:2,changeDetection:0})}}function WidgetMembersComponent_op_no_results_4_Template(e,t){if(1&e&&o.nrm(0,"op-no-results",11),2&e){const e=o.XpG();o.Y8G("title",e.text.noResults)}}function WidgetMembersComponent_ng_container_6_ng_container_4_ng_container_2_Template(e,t){1&e&&(o.qex(0),o.EFF(1,", "),o.bVm())}function WidgetMembersComponent_ng_container_6_ng_container_4_Template(e,t){if(1&e&&(o.qex(0),o.nrm(1,"op-principal",14),o.DNE(2,WidgetMembersComponent_ng_container_6_ng_container_4_ng_container_2_Template,2,0,"ng-container",15),o.bVm()),2&e){const e=t.$implicit,n=t.last;o.R7$(),o.Y8G("principal",e),o.R7$(),o.Y8G("ngIf",!n)}}function WidgetMembersComponent_ng_container_6_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"div",12),o.EFF(2),o.k0s(),o.j41(3,"div",13),o.DNE(4,WidgetMembersComponent_ng_container_6_ng_container_4_Template,3,2,"ng-container",6),o.k0s(),o.bVm()),2&e){const e=t.$implicit;o.R7$(2),o.SpI(" ",e.role.name," "),o.R7$(2),o.Y8G("ngForOf",e.users)}}function WidgetMembersComponent_div_7_Template(e,t){if(1&e&&(o.j41(0,"div",16),o.EFF(1),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.SpI(" ",e.moreMembersText," ")}}function WidgetMembersComponent_a_9_Template(e,t){if(1&e&&(o.j41(0,"a",17),o.nrm(1,"i",18)(2,"span",19),o.k0s()),2&e){const e=o.XpG();o.Y8G("href",e.projectMembershipsPath+"?show_add_members=true",o.B4B),o.R7$(2),o.Y8G("textContent",e.text.add)}}function WidgetMembersComponent_a_11_Template(e,t){if(1&e&&(o.j41(0,"a",20),o.nrm(1,"i",21)(2,"span",19),o.k0s()),2&e){const e=o.XpG();o.Y8G("href",e.projectMembershipsPath,o.B4B),o.R7$(2),o.Y8G("textContent",e.text.viewAll)}}class WidgetMembersComponent extends y.q{constructor(e,t,n,i,o,r){super(n,i),this.pathHelper=e,this.apiV3Service=t,this.i18n=n,this.injector=i,this.currentProject=o,this.cdr=r,this.text={add:this.i18n.t("js.grid.widgets.members.add"),noResults:this.i18n.t("js.grid.widgets.members.no_results"),viewAll:this.i18n.t("js.grid.widgets.members.view_all_members")},this.entriesByRoles={},this.entriesLoaded=!1}ngOnInit(){this.apiV3Service.memberships.list(this.listMembersParams).subscribe((e=>{this.partitionEntriesByRole(e.elements),this.sortUsersByName(),this.totalMembers=e.total,this.entriesLoaded=!0,this.cdr.detectChanges()})),this.membersAddable$=this.apiV3Service.memberships.available_projects.list(this.listAvailableProjectsParams).pipe((0,G.T)((e=>e.total>0)))}get isEditable(){return!1}get noMembers(){return this.entriesLoaded&&!Object.keys(this.entriesByRoles).length}get moreMembers(){return this.entriesLoaded&&this.totalMembers>100}get moreMembersText(){return I18n.t("js.grid.widgets.members.too_many",{count:100,total:this.totalMembers})}get projectMembershipsPath(){return this.pathHelper.projectMembershipsPath(this.currentProject.identifier)}get usersByRole(){return Object.values(this.entriesByRoles)}partitionEntriesByRole(e){e.forEach((e=>{e.roles.forEach((t=>{this.entriesByRoles[t.id]||(this.entriesByRoles[t.id]={role:t,users:[]}),this.entriesByRoles[t.id].users.push(e.principal)}))}))}sortUsersByName(){Object.values(this.entriesByRoles).forEach((e=>{e.users.sort(((e,t)=>e.name.localeCompare(t.name)))}))}get listMembersParams(){const e={sortBy:[["created_at","desc"]],pageSize:100};return this.currentProject.id&&(e.filters=[["project_id","=",[this.currentProject.id]]]),e}get listAvailableProjectsParams(){const e={};return this.currentProject.id&&(e.filters=[["id","=",[this.currentProject.id]]]),e}static{this.ɵfac=function WidgetMembersComponent_Factory(e){return new(e||WidgetMembersComponent)(o.rXU(B.B),o.rXU(O.n),o.rXU(w.W),o.rXU(o.zZn),o.rXU(T.c),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:WidgetMembersComponent,selectors:[["ng-component"]],features:[o.Vt3],decls:12,vars:11,consts:[[3,"name","editable"],["slot","prepend","attribute","members",3,"attributeScope"],["slot","menu",3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[1,"op-members-widget--attributes-map","-minimal-keys"],[4,"ngFor","ngForOf"],["class","op-members-widget--notification",4,"ngIf"],[1,"op-members-widget--grid--widget-footer"],["class","button -primary",3,"href",4,"ngIf"],["class","button -highlight-inverted",3,"href",4,"ngIf"],[3,"title"],[1,"attributes-map--key"],[1,"attributes-map--value"],["size","mini",3,"principal"],[4,"ngIf"],[1,"op-members-widget--notification"],[1,"button","-primary",3,"href"],["aria-hidden","true",1,"button--icon","icon-add"],[1,"button--text",3,"textContent"],[1,"button","-highlight-inverted",3,"href"],["aria-hidden","true",1,"button--icon","icon-group"]],template:function WidgetMembersComponent_Template(e,t){1&e&&(o.j41(0,"widget-header",0),o.nrm(1,"attribute-help-text",1)(2,"widget-menu",2),o.k0s(),o.j41(3,"div",3),o.DNE(4,WidgetMembersComponent_op_no_results_4_Template,1,1,"op-no-results",4),o.j41(5,"div",5),o.DNE(6,WidgetMembersComponent_ng_container_6_Template,5,2,"ng-container",6),o.k0s(),o.DNE(7,WidgetMembersComponent_div_7_Template,2,1,"div",7),o.k0s(),o.j41(8,"div",8),o.DNE(9,WidgetMembersComponent_a_9_Template,3,2,"a",9),o.nI1(10,"async"),o.DNE(11,WidgetMembersComponent_a_11_Template,3,2,"a",10),o.k0s()),2&e&&(o.Y8G("name",t.widgetName)("editable",t.isEditable),o.R7$(),o.Y8G("attributeScope","Project"),o.R7$(),o.Y8G("resource",t.resource),o.R7$(2),o.Y8G("ngIf",t.noMembers),o.R7$(2),o.Y8G("ngForOf",t.usersByRole),o.R7$(),o.Y8G("ngIf",t.moreMembers),o.R7$(2),o.Y8G("ngIf",o.bMT(10,9,t.membersAddable$)),o.R7$(2),o.Y8G("ngIf",!t.noMembers))},dependencies:[P.Sq,P.bT,Ee.e,ke.f,ce.h,WidgetMenuComponent,WidgetHeaderComponent,P.Jj],styles:[".op-members-widget--notification[_ngcontent-%COMP%]{font-style:italic;margin-top:.5rem}.op-members-widget--grid--widget-footer[_ngcontent-%COMP%]{margin-top:.5rem}.op-members-widget--grid--widget-footer[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin-bottom:0}.op-members-widget--attributes-map[_ngcontent-%COMP%]{padding-bottom:.875rem;line-height:1.5rem}.op-members-widget--attributes-map[_ngcontent-%COMP%]   .attributes-map--value[_ngcontent-%COMP%]:not(:last-of-type){margin-bottom:.5rem}"],changeDetection:0})}}var ze=n(62665);const Qe=["contentContainer"];function WidgetProjectStatusComponent_edit_form_4_Template(e,t){if(1&e&&(o.j41(0,"edit-form",5)(1,"div",6),o.nrm(2,"op-editable-attribute-field",7),o.k0s(),o.j41(3,"div",8),o.nrm(4,"op-editable-attribute-field",9),o.k0s()()),2&e){const e=t.ngIf;o.Y8G("resource",e),o.R7$(2),o.Y8G("resource",e),o.R7$(2),o.Y8G("resource",e)}}class WidgetProjectStatusComponent extends y.q{constructor(e,t,n,i,o){super(e,t),this.i18n=e,this.injector=t,this.apiV3Service=n,this.currentProject=i,this.cdRef=o,this.currentStatusCode="not set",this.explanation=""}ngOnInit(){this.currentProject.id&&(this.project$=this.apiV3Service.projects.id(this.currentProject.id).get(),this.cdRef.detectChanges())}get isEditable(){return!1}static{this.ɵfac=function WidgetProjectStatusComponent_Factory(e){return new(e||WidgetProjectStatusComponent)(o.rXU(w.W),o.rXU(o.zZn),o.rXU(O.n),o.rXU(T.c),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:WidgetProjectStatusComponent,selectors:[["ng-component"]],viewQuery:function WidgetProjectStatusComponent_Query(e,t){if(1&e&&o.GBs(Qe,7),2&e){let e;o.mGM(e=o.lsd())&&(t.contentContainer=e.first)}},features:[o.Jv_([ze.I,Ce.i,Ge.p]),o.Vt3],decls:6,vars:7,consts:[[3,"name","editable"],["slot","prepend","attribute","status",3,"attributeScope"],["slot","menu",3,"resource"],[1,"grid--widget-content","-allow-inner-overflow"],[3,"resource",4,"ngIf"],[3,"resource"],[1,"project-status--container"],["fieldName","status","wrapperClasses","project-status--display-field",3,"resource"],[1,"project-status-explanation--container"],["fieldName","statusExplanation",3,"resource"]],template:function WidgetProjectStatusComponent_Template(e,t){1&e&&(o.j41(0,"widget-header",0),o.nrm(1,"attribute-help-text",1)(2,"widget-menu",2),o.k0s(),o.j41(3,"div",3),o.DNE(4,WidgetProjectStatusComponent_edit_form_4_Template,5,3,"edit-form",4),o.nI1(5,"async"),o.k0s()),2&e&&(o.Y8G("name",t.widgetName)("editable",t.isEditable),o.R7$(),o.Y8G("attributeScope","Project"),o.R7$(),o.Y8G("resource",t.resource),o.R7$(2),o.Y8G("ngIf",o.bMT(5,5,t.project$)))},dependencies:[P.bT,Ee.e,Ae.G,Ve.c,WidgetMenuComponent,WidgetHeaderComponent,P.Jj],encapsulation:2,changeDetection:0})}}var Ke=n(91812),Je=n(89282),Ze=n(93855);function WidgetProjectFavoritesComponent_div_2_div_1_Template(e,t){if(1&e&&(o.j41(0,"div",6),o.qSk(),o.nrm(1,"svg",7),o.joV(),o.j41(2,"p"),o.nrm(3,"strong",8)(4,"br")(5,"span",9),o.k0s()()),2&e){const e=o.XpG(2);o.R7$(3),o.Y8G("textContent",e.text.no_favorites),o.R7$(2),o.Y8G("textContent",e.text.no_favorites_subtext)}}function WidgetProjectFavoritesComponent_div_2_ng_container_2_li_2_Template(e,t){if(1&e&&(o.j41(0,"li"),o.qSk(),o.nrm(1,"svg",12),o.joV(),o.nrm(2,"a",13),o.k0s()),2&e){const e=t.$implicit,n=o.XpG(3);o.R7$(2),o.Y8G("href",n.projectPath(e),o.B4B)("textContent",e.name)}}function WidgetProjectFavoritesComponent_div_2_ng_container_2_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"ul",10),o.DNE(2,WidgetProjectFavoritesComponent_div_2_ng_container_2_li_2_Template,3,2,"li",11),o.k0s(),o.bVm()),2&e){const e=o.XpG().ngIf;o.R7$(2),o.Y8G("ngForOf",e)}}function WidgetProjectFavoritesComponent_div_2_Template(e,t){if(1&e&&(o.j41(0,"div",3),o.DNE(1,WidgetProjectFavoritesComponent_div_2_div_1_Template,6,2,"div",4)(2,WidgetProjectFavoritesComponent_div_2_ng_container_2_Template,3,1,"ng-container",5),o.k0s()),2&e){const e=t.ngIf;o.R7$(),o.Y8G("ngIf",0===e.length),o.R7$(),o.Y8G("ngIf",e.length>0)}}class WidgetProjectFavoritesComponent extends y.q{constructor(e,t,n,i,o,r,s,a){super(n,i),this.halResource=e,this.pathHelper=t,this.i18n=n,this.injector=i,this.timezone=o,this.apiV3Service=r,this.currentProject=s,this.cdr=a,this.className=!0,this.text={no_favorites:this.i18n.t("js.favorite_projects.no_results"),no_favorites_subtext:this.i18n.t("js.favorite_projects.no_results_subtext")}}ngOnInit(){const e=new Je.hG;e.add("favored","=",!0),e.add("active","=",!0),this.projects$=this.apiV3Service.projects.filtered(e,{pageSize:"-1"}).getPaginatedResults()}projectPath(e){return this.pathHelper.projectPath(e.identifier)}static{this.ɵfac=function WidgetProjectFavoritesComponent_Factory(e){return new(e||WidgetProjectFavoritesComponent)(o.rXU(oe.t),o.rXU(B.B),o.rXU(w.W),o.rXU(o.zZn),o.rXU(W.D),o.rXU(O.n),o.rXU(T.c),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:WidgetProjectFavoritesComponent,selectors:[["ng-component"]],hostVars:2,hostBindings:function WidgetProjectFavoritesComponent_HostBindings(e,t){2&e&&o.AVh("op-widget-project-favorites",t.className)},features:[o.Vt3],decls:4,vars:6,consts:[[3,"name","editable"],["slot","menu",3,"resource"],["class","grid--widget-content",4,"ngIf"],[1,"grid--widget-content"],["class","op-header-project-select--no-favorites",4,"ngIf"],[4,"ngIf"],[1,"op-header-project-select--no-favorites"],["star-icon","","size","medium",1,"op-header-project-select--no-favorites-icon"],[3,"textContent"],[1,"op-header-project-select--no-favorites-subtext",3,"textContent"],[1,"op-widget-project-favorites--list"],[4,"ngFor","ngForOf"],["star-fill-icon","","size","small",1,"op-primer--star-icon"],[1,"op-widget-project-favorites--link",3,"href","textContent"]],template:function WidgetProjectFavoritesComponent_Template(e,t){1&e&&(o.j41(0,"widget-header",0),o.nrm(1,"widget-menu",1),o.k0s(),o.DNE(2,WidgetProjectFavoritesComponent_div_2_Template,3,2,"div",2),o.nI1(3,"async")),2&e&&(o.Y8G("name",t.widgetName)("editable",!1),o.R7$(),o.Y8G("resource",t.resource),o.R7$(),o.Y8G("ngIf",o.bMT(3,4,t.projects$)))},dependencies:[P.Sq,P.bT,Ze.uMM,Ze.F7G,WidgetMenuComponent,WidgetHeaderComponent,P.Jj],styles:[".op-widget-project-favorites--list{list-style:none}.op-widget-project-favorites--link{padding-left:.25rem}\n"],encapsulation:2,changeDetection:0})}}var et=n(17136);class OpenprojectGridsModule{constructor(e){!function registerWidgets(e){const t=e.get(b.R),n=e.get(w.W);t.register("gridWidgets",(()=>{const e=["id","project","type","subject"],t=new Je.hG;t.add("assignee","=",["me"]),t.add("status","o",[]);const i={"columns[]":e,filters:t.toJson()},o=new Je.hG;o.add("responsible","=",["me"]),o.add("status","o",[]);const r={"columns[]":e,filters:o.toJson()},s=new Je.hG;s.add("author","=",["me"]),s.add("status","o",[]);const a={"columns[]":e,filters:s.toJson()},l=new Je.hG;l.add("watcher","=",["me"]),l.add("status","o",[]);const c={"columns[]":e,filters:l.toJson()};return[{identifier:"work_packages_assigned",component:WidgetWpTableQuerySpaceComponent,title:n.t("js.grid.widgets.work_packages_assigned.title"),properties:{queryProps:i,name:n.t("js.grid.widgets.work_packages_assigned.title")}},{identifier:"work_packages_accountable",component:WidgetWpTableQuerySpaceComponent,title:n.t("js.grid.widgets.work_packages_accountable.title"),properties:{queryProps:r,name:n.t("js.grid.widgets.work_packages_accountable.title")}},{identifier:"work_packages_created",component:WidgetWpTableQuerySpaceComponent,title:n.t("js.grid.widgets.work_packages_created.title"),properties:{queryProps:a,name:n.t("js.grid.widgets.work_packages_created.title")}},{identifier:"work_packages_watched",component:WidgetWpTableQuerySpaceComponent,title:n.t("js.grid.widgets.work_packages_watched.title"),properties:{queryProps:c,name:n.t("js.grid.widgets.work_packages_watched.title")}},{identifier:"work_packages_table",component:WidgetWpTableQuerySpaceComponent,title:n.t("js.grid.widgets.work_packages_table.title"),properties:{name:n.t("js.grid.widgets.work_packages_table.title")}},{identifier:"work_packages_graph",component:WidgetWpGraphComponent,title:n.t("js.grid.widgets.work_packages_graph.title"),properties:{name:n.t("js.grid.widgets.work_packages_graph.title")}},{identifier:"work_packages_calendar",component:WidgetWpCalendarComponent,title:n.t("js.grid.widgets.work_packages_calendar.title"),properties:{name:n.t("js.grid.widgets.work_packages_calendar.title")}},{identifier:"work_packages_overview",component:WidgetWpOverviewComponent,title:n.t("js.grid.widgets.work_packages_overview.title"),properties:{name:n.t("js.grid.widgets.work_packages_overview.title")}},{identifier:"time_entries_current_user",component:WidgetTimeEntriesCurrentUserComponent,title:n.t("js.grid.widgets.time_entries_current_user.title"),properties:{name:n.t("js.grid.widgets.time_entries_current_user.title"),days:[!0,!0,!0,!0,!0,!0,!0]}},{identifier:"time_entries_list",component:WidgetTimeEntriesProjectComponent,title:n.t("js.grid.widgets.time_entries_list.title"),properties:{name:n.t("js.grid.widgets.time_entries_list.title")}},{identifier:"documents",component:WidgetDocumentsComponent,title:n.t("js.grid.widgets.documents.title"),properties:{name:n.t("js.grid.widgets.documents.title")}},{identifier:"members",component:WidgetMembersComponent,title:n.t("js.grid.widgets.members.title"),properties:{name:n.t("js.grid.widgets.members.title")}},{identifier:"news",component:WidgetNewsComponent,title:n.t("js.grid.widgets.news.title"),properties:{name:n.t("js.grid.widgets.news.title")}},{identifier:"project_description",component:WidgetProjectDescriptionComponent,title:n.t("js.grid.widgets.project_description.title"),properties:{name:n.t("js.grid.widgets.project_description.title")}},{identifier:"custom_text",component:WidgetCustomTextComponent,title:n.t("js.grid.widgets.custom_text.title"),properties:{name:n.t("js.grid.widgets.custom_text.title"),text:{raw:""}}},{identifier:"project_status",component:WidgetProjectStatusComponent,title:n.t("js.grid.widgets.project_status.title"),properties:{name:n.t("js.grid.widgets.project_status.title")}},{identifier:"subprojects",component:WidgetSubprojectsComponent,title:n.t("js.grid.widgets.subprojects.title"),properties:{name:n.t("js.grid.widgets.subprojects.title")}},{identifier:"project_favorites",component:WidgetProjectFavoritesComponent,title:n.t("js.grid.widgets.project_favorites.title"),properties:{name:n.t("js.grid.widgets.project_favorites.title")}}]}))}(e)}static{this.ɵfac=function OpenprojectGridsModule_Factory(e){return new(e||OpenprojectGridsModule)(o.KVO(o.zZn))}}static{this.ɵmod=o.$C({type:OpenprojectGridsModule})}static{this.ɵinj=o.G2t({providers:[GridWidgetsService,GridInitializationService],imports:[a.YN,C.ad,d.d,k.p,h.W,OpenprojectWorkPackageGraphsModule,v.OpenprojectCalendarModule,Ke.d,m._,f.oW,p.X,et.o]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenprojectGridsModule,{declarations:[GridComponent,WidgetCustomTextComponent,WidgetDocumentsComponent,WidgetMembersComponent,WidgetNewsComponent,WidgetWpCalendarComponent,WidgetWpOverviewComponent,WidgetWpTableComponent,WidgetWpTableQuerySpaceComponent,WidgetWpGraphComponent,WidgetProjectDescriptionComponent,WidgetProjectStatusComponent,WidgetSubprojectsComponent,WidgetProjectFavoritesComponent,WidgetTimeEntriesCurrentUserComponent,WidgetTimeEntriesProjectComponent,WidgetMenuComponent,WidgetWpTableMenuComponent,WidgetWpGraphMenuComponent,WidgetTimeEntriesCurrentUserMenuComponent,TimeEntriesCurrentUserConfigurationModalComponent,AddGridWidgetModalComponent,WidgetHeaderComponent],imports:[a.YN,C.ad,d.d,k.p,h.W,OpenprojectWorkPackageGraphsModule,v.OpenprojectCalendarModule,Ke.d,m._,f.oW,p.X,et.o],exports:[GridComponent]});var tt=n(72097),nt=n(88955);const it="openproject-base";class ApplicationBaseComponent{static{this.ɵfac=function ApplicationBaseComponent_Factory(e){return new(e||ApplicationBaseComponent)}}static{this.ɵcmp=o.VBU({type:ApplicationBaseComponent,selectors:[["openproject-base"]],decls:2,vars:0,consts:[[1,"openproject-base--ui-view"]],template:function ApplicationBaseComponent_Template(e,t){1&e&&(o.j41(0,"div",0),o.nrm(1,"ui-view"),o.k0s())},dependencies:[nt.UIView],encapsulation:2})}}var ot=n(30327),rt=n(36652);const st=[{name:"root",abstract:!0,url:"",component:ApplicationBaseComponent,params:{flash_message:{dynamic:!0,value:null,inherit:!1}}},{name:"optional_project",parent:"root",url:"/{projects}/{projectPath}",abstract:!0,params:{projectPath:{type:"path",value:null,squash:!0},projects:{type:"path",value:null,squash:!0}},views:{"!$default":{component:ApplicationBaseComponent}}},{name:"boards.**",parent:"optional_project",url:"/boards",loadChildren:()=>n.e("src_app_features_boards_openproject-boards_module_ts").then(n.bind(n,13085)).then((e=>e.OpenprojectBoardsModule))},{name:"bim.**",parent:"optional_project",url:"/bcf",loadChildren:()=>n.e("src_app_features_bim_ifc_models_openproject-ifc-models_module_ts").then(n.bind(n,69457)).then((e=>e.OpenprojectIFCModelsModule))},{name:"reporting.**",parent:"optional_project",url:"/cost_reports",loadChildren:()=>n.e("src_app_features_reporting_openproject-reporting_module_ts").then(n.bind(n,11486)).then((e=>e.OpenprojectReportingModule))},...[{name:"team_planner.**",parent:"optional_project",url:"/team_planner",loadChildren:()=>n.e("src_app_features_team-planner_team-planner_team-planner_module_ts").then(n.bind(n,7325)).then((e=>e.TeamPlannerModule))}],...[{name:"calendar.**",parent:"optional_project",url:"/calendars",loadChildren:()=>Promise.resolve().then(n.bind(n,57654)).then((e=>e.OpenprojectCalendarModule))}]];function bodyClass(e,t="add"){e&&(Array.isArray(e)?e.forEach((e=>{document.body.classList[t](e)})):document.body.classList[t](e))}function updateMenuItem(e,t="add"){if(!e)return;const n=jQuery(`#main-menu .${e}`)[0];if(!n)return;n.classList[t]("selected");let i=(n.getAttribute("title")||"").split(":").slice(-1)[0];"add"===t&&(i=I18n.t("js.description_current_position")+i),n.setAttribute("title",i)}function uiRouterConfiguration(e,t,n){e.urlService.config.strictMode(!1),e.urlService.config.type("opQueryString",{encode:encodeURIComponent,decode:decodeURIComponent,raw:!0,dynamic:!0,is:e=>"string"==typeof e,equals:(e,t)=>_.isEqual(e,t)}),e.urlService.config.type("opQueryId",{pattern:new RegExp(/(?:new|[0-9]+)/),encode:e=>e||"new",decode:e=>"new"===e?null:e,raw:!0,dynamic:!0,is:e=>"string"==typeof e,equals:(e,t)=>_.isEqual(e,t)})}function initializeUiRouterListeners(e){const t=e.get(ye.HN),n=e.get(ye.dw),i=e.get(R.fw),o=e.get(T.c),r=e.get(tt.H),s=e.get(ot.v),a=e.get(ye.ce);let l=document.querySelector(it);document.addEventListener("turbo:load",(()=>{l=document.querySelector(it),a.urlService.sync()})),t.onBefore({to:e=>!!e&&function mobileGuardActivated(e){return e.data&&e.data.mobileAlternative&&(new rt.g).isMobile}(e)},(e=>function redirectToMobileAlternative(e){const t=e.router.stateService,n=e.to().data.mobileAlternative;return t.target(n,e.params(),{})}(e))),t.onEnter({},((e,t)=>{bodyClass(_.get(t,"data.bodyClasses"),"add"),e.from().data&&_.get(t,"data.menuItem")!==e.from().data.menuItem&&updateMenuItem(_.get(t,"data.menuItem"),"add")})),t.onExit({},((e,t)=>{bodyClass(_.get(t,"data.bodyClasses"),"remove"),e.to().data&&_.get(t,"data.menuItem")!==e.to().data.menuItem&&updateMenuItem(_.get(t,"data.menuItem"),"remove")})),t.onStart({},(e=>{const t=e.router.stateService,a=e.params("to"),c=e.to();if(a.start_onboarding_tour&&"work-packages.partitioned.list"!==c.name){const n={...e.params()};return n.start_onboarding_tour=void 0,t.target(e.to(),n)}s.sync(e);const p=window.MiniProfiler;p?.pageTransition();const d=c.$$state&&c.$$state(),u=d?.includes?.root,h=a.projectPath||o.identifier;if(u&&!a.projects&&h){const e=_.clone(a);return _.assign(e,{projectPath:h,projects:"projects"}),t.target(c,e,{location:"replace"})}if(null===l){const e=window.location.pathname,t=e+window.location.search,i=n.href(c,a);if(i&&e!==i&&t!==i)return window.location.href=i,!1}return bodyClass(_.get(c,"data.bodyClasses"),"add"),r.setIfFirst(c.name,a),e.to().name!==e.from().name&&i.clear(),a.flash_message&&i.add(a.flash_message),!0}))}class OpenprojectRouterModule{constructor(e){initializeUiRouterListeners(e)}static{this.ɵfac=function OpenprojectRouterModule_Factory(e){return new(e||OpenprojectRouterModule)(o.KVO(o.zZn))}}static{this.ɵmod=o.$C({type:OpenprojectRouterModule})}static{this.ɵinj=o.G2t({providers:[tt.H],imports:[nt.UIRouterModule.forRoot({states:st,useHash:!1,config:uiRouterConfiguration})]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenprojectRouterModule,{declarations:[ApplicationBaseComponent],imports:[nt.UIRouterModule]});var at=n(4213),lt=n(81859),ct=n(76321),pt=n(60129),dt=n(27973),ut=n(19015),ht=n(96941),mt=n(72870),gt=n(59933),_t=n(66309),ft=n(62046);const bt="work-packages-menu-item",kt={sidemenuId:"work_packages_sidemenu",hardReloadOnBaseRoute:!0},vt=[{name:"work-packages",parent:"optional_project",url:"/work_packages?query_id&query_props&name&start_onboarding_tour",redirectTo:"work-packages.partitioned.list",views:{"!$default":{component:dt.F}},data:{bodyClasses:"router--work-packages-base",menuItem:bt,sideMenuOptions:kt},params:{query_id:{type:"query",dynamic:!0},query_props:{type:"opQueryString"},start_onboarding_tour:{type:"query",squash:!0,value:void 0},name:{type:"string",dynamic:!0}}},{name:"work-packages.new",url:"/new?type&parent_id",component:lt.N,reloadOnSearch:!1,params:{defaults:{value:null}},data:{baseRoute:"work-packages",allowMovingInEditMode:!0,bodyClasses:"router--work-packages-full-create",menuItem:bt,successState:"work-packages.show",sideMenuOptions:kt}},{name:"work-packages.copy",url:"/{copiedFromWorkPackageId:[0-9]+}/copy",component:gt.K,reloadOnSearch:!1,data:{baseRoute:"work-packages",allowMovingInEditMode:!0,bodyClasses:"router--work-packages-full-create",menuItem:bt,sideMenuOptions:kt}},{name:"work-packages.show",url:"/{workPackageId:[0-9]+}",redirectTo:e=>({state:"work-packages.show.tabs",params:{...e.params("to"),tabIdentifier:e.injector().get(_t.S).currentShowTab||"activity"}}),component:ct.y,data:{baseRoute:"work-packages",bodyClasses:["router--work-packages-full-view","router--work-packages-base"],newRoute:"work-packages.new",menuItem:bt,sideMenuOptions:kt}},{name:"work-packages.show.tabs",url:"/:tabIdentifier",component:at.B,data:{parent:"work-packages.show",menuItem:bt,sideMenuOptions:kt}},{name:"work-packages.partitioned",component:ht.L,url:"",data:{bodyClasses:"",sideMenuOptions:kt}},{name:"work-packages.partitioned.list",url:"",reloadOnSearch:!1,views:{"content-left":{component:ut.W}},data:{bodyClasses:["router--work-packages-partitioned-split-view","router--work-packages-base"],menuItem:bt,partition:"-left-only",sideMenuOptions:kt}},...(0,mt.M)("work-packages.partitioned.list",bt,pt.w),{url:"/share_upsale",name:"work-packages.share_upsale",component:ft.J}],Ct="gantt-menu-item",yt={sidemenuId:"gantt_menu",hardReloadOnBaseRoute:!0},wt=[{name:"gantt",parent:"optional_project",url:"/gantt?query_id&query_props&name&start_onboarding_tour",redirectTo:"gantt.partitioned.list",views:{"!$default":{component:dt.F}},data:{bodyClasses:"router--work-packages-base",menuItem:Ct,sideMenuOptions:yt},params:{query_id:{type:"query",dynamic:!0},query_props:{type:"opQueryString"},start_onboarding_tour:{type:"query",squash:!0,value:void 0},name:{type:"string",dynamic:!0}}},{name:"gantt.partitioned",component:ht.L,url:"",data:{bodyClasses:"",sideMenuOptions:yt}},{name:"gantt.partitioned.list",url:"",reloadOnSearch:!1,views:{"content-left":{component:ut.W}},data:{bodyClasses:"router--work-packages-partitioned-split-view",menuItem:Ct,partition:"-left-only",sideMenuOptions:yt}},...(0,mt.M)("gantt.partitioned.list",Ct,pt.w)];class OpenprojectWorkPackageRoutesModule{static{this.ɵfac=function OpenprojectWorkPackageRoutesModule_Factory(e){return new(e||OpenprojectWorkPackageRoutesModule)}}static{this.ɵmod=o.$C({type:OpenprojectWorkPackageRoutesModule})}static{this.ɵinj=o.G2t({imports:[h.W,nt.UIRouterModule.forChild({states:[...vt,...wt]})]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenprojectWorkPackageRoutesModule,{imports:[h.W,nt.UIRouterModule]});var Tt=n(32037),St=n(98764);class GlobalSearchService{constructor(e,t,n,i){this.I18n=e,this.injector=t,this.PathHelper=n,this.currentProjectService=i,this._searchTerm=new F.t(""),this.searchTerm$=this._searchTerm.asObservable(),this._currentTab=new F.t("work_packages"),this.currentTab$=this._currentTab.asObservable(),this._projectScope=new F.t(""),this.projectScope$=this._projectScope.asObservable(),this._tabs=new F.t([]),this.tabs$=this._tabs.asObservable(),this._resultsHidden=new F.t(!1),this.resultsHidden$=this._resultsHidden.asObservable(),this.initialize()}initialize(){const e=this.loadGonData();e&&(e.available_search_types&&this._tabs.next(e.available_search_types),e.search_term&&this._searchTerm.next(e.search_term),e.current_tab&&this._currentTab.next(e.current_tab),e.project_scope?this._projectScope.next(e.project_scope):this.currentProjectService.path||this._projectScope.next("all"))}loadGonData(){try{return window.gon.global_search}catch(e){return null}}submitSearch(){window.location.href=this.searchPath()}searchPath(){let e=this.PathHelper.staticBase;return this.currentProjectService.path&&"all"!==this.projectScope&&(e=this.currentProjectService.path),e+=`/search?${this.searchQueryParams()}`,e}set searchTerm(e){this._searchTerm.next(e)}get searchTerm(){return this._searchTerm.value}get searchTermIsId(){return this.searchTermWithoutHash!==this.searchTerm}get searchTermWithoutHash(){return/^#(\d+)/.exec(this.searchTerm)?this.searchTerm.substr(1):this.searchTerm}get tabs(){return this._tabs.value}get currentTab(){return this._currentTab.value}set currentTab(e){this._currentTab.next(e)}get projectScope(){return this._projectScope.value}set projectScope(e){this._projectScope.next(e)}get resultsHidden(){return this._resultsHidden.value}set resultsHidden(e){this._resultsHidden.next(e)}searchQueryParams(){let e;return e=`q=${encodeURIComponent(this.searchTerm)}`,this.currentTab.length>0&&"all"!==this.currentTab&&(e=`${e}&${this.currentTab}=1`),this.projectScope.length>0&&(e=`${e}&scope=${this.projectScope}`),e}isAfterSearch(){return jQuery("body.controller-search").length>0}static{this.ɵfac=function GlobalSearchService_Factory(e){return new(e||GlobalSearchService)(o.KVO(w.W),o.KVO(o.zZn),o.KVO(B.B),o.KVO(T.c))}}static{this.ɵprov=o.jDH({token:GlobalSearchService,factory:GlobalSearchService.ɵfac})}}var jt=n(2183),Pt=n(46116),It=n(7350),xt=n(40358),Rt=n(46303),Ft=n(27514),Mt=n(7749),Ot=n(37749),Dt=n(11528),Gt=n(22444);const Et=["btn"],global_search_input_component_c1=(e,t)=>({"top-menu-search--input":!0,"-markable":e,"-expanded":t}),global_search_input_component_c2=()=>({class:"global-search--input",name:"global-search--input"});function GlobalSearchInputComponent_button_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"button",10),o.bIt("click",(function GlobalSearchInputComponent_button_1_Template_button_click_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.toggleMobileSearch())})),o.nrm(1,"i",11),o.k0s()}if(2&e){const e=o.XpG();o.FS9("title",e.text.close_search)}}function GlobalSearchInputComponent_ng_template_4_div_0_Template(e,t){if(1&e&&(o.j41(0,"div"),o.EFF(1),o.k0s()),2&e){const e=o.XpG(2);o.R7$(),o.JRh(e.text.recently_viewed)}}function GlobalSearchInputComponent_ng_template_4_Template(e,t){if(1&e&&(o.DNE(0,GlobalSearchInputComponent_ng_template_4_div_0_Template,2,1,"div",12),o.nI1(1,"async")),2&e){const e=o.XpG();o.Y8G("ngIf",!e.searchTerm&&o.bMT(1,1,e.hasRecentItems$))}}function GlobalSearchInputComponent_ng_template_5_div_0_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div")(1,"div",14),o.bIt("click",(function GlobalSearchInputComponent_ng_template_5_div_0_Template_div_click_1_listener(){o.eBV(e);const t=o.XpG().$implicit,n=o.XpG();return o.Njj(n.followItem(t))})),o.j41(2,"div",15),o.EFF(3),o.k0s(),o.j41(4,"div",16),o.EFF(5),o.k0s()()()}if(2&e){const e=o.XpG().$implicit,t=o.XpG();o.R7$(3),o.SpI(" ",t.currentValue,""),o.R7$(),o.FS9("title",e.projectScope),o.R7$(),o.SpI("",e.text," ↵")}}function GlobalSearchInputComponent_ng_template_5_ng_template_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"a",17),o.bIt("click",(function GlobalSearchInputComponent_ng_template_5_ng_template_1_Template_a_click_0_listener(t){o.eBV(e);const n=o.XpG().$implicit,i=o.XpG();return o.Njj(i.redirectToWp(n.id,t))})),o.nrm(1,"op-principal",18),o.j41(2,"div",19)(3,"span",20),o.nrm(4,"span",21),o.EFF(5),o.k0s(),o.j41(6,"div",22),o.nrm(7,"span",23),o.EFF(8),o.nrm(9,"span",24),o.k0s()()()}if(2&e){const e=o.XpG().$implicit,t=o.XpG();o.Y8G("href",t.wpPath(e.id),o.B4B),o.R7$(),o.Y8G("hideName",!0)("principal",e.author)("hoverCard",!1),o.R7$(3),o.Y8G("ngClass",t.highlighting("type",e.type.id))("textContent",e.type.name),o.R7$(),o.SpI(" ",e.subject," "),o.R7$(2),o.Y8G("textContent",e.project.name),o.R7$(),o.SpI(" #",e.id," "),o.R7$(),o.Y8G("textContent",e.status.name)("ngClass",t.statusHighlighting(e.status.id))}}function GlobalSearchInputComponent_ng_template_5_Template(e,t){if(1&e&&o.DNE(0,GlobalSearchInputComponent_ng_template_5_div_0_Template,6,3,"div",13)(1,GlobalSearchInputComponent_ng_template_5_ng_template_1_Template,10,11,"ng-template",null,2,o.C5r),2&e){const e=t.$implicit,n=o.sdS(2);o.Y8G("ngIf",!e.id)("ngIfElse",n)}}class GlobalSearchInputComponent{constructor(e,t,n,i,o,r,s,a,l,c,p,d){this.elementRef=e,this.I18n=t,this.apiV3Service=n,this.pathHelperService=i,this.halResourceService=o,this.globalSearchService=r,this.currentProjectService=s,this.deviceService=a,this.cdRef=l,this.halNotification=c,this.ngZone=p,this.recentItemsService=d,this.expanded=!1,this._markable=new F.t(!1),this.markable$=this._markable.asObservable(),this.hasRecentItems$=this.recentItemsService.recentItems$.pipe((0,G.T)((e=>e.length>0))),this.getAutocompleterData=()=>this.autocompleteWorkPackages(),this.autocompleterOptions={filters:[],resource:"work_packages",searchKey:"subjectOrId",getOptionsFn:this.getAutocompleterData},this.selectedItem=void 0,this.currentValue="",this.isFocusedDirectly=this.globalSearchService.searchTerm.length>0&&this.selectedItem instanceof Ft.q,this.text={all_projects:this.I18n.t("js.global_search.all_projects"),close_search:this.I18n.t("js.global_search.close_search"),current_project_and_all_descendants:this.I18n.t("js.global_search.current_project_and_all_descendants"),current_project:this.I18n.t("js.global_search.current_project"),recently_viewed:this.I18n.t("js.global_search.recently_viewed")},(0,Ot.w)(this)}ngAfterViewInit(){this.searchTerm=this.globalSearchService.searchTerm,this.currentValue="",this.toggleTopMenuClass()}ngOnDestroy(){this.unregister()}set searchTerm(e){this.ngSelectComponent.ngSelectInstance.searchTerm=e}get searchTerm(){return this.ngSelectComponent.ngSelectInstance.searchTerm}set markable(e){this._markable.next(e)}get markable(){return this._markable.value}handleClick(e){e.preventDefault(),(0,It.s)(this.btn.nativeElement,e.target)&&(this.deviceService.isMobile?(this.toggleMobileSearch(),jQuery(".ng-input input").focus(),e.stopPropagation()):0===this.searchTerm?.length?this.ngSelectComponent.ngSelectInstance.focus():this.submitNonEmptySearch())}toggleMobileSearch(){this.expanded=!this.expanded,this.toggleTopMenuClass()}redirectToWp(e,t){return t.stopImmediatePropagation(),!!(0,jt.R)(t)||(window.location.href=this.wpPath(e),t.preventDefault(),!1)}wpPath(e){return this.pathHelperService.workPackagePath(e)}highlighting(e,t){return Pt.H.inlineClass(e,t)}search(e){this.currentValue=this.searchTerm}onFocus(){this.expanded=!0,this.toggleTopMenuClass(),this.ngSelectComponent.openSelect()}onFocusOut(){this.deviceService.isMobile||(this.expanded=null!==this.searchTerm&&this.searchTerm.length>0,this.ngSelectComponent.ngSelectInstance.isOpen=!1,this.selectedItem=void 0,this.toggleTopMenuClass()),document.activeElement.blur()}onClose(){this.searchTerm=this.currentValue}clearSearch(){this.currentValue="",this.searchTerm=""}onEnterBeforeResultsLoaded(){this.markable$.pipe((0,Tt.$)((e=>e))).subscribe((()=>{this.selectedItem?this.followSelectedItem():this.searchInScope(this.currentScope)}))}statusHighlighting(e){return Pt.H.inlineClass("status",e)}followItem(e){this.selectedItem=e,e instanceof Ft.q?window.location.href=this.wpPath(e.id):e&&(this.globalSearchService.searchTerm=this.currentValue,this.searchInScope(e.projectScope))}followSelectedItem(){this.selectedItem&&this.followItem(this.selectedItem)}customSearchFn(e,t){return void 0===t.id||-1!==t.subject.toLowerCase().indexOf(e.toLowerCase())}autocompleteWorkPackages(){const e=this.searchTerm;if(null===e||e.match(/^\s+$/))return(0,je.of)([]);if(!e.length)return this.recentItemsService.recentItems$.pipe((0,ae.n)((e=>0===e.length?(0,je.of)([]):(this.apiV3Service.work_packages.requireAll(e),this.apiV3Service.work_packages.cache.observeSome(e)))));this.selectedItem=void 0,this.markable=!1;const t=this.queryWithoutHash(e);return this.fetchSearchResults(t,t!==e).get().pipe((0,G.T)((e=>this.searchResultsToOptions(e.elements,t))),(0,St.M)((()=>{this.setMarkedOption()})))}queryWithoutHash(e){return/^#(\d+)/.exec(e)?e.substr(1):e}fetchSearchResults(e,t){return this.apiV3Service.work_packages.filterByTypeaheadOrId(e,t)}searchResultsToOptions(e,t){const n=this.detailedSearchOptions();return this.selectedItem=e.find((e=>e.id?.toString()===t))||n[0],[...n,...e]}detailedSearchOptions(){const e=[];return this.currentProjectService.path&&(e.push("current_project_and_all_descendants"),e.push("current_project")),"current_project"===this.globalSearchService.projectScope&&e.reverse(),e.push("all_projects"),e.map((e=>({projectScope:e,text:this.text[e]})))}setMarkedOption(){this.markable=!0,this.ngSelectComponent.ngSelectInstance.itemsList.markItem(this.ngSelectComponent.ngSelectInstance.itemsList.selectedItems[0]),this.cdRef.detectChanges()}searchInScope(e){switch(e){case"all_projects":{let e=!1;"all"!==this.globalSearchService.projectScope&&(e=!0,this.globalSearchService.resultsHidden=!0),this.globalSearchService.projectScope="all",this.submitNonEmptySearch(e);break}case"current_project":this.globalSearchService.projectScope="current_project",this.submitNonEmptySearch();break;case"current_project_and_all_descendants":this.globalSearchService.projectScope="",this.submitNonEmptySearch()}}submitNonEmptySearch(e=!1){if(this.globalSearchService.searchTerm=this.currentValue,this.currentValue.length>0){if(this.ngSelectComponent.ngSelectInstance.close(),!e&&this.globalSearchService.isAfterSearch()&&"work_packages"===this.globalSearchService.currentTab)return void window.history.replaceState({},`${I18n.t("global_search.search")}: ${this.searchTerm}`,this.globalSearchService.searchPath());this.globalSearchService.submitSearch()}}get currentScope(){const e=this.globalSearchService.projectScope;return""===e?"current_project_and_all_descendants":e}unregister(){this.unregisterGlobalListener&&(this.unregisterGlobalListener(),this.unregisterGlobalListener=void 0)}toggleTopMenuClass(){const e=document.getElementsByClassName("op-app-header")[0];e.classList.toggle("op-app-header_search-open",this.expanded),e.dataset.qaSearchOpen="1"}static{this.ɵfac=function GlobalSearchInputComponent_Factory(e){return new(e||GlobalSearchInputComponent)(o.rXU(o.aKT),o.rXU(w.W),o.rXU(O.n),o.rXU(B.B),o.rXU(oe.t),o.rXU(GlobalSearchService),o.rXU(T.c),o.rXU(rt.g),o.rXU(o.gRc),o.rXU(xt.Y),o.rXU(o.SKi),o.rXU(Mt.D))}}static{this.ɵcmp=o.VBU({type:GlobalSearchInputComponent,selectors:[["opce-global-search"]],viewQuery:function GlobalSearchInputComponent_Query(e,t){if(1&e&&(o.GBs(Et,7),o.GBs(Rt.T,7)),2&e){let e;o.mGM(e=o.lsd())&&(t.btn=e.first),o.mGM(e=o.lsd())&&(t.ngSelectComponent=e.first)}},hostBindings:function GlobalSearchInputComponent_HostBindings(e,t){1&e&&o.bIt("click",(function GlobalSearchInputComponent_click_HostBindingHandler(e){return t.handleClick(e)}))},inputs:{placeholder:"placeholder"},decls:9,vars:25,consts:[["select",""],["btn",""],["workPackageItemTemplate",""],[1,"top-menu-search"],["class","top-menu-search--back-button","href","#",3,"title","click",4,"ngIf"],[1,"global-search",3,"focus","blur","search","close","change","keydown.enter","keydown.escape","clear","defaultData","name","id","accesskey","placeholder","classes","inputAttrs","openOnEnter","labelRequired","focusDirectly","model","searchFn","virtualScroll","filters","resource","searchKey","getOptionsFn"],["op-autocompleter-header-tmp",""],["op-autocompleter-option-tmp",""],["role","button","id","top-menu-search-button",1,"top-menu-search--button","search-form-normal",3,"click","title"],["icon-classes","icon5 icon-search ellipsis"],["href","#",1,"top-menu-search--back-button",3,"click","title"],["aria-hidden","true",1,"icon-arrow-left1"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["tabindex","-1",1,"global-search--option",3,"click"],[1,"global-search--search-term"],[1,"global-search--project-scope",3,"title"],["tabindex","-1",1,"global-search--option",2,"line-height","1",3,"click","href"],[1,"hidden-for-mobile","global-search--principal",3,"hideName","principal","hoverCard"],[1,"global-search--option-meta"],[1,"global-search--wp-subject"],[3,"ngClass","textContent"],[1,"global-search--wp-content"],[1,"global-search--wp-project",3,"textContent"],[1,"global-search--wp-status",3,"textContent","ngClass"]],template:function GlobalSearchInputComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",3),o.DNE(1,GlobalSearchInputComponent_button_1_Template,2,1,"button",4),o.j41(2,"op-autocompleter",5,0),o.bIt("focus",(function GlobalSearchInputComponent_Template_op_autocompleter_focus_2_listener(){return o.eBV(e),o.Njj(t.onFocus())}))("blur",(function GlobalSearchInputComponent_Template_op_autocompleter_blur_2_listener(){return o.eBV(e),o.Njj(t.onFocusOut())}))("search",(function GlobalSearchInputComponent_Template_op_autocompleter_search_2_listener(n){return o.eBV(e),o.Njj(t.search(n))}))("close",(function GlobalSearchInputComponent_Template_op_autocompleter_close_2_listener(){return o.eBV(e),o.Njj(t.onClose())}))("change",(function GlobalSearchInputComponent_Template_op_autocompleter_change_2_listener(n){return o.eBV(e),o.Njj(t.followItem(n))}))("keydown.enter",(function GlobalSearchInputComponent_Template_op_autocompleter_keydown_enter_2_listener(){return o.eBV(e),o.Njj(t.onEnterBeforeResultsLoaded())}))("keydown.escape",(function GlobalSearchInputComponent_Template_op_autocompleter_keydown_escape_2_listener(){return o.eBV(e),o.Njj(t.onFocusOut())}))("clear",(function GlobalSearchInputComponent_Template_op_autocompleter_clear_2_listener(){return o.eBV(e),o.Njj(t.clearSearch())})),o.DNE(4,GlobalSearchInputComponent_ng_template_4_Template,2,3,"ng-template",6)(5,GlobalSearchInputComponent_ng_template_5_Template,3,2,"ng-template",7),o.k0s(),o.j41(6,"button",8,1),o.bIt("click",(function GlobalSearchInputComponent_Template_button_click_6_listener(n){return o.eBV(e),o.Njj(t.handleClick(n))})),o.nrm(8,"op-icon",9),o.k0s()()}2&e&&(o.R7$(),o.Y8G("ngIf",t.expanded),o.R7$(),o.Y8G("defaultData",!1)("name","global-search-input")("id","global-search-input")("accesskey",4)("placeholder",t.placeholder)("classes",o.l_i(21,global_search_input_component_c1,t.markable,t.expanded))("inputAttrs",o.lJ4(24,global_search_input_component_c2))("openOnEnter",!0)("labelRequired",!1)("focusDirectly",t.isFocusedDirectly)("model",t.selectedItem)("searchFn",t.customSearchFn)("virtualScroll",!1)("filters",t.autocompleterOptions.filters)("resource",t.autocompleterOptions.resource)("searchKey",t.autocompleterOptions.searchKey)("getOptionsFn",t.autocompleterOptions.getOptionsFn),o.R7$(4),o.AVh("-input-focused",t.expanded),o.FS9("title",t.text.search))},dependencies:[P.YU,P.bT,Le.i,ke.f,Rt.T,Dt.Q,Gt.O,P.Jj],styles:[".cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.top-menu-search{display:flex;align-items:center;position:relative;height:var(--header-height);line-height:var(--header-height);margin:0 15px}@media screen and (max-width: 543px){.top-menu-search{margin:0}}.top-menu-search--back-button{display:none}.top-menu-search--button{padding:0;margin:0;background:transparent;border:0;font:inherit;text-align:inherit;position:absolute;right:2px;font-size:var(--header-item-font-size);color:var(--header-item-font-color)}.top-menu-search--button.-input-focused{color:var(--body-font-color)!important}.top-menu-search--button:hover{text-decoration:none}@media screen and (max-width: 543px){.top-menu-search--button{position:relative;padding:0 8px}.top-menu-search--button:hover{background:var(--header-item-bg-hover-color);color:var(--header-item-font-hover-color);border-bottom:var(--header-border-bottom-width) solid var(--header-border-bottom-color)}}.top-menu-search--loading{top:var(--header-height)-11px;height:46px;z-index:1051}.top-menu-search--input{width:calc(160px + 3vw);font-size:.9rem;transition:width .2s ease-in-out}.top-menu-search--input .ng-input input.global-search--input{color:var(--header-item-font-color)!important}.top-menu-search--input::-ms-clear{margin-right:5px;width:20px}.top-menu-search--input .ng-select-container{background:transparent!important;border-color:var(--header-item-font-color)!important}.top-menu-search--input .ng-select-container:focus-within{outline:2px solid rgb(0,163,255);outline-offset:-2px}.top-menu-search--input .ng-arrow-wrapper{display:none}.top-menu-search--input .ng-clear-wrapper{color:var(--header-item-font-color);top:1px;width:30px;right:25px;text-align:center}@media screen and (max-width: 543px){.top-menu-search--input .ng-input{top:0!important}}.top-menu-search--input .ng-placeholder{color:var(--header-item-font-color)!important;width:calc(100% - 30px)}.top-menu-search--input.-expanded{width:calc(160px + 13vw);background:var(--overlay-bgColor);border-radius:4px}.top-menu-search--input.-expanded .ng-input input.global-search--input,.top-menu-search--input.-expanded .ng-clear-wrapper{color:var(--body-font-color)!important}.top-menu-search--input .ng-dropdown-header{border-bottom:none;color:var(--fgColor-muted);line-height:1rem;margin-top:.5rem;padding:.5rem .75rem;text-transform:uppercase}.top-menu-search--input .ng-dropdown-header:empty{display:none}.top-menu-search--input .ng-dropdown-panel-items.scroll-host{scrollbar-color:transparent transparent;scrollbar-width:thin;max-height:80vh;height:auto}.top-menu-search--input .ng-dropdown-panel-items.scroll-host::-webkit-scrollbar{height:10px;width:10px}.top-menu-search--input .ng-dropdown-panel-items.scroll-host::-webkit-scrollbar-track{background:transparent}.top-menu-search--input .ng-dropdown-panel-items.scroll-host::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.top-menu-search--input .ng-dropdown-panel-items.scroll-host:hover{scrollbar-color:#DDDDDD transparent}.top-menu-search--input .ng-dropdown-panel-items.scroll-host:hover::-webkit-scrollbar-thumb{visibility:visible}.top-menu-search--input .ng-option{border-bottom:1px solid var(--borderColor-default);white-space:normal;padding:5px 10px;background-color:unset}.top-menu-search--input .ng-option:last-child{border-bottom:none}.top-menu-search--input .ng-option.ng-option-disabled{display:none}.top-menu-search--input .ng-option.ng-option-marked{background-color:var(--control-transparent-bgColor-hover)!important}.top-menu-search--input.-markable .ng-option.ng-option-marked{background-color:var(--drop-down-hover-bg-color)}.top-menu-search--input.-markable .ng-option.ng-option-selected{background-color:unset}.top-menu-search--input .ng-spinner-loader{position:relative;right:14px}\n",".cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}@media screen and (max-width: 543px){.top-menu-search--input{display:none}.top-menu-search--input.-expanded{display:block;min-width:unset;flex-basis:100%;position:unset;flex-grow:1}.top-menu-search--input.-expanded .scroll-host{max-height:calc(100vh - var(--header-height))}.top-menu-search--input.-expanded .ng-clear-wrapper{width:40px;right:0}.top-menu-search--input.-expanded .ng-select-bottom{height:calc(100vh - var(--header-height));overflow-y:auto;margin:0}.top-menu-search--input.-expanded .ng-select-container{height:36px!important;border-radius:4px}.top-menu-search--input.-expanded .ng-input input{height:36px}.top-menu-search .top-menu-search--back-button{padding:0;margin:0;background:transparent;border:0;font:inherit;text-align:inherit;display:initial;width:50px;text-align:center;color:var(--header-item-font-color)}.top-menu-search .top-menu-search--back-button:hover,.top-menu-search .top-menu-search--back-button:focus,.top-menu-search .top-menu-search--back-button:active{text-decoration:none}.top-menu-search .top-menu-search--loading{top:var(--header-height)1px}.top-menu-search .top-menu-search--button.-input-focused{color:var(--header-item-font-color)}}\n",'.cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.global-search{flex-grow:1}@media screen and (max-width: 543px){.global-search{display:none}}.global-search--input[type=text]{line-height:20px}.global-search--option,.global-search--option:hover{padding:5px;line-height:15px;min-height:25px;word-break:break-word;color:var(--body-font-color);text-decoration:none;display:flex}.global-search--option-meta{display:flex;flex-direction:column;flex-grow:1;overflow:hidden}.global-search--search-term{flex-grow:1}.global-search--project-scope{flex-grow:0;flex-shrink:1;border:1px solid var(--button-default-borderColor-rest);font-size:13px;background:var(--button--background-color);border-radius:2px;padding:0 4px;color:var(--body-font-color)}.global-search--principal{margin-right:5px;margin-left:-5px}.global-search--wp-content{display:grid;grid-template-columns:50% 1fr auto;grid-template-areas:"project idlink status";font-size:.8rem;padding:5px 0}.global-search--wp-project{grid-area:project;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}.global-search--wp-id{grid-area:idlink;place-self:right;font-style:italic;color:var(--fgColor-muted);font-size:13px;white-space:nowrap}.global-search--wp-status{grid-area:status;overflow:hidden;font-style:italic}.global-search--wp-subject{font-weight:var(--base-text-weight-bold);display:inline-block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;line-height:1.5}\n'],encapsulation:2,changeDetection:0})}}var At=n(52575),Vt=n(19999),$t=n(99496);function GlobalSearchWorkPackagesComponent_wp_embedded_table_0_Template(e,t){if(1&e&&o.nrm(0,"wp-embedded-table",1),2&e){const e=o.XpG();o.Y8G("queryProps",e.queryProps)("configuration",e.tableConfiguration)}}class GlobalSearchWorkPackagesComponent extends $t.p{constructor(e,t,n,i,o,r,s,a,l){super(),this.elementRef=e,this.renderer=t,this.I18n=n,this.halResourceService=i,this.globalSearchService=o,this.wpTableFilters=r,this.querySpace=s,this.wpFilters=a,this.cdRef=l,this.resultsHidden=!1,this.tableConfiguration={actionsColumnEnabled:!1,columnMenuEnabled:!0,contextMenuEnabled:!1,inlineCreateEnabled:!1,withFilters:!0,showFilterButton:!0,filterButtonText:this.I18n.t("js.button_advanced_filter")}}ngAfterViewInit(){(0,Vt.z)([this.globalSearchService.searchTerm$,this.globalSearchService.projectScope$]).pipe((0,we.i)(1),(0,J.F)(),(0,At.B)(10),this.untilDestroyed()).subscribe((()=>{this.wpFilters.visible=!1,this.setQueryProps()})),this.globalSearchService.resultsHidden$.pipe(this.untilDestroyed()).subscribe((e=>this.resultsHidden=e))}ngOnInit(){this.setQueryProps()}setQueryProps(){const e=[];let t=["id","project","subject","type","status","updatedAt"];this.globalSearchService.searchTermIsId?e.push({id:{operator:"=",values:[this.globalSearchService.searchTermWithoutHash]}}):this.globalSearchService.searchTerm.length>0&&e.push({search:{operator:"**",values:[this.globalSearchService.searchTerm]}}),"current_project"===this.globalSearchService.projectScope&&(e.push({subprojectId:{operator:"!*",values:[]}}),t=["id","subject","type","status","updatedAt"]),""===this.globalSearchService.projectScope&&e.push({subprojectId:{operator:"*",values:[]}}),this.queryProps={"columns[]":t,filters:JSON.stringify(e),sortBy:JSON.stringify([["updatedAt","desc"]]),showHierarchies:!1}}static{this.ɵfac=function GlobalSearchWorkPackagesComponent_Factory(e){return new(e||GlobalSearchWorkPackagesComponent)(o.rXU(o.aKT),o.rXU(o.sFG),o.rXU(w.W),o.rXU(oe.t),o.rXU(GlobalSearchService),o.rXU(Pe.N),o.rXU(Ce.i),o.rXU(xe.a),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:GlobalSearchWorkPackagesComponent,selectors:[["opce-global-search-work-packages"]],features:[o.nM4([j.Y]),o.Vt3],decls:1,vars:1,consts:[[3,"queryProps","configuration",4,"ngIf"],[3,"queryProps","configuration"]],template:function GlobalSearchWorkPackagesComponent_Template(e,t){1&e&&o.DNE(0,GlobalSearchWorkPackagesComponent_wp_embedded_table_0_Template,1,2,"wp-embedded-table",0),2&e&&o.Y8G("ngIf",!t.resultsHidden)},dependencies:[P.bT,Te.Z],encapsulation:2,changeDetection:0})}}const Bt=[[["","slot","actions"]]],Wt=["[slot=actions]"];function GlobalSearchTabsComponent_li_5_a_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"a",16),o.bIt("click",(function GlobalSearchTabsComponent_li_5_a_1_Template_a_click_0_listener(t){o.eBV(e);const n=o.XpG().$implicit,i=o.XpG();return o.Njj(i.clickTab(n,t))})),o.k0s()}if(2&e){const e=o.XpG().$implicit,t=o.XpG();o.AVh("op-tab-row--link_selected",e.id===t.currentTabId)("op-tab-row--link_disabled",void 0!==e.disable),o.Y8G("href",e.path,o.B4B)("textContent",e.name),o.BMQ("aria-selected",e.id===t.currentTabId)("title",t.tabTitle(e))}}function GlobalSearchTabsComponent_li_5_a_2_ng_container_2_op_tab_count_1_Template(e,t){if(1&e&&o.nrm(0,"op-tab-count",22),2&e){const e=o.XpG().ngIf,t=o.XpG(2).$implicit;o.Y8G("count",e),o.BMQ("data-test-selector","tab-counter-"+t.name)}}function GlobalSearchTabsComponent_li_5_a_2_ng_container_2_span_2_Template(e,t){if(1&e&&(o.j41(0,"span",23),o.EFF(1),o.k0s()),2&e){const e=o.XpG().ngIf;o.R7$(),o.SpI(" (",e,")")}}function GlobalSearchTabsComponent_li_5_a_2_ng_container_2_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,GlobalSearchTabsComponent_li_5_a_2_ng_container_2_op_tab_count_1_Template,1,2,"op-tab-count",20)(2,GlobalSearchTabsComponent_li_5_a_2_ng_container_2_span_2_Template,2,1,"span",21),o.bVm()),2&e){const e=t.ngIf,n=o.XpG(2).$implicit;o.R7$(),o.Y8G("ngIf",n.showCountAsBubble),o.R7$(),o.Y8G("ngIf",e>0&&!n.showCountAsBubble)}}function GlobalSearchTabsComponent_li_5_a_2_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"a",17),o.bIt("click",(function GlobalSearchTabsComponent_li_5_a_2_Template_a_click_0_listener(t){o.eBV(e);const n=o.XpG().$implicit,i=o.XpG();return o.Njj(i.clickTab(n,t))})),o.nrm(1,"span",18),o.DNE(2,GlobalSearchTabsComponent_li_5_a_2_ng_container_2_Template,3,2,"ng-container",19),o.nI1(3,"async"),o.k0s()}if(2&e){const e=o.XpG().$implicit,t=o.XpG();o.AVh("op-tab-row--link_disabled",void 0!==e.disable),o.Y8G("uiSref",e.route)("uiParams",e.routeParams),o.BMQ("aria-selected",e.id===t.currentTabId)("title",t.tabTitle(e)),o.R7$(),o.Y8G("textContent",e.name),o.R7$(),o.Y8G("ngIf",o.bMT(3,8,t.counter(e)))}}function GlobalSearchTabsComponent_li_5_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"li",13),o.bIt("dragenter",(function GlobalSearchTabsComponent_li_5_Template_li_dragenter_0_listener(){const t=o.eBV(e).$implicit,n=o.XpG();return o.Njj(n.startDebouncedTabActivation(t))}))("dragleave",(function GlobalSearchTabsComponent_li_5_Template_li_dragleave_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.cancelDebouncedTabActivation())})),o.DNE(1,GlobalSearchTabsComponent_li_5_a_1_Template,1,8,"a",14)(2,GlobalSearchTabsComponent_li_5_a_2_Template,4,10,"a",15),o.k0s()}if(2&e){const e=t.$implicit,n=o.XpG();o.BMQ("data-tab-id",e.id)("data-qa-tab-id",e.id)("data-qa-tab-selected",e.id===n.currentTabId||void 0)("data-qa-tab-disabled",e.disable||void 0),o.R7$(),o.Y8G("ngIf",!e.route),o.R7$(),o.Y8G("ngIf",e.route)}}class GlobalSearchTabsComponent extends ue.f{constructor(e,t,n,i){super(t,i,n),this.globalSearchService=e,this.$state=t,this.injector=n,this.classes=["global-search--tabs","scrollable-tabs"]}ngOnInit(){this.currentTabSub=this.globalSearchService.currentTab$.subscribe((e=>{this.currentTabId=e})),this.tabsSub=this.globalSearchService.tabs$.subscribe((e=>{this.tabs=e,this.tabs.map((e=>e.path="#"))}))}clickTab(e,t){super.clickTab(e,t),this.globalSearchService.currentTab=e.id,this.globalSearchService.submitSearch()}ngOnDestroy(){this.currentTabSub.unsubscribe(),this.tabsSub.unsubscribe()}static{this.ɵfac=function GlobalSearchTabsComponent_Factory(e){return new(e||GlobalSearchTabsComponent)(o.rXU(GlobalSearchService),o.rXU(ye.dw),o.rXU(o.zZn),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:GlobalSearchTabsComponent,selectors:[["opce-global-search-tabs"]],features:[o.Vt3],ngContentSelectors:Wt,decls:14,vars:5,consts:[["scrollContainer",""],["scrollPane",""],["scrollLeftBtn",""],["scrollRightBtn",""],[1,"op-scrollable-tabs",3,"ngClass"],[1,"op-scrollable-tabs--tab-container"],[1,"op-tab-row",3,"scroll"],["class","op-tab-row--tab",3,"dragenter","dragleave",4,"ngFor","ngForOf","ngForTrackBy"],[1,"op-scrollable-tabs--button","op-scrollable-tabs--button_left",3,"click","hidden"],[1,"icon-arrow-left2"],[1,"op-scrollable-tabs--button","op-scrollable-tabs--button_right",3,"click","hidden"],[1,"icon-arrow-right2"],[1,"op-scrollable-tabs--actions"],[1,"op-tab-row--tab",3,"dragenter","dragleave"],["class","op-tab-row--link","role","tab",3,"href","op-tab-row--link_selected","op-tab-row--link_disabled","textContent","click",4,"ngIf"],["role","tab","class","op-tab-row--link","uiSrefActive","op-tab-row--link_selected","href","",3,"uiSref","uiParams","op-tab-row--link_disabled","click",4,"ngIf"],["role","tab",1,"op-tab-row--link",3,"click","href","textContent"],["role","tab","uiSrefActive","op-tab-row--link_selected","href","",1,"op-tab-row--link",3,"click","uiSref","uiParams"],[3,"textContent"],[4,"ngIf"],[3,"count",4,"ngIf"],["data-test-selector","tab-count",4,"ngIf"],[3,"count"],["data-test-selector","tab-count"]],template:function GlobalSearchTabsComponent_Template(e,t){if(1&e){const e=o.RV6();o.NAR(Bt),o.j41(0,"div",4)(1,"div",5,0)(3,"ul",6,1),o.bIt("scroll",(function GlobalSearchTabsComponent_Template_ul_scroll_3_listener(){return o.eBV(e),o.Njj(t.onScroll())})),o.DNE(5,GlobalSearchTabsComponent_li_5_Template,3,6,"li",7),o.k0s(),o.j41(6,"div",8,2),o.bIt("click",(function GlobalSearchTabsComponent_Template_div_click_6_listener(){return o.eBV(e),o.Njj(t.scrollLeft())})),o.nrm(8,"span",9),o.k0s(),o.j41(9,"div",10,3),o.bIt("click",(function GlobalSearchTabsComponent_Template_div_click_9_listener(){return o.eBV(e),o.Njj(t.scrollRight())})),o.nrm(11,"span",11),o.k0s()(),o.j41(12,"ul",12),o.SdG(13),o.k0s()()}2&e&&(o.Y8G("ngClass",t.classes),o.R7$(5),o.Y8G("ngForOf",t.tabs)("ngForTrackBy",t.trackById),o.R7$(),o.Y8G("hidden",t.hideLeftButton),o.R7$(3),o.Y8G("hidden",t.hideRightButton))},dependencies:[nt.UISref,nt.AnchorUISref,nt.UISrefActive,nt.UISrefStatus,P.YU,P.Sq,P.bT,P.Jj],encapsulation:2,changeDetection:0})}}class GlobalSearchTitleComponent extends $t.p{constructor(e,t,n,i,o){super(),this.elementRef=e,this.cdRef=t,this.globalSearchService=n,this.I18n=i,this.injector=o,this.text={all_projects:this.I18n.t("js.global_search.title.all_projects"),project_and_subprojects:this.I18n.t("js.global_search.title.project_and_subprojects"),search_for:this.I18n.t("js.global_search.title.search_for"),in:this.I18n.t("js.label_in")}}ngOnInit(){(0,Vt.z)([this.globalSearchService.searchTerm$,this.globalSearchService.projectScope$]).pipe((0,J.F)(),this.untilDestroyed()).subscribe((([e,t])=>{this.searchTerm=e,this.project=this.projectText(t),this.searchTitle=`${this.text.search_for} ${this.searchTerm} ${""===this.project?"":this.text.in} ${this.project}`,this.cdRef.detectChanges()}))}projectText(e){const t=this.currentProjectService.name?this.currentProjectService.name:"";switch(e){case"all":return this.text.all_projects;case"current_project":return t;case"":return`${t} ${this.text.project_and_subprojects}`;default:return""}}static{this.ɵfac=function GlobalSearchTitleComponent_Factory(e){return new(e||GlobalSearchTitleComponent)(o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(GlobalSearchService),o.rXU(w.W),o.rXU(o.zZn))}}static{this.ɵcmp=o.VBU({type:GlobalSearchTitleComponent,selectors:[["opce-global-search-title"]],inputs:{searchTerm:"searchTerm",project:"project",projectScope:"projectScope",searchTitle:"searchTitle"},features:[o.Vt3],decls:11,vars:5,consts:[[1,"toolbar-container"],[1,"toolbar"],[1,"title-container"],[1,"toolbar-items"]],template:function GlobalSearchTitleComponent_Template(e,t){1&e&&(o.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),o.EFF(4),o.j41(5,"i"),o.EFF(6),o.k0s(),o.EFF(7),o.j41(8,"i"),o.EFF(9),o.k0s()(),o.nrm(10,"ul",3),o.k0s()()()),2&e&&(o.R7$(3),o.BMQ("title",t.searchTitle),o.R7$(),o.SpI(" ",t.text.search_for," "),o.R7$(2),o.SpI('"',t.searchTerm,'"'),o.R7$(),o.SpI(" ",""===t.project?"":t.text.in," "),o.R7$(2),o.JRh(t.project))},encapsulation:2,changeDetection:0})}}(0,U.Cg)([(0,Q.O)(),(0,U.Sn)("design:type",T.c)],GlobalSearchTitleComponent.prototype,"currentProjectService",void 0);var Nt=n(42572);class OpenprojectGlobalSearchModule{constructor(e){this.injector=e}static{this.ɵfac=function OpenprojectGlobalSearchModule_Factory(e){return new(e||OpenprojectGlobalSearchModule)(o.KVO(o.zZn))}}static{this.ɵmod=o.$C({type:OpenprojectGlobalSearchModule})}static{this.ɵinj=o.G2t({providers:[GlobalSearchService,Mt.D],imports:[d.d,h.W,Nt.E]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenprojectGlobalSearchModule,{declarations:[GlobalSearchInputComponent,GlobalSearchWorkPackagesComponent,GlobalSearchTabsComponent,GlobalSearchTitleComponent],imports:[d.d,h.W,Nt.E]});var Ut=n(48707);class GridPageComponent{constructor(e,t,n,i,o,r,s,a,l,c){this.gridInitialization=e,this.pathHelper=t,this.currentProject=n,this.i18n=i,this.cdRef=o,this.title=r,this.addWidget=s,this.renderer=a,this.areas=l,this.configurationService=c,this.text={title:this.i18n.t(`js.${this.i18nNamespace()}.label`),html_title:this.i18n.t(`js.${this.i18nNamespace()}.label`)},this.showToolbar=!0}isTurboFrameSidebarEnabled(){return!1}ngOnInit(){this.renderer.addClass(document.body,"widget-grid-layout"),this.gridInitialization.initialize(this.gridScopePath()).subscribe((e=>{this.grid=e,this.cdRef.detectChanges()})),this.setHtmlTitle()}ngOnDestroy(){this.renderer.removeClass(document.body,"widget-grid-layout")}setHtmlTitle(){this.title.setFirstPart(this.text.html_title)}static{this.ɵfac=function GridPageComponent_Factory(e){return new(e||GridPageComponent)(o.rXU(GridInitializationService),o.rXU(B.B),o.rXU(T.c),o.rXU(w.W),o.rXU(o.gRc),o.rXU(Ut.P),o.rXU(GridAddWidgetService),o.rXU(o.sFG),o.rXU(GridAreaService),o.rXU(q.s))}}static{this.ɵdir=o.FsC({type:GridPageComponent})}}var Yt=n(53689),Xt=n(58397);function DashboardComponent_div_1_Template(e,t){if(1&e&&(o.j41(0,"div",4)(1,"div",5),o.nrm(2,"h2",6),o.k0s(),o.j41(3,"ul",7)(4,"li",8),o.nrm(5,"opce-zen-mode-toggle-button"),o.k0s()()()),2&e){const e=o.XpG();o.R7$(2),o.Y8G("textContent",e.text.title)}}function DashboardComponent_div_2_grid_2_Template(e,t){if(1&e&&o.nrm(0,"grid",14),2&e){const e=o.XpG(2);o.Y8G("grid",e.grid)}}function DashboardComponent_div_2_turbo_frame_4_Template(e,t){if(1&e&&(o.j41(0,"turbo-frame",15)(1,"op-content-loader",16),o.qSk(),o.nrm(2,"rect",17)(3,"rect",18)(4,"rect",19)(5,"rect",20),o.k0s()()),2&e){const e=o.XpG(2);o.Y8G("src",e.lifeCyclesSidebarSrc())("id",e.lifeCyclesSidebarId())}}function DashboardComponent_div_2_turbo_frame_5_Template(e,t){if(1&e&&(o.j41(0,"turbo-frame",15)(1,"op-content-loader",16),o.qSk(),o.nrm(2,"rect",17)(3,"rect",18)(4,"rect",19)(5,"rect",20),o.k0s()()),2&e){const e=o.XpG(2);o.Y8G("src",e.projectCustomFieldsSidebarSrc())("id",e.projectCustomFieldsSidebarId())}}function DashboardComponent_div_2_Template(e,t){if(1&e&&(o.j41(0,"div",9)(1,"div",10),o.DNE(2,DashboardComponent_div_2_grid_2_Template,1,1,"grid",11),o.k0s(),o.j41(3,"div",12),o.DNE(4,DashboardComponent_div_2_turbo_frame_4_Template,6,2,"turbo-frame",13)(5,DashboardComponent_div_2_turbo_frame_5_Template,6,2,"turbo-frame",13),o.k0s()()),2&e){const e=o.XpG();o.R7$(2),o.Y8G("ngIf",e.grid),o.R7$(2),o.Y8G("ngIf",e.isLifeCyclesSidebarEnabled()),o.R7$(),o.Y8G("ngIf",e.isCustomFieldsSidebarEnabled())}}function DashboardComponent_div_3_grid_1_Template(e,t){if(1&e&&o.nrm(0,"grid",14),2&e){const e=o.XpG(2);o.Y8G("grid",e.grid)}}function DashboardComponent_div_3_Template(e,t){if(1&e&&(o.j41(0,"div"),o.DNE(1,DashboardComponent_div_3_grid_1_Template,1,1,"grid",11),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.Y8G("ngIf",e.grid)}}class DashboardComponent extends GridPageComponent{i18nNamespace(){return"dashboards"}gridScopePath(){return this.pathHelper.projectDashboardsPath(this.currentProject.identifier)}static{this.ɵfac=(()=>{let e;return function DashboardComponent_Factory(t){return(e||(e=o.xGo(DashboardComponent)))(t||DashboardComponent)}})()}static{this.ɵcmp=o.VBU({type:DashboardComponent,selectors:[["dashboard"]],features:[o.Jv_(fe),o.Vt3],decls:4,vars:3,consts:[[1,"op-grid-page"],["class","toolbar op-grid-page--toolbar-container",4,"ngIf"],["class","op-grid-page--grid-container",4,"ngIf"],[4,"ngIf"],[1,"toolbar","op-grid-page--toolbar-container"],[1,"op-grid-page--title-container","title-container"],[3,"textContent"],[1,"op-grid-page--toolbar-items","toolbar-items","hidden-for-mobile"],[1,"toolbar-item","hidden-for-tablet"],[1,"op-grid-page--grid-container"],[1,"op-grid-page--main-content"],[3,"grid",4,"ngIf"],[1,"op-grid-page--sidebar"],[3,"src","id",4,"ngIf"],[3,"grid"],[3,"src","id"],["viewBox","0 0 100 100"],["x","0","y","0","width","70","height","5","rx","1"],["x","75","y","0","width","25","height","5","rx","1"],["x","0","y","10","width","100","height","8","rx","1"],["x","0","y","25","width","100","height","12","rx","1"]],template:function DashboardComponent_Template(e,t){1&e&&(o.j41(0,"div",0),o.DNE(1,DashboardComponent_div_1_Template,6,1,"div",1)(2,DashboardComponent_div_2_Template,6,3,"div",2)(3,DashboardComponent_div_3_Template,2,1,"div",3),o.k0s()),2&e&&(o.R7$(),o.Y8G("ngIf",t.showToolbar),o.R7$(),o.Y8G("ngIf",t.isTurboFrameSidebarEnabled()),o.R7$(),o.Y8G("ngIf",!t.isTurboFrameSidebarEnabled()))},dependencies:[P.bT,Yt.F,Xt.y,GridComponent],styles:[".op-grid-page--title-container[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:-5px}.op-grid-page--toolbar-container[_ngcontent-%COMP%]{margin-bottom:0}.op-grid-page--toolbar-items[_ngcontent-%COMP%]{padding-right:20px}.op-grid-page--grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:75% 25%;gap:20px}.op-grid-page--sidebar[_ngcontent-%COMP%]{margin-top:20px;margin-right:40px}@media only screen and (max-width: 543px){.op-grid-page--title-container[_ngcontent-%COMP%]{margin-left:0;margin-bottom:0}}@media only screen and (max-width: 1011px){.op-grid-page--grid-container[_ngcontent-%COMP%]{grid-template-columns:100%;gap:0}.op-grid-page--sidebar[_ngcontent-%COMP%]{display:none}}"]})}}const qt=[{name:"dashboards",parent:"optional_project",url:"/dashboards/",data:{bodyClasses:["router--dashboards-view-base","widget-grid-layout"],menuItem:"dashboards-menu-item"},component:DashboardComponent}];function uiRouterDashboardsConfiguration(e){e.urlService.rules.when(new RegExp("^/projects/(.*)/dashboards$"),(e=>`/projects/${e[1]}/dashboards/`))}class OpenprojectDashboardsModule{static{this.ɵfac=function OpenprojectDashboardsModule_Factory(e){return new(e||OpenprojectDashboardsModule)}}static{this.ɵmod=o.$C({type:OpenprojectDashboardsModule})}static{this.ɵinj=o.G2t({imports:[d.d,OpenprojectGridsModule,nt.UIRouterModule.forChild({states:qt,config:uiRouterDashboardsConfiguration})]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenprojectDashboardsModule,{declarations:[DashboardComponent],imports:[d.d,OpenprojectGridsModule,nt.UIRouterModule]});var Lt=n(18278);const Ht=["turboFrame"];function HoverCardComponent_div_0_Template(e,t){if(1&e&&(o.j41(0,"div",2),o.nrm(1,"turbo-frame",3,0),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.Y8G("src",e.turboFrameSrc)}}class HoverCardComponent extends X.a{set turboFrame(e){void 0!==e&&(this.setOpacity(this.elementRef,0),e.nativeElement?.addEventListener("turbo:frame-load",(()=>{const e=this.elementRef.nativeElement;this.reposition(e,this.locals.event.target),this.setOpacity(this.elementRef,1)})))}constructor(e,t,n){super(t,n,e),this.elementRef=e,this.locals=t,this.cdRef=n,this.alignment="bottom-end",this.allowRepositioning=!0}ngOnInit(){super.ngOnInit(),this.turboFrameSrc=this.locals.turboFrameSrc}reposition(e,t){var n=this;return(0,x.A)((function*(){const i=e.children[0],{x:o,y:r}=yield(0,Lt.rD)(t,i,{placement:n.alignment,middleware:n.allowRepositioning?[(0,Lt.UU)({mainAxis:!0,crossAxis:!0,fallbackAxisSideDirection:"start"}),(0,Lt.BN)({limiter:(0,Lt.ER)()})]:[]});Object.assign(i.style,{left:`${o}px`,top:`${r}px`})}))()}setOpacity(e,t){e.nativeElement.style.opacity=t.toString()}static{this.ɵfac=function HoverCardComponent_Factory(e){return new(e||HoverCardComponent)(o.rXU(o.aKT),o.rXU(Y.Y),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:HoverCardComponent,selectors:[["ng-component"]],viewQuery:function HoverCardComponent_Query(e,t){if(1&e&&o.GBs(Ht,5),2&e){let e;o.mGM(e=o.lsd())&&(t.turboFrame=e.first)}},inputs:{alignment:"alignment",allowRepositioning:"allowRepositioning"},features:[o.nM4([j.Y]),o.Vt3],decls:1,vars:1,consts:[["turboFrame",""],["class","op-hover-card",4,"ngIf"],[1,"op-hover-card"],["loading","lazy","id","op-hover-card-body",3,"src"]],template:function HoverCardComponent_Template(e,t){1&e&&o.DNE(0,HoverCardComponent_div_0_Template,3,1,"div",1),2&e&&o.Y8G("ngIf",t.turboFrameSrc)},dependencies:[P.bT],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}@keyframes _ngcontent-%COMP%_fade-in-hover-card{0%{opacity:0}to{opacity:1}}.op-hover-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fade-in-hover-card .25s ease-in;position:absolute;background-color:var(--body-background);z-index:5000;width:500px;box-shadow:var(--shadow-floating-medium);pointer-events:all;padding:var(--overlay-paddingBlock-normal);border-radius:var(--overlay-borderRadius)}"],changeDetection:0})}}var zt=n(17732);class HoverCardTriggerService{constructor(e,t,n){this.opModalService=e,this.ngZone=t,this.injector=n,this.mouseInModal=!1,this.hoverTimeout=null,this.closeTimeout=null,this.modalTarget=zt.V.Default,this.previousTarget=null,this.OPEN_DELAY_IN_MS=1e3,this.CLOSE_DELAY_IN_MS=250}setupListener(){jQuery(document.body).on("mouseover",".op-hover-card--preview-trigger",(e=>{e.preventDefault(),e.stopPropagation();const t=e.target;if(!t)return;if(this.previousTarget&&this.previousTarget===t)return void(this.mouseInModal=!0);this.close(!0),this.previousTarget=t;const n=t.getAttribute("data-hover-card-url");n&&(this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null),this.hoverTimeout=window.setTimeout((()=>{this.showHoverCard(t,n,e)}),this.OPEN_DELAY_IN_MS))})),jQuery(document.body).on("mouseleave",".op-hover-card--preview-trigger",(()=>{this.clearHoverTimer(),this.mouseInModal=!1,this.closeAfterTimeout()})),jQuery(document.body).on("mouseleave",".op-hover-card",(()=>{this.clearHoverTimer(),this.mouseInModal=!1,this.closeAfterTimeout()})),jQuery(document.body).on("mouseenter",".op-hover-card",(()=>{this.mouseInModal=!0}))}showHoverCard(e,t,n){if(!document.body.contains(e))return;this.parseHoverCardOptions(e);const i=this.opModalService.showIfNotActive(HoverCardComponent,this.injector,{turboFrameSrc:t,event:n},!0,!1,this.modalTarget);i?.subscribe((t=>{this.modalElement=t.elementRef.nativeElement,t.alignment="top",t.reposition(this.modalElement,e)}))}clearHoverTimer(){this.hoverTimeout&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=null)}closeAfterTimeout(){this.ngZone.runOutsideAngular((()=>{this.closeTimeout=window.setTimeout((()=>{this.close()}),this.CLOSE_DELAY_IN_MS)}))}close(e=!1){e&&(this.mouseInModal=!1),this.mouseInModal||(this.opModalService.close(),this.previousTarget=null)}parseHoverCardOptions(e){const t=e.getAttribute("data-hover-card-target");t&&(this.modalTarget=parseInt(t,10))}static{this.ɵfac=function HoverCardTriggerService_Factory(e){return new(e||HoverCardTriggerService)(o.KVO(Y.a),o.KVO(o.SKi),o.KVO(o.zZn))}}static{this.ɵprov=o.jDH({token:HoverCardTriggerService,factory:HoverCardTriggerService.ɵfac,providedIn:"root"})}}function OverviewComponent_div_1_Template(e,t){if(1&e&&(o.j41(0,"div",4)(1,"div",5),o.nrm(2,"h2",6),o.k0s(),o.j41(3,"ul",7)(4,"li",8),o.nrm(5,"opce-zen-mode-toggle-button"),o.k0s()()()),2&e){const e=o.XpG();o.R7$(2),o.Y8G("textContent",e.text.title)}}function OverviewComponent_div_2_grid_2_Template(e,t){if(1&e&&o.nrm(0,"grid",14),2&e){const e=o.XpG(2);o.Y8G("grid",e.grid)}}function OverviewComponent_div_2_turbo_frame_4_Template(e,t){if(1&e&&(o.j41(0,"turbo-frame",15)(1,"op-content-loader",16),o.qSk(),o.nrm(2,"rect",17)(3,"rect",18)(4,"rect",19)(5,"rect",20),o.k0s()()),2&e){const e=o.XpG(2);o.Y8G("src",e.lifeCyclesSidebarSrc())("id",e.lifeCyclesSidebarId())}}function OverviewComponent_div_2_turbo_frame_5_Template(e,t){if(1&e&&(o.j41(0,"turbo-frame",15)(1,"op-content-loader",16),o.qSk(),o.nrm(2,"rect",17)(3,"rect",18)(4,"rect",19)(5,"rect",20),o.k0s()()),2&e){const e=o.XpG(2);o.Y8G("src",e.projectCustomFieldsSidebarSrc())("id",e.projectCustomFieldsSidebarId())}}function OverviewComponent_div_2_Template(e,t){if(1&e&&(o.j41(0,"div",9)(1,"div",10),o.DNE(2,OverviewComponent_div_2_grid_2_Template,1,1,"grid",11),o.k0s(),o.j41(3,"div",12),o.DNE(4,OverviewComponent_div_2_turbo_frame_4_Template,6,2,"turbo-frame",13)(5,OverviewComponent_div_2_turbo_frame_5_Template,6,2,"turbo-frame",13),o.k0s()()),2&e){const e=o.XpG();o.R7$(2),o.Y8G("ngIf",e.grid),o.R7$(2),o.Y8G("ngIf",e.isLifeCyclesSidebarEnabled()),o.R7$(),o.Y8G("ngIf",e.isCustomFieldsSidebarEnabled())}}function OverviewComponent_div_3_grid_1_Template(e,t){if(1&e&&o.nrm(0,"grid",14),2&e){const e=o.XpG(2);o.Y8G("grid",e.grid)}}function OverviewComponent_div_3_Template(e,t){if(1&e&&(o.j41(0,"div"),o.DNE(1,OverviewComponent_div_3_grid_1_Template,1,1,"grid",11),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.Y8G("ngIf",e.grid)}}class OverviewComponent extends GridPageComponent{constructor(){super(...arguments),this.showToolbar=!1}i18nNamespace(){return"overviews"}isTurboFrameSidebarEnabled(){return this.isCustomFieldsSidebarEnabled()||this.isLifeCyclesSidebarEnabled()}isCustomFieldsSidebarEnabled(){const e=document.querySelector('meta[name="custom_fields_sidebar_enabled"]');return"true"===e?.dataset.enabled}isLifeCyclesSidebarEnabled(){const e=document.querySelector('meta[name="life_cycles_sidebar_enabled"]');return"true"===e?.dataset.enabled}lifeCyclesSidebarSrc(){return`${this.pathHelper.staticBase}/projects/${this.currentProject.identifier??""}/project_life_cycles_sidebar`}lifeCyclesSidebarId(){return"project-life-cycles-sidebar"}projectCustomFieldsSidebarSrc(){return`${this.pathHelper.staticBase}/projects/${this.currentProject.identifier??""}/project_custom_fields_sidebar`}projectCustomFieldsSidebarId(){return"project-custom-fields-sidebar"}gridScopePath(){return this.pathHelper.projectPath(this.currentProject.identifier??"")}static{this.ɵfac=(()=>{let e;return function OverviewComponent_Factory(t){return(e||(e=o.xGo(OverviewComponent)))(t||OverviewComponent)}})()}static{this.ɵcmp=o.VBU({type:OverviewComponent,selectors:[["overview"]],features:[o.Jv_(fe),o.Vt3],decls:4,vars:3,consts:[[1,"op-grid-page"],["class","toolbar op-grid-page--toolbar-container",4,"ngIf"],["class","op-grid-page--grid-container",4,"ngIf"],[4,"ngIf"],[1,"toolbar","op-grid-page--toolbar-container"],[1,"op-grid-page--title-container","title-container"],[3,"textContent"],[1,"op-grid-page--toolbar-items","toolbar-items","hidden-for-mobile"],[1,"toolbar-item","hidden-for-tablet"],[1,"op-grid-page--grid-container"],[1,"op-grid-page--main-content"],[3,"grid",4,"ngIf"],[1,"op-grid-page--sidebar"],[3,"src","id",4,"ngIf"],[3,"grid"],[3,"src","id"],["viewBox","0 0 100 100"],["x","0","y","0","width","70","height","5","rx","1"],["x","75","y","0","width","25","height","5","rx","1"],["x","0","y","10","width","100","height","8","rx","1"],["x","0","y","25","width","100","height","12","rx","1"]],template:function OverviewComponent_Template(e,t){1&e&&(o.j41(0,"div",0),o.DNE(1,OverviewComponent_div_1_Template,6,1,"div",1)(2,OverviewComponent_div_2_Template,6,3,"div",2)(3,OverviewComponent_div_3_Template,2,1,"div",3),o.k0s()),2&e&&(o.R7$(),o.Y8G("ngIf",t.showToolbar),o.R7$(),o.Y8G("ngIf",t.isTurboFrameSidebarEnabled()),o.R7$(),o.Y8G("ngIf",!t.isTurboFrameSidebarEnabled()))},dependencies:[P.bT,Yt.F,Xt.y,GridComponent],styles:[".op-grid-page--title-container[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:-5px}.op-grid-page--toolbar-container[_ngcontent-%COMP%]{margin-bottom:0}.op-grid-page--toolbar-items[_ngcontent-%COMP%]{padding-right:20px}.op-grid-page--grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:75% 25%;gap:20px}.op-grid-page--sidebar[_ngcontent-%COMP%]{margin-top:20px;margin-right:40px}@media only screen and (max-width: 543px){.op-grid-page--title-container[_ngcontent-%COMP%]{margin-left:0;margin-bottom:0}}@media only screen and (max-width: 1011px){.op-grid-page--grid-container[_ngcontent-%COMP%]{grid-template-columns:100%;gap:0}.op-grid-page--sidebar[_ngcontent-%COMP%]{display:none}}"],changeDetection:0})}}const Qt=[{name:"overview",parent:"optional_project",url:"/",data:{menuItem:"overview-menu-item"},component:OverviewComponent}];function uiRouterOverviewConfiguration(e){e.urlService.rules.when(new RegExp("^/projects(?!/new$)/([^/?]+)$"),(e=>`/projects/${e[1]}/${window.location.search}`))}class OpenprojectOverviewModule{static{this.ɵfac=function OpenprojectOverviewModule_Factory(e){return new(e||OpenprojectOverviewModule)}}static{this.ɵmod=o.$C({type:OpenprojectOverviewModule})}static{this.ɵinj=o.G2t({imports:[d.d,OpenprojectGridsModule,nt.UIRouterModule.forChild({states:Qt,config:uiRouterOverviewConfiguration})]})}}function MyPageComponent_div_1_Template(e,t){if(1&e&&(o.j41(0,"div",4)(1,"div",5),o.nrm(2,"h2",6),o.k0s(),o.j41(3,"ul",7)(4,"li",8),o.nrm(5,"opce-zen-mode-toggle-button"),o.k0s()()()),2&e){const e=o.XpG();o.R7$(2),o.Y8G("textContent",e.text.title)}}function MyPageComponent_div_2_grid_2_Template(e,t){if(1&e&&o.nrm(0,"grid",14),2&e){const e=o.XpG(2);o.Y8G("grid",e.grid)}}function MyPageComponent_div_2_turbo_frame_4_Template(e,t){if(1&e&&(o.j41(0,"turbo-frame",15)(1,"op-content-loader",16),o.qSk(),o.nrm(2,"rect",17)(3,"rect",18)(4,"rect",19)(5,"rect",20),o.k0s()()),2&e){const e=o.XpG(2);o.Y8G("src",e.lifeCyclesSidebarSrc())("id",e.lifeCyclesSidebarId())}}function MyPageComponent_div_2_turbo_frame_5_Template(e,t){if(1&e&&(o.j41(0,"turbo-frame",15)(1,"op-content-loader",16),o.qSk(),o.nrm(2,"rect",17)(3,"rect",18)(4,"rect",19)(5,"rect",20),o.k0s()()),2&e){const e=o.XpG(2);o.Y8G("src",e.projectCustomFieldsSidebarSrc())("id",e.projectCustomFieldsSidebarId())}}function MyPageComponent_div_2_Template(e,t){if(1&e&&(o.j41(0,"div",9)(1,"div",10),o.DNE(2,MyPageComponent_div_2_grid_2_Template,1,1,"grid",11),o.k0s(),o.j41(3,"div",12),o.DNE(4,MyPageComponent_div_2_turbo_frame_4_Template,6,2,"turbo-frame",13)(5,MyPageComponent_div_2_turbo_frame_5_Template,6,2,"turbo-frame",13),o.k0s()()),2&e){const e=o.XpG();o.R7$(2),o.Y8G("ngIf",e.grid),o.R7$(2),o.Y8G("ngIf",e.isLifeCyclesSidebarEnabled()),o.R7$(),o.Y8G("ngIf",e.isCustomFieldsSidebarEnabled())}}function MyPageComponent_div_3_grid_1_Template(e,t){if(1&e&&o.nrm(0,"grid",14),2&e){const e=o.XpG(2);o.Y8G("grid",e.grid)}}function MyPageComponent_div_3_Template(e,t){if(1&e&&(o.j41(0,"div"),o.DNE(1,MyPageComponent_div_3_grid_1_Template,1,1,"grid",11),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.Y8G("ngIf",e.grid)}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenprojectOverviewModule,{declarations:[OverviewComponent],imports:[d.d,OpenprojectGridsModule,nt.UIRouterModule]});class MyPageComponent extends GridPageComponent{i18nNamespace(){return"my_page"}gridScopePath(){return this.pathHelper.myPagePath()}static{this.ɵfac=(()=>{let e;return function MyPageComponent_Factory(t){return(e||(e=o.xGo(MyPageComponent)))(t||MyPageComponent)}})()}static{this.ɵcmp=o.VBU({type:MyPageComponent,selectors:[["ng-component"]],features:[o.Jv_(fe),o.Vt3],decls:4,vars:3,consts:[[1,"op-grid-page"],["class","toolbar op-grid-page--toolbar-container",4,"ngIf"],["class","op-grid-page--grid-container",4,"ngIf"],[4,"ngIf"],[1,"toolbar","op-grid-page--toolbar-container"],[1,"op-grid-page--title-container","title-container"],[3,"textContent"],[1,"op-grid-page--toolbar-items","toolbar-items","hidden-for-mobile"],[1,"toolbar-item","hidden-for-tablet"],[1,"op-grid-page--grid-container"],[1,"op-grid-page--main-content"],[3,"grid",4,"ngIf"],[1,"op-grid-page--sidebar"],[3,"src","id",4,"ngIf"],[3,"grid"],[3,"src","id"],["viewBox","0 0 100 100"],["x","0","y","0","width","70","height","5","rx","1"],["x","75","y","0","width","25","height","5","rx","1"],["x","0","y","10","width","100","height","8","rx","1"],["x","0","y","25","width","100","height","12","rx","1"]],template:function MyPageComponent_Template(e,t){1&e&&(o.j41(0,"div",0),o.DNE(1,MyPageComponent_div_1_Template,6,1,"div",1)(2,MyPageComponent_div_2_Template,6,3,"div",2)(3,MyPageComponent_div_3_Template,2,1,"div",3),o.k0s()),2&e&&(o.R7$(),o.Y8G("ngIf",t.showToolbar),o.R7$(),o.Y8G("ngIf",t.isTurboFrameSidebarEnabled()),o.R7$(),o.Y8G("ngIf",!t.isTurboFrameSidebarEnabled()))},dependencies:[P.bT,Yt.F,Xt.y,GridComponent],styles:[".op-grid-page--title-container{margin-left:20px;margin-bottom:-5px}.op-grid-page--toolbar-container{margin-bottom:0}.op-grid-page--toolbar-items{padding-right:20px}.op-grid-page--grid-container{display:grid;grid-template-columns:75% 25%;gap:20px}.op-grid-page--sidebar{margin-top:20px;margin-right:40px}@media only screen and (max-width: 543px){.op-grid-page--title-container{margin-left:0;margin-bottom:0}}@media only screen and (max-width: 1011px){.op-grid-page--grid-container{grid-template-columns:100%;gap:0}.op-grid-page--sidebar{display:none}}\n"],encapsulation:2})}}const Kt=[{name:"my_page",url:"/my/page",component:MyPageComponent,data:{bodyClasses:["router--work-packages-my-page","widget-grid-layout"],parent:"work-packages"}}];class OpenprojectMyPageModule{static{this.ɵfac=function OpenprojectMyPageModule_Factory(e){return new(e||OpenprojectMyPageModule)}}static{this.ɵmod=o.$C({type:OpenprojectMyPageModule})}static{this.ɵinj=o.G2t({imports:[d.d,OpenprojectGridsModule,k.p,nt.UIRouterModule.forChild({states:Kt})]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenprojectMyPageModule,{declarations:[MyPageComponent],imports:[d.d,OpenprojectGridsModule,k.p,nt.UIRouterModule]});var Jt=n(11856),Zt=n(87879),en=n(80559);const tn={preview:1,newWorkPackage:2,edit:3,quickSearch:4,projectSearch:5,help:6,moreMenu:7,details:8};class KeyboardShortcutService{constructor(e,t,n){this.PathHelper=e,this.FocusHelper=t,this.currentProject=n,this.shortcuts={"?":()=>this.showHelpModal(),"g m":this.globalAction("myPagePath"),"g o":this.projectScoped("projectPath"),"g w p":this.projectScoped("projectWorkPackagesPath"),"g w i":this.projectScoped("projectWikiPath"),"g a":this.projectScoped("projectActivityPath"),"g c":this.projectScoped("projectCalendarPath"),"g n":this.projectScoped("projectNewsPath"),"n w p":this.projectScoped("projectWorkPackageNewPath"),"g e":this.accessKey("edit"),"g p":this.accessKey("preview"),"d w p":this.accessKey("details"),m:this.accessKey("moreMenu"),p:this.accessKey("projectSearch"),s:this.accessKey("quickSearch"),k:()=>this.focusPrevItem(),j:()=>this.focusNextItem()},this.register()}register(){_.each(this.shortcuts,((e,t)=>en.bind(t,e)))}accessKey(e){const t=tn[e];return()=>{const e=jQuery(`[accesskey=${t}]:first`);e.is("input")||"global-search-input"===e.attr("id")?setTimeout((()=>this.FocusHelper.focus(e[0])),200):e.is("[href]")?this.clickLink(e[0]):e[0].click()}}globalAction(e){return()=>{window.location.href=this.PathHelper[e]()}}projectScoped(e){return()=>{const t=this.currentProject.identifier;t&&(window.location.href=this.PathHelper[e](t))}}clickLink(e){const t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});!e.dispatchEvent(t)||(window.location.href=e.href)}showHelpModal(){window.open(this.PathHelper.keyboardShortcutsHelpPath())}focusItemOffset(e){const t=document.querySelector("table.keyboard-accessible-list");if(!t)return;const n=Array.from(t.querySelectorAll("tbody > tr"));let i;if(document.activeElement){i=n.indexOf(document.activeElement);const t=n[i+e];t?.focus()}}focusNextItem(){this.focusItemOffset(1)}focusPrevItem(){this.focusItemOffset(-1)}static{this.ɵfac=function KeyboardShortcutService_Factory(e){return new(e||KeyboardShortcutService)(o.KVO(B.B),o.KVO(Zt.k),o.KVO(T.c))}}static{this.ɵprov=o.jDH({token:KeyboardShortcutService,factory:KeyboardShortcutService.ɵfac,providedIn:"root"})}}var nn=n(36777),on=n(77938),rn=n(50248),sn=n(44931),an=n(62223);const members_autocompleter_component_c0=(e,t,n)=>({$implicit:e,search:t,index:n}),members_autocompleter_component_c1=(e,t,n,i)=>({$implicit:e,search:t,index:n,clear:i}),members_autocompleter_component_c2=e=>({"padding-left.px":e});function MembersAutocompleterComponent_input_1_Template(e,t){if(1&e&&o.nrm(0,"input",10,3),2&e){const e=o.XpG();o.BMQ("name",e.inputName)("data-action",e.hiddenFieldAction)}}function MembersAutocompleterComponent_ng_container_2_input_1_Template(e,t){if(1&e&&o.nrm(0,"input",12),2&e){const e=t.$implicit,n=o.XpG(2);o.Y8G("value",e),o.BMQ("name",n.inputName+"[]")("data-action",n.hiddenFieldAction)}}function MembersAutocompleterComponent_ng_container_2_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,MembersAutocompleterComponent_ng_container_2_input_1_Template,1,3,"input",11),o.bVm()),2&e){const e=o.XpG();o.R7$(),o.Y8G("ngForOf",e.mappedInputValue)}}function MembersAutocompleterComponent_7_ng_template_0_Template(e,t){if(1&e&&o.eu8(0,14),2&e){const e=t.item,n=t.index,i=t.searchTerm,r=o.XpG(2);o.Y8G("ngTemplateOutlet",r.headerTemplate||r.projectedHeaderTemplate)("ngTemplateOutletContext",o.sMw(2,members_autocompleter_component_c0,e,i,n))}}function MembersAutocompleterComponent_7_Template(e,t){1&e&&o.DNE(0,MembersAutocompleterComponent_7_ng_template_0_Template,1,6,"ng-template",13)}function MembersAutocompleterComponent_8_ng_template_0_Template(e,t){if(1&e&&o.eu8(0,14),2&e){const e=t.item,n=t.index,i=t.searchTerm,r=t.clear,s=o.XpG(2),a=o.sdS(14);o.Y8G("ngTemplateOutlet",s.projectedLabelTemplate||s.labelTemplate||a)("ngTemplateOutletContext",o.ziG(2,members_autocompleter_component_c1,e,i,n,r))}}function MembersAutocompleterComponent_8_Template(e,t){1&e&&o.DNE(0,MembersAutocompleterComponent_8_ng_template_0_Template,1,7,"ng-template",15)}function MembersAutocompleterComponent_ng_template_9_Template(e,t){if(1&e&&o.eu8(0,14),2&e){const e=t.item,n=t.index,i=t.searchTerm,r=o.XpG(),s=o.sdS(12);o.Y8G("ngTemplateOutlet",r.projectedOptionTemplate||r.optionTemplate||s)("ngTemplateOutletContext",o.sMw(2,members_autocompleter_component_c0,e,i,n))}}function MembersAutocompleterComponent_10_ng_template_0_Template(e,t){if(1&e&&o.eu8(0,14),2&e){const e=t.item,n=t.index,i=t.searchTerm,r=o.XpG(2);o.Y8G("ngTemplateOutlet",r.footerTemplate||r.projectedFooterTemplate)("ngTemplateOutletContext",o.sMw(2,members_autocompleter_component_c0,e,i,n))}}function MembersAutocompleterComponent_10_Template(e,t){1&e&&o.DNE(0,MembersAutocompleterComponent_10_ng_template_0_Template,1,6,"ng-template",16)}function MembersAutocompleterComponent_ng_template_11_ng_container_0_Template(e,t){if(1&e&&(o.qex(0),o.nrm(1,"span",18),o.bVm()),2&e){const e=o.XpG(),t=e.$implicit,n=e.search;o.R7$(),o.Y8G("ngOptionHighlight",n)("textContent",t.name)("ngStyle",o.eq3(3,members_autocompleter_component_c2,16*t.depth))}}function MembersAutocompleterComponent_ng_template_11_ng_container_1_op_principal_2_Template(e,t){if(1&e&&o.nrm(0,"op-principal",28),2&e){const e=o.XpG(2).$implicit;o.Y8G("principal",e.author)("hideName",!0)}}function MembersAutocompleterComponent_ng_template_11_ng_container_1_span_4_Template(e,t){if(1&e&&o.nrm(0,"span",29),2&e){const e=o.XpG(2).$implicit,t=o.XpG();o.Mz_("textContent","",e.type.name," "),o.Y8G("ngClass",t.highlighting("type",e.type.id))}}function MembersAutocompleterComponent_ng_template_11_ng_container_1_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"div",19),o.DNE(2,MembersAutocompleterComponent_ng_template_11_ng_container_1_op_principal_2_Template,1,2,"op-principal",20),o.j41(3,"span",21),o.DNE(4,MembersAutocompleterComponent_ng_template_11_ng_container_1_span_4_Template,1,3,"span",22),o.nrm(5,"span",23),o.k0s(),o.j41(6,"div",24),o.nrm(7,"span",25),o.j41(8,"span",26),o.EFF(9),o.k0s(),o.nrm(10,"span",27),o.k0s()(),o.bVm()),2&e){const e=o.XpG(),t=e.$implicit,n=e.search,i=o.XpG();o.R7$(2),o.Y8G("ngIf",t.author&&t.author.href),o.R7$(2),o.Y8G("ngIf",t.type),o.R7$(),o.Y8G("ngOptionHighlight",n)("textContent",t.subject),o.R7$(2),o.Y8G("ngOptionHighlight",n)("textContent",null==t.project?null:t.project.name),o.R7$(),o.Y8G("ngOptionHighlight",n),o.R7$(),o.SpI("#",t.id,""),o.R7$(),o.Y8G("textContent",null==t.status?null:t.status.name)("ngClass",i.highlighting("status",null==t.status?null:t.status.id))}}function MembersAutocompleterComponent_ng_template_11_ng_container_2_op_principal_1_Template(e,t){if(1&e&&o.nrm(0,"op-principal",33),2&e){const e=o.XpG(2).$implicit;o.Y8G("principal",e)("hideName",!0)}}function MembersAutocompleterComponent_ng_template_11_ng_container_2_span_4_Template(e,t){if(1&e&&(o.j41(0,"span",34),o.EFF(1),o.k0s()),2&e){const e=o.XpG(2),t=e.$implicit,n=e.search;o.Y8G("ngOptionHighlight",n),o.R7$(),o.JRh(t.email)}}function MembersAutocompleterComponent_ng_template_11_ng_container_2_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,MembersAutocompleterComponent_ng_template_11_ng_container_2_op_principal_1_Template,1,2,"op-principal",30),o.j41(2,"span",31),o.EFF(3),o.k0s(),o.DNE(4,MembersAutocompleterComponent_ng_template_11_ng_container_2_span_4_Template,2,2,"span",32),o.bVm()),2&e){const e=o.XpG(),t=e.$implicit,n=e.search;o.R7$(),o.Y8G("ngIf",t&&t.href),o.R7$(),o.Y8G("ngOptionHighlight",n),o.R7$(),o.JRh(t.name),o.R7$(),o.Y8G("ngIf",t.email)}}function MembersAutocompleterComponent_ng_template_11_ng_container_3_span_3_Template(e,t){if(1&e&&(o.j41(0,"span",34),o.EFF(1),o.k0s()),2&e){const e=o.XpG(2),t=e.$implicit,n=e.search;o.Y8G("ngOptionHighlight",n),o.R7$(),o.JRh(t.email)}}function MembersAutocompleterComponent_ng_template_11_ng_container_3_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"span",31),o.EFF(2),o.k0s(),o.DNE(3,MembersAutocompleterComponent_ng_template_11_ng_container_3_span_3_Template,2,2,"span",32),o.bVm()),2&e){const e=o.XpG(),t=e.$implicit,n=e.search;o.R7$(),o.Y8G("ngOptionHighlight",n),o.R7$(),o.JRh(t.name),o.R7$(),o.Y8G("ngIf",t.email)}}function MembersAutocompleterComponent_ng_template_11_Template(e,t){if(1&e&&o.DNE(0,MembersAutocompleterComponent_ng_template_11_ng_container_0_Template,2,5,"ng-container",17)(1,MembersAutocompleterComponent_ng_template_11_ng_container_1_Template,11,10,"ng-container",17)(2,MembersAutocompleterComponent_ng_template_11_ng_container_2_Template,5,4,"ng-container",17)(3,MembersAutocompleterComponent_ng_template_11_ng_container_3_Template,4,3,"ng-container",17),2&e){const e=t.$implicit,n=o.XpG();o.Y8G("ngSwitchCase",!n.resource&&!!e.depth),o.R7$(),o.Y8G("ngSwitchCase","work_packages"===n.resource||"parent-child"===n.resource),o.R7$(),o.Y8G("ngSwitchCase","users"===n.resource||"assignee"===n.resource||"principals"===n.resource),o.R7$(),o.Y8G("ngSwitchCase","subproject"===n.resource||"version"===n.resource||"status"===n.resource||"default"===n.resource||!n.resource&&!e.depth)}}function MembersAutocompleterComponent_ng_template_13_ng_container_0_span_3_Template(e,t){if(1&e&&(o.j41(0,"span",37),o.EFF(1),o.k0s()),2&e){const e=o.XpG(2),t=e.$implicit,n=e.search;o.Y8G("ngOptionHighlight",n),o.R7$(),o.E5c(" ",null==t.type?null:t.type.name," #",t.id," ",t.subject||t.name," ")}}function MembersAutocompleterComponent_ng_template_13_ng_container_0_Template(e,t){if(1&e){const e=o.RV6();o.qex(0),o.j41(1,"span",35),o.bIt("click",(function MembersAutocompleterComponent_ng_template_13_ng_container_0_Template_span_click_1_listener(){o.eBV(e);const t=o.XpG(),n=t.$implicit,i=t.clear;return o.Njj(i(n))})),o.EFF(2,"×"),o.k0s(),o.DNE(3,MembersAutocompleterComponent_ng_template_13_ng_container_0_span_3_Template,2,4,"span",36),o.bVm()}if(2&e){const e=o.XpG().$implicit;o.R7$(3),o.Y8G("ngIf",e.id)}}function MembersAutocompleterComponent_ng_template_13_ng_container_1_Template(e,t){if(1&e){const e=o.RV6();o.qex(0),o.j41(1,"span",35),o.bIt("click",(function MembersAutocompleterComponent_ng_template_13_ng_container_1_Template_span_click_1_listener(){o.eBV(e);const t=o.XpG(),n=t.$implicit,i=t.clear;return o.Njj(i(n))})),o.EFF(2,"×"),o.k0s(),o.j41(3,"span",37),o.EFF(4),o.k0s(),o.bVm()}if(2&e){const e=o.XpG(),t=e.$implicit,n=e.search;o.R7$(3),o.Y8G("ngOptionHighlight",n),o.R7$(),o.JRh(t.name)}}function MembersAutocompleterComponent_ng_template_13_Template(e,t){if(1&e&&o.DNE(0,MembersAutocompleterComponent_ng_template_13_ng_container_0_Template,4,1,"ng-container",6)(1,MembersAutocompleterComponent_ng_template_13_ng_container_1_Template,5,2,"ng-container",6),2&e){const e=o.XpG();o.Y8G("ngIf","work_packages"===e.resource),o.R7$(),o.Y8G("ngIf","work_packages"!==e.resource)}}class MembersAutocompleterComponent extends on.P{getAvailableUsers(e){return this.http.get(this.url,{params:new s.Nl({encoder:new rn.Y,fromObject:{q:e}}),responseType:"json",headers:{"Content-Type":"application/json; charset=utf-8"}})}static{this.ɵfac=(()=>{let e;return function MembersAutocompleterComponent_Factory(t){return(e||(e=o.xGo(MembersAutocompleterComponent)))(t||MembersAutocompleterComponent)}})()}static{this.ɵcmp=o.VBU({type:MembersAutocompleterComponent,selectors:[["ng-component"]],features:[o.Vt3],decls:15,vars:59,consts:[["ngSelectInstance",""],["defaultOption",""],["defaultLabel",""],["syncedInput",""],[1,"inline-label"],["type","hidden",4,"ngIf"],[4,"ngIf"],[3,"ngModelChange","change","open","close","blur","focus","clear","keydown","keydown.escape","search","scroll","scrollToEnd","add","remove","ngModel","items","ngClass","typeahead","clearOnBackspace","clearSearchOnAdd","hideSelected","appendTo","multiple","loading","addTag","virtualScroll","required","clearable","closeOnSelect","openOnEnter","disabled","name","id","bindLabel","bindValue","markFirst","notFoundText","addTagText","loadingText","clearAllText","appearance","dropdownPosition","selectOnTab","maxSelectedItems","placeholder","groupBy","groupValue","bufferAmount","selectableGroup","searchable","selectableGroupAsModel","trackByFn","compareWith","searchFn","labelForId","inputAttrs","tabIndex","readonly","searchWhileComposing","minTermLength","editableSearchTerm","keyDownFn"],["ng-option-tmp",""],[3,"ngSwitch"],["type","hidden"],["type","hidden",3,"value",4,"ngFor","ngForOf"],["type","hidden",3,"value"],["ng-header-tmp",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["ng-label-tmp",""],["ng-footer-tmp",""],[4,"ngSwitchCase"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight","textContent","ngStyle"],[1,"op-autocompleter--option-wrapper"],["class","op-autocompleter--option-principal",3,"principal","hideName",4,"ngIf"],["data-test-selector","op-autocompleter-item-subject",1,"op-autocompleter--wp-subject"],[3,"ngClass","textContent",4,"ngIf"],[3,"ngOptionHighlight","textContent"],[1,"op-autocompleter--wp-content"],[1,"op-autocompleter--wp-project",3,"ngOptionHighlight","textContent"],[1,"op-autocompleter--wp-id",3,"ngOptionHighlight"],[1,"op-autocompleter--wp-status",3,"textContent","ngClass"],[1,"op-autocompleter--option-principal",3,"principal","hideName"],[3,"ngClass","textContent"],["class","op-autocompleter--option-principal-avatar","size","mini",3,"principal","hideName",4,"ngIf"],[3,"ngOptionHighlight"],["class","op-autocompleter__option-principal-email",3,"ngOptionHighlight",4,"ngIf"],["size","mini",1,"op-autocompleter--option-principal-avatar",3,"principal","hideName"],[1,"op-autocompleter__option-principal-email",3,"ngOptionHighlight"],[1,"ng-value-icon","left",3,"click"],["class","ng-value-label",3,"ngOptionHighlight",4,"ngIf"],[1,"ng-value-label",3,"ngOptionHighlight"]],template:function MembersAutocompleterComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",4),o.DNE(1,MembersAutocompleterComponent_input_1_Template,2,2,"input",5)(2,MembersAutocompleterComponent_ng_container_2_Template,2,1,"ng-container",6),o.j41(3,"ng-select",7,0),o.nI1(5,"async"),o.nI1(6,"async"),o.mxI("ngModelChange",(function MembersAutocompleterComponent_Template_ng_select_ngModelChange_3_listener(n){return o.eBV(e),o.DH7(t.model,n)||(t.model=n),o.Njj(n)})),o.bIt("change",(function MembersAutocompleterComponent_Template_ng_select_change_3_listener(n){return o.eBV(e),o.Njj(t.changed(n))}))("open",(function MembersAutocompleterComponent_Template_ng_select_open_3_listener(){return o.eBV(e),o.Njj(t.opened())}))("close",(function MembersAutocompleterComponent_Template_ng_select_close_3_listener(){return o.eBV(e),o.Njj(t.closed())}))("blur",(function MembersAutocompleterComponent_Template_ng_select_blur_3_listener(n){return o.eBV(e),o.Njj(t.blured(n))}))("focus",(function MembersAutocompleterComponent_Template_ng_select_focus_3_listener(n){return o.eBV(e),o.Njj(t.focused(n))}))("clear",(function MembersAutocompleterComponent_Template_ng_select_clear_3_listener(n){return o.eBV(e),o.Njj(t.cleared(n))}))("keydown",(function MembersAutocompleterComponent_Template_ng_select_keydown_3_listener(n){return o.eBV(e),o.Njj(t.keydowned(n))}))("keydown.escape",(function MembersAutocompleterComponent_Template_ng_select_keydown_escape_3_listener(n){return o.eBV(e),o.Njj(t.canceled(n))}))("search",(function MembersAutocompleterComponent_Template_ng_select_search_3_listener(n){return o.eBV(e),o.Njj(t.searched(n))}))("scroll",(function MembersAutocompleterComponent_Template_ng_select_scroll_3_listener(n){return o.eBV(e),o.Njj(t.scrolled(n))}))("scrollToEnd",(function MembersAutocompleterComponent_Template_ng_select_scrollToEnd_3_listener(n){return o.eBV(e),o.Njj(t.scrolledToEnd(n))}))("add",(function MembersAutocompleterComponent_Template_ng_select_add_3_listener(n){return o.eBV(e),o.Njj(t.added(n))}))("remove",(function MembersAutocompleterComponent_Template_ng_select_remove_3_listener(n){return o.eBV(e),o.Njj(t.removed(n))})),o.DNE(7,MembersAutocompleterComponent_7_Template,1,0,null,6)(8,MembersAutocompleterComponent_8_Template,1,0,null,6)(9,MembersAutocompleterComponent_ng_template_9_Template,1,6,"ng-template",8)(10,MembersAutocompleterComponent_10_Template,1,0,null,6),o.k0s()(),o.DNE(11,MembersAutocompleterComponent_ng_template_11_Template,4,4,"ng-template",9,1,o.C5r)(13,MembersAutocompleterComponent_ng_template_13_Template,2,2,"ng-template",null,2,o.C5r)}2&e&&(o.R7$(),o.Y8G("ngIf",t.inputName&&!(t.multiple&&t.multipleAsSeparateInputs)),o.R7$(),o.Y8G("ngIf",t.multiple&&t.multipleAsSeparateInputs),o.R7$(),o.R50("ngModel",t.model),o.Y8G("items",o.bMT(5,55,t.results$))("ngClass",t.classes)("typeahead",t.typeahead)("clearOnBackspace",t.clearOnBackspace)("clearSearchOnAdd",t.clearSearchOnAdd)("hideSelected",t.hideSelected)("appendTo",t.appendTo)("multiple",t.multiple)("loading",o.bMT(6,57,t.loading$))("addTag",t.addTag)("virtualScroll",t.virtualScroll)("required",t.required)("clearable",t.clearable)("closeOnSelect",t.closeOnSelect)("openOnEnter",t.openOnEnter)("disabled",t.disabled)("name",t.name)("id",t.id)("bindLabel",t.bindLabel)("bindValue",t.bindValue)("markFirst",t.markFirst)("notFoundText",t.notFoundText)("addTagText",t.addTagText)("loadingText",t.loadingText)("clearAllText",t.clearAllText)("appearance",t.appearance)("dropdownPosition",t.dropdownPosition)("selectOnTab",t.selectOnTab)("maxSelectedItems",t.maxSelectedItems)("placeholder",t.placeholder)("groupBy",t.groupBy)("groupValue",t.groupValue)("bufferAmount",t.bufferAmount)("selectableGroup",t.selectableGroup)("searchable",t.searchable)("selectableGroupAsModel",t.selectableGroupAsModel)("trackByFn",t.trackByFn)("compareWith",t.compareWith)("searchFn",t.searchFn)("labelForId",t.labelForId)("inputAttrs",t.inputAttrs)("tabIndex",t.tabIndex)("readonly",t.readonly)("searchWhileComposing",t.searchWhileComposing)("minTermLength",t.minTermLength)("editableSearchTerm",t.editableSearchTerm)("keyDownFn",t.keyDownFn),o.BMQ("accesskey",t.accesskey||void 0),o.R7$(4),o.Y8G("ngIf",t.headerTemplate||t.projectedHeaderTemplate),o.R7$(),o.Y8G("ngIf",t.labelRequired),o.R7$(2),o.Y8G("ngIf",t.footerTemplate||t.projectedFooterTemplate),o.R7$(),o.Y8G("ngSwitch",!0))},dependencies:[P.YU,P.Sq,P.bT,P.T3,P.B3,P.ux,P.e1,a.BC,a.YS,a.vS,sn.G,ke.f,an.vr,an.Uq,an.ZZ,an.Uc,an.q8,P.Jj],encapsulation:2})}}(0,U.Cg)([(0,Q.O)(),(0,U.Sn)("design:type",B.B)],MembersAutocompleterComponent.prototype,"pathHelper",void 0);class OpenprojectMembersModule{static{this.ɵfac=function OpenprojectMembersModule_Factory(e){return new(e||OpenprojectMembersModule)}}static{this.ɵmod=o.$C({type:OpenprojectMembersModule})}static{this.ɵinj=o.G2t({imports:[d.d,a.YN,an.MQ]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenprojectMembersModule,{declarations:[MembersAutocompleterComponent],imports:[d.d,a.YN,an.MQ]});var ln=n(80481);class OpenprojectAugmentingModule{constructor(e){e.setupListener(),document.addEventListener("turbo:load",(()=>{e.setupListener()}))}static{this.ɵfac=function OpenprojectAugmentingModule_Factory(e){return new(e||OpenprojectAugmentingModule)(o.KVO(ln.A))}}static{this.ɵmod=o.$C({type:OpenprojectAugmentingModule})}static{this.ɵinj=o.G2t({imports:[k.p]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenprojectAugmentingModule,{imports:[k.p]});var cn=n(69940),pn=n(1845),dn=n(98637),un=n(54767),hn=n(8790);class OpInviteUserModalAugmentService{constructor(e,t,n){this.documentElement=e,this.opModalService=t,this.currentProjectService=n}setupListener(){const e=this.documentElement.querySelectorAll("[invite-user-modal-augment]");for(let t=0;t<e.length;++t){e[t].addEventListener("click",this.spawnModal.bind(this))}}spawnModal(e){e.preventDefault(),this.opModalService.show(hn.X,"global",{projectId:this.currentProjectService.id}).subscribe((e=>e.closingEvent.subscribe((e=>{e.data&&window.location.reload()}))))}static{this.ɵfac=function OpInviteUserModalAugmentService_Factory(e){return new(e||OpInviteUserModalAugmentService)(o.KVO(P.qQ),o.KVO(Y.a),o.KVO(T.c))}}static{this.ɵprov=o.jDH({token:OpInviteUserModalAugmentService,factory:OpInviteUserModalAugmentService.ɵfac,providedIn:"root"})}}var mn=n(54182),gn=n(10267),_n=n(61318);var fn=n(51196),bn=n(88294),kn=n(13469);function ProjectSelectionComponent_div_7_Template(e,t){if(1&e&&(o.j41(0,"div",14),o.EFF(1),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.SpI(" ",e.text.project.lackingPermissionInfo," ")}}function ProjectSelectionComponent_div_8_Template(e,t){if(1&e&&(o.j41(0,"div",15),o.EFF(1),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.SpI(" ",e.text.project.required," ")}}function ProjectSelectionComponent_div_9_Template(e,t){if(1&e&&(o.j41(0,"div",15),o.EFF(1),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.SpI(" ",e.text.project.lackingPermission," ")}}function ProjectSelectionComponent_div_12_Template(e,t){if(1&e&&(o.j41(0,"div",16)(1,"div",17),o.EFF(2),o.k0s()()),2&e){const e=o.XpG();o.R7$(2),o.SpI(" ",e.text.type.required," ")}}class ProjectSelectionComponent{get typeControl(){return this.projectAndTypeForm.get("type")}get projectControl(){return this.projectAndTypeForm.get("project")}constructor(e,t,n,i,r,s){var l;this.I18n=e,this.elementRef=t,this.bannersService=n,this.apiV3Service=i,this.currentUserService=r,this.cdRef=s,this.close=new o.bkB,this.save=new o.bkB,this.text={title:this.I18n.t("js.invite_user_modal.title.invite"),project:{label:this.I18n.t("js.invite_user_modal.project.label"),required:this.I18n.t("js.invite_user_modal.project.required"),lackingPermission:this.I18n.t("js.invite_user_modal.project.lacking_permission"),lackingPermissionInfo:this.I18n.t("js.invite_user_modal.project.lacking_permission_info"),noInviteRights:this.I18n.t("js.invite_user_modal.project.no_invite_rights")},type:{required:this.I18n.t("js.invite_user_modal.type.required")},nextButton:this.I18n.t("js.invite_user_modal.project.next_button"),cancelButton:this.I18n.t("js.button_cancel")},this.typeOptions=[{value:hn.J.User,title:this.I18n.t("js.invite_user_modal.type.user.title"),description:this.I18n.t("js.invite_user_modal.type.user.description")},{value:hn.J.Group,title:this.I18n.t("js.invite_user_modal.type.group.title"),description:this.I18n.t("js.invite_user_modal.type.group.description")}],this.projectAndTypeForm=new a.J3({type:new a.hs(hn.J.User,[a.k0.required]),project:new a.hs(null,[a.k0.required],(l=this.currentUserService,e=>{const t=e.value?.href||e.value?.$links?.self.href,n=t?(0,be.A)(t):e.value;return l.hasCapabilities$("memberships/create",n).pipe((0,ne.s)(1),(0,G.T)((e=>e?null:{lackingPermission:!0})),(0,_n.W)((()=>(0,je.of)(null))))}))}),this.projectInviteCapabilities=[],this.APIFiltersForProjects=[{name:"active",operator:"=",values:["t"]}]}ngOnInit(){this.typeControl.setValue(this.type),this.project&&this.projectControl.setValue((0,gn.P_)(this.project)),this.setPlaceholderOption(),this.currentUserService.capabilities$(["memberships/create"],null).pipe((0,G.T)((e=>e.filter((e=>e._links.action.href.endsWith("/memberships/create")))))).subscribe((e=>{this.projectInviteCapabilities=e,this.cdRef.detectChanges()}))}setPlaceholderOption(){this.bannersService.eeShowBanners?this.typeOptions.push({value:hn.J.Placeholder,title:this.I18n.t("js.invite_user_modal.type.placeholder.title_no_ee"),description:this.I18n.t("js.invite_user_modal.type.placeholder.description_no_ee",{eeHref:this.bannersService.getEnterPriseEditionUrl({referrer:"placeholder-users",hash:"placeholder-users"})}),disabled:!0}):this.typeOptions.push({value:hn.J.Placeholder,title:this.I18n.t("js.invite_user_modal.type.placeholder.title"),description:this.I18n.t("js.invite_user_modal.type.placeholder.description"),disabled:!1})}onSubmit(e){var t=this;return(0,x.A)((function*(){if(e.preventDefault(),t.projectAndTypeForm.invalid)return void t.projectAndTypeForm.markAsDirty();const n=(0,be.A)(t.projectControl?.value?.href),i=yield(0,M._)(t.apiV3Service.projects.id(n).get());t.save.emit({project:i,type:t.typeControl.value})}))()}projectFilterFn(e){const t=e.map((e=>{const t=!this.projectInviteCapabilities.find((t=>(0,be.A)(t._links.context.href)===e.id.toString()));return{...e,disabled:t,disabledReason:t?this.text.project.noInviteRights:""}}));return t.sort(((e,t)=>(e.disabled?1:0)-(t.disabled?1:0))),t}static{this.ɵfac=function ProjectSelectionComponent_Factory(e){return new(e||ProjectSelectionComponent)(o.rXU(w.W),o.rXU(o.aKT),o.rXU(ee.b),o.rXU(O.n),o.rXU(S.K),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:ProjectSelectionComponent,selectors:[["op-ium-project-selection"]],inputs:{type:"type",project:"project"},outputs:{close:"close",save:"save"},decls:17,vars:12,consts:[[1,"spot-modal",3,"ngSubmit","formGroup"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"spot-modal--body","spot-container"],["required","",3,"label"],["slot","input","formControlName","project","appendTo",".spot-modal-overlay",3,"filters","mapResultsFn"],["slot","action",4,"ngIf"],["slot","errors","class","spot-form-field--error",4,"ngIf"],["formControlName","type","slot","input",3,"options"],["class","spot-form-field--errors","slot","errors",4,"ngIf"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button",1,"button","spot-action-bar--action","spot-modal--cancel-button",3,"click","textContent"],["type","submit",1,"button","-primary","spot-action-bar--action",3,"textContent"],["slot","action"],["slot","errors",1,"spot-form-field--error"],["slot","errors",1,"spot-form-field--errors"],[1,"spot-form-field--error"]],template:function ProjectSelectionComponent_Template(e,t){1&e&&(o.j41(0,"form",0),o.bIt("ngSubmit",(function ProjectSelectionComponent_Template_form_ngSubmit_0_listener(e){return t.onSubmit(e)})),o.j41(1,"div",1),o.EFF(2),o.k0s(),o.nrm(3,"div",2),o.j41(4,"div",3)(5,"spot-form-field",4),o.nrm(6,"op-project-autocompleter",5),o.DNE(7,ProjectSelectionComponent_div_7_Template,2,1,"div",6)(8,ProjectSelectionComponent_div_8_Template,2,1,"div",7)(9,ProjectSelectionComponent_div_9_Template,2,1,"div",7),o.k0s(),o.j41(10,"spot-form-field"),o.nrm(11,"op-option-list",8),o.DNE(12,ProjectSelectionComponent_div_12_Template,3,1,"div",9),o.k0s()(),o.j41(13,"div",10)(14,"div",11)(15,"button",12),o.bIt("click",(function ProjectSelectionComponent_Template_button_click_15_listener(){return t.close.emit()})),o.k0s(),o.nrm(16,"button",13),o.k0s()()()),2&e&&(o.Y8G("formGroup",t.projectAndTypeForm),o.R7$(2),o.JRh(t.text.title),o.R7$(3),o.Y8G("label",t.text.project.label),o.R7$(),o.Y8G("filters",t.APIFiltersForProjects)("mapResultsFn",t.projectFilterFn.bind(t)),o.R7$(),o.Y8G("ngIf",null==t.projectControl.errors?null:t.projectControl.errors.lackingPermission),o.R7$(),o.Y8G("ngIf",null==t.projectControl.errors?null:t.projectControl.errors.required),o.R7$(),o.Y8G("ngIf",null==t.projectControl.errors?null:t.projectControl.errors.lackingPermission),o.R7$(2),o.Y8G("options",t.typeOptions),o.R7$(),o.Y8G("ngIf",(null==t.projectAndTypeForm?null:t.projectAndTypeForm.dirty)&&(null==t.typeControl?null:t.typeControl.invalid)),o.R7$(3),o.Y8G("textContent",t.text.cancelButton),o.R7$(),o.Y8G("textContent",t.text.nextButton))},dependencies:[P.bT,a.qT,a.BC,a.cb,fn.j,bn.U,kn.S,a.j4,a.JD],encapsulation:2,changeDetection:0})}}var vn=n(46874),Cn=(n(86198),n(74803),n(40169)),yn=n(61873),wn=n(71870),Tn=n(86301),Sn=n(51280);function PrincipalSearchComponent_ng_template_3_Template(e,t){if(1&e&&o.EFF(0),2&e){const e=t.item;o.SpI(" ",(null==e.principal?null:e.principal.name)||e.name," ")}}function PrincipalSearchComponent_ng_template_4_div_0_span_3_Template(e,t){if(1&e&&(o.j41(0,"span",11),o.EFF(1),o.k0s()),2&e){const e=o.XpG(2),t=e.item,n=e.searchTerm;o.Y8G("ngOptionHighlight",n),o.R7$(),o.JRh(t.principal.email)}}function PrincipalSearchComponent_ng_template_4_div_0_div_4_Template(e,t){if(1&e&&(o.j41(0,"div",12),o.EFF(1),o.k0s()),2&e){const e=o.XpG(3);o.R7$(),o.JRh(e.text.alreadyAMember())}}function PrincipalSearchComponent_ng_template_4_div_0_Template(e,t){if(1&e&&(o.j41(0,"div",7)(1,"span",8),o.EFF(2),o.k0s(),o.DNE(3,PrincipalSearchComponent_ng_template_4_div_0_span_3_Template,2,2,"span",9)(4,PrincipalSearchComponent_ng_template_4_div_0_div_4_Template,2,1,"div",10),o.k0s()),2&e){const e=o.XpG(),t=e.item,n=e.searchTerm;o.R7$(),o.Y8G("ngOptionHighlight",n),o.R7$(),o.JRh(t.principal.name),o.R7$(),o.Y8G("ngIf",t.principal.email),o.R7$(),o.Y8G("ngIf",t.disabled)}}function PrincipalSearchComponent_ng_template_4_Template(e,t){if(1&e&&o.DNE(0,PrincipalSearchComponent_ng_template_4_div_0_Template,5,4,"div",6),2&e){const e=t.item;o.Y8G("ngIf",e)}}function PrincipalSearchComponent_ng_template_5_Template(e,t){if(1&e&&(o.j41(0,"div",13),o.EFF(1),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.SpI(" ",e.text.noResults[e.type]," ")}}function PrincipalSearchComponent_ng_template_6_div_0_Template(e,t){if(1&e&&(o.j41(0,"div"),o.nrm(1,"op-icon",15),o.j41(2,"b"),o.EFF(3),o.k0s(),o.EFF(4),o.k0s()),2&e){const e=o.XpG(2);o.R7$(3),o.JRh(e.text.inviteNewUser),o.R7$(),o.SpI(" ",e.input," ")}}function PrincipalSearchComponent_ng_template_6_div_2_Template(e,t){if(1&e&&(o.j41(0,"div"),o.nrm(1,"op-icon",16),o.j41(2,"b"),o.EFF(3),o.k0s(),o.EFF(4),o.k0s()),2&e){const e=o.XpG(2);o.R7$(3),o.JRh(e.text.createNewPlaceholder),o.R7$(),o.SpI(" ",e.input," ")}}function PrincipalSearchComponent_ng_template_6_Template(e,t){if(1&e&&(o.DNE(0,PrincipalSearchComponent_ng_template_6_div_0_Template,5,2,"div",14),o.nI1(1,"async"),o.DNE(2,PrincipalSearchComponent_ng_template_6_div_2_Template,5,2,"div",14),o.nI1(3,"async")),2&e){const e=o.XpG();o.Y8G("ngIf",o.bMT(1,2,e.canInviteByEmail$)),o.R7$(2),o.Y8G("ngIf",o.bMT(3,4,e.canCreateNewPlaceholder$))}}class PrincipalSearchComponent extends $t.p{constructor(e,t,n,i,r){super(),this.I18n=e,this.elementRef=t,this.apiV3Service=n,this.currentUserService=i,this.capabilitiesService=r,this.createNew=new o.bkB,this.input$=new F.t(""),this.input="",this.items$=this.input$.pipe(this.untilDestroyed(),(0,At.B)(200),(0,J.F)(),(0,ae.n)(this.loadPrincipalData.bind(this)),(0,wn.u)()),this.emailRegExp=/^\S+@\S+\.\S+$/,this.canInviteByEmail$=(0,Vt.z)(this.items$,this.input$,this.currentUserService.hasCapabilities$("users/create","global")).pipe((0,G.T)((([e,t,n])=>n&&this.type===hn.J.User&&!!t&&this.emailRegExp.test(t)&&!e.find((e=>e.principal.email===t))))),this.canCreateNewPlaceholder$=(0,Vt.z)([this.items$,this.input$,this.currentUserService.hasCapabilities$("placeholder_users/create","global")]).pipe((0,G.T)((([e,t,n])=>!!n&&(this.type===hn.J.Placeholder&&(!!t&&!e.find((e=>e.name===t))))))),this.showAddTag=!1,this.text={alreadyAMember:()=>this.I18n.t("js.invite_user_modal.principal.already_member_message",{project:this.project?.name}),inviteNewUser:this.I18n.t("js.invite_user_modal.principal.invite_user"),createNewPlaceholder:this.I18n.t("js.invite_user_modal.principal.create_new_placeholder"),noResults:{User:this.I18n.t("js.invite_user_modal.principal.no_results_user"),PlaceholderUser:this.I18n.t("js.invite_user_modal.principal.no_results_placeholder"),Group:this.I18n.t("js.invite_user_modal.principal.no_results_group")}},this.compareWith=(e,t)=>e.principal.id===t.id,this.input$.subscribe((e=>{this.input=e})),(0,Vt.z)(this.canInviteByEmail$,this.canCreateNewPlaceholder$).pipe((0,G.T)((([e,t])=>e||t))).subscribe((e=>{this.showAddTag=e}))}ngOnInit(){setTimeout((()=>this.input$.next("")))}createNewFromInput(){this.createNew.emit({name:this.input})}loadPrincipalData(e){const t=new Je.hG;e&&t.add("any_name_attribute","~",[e]),t.add("status","!",[3]),t.add("type","=",[this.type]),t.add("member","!",[this.project?.id||""]);const n=this.apiV3Service.principals.filtered(t).get(),i=new Je.hG;e&&i.add("any_name_attribute","~",[e]),i.add("status","!",[3]),i.add("type","=",[this.type]),i.add("member","=",[this.project?.id||""]);const o=this.apiV3Service.principals.filtered(i).get();return(0,yn.p)({members:o,nonMembers:n}).pipe((0,G.T)((({members:e,nonMembers:t})=>[...t.elements.map((e=>({principal:e,disabled:!1}))),...e.elements.map((e=>({principal:e,disabled:!0})))].slice(0,5))),(0,Tn.t)(1))}static{this.ɵfac=function PrincipalSearchComponent_Factory(e){return new(e||PrincipalSearchComponent)(o.rXU(w.W),o.rXU(o.aKT),o.rXU(O.n),o.rXU(S.K),o.rXU(Sn.W))}}static{this.ɵcmp=o.VBU({type:PrincipalSearchComponent,selectors:[["op-ium-principal-search"]],inputs:{spotFormBinding:"spotFormBinding",type:"type",project:"project"},outputs:{createNew:"createNew"},features:[o.Vt3],decls:7,vars:10,consts:[["ngselect",""],["appendTo",".spot-modal-overlay","bindValue","principal",3,"formControl","addTag","typeahead","items","clearable","clearOnBackspace","clearSearchOnAdd","compareWith"],["ng-label-tmp",""],["ng-option-tmp",""],["ng-notfound-tmp",""],["ng-tag-tmp",""],["class","ng-option-label",4,"ngIf"],[1,"ng-option-label"],[3,"ngOptionHighlight"],["class","op-autocompleter__option-principal-email",3,"ngOptionHighlight",4,"ngIf"],["class","ellipsis",4,"ngIf"],[1,"op-autocompleter__option-principal-email",3,"ngOptionHighlight"],[1,"ellipsis"],[1,"ng-option","disabled"],[4,"ngIf"],["icon-classes","icon-mail1 icon-context"],["icon-classes","icon-add icon-context"]],template:function PrincipalSearchComponent_Template(e,t){1&e&&(o.j41(0,"ng-select",1,0),o.nI1(2,"async"),o.DNE(3,PrincipalSearchComponent_ng_template_3_Template,1,1,"ng-template",2)(4,PrincipalSearchComponent_ng_template_4_Template,1,1,"ng-template",3)(5,PrincipalSearchComponent_ng_template_5_Template,2,1,"ng-template",4)(6,PrincipalSearchComponent_ng_template_6_Template,4,6,"ng-template",5),o.k0s()),2&e&&o.Y8G("formControl",t.spotFormBinding)("addTag",!!t.showAddTag&&t.createNewFromInput.bind(t))("typeahead",t.input$)("items",o.bMT(2,8,t.items$))("clearable",!0)("clearOnBackspace",!1)("clearSearchOnAdd",!1)("compareWith",t.compareWith)},dependencies:[P.bT,a.BC,Le.i,sn.G,an.vr,an.Uq,an.ZZ,an.y2,an.BW,a.l_,P.Jj],styles:[".op-autocompleter__option-principal-email[_ngcontent-%COMP%]{color:var(--fgColor-muted);font-size:var(--font-size-small);margin-left:var(--stack-gap-condensed)}@media screen and (max-width: 543px){.op-autocompleter__option-principal-email[_ngcontent-%COMP%]{display:block;margin-left:0;margin-top:var(--control-xsmall-gap)}}"],changeDetection:0})}}var jn=n(84205);function RoleSearchComponent_ng_template_3_Template(e,t){if(1&e&&(o.j41(0,"div",4),o.EFF(1),o.k0s()),2&e){const e=t.item,n=t.searchTerm;o.Y8G("ngOptionHighlight",n),o.R7$(),o.JRh(e.name)}}function RoleSearchComponent_ng_template_4_Template(e,t){if(1&e&&(o.j41(0,"div",5),o.EFF(1),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.SpI(" ",e.text.noRolesFound," ")}}class RoleSearchComponent extends $t.p{constructor(e,t,n){super(),this.I18n=e,this.elementRef=t,this.apiV3Service=n,this.input$=new jn.B,this.roles$=new jn.B,this.text={noRolesFound:this.I18n.t("js.invite_user_modal.role.no_roles_found")},this.items$=(0,Vt.z)(this.input$.pipe(this.untilDestroyed(),(0,At.B)(200),(0,Z.p)((e=>"string"==typeof e)),(0,G.T)((e=>e.toLowerCase())),(0,J.F)()),this.roles$).pipe((0,G.T)((([e,t])=>t.filter((t=>!e||-1!==t.name.toLowerCase().indexOf(e))))))}ngOnInit(){const e=new Je.hG;e.add("grantable","=",!0),e.add("unit","=",["project"]),this.apiV3Service.roles.filtered(e).get().subscribe((({elements:e})=>this.roles$.next(e))),setTimeout((()=>this.input$.next("")))}static{this.ɵfac=function RoleSearchComponent_Factory(e){return new(e||RoleSearchComponent)(o.rXU(w.W),o.rXU(o.aKT),o.rXU(O.n))}}static{this.ɵcmp=o.VBU({type:RoleSearchComponent,selectors:[["op-ium-role-search"]],inputs:{spotFormBinding:"spotFormBinding"},features:[o.Vt3],decls:5,vars:9,consts:[["ngselect",""],["appendTo",".spot-modal-overlay","bindLabel","name",3,"formControl","typeahead","items","virtualScroll","clearable","clearOnBackspace","clearSearchOnAdd"],["ng-option-tmp",""],["ng-notfound-tmp",""],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight"],[1,"ng-option","disabled"]],template:function RoleSearchComponent_Template(e,t){1&e&&(o.j41(0,"ng-select",1,0),o.nI1(2,"async"),o.DNE(3,RoleSearchComponent_ng_template_3_Template,2,2,"ng-template",2)(4,RoleSearchComponent_ng_template_4_Template,2,1,"ng-template",3),o.k0s()),2&e&&o.Y8G("formControl",t.spotFormBinding)("typeahead",t.input$)("items",o.bMT(2,7,t.items$))("virtualScroll",!0)("clearable",!0)("clearOnBackspace",!1)("clearSearchOnAdd",!1)},dependencies:[a.BC,sn.G,an.vr,an.Uq,an.y2,a.l_,P.Jj],encapsulation:2})}}function PrincipalComponent_op_ium_principal_search_6_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"op-ium-principal-search",20),o.bIt("createNew",(function PrincipalComponent_op_ium_principal_search_6_Template_op_ium_principal_search_createNew_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.createNewFromInput(t))})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("spotFormBinding",e.principalControl)("type",e.type)("project",e.project)}}function PrincipalComponent_p_7_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"p",21)(1,"b"),o.EFF(2),o.k0s(),o.EFF(3),o.j41(4,"button",22),o.bIt("click",(function PrincipalComponent_p_7_Template_button_click_4_listener(){o.eBV(e);const t=o.XpG();return o.Njj(null==t.principalControl?null:t.principalControl.setValue(null))})),o.EFF(5),o.k0s()()}if(2&e){const e=o.XpG();o.R7$(2),o.JRh(e.text.principal.inviteUser),o.R7$(),o.SpI(" ",e.principal.name," "),o.R7$(2),o.JRh(e.text.principal.change)}}function PrincipalComponent_p_8_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"p",21)(1,"b"),o.EFF(2),o.k0s(),o.EFF(3),o.j41(4,"button",22),o.bIt("click",(function PrincipalComponent_p_8_Template_button_click_4_listener(){o.eBV(e);const t=o.XpG();return o.Njj(null==t.principalControl?null:t.principalControl.setValue(null))})),o.EFF(5),o.k0s()()}if(2&e){const e=o.XpG();o.R7$(2),o.JRh(e.text.principal.createNewPlaceholder),o.R7$(),o.SpI(" ",e.principal.name," "),o.R7$(2),o.JRh(e.text.principal.change)}}function PrincipalComponent_div_9_Template(e,t){if(1&e&&(o.j41(0,"div",23),o.EFF(1),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.SpI(" ",e.text.principal.required[e.type]," ")}}function PrincipalComponent_op_dynamic_form_10_Template(e,t){if(1&e&&o.nrm(0,"op-dynamic-form",24),2&e){const e=o.XpG();o.Y8G("dynamicFormGroup",e.dynamicFieldsControl)("settings",e.userDynamicFieldConfig)("formUrl",e.apiV3Service.users.form.path)("handleSubmit",!1)}}function PrincipalComponent_div_14_Template(e,t){if(1&e&&(o.j41(0,"div",23),o.EFF(1),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.SpI(" ",e.text.role.required," ")}}function PrincipalComponent_spot_form_field_15_Template(e,t){if(1&e&&(o.j41(0,"spot-form-field",25)(1,"textarea",26,0),o.EFF(3,"      "),o.k0s(),o.nrm(4,"p",11),o.k0s()),2&e){const e=o.XpG();o.Y8G("label",e.text.message.label),o.R7$(),o.Y8G("formControl",e.messageControl),o.R7$(3),o.Y8G("innerHtml",e.text.message.description(),o.npT)}}class PrincipalComponent{get messageControl(){return this.principalForm.get("message")}get roleControl(){return this.principalForm.get("role")}get principalControl(){return this.principalForm.get("principal")}get principal(){return this.principalControl?.value}get role(){return this.roleControl?.value}get message(){return this.messageControl?.value}get dynamicFieldsControl(){return this.principalForm.get("userDynamicFields")}get customFields(){return this.dynamicFieldsControl?.value}get hasPrincipalSelected(){return!!this.principal}get textLabel(){return this.type===hn.J.User&&this.isNewPrincipal?this.text.principal.label.Email:this.text.principal.label[this.type]}get isNewPrincipal(){return this.hasPrincipalSelected&&!(this.principal instanceof Ft.q)}get isMemberOfCurrentProject(){return!!this.principalControl?.value?.memberships?.elements?.find((e=>e.project.id===this.project.id))}constructor(e,t,n,i){this.I18n=e,this.httpClient=t,this.apiV3Service=n,this.cdRef=i,this.messageData="",this.close=new o.bkB,this.save=new o.bkB,this.back=new o.bkB,this.PrincipalType=hn.J,this.text={principal:{title:()=>this.I18n.t("js.invite_user_modal.title.invite"),label:{User:this.I18n.t("js.invite_user_modal.principal.label.name_or_email"),PlaceholderUser:this.I18n.t("js.invite_user_modal.principal.label.name"),Group:this.I18n.t("js.invite_user_modal.principal.label.name"),Email:this.I18n.t("js.label_email")},change:this.I18n.t("js.label_change"),inviteUser:this.I18n.t("js.invite_user_modal.principal.invite_user"),createNewPlaceholder:this.I18n.t("js.invite_user_modal.principal.create_new_placeholder"),required:{User:this.I18n.t("js.invite_user_modal.principal.required.user"),PlaceholderUser:this.I18n.t("js.invite_user_modal.principal.required.placeholder"),Group:this.I18n.t("js.invite_user_modal.principal.required.group")},backButton:this.I18n.t("js.invite_user_modal.back"),nextButton:this.I18n.t("js.invite_user_modal.principal.next_button"),cancelButton:this.I18n.t("js.button_cancel")},role:{label:()=>this.I18n.t("js.invite_user_modal.role.label",{project:this.project?.name}),description:()=>this.I18n.t("js.invite_user_modal.role.description",{principal:this.principal?.name}),required:this.I18n.t("js.invite_user_modal.role.required")},message:{label:this.I18n.t("js.invite_user_modal.message.label"),description:()=>this.I18n.t("js.invite_user_modal.message.description",{principal:this.principal?.name})}},this.principalForm=new a.J3({principal:new a.hs(null,[a.k0.required]),userDynamicFields:new a.J3({}),role:new a.hs(null,[a.k0.required]),message:new a.hs("")}),this.userDynamicFieldConfig={payload:null,schema:null}}ngOnInit(){if(this.principalControl?.setValue(this.principalData.principal),this.roleControl?.setValue(this.roleData),this.messageControl?.setValue(this.messageData),this.type===hn.J.User){const e=this.isNewPrincipal?this.principalData.customFields:{};this.apiV3Service.users.form.post(e).pipe((0,ne.s)(1),(0,G.T)((e=>e.$source))).subscribe((e=>{this.userDynamicFieldConfig.schema=function extractCustomFieldsFromSchema(e){return Object.keys(e).reduce(((t,n)=>n.startsWith("customField")&&e[n].required?{...t,[n]:e[n]}:t),{})}(e._embedded?.schema),this.userDynamicFieldConfig.payload=e._embedded?.payload,this.cdRef.detectChanges()}))}}createNewFromInput(e){this.principalControl?.setValue(e)}onSubmit(e){e.preventDefault(),this.dynamicForm?this.dynamicForm.validateForm().subscribe((()=>{this.onValidatedSubmit()})):this.onValidatedSubmit()}onValidatedSubmit(){if(this.principalForm.invalid)return;const e=this.userDynamicFieldConfig.schema||{},t=Object.keys(e).reduce(((t,n)=>{const i=e[n];let o=this.customFields[n];return"_links"===i.location&&o&&(o=Array.isArray(o)?o.map((e=>e._links?e._links.self:e)):o._links?o._links.self:o),t={...t,[n]:o}}),{});this.save.emit({principalData:{customFields:t,principal:this.principal},isAlreadyMember:this.isMemberOfCurrentProject,role:this.role,message:this.message})}static{this.ɵfac=function PrincipalComponent_Factory(e){return new(e||PrincipalComponent)(o.rXU(w.W),o.rXU(s.Qq),o.rXU(O.n),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:PrincipalComponent,selectors:[["op-ium-principal"]],viewQuery:function PrincipalComponent_Query(e,t){if(1&e&&o.GBs(vn.f,5),2&e){let e;o.mGM(e=o.lsd())&&(t.dynamicForm=e.first)}},inputs:{principalData:"principalData",project:"project",type:"type",roleData:"roleData",messageData:"messageData"},outputs:{close:"close",save:"save",back:"back"},decls:24,vars:16,consts:[["input",""],[1,"spot-modal",3,"ngSubmit","formGroup"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"spot-modal--body","spot-container"],["required","",3,"label"],["slot","input",3,"spotFormBinding","type","project","createNew",4,"ngIf"],["slot","input",4,"ngIf"],["slot","errors","class","spot-form-field--error",4,"ngIf"],[3,"dynamicFormGroup","settings","formUrl","handleSubmit",4,"ngIf"],["slot","input",3,"spotFormBinding"],["slot","action",1,"spot-form-field--description",3,"innerHtml"],[3,"label",4,"ngIf"],[1,"spot-action-bar"],[1,"spot-action-bar--left"],["type","button",1,"button","button_no-margin","spot-action-bar--action",3,"click"],["icon-classes","button--icon icon-arrow-left1"],[1,"spot-action-bar--right"],["type","button",1,"button","button_no-margin","spot-action-bar--action","spot-modal--cancel-button",3,"click","textContent"],["type","submit",1,"button","button_no-margin","-primary","spot-action-bar--action",3,"textContent"],["slot","input",3,"createNew","spotFormBinding","type","project"],["slot","input"],["type","button",1,"spot-link",3,"click"],["slot","errors",1,"spot-form-field--error"],[3,"dynamicFormGroup","settings","formUrl","handleSubmit"],[3,"label"],["slot","input",1,"op-input","op-ium-invite-message-field",3,"formControl"]],template:function PrincipalComponent_Template(e,t){1&e&&(o.j41(0,"form",1),o.bIt("ngSubmit",(function PrincipalComponent_Template_form_ngSubmit_0_listener(e){return t.onSubmit(e)})),o.j41(1,"div",2),o.EFF(2),o.k0s(),o.nrm(3,"div",3),o.j41(4,"div",4)(5,"spot-form-field",5),o.DNE(6,PrincipalComponent_op_ium_principal_search_6_Template,1,3,"op-ium-principal-search",6)(7,PrincipalComponent_p_7_Template,6,3,"p",7)(8,PrincipalComponent_p_8_Template,6,3,"p",7)(9,PrincipalComponent_div_9_Template,2,1,"div",8),o.k0s(),o.DNE(10,PrincipalComponent_op_dynamic_form_10_Template,1,4,"op-dynamic-form",9),o.j41(11,"spot-form-field",5),o.nrm(12,"op-ium-role-search",10)(13,"p",11),o.DNE(14,PrincipalComponent_div_14_Template,2,1,"div",8),o.k0s(),o.DNE(15,PrincipalComponent_spot_form_field_15_Template,5,3,"spot-form-field",12),o.k0s(),o.j41(16,"div",13)(17,"div",14)(18,"button",15),o.bIt("click",(function PrincipalComponent_Template_button_click_18_listener(){return t.back.emit()})),o.nrm(19,"op-icon",16),o.EFF(20),o.k0s()(),o.j41(21,"div",17)(22,"button",18),o.bIt("click",(function PrincipalComponent_Template_button_click_22_listener(){return t.close.emit()})),o.k0s(),o.nrm(23,"button",19),o.k0s()()()),2&e&&(o.Y8G("formGroup",t.principalForm),o.R7$(2),o.JRh(t.text.principal.title()),o.R7$(3),o.Y8G("label",t.textLabel),o.R7$(),o.Y8G("ngIf",!(t.hasPrincipalSelected&&t.isNewPrincipal)),o.R7$(),o.Y8G("ngIf",t.isNewPrincipal&&t.type===t.PrincipalType.User),o.R7$(),o.Y8G("ngIf",t.isNewPrincipal&&t.type===t.PrincipalType.Placeholder),o.R7$(),o.Y8G("ngIf",null==t.principalControl?null:t.principalControl.invalid),o.R7$(),o.Y8G("ngIf",t.isNewPrincipal&&t.type===t.PrincipalType.User&&t.userDynamicFieldConfig.schema),o.R7$(),o.Y8G("label",t.text.role.label()),o.R7$(),o.Y8G("spotFormBinding",t.roleControl),o.R7$(),o.Y8G("innerHtml",t.text.role.description(),o.npT),o.R7$(),o.Y8G("ngIf",null==t.roleControl?null:t.roleControl.invalid),o.R7$(),o.Y8G("ngIf",t.type!==t.PrincipalType.Placeholder),o.R7$(5),o.SpI(" ",t.text.principal.backButton," "),o.R7$(2),o.Y8G("textContent",t.text.principal.cancelButton),o.R7$(),o.Y8G("textContent",t.text.principal.nextButton))},dependencies:[P.bT,a.qT,a.me,a.BC,a.cb,Le.i,bn.U,Cn.x,a.l_,a.j4,vn.f,PrincipalSearchComponent,RoleSearchComponent],styles:[".op-ium-invite-message-field[_ngcontent-%COMP%]{height:8em}"],changeDetection:0})}}var Pn=n(87378);function SummaryComponent_spot_form_field_14_Template(e,t){if(1&e&&(o.j41(0,"spot-form-field",4)(1,"p",14),o.EFF(2),o.k0s()()),2&e){const e=o.XpG();o.Y8G("label",e.text.messageLabel),o.R7$(2),o.JRh(e.message)}}class SummaryComponent{get principal(){return this.principalData.principal}constructor(e,t,n){this.I18n=e,this.elementRef=t,this.api=n,this.message="",this.close=new o.bkB,this.back=new o.bkB,this.save=new o.bkB,this.PrincipalType=hn.J,this.text={title:()=>this.I18n.t("js.invite_user_modal.title.invite"),projectLabel:this.I18n.t("js.invite_user_modal.project.label"),principalLabel:{User:this.I18n.t("js.invite_user_modal.principal.label.name_or_email"),PlaceholderUser:this.I18n.t("js.invite_user_modal.principal.label.name"),Group:this.I18n.t("js.invite_user_modal.principal.label.name")},roleLabel:()=>this.I18n.t("js.invite_user_modal.role.label",{project:this.project?.name}),messageLabel:this.I18n.t("js.invite_user_modal.message.label"),backButton:this.I18n.t("js.invite_user_modal.back"),cancelButton:this.I18n.t("js.button_cancel"),nextButton:()=>this.I18n.t("js.invite_user_modal.summary.next_button",{type:this.type,principal:this.principal})}}invite(){return(0,je.of)(this.principalData).pipe((0,ae.n)((e=>this.createPrincipal(e))),(0,ae.n)((e=>this.api.memberships.post({principal:e,project:this.project,roles:[this.role],notificationMessage:{raw:this.message}}).pipe((0,Pn.u)(e)))))}createPrincipal(e){const{principal:t,customFields:n}=e;if(t instanceof Ft.q)return(0,je.of)(t);switch(this.type){case hn.J.User:return this.api.users.post({email:t.name,status:"invited",...n});case hn.J.Placeholder:return this.api.placeholder_users.post({name:t.name});default:throw new Error("Unsupported PrincipalType given")}}onSubmit(e){e.preventDefault(),this.invite().subscribe((e=>this.save.emit({principal:e})))}static{this.ɵfac=function SummaryComponent_Factory(e){return new(e||SummaryComponent)(o.rXU(w.W),o.rXU(o.aKT),o.rXU(O.n))}}static{this.ɵcmp=o.VBU({type:SummaryComponent,selectors:[["op-ium-summary"]],inputs:{type:"type",project:"project",role:"role",principalData:"principalData",message:"message"},outputs:{close:"close",back:"back",save:"save"},decls:25,vars:11,consts:[["name","sendUserInviteForm",1,"op-ium-summary","spot-modal",3,"submit"],["id","spotModalTitle",1,"spot-modal--header"],[1,"spot-divider"],[1,"spot-modal--body","spot-container"],[3,"label"],["slot","input",1,"spot-body-small","op-ium-summary--details"],[3,"label",4,"ngIf"],[1,"spot-action-bar"],[1,"spot-action-bar--left"],["type","button",1,"button","button_no-margin","spot-action-bar--action",3,"click"],["icon-classes","button--icon icon-arrow-left1"],[1,"spot-action-bar--right"],["type","button",1,"button","button_no-margin","spot-action-bar--action","spot-modal--cancel-button",3,"click"],["type","submit",1,"button","button_no-margin","-primary","spot-action-bar--action"],["slot","input",1,"spot-body-small","op-ium-summary--message"]],template:function SummaryComponent_Template(e,t){1&e&&(o.j41(0,"form",0),o.bIt("submit",(function SummaryComponent_Template_form_submit_0_listener(e){return t.onSubmit(e)})),o.j41(1,"div",1),o.EFF(2),o.k0s(),o.nrm(3,"div",2),o.j41(4,"div",3)(5,"spot-form-field",4)(6,"p",5),o.EFF(7),o.k0s()(),o.j41(8,"spot-form-field",4)(9,"p",5),o.EFF(10),o.k0s()(),o.j41(11,"spot-form-field",4)(12,"p",5),o.EFF(13),o.k0s()(),o.DNE(14,SummaryComponent_spot_form_field_14_Template,3,2,"spot-form-field",6),o.k0s(),o.j41(15,"div",7)(16,"div",8)(17,"button",9),o.bIt("click",(function SummaryComponent_Template_button_click_17_listener(){return t.back.emit()})),o.nrm(18,"op-icon",10),o.EFF(19),o.k0s()(),o.j41(20,"div",11)(21,"button",12),o.bIt("click",(function SummaryComponent_Template_button_click_21_listener(){return t.close.emit()})),o.EFF(22),o.k0s(),o.j41(23,"button",13),o.EFF(24),o.k0s()()()()),2&e&&(o.R7$(2),o.JRh(t.text.title()),o.R7$(3),o.Y8G("label",t.text.projectLabel),o.R7$(2),o.JRh(t.project.name),o.R7$(),o.Y8G("label",t.text.principalLabel[t.type]),o.R7$(2),o.JRh(null==t.principal?null:t.principal.name),o.R7$(),o.Y8G("label",t.text.roleLabel()),o.R7$(2),o.JRh(t.role.name),o.R7$(),o.Y8G("ngIf",t.type!==t.PrincipalType.Placeholder&&t.message),o.R7$(5),o.SpI(" ",t.text.backButton," "),o.R7$(3),o.JRh(t.text.cancelButton),o.R7$(2),o.JRh(t.text.nextButton()))},dependencies:[P.bT,a.qT,a.cb,a.cV,Le.i,bn.U],styles:[".op-ium-summary--message[_ngcontent-%COMP%]{white-space:pre-wrap}.op-ium-summary--details[_ngcontent-%COMP%]{margin-bottom:0}"],changeDetection:0})}}var In=n(65277);class SuccessComponent{constructor(e,t){this.I18n=e,this.elementRef=t,this.close=new o.bkB,this.PrincipalType=hn.J,this.user_image=(0,In.d)("invite-user-modal/successful-invite.svg"),this.placeholder_image=(0,In.d)("invite-user-modal/placeholder-added.svg"),this.text={title:()=>this.I18n.t("js.invite_user_modal.success.title",{principal:this.createdNewPrincipal?this.principal.email:this.principal.name}),description:{User:()=>this.I18n.t("js.invite_user_modal.success.description.user",{project:this.project?.name}),PlaceholderUser:()=>this.I18n.t("js.invite_user_modal.success.description.placeholder",{project:this.project?.name}),Group:()=>this.I18n.t("js.invite_user_modal.success.description.group",{project:this.project?.name})},nextButton:this.I18n.t("js.invite_user_modal.success.next_button")}}static{this.ɵfac=function SuccessComponent_Factory(e){return new(e||SuccessComponent)(o.rXU(w.W),o.rXU(o.aKT))}}static{this.ɵcmp=o.VBU({type:SuccessComponent,selectors:[["op-ium-success"]],inputs:{principal:"principal",project:"project",type:"type",createdNewPrincipal:"createdNewPrincipal"},outputs:{close:"close"},decls:8,vars:4,consts:[["id","spotModalTitle",1,"spot-modal--header",3,"textContent"],[1,"spot-divider"],[1,"spot-modal--body","spot-container"],[1,"op-ium-success-image",3,"src"],[3,"textContent"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],["type","button",1,"button","-primary","spot-action-bar--action",3,"click","textContent"]],template:function SuccessComponent_Template(e,t){1&e&&(o.nrm(0,"div",0)(1,"div",1),o.j41(2,"div",2),o.nrm(3,"img",3)(4,"span",4),o.k0s(),o.j41(5,"div",5)(6,"div",6)(7,"button",7),o.bIt("click",(function SuccessComponent_Template_button_click_7_listener(){return t.close.emit()})),o.k0s()()()),2&e&&(o.Y8G("textContent",t.text.title()),o.R7$(3),o.Y8G("src",t.type===t.PrincipalType.Placeholder?t.placeholder_image:t.user_image,o.B4B),o.R7$(),o.Y8G("textContent",t.text.description[t.type]()),o.R7$(3),o.Y8G("textContent",t.text.nextButton))},styles:[".op-ium-success-image[_ngcontent-%COMP%]{height:4rem}"],changeDetection:0})}}function initializeServices(e){return function(){e.get(OpInviteUserModalAugmentService).setupListener()}}class OpenprojectInviteUserModalModule{static{this.ɵfac=function OpenprojectInviteUserModalModule_Factory(e){return new(e||OpenprojectInviteUserModalModule)}}static{this.ɵmod=o.$C({type:OpenprojectInviteUserModalModule})}static{this.ɵinj=o.G2t({providers:[mn.Q,{provide:o.hnV,useFactory:initializeServices,deps:[o.zZn],multi:!0}],imports:[P.MD,d.d,k.p,a.YN,an.MQ,a.X1,cn.EE,un.t,dn.t,pn.l,dn.t]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenprojectInviteUserModalModule,{declarations:[hn.X,ProjectSelectionComponent,PrincipalComponent,PrincipalSearchComponent,RoleSearchComponent,SuccessComponent,SummaryComponent],imports:[P.MD,d.d,k.p,a.YN,an.MQ,a.X1,cn.EE,un.t,dn.t,pn.l],exports:[dn.t]}),o.wjB(hn.X,[P.bT,r.kB,ProjectSelectionComponent,PrincipalComponent,SuccessComponent,SummaryComponent],[]);class RevitAddInSettingsButtonService{constructor(e){this.i18n=e;window.navigator.userAgent.search("Revit")>-1&&(this.labelText=e.t("js.revit.revit_add_in_settings"),this.groupLabelText=e.t("js.revit.revit_add_in"),this.addUserMenuItem(),this.addLoginMenuItem())}addUserMenuItem(){const e=document.getElementById("user-menu");if(e){const t=document.createElement("li");t.dataset.name=this.labelText,t.innerHTML=`\n        <a class="op-menu--item-action revit-addin-settings-menu-item ellipsis" title="${this.labelText}" href="#">\n          <span class="menu-item--title ellipsis ">${this.labelText}</span>\n        </a>\n      `,t.addEventListener("click",(()=>this.goToSettings())),e.appendChild(t)}}addLoginMenuItem(){const e=document.querySelector("#nav-login-content");if(e){const t=document.createElement("div");t.dataset.name=this.labelText,t.innerHTML=`\n        <div class="login-auth-providers">\n          <h3 class="login-auth-providers-title">\n            <span>\n              ${this.groupLabelText}\n            </span>\n           </h3>\n          <div class="login-auth-provider-list revit-add-in-button">\n            <div class="auth-provider auth-provider-developer button">\n              <span class="auth-provider-name">${this.labelText}</span>\n            </div>\n          </div>\n        </div>\n      `,e.appendChild(t);const n=e.querySelector(".revit-add-in-button");n?.addEventListener("click",(()=>this.goToSettings()))}}goToSettings(){window.RevitBridge.sendMessageToRevit("GoToSettings","1","")}static{this.ɵfac=function RevitAddInSettingsButtonService_Factory(e){return new(e||RevitAddInSettingsButtonService)(o.KVO(w.W))}}static{this.ɵprov=o.jDH({token:RevitAddInSettingsButtonService,factory:RevitAddInSettingsButtonService.ɵfac})}}var xn=n(91141),Rn=n(61623),Fn=n(36987);function EnterpriseBaseComponent_div_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div")(1,"p"),o.EFF(2),o.k0s(),o.j41(3,"p",3),o.EFF(4),o.k0s(),o.j41(5,"p")(6,"span",3),o.EFF(7),o.k0s(),o.nrm(8,"br"),o.j41(9,"span"),o.EFF(10),o.k0s()(),o.j41(11,"button",4),o.bIt("click",(function EnterpriseBaseComponent_div_1_Template_button_click_11_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.openTrialModal())})),o.EFF(12),o.k0s()()}if(2&e){const e=o.XpG();o.R7$(2),o.JRh(e.text.enterprise_edition),o.R7$(2),o.JRh(e.text.confidence),o.R7$(3),o.JRh(e.text.become_hero),o.R7$(3),o.JRh(e.text.you_contribute),o.R7$(2),o.SpI(" ",e.text.button_trial," ")}}function EnterpriseBaseComponent_ng_template_2_Template(e,t){if(1&e){const e=o.RV6();o.nrm(0,"enterprise-trial-waiting"),o.j41(1,"p",5),o.EFF(2),o.j41(3,"a",6),o.bIt("click",(function EnterpriseBaseComponent_ng_template_2_Template_a_click_3_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.openTrialModal())})),o.EFF(4),o.k0s()()}if(2&e){const e=o.XpG();o.R7$(2),o.SpI("",e.text.email_not_received," "),o.R7$(2),o.JRh(e.text.try_another_email)}}class EnterpriseBaseComponent{constructor(e,t,n,i){this.I18n=e,this.opModalService=t,this.injector=n,this.eeTrialService=i,this.text={button_trial:this.I18n.t("js.admin.enterprise.upsale.button_start_trial"),button_book:this.I18n.t("js.admin.enterprise.upsale.button_book_now"),link_quote:this.I18n.t("js.admin.enterprise.upsale.link_quote"),become_hero:this.I18n.t("js.admin.enterprise.upsale.become_hero"),you_contribute:this.I18n.t("js.admin.enterprise.upsale.you_contribute"),email_not_received:this.I18n.t("js.admin.enterprise.trial.email_not_received"),enterprise_edition:this.I18n.t("js.admin.enterprise.upsale.text"),confidence:this.I18n.t("js.admin.enterprise.upsale.confidence"),try_another_email:this.I18n.t("js.admin.enterprise.trial.try_another_email")}}openTrialModal(){this.eeTrialService.store.update({cancelled:!0,modalOpen:!0}),this.opModalService.show(Rn._,this.injector)}get noTrialRequested(){return void 0===window.gon.ee_trial_key}static{this.ɵfac=function EnterpriseBaseComponent_Factory(e){return new(e||EnterpriseBaseComponent)(o.rXU(w.W),o.rXU(Y.a),o.rXU(o.zZn),o.rXU(xn.d))}}static{this.ɵcmp=o.VBU({type:EnterpriseBaseComponent,selectors:[["enterprise-base"]],decls:4,vars:2,consts:[["alreadyRequested",""],[1,"op-enterprise-base"],[4,"ngIf","ngIfElse"],[1,"-bold"],[1,"button","-primary",3,"click"],[1,"op-enterprise-base--confirmation-hint"],[3,"click"]],template:function EnterpriseBaseComponent_Template(e,t){if(1&e&&(o.j41(0,"div",1),o.DNE(1,EnterpriseBaseComponent_div_1_Template,13,5,"div",2)(2,EnterpriseBaseComponent_ng_template_2_Template,5,2,"ng-template",null,0,o.C5r),o.k0s()),2&e){const e=o.sdS(3);o.R7$(),o.Y8G("ngIf",t.noTrialRequested)("ngIfElse",e)}},dependencies:[P.bT,Fn.Z],styles:[".op-enterprise-base[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{float:left}.op-enterprise-base--confirmation-hint[_ngcontent-%COMP%]{font-size:.9em;font-style:italic;margin-bottom:2rem}"],changeDetection:0})}}var Mn=n(68235),On=n(57907),Dn=n(52843);function EEActiveSavedTrialComponent_div_13_Template(e,t){if(1&e&&(o.j41(0,"div",3),o.nrm(1,"div",4),o.j41(2,"div",5)(3,"div",6),o.nrm(4,"span",7),o.k0s()()()),2&e){const e=o.XpG();o.R7$(),o.Y8G("textContent",e.text.label_company),o.R7$(3),o.Y8G("textContent",e.company)}}function EEActiveSavedTrialComponent_div_14_Template(e,t){if(1&e&&(o.j41(0,"div",3),o.nrm(1,"div",4),o.j41(2,"div",10)(3,"div",6),o.nrm(4,"span",7),o.k0s()()()),2&e){const e=o.XpG();o.R7$(),o.Y8G("textContent",e.text.label_domain),o.R7$(3),o.Y8G("textContent",e.domain)}}function EEActiveSavedTrialComponent_div_15_Template(e,t){if(1&e&&(o.j41(0,"div",3),o.nrm(1,"div",4),o.j41(2,"div",5)(3,"div",6),o.nrm(4,"span",7),o.k0s()()()),2&e){const e=o.XpG();o.R7$(),o.Y8G("textContent",e.text.label_maximum_users),o.R7$(3),o.Y8G("textContent",e.userCount)}}function EEActiveSavedTrialComponent_div_16_Template(e,t){if(1&e&&(o.j41(0,"div",3),o.nrm(1,"div",4),o.j41(2,"div",5)(3,"div",6),o.nrm(4,"span",7),o.k0s()()()),2&e){const e=o.XpG();o.R7$(),o.Y8G("textContent",e.text.label_starts_at),o.R7$(3),o.Y8G("textContent",e.startsAt)}}function EEActiveSavedTrialComponent_div_17_span_5_Template(e,t){if(1&e&&o.nrm(0,"span",12),2&e){const e=o.XpG(2);o.Y8G("textContent",e.expiredWarningText)}}function EEActiveSavedTrialComponent_div_17_Template(e,t){if(1&e&&(o.j41(0,"div",3),o.nrm(1,"div",4),o.j41(2,"div",5)(3,"div",6),o.nrm(4,"span",7),o.DNE(5,EEActiveSavedTrialComponent_div_17_span_5_Template,1,1,"span",11),o.k0s()()()),2&e){const e=o.XpG();o.R7$(),o.Y8G("textContent",e.text.label_expires_at),o.R7$(3),o.Y8G("textContent",e.expiresAt),o.R7$(),o.Y8G("ngIf",e.isExpired)}}class EEActiveSavedTrialComponent extends Dn.E{constructor(e,t){super(t),this.elementRef=e,this.I18n=t,this.subscriber=this.elementRef.nativeElement.dataset.subscriber,this.email=this.elementRef.nativeElement.dataset.email,this.company=this.elementRef.nativeElement.dataset.company,this.domain=this.elementRef.nativeElement.dataset.domain,this.userCount=this.elementRef.nativeElement.dataset.userCount,this.startsAt=this.elementRef.nativeElement.dataset.startsAt,this.expiresAt=this.elementRef.nativeElement.dataset.expiresAt,this.isExpired="true"===this.elementRef.nativeElement.dataset.isExpired,this.reprieveDaysLeft=this.elementRef.nativeElement.dataset.reprieveDaysLeft}get expiredWarningText(){let e=this.text.text_expired;return this.reprieveDaysLeft&&this.reprieveDaysLeft>0&&(e=`${e}: ${this.text.text_reprieve_days_left(this.reprieveDaysLeft)}`),e}static{this.ɵfac=function EEActiveSavedTrialComponent_Factory(e){return new(e||EEActiveSavedTrialComponent)(o.rXU(o.aKT),o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:EEActiveSavedTrialComponent,selectors:[["opce-enterprise-active-saved-trial"]],features:[o.Vt3],decls:18,vars:9,consts:[["data-test-selector","op-enterprise--active-token",1,"op-enterprise--active-token"],[1,"attributes-group"],[1,"attributes-group--attributes"],[1,"attributes-key-value"],[1,"attributes-key-value--key",3,"textContent"],[1,"attributes-key-value--value-container"],[1,"attributes-key-value--value","-text"],[3,"textContent"],["data-test-selector","ee-active-trial-email",1,"attributes-key-value--value-container"],["class","attributes-key-value",4,"ngIf"],["data-test-selector","ee-active-trial-domain",1,"attributes-key-value--value-container"],["class","expired-warning",3,"textContent",4,"ngIf"],[1,"expired-warning",3,"textContent"]],template:function EEActiveSavedTrialComponent_Template(e,t){1&e&&(o.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),o.nrm(4,"div",4),o.j41(5,"div",5)(6,"div",6),o.nrm(7,"span",7),o.k0s()()(),o.j41(8,"div",3),o.nrm(9,"div",4),o.j41(10,"div",8)(11,"div",6),o.nrm(12,"span",7),o.k0s()()(),o.DNE(13,EEActiveSavedTrialComponent_div_13_Template,5,2,"div",9)(14,EEActiveSavedTrialComponent_div_14_Template,5,2,"div",9)(15,EEActiveSavedTrialComponent_div_15_Template,5,2,"div",9)(16,EEActiveSavedTrialComponent_div_16_Template,5,2,"div",9)(17,EEActiveSavedTrialComponent_div_17_Template,6,3,"div",9),o.k0s()()()),2&e&&(o.R7$(4),o.Y8G("textContent",t.text.label_subscriber),o.R7$(3),o.Y8G("textContent",t.subscriber),o.R7$(2),o.Y8G("textContent",t.text.label_email),o.R7$(3),o.Y8G("textContent",t.email),o.R7$(),o.Y8G("ngIf",t.company),o.R7$(),o.Y8G("ngIf",t.domain),o.R7$(),o.Y8G("ngIf",t.userCount),o.R7$(),o.Y8G("ngIf",t.startsAt),o.R7$(),o.Y8G("ngIf",t.expiresAt))},dependencies:[P.bT],styles:[".op-enterprise--active-token[_ngcontent-%COMP%]   .attributes-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.op-enterprise--active-token[_ngcontent-%COMP%]   .expired-warning[_ngcontent-%COMP%]{margin-left:.4rem;color:red;font-weight:var(--base-text-weight-bold)}"],changeDetection:0})}}class OpenprojectEnterpriseModule{static{this.ɵfac=function OpenprojectEnterpriseModule_Factory(e){return new(e||OpenprojectEnterpriseModule)}}static{this.ɵmod=o.$C({type:OpenprojectEnterpriseModule})}static{this.ɵinj=o.G2t({providers:[xn.d],imports:[d.d,k.p,a.YN,a.X1]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenprojectEnterpriseModule,{declarations:[EnterpriseBaseComponent,Rn._,Mn.s,Fn.Z,On.c,EEActiveSavedTrialComponent],imports:[d.d,k.p,a.YN,a.X1]});var Gn=n(2237),En=n(91066);class MainMenuToggleComponent extends $t.p{constructor(e,t,n,i){super(),this.topMenu=e,this.toggleService=t,this.cdRef=n,this.injector=i,this.toggleTitle=""}ngOnInit(){this.toggleService.initializeMenu(),this.toggleService.titleData$.pipe((0,J.F)(),this.untilDestroyed()).subscribe((e=>{this.toggleTitle=e,this.cdRef.detectChanges()}))}toggle(e){this.toggleService.toggleNavigation(e),this.topMenu.close()}static{this.ɵfac=function MainMenuToggleComponent_Factory(e){return new(e||MainMenuToggleComponent)(o.rXU(En.k),o.rXU(Gn.S),o.rXU(o.gRc),o.rXU(o.zZn))}}static{this.ɵcmp=o.VBU({type:MainMenuToggleComponent,selectors:[["opce-main-menu-toggle"]],hostAttrs:[1,"op-app-menu","op-main-menu-toggle"],features:[o.Vt3],decls:3,vars:1,consts:[["id","main-menu-toggle","aria-haspopup","true","type","button",1,"op-app-menu--item-action",3,"click"],["aria-hidden","true",1,"icon-hamburger"],["aria-hidden","true",1,"icon-close"]],template:function MainMenuToggleComponent_Template(e,t){1&e&&(o.j41(0,"button",0),o.bIt("click",(function MainMenuToggleComponent_Template_button_click_0_listener(e){return t.toggle(e)})),o.nrm(1,"op-icon",1)(2,"op-icon",2),o.k0s()),2&e&&o.BMQ("title",t.toggleTitle)},dependencies:[Le.i],encapsulation:2,changeDetection:0})}}(0,U.Cg)([(0,Q.O)(),(0,U.Sn)("design:type",T.c)],MainMenuToggleComponent.prototype,"currentProject",void 0);var An=n(76790),Vn=n(71116),$n=n(78),Bn=n(56042),Wn=n(90778),Nn=n(1365),Un=n(61396),Yn=n(10885),Xn=n(73881),qn=n(51832),Ln=n(18240),Hn=n(93338),zn=n(44197),Qn=n(26579);const Kn=["op-header-project-select-list",""],header_project_select_list_component_c1=(e,t)=>({"spot-list--item-action_disabled":e,"spot-list--item-action_active":t}),header_project_select_list_component_c2=e=>({"spot-list--item-action_active":e});function OpHeaderProjectSelectListComponent_li_0_a_1__svg_svg_4_Template(e,t){1&e&&(o.qSk(),o.nrm(0,"svg",10))}function OpHeaderProjectSelectListComponent_li_0_a_1_a_5_Template(e,t){if(1&e&&(o.j41(0,"a",11),o.qSk(),o.nrm(1,"svg",12),o.k0s()),2&e){const e=o.XpG(3);o.Y8G("href",e.extendedUrl(null),o.B4B)}}function OpHeaderProjectSelectListComponent_li_0_a_1_Template(e,t){if(1&e&&(o.j41(0,"a",5),o.nI1(1,"async"),o.j41(2,"span",6),o.nrm(3,"span",7),o.DNE(4,OpHeaderProjectSelectListComponent_li_0_a_1__svg_svg_4_Template,1,0,"svg",8),o.k0s(),o.DNE(5,OpHeaderProjectSelectListComponent_li_0_a_1_a_5_Template,2,1,"a",9),o.k0s()),2&e){const e=o.XpG().$implicit,t=o.XpG();o.Y8G("ngClass",o.l_i(11,header_project_select_list_component_c1,e.disabled,o.bMT(1,9,t.searchableProjectListService.selectedItemID$)===e.id))("href",t.extendedUrl(e.id),o.B4B),o.BMQ("data-list-selector",t.projectListActionIdentifier)("data-project-id",e.id)("data-test-selector",t.currentProjectService.id===e.id.toString()?"op-header-project-select--active-item":null),o.R7$(3),o.Y8G("opSearchHighlight",t.searchText)("textContent",e.name),o.R7$(),o.Y8G("ngIf",null==t.favored?null:t.favored.includes(e.id.toString())),o.R7$(),o.Y8G("ngIf",t.currentProjectService.id===e.id.toString())}}function OpHeaderProjectSelectListComponent_li_0_span_2_Template(e,t){if(1&e&&(o.j41(0,"span",13),o.nI1(1,"async"),o.j41(2,"span",14),o.EFF(3),o.k0s()()),2&e){const e=o.XpG().$implicit,t=o.XpG();o.Y8G("ngClass",o.eq3(4,header_project_select_list_component_c2,o.bMT(1,2,t.searchableProjectListService.selectedItemID$)===e.id)),o.R7$(3),o.JRh(e.name)}}function OpHeaderProjectSelectListComponent_li_0_ul_3_Template(e,t){if(1&e&&o.nrm(0,"ul",15),2&e){const e=o.XpG().$implicit,t=o.XpG();o.Y8G("projects",e.children)("displayMode",t.displayMode)("favored",t.favored)("selected",t.selected)("searchText",t.searchText)}}function OpHeaderProjectSelectListComponent_li_0_Template(e,t){if(1&e&&(o.j41(0,"li",1),o.DNE(1,OpHeaderProjectSelectListComponent_li_0_a_1_Template,6,14,"a",2)(2,OpHeaderProjectSelectListComponent_li_0_span_2_Template,4,6,"span",3)(3,OpHeaderProjectSelectListComponent_li_0_ul_3_Template,1,5,"ul",4),o.k0s()),2&e){const e=t.$implicit,n=o.XpG();o.BMQ("data-list-selector",n.projectListItemIdentifier),o.R7$(),o.Y8G("ngIf",!e.disabled),o.R7$(),o.Y8G("ngIf",e.disabled),o.R7$(),o.Y8G("ngIf",e.children.length)}}class OpHeaderProjectSelectListComponent{constructor(e,t,n,i,r,s,a){this.I18n=e,this.pathHelper=t,this.configuration=n,this.searchableProjectListService=i,this.elementRef=r,this.cdRef=s,this.currentProjectService=a,this.classNameList=!0,this.className=!0,this.update=new o.bkB,this.root=!1,this.projects=[],this.favored=[],this.searchText="",this.text={does_not_match_search:this.I18n.t("js.include_projects.tooltip.does_not_match_search"),include_all_selected:this.I18n.t("js.include_projects.tooltip.include_all_selected")}}ngOnInit(){this.root&&this.searchableProjectListService.selectedItemID$.subscribe((e=>{requestAnimationFrame((()=>{const t=this.elementRef.nativeElement.querySelectorAll(`.spot-list--item-action[data-project-id="${e||""}"]`);t[0]?.scrollIntoView()}))})),this.updateProjectFilter()}ngOnChanges(e){(e.displayMode||e.projects||e.favored)&&this.updateProjectFilter()}updateProjectFilter(){this.filteredProjects=this.projects.filter((e=>"all"===this.displayMode||this.showWhenFavored(e)))}showWhenFavored(e){return!!this.isFavored(e)||e.children.length>0&&e.children.some((e=>this.showWhenFavored(e)))}isFavored(e){return this.favored.includes(e.id.toString())}extendedUrl(e){const t=document.querySelector('meta[name="current_menu_item"]'),n=null===e?window.appBasePath:this.pathHelper.projectPath(e);return t?`${n}?jump=${encodeURIComponent(t.content)}`:n}static{this.ɵfac=function OpHeaderProjectSelectListComponent_Factory(e){return new(e||OpHeaderProjectSelectListComponent)(o.rXU(w.W),o.rXU(B.B),o.rXU(q.s),o.rXU(Xn.Z),o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(T.c))}}static{this.ɵcmp=o.VBU({type:OpHeaderProjectSelectListComponent,selectors:[["","op-header-project-select-list",""]],hostVars:6,hostBindings:function OpHeaderProjectSelectListComponent_HostBindings(e,t){2&e&&o.AVh("spot-list",t.classNameList)("op-header-project-select-list",t.className)("op-header-project-select-list--root",t.root)},inputs:{root:"root",projects:"projects",favored:"favored",displayMode:"displayMode",searchText:"searchText"},outputs:{update:"update"},features:[o.OA$],attrs:Kn,decls:1,vars:1,consts:[["class","spot-list--item","data-test-selector","op-header-project-select--item",4,"ngFor","ngForOf"],["data-test-selector","op-header-project-select--item",1,"spot-list--item"],["tabindex","-1","class","spot-list--item-action",3,"ngClass","href",4,"ngIf"],["class","spot-list--item-action spot-list--item-action_disabled",3,"ngClass",4,"ngIf"],["op-header-project-select-list","",3,"projects","displayMode","favored","selected","searchText",4,"ngIf"],["tabindex","-1",1,"spot-list--item-action",3,"ngClass","href"],["data-test-selector","op-header-project-select--item-title",1,"spot-list--item-title","spot-list--item-title_ellipse-text"],[3,"opSearchHighlight","textContent"],["star-fill-icon","","class","op-primer--star-icon","size","small",4,"ngIf"],["data-test-selector","op-header-project-select--item-remove-icon",3,"href",4,"ngIf"],["star-fill-icon","","size","small",1,"op-primer--star-icon"],["data-test-selector","op-header-project-select--item-remove-icon",3,"href"],["x-circle-icon","","size","small"],[1,"spot-list--item-action","spot-list--item-action_disabled",3,"ngClass"],["data-test-selector","op-header-project-select--item-disabled-title",1,"spot-list--item-title","spot-list--item-title_ellipse-text"],["op-header-project-select-list","",3,"projects","displayMode","favored","selected","searchText"]],template:function OpHeaderProjectSelectListComponent_Template(e,t){1&e&&o.DNE(0,OpHeaderProjectSelectListComponent_li_0_Template,4,4,"li",0),2&e&&o.Y8G("ngForOf",t.filteredProjects)},dependencies:[P.YU,P.Sq,P.bT,Ze.uMM,Ze.RAZ,Qn.p,OpHeaderProjectSelectListComponent,P.Jj],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}[_nghost-%COMP%], .op-header-project-select-list[_ngcontent-%COMP%]{flex-shrink:1;flex-basis:100%}.op-header-project-select-list--root[_nghost-%COMP%], .op-header-project-select-list.op-header-project-select-list--root[_ngcontent-%COMP%]{overflow-y:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.op-header-project-select-list--root[_nghost-%COMP%]::-webkit-scrollbar, .op-header-project-select-list.op-header-project-select-list--root[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.op-header-project-select-list--root[_nghost-%COMP%]::-webkit-scrollbar-track, .op-header-project-select-list.op-header-project-select-list--root[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.op-header-project-select-list--root[_nghost-%COMP%]::-webkit-scrollbar-thumb, .op-header-project-select-list.op-header-project-select-list--root[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.op-header-project-select-list--root[_nghost-%COMP%]:hover, .op-header-project-select-list.op-header-project-select-list--root[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.op-header-project-select-list--root[_nghost-%COMP%]:hover::-webkit-scrollbar-thumb, .op-header-project-select-list.op-header-project-select-list--root[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}"],changeDetection:0})}}const header_project_select_component_c0=()=>({standalone:!0});function OpHeaderProjectSelectComponent_spot_toggle_7_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"spot-toggle",11),o.bIt("ngModelChange",(function OpHeaderProjectSelectComponent_spot_toggle_7_Template_spot_toggle_ngModelChange_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.displayModeChange(t))})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("options",e.displayModeOptions)("ngModel",e.displayMode)}}function OpHeaderProjectSelectComponent_div_8_spot_text_field_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"spot-text-field",21),o.mxI("ngModelChange",(function OpHeaderProjectSelectComponent_div_8_spot_text_field_1_Template_spot_text_field_ngModelChange_0_listener(t){o.eBV(e);const n=o.XpG(2);return o.DH7(n.searchableProjectListService.searchText,t)||(n.searchableProjectListService.searchText=t),o.Njj(t)})),o.bIt("keydown",(function OpHeaderProjectSelectComponent_div_8_spot_text_field_1_Template_spot_text_field_keydown_0_listener(t){o.eBV(e);const n=o.XpG().ngIf,i=o.XpG();return o.Njj(i.searchableProjectListService.onKeydown(t,n))}))("inputFocus",(function OpHeaderProjectSelectComponent_div_8_spot_text_field_1_Template_spot_text_field_inputFocus_0_listener(){o.eBV(e);const t=o.XpG(2);return o.Njj(t.textFieldFocused=!0)}))("inputBlur",(function OpHeaderProjectSelectComponent_div_8_spot_text_field_1_Template_spot_text_field_inputBlur_0_listener(){o.eBV(e);const t=o.XpG(2);return o.Njj(t.textFieldFocused=!1)})),o.nrm(1,"span",22),o.k0s()}if(2&e){const e=o.XpG(2);o.Y8G("placeholder",e.text.search_placeholder),o.R50("ngModel",e.searchableProjectListService.searchText),o.Y8G("ngModelOptions",o.lJ4(3,header_project_select_component_c0))}}function OpHeaderProjectSelectComponent_div_8_ng_container_3_ul_1_Template(e,t){if(1&e&&(o.nrm(0,"ul",24),o.nI1(1,"async")),2&e){const e=o.XpG(2).ngIf,t=o.XpG();o.Y8G("projects",e)("displayMode",t.displayMode)("favored",o.bMT(1,5,t.favorites$))("searchText",t.searchableProjectListService.searchText)("root",!0)}}function OpHeaderProjectSelectComponent_div_8_ng_container_3_ng_template_3_div_0_Template(e,t){if(1&e&&(o.j41(0,"div",27),o.qSk(),o.nrm(1,"svg",28),o.joV(),o.j41(2,"p"),o.nrm(3,"strong",19)(4,"br")(5,"span",29),o.k0s()()),2&e){const e=o.XpG(4);o.R7$(3),o.Y8G("textContent",e.text.no_favorites),o.R7$(2),o.Y8G("textContent",e.text.no_favorites_subtext)}}function OpHeaderProjectSelectComponent_div_8_ng_container_3_ng_template_3_span_2_Template(e,t){if(1&e&&(o.j41(0,"span",30),o.EFF(1),o.k0s()),2&e){const e=o.XpG(4);o.R7$(),o.SpI(" ",e.text.no_results," ")}}function OpHeaderProjectSelectComponent_div_8_ng_container_3_ng_template_3_Template(e,t){if(1&e&&(o.DNE(0,OpHeaderProjectSelectComponent_div_8_ng_container_3_ng_template_3_div_0_Template,6,2,"div",25),o.nI1(1,"async"),o.DNE(2,OpHeaderProjectSelectComponent_div_8_ng_container_3_ng_template_3_span_2_Template,2,1,"span",26),o.nI1(3,"async")),2&e){const e=o.XpG(3);o.Y8G("ngIf","favored"===e.displayMode&&0===o.bMT(1,2,e.favorites$).length),o.R7$(2),o.Y8G("ngIf",!("favored"===e.displayMode&&0===o.bMT(3,4,e.favorites$).length))}}function OpHeaderProjectSelectComponent_div_8_ng_container_3_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,OpHeaderProjectSelectComponent_div_8_ng_container_3_ul_1_Template,2,7,"ul",23),o.nI1(2,"async"),o.DNE(3,OpHeaderProjectSelectComponent_div_8_ng_container_3_ng_template_3_Template,4,6,"ng-template",null,1,o.C5r),o.bVm()),2&e){const e=o.sdS(4),t=o.XpG().ngIf,n=o.XpG();o.R7$(),o.Y8G("ngIf",n.anyProjectsFound(t,o.bMT(2,2,n.favorites$)))("ngIfElse",e)}}function OpHeaderProjectSelectComponent_div_8_a_10_Template(e,t){if(1&e&&(o.j41(0,"a",31),o.nrm(1,"span",32)(2,"span",19),o.k0s()),2&e){const e=o.XpG(2);o.Y8G("href",e.newProjectPath(),o.B4B),o.R7$(2),o.Y8G("textContent",e.text.project.singular)}}function OpHeaderProjectSelectComponent_div_8_Template(e,t){if(1&e&&(o.j41(0,"div",12),o.DNE(1,OpHeaderProjectSelectComponent_div_8_spot_text_field_1_Template,2,4,"spot-text-field",13),o.nI1(2,"async"),o.DNE(3,OpHeaderProjectSelectComponent_div_8_ng_container_3_Template,5,4,"ng-container",14),o.nI1(4,"async"),o.j41(5,"div",15)(6,"div",16)(7,"a",17),o.nrm(8,"span",18)(9,"span",19),o.k0s(),o.DNE(10,OpHeaderProjectSelectComponent_div_8_a_10_Template,3,2,"a",20),o.nI1(11,"async"),o.k0s()()()),2&e){let e;const t=o.XpG(),n=o.sdS(11);o.R7$(),o.Y8G("ngIf","favored"!==t.displayMode||(null==(e=o.bMT(2,6,t.favorites$))?null:e.length)>0),o.R7$(2),o.Y8G("ngIf",!1===o.bMT(4,8,t.loading$))("ngIfElse",n),o.R7$(4),o.Y8G("href",t.allProjectsPath(),o.B4B),o.R7$(2),o.Y8G("textContent",t.text.project.list),o.R7$(),o.Y8G("ngIf",o.bMT(11,10,t.canCreateNewProjects$))}}function OpHeaderProjectSelectComponent_ng_template_10_Template(e,t){1&e&&o.nrm(0,"op-loading-project-list",33)}class OpHeaderProjectSelectComponent extends $t.p{constructor(e,t,n,i,o,r,s){super(),this.pathHelper=e,this.configuration=t,this.I18n=n,this.currentProject=i,this.searchableProjectListService=o,this.currentUserService=r,this.apiV3Service=s,this.className=!0,this.dropModalOpen=!1,this.textFieldFocused=!1,this.canCreateNewProjects$=this.currentUserService.hasCapabilities$("projects/create","global"),this.projects$=(0,Vt.z)([this.searchableProjectListService.allProjects$,this.searchableProjectListService.searchText$.pipe((0,At.B)(200))]).pipe((0,G.T)((([e,t])=>e.filter((e=>{if(t.length){if(!e.name.toLowerCase().includes(t.toLowerCase()))return!1}return!0})).sort(((e,t)=>e._links.ancestors.length-t._links.ancestors.length)).reduce(((t,n)=>{const{ancestors:i}=n._links;return(0,Un.X)(e,n,t,i)}),[]))),(0,G.T)((e=>(0,Yn.h)(e))),(0,Tn.t)()),this.favorites$=this.apiV3Service.projects.signalled((0,Je.K7)("favored","=",!0),["elements/id"],{pageSize:"-1"}).pipe((0,G.T)((e=>e._embedded.elements||[])),(0,G.T)((e=>e.map((e=>e.id.toString())))),(0,Wn.U)([]),(0,Tn.t)(1)),this.text={all:this.I18n.t("js.label_all_uppercase"),favored:this.I18n.t("js.label_favorites"),no_favorites:this.I18n.t("js.favorite_projects.no_results"),no_favorites_subtext:this.I18n.t("js.favorite_projects.no_results_subtext"),project:{singular:this.I18n.t("js.label_project"),plural:this.I18n.t("js.label_project_plural"),list:this.I18n.t("js.label_project_list"),select:this.I18n.t("js.label_select_project")},search_placeholder:this.I18n.t("js.include_projects.search_placeholder"),no_results:this.I18n.t("js.include_projects.no_results")},this.displayMode="all",this.displayModeOptions=[{value:"all",title:this.text.all},{value:"favored",title:this.text.favored}],this.loading$=this.searchableProjectListService.fetchingProjects$.pipe((0,Z.p)((e=>e)),(0,ne.s)(1),(0,Nn.Z)((()=>this.projects$)),(0,Nn.Z)((()=>this.searchableProjectListService.fetchingProjects$))),this.scrollToCurrent=!1,this.subscriptionComplete$=new Bn.m(1),this.projects$.pipe(this.untilDestroyed()).subscribe((e=>{this.currentProject.id&&e.length&&this.scrollToCurrent?this.searchableProjectListService.selectedItemID$.next(parseInt(this.currentProject.id,10)):this.searchableProjectListService.resetActiveResult(e),this.scrollToCurrent=!1,this.subscriptionComplete$.next()}))}toggleDropModal(){this.subscriptionComplete$.pipe((0,ne.s)(1)).subscribe((()=>{this.dropModalOpen=!this.dropModalOpen,this.dropModalOpen&&(this.scrollToCurrent=!0,this.searchableProjectListService.loadAllProjects())}))}displayModeChange(e){this.displayMode=e,this.currentProject?.id&&this.searchableProjectListService.selectedItemID$.next(parseInt(this.currentProject.id,10))}close(){this.searchableProjectListService.searchText="",this.dropModalOpen=!1}currentProjectName(){return null!==this.currentProject.name?this.currentProject.name:this.text.project.select}allProjectsPath(){return this.pathHelper.projectsPath()}newProjectPath(){const e=this.currentProject.id?`?parent_id=${this.currentProject.id}`:"";return`${this.pathHelper.projectsNewPath()}${e}`}anyProjectsFound(e,t){return"all"===this.displayMode?e.length>0:e.length>0&&t.length>0}static{this.ɵfac=function OpHeaderProjectSelectComponent_Factory(e){return new(e||OpHeaderProjectSelectComponent)(o.rXU(B.B),o.rXU(q.s),o.rXU(w.W),o.rXU(T.c),o.rXU(Xn.Z),o.rXU(S.K),o.rXU(O.n))}}static{this.ɵcmp=o.VBU({type:OpHeaderProjectSelectComponent,selectors:[["opce-header-project-select"]],hostVars:2,hostBindings:function OpHeaderProjectSelectComponent_HostBindings(e,t){2&e&&o.AVh("op-header-project-select",t.className)},features:[o.Jv_([Xn.Z]),o.Vt3],decls:12,vars:8,consts:[["loadingTemplate",""],["noResultsTemplate",""],["alignment","bottom-start",1,"op-project-list-modal",3,"closed","opened","allowRepositioning"],["id","projects-menu","accesskey","5","aria-haspopup","true","type","button","slot","trigger","data-test-selector","op-projects-menu",1,"op-app-menu--item-action",3,"click"],[1,"op-app-menu--item-title","ellipsis",3,"textContent"],[1,"op-app-menu--item-dropdown-indicator","button--dropdown-indicator"],["slot","body"],[1,"op-project-list-modal--header"],[1,"op-project-list-modal--title",3,"textContent"],[3,"options","ngModel","ngModelChange",4,"ngIf"],["class","op-project-list-modal--body spot-container","data-searchable-list-parent","true",4,"ngIf"],[3,"ngModelChange","options","ngModel"],["data-searchable-list-parent","true",1,"op-project-list-modal--body","spot-container"],["data-test-selector","op-header-project-select--search","data-modal-focus-catcher-container","true",3,"placeholder","ngModel","ngModelOptions","ngModelChange","keydown","inputFocus","inputBlur",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"spot-action-bar"],[1,"spot-action-bar--right"],[1,"button","spot-action-bar--action",3,"href"],[1,"spot-icon","spot-icon_unordered-list"],[3,"textContent"],["class","button -primary spot-action-bar--action",3,"href",4,"ngIf"],["data-test-selector","op-header-project-select--search","data-modal-focus-catcher-container","true",3,"ngModelChange","keydown","inputFocus","inputBlur","placeholder","ngModel","ngModelOptions"],["slot","before",1,"spot-icon","spot-icon_search"],["op-header-project-select-list","","class","spot-list_active","data-list-root","true","data-test-selector","op-header-project-select--list",3,"projects","displayMode","favored","searchText","root",4,"ngIf","ngIfElse"],["op-header-project-select-list","","data-list-root","true","data-test-selector","op-header-project-select--list",1,"spot-list_active",3,"projects","displayMode","favored","searchText","root"],["class","op-header-project-select--no-favorites",4,"ngIf"],["class","op-project-list-modal--no-results",4,"ngIf"],[1,"op-header-project-select--no-favorites"],["star-icon","","size","medium",1,"op-header-project-select--no-favorites-icon"],[1,"op-header-project-select--no-favorites-subtext",3,"textContent"],[1,"op-project-list-modal--no-results"],[1,"button","-primary","spot-action-bar--action",3,"href"],[1,"spot-icon","spot-icon_add"],[1,"op-project-list-modal--loading"]],template:function OpHeaderProjectSelectComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"spot-drop-modal",2),o.bIt("closed",(function OpHeaderProjectSelectComponent_Template_spot_drop_modal_closed_0_listener(){return o.eBV(e),o.Njj(t.close())})),o.j41(1,"button",3),o.bIt("click",(function OpHeaderProjectSelectComponent_Template_button_click_1_listener(){return o.eBV(e),o.Njj(t.toggleDropModal())})),o.nrm(2,"span",4)(3,"i",5),o.k0s(),o.qex(4,6),o.j41(5,"div",7),o.nrm(6,"h1",8),o.DNE(7,OpHeaderProjectSelectComponent_spot_toggle_7_Template,1,2,"spot-toggle",9),o.k0s(),o.DNE(8,OpHeaderProjectSelectComponent_div_8_Template,12,12,"div",10),o.nI1(9,"async"),o.bVm(),o.DNE(10,OpHeaderProjectSelectComponent_ng_template_10_Template,1,0,"ng-template",null,0,o.C5r),o.k0s()}2&e&&(o.Y8G("opened",t.dropModalOpen)("allowRepositioning",!1),o.R7$(2),o.Y8G("textContent",t.currentProjectName()),o.R7$(4),o.Y8G("textContent",t.text.project.plural),o.R7$(),o.Y8G("ngIf",t.currentUserService.isLoggedIn),o.R7$(),o.Y8G("ngIf",o.bMT(9,6,t.projects$)))},dependencies:[P.bT,a.BC,a.vS,Ze.F7G,qn.k,Ln.l,Hn.m,zn.K,OpHeaderProjectSelectListComponent,P.Jj],styles:[".op-header-project-select{max-width:100%}.op-header-project-select--no-favorites{display:flex;text-align:center;flex-direction:column;align-items:center;margin:0 1.25rem}.op-header-project-select--no-favorites-icon{margin-bottom:.5rem}.op-header-project-select--no-favorites-subtext{font-size:.9rem;color:var(--fgColor-muted, var(--color-fg-subtle))}.op-header-project-select .op-app-menu--item-action{padding:0 8px}\n"],encapsulation:2,changeDetection:0})}}var Jn=n(81965);class MainMenuResizerComponent extends $t.p{constructor(e,t,n){super(),this.toggleService=e,this.cdRef=t,this.elementRef=n,this.mainMenu=jQuery("#main-menu")[0],this.moving=!1}ngOnInit(){this.toggleService.titleData$.pipe((0,J.F)(),this.untilDestroyed()).subscribe((e=>{this.toggleTitle=e,this.cdRef.detectChanges()})),this.resizeEvent="main-menu-resize"}resizeStart(){this.elementWidth=this.mainMenu.clientWidth}resizeMove(e){this.toggleService.saveWidth(this.elementWidth+e.absolute.x)}resizeEnd(){const e=new Event(this.resizeEvent);window.dispatchEvent(e)}static{this.ɵfac=function MainMenuResizerComponent_Factory(e){return new(e||MainMenuResizerComponent)(o.rXU(Gn.S),o.rXU(o.gRc),o.rXU(o.aKT))}}static{this.ɵcmp=o.VBU({type:MainMenuResizerComponent,selectors:[["opce-main-menu-resizer"]],features:[o.Vt3],decls:8,vars:5,consts:[[1,"main-menu--resizer",3,"resizeFinished","resizeStarted","move","customHandler","cursorClass"],[1,"spot-link","main-menu--navigation-toggler",3,"click"],[1,"resize-handle"],["op-resizer-vertical-lines-icon","","size","small"],[1,"collapse-menu"],["chevron-left-icon","","size","small"],[1,"expand-menu"],["chevron-right-icon","","size","small"]],template:function MainMenuResizerComponent_Template(e,t){1&e&&(o.j41(0,"op-resizer",0),o.bIt("resizeFinished",(function MainMenuResizerComponent_Template_op_resizer_resizeFinished_0_listener(){return t.resizeEnd()}))("resizeStarted",(function MainMenuResizerComponent_Template_op_resizer_resizeStarted_0_listener(){return t.resizeStart()}))("move",(function MainMenuResizerComponent_Template_op_resizer_move_0_listener(e){return t.resizeMove(e)})),o.j41(1,"button",1),o.bIt("click",(function MainMenuResizerComponent_Template_button_click_1_listener(e){return t.toggleService.toggleNavigation(e)})),o.j41(2,"span",2),o.qSk(),o.nrm(3,"svg",3),o.k0s(),o.joV(),o.j41(4,"span",4),o.qSk(),o.nrm(5,"svg",5),o.k0s(),o.joV(),o.j41(6,"span",6),o.qSk(),o.nrm(7,"svg",7),o.k0s()()()),2&e&&(o.Y8G("customHandler",!0)("cursorClass","col-resize"),o.R7$(),o.AVh("open",t.toggleService.showNavigation),o.BMQ("title",t.toggleTitle))},dependencies:[Ze.pRt,Ze.weG,Ze.BBM,_e.a],encapsulation:2,changeDetection:0})}}var Zn=n(46147);class TypeBannerService extends ee.b{constructor(e,t,n){super(e),this.documentElement=e,this.confirmDialog=t,this.I18n=n}showEEOnlyHint(){this.confirmDialog.confirm({text:{title:this.I18n.t("js.types.attribute_groups.upgrade_to_ee"),text:this.I18n.t("js.types.attribute_groups.upgrade_to_ee_text"),button_continue:this.I18n.t("js.types.attribute_groups.more_information"),button_cancel:this.I18n.t("js.types.attribute_groups.nevermind")}}).then((()=>{window.location.href="https://www.openproject.org/enterprise-edition/?utm_source=unknown&utm_medium=community-edition&utm_campaign=form-configuration"})).catch((()=>{}))}static{this.ɵfac=function TypeBannerService_Factory(e){return new(e||TypeBannerService)(o.KVO(P.qQ),o.KVO(qe.g),o.KVO(w.W))}}static{this.ɵprov=o.jDH({token:TypeBannerService,factory:TypeBannerService.ɵfac})}}var ei=n(2768);function GroupEditInPlaceComponent_div_0_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",3),o.bIt("click",(function GroupEditInPlaceComponent_div_0_Template_div_click_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.startEditing())})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("textContent",e.name)}}function GroupEditInPlaceComponent_input_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"input",4,0),o.mxI("ngModelChange",(function GroupEditInPlaceComponent_input_1_Template_input_ngModelChange_0_listener(t){o.eBV(e);const n=o.XpG();return o.DH7(n.editedName,t)||(n.editedName=t),o.Njj(t)})),o.bIt("blur",(function GroupEditInPlaceComponent_input_1_Template_input_blur_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.saveEdition(t))}))("keydown.escape",(function GroupEditInPlaceComponent_input_1_Template_input_keydown_escape_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.reset())}))("keydown.enter",(function GroupEditInPlaceComponent_input_1_Template_input_keydown_enter_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.saveEdition(t))})),o.k0s()}if(2&e){const e=o.XpG();o.R50("ngModel",e.editedName),o.BMQ("placeholder",e.placeholder)}}class GroupEditInPlaceComponent{constructor(e,t){this.bannerService=e,this.cdRef=t,this.placeholder="",this.onValueChange=new o.bkB,this.editing=!1}ngOnInit(){this.editedName=this.name,this.name&&0!==this.name.length||this.startEditing()}startEditing(){this.bannerService.conditional((()=>this.bannerService.showEEOnlyHint()),(()=>{this.editing=!0}))}saveEdition(e){return this.leaveEditingMode(),this.name=this.editedName.trim(),this.cdRef.detectChanges(),""!==this.name&&this.onValueChange.emit(this.name),e.preventDefault(),e.stopPropagation(),!1}reset(){this.editing=!1,this.editedName=this.name}leaveEditingMode(){null!=this.editedName&&this.editedName.trim().length>0&&(this.editing=!1)}static{this.ɵfac=function GroupEditInPlaceComponent_Factory(e){return new(e||GroupEditInPlaceComponent)(o.rXU(TypeBannerService),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:GroupEditInPlaceComponent,selectors:[["op-group-edit-in-place"]],inputs:{placeholder:"placeholder",name:"name"},outputs:{onValueChange:"onValueChange"},decls:2,vars:2,consts:[["nameInput",""],["class","group-edit-handler",3,"textContent","click",4,"ngIf"],["class","group-edit-in-place--input","type","text","opAutofocus","",3,"ngModel","ngModelChange","blur","keydown.escape","keydown.enter",4,"ngIf"],[1,"group-edit-handler",3,"click","textContent"],["type","text","opAutofocus","",1,"group-edit-in-place--input",3,"ngModelChange","blur","keydown.escape","keydown.enter","ngModel"]],template:function GroupEditInPlaceComponent_Template(e,t){1&e&&o.DNE(0,GroupEditInPlaceComponent_div_0_Template,1,1,"div",1)(1,GroupEditInPlaceComponent_input_1_Template,2,2,"input",2),2&e&&(o.Y8G("ngIf",!t.editing),o.R7$(),o.Y8G("ngIf",t.editing))},dependencies:[P.bT,a.me,a.BC,a.vS,ei.B],encapsulation:2,changeDetection:0})}}function TypeFormAttributeGroupComponent_div_6_span_4_Template(e,t){if(1&e&&o.nrm(0,"span",12),2&e){const e=o.XpG(2);o.Y8G("textContent",e.text.custom_field)}}function TypeFormAttributeGroupComponent_div_6_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",7),o.nrm(1,"span",8),o.j41(2,"span",9),o.EFF(3),o.DNE(4,TypeFormAttributeGroupComponent_div_6_span_4_Template,1,1,"span",10),o.k0s(),o.j41(5,"span",11),o.bIt("click",(function TypeFormAttributeGroupComponent_div_6_Template_span_click_5_listener(){const t=o.eBV(e).$implicit,n=o.XpG();return o.Njj(n.removeFromGroup(t))})),o.k0s()()}if(2&e){const e=t.$implicit;o.BMQ("data-key",e.key),o.R7$(3),o.SpI(" ",e.translation," "),o.R7$(),o.Y8G("ngIf",e.is_cf)}}class TypeFormAttributeGroupComponent{constructor(e,t){this.I18n=e,this.cdRef=t,this.deleteGroup=new o.bkB,this.removeAttribute=new o.bkB,this.text={custom_field:this.I18n.t("js.admin.type_form.custom_field")}}rename(e){this.group.name=e,delete this.group.key,this.cdRef.detectChanges()}removeFromGroup(e){this.group.attributes=this.group.attributes.filter((t=>t!==e)),this.removeAttribute.emit(e)}static{this.ɵfac=function TypeFormAttributeGroupComponent_Factory(e){return new(e||TypeFormAttributeGroupComponent)(o.rXU(w.W),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:TypeFormAttributeGroupComponent,selectors:[["op-type-form-attribute-group"]],inputs:{group:"group"},outputs:{deleteGroup:"deleteGroup",removeAttribute:"removeAttribute"},decls:7,vars:3,consts:[[1,"type-form-conf-group"],[1,"group-head"],[1,"group-handle","icon-drag-handle"],[1,"group-name",3,"onValueChange","name"],[1,"delete-group","icon-small","icon-close",3,"click"],["dragula","attributes",1,"attributes",3,"dragulaModelChange","dragulaModel"],["class","type-form-conf-attribute",4,"ngFor","ngForOf"],[1,"type-form-conf-attribute"],[1,"attribute-handle","icon-drag-handle"],[1,"attribute-name"],["class","attribute-cf-label",3,"textContent",4,"ngIf"],[1,"delete-attribute","icon-small","icon-close",3,"click"],[1,"attribute-cf-label",3,"textContent"]],template:function TypeFormAttributeGroupComponent_Template(e,t){1&e&&(o.j41(0,"div",0)(1,"div",1),o.nrm(2,"span",2),o.j41(3,"op-group-edit-in-place",3),o.bIt("onValueChange",(function TypeFormAttributeGroupComponent_Template_op_group_edit_in_place_onValueChange_3_listener(e){return t.rename(e)})),o.k0s(),o.j41(4,"span",4),o.bIt("click",(function TypeFormAttributeGroupComponent_Template_span_click_4_listener(){return t.deleteGroup.emit()})),o.k0s()(),o.j41(5,"div",5),o.mxI("dragulaModelChange",(function TypeFormAttributeGroupComponent_Template_div_dragulaModelChange_5_listener(e){return o.DH7(t.group.attributes,e)||(t.group.attributes=e),e})),o.DNE(6,TypeFormAttributeGroupComponent_div_6_Template,6,3,"div",6),o.k0s()()),2&e&&(o.R7$(3),o.Y8G("name",t.group.name),o.R7$(2),o.R50("dragulaModel",t.group.attributes),o.R7$(),o.Y8G("ngForOf",t.group.attributes))},dependencies:[Zn.Am,P.Sq,P.bT,GroupEditInPlaceComponent],encapsulation:2,changeDetection:0})}}var ti=n(70130),ni=n(36831),ii=n(66899);function TypeFormConfigurationComponent_li_7_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"li",18)(1,"a",19),o.nrm(2,"op-icon",20)(3,"span",6)(4,"op-icon",21),o.k0s(),o.j41(5,"ul",22)(6,"li")(7,"button",23),o.bIt("click",(function TypeFormConfigurationComponent_li_7_Template_button_click_7_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.createGroup("attribute",""))})),o.k0s()(),o.j41(8,"li")(9,"button",23),o.bIt("click",(function TypeFormConfigurationComponent_li_7_Template_button_click_9_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.addGroupAndOpenQuery())})),o.k0s()()()()}if(2&e){const e=o.XpG();o.R7$(3),o.Y8G("textContent",e.text.label_group),o.R7$(4),o.Y8G("textContent",e.text.add_group),o.R7$(2),o.Y8G("textContent",e.text.add_table)}}function TypeFormConfigurationComponent_ng_container_11_op_type_form_attribute_group_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"op-type-form-attribute-group",26),o.bIt("removeAttribute",(function TypeFormConfigurationComponent_ng_container_11_op_type_form_attribute_group_1_Template_op_type_form_attribute_group_removeAttribute_0_listener(t){o.eBV(e);const n=o.XpG(2);return o.Njj(n.deactivateAttribute(t))}))("deleteGroup",(function TypeFormConfigurationComponent_ng_container_11_op_type_form_attribute_group_1_Template_op_type_form_attribute_group_deleteGroup_0_listener(){o.eBV(e);const t=o.XpG().$implicit,n=o.XpG();return o.Njj(n.deleteGroup(t))})),o.k0s()}if(2&e){const e=o.XpG().$implicit;o.Y8G("group",e)}}function TypeFormConfigurationComponent_ng_container_11_op_type_form_query_group_2_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"op-type-form-query-group",27),o.bIt("editQuery",(function TypeFormConfigurationComponent_ng_container_11_op_type_form_query_group_2_Template_op_type_form_query_group_editQuery_0_listener(){o.eBV(e);const t=o.XpG().$implicit,n=o.XpG();return o.Njj(n.editQuery(t))}))("deleteGroup",(function TypeFormConfigurationComponent_ng_container_11_op_type_form_query_group_2_Template_op_type_form_query_group_deleteGroup_0_listener(){o.eBV(e);const t=o.XpG().$implicit,n=o.XpG();return o.Njj(n.deleteGroup(t))})),o.k0s()}if(2&e){const e=o.XpG().$implicit;o.Y8G("group",e)}}function TypeFormConfigurationComponent_ng_container_11_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,TypeFormConfigurationComponent_ng_container_11_op_type_form_attribute_group_1_Template,1,1,"op-type-form-attribute-group",24)(2,TypeFormConfigurationComponent_ng_container_11_op_type_form_query_group_2_Template,1,1,"op-type-form-query-group",25),o.bVm()),2&e){const e=t.$implicit;o.R7$(),o.Y8G("ngIf","attribute"===e.type),o.R7$(),o.Y8G("ngIf","query"===e.type)}}function TypeFormConfigurationComponent_div_19_span_4_Template(e,t){if(1&e&&o.nrm(0,"span",32),2&e){const e=o.XpG(2);o.Y8G("textContent",e.text.custom_field)}}function TypeFormConfigurationComponent_div_19_Template(e,t){if(1&e&&(o.j41(0,"div",28),o.nrm(1,"span",29),o.j41(2,"span",30),o.EFF(3),o.DNE(4,TypeFormConfigurationComponent_div_19_span_4_Template,1,1,"span",31),o.k0s()()),2&e){const e=t.$implicit;o.BMQ("data-key",e.key),o.R7$(3),o.SpI(" ",e.translation," "),o.R7$(),o.Y8G("ngIf",e.is_cf)}}const oi="__empty";class TypeFormConfigurationComponent extends $t.p{constructor(e,t,n,i,o,r){super(),this.elementRef=e,this.I18n=t,this.dragula=n,this.confirmDialog=i,this.externalRelationQuery=o,this.typeBanner=r,this.text={drag_to_activate:this.I18n.t("js.admin.type_form.drag_to_activate"),reset:this.I18n.t("js.admin.type_form.reset_to_defaults"),label_group:this.I18n.t("js.label_group"),new_group:this.I18n.t("js.admin.type_form.new_group"),label_inactive:this.I18n.t("js.admin.type_form.inactive"),custom_field:this.I18n.t("js.admin.type_form.custom_field"),add_group:this.I18n.t("js.admin.type_form.add_group"),add_table:this.I18n.t("js.admin.type_form.add_table")},this.groups=[],this.inactives=[]}ngOnInit(){this.dragula.destroy("groups"),this.dragula.destroy("attributes"),this.element=this.elementRef.nativeElement,this.no_filter_query=this.element.dataset.noFilterQuery,this.form=jQuery(this.element).closest("form"),this.submit=this.form.find(".form-configuration--save");let e=!1;this.form.on("submit",(()=>{e=!0})),this.submit.on("mousedown",(()=>(setTimeout((()=>{e||this.form.trigger("submit")}),50),!0))),this.form.on("submit.typeformupdater",(()=>(this.updateHiddenFields(),!0))),this.groupsDrake=this.dragula.createGroup("groups",{moves:(e,t,n)=>n.classList.contains("group-handle")}).drake,this.attributeDrake=this.dragula.createGroup("attributes",{moves:(e,t,n)=>n.classList.contains("attribute-handle")}).drake,this.groups=JSON.parse(this.element.dataset.activeGroups).filter((e=>e?.key!==oi)),this.inactives=JSON.parse(this.element.dataset.inactiveAttributes);const t=this;this.autoscroll=new ni.A([document.getElementById("content-body")],{margin:25,maxSpeed:10,scrollWhenOutside:!0,autoScroll(){const e=t.groupsDrake&&t.groupsDrake.dragging,n=t.attributeDrake&&t.attributeDrake.dragging;return e||n}})}ngAfterViewInit(){const e=jQuery(this.elementRef.nativeElement).find(".toolbar-items");(0,ii.f)(e)}ngOnDestroy(){this.dragula.destroy("groups"),this.dragula.destroy("attributes"),this.autoscroll.destroy()}deactivateAttribute(e){this.updateInactives(this.inactives.concat(e))}addGroupAndOpenQuery(){const e=this.createGroup("query");this.editQuery(e)}editQuery(e){this.typeBanner.conditional((()=>this.typeBanner.showEEOnlyHint()),(()=>{const t={"display-settings":I18n.t("js.work_packages.table_configuration.embedded_tab_disabled"),timelines:I18n.t("js.work_packages.table_configuration.embedded_tab_disabled")};this.externalRelationQuery.show({currentQuery:JSON.parse(e.query),callback:t=>e.query=JSON.stringify(t),disabledTabs:t})}))}deleteGroup(e){this.typeBanner.conditional((()=>this.typeBanner.showEEOnlyHint()),(()=>("attribute"===e.type&&this.updateInactives(this.inactives.concat(e.attributes)),this.groups=this.groups.filter((t=>t!==e)),e)))}createGroup(e,t=""){const n={type:e,name:t,key:null,query:this.no_filter_query,attributes:[]};return this.groups.unshift(n),n}resetToDefault(e){return this.confirmDialog.confirm({text:{title:this.I18n.t("js.types.attribute_groups.reset_title"),text:this.I18n.t("js.types.attribute_groups.confirm_reset"),button_continue:this.I18n.t("js.label_reset")}}).then((()=>{this.form.find("input#type_attribute_groups").val(JSON.stringify([])),this.form.off("submit.typeformupdater"),this.form.trigger("submit")})).catch((()=>{})),e.preventDefault(),!1}updateInactives(e){this.inactives=[...e].sort(((e,t)=>e.translation.localeCompare(t.translation)))}get emptyGroup(){return{type:"attribute",key:oi,name:"empty",attributes:[]}}updateHiddenFields(){const e=this.form.find(".admin-type-form--hidden-field");0===this.groups.length?e.val(JSON.stringify([this.emptyGroup])):e.val(JSON.stringify(this.groups))}static{this.ɵfac=function TypeFormConfigurationComponent_Factory(e){return new(e||TypeFormConfigurationComponent)(o.rXU(o.aKT),o.rXU(w.W),o.rXU(Zn.g$),o.rXU(qe.g),o.rXU(ti.R),o.rXU(TypeBannerService))}}static{this.ɵcmp=o.VBU({type:TypeFormConfigurationComponent,selectors:[["opce-admin-type-form-configuration"]],features:[o.Jv_([TypeBannerService]),o.Vt3],decls:20,vars:8,consts:[[1,"toolbar-container","-with-dropdown"],[1,"toolbar","toolbar_empty-title"],[1,"toolbar-items"],[1,"toolbar-item"],["type","button -primary",1,"form-configuration--reset","button",3,"click"],["icon-classes","button--icon icon-undo"],[1,"button--text",3,"textContent"],["class","toolbar-item drop-down",4,"ngIf"],[1,"grid-block","wrap"],[1,"grid-content","small-12","medium-6"],["id","draggable-groups","dragula","groups",3,"dragulaModelChange","dragulaModel"],[4,"ngFor","ngForOf"],["id","type-form-conf-inactive-group"],[1,"group-head"],[1,"group-name",3,"textContent"],[1,"advice",3,"textContent"],["dragula","attributes",1,"attributes",3,"dragulaModelChange","dragulaModel"],["class","type-form-conf-attribute",4,"ngFor","ngForOf"],[1,"toolbar-item","drop-down"],["aria-haspopup","true",1,"form-configuration--add-group","button","-primary"],["icon-classes","button--icon icon-add"],["icon-classes","button--dropdown-indicator"],[1,"menu-drop-down-container"],["type","button",1,"menu-item","form-configuration--add-group",3,"click","textContent"],[3,"group","removeAttribute","deleteGroup",4,"ngIf"],[3,"group","editQuery","deleteGroup",4,"ngIf"],[3,"removeAttribute","deleteGroup","group"],[3,"editQuery","deleteGroup","group"],[1,"type-form-conf-attribute"],[1,"attribute-handle","icon-drag-handle"],[1,"attribute-name"],["class","attribute-cf-label",3,"textContent",4,"ngIf"],[1,"attribute-cf-label",3,"textContent"]],template:function TypeFormConfigurationComponent_Template(e,t){1&e&&(o.j41(0,"div",0)(1,"div",1)(2,"ul",2)(3,"li",3)(4,"button",4),o.bIt("click",(function TypeFormConfigurationComponent_Template_button_click_4_listener(e){return t.resetToDefault(e)})),o.nrm(5,"op-icon",5)(6,"span",6),o.k0s()(),o.DNE(7,TypeFormConfigurationComponent_li_7_Template,10,3,"li",7),o.k0s()()(),o.j41(8,"div",8)(9,"div",9)(10,"div",10),o.mxI("dragulaModelChange",(function TypeFormConfigurationComponent_Template_div_dragulaModelChange_10_listener(e){return o.DH7(t.groups,e)||(t.groups=e),e})),o.DNE(11,TypeFormConfigurationComponent_ng_container_11_Template,3,2,"ng-container",11),o.k0s()(),o.j41(12,"div",9)(13,"div",12)(14,"div",13),o.nrm(15,"span",14),o.EFF(16," "),o.nrm(17,"span",15),o.k0s(),o.j41(18,"div",16),o.mxI("dragulaModelChange",(function TypeFormConfigurationComponent_Template_div_dragulaModelChange_18_listener(e){return o.DH7(t.inactives,e)||(t.inactives=e),e})),o.DNE(19,TypeFormConfigurationComponent_div_19_Template,5,3,"div",17),o.k0s()()()()),2&e&&(o.R7$(6),o.Y8G("textContent",t.text.reset),o.R7$(),o.Y8G("ngIf",!t.typeBanner.eeShowBanners),o.R7$(3),o.R50("dragulaModel",t.groups),o.R7$(),o.Y8G("ngForOf",t.groups),o.R7$(4),o.Y8G("textContent",t.text.label_inactive),o.R7$(2),o.Y8G("textContent",t.text.drag_to_activate),o.R7$(),o.R50("dragulaModel",t.inactives),o.R7$(),o.Y8G("ngForOf",t.inactives))},encapsulation:2})}}class TypeFormQueryGroupComponent{constructor(e,t){this.I18n=e,this.cdRef=t,this.text={edit_query:this.I18n.t("js.admin.type_form.edit_query")},this.editQuery=new o.bkB,this.deleteGroup=new o.bkB}rename(e){this.group.name=e,this.cdRef.detectChanges()}static{this.ɵfac=function TypeFormQueryGroupComponent_Factory(e){return new(e||TypeFormQueryGroupComponent)(o.rXU(w.W),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:TypeFormQueryGroupComponent,selectors:[["op-type-form-query-group"]],inputs:{group:"group"},outputs:{editQuery:"editQuery",deleteGroup:"deleteGroup"},decls:9,vars:2,consts:[[1,"type-form-conf-group","type-form-query-group"],[1,"group-head"],[1,"group-handle","icon-drag-handle"],[1,"group-name",3,"onValueChange","name"],[1,"delete-group","icon-small","icon-close",3,"click"],[1,"type-form-query"],[1,"type-form-query-group--edit-button",3,"click"],["icon-classes","button--icon icon-edit"]],template:function TypeFormQueryGroupComponent_Template(e,t){1&e&&(o.j41(0,"div",0)(1,"div",1),o.nrm(2,"span",2),o.j41(3,"op-group-edit-in-place",3),o.bIt("onValueChange",(function TypeFormQueryGroupComponent_Template_op_group_edit_in_place_onValueChange_3_listener(e){return t.rename(e)})),o.k0s(),o.j41(4,"span",4),o.bIt("click",(function TypeFormQueryGroupComponent_Template_span_click_4_listener(){return t.deleteGroup.emit()})),o.k0s()(),o.j41(5,"div",5)(6,"span",6),o.bIt("click",(function TypeFormQueryGroupComponent_Template_span_click_6_listener(){return t.editQuery.emit()})),o.nrm(7,"op-icon",7),o.EFF(8),o.k0s()()()),2&e&&(o.R7$(3),o.Y8G("name",t.group.name),o.R7$(5),o.SpI(" ",t.text.edit_query," "))},dependencies:[Le.i,GroupEditInPlaceComponent],encapsulation:2,changeDetection:0})}}var ri=n(74627);class EditableQueryPropsComponent{constructor(e,t,n,i){this.elementRef=e,this.I18n=t,this.cdRef=n,this.externalQuery=i,this.urlParams=!1,this.text={edit_query:this.I18n.t("js.admin.type_form.edit_query")}}ngOnInit(){const e=this.elementRef.nativeElement;this.id=e.dataset.id,this.name=e.dataset.name,this.urlParams="true"===e.dataset.urlParams,this.queryProps=e.dataset.query}editQuery(){const e=(()=>{if(this.urlParams)return this.queryProps;try{return JSON.parse(this.queryProps)}catch(e){return console.error(`Failed to parse query props from ${this.queryProps}: ${e}`),{}}})();this.externalQuery.show({currentQuery:e,urlParams:this.urlParams,callback:e=>{this.queryProps=this.urlParams?e:JSON.stringify(e),this.cdRef.detectChanges()}})}static{this.ɵfac=function EditableQueryPropsComponent_Factory(e){return new(e||EditableQueryPropsComponent)(o.rXU(o.aKT),o.rXU(w.W),o.rXU(o.gRc),o.rXU(ri.H))}}static{this.ɵcmp=o.VBU({type:EditableQueryPropsComponent,selectors:[["opce-editable-query-props"]],decls:2,vars:4,consts:[["type","hidden",3,"value"],["type","button",1,"spot-link",3,"click","textContent"]],template:function EditableQueryPropsComponent_Template(e,t){1&e&&(o.nrm(0,"input",0),o.j41(1,"button",1),o.bIt("click",(function EditableQueryPropsComponent_Template_button_click_1_listener(){return t.editQuery()})),o.k0s()),2&e&&(o.Y8G("value",t.queryProps),o.BMQ("name",t.name||void 0)("id",t.id||void 0),o.R7$(),o.Y8G("textContent",t.text.edit_query))},encapsulation:2,changeDetection:0})}}class OpenprojectAdminModule{static{this.ɵfac=function OpenprojectAdminModule_Factory(e){return new(e||OpenprojectAdminModule)}}static{this.ɵmod=o.$C({type:OpenprojectAdminModule})}static{this.ɵinj=o.G2t({imports:[Zn.d0.forRoot(),d.d]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenprojectAdminModule,{declarations:[TypeFormAttributeGroupComponent,TypeFormQueryGroupComponent,TypeFormConfigurationComponent,GroupEditInPlaceComponent,EditableQueryPropsComponent],imports:[Zn.d0,d.d]}),o.wjB(TypeFormConfigurationComponent,(function(){return[Zn.Am,P.Sq,P.bT,Le.i,TypeFormAttributeGroupComponent,TypeFormQueryGroupComponent]}),[]);var si=n(7014),ai=n(11621),li=n(39356),ci=n(27256),pi=n(44933),di=n(20666);class HTMLSanitizeService{constructor(e){this.sanitizer=e}sanitize(e){return this.sanitizer.sanitize(o.WPN.HTML,e)||""}static{this.ɵfac=function HTMLSanitizeService_Factory(e){return new(e||HTMLSanitizeService)(o.KVO(i.up))}}static{this.ɵprov=o.jDH({token:HTMLSanitizeService,factory:HTMLSanitizeService.ɵfac,providedIn:"root"})}}var ui=n(73962),hi=n(88535);class OpenProjectPluginContext{constructor(e){this.injector=e,this._knownHookNames=["workPackageBulkContextMenu","workPackageTableContextMenu","workPackageSingleContextMenu","workPackageNewInitialization"],this.services={confirmDialog:this.injector.get(qe.g),externalQueryConfiguration:this.injector.get(ri.H),externalRelationQueryConfiguration:this.injector.get(ti.R),halResource:this.injector.get(oe.t),hooks:this.injector.get(b.R),i18n:this.injector.get(w.W),notifications:this.injector.get(R.fw),timezone:this.injector.get(W.D),opModalService:this.injector.get(Y.a),displayField:this.injector.get(li.w),editField:this.injector.get(ci.M),macros:this.injector.get(di.K),htmlSanitizeService:this.injector.get(HTMLSanitizeService),ckEditorPreview:this.injector.get(pi.H),pathHelperService:this.injector.get(B.B),states:this.injector.get(c.D),apiV3Service:this.injector.get(O.n),configurationService:this.injector.get(q.s),attachmentsResourceService:this.injector.get(ui._),http:this.injector.get(s.Qq),turboRequests:this.injector.get(hi.W)},this.helpers={idFromLink:be.A},this.classes={modals:{dynamicContent:Vn.T},HalResource:Ft.q,DisplayField:ai.p,DomAutoscrollService:ni.A},this.hooks={},this._knownHookNames.forEach((e=>{this.hooks[e]=t=>this.services.hooks.register(e,t)}))}runInZone(e){this.zone.run(e)}}(0,U.Cg)([(0,Q.O)(),(0,U.Sn)("design:type",o.SKi)],OpenProjectPluginContext.prototype,"zone",void 0);var mi=n(36819);class OpenprojectPluginsModule{constructor(e){(0,mi.cY)("Registering OpenProject plugin context");const t=new OpenProjectPluginContext(e);window.OpenProject.pluginContext.putValue(t)}static{this.ɵfac=function OpenprojectPluginsModule_Factory(e){return new(e||OpenprojectPluginsModule)(o.KVO(o.zZn))}}static{this.ɵmod=o.$C({type:OpenprojectPluginsModule})}static{this.ɵinj=o.G2t({providers:[b.R]})}}var gi=n(47418);class PlannedCostsFormAugment{static listen(){jQuery(document).on("click",".costs--edit-planned-costs-btn",(e=>{const t=e.target,n=t.nextElementSibling;t.hidden=!0,n.hidden=!1;n.querySelector("input").disabled=!1})),jQuery(document).on("click",".costs--edit-planned-costs-cancel-btn",(e=>{const t=e.target.closest(".costs--edit-form");t.previousElementSibling.hidden=!1,t.hidden=!0;t.querySelector("input").disabled=!0}))}}var _i=n(71138);class BudgetBaseResource extends Ft.q{}const fi=(0,_i.o)(BudgetBaseResource);class PluginModule{constructor(e){!function initializeCostsPlugin(e){window.OpenProject.getPluginContext().then((e=>{e.services.editField.extendFieldType("select",["Budget"]),e.services.displayField.extendFieldType("resource",["Budget"]),e.services.halResource.registerResource("Budget",{cls:fi});const{states:t}=e.services;t.add("budgets",(0,gi.Iy)()),PlannedCostsFormAugment.listen()}))}()}static{this.ɵfac=function PluginModule_Factory(e){return new(e||PluginModule)(o.KVO(o.zZn))}}static{this.ɵmod=o.$C({type:PluginModule})}static{this.ɵinj=o.G2t({})}}class CostsByTypeDisplayField extends ai.p{apply(e,t){super.apply(e,t),this.loadIfNecessary()}loadIfNecessary(){this.value&&!1===this.value.$loaded&&this.value.$load().then((()=>{"WorkPackage"===this.resource.$source._type&&this.apiV3Service.work_packages.cache.touch(this.resource.id)}))}get title(){return""}render(e,t){this.isEmpty()?e.textContent=this.placeholder:this.value.elements.forEach(((t,n)=>{this.resource.showCosts?this.renderCostAsLink(t,e,n):this.renderCostAsText(t,e,n)}))}isEmpty(){return!this.value||!this.value.elements||0===this.value.elements.length}renderCostAsLink(e,t,n){const i=this.resource.showCosts,o=document.createElement("a");o.href=i.href+"&unit="+e.costType.id,o.setAttribute("target","_blank"),o.textContent=e.spentUnits+" "+e.costType.name,t.appendChild(o),this.addSeparator(t,n)}renderCostAsText(e,t,n){const i=document.createElement("span");i.textContent=e.spentUnits+" "+e.costType.name,t.appendChild(i),this.addSeparator(t,n)}addSeparator(e,t){if(t<this.value.elements.length-1){const t=document.createElement("span");t.textContent=", ",e.appendChild(t)}}}(0,U.Cg)([(0,Q.O)(),(0,U.Sn)("design:type",O.n)],CostsByTypeDisplayField.prototype,"apiV3Service",void 0);class CurrencyDisplayField extends ai.p{isEmpty(){return!this.value||!parseFloat(this.value.match(/\d+/g)[0])}}class main_PluginModule{constructor(e){!function main_initializeCostsPlugin(e){window.OpenProject.getPluginContext().then((e=>{const t=e.services.displayField;t.addFieldType(CostsByTypeDisplayField,"costs",["costsByType"]),t.addFieldType(CurrencyDisplayField,"currency",["laborCosts","materialCosts","overallCosts"]),e.hooks.workPackageSingleContextMenu((e=>({key:"log_costs",icon:"icon-projects",indexBy(e){const t=_.findIndex(e,{key:"log_time"});return-1!==t?t+1:e.length},resource:"workPackage",link:"logCosts"}))),e.hooks.workPackageTableContextMenu((e=>({key:"log_costs",icon:"icon-projects",link:"logCosts",indexBy(e){const t=_.findIndex(e,{link:"logTime"});return-1!==t?t+1:e.length},text:I18n.t("js.button_log_costs")})))}))}()}static{this.ɵfac=function PluginModule_Factory(e){return new(e||main_PluginModule)(o.KVO(o.zZn))}}static{this.ɵmod=o.$C({type:main_PluginModule})}static{this.ɵinj=o.G2t({})}}function dataURItoBlob(e){const t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],i=t.length,o=new Uint8Array(i);for(let e=0;e<i;e+=1)o[e]=t.charCodeAt(e);return new Blob([o],{type:n})}function resizeFile(e,t){return new Promise((n=>{const i=new FileReader;i.onload=t=>{const i=new Image;i.onload=()=>n(function resizeImage(e,t){const n=document.createElement("canvas"),i=n.getContext("2d");let{width:o}=t,{height:r}=t;o>r?o>e&&(r*=e/o,o=e):r>e&&(o*=e/r,r=e),n.width=o,n.height=r,i.drawImage(t,0,0,o,r);const s=n.toDataURL("image/jpeg");return[s,dataURItoBlob(s)]}(e,i)),i.src=t.target?.result},i.readAsDataURL(t)}))}var bi=n(39626);class AvatarUploadService extends bi.u{constructor(e){super(),this.http=e}upload(e,t){return t.map((t=>this.uploadSingle(e,t)))}uploadSingle(e,t){const n=new FormData;return n.append("metadata",JSON.stringify({fileName:t.file.name})),n.append("file",t.file,t.file.name),this.http.request(t.method,e,{body:n,observe:"events",withCredentials:!0,responseType:"text",reportProgress:!0}).pipe((0,wn.u)())}static{this.ɵfac=function AvatarUploadService_Factory(e){return new(e||AvatarUploadService)(o.KVO(s.Qq))}}static{this.ɵprov=o.jDH({token:AvatarUploadService,factory:AvatarUploadService.ɵfac})}}const ki=["avatarFilePicker"],avatar_upload_form_component_c1=e=>({"-error":e});function AvatarUploadFormComponent_span_8_Template(e,t){if(1&e&&o.nrm(0,"span",6),2&e){const e=o.XpG();o.Y8G("textContent",e.text.wrong_file_format)}}function AvatarUploadFormComponent_fieldset_9_Template(e,t){if(1&e&&(o.j41(0,"fieldset",11),o.nrm(1,"legend",12)(2,"img",13),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.Y8G("textContent",e.text.preview),o.R7$(),o.Y8G("src",e.avatarPreviewUrl,o.B4B)}}class AvatarUploadFormComponent{constructor(e,t,n,i,o){this.I18n=e,this.elementRef=t,this.cdRef=n,this.toastService=i,this.uploadService=o,this.busy=!1,this.fileInvalid=!1,this.text={label_choose_avatar:this.I18n.t("js.avatars.label_choose_avatar"),upload_instructions:this.I18n.t("js.avatars.text_upload_instructions"),error_too_large:this.I18n.t("js.avatars.error_image_too_large"),wrong_file_format:this.I18n.t("js.avatars.wrong_file_format"),button_update:this.I18n.t("js.button_update"),uploading:this.I18n.t("js.avatars.uploading_avatar"),preview:this.I18n.t("js.label_preview")}}ngOnInit(){const e=this.elementRef.nativeElement;this.target=e.getAttribute("target")||"",this.method=e.getAttribute("method")||""}onFilePickerChanged(e){const t=this.avatarFilePicker.nativeElement.files;if(null===t||0===t.length)return;const n=t[0];if(-1===["image/jpeg","image/png","image/gif"].indexOf(n.type))return this.fileInvalid=!0,void this.cdRef.detectChanges();resizeFile(128,n).then((([e,t])=>{this.avatarFile=new File([t],n.name),this.avatarPreviewUrl=e,this.fileInvalid=!1,this.cdRef.detectChanges()}))}uploadAvatar(e){e.preventDefault(),this.busy=!0;const t={file:this.avatarFile,method:this.method},n=this.uploadService.upload(this.target,[t])[0];this.toastService.addUpload(this.text.uploading,[[this.avatarFile,n]]),n.subscribe((e=>{switch(e.type){case 0:break;case 4:this.busy=!1,window.location.reload()}}),(e=>{this.toastService.addError(e),this.busy=!1}))}static{this.ɵfac=function AvatarUploadFormComponent_Factory(e){return new(e||AvatarUploadFormComponent)(o.rXU(w.W),o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(R.fw),o.rXU(bi.u))}}static{this.ɵcmp=o.VBU({type:AvatarUploadFormComponent,selectors:[["opce-avatar-upload-form"]],viewQuery:function AvatarUploadFormComponent_Query(e,t){if(1&e&&o.GBs(ki,7),2&e){let e;o.mGM(e=o.lsd())&&(t.avatarFilePicker=e.first)}},features:[o.Jv_([{provide:bi.u,useClass:AvatarUploadService}])],decls:11,vars:9,consts:[["avatarFilePicker",""],[1,"form--field"],["for","avatar_file_input",1,"form--label",3,"ngClass","textContent"],[1,"form--field-container"],["type","file","accept","image/jpeg,image/png,image/gif","id","avatar_file_input","name","avatar_file_input",3,"change"],[1,"form--field-instructions"],[3,"textContent"],[1,"avatars--error-pane"],[3,"textContent",4,"ngIf"],["class","preview",4,"ngIf"],["type","submit",1,"button","-primary","-with-icon","icon-checkmark",3,"click","textContent"],[1,"preview"],[1,"preview--legend",3,"textContent"],[1,"avatars--local-avatar-preview",3,"src"]],template:function AvatarUploadFormComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",1),o.nrm(1,"label",2),o.j41(2,"div",3)(3,"input",4,0),o.bIt("change",(function AvatarUploadFormComponent_Template_input_change_3_listener(n){return o.eBV(e),o.Njj(t.onFilePickerChanged(n))})),o.k0s()(),o.j41(5,"div",5),o.nrm(6,"span",6),o.j41(7,"div",7),o.DNE(8,AvatarUploadFormComponent_span_8_Template,1,1,"span",8),o.k0s()()(),o.DNE(9,AvatarUploadFormComponent_fieldset_9_Template,3,2,"fieldset",9),o.j41(10,"button",10),o.bIt("click",(function AvatarUploadFormComponent_Template_button_click_10_listener(n){return o.eBV(e),o.Njj(t.uploadAvatar(n))})),o.k0s()}2&e&&(o.R7$(),o.Y8G("ngClass",o.eq3(7,avatar_upload_form_component_c1,t.fileInvalid))("textContent",t.text.label_choose_avatar),o.R7$(5),o.Y8G("textContent",t.text.upload_instructions),o.R7$(2),o.Y8G("ngIf",t.fileInvalid),o.R7$(),o.Y8G("ngIf",t.avatarPreviewUrl),o.R7$(),o.Y8G("textContent",t.text.button_update),o.BMQ("disabled",!t.avatarFile||t.busy||void 0))},dependencies:[P.YU,P.bT],encapsulation:2,changeDetection:0})}}n(99585);var vi=n(45764);function registerCustomElement(e,t,n){const i=(0,vi.gw)(t,n);customElements.get(e)?(0,mi.cY)(`${e} custom element already registered.`):customElements.define(e,i)}class openproject_avatars_main_PluginModule{constructor(e){registerCustomElement("opce-avatar-upload-form",AvatarUploadFormComponent,{injector:e})}static{this.ɵfac=function PluginModule_Factory(e){return new(e||openproject_avatars_main_PluginModule)(o.KVO(o.zZn))}}static{this.ɵmod=o.$C({type:openproject_avatars_main_PluginModule})}static{this.ɵinj=o.G2t({imports:[P.MD]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(openproject_avatars_main_PluginModule,{declarations:[AvatarUploadFormComponent],imports:[P.MD]});class DocumentBaseResource extends Ft.q{constructor(){super(...arguments),this.attachmentsBackend=!1}}const Ci=(0,_i.o)(DocumentBaseResource);class openproject_documents_main_PluginModule{constructor(){!function initializeDocumentPlugin(){window.OpenProject.getPluginContext().then((e=>{e.services.halResource.registerResource("Document",{cls:Ci});const{states:t}=e.services;t.add("documents",(0,gi.Iy)())}))}()}static{this.ɵfac=function PluginModule_Factory(e){return new(e||openproject_documents_main_PluginModule)}}static{this.ɵmod=o.$C({type:openproject_documents_main_PluginModule})}static{this.ɵinj=o.G2t({})}}var yi=n(33924),wi=(n(68643),n(67369)),Ti=n(12494);class GitActionsService{sanitizeBranchString(e){return e.replace(/&/g,"and ").replace(/ +/g,"-").replace(/[\000-\039]/g,"").replace(/\177/g,"").replace(/[#\\\/\?\*\~\^\:\{\}@\.\[\]'"]/g,"").replace(/^[-]+/g,"").replace(/[-]+$/g,"").replace(/-+/g,"-").trim()}formattingInput(e){const t=e.type.name||"",n=e.id||"";return{id:n,type:t,title:e.subject,url:window.location.origin+e.pathHelper.workPackagePath(n),description:""}}sanitizeShellInput(e){return`${e.replace(/'/g,"\\'")}`}branchName(e){const{type:t,id:n,title:i}=this.formattingInput(e);return`${this.sanitizeBranchString(t)}/${n}-${this.sanitizeBranchString(i)}`.toLocaleLowerCase()}commitMessage(e){const{title:t,id:n,description:i,url:o}=this.formattingInput(e);return`[#${n}] ${t}\n\n${i}\n\n${o}\n`.replace(/\n\n+/g,"\n\n")}commitMessageDisplayText(e){return this.commitMessage(e).replace(/\n\n/g," ")}gitCommand(e){const t=this.branchName(e),n=this.commitMessage(e);return`git checkout -b '${this.sanitizeShellInput(t)}' && git commit --allow-empty -m '${this.sanitizeShellInput(n)}'`}static{this.ɵfac=function GitActionsService_Factory(e){return new(e||GitActionsService)}}static{this.ɵprov=o.jDH({token:GitActionsService,factory:GitActionsService.ɵfac,providedIn:"root"})}}var Si=n(23941),ji=n(93743);function GitActionsMenuComponent_div_3_div_8_Template(e,t){if(1&e&&o.nrm(0,"div",11),2&e){const e=o.XpG(2);o.Y8G("textContent",e.lastCopyResult)}}function GitActionsMenuComponent_div_3_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",3)(1,"label",4)(2,"div",5),o.EFF(3),o.k0s(),o.j41(4,"div",6),o.nrm(5,"input",7),o.j41(6,"button",8),o.bIt("click",(function GitActionsMenuComponent_div_3_Template_button_click_6_listener(){const t=o.eBV(e).$implicit,n=o.XpG();return o.Njj(n.onCopyButtonClick(t))})),o.nrm(7,"span",9),o.k0s(),o.DNE(8,GitActionsMenuComponent_div_3_div_8_Template,1,1,"div",10),o.k0s()()()}if(2&e){const e=t.$implicit,n=o.XpG();o.R7$(3),o.JRh(e.name),o.R7$(2),o.Y8G("value",e.textToDisplay()),o.R7$(),o.BMQ("aria-label",n.text.copyButtonHelpText),o.R7$(2),o.Y8G("ngIf",n.showCopyResult&&e.id===n.copiedSnippetId)}}class GitActionsMenuComponent extends Si.n{constructor(e,t,n){super(e),this.locals=e,this.I18n=t,this.gitActions=n,this.text={title:this.I18n.t("js.github_integration.tab_header.git_actions.title"),copyButtonHelpText:this.I18n.t("js.github_integration.tab_header.git_actions.copy_button_help"),copyResult:{success:this.I18n.t("js.github_integration.tab_header.git_actions.copy_success"),error:this.I18n.t("js.github_integration.tab_header.git_actions.copy_error")}},this.lastCopyResult=this.text.copyResult.success,this.showCopyResult=!1,this.copiedSnippetId="",this.snippets=[{id:"branch",name:this.I18n.t("js.github_integration.tab_header.git_actions.branch_name"),textToDisplay:()=>this.gitActions.branchName(this.workPackage),textToCopy:()=>this.gitActions.branchName(this.workPackage)},{id:"message",name:this.I18n.t("js.github_integration.tab_header.git_actions.commit_message"),textToDisplay:()=>this.gitActions.commitMessageDisplayText(this.workPackage),textToCopy:()=>this.gitActions.commitMessage(this.workPackage)},{id:"command",name:this.I18n.t("js.github_integration.tab_header.git_actions.cmd"),textToDisplay:()=>this.gitActions.gitCommand(this.workPackage),textToCopy:()=>this.gitActions.gitCommand(this.workPackage)}],this.workPackage=this.locals.workPackage}onCopyButtonClick(e){const t=(0,Ti.A)(e.textToCopy());this.lastCopyResult=t?this.text.copyResult.success:this.text.copyResult.error,this.copiedSnippetId=e.id,this.showCopyResult=!0,window.setTimeout((()=>{this.showCopyResult=!1}),2e3)}static{this.ɵfac=function GitActionsMenuComponent_Factory(e){return new(e||GitActionsMenuComponent)(o.rXU(ji.P),o.rXU(w.W),o.rXU(GitActionsService))}}static{this.ɵcmp=o.VBU({type:GitActionsMenuComponent,selectors:[["op-git-actions-menu"]],inputs:{workPackage:"workPackage"},features:[o.Vt3],decls:4,vars:2,consts:[[1,"git-actions-menu","dropdown-relative","dropdown","-overflow-in-view","dropdown-anchor-right"],[1,"title"],["class","copy-wrapper spot-form-field",4,"ngFor","ngForOf"],[1,"copy-wrapper","spot-form-field"],[1,"spot-form-field--label-wrap"],[1,"spot-form-field--label"],[1,"spot-form-field--input"],["type","text","readonly","true",1,"copy-content","op-input",3,"value"],["type","button",1,"button","copy-button",3,"click"],[1,"spot-icon","spot-icon_copy"],["class","copy-result-message",3,"textContent",4,"ngIf"],[1,"copy-result-message",3,"textContent"]],template:function GitActionsMenuComponent_Template(e,t){1&e&&(o.j41(0,"div",0)(1,"h3",1),o.EFF(2),o.k0s(),o.DNE(3,GitActionsMenuComponent_div_3_Template,9,4,"div",2),o.k0s()),2&e&&(o.R7$(2),o.JRh(t.text.title),o.R7$(),o.Y8G("ngForOf",t.snippets))},dependencies:[P.Sq,P.bT],styles:['.git-actions-menu[_ngcontent-%COMP%]{background-color:var(--body-background);border:1px solid var(--borderColor-default);padding:1rem 1rem 2rem;min-width:25rem;box-shadow:.1em .1em .4em #0000001a}.git-actions-menu[_ngcontent-%COMP%]   .copy-wrapper[_ngcontent-%COMP%]{width:100%;position:relative;margin-bottom:1rem}.git-actions-menu[_ngcontent-%COMP%]   .copy-content[_ngcontent-%COMP%]{width:calc(100% - 3em);min-height:calc(2.2em + 1px);border-radius:2px 0 0 2px;padding:.65em;color:var(--fgColor-muted);white-space:pre;resize:none;font-size:.9rem;display:inline-block}.git-actions-menu[_ngcontent-%COMP%]   .copy-button[_ngcontent-%COMP%]{margin:0;border:1px solid var(--borderColor-default);border-radius:0 2px 2px 0;vertical-align:top;left:-1px;position:relative;font-size:.9rem}.git-actions-menu[_ngcontent-%COMP%]   .copy-button[_ngcontent-%COMP%]:hover{background:var(--button--background-hover-color);color:var(--button--font-color)}.git-actions-menu[_ngcontent-%COMP%]   .copy-result-message[_ngcontent-%COMP%]{background-color:var(--main-menu-bg-color);display:inline-block;padding:.5em;border-radius:5px;color:var(--main-menu-font-color);position:absolute;right:0;top:calc(2.2em + 10px);box-shadow:1px 1px 4px var(--fgColor-muted);z-index:1}.git-actions-menu[_ngcontent-%COMP%]   .copy-result-message[_ngcontent-%COMP%]:before{content:"";border-bottom:.6em solid var(--main-menu-bg-color);height:0;width:0;position:absolute;top:-9px;right:10px;border-left:.3em solid transparent;border-right:.3em solid transparent}']})}}class GitActionsMenuDirective extends l.i{constructor(e,t){super(e,t),this.elementRef=e,this.opContextMenu=t}open(e){this.opContextMenu.show(this,e,GitActionsMenuComponent)}get locals(){return{workPackage:this.workPackage,contextMenuId:"github-integration-git-actions-menu",items:[]}}static{this.ɵfac=function GitActionsMenuDirective_Factory(e){return new(e||GitActionsMenuDirective)(o.rXU(o.aKT),o.rXU(wi.V))}}static{this.ɵdir=o.FsC({type:GitActionsMenuDirective,selectors:[["","gitActionsCopyDropdown",""]],inputs:{workPackage:[o.Mj6.None,"gitActionsCopyDropdown-workPackage","workPackage"]},features:[o.Vt3]})}}class TabHeaderComponent{constructor(e){this.I18n=e,this.text={title:this.I18n.t("js.github_integration.tab_header.title"),createPrButtonLabel:this.I18n.t("js.github_integration.tab_header.create_pr.label"),createPrButtonDescription:this.I18n.t("js.github_integration.tab_header.create_pr.description"),gitMenuLabel:this.I18n.t("js.github_integration.tab_header.copy_menu.label"),gitMenuDescription:this.I18n.t("js.github_integration.tab_header.copy_menu.description")}}static{this.ɵfac=function TabHeaderComponent_Factory(e){return new(e||TabHeaderComponent)(o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:TabHeaderComponent,selectors:[["tab-header"]],inputs:{workPackage:"workPackage"},decls:10,vars:4,consts:[[1,"github-pr-header","op-tab-content--header"],[1,"title"],["icon-classes","button--icon icon-merge-branch"],[1,"toolbar-items","hide-when-print"],[1,"toolbar-item"],["type","button","gitActionsCopyDropdown","",1,"button","github-git-copy",3,"gitActionsCopyDropdown-workPackage"],["icon-classes","button--icon icon-console-light"],["aria-hidden","true",1,"button--text",3,"textContent"],["icon-classes","button--icon icon-small icon-pulldown hidden-for-mobile"]],template:function TabHeaderComponent_Template(e,t){1&e&&(o.j41(0,"div",0)(1,"h3",1),o.nrm(2,"op-icon",2),o.EFF(3),o.k0s(),o.j41(4,"ul",3)(5,"li",4)(6,"button",5),o.nrm(7,"op-icon",6)(8,"span",7)(9,"op-icon",8),o.k0s()()()()),2&e&&(o.R7$(3),o.SpI(" ",t.text.title," "),o.R7$(3),o.Y8G("gitActionsCopyDropdown-workPackage",t.workPackage),o.BMQ("aria-label",t.text.gitMenuDescription),o.R7$(2),o.Y8G("textContent",t.text.gitMenuLabel))},dependencies:[Le.i,GitActionsMenuDirective],styles:[".github-pr-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex:1 1 auto;border-bottom:0;margin:0;padding:0;font-weight:var(--base-text-weight-bold);font-size:1rem;line-height:32px;text-transform:uppercase}"]})}}var Pi=n(57678),Ii=n(51132);let xi=class GithubPullRequestsStore extends Pi.D_{constructor(){super((0,Ii.gB)())}};xi=(0,U.Cg)([(0,Pi.g7)({name:"github-pull-requests"}),(0,U.Sn)("design:paramtypes",[])],xi);var Ri=n(94529);class GithubPullRequestResourceService extends Ri.L{ofWorkPackage(e){const t=this.workPackagePullRequestsPath(e.id);return this.requireCollection(t)}requireSingle(e){return this.requireEntity(this.entityPath(e))}basePath(){return this.apiV3Service.github_pull_requests.path}entityPath(e){return this.apiV3Service.github_pull_requests.id(e).path}workPackagePullRequestsPath(e){return this.apiV3Service.work_packages.id(e).github_pull_requests.path}createStore(){return new xi}static{this.ɵfac=(()=>{let e;return function GithubPullRequestResourceService_Factory(t){return(e||(e=o.xGo(GithubPullRequestResourceService)))(t||GithubPullRequestResourceService)}})()}static{this.ɵprov=o.jDH({token:GithubPullRequestResourceService,factory:GithubPullRequestResourceService.ɵfac})}}var Fi=n(2731);class PullRequestStateComponent{constructor(e,t){this.PathHelper=e,this.I18n=t,this.small=!1}ngOnInit(){this.displayText=this.I18n.t(`js.github_integration.pull_requests.states.${this.state}`,{defaultValue:this.state||"(unknown state)"})}static{this.ɵfac=function PullRequestStateComponent_Factory(e){return new(e||PullRequestStateComponent)(o.rXU(B.B),o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:PullRequestStateComponent,selectors:[["op-github-pull-request-state"]],inputs:{state:"state",small:"small"},decls:3,vars:4,consts:[[1,"op-pull-request-state",3,"ngClass"],["icon-classes","button--icon icon-merge-branch"]],template:function PullRequestStateComponent_Template(e,t){1&e&&(o.j41(0,"span",0),o.nrm(1,"op-icon",1),o.EFF(2),o.k0s()),2&e&&(o.AVh("op-pull-request-state_small",t.small),o.Y8G("ngClass","op-pull-request-state_"+t.state),o.R7$(2),o.SpI(" ",t.displayText,"\n"))},dependencies:[P.YU,Le.i],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-pull-request-state[_ngcontent-%COMP%]{display:inline-block;padding:8px 11px;border-radius:16px;color:#fff;font-size:.9rem;text-transform:capitalize;background-color:#6a737d}.op-pull-request-state_small[_ngcontent-%COMP%]{padding:0 10px;font-size:.75rem}.op-pull-request-state_opened[_ngcontent-%COMP%], .op-pull-request-state_open[_ngcontent-%COMP%]{background-color:#28a745}.op-pull-request-state_merged[_ngcontent-%COMP%]{background-color:#6f42c1}.op-pull-request-state_closed[_ngcontent-%COMP%]{background-color:#d73a49}.op-pull-request-state_deployed[_ngcontent-%COMP%]{background-color:#d73af9}"],changeDetection:0})}}function PullRequestComponent_div_4_Template(e,t){if(1&e&&(o.j41(0,"div",9),o.nrm(1,"img",10)(2,"a",11),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.Y8G("src",e.pullRequest._embedded.githubUser.avatarUrl,o.B4B),o.R7$(),o.Y8G("href",e.pullRequest._embedded.githubUser.htmlUrl,o.B4B)("textContent",e.pullRequest._embedded.githubUser.login)}}function PullRequestComponent_span_11_Template(e,t){if(1&e&&o.nrm(0,"span",12),2&e){const e=o.XpG();o.Y8G("textContent",e.text.label_actions)}}function PullRequestComponent_ul_12_li_1_Template(e,t){if(1&e&&(o.j41(0,"li",15)(1,"span",16),o.nrm(2,"op-icon",17),o.k0s(),o.j41(3,"span",18),o.nrm(4,"img",19),o.k0s(),o.j41(5,"span",20),o.nrm(6,"span",21)(7,"span",22),o.k0s(),o.j41(8,"span",23)(9,"a",24),o.EFF(10),o.k0s()()()),2&e){const e=t.$implicit,n=o.XpG(2);o.R7$(),o.Y8G("ngClass","op-pr-check--state-icon_"+n.checkRunState(e)),o.R7$(),o.Mz_("icon-classes","icon-",n.checkRunStateIcon(e),""),o.Y8G("icon-title",n.checkRunStateText(e)),o.R7$(2),o.Y8G("src",e.appOwnerAvatarUrl,o.B4B),o.R7$(2),o.Y8G("textContent",e.name),o.R7$(),o.Y8G("textContent",n.checkRunStateText(e)),o.R7$(2),o.Y8G("href",e.detailsUrl,o.B4B),o.R7$(),o.SpI(" ",n.text.label_details," ")}}function PullRequestComponent_ul_12_Template(e,t){if(1&e&&(o.j41(0,"ul",13),o.DNE(1,PullRequestComponent_ul_12_li_1_Template,11,9,"li",14),o.k0s()),2&e){const e=o.XpG();o.BMQ("aria-label",e.text.label_actions),o.R7$(),o.Y8G("ngForOf",e.pullRequest._embedded.checkRuns)}}class PullRequestComponent{constructor(e,t){this.PathHelper=e,this.I18n=t,this.className=!0,this.text={label_created_by:this.I18n.t("js.label_created_by"),label_last_updated_on:this.I18n.t("js.label_last_updated_on"),label_details:this.I18n.t("js.label_details"),label_actions:this.I18n.t("js.github_integration.github_actions")}}get state(){return"open"===this.pullRequest.state?this.pullRequest.draft?"draft":"open":"deployed"===this.pullRequest.state?"deployed":this.pullRequest.merged?"merged":"closed"}checkRunStateText(e){return e.outputTitle||e.conclusion||e.status}checkRunState(e){return e.conclusion||e.status}checkRunStateIcon(e){switch(this.checkRunState(e)){case"success":return"checkmark";case"queued":return"getting-started";case"in_progress":return"loading1";case"failure":return"cancel";case"timed_out":return"reminder";case"action_required":return"warning";case"stale":default:return"not-supported";case"skipped":return"redo";case"neutral":case"cancelled":return"minus1"}}static{this.ɵfac=function PullRequestComponent_Factory(e){return new(e||PullRequestComponent)(o.rXU(B.B),o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:PullRequestComponent,selectors:[["op-github-pull-request"]],hostVars:2,hostBindings:function PullRequestComponent_HostBindings(e,t){2&e&&o.AVh("op-pull-request",t.className)},inputs:{pullRequest:"pullRequest"},decls:13,vars:10,consts:[["target","blank",1,"op-pull-request--link",3,"href","textContent"],[1,"op-pull-request--title",3,"textContent"],[1,"op-pull-request--info"],["class","op-principal",4,"ngIf"],[1,"op-pull-request--date"],[3,"dateTimeValue"],[1,"op-pull-request--state",3,"state"],["class","op-pull-request--checks-label",3,"textContent",4,"ngIf"],["class","op-pull-request--checks",4,"ngIf"],[1,"op-principal"],["alt","PR author avatar",1,"op-pull-request--avatar","op-avatar","op-avatar_mini","op-principal--avatar",3,"src"],[1,"op-principal--name",3,"href","textContent"],[1,"op-pull-request--checks-label",3,"textContent"],[1,"op-pull-request--checks"],["class","op-pr-check",4,"ngFor","ngForOf"],[1,"op-pr-check"],[1,"op-pr-check--state-icon",3,"ngClass"],[3,"icon-classes","icon-title"],[1,"op-pr-check--avatar"],["alt","app owner avatar",3,"src"],[1,"op-pr-check--info"],[1,"op-pr-check--name",3,"textContent"],[1,"op-pr-check--state",3,"textContent"],[1,"op-pr-check--details"],[3,"href"]],template:function PullRequestComponent_Template(e,t){1&e&&(o.nrm(0,"a",0)(1,"div",1),o.j41(2,"div",2),o.EFF(3),o.DNE(4,PullRequestComponent_div_4_Template,3,3,"div",3),o.EFF(5," . "),o.j41(6,"span",4),o.EFF(7),o.nrm(8,"op-date-time",5),o.k0s(),o.EFF(9,".\n"),o.k0s(),o.nrm(10,"op-github-pull-request-state",6),o.DNE(11,PullRequestComponent_span_11_Template,1,1,"span",7)(12,PullRequestComponent_ul_12_Template,2,2,"ul",8)),2&e&&(o.Y8G("href",t.pullRequest.htmlUrl,o.B4B)("textContent",t.pullRequest.repository+"#"+t.pullRequest.number),o.R7$(),o.Y8G("textContent",t.pullRequest.title),o.R7$(2),o.SpI(" ",t.text.label_created_by," "),o.R7$(),o.Y8G("ngIf",t.pullRequest._embedded.githubUser),o.R7$(3),o.SpI(" ",t.text.label_last_updated_on," "),o.R7$(),o.Y8G("dateTimeValue",t.pullRequest.githubUpdatedAt),o.R7$(2),o.Y8G("state",t.state),o.R7$(),o.Y8G("ngIf",null==t.pullRequest._embedded.checkRuns?null:t.pullRequest._embedded.checkRuns.length),o.R7$(),o.Y8G("ngIf",null==t.pullRequest._embedded.checkRuns?null:t.pullRequest._embedded.checkRuns.length))},dependencies:[P.YU,P.Sq,P.bT,Le.i,Fi.U,PullRequestStateComponent],styles:['.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}[_nghost-%COMP%], .op-pull-request[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr auto auto;grid-template-areas:"link link link link" "title title title state" "info info info info" "checks-label checks-label checks-label checks-label" "checks checks checks checks";align-items:center;margin-bottom:11px;padding-bottom:11px;border-bottom:1px solid #dddddd}[_nghost-%COMP%]:last-child, .op-pull-request[_ngcontent-%COMP%]:last-child{border-bottom:none}--title[_nghost-%COMP%], .op-pull-request--title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;font-weight:var(--base-text-weight-bold);grid-area:title;line-height:32px;margin-right:20px}--info[_nghost-%COMP%], .op-pull-request--info[_ngcontent-%COMP%]{display:inline-flex;grid-area:info;color:var(--fgColor-muted)}--avatar[_nghost-%COMP%], --date[_nghost-%COMP%], .op-pull-request--avatar[_ngcontent-%COMP%], .op-pull-request--date[_ngcontent-%COMP%]{margin-left:.25rem}--link[_nghost-%COMP%], .op-pull-request--link[_ngcontent-%COMP%]{grid-area:link;margin-top:6px}--state[_nghost-%COMP%], .op-pull-request--state[_ngcontent-%COMP%]{grid-area:state}--checks-label[_nghost-%COMP%], .op-pull-request--checks-label[_ngcontent-%COMP%]{grid-area:checks-label;margin-top:12px;font-weight:var(--base-text-weight-bold)}--checks[_nghost-%COMP%], .op-pull-request--checks[_ngcontent-%COMP%]{margin-top:12px;margin-left:0;grid-area:checks}','.op-pr-check[_ngcontent-%COMP%]{display:grid;grid-row:span 4;grid-template-columns:28px 33px 1fr auto;grid-template-areas:"check-state-icon check-avatar check-info check-details";list-style-type:none;border:1px solid var(--borderColor-default);padding:.3rem 1rem;background:#0000000d;font-size:.9rem}.op-pr-check[_ngcontent-%COMP%]:first-child{border-top-right-radius:5px;border-top-left-radius:5px}.op-pr-check[_ngcontent-%COMP%]:last-child{border-bottom-right-radius:5px;border-bottom-left-radius:5px}.op-pr-check--avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{grid-area:check-avatar;display:inline-block;width:22px;height:22px;margin-right:5px;border-radius:var(--user-avatar-border-radius)}.op-pr-check--info[_ngcontent-%COMP%]{grid-area:check-info}.op-pr-check--state[_ngcontent-%COMP%]{color:var(--fgColor-muted);font-style:italic;margin-left:1em}.op-pr-check--state-icon[_ngcontent-%COMP%]{grid-area:check-state-icon}.op-pr-check--state-icon_queued[_ngcontent-%COMP%]{color:#5f9ea0}.op-pr-check--state-icon_in_progress[_ngcontent-%COMP%]{color:orange}.op-pr-check--state-icon_success[_ngcontent-%COMP%]{color:green}.op-pr-check--state-icon_failure[_ngcontent-%COMP%], .op-pr-check--state-icon_timed_out[_ngcontent-%COMP%], .op-pr-check--state-icon_action_required[_ngcontent-%COMP%], .op-pr-check--state-icon_stale[_ngcontent-%COMP%]{color:red}.op-pr-check--state-icon_skipped[_ngcontent-%COMP%], .op-pr-check--state-icon_neutral[_ngcontent-%COMP%], .op-pr-check--state-icon_cancelled[_ngcontent-%COMP%]{color:gray}.op-pr-check--details[_ngcontent-%COMP%]{grid-area:check-details}'],changeDetection:0})}}function TabPrsComponent_ng_container_0_Template(e,t){if(1&e&&(o.qex(0),o.nrm(1,"p",2),o.bVm()),2&e){const e=o.XpG();o.R7$(),o.Y8G("innerHTML",e.emptyText,o.npT)}}function TabPrsComponent_op_github_pull_request_2_Template(e,t){if(1&e&&o.nrm(0,"op-github-pull-request",3),2&e){const e=t.$implicit;o.Y8G("pullRequest",e)}}class TabPrsComponent{constructor(e,t,n){this.I18n=e,this.apiV3Service=t,this.githubPullRequests=n,this.className=!0}ngOnInit(){this.emptyText=this.I18n.t("js.github_integration.tab_prs.empty",{wp_id:this.workPackage.id}),this.pullRequests$=this.githubPullRequests.ofWorkPackage(this.workPackage).pipe((0,G.T)((e=>_.sortBy(e,"updatedAt"))),(0,Tn.t)(1))}static{this.ɵfac=function TabPrsComponent_Factory(e){return new(e||TabPrsComponent)(o.rXU(w.W),o.rXU(O.n),o.rXU(GithubPullRequestResourceService))}}static{this.ɵcmp=o.VBU({type:TabPrsComponent,selectors:[["op-tab-prs"]],hostVars:2,hostBindings:function TabPrsComponent_HostBindings(e,t){2&e&&o.AVh("op-github-prs",t.className)},inputs:{workPackage:"workPackage"},decls:4,vars:6,consts:[[4,"ngIf"],[3,"pullRequest",4,"ngFor","ngForOf"],[1,"op-tab-content--text-box",3,"innerHTML"],[3,"pullRequest"]],template:function TabPrsComponent_Template(e,t){if(1&e&&(o.DNE(0,TabPrsComponent_ng_container_0_Template,2,1,"ng-container",0),o.nI1(1,"async"),o.DNE(2,TabPrsComponent_op_github_pull_request_2_Template,1,1,"op-github-pull-request",1),o.nI1(3,"async")),2&e){let e;o.Y8G("ngIf",0===(null==(e=o.bMT(1,2,t.pullRequests$))?null:e.length)),o.R7$(2),o.Y8G("ngForOf",o.bMT(3,4,t.pullRequests$))}},dependencies:[P.Sq,P.bT,PullRequestComponent,P.Jj],encapsulation:2,changeDetection:0})}}class GitHubTabComponent{constructor(e,t){this.PathHelper=e,this.I18n=t}static{this.ɵfac=function GitHubTabComponent_Factory(e){return new(e||GitHubTabComponent)(o.rXU(B.B),o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:GitHubTabComponent,selectors:[["github-tab"]],inputs:{workPackage:"workPackage"},decls:2,vars:2,consts:[[3,"workPackage"]],template:function GitHubTabComponent_Template(e,t){1&e&&o.nrm(0,"tab-header",0)(1,"op-tab-prs",0),2&e&&(o.Y8G("workPackage",t.workPackage),o.R7$(),o.Y8G("workPackage",t.workPackage))},dependencies:[TabHeaderComponent,TabPrsComponent],encapsulation:2})}}function PullRequestMacroComponent_div_0_Template(e,t){if(1&e&&(o.j41(0,"div",2),o.nrm(1,"op-github-pull-request-state",3)(2,"span",4),o.nI1(3,"async"),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.Y8G("small",!0)("state",e.pullRequestState),o.R7$(),o.Y8G("innerHTML",o.bMT(3,3,e.displayText$),o.npT)}}function PullRequestMacroComponent_ng_template_2_Template(e,t){1&e&&(o.j41(0,"op-content-loader",5),o.qSk(),o.nrm(1,"rect",6),o.k0s())}class PullRequestMacroComponent{constructor(e,t,n,i){this.elementRef=e,this.injector=t,this.pullRequests=n,this.I18n=i,(0,Ot.w)(this)}ngOnInit(){this.pullRequest$=this.pullRequests.requireSingle(this.pullRequestId),this.displayText$=this.pullRequest$.pipe((0,G.T)((e=>this.buildText(e))))}buildText(e){const t=this.deriveActor(e);if(!t)return null;const n=this.htmlLink(t.htmlUrl,t.login),i=this.htmlLink(e.repositoryHtmlUrl,e.repository),o=this.htmlLink(e.htmlUrl,e.title),r=this.deriveMessage();return this.I18n.t(`js.github_integration.pull_requests.${r}`,{pr_number:e.number,pr_link:o,repository_link:i,pr_state:this.I18n.t(`js.github_integration.pull_requests.states.${this.pullRequestState}`,{defaultValue:this.pullRequestState||"(unknown state)"}),github_user_link:n})}deriveActor(e){return"merged"===this.pullRequestState?e._embedded.mergedBy:e._embedded.githubUser}deriveMessage(){return"referenced"===this.pullRequestState?"referenced_message":"merged"===this.pullRequestState?"merged_message":"message"}htmlLink(e,t){const n=document.createElement("a");return n.href=e,n.textContent=t,n.outerHTML}static{this.ɵfac=function PullRequestMacroComponent_Factory(e){return new(e||PullRequestMacroComponent)(o.rXU(o.aKT),o.rXU(o.zZn),o.rXU(GithubPullRequestResourceService),o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:PullRequestMacroComponent,selectors:[["ng-component"]],inputs:{pullRequestId:"pullRequestId",pullRequestState:"pullRequestState"},features:[o.Jv_([Ge.p])],decls:4,vars:4,consts:[["loadingTemplate",""],["class","op-pull-request-macro",4,"ngIf","ngIfElse"],[1,"op-pull-request-macro"],[1,"op-pull-request-macro--state",3,"small","state"],[3,"innerHTML"],["viewBox","0 0 200 5"],["x","0","y","0","width","100%","height","5","rx","1"]],template:function PullRequestMacroComponent_Template(e,t){if(1&e&&(o.DNE(0,PullRequestMacroComponent_div_0_Template,4,5,"div",1),o.nI1(1,"async"),o.DNE(2,PullRequestMacroComponent_ng_template_2_Template,2,0,"ng-template",null,0,o.C5r)),2&e){const e=o.sdS(3);o.Y8G("ngIf",o.bMT(1,2,t.pullRequest$))("ngIfElse",e)}},dependencies:[P.bT,Yt.F,PullRequestStateComponent,P.Jj],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-pull-request-macro--state[_ngcontent-%COMP%]{display:inline-block;margin-right:.25rem}"],changeDetection:0})}}function workPackageGithubPrsCount(e,t){return t.get(GithubPullRequestResourceService).ofWorkPackage(e).pipe((0,G.T)((e=>e.length)))}class openproject_github_integration_main_PluginModule{constructor(e){!function initializeGithubIntegrationPlugin(e){e.get(yi.L).register({component:GitHubTabComponent,name:I18n.t("js.github_integration.work_packages.tab_name"),id:"github",displayable:e=>!!e.github,count:workPackageGithubPrsCount})}(e),registerCustomElement("opce-github-pull-request",PullRequestMacroComponent,{injector:e})}static{this.ɵfac=function PluginModule_Factory(e){return new(e||openproject_github_integration_main_PluginModule)(o.KVO(o.zZn))}}static{this.ɵmod=o.$C({type:openproject_github_integration_main_PluginModule})}static{this.ɵinj=o.G2t({providers:[GithubPullRequestResourceService],imports:[d.d,De.q]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(openproject_github_integration_main_PluginModule,{declarations:[GitHubTabComponent,TabHeaderComponent,TabPrsComponent,GitActionsMenuDirective,GitActionsMenuComponent,PullRequestComponent,PullRequestMacroComponent,PullRequestStateComponent],imports:[d.d,De.q],exports:[GitHubTabComponent,TabHeaderComponent,TabPrsComponent,GitActionsMenuDirective,GitActionsMenuComponent,PullRequestMacroComponent]});class git_actions_service_GitActionsService{sanitizeBranchString(e){return e.replace(/&/g,"and ").replace(/ +/g,"-").replace(/[\000-\039]/g,"").replace(/\177/g,"").replace(/[#\\\/\?\*\~\^\:\{\}@\.\[\]'"]/g,"").replace(/^[-]+/g,"").replace(/[-]+$/g,"").replace(/-+/g,"-").trim()}formattingInput(e){const t=e.type.name||"",n=e.id||"";return{id:n,type:t,title:e.subject,url:window.location.origin+e.pathHelper.workPackagePath(n),description:""}}sanitizeShellInput(e){return`${e.replace(/'/g,"\\'")}`}branchName(e){const{type:t,id:n,title:i}=this.formattingInput(e);return`${this.sanitizeBranchString(t)}/${n}-${this.sanitizeBranchString(i)}`.toLocaleLowerCase()}commitMessage(e){const{title:t,id:n,description:i,url:o}=this.formattingInput(e);return`OP#${n} ${t}\n\n${i}\n\n${o}\n`.replace(/\n\n+/g,"\n\n")}commitMessageDisplayText(e){return this.commitMessage(e).replace(/\n\n/g," ")}gitCommand(e){const t=this.branchName(e),n=this.commitMessage(e);return`git checkout -b '${this.sanitizeShellInput(t)}' && git commit --allow-empty -m '${this.sanitizeShellInput(n)}'`}static{this.ɵfac=function GitActionsService_Factory(e){return new(e||git_actions_service_GitActionsService)}}static{this.ɵprov=o.jDH({token:git_actions_service_GitActionsService,factory:git_actions_service_GitActionsService.ɵfac,providedIn:"root"})}}function git_actions_menu_component_GitActionsMenuComponent_div_3_div_8_Template(e,t){if(1&e&&o.nrm(0,"div",11),2&e){const e=o.XpG(2);o.Y8G("textContent",e.lastCopyResult)}}function git_actions_menu_component_GitActionsMenuComponent_div_3_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",3)(1,"label",4)(2,"div",5),o.EFF(3),o.k0s(),o.j41(4,"div",6),o.nrm(5,"input",7),o.j41(6,"button",8),o.bIt("click",(function GitActionsMenuComponent_div_3_Template_button_click_6_listener(){const t=o.eBV(e).$implicit,n=o.XpG();return o.Njj(n.onCopyButtonClick(t))})),o.nrm(7,"op-icon",9),o.k0s(),o.DNE(8,git_actions_menu_component_GitActionsMenuComponent_div_3_div_8_Template,1,1,"div",10),o.k0s()()()}if(2&e){const e=t.$implicit,n=o.XpG();o.R7$(3),o.JRh(e.name),o.R7$(2),o.Y8G("value",e.textToDisplay()),o.R7$(),o.BMQ("aria-label",n.text.copyButtonHelpText),o.R7$(2),o.Y8G("ngIf",n.showCopyResult&&e.id===n.copiedSnippetId)}}class git_actions_menu_component_GitActionsMenuComponent extends Si.n{constructor(e,t,n){super(e),this.locals=e,this.I18n=t,this.gitActions=n,this.text={title:this.I18n.t("js.gitlab_integration.tab_header_mr.git_actions.title"),copyButtonHelpText:this.I18n.t("js.gitlab_integration.tab_header_mr.git_actions.copy_button_help"),copyResult:{success:this.I18n.t("js.gitlab_integration.tab_header_mr.git_actions.copy_success"),error:this.I18n.t("js.gitlab_integration.tab_header_mr.git_actions.copy_error")}},this.lastCopyResult=this.text.copyResult.success,this.showCopyResult=!1,this.copiedSnippetId="",this.snippets=[{id:"branch",name:this.I18n.t("js.gitlab_integration.tab_header_mr.git_actions.branch_name"),textToDisplay:()=>this.gitActions.branchName(this.workPackage),textToCopy:()=>this.gitActions.branchName(this.workPackage)},{id:"message",name:this.I18n.t("js.gitlab_integration.tab_header_mr.git_actions.commit_message"),textToDisplay:()=>this.gitActions.commitMessageDisplayText(this.workPackage),textToCopy:()=>this.gitActions.commitMessage(this.workPackage)},{id:"command",name:this.I18n.t("js.gitlab_integration.tab_header_mr.git_actions.cmd"),textToDisplay:()=>this.gitActions.gitCommand(this.workPackage),textToCopy:()=>this.gitActions.gitCommand(this.workPackage)}],this.workPackage=this.locals.workPackage}onCopyButtonClick(e){const t=(0,Ti.A)(e.textToCopy());this.lastCopyResult=t?this.text.copyResult.success:this.text.copyResult.error,this.copiedSnippetId=e.id,this.showCopyResult=!0,window.setTimeout((()=>{this.showCopyResult=!1}),2e3)}static{this.ɵfac=function GitActionsMenuComponent_Factory(e){return new(e||git_actions_menu_component_GitActionsMenuComponent)(o.rXU(ji.P),o.rXU(w.W),o.rXU(git_actions_service_GitActionsService))}}static{this.ɵcmp=o.VBU({type:git_actions_menu_component_GitActionsMenuComponent,selectors:[["op-git-actions-menu"]],inputs:{workPackage:"workPackage"},features:[o.Vt3],decls:4,vars:2,consts:[[1,"git-actions-menu","dropdown-relative","dropdown","-overflow-in-view","dropdown-anchor-right"],[1,"title"],["class","copy-wrapper op-form-field",4,"ngFor","ngForOf"],[1,"copy-wrapper","op-form-field"],[1,"op-form-field--label-wrap"],[1,"op-form-field--label"],[1,"op-form-field--input"],["type","text","readonly","true",1,"copy-content","op-input",3,"value"],["type","button",1,"button","copy-button",3,"click"],["icon-classes","button--icon icon-copy"],["class","copy-result-message",3,"textContent",4,"ngIf"],[1,"copy-result-message",3,"textContent"]],template:function GitActionsMenuComponent_Template(e,t){1&e&&(o.j41(0,"div",0)(1,"h3",1),o.EFF(2),o.k0s(),o.DNE(3,git_actions_menu_component_GitActionsMenuComponent_div_3_Template,9,4,"div",2),o.k0s()),2&e&&(o.R7$(2),o.JRh(t.text.title),o.R7$(),o.Y8G("ngForOf",t.snippets))},dependencies:[P.Sq,P.bT,Le.i],styles:['.git-actions-menu[_ngcontent-%COMP%]{background-color:var(--body-background);border:var(--content-default-border-width) solid var(--content-default-border-color);padding:1rem 1rem 2rem;min-width:25rem;box-shadow:.1em .1em .4em #0000001a}.git-actions-menu[_ngcontent-%COMP%]   .copy-wrapper[_ngcontent-%COMP%]{width:100%;position:relative;margin-bottom:1rem}.git-actions-menu[_ngcontent-%COMP%]   .copy-content[_ngcontent-%COMP%]{width:calc(100% - 3em);min-height:calc(2.2em + 1px);border-radius:2px 0 0 2px;padding:.65em;color:var(--gray-dark);white-space:pre;resize:none;font-size:.9rem;display:inline-block}.git-actions-menu[_ngcontent-%COMP%]   .copy-button[_ngcontent-%COMP%]{margin:0;border:1px solid #ccc;border-radius:0 2px 2px 0;vertical-align:top;left:-1px;position:relative;font-size:.9rem}.git-actions-menu[_ngcontent-%COMP%]   .copy-button[_ngcontent-%COMP%]:hover{border-color:#999}.git-actions-menu[_ngcontent-%COMP%]   .copy-result-message[_ngcontent-%COMP%]{background-color:var(--main-menu-bg-color);display:inline-block;padding:.5em;border-radius:5px;color:var(--main-menu-font-color);position:absolute;right:0;top:calc(2.2em + 10px);box-shadow:1px 1px 4px var(--gray-dark);z-index:1}.git-actions-menu[_ngcontent-%COMP%]   .copy-result-message[_ngcontent-%COMP%]:before{content:"";border-bottom:.6em solid var(--main-menu-bg-color);height:0;width:0;position:absolute;top:-9px;right:10px;border-left:.3em solid transparent;border-right:.3em solid transparent}']})}}class git_actions_menu_directive_GitActionsMenuDirective extends l.i{constructor(e,t){super(e,t),this.elementRef=e,this.opContextMenu=t}open(e){this.opContextMenu.show(this,e,git_actions_menu_component_GitActionsMenuComponent)}get locals(){return{workPackage:this.workPackage,contextMenuId:"gitlab-integration-git-actions-menu",items:[]}}static{this.ɵfac=function GitActionsMenuDirective_Factory(e){return new(e||git_actions_menu_directive_GitActionsMenuDirective)(o.rXU(o.aKT),o.rXU(wi.V))}}static{this.ɵdir=o.FsC({type:git_actions_menu_directive_GitActionsMenuDirective,selectors:[["","gitActionsCopyDropdown",""]],inputs:{workPackage:[o.Mj6.None,"gitActionsCopyDropdown-workPackage","workPackage"]},features:[o.Vt3]})}}class TabHeaderMrsComponent{constructor(e){this.I18n=e,this.text={title:this.I18n.t("js.gitlab_integration.tab_header_mr.title"),gitMenuLabel:this.I18n.t("js.gitlab_integration.tab_header_mr.copy_menu.label"),gitMenuDescription:this.I18n.t("js.gitlab_integration.tab_header_mr.copy_menu.description")}}static{this.ɵfac=function TabHeaderMrsComponent_Factory(e){return new(e||TabHeaderMrsComponent)(o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:TabHeaderMrsComponent,selectors:[["tab-header-mr"]],inputs:{workPackage:"workPackage"},decls:10,vars:4,consts:[[1,"gitlab-mr-header","op-tab-content--header"],["op-gitlab-merge-request-open-icon","","size","small"],[1,"title"],[1,"toolbar-items","hide-when-print"],[1,"toolbar-item"],["type","button","gitActionsCopyDropdown","",1,"button","gitlab-git-copy",3,"gitActionsCopyDropdown-workPackage"],["icon-classes","button--icon icon-console-light"],["aria-hidden","true",1,"button--text",3,"textContent"],["icon-classes","button--icon icon-small icon-pulldown hidden-for-mobile"]],template:function TabHeaderMrsComponent_Template(e,t){1&e&&(o.j41(0,"div",0),o.qSk(),o.nrm(1,"svg",1),o.joV(),o.j41(2,"h3",2),o.EFF(3),o.k0s(),o.j41(4,"ul",3)(5,"li",4)(6,"button",5),o.nrm(7,"op-icon",6)(8,"span",7)(9,"op-icon",8),o.k0s()()()()),2&e&&(o.R7$(3),o.SpI(" ",t.text.title," "),o.R7$(3),o.Y8G("gitActionsCopyDropdown-workPackage",t.workPackage),o.BMQ("aria-label",t.text.gitMenuDescription),o.R7$(2),o.Y8G("textContent",t.text.gitMenuLabel))},dependencies:[Le.i,Ze.YLs,git_actions_menu_directive_GitActionsMenuDirective],styles:[".gitlab-mr-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex:1 1 auto;border-bottom:0;margin:0;padding:0 0 0 4px;font-weight:700;font-size:1rem;line-height:32px;text-transform:uppercase;align-self:baseline}.gitlab-mr-header[_ngcontent-%COMP%]   .s16x32[_ngcontent-%COMP%]{width:16px;height:32px}"]})}}class TabHeaderIssueComponent{constructor(e){this.I18n=e,this.text={title:this.I18n.t("js.gitlab_integration.tab_header_issue.title")}}static{this.ɵfac=function TabHeaderIssueComponent_Factory(e){return new(e||TabHeaderIssueComponent)(o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:TabHeaderIssueComponent,selectors:[["tab-header-issue"]],inputs:{workPackage:"workPackage"},decls:4,vars:1,consts:[[1,"gitlab-issue-header","op-tab-content--header"],["op-gitlab-issue-open-icon","","size","small"],[1,"title"]],template:function TabHeaderIssueComponent_Template(e,t){1&e&&(o.j41(0,"div",0),o.qSk(),o.nrm(1,"svg",1),o.joV(),o.j41(2,"h3",2),o.EFF(3),o.k0s()()),2&e&&(o.R7$(3),o.SpI(" ",t.text.title," "))},dependencies:[Ze.QX2],styles:[".gitlab-issue-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex:1 1 auto;border-bottom:0;margin:0;padding:0 0 0 4px;font-weight:700;font-size:1rem;line-height:32px;text-transform:uppercase}.gitlab-issue-header[_ngcontent-%COMP%]   .s16x32[_ngcontent-%COMP%]{width:16px;height:32px}"]})}}const merge_request_component_c0=e=>({"background-color":e});function MergeRequestComponent__svg_svg_2_Template(e,t){1&e&&(o.qSk(),o.nrm(0,"svg",16))}function MergeRequestComponent__svg_svg_3_Template(e,t){1&e&&(o.qSk(),o.nrm(0,"svg",17))}function MergeRequestComponent__svg_svg_4_Template(e,t){1&e&&(o.qSk(),o.nrm(0,"svg",18))}function MergeRequestComponent__svg_svg_5_Template(e,t){1&e&&(o.qSk(),o.nrm(0,"svg",19))}function MergeRequestComponent_button_8_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"button",20),o.bIt("click",(function MergeRequestComponent_button_8_Template_button_click_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.toggleLabels(t.mergeRequest.number))})),o.qSk(),o.nrm(1,"svg",21),o.k0s()}}function MergeRequestComponent_span_9__svg_svg_1_Template(e,t){if(1&e&&(o.qSk(),o.nrm(0,"svg",35)),2&e){const e=o.XpG(2);o.Y8G("ngClass",e.pipelineIconClass)}}function MergeRequestComponent_span_9__svg_svg_2_Template(e,t){if(1&e&&(o.qSk(),o.nrm(0,"svg",36)),2&e){const e=o.XpG(2);o.Y8G("ngClass",e.pipelineIconClass)}}function MergeRequestComponent_span_9__svg_svg_3_Template(e,t){if(1&e&&(o.qSk(),o.nrm(0,"svg",37)),2&e){const e=o.XpG(2);o.Y8G("ngClass",e.pipelineIconClass)}}function MergeRequestComponent_span_9__svg_svg_4_Template(e,t){if(1&e&&(o.qSk(),o.nrm(0,"svg",38)),2&e){const e=o.XpG(2);o.Y8G("ngClass",e.pipelineIconClass)}}function MergeRequestComponent_span_9__svg_svg_5_Template(e,t){if(1&e&&(o.qSk(),o.nrm(0,"svg",39)),2&e){const e=o.XpG(2);o.Y8G("ngClass",e.pipelineIconClass)}}function MergeRequestComponent_span_9__svg_svg_6_Template(e,t){if(1&e&&(o.qSk(),o.nrm(0,"svg",40)),2&e){const e=o.XpG(2);o.Y8G("ngClass",e.pipelineIconClass)}}function MergeRequestComponent_span_9__svg_svg_7_Template(e,t){if(1&e&&(o.qSk(),o.nrm(0,"svg",41)),2&e){const e=o.XpG(2);o.Y8G("ngClass",e.pipelineIconClass)}}function MergeRequestComponent_span_9__svg_svg_8_Template(e,t){if(1&e&&(o.qSk(),o.nrm(0,"svg",42)),2&e){const e=o.XpG(2);o.Y8G("ngClass",e.pipelineIconClass)}}function MergeRequestComponent_span_9__svg_svg_9_Template(e,t){if(1&e&&(o.qSk(),o.nrm(0,"svg",43)),2&e){const e=o.XpG(2);o.Y8G("ngClass",e.pipelineIconClass)}}function MergeRequestComponent_span_9__svg_svg_10_Template(e,t){if(1&e&&(o.qSk(),o.nrm(0,"svg",44)),2&e){const e=o.XpG(2);o.Y8G("ngClass",e.pipelineIconClass)}}function MergeRequestComponent_span_9__svg_svg_11_Template(e,t){if(1&e&&(o.qSk(),o.nrm(0,"svg",45)),2&e){const e=o.XpG(2);o.Y8G("ngClass",e.pipelineIconClass)}}function MergeRequestComponent_span_9_Template(e,t){if(1&e&&(o.j41(0,"span",22),o.DNE(1,MergeRequestComponent_span_9__svg_svg_1_Template,1,1,"svg",23)(2,MergeRequestComponent_span_9__svg_svg_2_Template,1,1,"svg",24)(3,MergeRequestComponent_span_9__svg_svg_3_Template,1,1,"svg",25)(4,MergeRequestComponent_span_9__svg_svg_4_Template,1,1,"svg",26)(5,MergeRequestComponent_span_9__svg_svg_5_Template,1,1,"svg",27)(6,MergeRequestComponent_span_9__svg_svg_6_Template,1,1,"svg",28)(7,MergeRequestComponent_span_9__svg_svg_7_Template,1,1,"svg",29)(8,MergeRequestComponent_span_9__svg_svg_8_Template,1,1,"svg",30)(9,MergeRequestComponent_span_9__svg_svg_9_Template,1,1,"svg",31)(10,MergeRequestComponent_span_9__svg_svg_10_Template,1,1,"svg",32)(11,MergeRequestComponent_span_9__svg_svg_11_Template,1,1,"svg",33),o.j41(12,"span",34),o.EFF(13),o.k0s()()),2&e){const e=o.XpG();o.Y8G("ngClass","op-merge-request--pipeline-icon_bg_"+e.mergeRequest.pipelines[0].status),o.R7$(),o.Y8G("ngIf",e.isCurrentPipelinestate("failed")),o.R7$(),o.Y8G("ngIf",e.isCurrentPipelinestate("canceled")),o.R7$(),o.Y8G("ngIf",e.isCurrentPipelinestate("created")),o.R7$(),o.Y8G("ngIf",e.isCurrentPipelinestate("manual")),o.R7$(),o.Y8G("ngIf",e.isCurrentPipelinestate("pending")),o.R7$(),o.Y8G("ngIf",e.isCurrentPipelinestate("preparing")),o.R7$(),o.Y8G("ngIf",e.isCurrentPipelinestate("running")),o.R7$(),o.Y8G("ngIf",e.isCurrentPipelinestate("scheduled")),o.R7$(),o.Y8G("ngIf",e.isCurrentPipelinestate("skipped")),o.R7$(),o.Y8G("ngIf",e.isCurrentPipelinestate("success")),o.R7$(),o.Y8G("ngIf",e.isCurrentPipelinestate("waiting")),o.R7$(),o.Y8G("ngClass","op-merge-request--pipeline-label_"+e.mergeRequest.pipelines[0].status),o.R7$(),o.SpI(" ",e.mergeRequest.pipelines[0].status," ")}}function MergeRequestComponent_a_13_Template(e,t){if(1&e&&o.nrm(0,"a",46),2&e){const e=o.XpG();o.Y8G("href","mailto:"+e.mergeRequest.gitlabUser.email,o.B4B)("textContent",e.mergeRequest.gitlabUser.login)}}function MergeRequestComponent_span_20_Template(e,t){if(1&e&&(o.j41(0,"span")(1,"span",47),o.EFF(2),o.k0s()()),2&e){const e=t.$implicit;o.R7$(),o.Y8G("ngStyle",o.eq3(2,merge_request_component_c0,e.color)),o.R7$(),o.SpI(" ",e.title," ")}}class MergeRequestComponent{constructor(e,t){this.PathHelper=e,this.I18n=t,this.text={label_created_by:this.I18n.t("js.label_created_by"),label_last_updated_on:this.I18n.t("js.gitlab_integration.updated_on"),label_details:this.I18n.t("js.label_details"),label_pipelines:this.I18n.t("js.gitlab_integration.gitlab_pipelines")}}get state(){return"opened"===this.mergeRequest.state?this.mergeRequest.draft?"open":"ready":this.mergeRequest.merged?"merged":"closed"}toggleLabels(e){const t=document.querySelector(`.op-merge-request--labels-${e}`);t.style.display="none"===t.style.display?"block":"none"}get pipelineIconClass(){return this.mergeRequest.pipelines?"op-merge-request--pipeline-icon_"+this.mergeRequest.pipelines[0].status:""}isCurrentPipelinestate(e){return!!this.mergeRequest.pipelines&&this.mergeRequest.pipelines[0].status===e}static{this.ɵfac=function MergeRequestComponent_Factory(e){return new(e||MergeRequestComponent)(o.rXU(B.B),o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:MergeRequestComponent,selectors:[["gitlab-merge-request"]],hostAttrs:[1,"op-merge-request"],inputs:{mergeRequest:"mergeRequest"},decls:21,vars:18,consts:[[1,"op-merge-request--title",3,"textContent"],[1,"op-merge-request--state",3,"ngClass"],["op-gitlab-merge-request-open-icon","","size","small",4,"ngIf"],["op-gitlab-merge-request-ready-icon","","size","small",4,"ngIf"],["op-gitlab-merge-request-merged-icon","","size","small",4,"ngIf"],["op-gitlab-merge-request-closed-icon","","size","small",4,"ngIf"],["target","blank",3,"ngClass","href","textContent"],["class","op-merge-request--label_icon","title","Show/Hide labels",3,"click",4,"ngIf"],["class","op-merge-request--pipeline-icon",3,"ngClass",4,"ngIf"],[1,"op-merge-request--info_created"],[1,"op-merge-request--user"],["class","op-merge-request--username",3,"href","textContent",4,"ngIf"],[1,"op-merge-request--date"],[3,"dateTimeValue"],[1,"op-merge-request--labels",2,"display","none",3,"ngClass"],[4,"ngFor","ngForOf"],["op-gitlab-merge-request-open-icon","","size","small"],["op-gitlab-merge-request-ready-icon","","size","small"],["op-gitlab-merge-request-merged-icon","","size","small"],["op-gitlab-merge-request-closed-icon","","size","small"],["title","Show/Hide labels",1,"op-merge-request--label_icon",3,"click"],["op-gitlab-labels-icon","","size","small",1,"op-merge-request--label_icon_style"],[1,"op-merge-request--pipeline-icon",3,"ngClass"],["op-gitlab-pipeline-status-failed-icon","","size","small",3,"ngClass",4,"ngIf"],["op-gitlab-pipeline-status-canceled-icon","","size","small",3,"ngClass",4,"ngIf"],["op-gitlab-pipeline-status-created-icon","","size","small",3,"ngClass",4,"ngIf"],["op-gitlab-pipeline-status-manual-icon","","size","small",3,"ngClass",4,"ngIf"],["op-gitlab-pipeline-status-pending-icon","","size","small",3,"ngClass",4,"ngIf"],["op-gitlab-pipeline-status-preparing-icon","","size","small",3,"ngClass",4,"ngIf"],["op-gitlab-pipeline-status-running-icon","","size","small",3,"ngClass",4,"ngIf"],["op-gitlab-pipeline-status-scheduled-icon","","size","small",3,"ngClass",4,"ngIf"],["op-gitlab-pipeline-status-skipped-icon","","size","small",3,"ngClass",4,"ngIf"],["op-gitlab-pipeline-status-success-icon","","size","small",3,"ngClass",4,"ngIf"],["op-gitlab-pipeline-status-waiting-icon","","size","small",3,"ngClass",4,"ngIf"],[1,"op-merge-request--pipeline-label",3,"ngClass"],["op-gitlab-pipeline-status-failed-icon","","size","small",3,"ngClass"],["op-gitlab-pipeline-status-canceled-icon","","size","small",3,"ngClass"],["op-gitlab-pipeline-status-created-icon","","size","small",3,"ngClass"],["op-gitlab-pipeline-status-manual-icon","","size","small",3,"ngClass"],["op-gitlab-pipeline-status-pending-icon","","size","small",3,"ngClass"],["op-gitlab-pipeline-status-preparing-icon","","size","small",3,"ngClass"],["op-gitlab-pipeline-status-running-icon","","size","small",3,"ngClass"],["op-gitlab-pipeline-status-scheduled-icon","","size","small",3,"ngClass"],["op-gitlab-pipeline-status-skipped-icon","","size","small",3,"ngClass"],["op-gitlab-pipeline-status-success-icon","","size","small",3,"ngClass"],["op-gitlab-pipeline-status-waiting-icon","","size","small",3,"ngClass"],[1,"op-merge-request--username",3,"href","textContent"],[1,"op-merge-request--label",3,"ngStyle"]],template:function MergeRequestComponent_Template(e,t){1&e&&(o.nrm(0,"div",0),o.j41(1,"span",1),o.DNE(2,MergeRequestComponent__svg_svg_2_Template,1,0,"svg",2)(3,MergeRequestComponent__svg_svg_3_Template,1,0,"svg",3)(4,MergeRequestComponent__svg_svg_4_Template,1,0,"svg",4)(5,MergeRequestComponent__svg_svg_5_Template,1,0,"svg",5),o.EFF(6),o.nrm(7,"a",6),o.k0s(),o.DNE(8,MergeRequestComponent_button_8_Template,2,0,"button",7)(9,MergeRequestComponent_span_9_Template,14,14,"span",8),o.j41(10,"div",9),o.EFF(11),o.j41(12,"span",10),o.DNE(13,MergeRequestComponent_a_13_Template,1,2,"a",11),o.EFF(14,". "),o.k0s(),o.j41(15,"span",12),o.EFF(16),o.nrm(17,"op-date-time",13),o.k0s(),o.EFF(18,".\n"),o.k0s(),o.j41(19,"div",14),o.DNE(20,MergeRequestComponent_span_20_Template,3,4,"span",15),o.k0s()),2&e&&(o.Y8G("textContent",t.mergeRequest.title),o.R7$(),o.Y8G("ngClass","op-merge-request--state_"+t.state),o.R7$(),o.Y8G("ngIf","open"===t.state),o.R7$(),o.Y8G("ngIf","ready"===t.state),o.R7$(),o.Y8G("ngIf","merged"===t.state),o.R7$(),o.Y8G("ngIf","closed"===t.state),o.R7$(),o.SpI(" ",t.state," | "),o.R7$(),o.Y8G("ngClass","op-merge-request--link_"+t.state)("href",t.mergeRequest.htmlUrl,o.B4B)("textContent",t.mergeRequest.repository+"#"+t.mergeRequest.number),o.R7$(),o.Y8G("ngIf",t.mergeRequest.labels&&t.mergeRequest.labels.length>0),o.R7$(),o.Y8G("ngIf",t.mergeRequest.pipelines&&t.mergeRequest.pipelines.length>0),o.R7$(2),o.SpI(" ",t.text.label_created_by," "),o.R7$(2),o.Y8G("ngIf",t.mergeRequest.gitlabUser),o.R7$(3),o.SpI(" ",t.text.label_last_updated_on," "),o.R7$(),o.Y8G("dateTimeValue",t.mergeRequest.gitlabUpdatedAt),o.R7$(2),o.Y8G("ngClass","op-merge-request--labels-"+t.mergeRequest.number),o.R7$(),o.Y8G("ngForOf",t.mergeRequest.labels))},dependencies:[P.YU,P.Sq,P.bT,P.B3,Ze.mPf,Ze.S26,Ze.oB3,Ze.YLs,Ze.hA5,Ze.EAK,Ze.heV,Ze.OMe,Ze.RU6,Ze.Suf,Ze.zps,Ze.Q3F,Ze._Ym,Ze.bdw,Ze.WuR,Ze.Qbw,Fi.U],styles:['.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}[_nghost-%COMP%], .op-merge-request[_ngcontent-%COMP%]{display:grid;grid-template-columns:minmax(270px,auto) auto auto 1fr;grid-template-areas:"title title title title" "info_created info_created info_created info_created" "state label_icon pipe_icon pipe_icon" "label label label label";margin-bottom:5px;margin-top:5px;padding-bottom:4px;padding-top:4px;border-bottom:1px solid #dddddd}[_nghost-%COMP%]:last-child, .op-merge-request[_ngcontent-%COMP%]:last-child{border-bottom:none}--iconwidth[_nghost-%COMP%], .op-merge-request--iconwidth[_ngcontent-%COMP%]{min-width:100px}--title[_nghost-%COMP%], .op-merge-request--title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;font-weight:700;grid-area:title;line-height:22px;margin-right:20px}--avatar[_nghost-%COMP%], .op-merge-request--avatar[_ngcontent-%COMP%]{grid-area:info}--info_created[_nghost-%COMP%], .op-merge-request--info_created[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;display:block;grid-area:info_created;font-size:.75rem;color:var(--gray-dark);margin-bottom:3px}--info_updated[_nghost-%COMP%], .op-merge-request--info_updated[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;display:block;grid-area:info_updated;font-size:.75rem;color:var(--gray-dark);margin-top:-4px}--username[_nghost-%COMP%], .op-merge-request--username[_ngcontent-%COMP%]{color:var(--gray-dark);text-decoration:none}--labels[_nghost-%COMP%], .op-merge-request--labels[_ngcontent-%COMP%]{display:none;grid-area:label;font-size:.9rem;color:var(--gray-dark);margin-top:10px}--label[_nghost-%COMP%], .op-merge-request--label[_ngcontent-%COMP%]{display:inline-block;padding:2px .5rem;border-radius:10rem;border:1px solid #fff;color:#fff;font-size:.8rem}--link[_nghost-%COMP%], .op-merge-request--link[_ngcontent-%COMP%]{font-size:.8rem;text-decoration:none}--link_open[_nghost-%COMP%], .op-merge-request--link_open[_ngcontent-%COMP%]{background-color:#c3e6cd;color:#24663b;fill:#24663b}--link_ready[_nghost-%COMP%], .op-merge-request--link_ready[_ngcontent-%COMP%]{background-color:#c3e6cd;color:#24663b;fill:#24663b}--link_merged[_nghost-%COMP%], .op-merge-request--link_merged[_ngcontent-%COMP%]{background-color:#cbe2f9;color:#0b5cad;fill:#0b5cad}--link_closed[_nghost-%COMP%], .op-merge-request--link_closed[_ngcontent-%COMP%]{background-color:#fdd4cd;color:#ae1800;fill:#ae1800}--label_icon[_nghost-%COMP%], .op-merge-request--label_icon[_ngcontent-%COMP%]{grid-area:label_icon;display:inline-block;padding:4px 6px;border-radius:10rem;font-size:.8rem;font-weight:400;align-self:center;width:-moz-fit-content;width:fit-content;margin-right:6px;border:1px solid #cecdd4;background-color:#f3f3f3}--label_icon[_nghost-%COMP%]:hover, .op-merge-request--label_icon[_ngcontent-%COMP%]:hover{border:1px solid #b6b5ba;background-color:#e4e4e4}--label_icon_style[_nghost-%COMP%], .op-merge-request--label_icon_style[_ngcontent-%COMP%]{fill:#737278}--state[_nghost-%COMP%], .op-merge-request--state[_ngcontent-%COMP%]{grid-area:state;display:inline-block;padding:5px .6rem;border-radius:10rem;font-size:.8rem;font-weight:400;text-transform:capitalize;align-self:center;white-space:nowrap;width:-moz-fit-content;width:fit-content;margin-right:6px}--state_open[_nghost-%COMP%], .op-merge-request--state_open[_ngcontent-%COMP%]{background-color:#c3e6cd;color:#24663b;fill:#24663b}--state_ready[_nghost-%COMP%], .op-merge-request--state_ready[_ngcontent-%COMP%]{background-color:#c3e6cd;color:#24663b;fill:#24663b}--state_merged[_nghost-%COMP%], .op-merge-request--state_merged[_ngcontent-%COMP%]{background-color:#cbe2f9;color:#0b5cad;fill:#0b5cad}--state_closed[_nghost-%COMP%], .op-merge-request--state_closed[_ngcontent-%COMP%]{background-color:#fdd4cd;color:#ae1800;fill:#ae1800}--pipeline-icon[_nghost-%COMP%], .op-merge-request--pipeline-icon[_ngcontent-%COMP%]{grid-area:pipe_icon;padding:.25rem;border-radius:10rem;font-size:.8rem;font-weight:400;align-self:center;margin-right:6px;width:-moz-fit-content;width:fit-content;height:28px;align-items:center;display:inline-flex}--pipeline-icon_failed[_nghost-%COMP%], .op-merge-request--pipeline-icon_failed[_ngcontent-%COMP%]{fill:#dd2b0e;width:20px;height:20px}--pipeline-icon_bg_failed[_nghost-%COMP%], .op-merge-request--pipeline-icon_bg_failed[_ngcontent-%COMP%]{background-color:#fdd4cd}--pipeline-icon_success[_nghost-%COMP%], .op-merge-request--pipeline-icon_success[_ngcontent-%COMP%]{fill:#108548;width:20px;height:20px}--pipeline-icon_bg_success[_nghost-%COMP%], .op-merge-request--pipeline-icon_bg_success[_ngcontent-%COMP%]{background-color:#c3e6cd}--pipeline-icon_running[_nghost-%COMP%], .op-merge-request--pipeline-icon_running[_ngcontent-%COMP%]{fill:#367ad1;width:20px;height:20px}--pipeline-icon_bg_running[_nghost-%COMP%], .op-merge-request--pipeline-icon_bg_running[_ngcontent-%COMP%]{background-color:#cddffd}--pipeline-icon_created[_nghost-%COMP%], .op-merge-request--pipeline-icon_created[_ngcontent-%COMP%]{fill:#737278;width:20px;height:20px}--pipeline-icon_bg_created[_nghost-%COMP%], .op-merge-request--pipeline-icon_bg_created[_ngcontent-%COMP%]{background-color:#ececef}--pipeline-icon_waiting[_nghost-%COMP%], .op-merge-request--pipeline-icon_waiting[_ngcontent-%COMP%]{fill:#737278;width:20px;height:20px}--pipeline-icon_bg_waiting[_nghost-%COMP%], .op-merge-request--pipeline-icon_bg_waiting[_ngcontent-%COMP%]{background-color:#ececef}--pipeline-icon_preparing[_nghost-%COMP%], .op-merge-request--pipeline-icon_preparing[_ngcontent-%COMP%]{fill:#737278;width:20px;height:20px}--pipeline-icon_bg_preparing[_nghost-%COMP%], .op-merge-request--pipeline-icon_bg_preparing[_ngcontent-%COMP%]{background-color:#ececef}--pipeline-icon_pending[_nghost-%COMP%], .op-merge-request--pipeline-icon_pending[_ngcontent-%COMP%]{fill:#737278;width:20px;height:20px}--pipeline-icon_bg_pending[_nghost-%COMP%], .op-merge-request--pipeline-icon_bg_pending[_ngcontent-%COMP%]{background-color:#ececef}--pipeline-icon_canceled[_nghost-%COMP%], .op-merge-request--pipeline-icon_canceled[_ngcontent-%COMP%]{fill:#737278;width:20px;height:20px}--pipeline-icon_bg_canceled[_nghost-%COMP%], .op-merge-request--pipeline-icon_bg_canceled[_ngcontent-%COMP%]{background-color:#ececef}--pipeline-icon_skipped[_nghost-%COMP%], .op-merge-request--pipeline-icon_skipped[_ngcontent-%COMP%]{fill:#737278;width:20px;height:20px}--pipeline-icon_bg_skipped[_nghost-%COMP%], .op-merge-request--pipeline-icon_bg_skipped[_ngcontent-%COMP%]{background-color:#ececef}--pipeline-icon_manual[_nghost-%COMP%], .op-merge-request--pipeline-icon_manual[_ngcontent-%COMP%]{fill:#737278;width:20px;height:20px}--pipeline-icon_bg_manual[_nghost-%COMP%], .op-merge-request--pipeline-icon_bg_manual[_ngcontent-%COMP%]{background-color:#ececef}--pipeline-icon_scheduled[_nghost-%COMP%], .op-merge-request--pipeline-icon_scheduled[_ngcontent-%COMP%]{fill:#737278;width:20px;height:20px}--pipeline-icon_bg_scheduled[_nghost-%COMP%], .op-merge-request--pipeline-icon_bg_scheduled[_ngcontent-%COMP%]{background-color:#ececef}--pipeline-label[_nghost-%COMP%], .op-merge-request--pipeline-label[_ngcontent-%COMP%]{font-size:.8rem;font-weight:400;margin-left:4px;margin-right:5px;text-transform:capitalize}--pipeline-label_failed[_nghost-%COMP%], .op-merge-request--pipeline-label_failed[_ngcontent-%COMP%]{color:#ae1800}--pipeline-label_success[_nghost-%COMP%], .op-merge-request--pipeline-label_success[_ngcontent-%COMP%]{color:#24663b}--pipeline-label_running[_nghost-%COMP%], .op-merge-request--pipeline-label_running[_ngcontent-%COMP%]{color:#4782d0}--pipeline-label_created[_nghost-%COMP%], .op-merge-request--pipeline-label_created[_ngcontent-%COMP%]{color:#737278}--pipeline-label_waiting[_nghost-%COMP%], .op-merge-request--pipeline-label_waiting[_ngcontent-%COMP%]{color:#737278}--pipeline-label_preparing[_nghost-%COMP%], .op-merge-request--pipeline-label_preparing[_ngcontent-%COMP%]{color:#737278}--pipeline-label_pending[_nghost-%COMP%], .op-merge-request--pipeline-label_pending[_ngcontent-%COMP%]{color:#737278}--pipeline-label_canceled[_nghost-%COMP%], .op-merge-request--pipeline-label_canceled[_ngcontent-%COMP%]{color:#737278}--pipeline-label_skipped[_nghost-%COMP%], .op-merge-request--pipeline-label_skipped[_ngcontent-%COMP%]{color:#737278}--pipeline-label_manual[_nghost-%COMP%], .op-merge-request--pipeline-label_manual[_ngcontent-%COMP%]{color:#737278}--pipeline-label_scheduled[_nghost-%COMP%], .op-merge-request--pipeline-label_scheduled[_ngcontent-%COMP%]{color:#737278}--pipeline[_nghost-%COMP%], .op-merge-request--pipeline[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:12px;margin-left:0;grid-area:pipeline}','.op-mr-pipeline[_ngcontent-%COMP%]{display:grid;grid-row:span 4;grid-template-columns:28px 1fr auto;grid-template-areas:"pipeline-state-icon pipeline-info pipeline-avatar";list-style-type:none;border:1px solid #e4e4e4;padding:.3rem 1rem;font-size:.84rem}.op-mr-pipeline[_ngcontent-%COMP%]:first-child{border-top-right-radius:5px;border-top-left-radius:5px}.op-mr-pipeline[_ngcontent-%COMP%]:last-child{border-bottom-right-radius:5px;border-bottom-left-radius:5px}.op-mr-pipeline--avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{grid-area:pipeline-avatar;display:inline-block;width:22px;height:22px;margin-right:5px;border-radius:var(--user-avatar-border-radius)}.op-mr-pipeline--info[_ngcontent-%COMP%]{grid-area:pipeline-info}.op-mr-pipeline--state[_ngcontent-%COMP%]{color:var(--gray-dark);font-style:italic;margin-left:1em}.op-mr-pipeline--state-icon[_ngcontent-%COMP%]{grid-area:pipeline-state-icon}.op-mr-pipeline--state-icon_queued[_ngcontent-%COMP%]{color:#5f9ea0}.op-mr-pipeline--state-icon_running[_ngcontent-%COMP%]{color:orange}.op-mr-pipeline--state-icon_success[_ngcontent-%COMP%]{color:green}.op-mr-pipeline--state-icon_failed[_ngcontent-%COMP%], .op-mr-pipeline--state-icon_timed_out[_ngcontent-%COMP%], .op-mr-pipeline--state-icon_action_required[_ngcontent-%COMP%], .op-mr-pipeline--state-icon_stale[_ngcontent-%COMP%]{color:red}.op-mr-pipeline--state-icon_skipped[_ngcontent-%COMP%], .op-mr-pipeline--state-icon_neutral[_ngcontent-%COMP%], .op-mr-pipeline--state-icon_cancelled[_ngcontent-%COMP%]{color:gray}.op-mr-pipeline--details[_ngcontent-%COMP%]{grid-area:pipeline-details}']})}}function TabMrsComponent_ng_container_0_Template(e,t){if(1&e&&(o.qex(0),o.nrm(1,"p",2),o.bVm()),2&e){const e=o.XpG();o.R7$(),o.Y8G("innerHTML",e.getEmptyText(),o.npT)}}function TabMrsComponent_gitlab_merge_request_1_Template(e,t){if(1&e&&o.nrm(0,"gitlab-merge-request",3),2&e){const e=t.$implicit;o.Y8G("mergeRequest",e)}}class TabMrsComponent{constructor(e,t,n,i){this.I18n=e,this.apiV3Service=t,this.halResourceService=n,this.changeDetector=i,this.mergeRequests=[]}ngOnInit(){const e=`${this.apiV3Service.work_packages.id(this.workPackage.id).path}/gitlab_merge_requests`;this.halResourceService.get(e).subscribe((e=>{this.mergeRequests=e.elements,this.changeDetector.detectChanges()}))}getEmptyText(){return this.I18n.t("js.gitlab_integration.tab_mrs.empty",{wp_id:this.workPackage.id})}static{this.ɵfac=function TabMrsComponent_Factory(e){return new(e||TabMrsComponent)(o.rXU(w.W),o.rXU(O.n),o.rXU(oe.t),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:TabMrsComponent,selectors:[["tab-mrs"]],hostAttrs:[1,"op-mrs"],inputs:{workPackage:"workPackage"},decls:2,vars:2,consts:[[4,"ngIf"],[3,"mergeRequest",4,"ngFor","ngForOf"],[1,"op-tab-content--text-box",3,"innerHTML"],[3,"mergeRequest"]],template:function TabMrsComponent_Template(e,t){1&e&&o.DNE(0,TabMrsComponent_ng_container_0_Template,2,1,"ng-container",0)(1,TabMrsComponent_gitlab_merge_request_1_Template,1,1,"gitlab-merge-request",1),2&e&&(o.Y8G("ngIf",0===t.mergeRequests.length),o.R7$(),o.Y8G("ngForOf",t.mergeRequests))},dependencies:[P.Sq,P.bT,MergeRequestComponent],encapsulation:2})}}const issue_component_c0=e=>({"background-color":e});function IssueComponent__svg_svg_2_Template(e,t){1&e&&(o.qSk(),o.nrm(0,"svg",13))}function IssueComponent__svg_svg_3_Template(e,t){1&e&&(o.qSk(),o.nrm(0,"svg",14))}function IssueComponent_button_6_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"button",15),o.bIt("click",(function IssueComponent_button_6_Template_button_click_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.toggleLabels(t.gitlabIssue.number))})),o.qSk(),o.nrm(1,"svg",16),o.k0s()}}function IssueComponent_a_10_Template(e,t){if(1&e&&o.nrm(0,"a",17),2&e){const e=o.XpG();o.Y8G("href","mailto:"+e.gitlabIssue.gitlabUser.email,o.B4B)("textContent",e.gitlabIssue.gitlabUser.login)}}function IssueComponent_span_17_Template(e,t){if(1&e&&(o.j41(0,"span")(1,"span",18),o.EFF(2),o.k0s()()),2&e){const e=t.$implicit;o.R7$(),o.Y8G("ngStyle",o.eq3(2,issue_component_c0,e.color)),o.R7$(),o.SpI(" ",e.title," ")}}class IssueComponent{constructor(e,t){this.PathHelper=e,this.I18n=t,this.text={label_created_by:this.I18n.t("js.label_created_by"),label_last_updated_on:this.I18n.t("js.gitlab_integration.updated_on"),label_details:this.I18n.t("js.label_details")}}get state(){return"opened"===this.gitlabIssue.state?"open":"closed"}toggleLabels(e){const t=document.querySelector(`.op-issue--labels-${e}`);t.style.display="none"===t.style.display?"block":"none"}static{this.ɵfac=function IssueComponent_Factory(e){return new(e||IssueComponent)(o.rXU(B.B),o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:IssueComponent,selectors:[["gitlab-issue"]],hostAttrs:[1,"op-issue"],inputs:{gitlabIssue:"gitlabIssue"},decls:18,vars:15,consts:[[1,"op-issue--title",3,"textContent"],[1,"op-issue--state",3,"ngClass"],["op-gitlab-issue-open-icon","","size","small",4,"ngIf"],["op-gitlab-issue-closed-icon","","size","small",4,"ngIf"],["target","blank",3,"ngClass","href","textContent"],["class","op-issue--label_icon","title","Show/Hide labels",3,"click",4,"ngIf"],[1,"op-issue--info_created"],[1,"op-issue--user"],["class","op-issue--username",3,"href","textContent",4,"ngIf"],[1,"op-issue--date"],[3,"dateTimeValue"],[1,"op-issue--labels",2,"display","none",3,"ngClass"],[4,"ngFor","ngForOf"],["op-gitlab-issue-open-icon","","size","small"],["op-gitlab-issue-closed-icon","","size","small"],["title","Show/Hide labels",1,"op-issue--label_icon",3,"click"],["op-gitlab-labels-icon","","size","small",1,"op-issue--label_icon_style"],[1,"op-issue--username",3,"href","textContent"],[1,"op-issue--label",3,"ngStyle"]],template:function IssueComponent_Template(e,t){1&e&&(o.nrm(0,"div",0),o.j41(1,"span",1),o.DNE(2,IssueComponent__svg_svg_2_Template,1,0,"svg",2)(3,IssueComponent__svg_svg_3_Template,1,0,"svg",3),o.EFF(4),o.nrm(5,"a",4),o.k0s(),o.DNE(6,IssueComponent_button_6_Template,2,0,"button",5),o.j41(7,"div",6),o.EFF(8),o.j41(9,"span",7),o.DNE(10,IssueComponent_a_10_Template,1,2,"a",8),o.EFF(11,". "),o.k0s(),o.j41(12,"span",9),o.EFF(13),o.nrm(14,"op-date-time",10),o.k0s(),o.EFF(15,".\n"),o.k0s(),o.j41(16,"div",11),o.DNE(17,IssueComponent_span_17_Template,3,4,"span",12),o.k0s()),2&e&&(o.Y8G("textContent",t.gitlabIssue.title),o.R7$(),o.Y8G("ngClass","op-issue--state_"+t.state),o.R7$(),o.Y8G("ngIf","open"===t.state),o.R7$(),o.Y8G("ngIf","open"!==t.state),o.R7$(),o.SpI(" ",t.state," | "),o.R7$(),o.Y8G("ngClass","op-issue--link_"+t.state)("href",t.gitlabIssue.htmlUrl,o.B4B)("textContent",t.gitlabIssue.repository+"#"+t.gitlabIssue.number),o.R7$(),o.Y8G("ngIf",t.gitlabIssue.labels&&t.gitlabIssue.labels.length>0),o.R7$(2),o.SpI(" ",t.text.label_created_by," "),o.R7$(2),o.Y8G("ngIf",t.gitlabIssue.gitlabUser),o.R7$(3),o.SpI(" ",t.text.label_last_updated_on," "),o.R7$(),o.Y8G("dateTimeValue",t.gitlabIssue.gitlabUpdatedAt),o.R7$(2),o.Y8G("ngClass","op-issue--labels-"+t.gitlabIssue.number),o.R7$(),o.Y8G("ngForOf",t.gitlabIssue.labels))},dependencies:[P.YU,P.Sq,P.bT,P.B3,Ze.QX2,Ze.GON,Ze.mPf,Fi.U],styles:['.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}[_nghost-%COMP%], .op-issue[_ngcontent-%COMP%]{display:grid;grid-template-columns:minmax(270px,auto) auto 1fr;grid-template-areas:"title title title" "info_created info_created info_created" "state label_icon label_icon" "label label label";margin-bottom:5px;margin-top:5px;padding-bottom:4px;padding-top:4px;border-bottom:1px solid #dddddd}[_nghost-%COMP%]:last-child, .op-issue[_ngcontent-%COMP%]:last-child{border-bottom:none}--title[_nghost-%COMP%], .op-issue--title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;font-weight:700;grid-area:title;line-height:22px;margin-right:20px}--avatar[_nghost-%COMP%], .op-issue--avatar[_ngcontent-%COMP%]{grid-area:info}--info_created[_nghost-%COMP%], .op-issue--info_created[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;display:block;grid-area:info_created;font-size:.75rem;color:var(--gray-dark);margin-bottom:3px}--info_updated[_nghost-%COMP%], .op-issue--info_updated[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;display:block;grid-area:info_updated;font-size:.75rem;color:var(--gray-dark);margin-top:-4px}--username[_nghost-%COMP%], .op-issue--username[_ngcontent-%COMP%]{color:var(--gray-dark);text-decoration:none}--labels[_nghost-%COMP%], .op-issue--labels[_ngcontent-%COMP%]{display:none;grid-area:label;font-size:.9rem;color:var(--gray-dark);margin-top:10px}--label[_nghost-%COMP%], .op-issue--label[_ngcontent-%COMP%]{display:inline-block;padding:2px .5rem;border-radius:10rem;border:1px solid #fff;color:#fff;font-size:.8rem}--link[_nghost-%COMP%], .op-issue--link[_ngcontent-%COMP%]{font-size:.8rem;text-decoration:none}--link_open[_nghost-%COMP%], .op-issue--link_open[_ngcontent-%COMP%]{background-color:#c3e6cd;color:#24663b;fill:#24663b}--link_closed[_nghost-%COMP%], .op-issue--link_closed[_ngcontent-%COMP%]{background-color:#cbe2f9;color:#0b5cad;fill:#0b5cad}--label_icon[_nghost-%COMP%], .op-issue--label_icon[_ngcontent-%COMP%]{grid-area:label_icon;display:inline-block;padding:4px 6px;border-radius:10rem;font-size:.8rem;font-weight:400;align-self:center;width:-moz-fit-content;width:fit-content;margin-right:6px;border:1px solid #cecdd4;background-color:#f3f3f3}--label_icon[_nghost-%COMP%]:hover, .op-issue--label_icon[_ngcontent-%COMP%]:hover{border:1px solid #b6b5ba;background-color:#e4e4e4}--label_icon_style[_nghost-%COMP%], .op-issue--label_icon_style[_ngcontent-%COMP%]{fill:#737278}--state[_nghost-%COMP%], .op-issue--state[_ngcontent-%COMP%]{grid-area:state;display:inline-block;padding:5px .6rem;border-radius:10rem;font-size:.8rem;font-weight:400;text-transform:capitalize;align-self:center;white-space:nowrap;width:-moz-fit-content;width:fit-content;margin-right:6px}--state_open[_nghost-%COMP%], .op-issue--state_open[_ngcontent-%COMP%]{background-color:#c3e6cd;color:#24663b;fill:#24663b}--state_closed[_nghost-%COMP%], .op-issue--state_closed[_ngcontent-%COMP%]{background-color:#cbe2f9;color:#0b5cad;fill:#0b5cad}']})}}function TabIssueComponent_ng_container_0_Template(e,t){if(1&e&&(o.qex(0),o.nrm(1,"p",2),o.bVm()),2&e){const e=o.XpG();o.R7$(),o.Y8G("innerHTML",e.getEmptyText(),o.npT)}}function TabIssueComponent_gitlab_issue_1_Template(e,t){if(1&e&&o.nrm(0,"gitlab-issue",3),2&e){const e=t.$implicit;o.Y8G("gitlabIssue",e)}}class TabIssueComponent{constructor(e,t,n,i){this.I18n=e,this.apiV3Service=t,this.halResourceService=n,this.changeDetector=i,this.gitlabIssues=[]}ngOnInit(){const e=`${this.apiV3Service.work_packages.id(this.workPackage.id).path}/gitlab_issues`;this.halResourceService.get(e).subscribe((e=>{this.gitlabIssues=e.elements,this.changeDetector.detectChanges()}))}getEmptyText(){return this.I18n.t("js.gitlab_integration.tab_issue.empty",{wp_id:this.workPackage.id})}static{this.ɵfac=function TabIssueComponent_Factory(e){return new(e||TabIssueComponent)(o.rXU(w.W),o.rXU(O.n),o.rXU(oe.t),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:TabIssueComponent,selectors:[["tab-issue"]],hostAttrs:[1,"op-issue"],inputs:{workPackage:"workPackage"},decls:2,vars:2,consts:[[4,"ngIf"],[3,"gitlabIssue",4,"ngFor","ngForOf"],[1,"op-tab-content--text-box",3,"innerHTML"],[3,"gitlabIssue"]],template:function TabIssueComponent_Template(e,t){1&e&&o.DNE(0,TabIssueComponent_ng_container_0_Template,2,1,"ng-container",0)(1,TabIssueComponent_gitlab_issue_1_Template,1,1,"gitlab-issue",1),2&e&&(o.Y8G("ngIf",0===t.gitlabIssues.length),o.R7$(),o.Y8G("ngForOf",t.gitlabIssues))},dependencies:[P.Sq,P.bT,IssueComponent],encapsulation:2})}}class GitlabTabComponent{constructor(e,t){this.PathHelper=e,this.I18n=t}static{this.ɵfac=function GitlabTabComponent_Factory(e){return new(e||GitlabTabComponent)(o.rXU(B.B),o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:GitlabTabComponent,selectors:[["gitlab-tab"]],inputs:{workPackage:"workPackage"},decls:4,vars:4,consts:[[1,"gitlab-header",3,"workPackage"],[3,"workPackage"]],template:function GitlabTabComponent_Template(e,t){1&e&&o.nrm(0,"tab-header-issue",0)(1,"tab-issue",1)(2,"tab-header-mr",0)(3,"tab-mrs",1),2&e&&(o.Y8G("workPackage",t.workPackage),o.R7$(),o.Y8G("workPackage",t.workPackage),o.R7$(),o.Y8G("workPackage",t.workPackage),o.R7$(),o.Y8G("workPackage",t.workPackage))},dependencies:[TabHeaderMrsComponent,TabHeaderIssueComponent,TabMrsComponent,TabIssueComponent],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.gitlab-header[_ngcontent-%COMP%]{position:sticky;top:0}"]})}}var Mi=n(62187);class WorkPackagesGitlabMrsService extends Mi.${constructor(e){super(),this.ConfigurationService=e}load(e){return e.gitlab_merge_requests.$update().then((e=>this.sortList(e.elements)))}sortList(e,t="createdAt"){return _.sortBy(_.flatten(e),t)}static{this.ɵfac=function WorkPackagesGitlabMrsService_Factory(e){return new(e||WorkPackagesGitlabMrsService)(o.KVO(q.s))}}static{this.ɵprov=o.jDH({token:WorkPackagesGitlabMrsService,factory:WorkPackagesGitlabMrsService.ɵfac})}}class WorkPackagesGitlabIssueService extends Mi.${constructor(e){super(),this.ConfigurationService=e}load(e){return e.gitlab_issues.$update().then((e=>this.sortList(e.elements)))}sortList(e,t="createdAt"){return _.sortBy(_.flatten(e),t)}static{this.ɵfac=function WorkPackagesGitlabIssueService_Factory(e){return new(e||WorkPackagesGitlabIssueService)(o.KVO(q.s))}}static{this.ɵprov=o.jDH({token:WorkPackagesGitlabIssueService,factory:WorkPackagesGitlabIssueService.ɵfac})}}function workPackageGitlabCount(e,t){const n=t.get(WorkPackagesGitlabMrsService),i=t.get(WorkPackagesGitlabIssueService),o=n.requireAndStream(e).pipe((0,G.T)((e=>e.length))),r=i.requireAndStream(e).pipe((0,G.T)((e=>e.length)));return(0,Vt.z)([o,r]).pipe((0,G.T)((([e,t])=>e+t)))}class openproject_gitlab_integration_main_PluginModule{constructor(e){!function initializeGitlabIntegrationPlugin(e){e.get(yi.L).register({component:GitlabTabComponent,name:I18n.t("js.gitlab_integration.work_packages.tab_name"),id:"gitlab",displayable:e=>!!e.gitlab,count:workPackageGitlabCount})}(e)}static{this.ɵfac=function PluginModule_Factory(e){return new(e||openproject_gitlab_integration_main_PluginModule)(o.KVO(o.zZn))}}static{this.ɵmod=o.$C({type:openproject_gitlab_integration_main_PluginModule})}static{this.ɵinj=o.G2t({providers:[WorkPackagesGitlabMrsService,WorkPackagesGitlabIssueService],imports:[d.d,De.q]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(openproject_gitlab_integration_main_PluginModule,{declarations:[GitlabTabComponent,TabHeaderMrsComponent,TabHeaderIssueComponent,TabMrsComponent,TabIssueComponent,git_actions_menu_directive_GitActionsMenuDirective,git_actions_menu_component_GitActionsMenuComponent,MergeRequestComponent,IssueComponent],imports:[d.d,De.q],exports:[GitlabTabComponent,TabHeaderMrsComponent,TabHeaderIssueComponent,TabMrsComponent,TabIssueComponent,git_actions_menu_directive_GitActionsMenuDirective,git_actions_menu_component_GitActionsMenuComponent]});class MeetingsTabComponent{constructor(e,t,n){this.elementRef=e,this.PathHelper=t,this.I18n=n}ngOnInit(){this.turboFrameSrc=`${this.PathHelper.staticBase}/work_packages/${this.workPackage.id}/meetings/tab`}static{this.ɵfac=function MeetingsTabComponent_Factory(e){return new(e||MeetingsTabComponent)(o.rXU(o.aKT),o.rXU(B.B),o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:MeetingsTabComponent,selectors:[["op-meetings-tab"]],inputs:{workPackage:"workPackage"},decls:6,vars:1,consts:[["id","work-package-meetings-tab-content",3,"src"],["viewBox","0 0 100 100"],["x","0","y","0","width","70","height","5","rx","1"],["x","75","y","0","width","25","height","5","rx","1"],["x","0","y","10","width","100","height","8","rx","1"],["x","0","y","25","width","100","height","12","rx","1"]],template:function MeetingsTabComponent_Template(e,t){1&e&&(o.j41(0,"turbo-frame",0)(1,"op-content-loader",1),o.qSk(),o.nrm(2,"rect",2)(3,"rect",3)(4,"rect",4)(5,"rect",5),o.k0s()()),2&e&&o.Y8G("src",t.turboFrameSrc)},dependencies:[Yt.F],encapsulation:2,changeDetection:0})}}var Oi=n(63037),Di=n(63617),Gi=n(18537);function workPackageMeetingsCount(e,t){const n=t.get(B.B),i=t.get(s.Qq);return(0,Di.h)((0,Gi.R)(document,"turbo:frame-render"),(0,Gi.R)(document,"turbo:before-stream-render")).pipe((0,Z.p)((e=>{if("turbo:frame-render"===e.type)return e.target.id?.includes("work-package-meetings-tab");if("turbo:before-stream-render"===e.type){const t=e.detail.newStream;return t.target?.includes("work-package-meetings-tab")}return!1})),(0,Oi.Z)(null),(0,K.c)(1e3),(0,ae.n)((()=>i.get(`${n.workPackagePath(e.id)}/meetings/tab/count`).pipe((0,G.T)((e=>e.count))))))}class openproject_meeting_main_PluginModule{constructor(e){!function initializeMeetingPlugin(e){const t=e.get(yi.L),n=e.get(w.W);t.register({component:MeetingsTabComponent,name:n.t("js.label_meetings"),id:"meetings",displayable:e=>!!e.meetings,count:workPackageMeetingsCount})}(e)}static{this.ɵfac=function PluginModule_Factory(e){return new(e||openproject_meeting_main_PluginModule)(o.KVO(o.zZn))}}static{this.ɵmod=o.$C({type:openproject_meeting_main_PluginModule})}static{this.ɵinj=o.G2t({imports:[d.d,De.q]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(openproject_meeting_main_PluginModule,{declarations:[MeetingsTabComponent],imports:[d.d,De.q],exports:[MeetingsTabComponent]});class LinkedPluginsModule{static{this.ɵfac=function LinkedPluginsModule_Factory(e){return new(e||LinkedPluginsModule)}}static{this.ɵmod=o.$C({type:LinkedPluginsModule})}static{this.ɵinj=o.G2t({imports:[PluginModule,main_PluginModule,openproject_avatars_main_PluginModule,openproject_documents_main_PluginModule,openproject_github_integration_main_PluginModule,openproject_gitlab_integration_main_PluginModule,openproject_meeting_main_PluginModule]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(LinkedPluginsModule,{imports:[PluginModule,main_PluginModule,openproject_avatars_main_PluginModule,openproject_documents_main_PluginModule,openproject_github_integration_main_PluginModule,openproject_gitlab_integration_main_PluginModule,openproject_meeting_main_PluginModule]});var Ei=n(85038),Ai=n(14876),Vi=n(44442),$i=n(15980);function InAppNotificationBellComponent_ng_container_2_span_1_Template(e,t){if(1&e&&(o.nrm(0,"span",4),o.nI1(1,"async")),2&e){const e=o.XpG(2);o.Y8G("textContent",o.bMT(1,1,e.unreadCountText$))}}function InAppNotificationBellComponent_ng_container_2_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,InAppNotificationBellComponent_ng_container_2_span_1_Template,2,3,"span",3),o.bVm()),2&e){const e=t.ngIf;o.R7$(),o.Y8G("ngIf",0!==e)}}class InAppNotificationBellComponent{constructor(e,t,n,i,o){this.elementRef=e,this.storeService=t,this.apiV3Service=n,this.activeWindow=i,this.pathHelper=o,this.interval=5e4,(0,Ot.w)(this)}triggerImmediateUpdate(){this.storeService.fetchUnread().subscribe()}ngOnInit(){this.polling$=(0,Di.h)((0,Ai.O)(10,this.interval).pipe((0,Z.p)((()=>this.activeWindow.isActive))),(0,Ai.O)(10,10*this.interval).pipe((0,Z.p)((()=>!this.activeWindow.isActive)))).pipe((0,K.c)(this.interval),(0,ae.n)((()=>this.storeService.fetchUnread()))),this.unreadCount$=(0,Vt.z)([this.storeService.unread$,this.polling$]).pipe((0,G.T)((([e])=>e)),(0,Tn.t)(1)),this.unreadCountText$=this.unreadCount$.pipe((0,G.T)((e=>e>99?"99+":e<=0?"":e)))}notificationsPath(){return this.pathHelper.notificationsPath()}static{this.ɵfac=function InAppNotificationBellComponent_Factory(e){return new(e||InAppNotificationBellComponent)(o.rXU(o.aKT),o.rXU($i.n),o.rXU(O.n),o.rXU(Vi.m),o.rXU(B.B))}}static{this.ɵcmp=o.VBU({type:InAppNotificationBellComponent,selectors:[["opce-in-app-notification-bell"]],hostBindings:function InAppNotificationBellComponent_HostBindings(e,t){1&e&&o.bIt("ian-update-immediate",(function InAppNotificationBellComponent_ian_update_immediate_HostBindingHandler(){return t.triggerImmediateUpdate()}),!1,o.EBC)},inputs:{interval:"interval"},decls:4,vars:4,consts:[["data-test-selector","op-ian-bell",1,"op-ian-bell","op-app-menu--item-action",3,"href"],["bell-fill-icon","","size","small"],[4,"ngIf"],["class","op-ian-bell--indicator","data-test-selector","op-ian-notifications-count",3,"textContent",4,"ngIf"],["data-test-selector","op-ian-notifications-count",1,"op-ian-bell--indicator",3,"textContent"]],template:function InAppNotificationBellComponent_Template(e,t){1&e&&(o.j41(0,"a",0),o.qSk(),o.nrm(1,"svg",1),o.DNE(2,InAppNotificationBellComponent_ng_container_2_Template,2,1,"ng-container",2),o.nI1(3,"async"),o.k0s()),2&e&&(o.Y8G("href",t.notificationsPath(),o.B4B),o.R7$(2),o.Y8G("ngIf",o.bMT(3,2,t.unreadCount$)))},dependencies:[P.bT,Ze.ziU,P.Jj],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-ian-bell[_ngcontent-%COMP%]{position:relative}.op-ian-bell--indicator[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;align-items:center;box-sizing:content-box;height:16px;line-height:16px;width:16px;border-radius:.5rem;padding:0 .15rem;font-size:.7rem;font-weight:var(--base-text-weight-bold);background:var(--bgColor-accent-emphasis);color:#fff;flex-shrink:0;position:absolute;top:10px;right:3px;background:var(--display-red-bgColor-emphasis)}"],changeDetection:0})}}var Bi=n(14600),Wi=n(17270),Ni=n(86748),Ui=n(94564),Yi=n(21567),Xi=n(87392),qi=n(98522);let Li=class IanCenterService extends $t.p{get params(){const e=this.store.getValue(),t=e.filters.name&&e.filters.filter;return{...e.params,filters:[..."all"===e.activeFacet?Xi.Zp.all:Xi.Zp.unread,...t?[[e.filters.filter,"=",[e.filters.name]]]:[]]}}constructor(e,t,n,i,o,r,s,a,l,c,p,d){super(),this.I18n=e,this.injector=t,this.resourceService=n,this.actions$=i,this.apiV3Service=o,this.toastService=r,this.urlParams=s,this.state=a,this.deviceService=l,this.pathHelper=c,this.ianBellService=p,this.configurationService=d,this.id="ian-center",this.store=new Xi.zY,this.query=new Pi.XK(this.store),this.activeFacet$=this.query.select("activeFacet"),this.notLoaded$=this.query.select("notLoaded"),this.activeCollection$=this.query.select("activeCollection"),this.menuFrame=document.getElementById("notifications_sidemenu"),this.loading$=this.query.selectLoading(),this.selectNotifications$=this.activeCollection$.pipe((0,ae.n)((e=>(0,yn.p)(e.ids.map((e=>this.resourceService.lookup(e).pipe((0,ne.s)(1))))).pipe((0,Wn.U)([]))))),this.aggregatedCenterNotifications$=this.selectNotifications$.pipe((0,G.T)((e=>_.groupBy(e,(e=>e._links.resource?.href||"none")))),(0,J.F)()),this.notifications$=this.aggregatedCenterNotifications$.pipe((0,G.T)((e=>Object.values(e))),(0,J.F)()),this.hasNotifications$=this.notifications$.pipe((0,J.F)(),(0,G.T)((e=>e.length>0)),(0,J.F)()),this.hasMoreThanPageSize$=this.notLoaded$.pipe((0,G.T)((e=>e>0)),(0,J.F)()),this.activeReloadToast=null,this.reload=new jn.B,this.onReload=this.reload.pipe((0,At.B)(0),(0,St.M)((e=>{e&&this.store.setLoading(!0)})),(0,ae.n)((()=>this.resourceService.fetchCollection(this.params).pipe((0,ae.n)((e=>(0,Bi.H)(this.sideLoadInvolvedWorkPackages(e._embedded.elements)).pipe((0,Pn.u)((0,Ii.uL)(e)))))))),(0,St.M)((()=>setTimeout((()=>this.store.setLoading(!1)))))),this.selectedNotificationIndex=0,this.selectedWorkPackage$=this.urlParams.pathMatching$(/\/details\/(\d+)/),this.reload.subscribe(),this.selectedWorkPackage$.subscribe((e=>{this.updateSelectedNotification(e)}))}setFilters(e){this.store.update({filters:e}),this.onReload.pipe((0,ne.s)(1)).subscribe((e=>{this.store.update({activeCollection:e})})),this.reload.next(!0)}setFacet(e){this.store.update({activeFacet:e}),this.onReload.pipe((0,ne.s)(1)).subscribe((e=>{this.store.update({activeCollection:e})})),"unread"===e&&this.selectedNotification?.readIAN&&this.goToCenter(),this.reload.next(!0)}markAsRead(e){this.actions$.dispatch((0,Wi.Q1)({origin:this.id,notifications:e}))}openSplitScreen(e,t="activity"){const n=this.pathHelper.notificationsDetailsPath(e,t)+window.location.search;Turbo.visit(n,{frame:"content-bodyRight",action:"advance"})}openFullView(e){this.state.go("work-packages.show",{workPackageId:e})}goToCenter(){this.state.go(this.state.current.data.baseRoute)}showNextNotification(){this.notifications$.pipe((0,ne.s)(1)).subscribe((e=>{if(e.length<=0)window.location.href=this.pathHelper.notificationsPath();else if(e[0][0]._links.resource||e[this.selectedNotificationIndex][0]._links.resource){const t=(0,be.A)(e[this.selectedNotificationIndex>=e.length?0:this.selectedNotificationIndex][0]._links.resource.href);this.openSplitScreen(t)}}))}updateImmediate(){this.ianBellService.fetchUnread().subscribe()}handleChangedNotificationCount(){this.primerizedActivitiesEnabled&&(this.onReload.pipe((0,ne.s)(1)).subscribe((e=>{this.store.update({activeCollection:e}),this.actions$.dispatch((0,Wi.NB)({origin:this.id}))})),this.reload.next(!1))}checkForNewNotifications(){this.primerizedActivitiesEnabled||(this.onReload.pipe((0,ne.s)(1)).subscribe((e=>{const{activeCollection:t}=this.query.getValue();!e.ids.reduce(((e,n)=>e&&t.ids.includes(n)),!0)&&(this.activeReloadToast&&(this.toastService.remove(this.activeReloadToast),this.activeReloadToast=null),this.activeReloadToast=this.toastService.add({type:"info",icon:"bell",message:this.I18n.t("js.notifications.center.new_notifications.message"),link:{text:this.I18n.t("js.notifications.center.new_notifications.link_text"),target:()=>{this.store.update({activeCollection:e}),this.actions$.dispatch((0,Wi.NB)({origin:this.id})),this.activeReloadToast=null}}}))})),this.reload.next(!1))}get primerizedActivitiesEnabled(){return this.configurationService.activeFeatureFlags.includes("primerizedWorkPackageActivities")}reloadOnNotificationRead(e){if(e.all)return this.store.update({activeCollection:{ids:[]},activeFacet:"unread"}),void this.menuFrame.reload();const{activeCollection:t}=this.query.getValue();this.store.update({activeCollection:{ids:t.ids.filter((t=>!e.notifications.includes(t)))}}),!this.deviceService.isMobile&&window.location.href.includes("details")&&this.showNextNotification(),this.menuFrame.reload()}sideLoadInvolvedWorkPackages(e){const{cache:t}=this.apiV3Service.work_packages,n=e.map((e=>{const t=e._links.resource?.href;return t&&Ft.q.matchFromLink(t,"work_packages")})).filter((e=>e&&t.stale(e))),i=this.apiV3Service.work_packages.requireAll(_.compact(n));return n.forEach((e=>{t.clearAndLoad(e,(0,Bi.H)(i).pipe((0,G.T)((()=>t.current(e)))))})),i}updateSelectedNotification(e){this.notifications$.pipe((0,ne.s)(1)).subscribe((t=>{for(let n=0;n<t.length;++n)if(t[n][0]._links.resource&&(0,be.A)(t[n][0]._links.resource.href)===e)return this.selectedNotificationIndex=n,void([this.selectedNotification]=t[n])}))}static{this.ɵfac=function IanCenterService_Factory(e){return new(e||IanCenterService)(o.KVO(w.W),o.KVO(o.zZn),o.KVO(Yi.u),o.KVO(Ui.d),o.KVO(O.n),o.KVO(R.fw),o.KVO(qi.Z),o.KVO(ye.dw),o.KVO(rt.g),o.KVO(B.B),o.KVO($i.n),o.KVO(q.s))}}static{this.ɵprov=o.jDH({token:IanCenterService,factory:IanCenterService.ɵfac,providedIn:"root"})}};(0,U.Cg)([(0,Ni.xP)(Wi.$s),(0,U.Sn)("design:type",Function),(0,U.Sn)("design:paramtypes",[]),(0,U.Sn)("design:returntype",void 0)],Li.prototype,"handleChangedNotificationCount",null),(0,U.Cg)([(0,Ni.xP)(Wi.Z9),(0,U.Sn)("design:type",Function),(0,U.Sn)("design:paramtypes",[]),(0,U.Sn)("design:returntype",void 0)],Li.prototype,"checkForNewNotifications",null),(0,U.Cg)([(0,Ni.xP)(Wi.jo),(0,U.Sn)("design:type",Function),(0,U.Sn)("design:paramtypes",[void 0]),(0,U.Sn)("design:returntype",void 0)],Li.prototype,"reloadOnNotificationRead",null),Li=(0,U.Cg)([Ni.qm,(0,U.Sn)("design:paramtypes",[w.W,o.zZn,Yi.u,Ui.d,O.n,R.fw,qi.Z,ye.dw,rt.g,B.B,$i.n,q.s])],Li);var Hi=n(15999),zi=n(55939);n(48241);class InAppNotificationStatusComponent{ngOnChanges(e){if(e.status){const t=e.status;this.highlightClass=Pt.H.backgroundClass("status",t.currentValue.id||"")}}static{this.ɵfac=function InAppNotificationStatusComponent_Factory(e){return new(e||InAppNotificationStatusComponent)}}static{this.ɵcmp=o.VBU({type:InAppNotificationStatusComponent,selectors:[["op-in-app-notification-status"]],inputs:{status:"status"},features:[o.OA$],decls:2,vars:2,consts:[[1,"op-ian-wp-status",3,"ngClass"],[1,"op-ian-wp-status--text",3,"textContent"]],template:function InAppNotificationStatusComponent_Template(e,t){1&e&&(o.j41(0,"span",0),o.nrm(1,"span",1),o.k0s()),2&e&&(o.Y8G("ngClass",t.highlightClass),o.R7$(),o.Y8G("textContent",t.status.name))},dependencies:[P.YU],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-ian-wp-status[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;background-color:var(--status-selector-bg-color);color:#fff;margin-bottom:0;padding:1px 8px;border:none;border-radius:2px;max-width:100%;font-size:12px;min-height:16px;line-height:16px}.op-ian-wp-status--text[_ngcontent-%COMP%]{margin:0 5px}"],changeDetection:0})}}class InAppNotificationRelativeTimeComponent{constructor(e,t){this.I18n=e,this.timezoneService=t,this.hasActorByLine=!0,this.text={updated_by_at:e=>this.I18n.t("js.notifications.center.text_update_date_by",{date:e})}}ngOnInit(){this.buildTime()}buildTime(){this.fixedTime=this.timezoneService.formattedDatetime(this.notification.createdAt),this.relativeTime$=(0,Ai.O)(0,1e4).pipe((0,G.T)((()=>{const e=this.timezoneService.formattedRelativeDateTime(this.notification.createdAt);return this.hasActorByLine&&this.notification._links.actor?this.text.updated_by_at(e):`${e}.`})),(0,J.F)())}static{this.ɵfac=function InAppNotificationRelativeTimeComponent_Factory(e){return new(e||InAppNotificationRelativeTimeComponent)(o.rXU(w.W),o.rXU(W.D))}}static{this.ɵcmp=o.VBU({type:InAppNotificationRelativeTimeComponent,selectors:[["op-in-app-notification-relative-time"]],inputs:{notification:"notification",hasActorByLine:"hasActorByLine"},decls:2,vars:4,consts:[[1,"op-ian-relative-time",3,"title","textContent"]],template:function InAppNotificationRelativeTimeComponent_Template(e,t){1&e&&(o.nrm(0,"div",0),o.nI1(1,"async")),2&e&&o.Y8G("title",t.fixedTime)("textContent",o.bMT(1,2,t.relativeTime$))},dependencies:[P.Jj],styles:[".cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-ian-relative-time{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;max-width:100%;line-height:1rem}\n"],encapsulation:2,changeDetection:0})}}function InAppNotificationActorsLineComponent_ng_container_2_span_1_Template(e,t){if(1&e&&o.nrm(0,"span",6),2&e){const e=o.XpG(2);o.Mz_("textContent"," ",e.text.and," ")}}function InAppNotificationActorsLineComponent_ng_container_2_span_3_Template(e,t){1&e&&o.nrm(0,"span",6),2&e&&o.Y8G("textContent",", ")}function InAppNotificationActorsLineComponent_ng_container_2_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,InAppNotificationActorsLineComponent_ng_container_2_span_1_Template,1,2,"span",4),o.nrm(2,"op-principal",5),o.DNE(3,InAppNotificationActorsLineComponent_ng_container_2_span_3_Template,1,1,"span",4),o.bVm()),2&e){const e=t.$implicit,n=t.index,i=t.last,r=o.XpG();o.R7$(),o.Y8G("ngIf",i&&r.actors.length>1&&r.actors.length<4),o.R7$(),o.Y8G("principal",e)("hideName",!1)("hideAvatar",!0)("link",!r.deviceService.isMobile),o.R7$(),o.Y8G("ngIf",0===n&&r.actors.length>2||1===n&&r.actors.length>3)}}function InAppNotificationActorsLineComponent_span_4_Template(e,t){if(1&e&&(o.j41(0,"span"),o.EFF(1),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.SpI(" ",e.text_for_additional_authors(e.actors.length-3),"")}}class InAppNotificationActorsLineComponent{constructor(e,t){this.deviceService=e,this.I18n=t,this.className=!0,this.actors=[],this.text={and:this.I18n.t("js.notifications.center.label_actor_and"),and_other_singular:this.I18n.t("js.notifications.center.and_more_users.one"),and_other_plural:e=>this.I18n.t("js.notifications.center.and_more_users.other",{count:e}),loading:this.I18n.t("js.ajax.loading"),placeholder:this.I18n.t("js.placeholders.default"),mark_as_read:this.I18n.t("js.notifications.center.mark_as_read")}}ngOnInit(){this.notification._links.actor&&this.buildActors()}text_for_additional_authors(e){return 1===e?this.text.and_other_singular:this.text.and_other_plural(e)}buildActors(){const e=this.aggregatedNotifications.map((e=>{const{actor:t}=e._links;return t?{href:t.href,name:t.title}:null})).filter((e=>null!==e));this.actors=_.uniqBy(e,(e=>e.href))}static{this.ɵfac=function InAppNotificationActorsLineComponent_Factory(e){return new(e||InAppNotificationActorsLineComponent)(o.rXU(rt.g),o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:InAppNotificationActorsLineComponent,selectors:[["op-in-app-notification-actors-line"]],hostVars:2,hostBindings:function InAppNotificationActorsLineComponent_HostBindings(e,t){2&e&&o.AVh("op-ian-actors",t.className)},inputs:{aggregatedNotifications:"aggregatedNotifications",notification:"notification"},decls:5,vars:7,consts:[[3,"notification"],[1,"op-ian-actors--container"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"textContent",4,"ngIf"],[1,"op-ian-item--actors",3,"principal","hideName","hideAvatar","link"],[3,"textContent"]],template:function InAppNotificationActorsLineComponent_Template(e,t){1&e&&(o.nrm(0,"op-in-app-notification-relative-time",0),o.j41(1,"div",1),o.DNE(2,InAppNotificationActorsLineComponent_ng_container_2_Template,4,6,"ng-container",2),o.nI1(3,"slice"),o.DNE(4,InAppNotificationActorsLineComponent_span_4_Template,2,1,"span",3),o.k0s()),2&e&&(o.Y8G("notification",t.notification),o.R7$(2),o.Y8G("ngForOf",o.brH(3,3,t.actors,0,3)),o.R7$(2),o.Y8G("ngIf",t.actors.length>3))},dependencies:[P.Sq,P.bT,ke.f,InAppNotificationRelativeTimeComponent,P.P9],styles:[".cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-ian-actors{display:grid;grid-template-columns:auto 1fr;grid-column-gap:.25rem;align-items:center;color:var(--fgColor-muted)}.op-ian-actors--container{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;display:flex;white-space:pre-wrap;line-height:1rem}.op-ian-actors--container>*{flex-shrink:0}\n"],encapsulation:2,changeDetection:0})}}var Qi=n(39545);class InAppNotificationDateAlertComponent{constructor(e,t){this.I18n=e,this.timezoneService=t,this.className=!0,this.text={work_package_is:this.I18n.t("js.notifications.date_alerts.work_package_is"),overdue:this.I18n.t("js.notifications.date_alerts.overdue"),overdue_since:e=>this.I18n.t("js.notifications.date_alerts.overdue_since",{difference_in_days:e}),property_is:e=>this.I18n.t("js.notifications.date_alerts.property_is",{difference_in_days:e}),property_was:e=>this.I18n.t("js.notifications.date_alerts.property_was",{difference_in_days:e}),property_deleted:this.I18n.t("js.notifications.date_alerts.property_is_deleted"),startDate:this.I18n.t("js.work_packages.properties.startDate"),dueDate:this.I18n.t("js.work_packages.properties.dueDate"),date:this.I18n.t("js.notifications.date_alerts.milestone_date"),due_today:this.I18n.t("js.notifications.date_alerts.property_today"),note:""}}ngOnInit(){const e=this.deriveMostRelevantAlert(this.aggregatedNotifications)._embedded.details[0],t=e.property;e.value?this.deriveDueDate(e.value,t):(this.propertyText=this.text[t],this.alertText=this.text.property_deleted)}deriveDueDate(e,t){const n=this.timezoneService.parseISODate(e).startOf("day"),i=Qi();this.dateIsPast=n.isBefore(i,"day"),this.isOverdue=this.dateIsPast&&["date","dueDate"].includes(t);const o=this.dateDiff(n);this.propertyText=this.isOverdue&&o>0?this.text.overdue:this.text[t],this.alertText=this.buildAlertText(o)}buildAlertText(e){if(0===e)return this.text.due_today;const t=this.I18n.t("js.units.day",{count:e});return this.isOverdue?this.text.overdue_since(t):this.dateIsPast?this.text.property_was(t):this.text.property_is(t)}dateDiff(e){const t=Qi().startOf("day");return Math.abs(t.diff(e,"days"))}deriveMostRelevantAlert(e){const t=e.filter((e=>"dateAlert"===e.reason)),n=t[0];if(t.length>1){return t.find((e=>"dueDate"===e._embedded.details[0].property))||n}return n}static{this.ɵfac=function InAppNotificationDateAlertComponent_Factory(e){return new(e||InAppNotificationDateAlertComponent)(o.rXU(w.W),o.rXU(W.D))}}static{this.ɵcmp=o.VBU({type:InAppNotificationDateAlertComponent,selectors:[["op-in-app-notification-date-alert"]],hostVars:4,hostBindings:function InAppNotificationDateAlertComponent_HostBindings(e,t){2&e&&o.AVh("op-ian-date-alert",t.className)("op-ian-date-alert_overdue",t.isOverdue)},inputs:{aggregatedNotifications:"aggregatedNotifications"},decls:3,vars:2,consts:[[1,"op-ian-date-alert--property",3,"textContent"],[1,"op-ian-date-alert--days",3,"textContent"]],template:function InAppNotificationDateAlertComponent_Template(e,t){1&e&&(o.nrm(0,"span",0),o.EFF(1," "),o.nrm(2,"span",1)),2&e&&(o.Y8G("textContent",t.propertyText),o.R7$(2),o.Y8G("textContent",t.alertText))},styles:[".op-ian-date-alert{color:var(--fgColor-muted)}.op-ian-date-alert_overdue{color:var(--warn)}.op-ian-date-alert--property{font-weight:var(--base-text-weight-bold)}\n"],encapsulation:2,changeDetection:0})}}function InAppNotificationReminderAlertComponent_op_in_app_notification_date_alert_0_Template(e,t){if(1&e&&o.nrm(0,"op-in-app-notification-date-alert",3),2&e){const e=o.XpG();o.Y8G("aggregatedNotifications",e.dateAlerts)}}function InAppNotificationReminderAlertComponent_op_in_app_notification_relative_time_1_Template(e,t){if(1&e&&o.nrm(0,"op-in-app-notification-relative-time",4),2&e){const e=o.XpG();o.Y8G("notification",e.reminderAlert)("hasActorByLine",!1)}}class InAppNotificationReminderAlertComponent{constructor(e){this.I18n=e,this.className=!0,this.hasDateAlert=!1,this.dateAlerts=[]}ngOnInit(){this.reminderAlert=this.deriveMostRecentReminder(this.aggregatedNotifications),this.reminderNote=this.extractReminderNoteValue(this.reminderAlert._embedded.details),this.dateAlerts=this.aggregatedNotifications.filter((e=>"dateAlert"===e.reason)),this.hasDateAlert=this.dateAlerts.length>0}deriveMostRecentReminder(e){const t=e.filter((e=>"reminder"===e.reason));if(t.length>1){return t.reduce(((e,t)=>new Date(e.createdAt)>new Date(t.createdAt)?e:t))}return t[0]}extractReminderNoteValue(e){const t=e.find((e=>"note"===e.property));return t?.value?this.I18n.t("js.notifications.reminders.note",{note:t?.value}):""}static{this.ɵfac=function InAppNotificationReminderAlertComponent_Factory(e){return new(e||InAppNotificationReminderAlertComponent)(o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:InAppNotificationReminderAlertComponent,selectors:[["op-in-app-notification-reminder-alert"]],hostVars:2,hostBindings:function InAppNotificationReminderAlertComponent_HostBindings(e,t){2&e&&o.AVh("op-ian-reminder-alert",t.className)},inputs:{aggregatedNotifications:"aggregatedNotifications"},decls:3,vars:3,consts:[[3,"aggregatedNotifications",4,"ngIf"],[3,"notification","hasActorByLine",4,"ngIf"],[1,"op-ian-reminder-alert--note",3,"textContent"],[3,"aggregatedNotifications"],[3,"notification","hasActorByLine"]],template:function InAppNotificationReminderAlertComponent_Template(e,t){1&e&&(o.DNE(0,InAppNotificationReminderAlertComponent_op_in_app_notification_date_alert_0_Template,1,1,"op-in-app-notification-date-alert",0)(1,InAppNotificationReminderAlertComponent_op_in_app_notification_relative_time_1_Template,1,2,"op-in-app-notification-relative-time",1),o.nrm(2,"span",2)),2&e&&(o.Y8G("ngIf",t.hasDateAlert),o.R7$(),o.Y8G("ngIf",!t.hasDateAlert),o.R7$(),o.Y8G("textContent",t.reminderNote))},dependencies:[P.bT,InAppNotificationDateAlertComponent,InAppNotificationRelativeTimeComponent],styles:[".cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-ian-reminder-alert{display:grid;grid-template-columns:auto 1fr;grid-column-gap:.25rem;align-items:center;color:var(--fgColor-muted)}.op-ian-reminder-alert--note{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;line-height:1rem;color:var(--fgColor-default)}.op-ian-reminder-alert--note>*{flex-shrink:0}\n"],encapsulation:2,changeDetection:0})}}const in_app_notification_entry_component_c0=e=>({workPackageId:e});function InAppNotificationEntryComponent_ng_container_1_div_5_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",20),o.EFF(1," - "),o.j41(2,"a",21),o.bIt("click",(function InAppNotificationEntryComponent_ng_container_1_div_5_Template_a_click_2_listener(t){o.eBV(e);const n=o.XpG(2);return o.Njj(n.projectClicked(t))})),o.k0s(),o.EFF(3," - "),o.k0s()}if(2&e){const e=o.XpG(2);o.R7$(2),o.AVh("spot-link_inactive",e.isMobile()),o.Y8G("href",e.project.showUrl,o.B4B)("textContent",e.project.title)}}function InAppNotificationEntryComponent_ng_container_1_span_7_ng_container_2_Template(e,t){1&e&&(o.qex(0),o.EFF(1,", "),o.bVm())}function InAppNotificationEntryComponent_ng_container_1_span_7_Template(e,t){if(1&e&&(o.j41(0,"span",22),o.EFF(1),o.DNE(2,InAppNotificationEntryComponent_ng_container_1_span_7_ng_container_2_Template,2,0,"ng-container",19),o.k0s()),2&e){const e=t.$implicit,n=t.last;o.R7$(),o.SpI(" ",e.key,""),o.R7$(),o.Y8G("ngIf",!n)}}function InAppNotificationEntryComponent_ng_container_1_span_9_Template(e,t){if(1&e&&o.nrm(0,"span",23),2&e){const e=o.XpG(2);o.Y8G("textContent",e.aggregatedNotifications.length)}}function InAppNotificationEntryComponent_ng_container_1_i_11_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"i",24),o.bIt("click",(function InAppNotificationEntryComponent_ng_container_1_i_11_Template_i_click_0_listener(t){o.eBV(e);const n=o.XpG(2);return o.Njj(n.markAsRead(t,n.aggregatedNotifications))})),o.k0s()}if(2&e){const e=o.XpG(2);o.Y8G("title",e.text.mark_as_read)}}function InAppNotificationEntryComponent_ng_container_1_op_in_app_notification_reminder_alert_17_Template(e,t){if(1&e&&o.nrm(0,"op-in-app-notification-reminder-alert",25),2&e){const e=o.XpG(2);o.Y8G("aggregatedNotifications",e.aggregatedNotifications)}}function InAppNotificationEntryComponent_ng_container_1_ng_container_18_op_in_app_notification_date_alert_1_Template(e,t){if(1&e&&o.nrm(0,"op-in-app-notification-date-alert",25),2&e){const e=o.XpG(3);o.Y8G("aggregatedNotifications",e.aggregatedNotifications)}}function InAppNotificationEntryComponent_ng_container_1_ng_container_18_op_in_app_notification_actors_line_2_Template(e,t){if(1&e&&o.nrm(0,"op-in-app-notification-actors-line",27),2&e){const e=o.XpG(3);o.Y8G("notification",e.notification)("aggregatedNotifications",e.aggregatedNotifications)}}function InAppNotificationEntryComponent_ng_container_1_ng_container_18_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,InAppNotificationEntryComponent_ng_container_1_ng_container_18_op_in_app_notification_date_alert_1_Template,1,1,"op-in-app-notification-date-alert",18)(2,InAppNotificationEntryComponent_ng_container_1_ng_container_18_op_in_app_notification_actors_line_2_Template,1,2,"op-in-app-notification-actors-line",26),o.bVm()),2&e){const e=o.XpG(2);o.R7$(),o.Y8G("ngIf",e.showDateAlert),o.R7$(),o.Y8G("ngIf",!e.showDateAlert)}}function InAppNotificationEntryComponent_ng_container_1_Template(e,t){if(1&e){const e=o.RV6();o.qex(0),o.j41(1,"div",3)(2,"div",4),o.nrm(3,"op-in-app-notification-status",5),o.k0s(),o.nrm(4,"a",6),o.DNE(5,InAppNotificationEntryComponent_ng_container_1_div_5_Template,4,4,"div",7),o.j41(6,"div",8),o.DNE(7,InAppNotificationEntryComponent_ng_container_1_span_7_Template,3,2,"span",9),o.nI1(8,"keyvalue"),o.k0s(),o.DNE(9,InAppNotificationEntryComponent_ng_container_1_span_9_Template,1,1,"span",10),o.j41(10,"div",11),o.DNE(11,InAppNotificationEntryComponent_ng_container_1_i_11_Template,1,1,"i",12),o.j41(12,"i",13),o.bIt("keydown.enter",(function InAppNotificationEntryComponent_ng_container_1_Template_i_keydown_enter_12_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.showDetails())})),o.k0s()()(),o.j41(13,"div",14),o.nrm(14,"span",15)(15,"span",16),o.k0s(),o.j41(16,"div",17),o.DNE(17,InAppNotificationEntryComponent_ng_container_1_op_in_app_notification_reminder_alert_17_Template,1,1,"op-in-app-notification-reminder-alert",18)(18,InAppNotificationEntryComponent_ng_container_1_ng_container_18_Template,3,2,"ng-container",19),o.k0s(),o.bVm()}if(2&e){const e=t.ngIf,n=o.XpG();o.R7$(3),o.Y8G("status",e.status),o.R7$(),o.AVh("spot-link_inactive",n.isMobile()),o.Y8G("uiParams",o.eq3(19,in_app_notification_entry_component_c0,e.id))("textContent","#"+e.id),o.BMQ("title",e.subject),o.R7$(),o.Y8G("ngIf",n.project),o.R7$(2),o.Y8G("ngForOf",o.bMT(8,17,n.translatedReasons)),o.R7$(2),o.Y8G("ngIf",!n.notification.readIAN),o.R7$(2),o.Y8G("ngIf",!n.notification.readIAN),o.R7$(3),o.Y8G("ngClass","op-ian-item--work-package-type __hl_inline_type_"+e.type.id)("textContent",e.type.name),o.R7$(),o.AVh("-read",n.notification.readIAN),o.Y8G("textContent",e.subject),o.R7$(2),o.Y8G("ngIf",n.hasReminderAlert),o.R7$(),o.Y8G("ngIf",!n.hasReminderAlert)}}function InAppNotificationEntryComponent_ng_template_3_op_content_loader_1_Template(e,t){1&e&&(o.j41(0,"op-content-loader",32),o.qSk(),o.nrm(1,"rect",33)(2,"rect",34)(3,"rect",35),o.k0s())}function InAppNotificationEntryComponent_ng_template_3_Template(e,t){if(1&e&&(o.j41(0,"div",28),o.DNE(1,InAppNotificationEntryComponent_ng_template_3_op_content_loader_1_Template,4,0,"op-content-loader",29),o.nrm(2,"span",30),o.j41(3,"div",11),o.nrm(4,"i",31),o.k0s()()),2&e){const e=o.XpG();o.R7$(),o.Y8G("ngIf",e.workPackage$)}}class InAppNotificationEntryComponent{constructor(e,t,n,i,o,r,s){this.apiV3Service=e,this.I18n=t,this.storeService=n,this.timezoneService=i,this.pathHelper=o,this.deviceService=r,this.urlParams=s,this.className=!0,this.workPackage$=null,this.showDateAlert=!1,this.hasReminderAlert=!1,this.loading$=this.storeService.query.selectLoading(),this.text={loading:this.I18n.t("js.ajax.loading"),placeholder:this.I18n.t("js.placeholders.default"),mark_as_read:this.I18n.t("js.notifications.center.mark_as_read")}}ngOnInit(){const e=this.notification._links.resource?.href;this.workPackageId=e&&Ft.q.matchFromLink(e,"work_packages"),this.hasReminderAlert=this.hasNotificationReason("reminder"),this.showDateAlert=this.hasNotificationReason("dateAlert"),this.buildTranslatedReason(),this.buildProject(),this.loadWorkPackage()}hasNotificationReason(e){return this.aggregatedNotifications.some((t=>t.reason===e))}loadWorkPackage(){this.workPackageId&&(this.workPackage$=this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream())}onClick(){clearTimeout(this.clickTimer),this.clickTimer=setTimeout((()=>{this.showDetails()}),250)}showDetails(){if(!this.workPackageId)return;const e=this.showDateAlert?"overview":"activity";this.storeService.openSplitScreen(this.workPackageId,e)}onDoubleClick(){clearTimeout(this.clickTimer),this.showFullView()}showFullView(){const e=this.notification._links.resource?.href,t=e&&Ft.q.matchFromLink(e,"work_packages");this.storeService.openFullView(t)}projectClicked(e){e.stopPropagation()}markAsRead(e,t){e.stopPropagation(),this.storeService.markAsRead(t.map((e=>e.id)))}isMobile(){return this.deviceService.isMobile}buildTranslatedReason(){const e={};this.aggregatedNotifications.forEach((t=>{const n=this.I18n.t(`js.notifications.reasons.${t.reason}`,{defaultValue:t.reason||this.text.placeholder});e[n]=e[n]||0,e[n]+=1})),this.translatedReasons=e}buildProject(){const{project:e}=this.notification._links;e&&(this.project={...e,showUrl:this.pathHelper.projectPath((0,be.A)(e.href))})}static{this.ɵfac=function InAppNotificationEntryComponent_Factory(e){return new(e||InAppNotificationEntryComponent)(o.rXU(O.n),o.rXU(w.W),o.rXU(Li),o.rXU(W.D),o.rXU(B.B),o.rXU(rt.g),o.rXU(qi.Z))}}static{this.ɵcmp=o.VBU({type:InAppNotificationEntryComponent,selectors:[["op-in-app-notification-entry"]],hostVars:2,hostBindings:function InAppNotificationEntryComponent_HostBindings(e,t){2&e&&o.AVh("op-ian-item",t.className)},inputs:{notification:"notification",aggregatedNotifications:"aggregatedNotifications"},decls:5,vars:4,consts:[["workPackageLoading",""],[1,"op-ian-item--row",3,"click","dblclick"],[4,"ngIf","ngIfElse"],[1,"op-ian-item--top-line"],[1,"op-ian-item--status"],[3,"status"],["uiSref","work-packages.show",1,"op-ian-item--work-package-id-link","spot-link",3,"uiParams","textContent"],["class","op-ian-item--project",4,"ngIf"],[1,"op-ian-item--reason-wrapper"],["class","op-ian-item--reason",4,"ngFor","ngForOf"],["class","op-ian-item--reason-count",3,"textContent",4,"ngIf"],[1,"op-ian-item--buttons"],["data-test-selector","mark-as-read-button","class","op-ian-item--button icon-mark-read","tabindex","0",3,"title","click",4,"ngIf"],["tabindex","0",1,"op-ian-item--button","op-ian-item--button_shown-on-focus","icon-info1",3,"keydown.enter"],[1,"op-ian-item--middle-line"],[3,"ngClass","textContent"],[1,"op-ian-item--work-package-subject",3,"textContent"],[1,"op-ian-item--bottom-line"],[3,"aggregatedNotifications",4,"ngIf"],[4,"ngIf"],[1,"op-ian-item--project"],["target","_blank",1,"op-ian-item--project-link",3,"click","href","textContent"],[1,"op-ian-item--reason"],[1,"op-ian-item--reason-count",3,"textContent"],["data-test-selector","mark-as-read-button","tabindex","0",1,"op-ian-item--button","icon-mark-read",3,"click","title"],[3,"aggregatedNotifications"],[3,"notification","aggregatedNotifications",4,"ngIf"],[3,"notification","aggregatedNotifications"],[1,"op-ian-item--loading"],["class","op-ian-item--loading-indicator","viewBox","0 0 200 20",4,"ngIf"],[1,"op-ian-item--reason-count"],[1,"op-ian-item--button","icon-mark-read"],["viewBox","0 0 200 20",1,"op-ian-item--loading-indicator"],["x","0","y","0","width","100%","height","5","rx","1"],["x","0","y","7","width","100%","height","5","rx","1"],["x","0","y","14","width","80%","height","5","rx","1"]],template:function InAppNotificationEntryComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",1),o.bIt("click",(function InAppNotificationEntryComponent_Template_div_click_0_listener(){return o.eBV(e),o.Njj(t.onClick())}))("dblclick",(function InAppNotificationEntryComponent_Template_div_dblclick_0_listener(){return o.eBV(e),o.Njj(t.onDoubleClick())})),o.DNE(1,InAppNotificationEntryComponent_ng_container_1_Template,19,21,"ng-container",2),o.nI1(2,"async"),o.DNE(3,InAppNotificationEntryComponent_ng_template_3_Template,5,1,"ng-template",null,0,o.C5r),o.k0s()}if(2&e){const e=o.sdS(4);o.R7$(),o.Y8G("ngIf",t.workPackage$&&o.bMT(2,2,t.workPackage$))("ngIfElse",e)}},dependencies:[nt.UISref,nt.AnchorUISref,P.YU,P.Sq,P.bT,Yt.F,InAppNotificationStatusComponent,InAppNotificationActorsLineComponent,InAppNotificationDateAlertComponent,InAppNotificationReminderAlertComponent,P.Jj,P.lG],styles:['.cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-ian-item{display:block;background:var(--body-background);margin:0;padding:15px 10px;font-size:.9rem;border-top:1px solid var(--borderColor-default);height:100px}.op-ian-item:hover{background:var(--bgColor-neutral-muted)}.op-ian-item:first-child{border-top:none}.op-ian-item:last-of-type{border-bottom:1px solid var(--borderColor-default)}.op-ian-item_selected{background:var(--codeMirror-selection-bgColor)}.op-ian-item_selected:hover{background:hsl(from var(--codeMirror-selection-bgColor) h calc(s - 30) l)}.op-ian-item_read{background:var(--bgColor-muted)}.op-ian-item_read:hover{background:hsl(from var(--bgColor-neutral-muted) h s calc(l - .5))}.op-ian-item--row{padding:0;margin:0;background:transparent;border:0;font:inherit;text-align:inherit;width:100%;height:100%;display:grid;grid-template-rows:auto 14px auto;grid-template-areas:"header" "body" "footer";grid-gap:10px;align-items:center;cursor:pointer}.op-ian-item--top-line{grid-area:header;display:grid;grid-template-columns:max-content max-content minmax(0,max-content) minmax(0,max-content) auto minmax(20px,max-content);grid-template-areas:"status wpIdLink project reason count buttons";grid-column-gap:5px;font-size:var(--body-font-size);align-items:baseline}.op-ian-item--middle-line{grid-area:body;display:grid;grid-template-columns:auto 1fr;grid-column-gap:5px;line-height:normal}.op-ian-item--bottom-line{grid-area:footer}.op-ian-item--work-package-subject{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;font-weight:var(--base-text-weight-bold)}.op-ian-item--work-package-subject.-read{font-weight:400}.op-ian-item--work-package-id-link{grid-area:wpIdLink}.op-ian-item--project{grid-area:project;color:var(--fgColor-muted);overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}.op-ian-item--project-link,.op-ian-item--work-package-id-link{color:var(--fgColor-muted);font-weight:var(--base-text-weight-bold)}.op-ian-item--reason-count{grid-area:count;display:inline-flex;justify-content:center;align-items:center;box-sizing:content-box;height:16px;line-height:16px;width:16px;border-radius:.5rem;padding:0 .15rem;font-size:.7rem;font-weight:var(--base-text-weight-bold);background:var(--bgColor-accent-emphasis);color:#fff;flex-shrink:0;justify-self:flex-end;margin-right:5px}.op-ian-item--reason-wrapper{grid-area:reason;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;color:var(--fgColor-muted)}.op-ian-item--status{grid-area:status;margin-right:5px}.op-ian-item--buttons{grid-area:buttons;font-size:16px}.op-ian-item--button:hover{color:var(--accent-color)}.op-ian-item--button_shown-on-focus{position:absolute;right:-10000px}.op-ian-item--button_shown-on-focus:focus{right:0}.op-ian-item--loading-indicator{height:100%;display:block;grid-area:loadingIndicator}.op-ian-item--loading-indicator svg{height:70px}.op-ian-item--loading{display:grid;grid-template-columns:max-content auto minmax(20px,max-content);grid-template-areas:"loadingIndicator count buttons";grid-column-gap:5px}\n'],encapsulation:2,changeDetection:0})}}function InAppNotificationCenterComponent_ng_container_4_ng_container_1_op_in_app_notification_entry_2_Template(e,t){if(1&e&&(o.nrm(0,"op-in-app-notification-entry",9),o.nI1(1,"async"),o.nI1(2,"async")),2&e){const e=t.$implicit,n=o.XpG(3);o.AVh("op-ian-item_expanded",e[0].expanded)("op-ian-item_read",!0===e[0].readIAN)("op-ian-item_selected",o.bMT(1,12,n.selectedWorkPackage$)===n.idFromLink(e[0]._links.resource.href)),o.x72("data-test-selector","op-ian-notification-item-",e[0].id,""),o.Y8G("notification",e[0])("aggregatedNotifications",e),o.BMQ("data-qa-ian-read",!0===e[0].readIAN||void 0)("data-qa-ian-selected",o.bMT(2,14,n.selectedWorkPackage$)===n.idFromLink(e[0]._links.resource.href))}}function InAppNotificationCenterComponent_ng_container_4_ng_container_1_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"cdk-virtual-scroll-viewport",7),o.DNE(2,InAppNotificationCenterComponent_ng_container_4_ng_container_1_op_in_app_notification_entry_2_Template,3,16,"op-in-app-notification-entry",8),o.nI1(3,"async"),o.k0s(),o.bVm()),2&e){const e=o.XpG(2);o.R7$(2),o.Y8G("cdkVirtualForOf",o.bMT(3,3,e.notifications$))("cdkVirtualForTrackBy",e.trackNotificationGroups)("cdkVirtualForTemplateCacheSize",0)}}function InAppNotificationCenterComponent_ng_container_4_ng_template_3_span_5_Template(e,t){if(1&e&&o.nrm(0,"span",13),2&e){const e=o.XpG(3);o.Y8G("textContent",e.text.no_results.with_current_filter)}}function InAppNotificationCenterComponent_ng_container_4_ng_template_3_ng_container_7_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"p"),o.nrm(2,"span",13)(3,"br")(4,"span",16),o.k0s(),o.bVm()),2&e){const e=o.XpG(3);o.R7$(2),o.Y8G("textContent",e.text.no_results.at_all),o.R7$(2),o.Y8G("innerHTML",e.text.change_notification_settings,o.npT)}}function InAppNotificationCenterComponent_ng_container_4_ng_template_3_Template(e,t){if(1&e&&(o.j41(0,"div",10),o.nrm(1,"img",11),o.j41(2,"p",12),o.nrm(3,"span",13),o.nI1(4,"async"),o.k0s(),o.DNE(5,InAppNotificationCenterComponent_ng_container_4_ng_template_3_span_5_Template,1,1,"span",14),o.nI1(6,"async"),o.DNE(7,InAppNotificationCenterComponent_ng_container_4_ng_template_3_ng_container_7_Template,5,2,"ng-container",15),o.nI1(8,"async"),o.k0s()),2&e){const e=o.XpG(2);o.R7$(),o.Y8G("src",e.image.no_notification,o.B4B),o.R7$(2),o.Y8G("textContent",e.noNotificationText(o.bMT(4,4,e.totalCount$)>0)),o.R7$(2),o.Y8G("ngIf",o.bMT(6,6,e.totalCount$)>0),o.R7$(2),o.Y8G("ngIf",0===o.bMT(8,8,e.totalCount$))}}function InAppNotificationCenterComponent_ng_container_4_Template(e,t){if(1&e&&(o.qex(0),o.DNE(1,InAppNotificationCenterComponent_ng_container_4_ng_container_1_Template,4,5,"ng-container",4),o.nI1(2,"async"),o.DNE(3,InAppNotificationCenterComponent_ng_container_4_ng_template_3_Template,9,10,"ng-template",null,1,o.C5r),o.bVm()),2&e){const e=o.sdS(4),t=o.XpG();o.R7$(),o.Y8G("ngIf",o.bMT(2,2,t.hasNotifications$))("ngIfElse",e)}}function InAppNotificationCenterComponent_ng_template_6_Template(e,t){if(1&e&&(o.j41(0,"div",10),o.nrm(1,"img",17),o.k0s()),2&e){const e=o.XpG();o.R7$(),o.Y8G("src",e.image.loading,o.B4B)}}function InAppNotificationCenterComponent_p_9_Template(e,t){if(1&e&&(o.nrm(0,"p",18),o.nI1(1,"async")),2&e){const e=o.XpG();o.Y8G("textContent",o.bMT(1,1,e.totalCountWarning$))}}class InAppNotificationCenterComponent{constructor(e,t,n,i,o,r,s,a,l,c){this.cdRef=e,this.elementRef=t,this.I18n=n,this.storeService=i,this.bellService=o,this.urlParams=r,this.state=s,this.apiV3=a,this.pathService=l,this.colorsService=c,this.maxSize=Hi.y,this.hasMoreThanPageSize$=this.storeService.hasMoreThanPageSize$,this.hasNotifications$=this.storeService.hasNotifications$,this.notifications$=this.storeService.notifications$,this.loading$=this.storeService.loading$,this.totalCount$=this.bellService.unread$,this.totalCountWarning$=this.storeService.notLoaded$.pipe((0,Z.p)((e=>e>0)),(0,G.T)((e=>this.I18n.t("js.notifications.center.total_count_warning",{newest_count:this.maxSize,more_count:e})))),this.selectedWorkPackage$=this.storeService.selectedWorkPackage$,this.reasonMenuItems=[{key:"mentioned",title:this.I18n.t("js.notifications.reasons.mentioned")},{key:"assigned",title:this.I18n.t("js.label_assignee")},{key:"responsible",title:this.I18n.t("js.notifications.reasons.accountable")},{key:"watched",title:this.I18n.t("js.notifications.reasons.watched")},{key:"dateAlert",title:this.I18n.t("js.notifications.reasons.dateAlert")},{key:"shared",title:this.I18n.t("js.notifications.reasons.shared")},{key:"reminder",title:this.I18n.t("js.notifications.reasons.reminder")}],this.selectedFilter=this.reasonMenuItems.find((e=>e.key===this.urlParams.get("name")))?.title,this.image={no_notification:(0,In.d)("notification-center/empty-state-no-notification.svg"),no_selection:(0,In.d)("notification-center/empty-state-no-selection.svg"),loading:(0,In.d)(`notification-center/notification_loading_${this.colorsService.colorMode()}.gif`)},this.trackNotificationGroups=(e,t)=>t.map((e=>`${e.id}@${e.updatedAt}`)).join(","),this.text={no_notification:this.I18n.t("js.notifications.center.empty_state.no_notification"),no_notification_with_current_filter_project:this.I18n.t("js.notifications.center.empty_state.no_notification_with_current_project_filter"),no_notification_for_filter:this.I18n.t("js.notifications.center.empty_state.no_notification_for_filter"),no_selection:this.I18n.t("js.notifications.center.empty_state.no_selection"),change_notification_settings:this.I18n.t("js.notifications.settings.change_notification_settings",{url:this.pathService.myNotificationsSettingsPath()}),title:this.I18n.t("js.notifications.title"),button_close:this.I18n.t("js.button_close"),no_results:{at_all:this.I18n.t("js.notifications.center.no_results.at_all",{url:this.pathService.myNotificationsSettingsPath()}),with_current_filter:this.I18n.t("js.notifications.center.no_results.with_current_filter")}},this.idFromLink=be.A}ngOnInit(){const e=this.urlParams.get("facet")||"unread";this.storeService.setFacet(e),this.storeService.setFilters({filter:this.urlParams.get("filter"),name:this.urlParams.get("name")})}noNotificationText(e){return e?"project"===this.urlParams.get("filter")?this.text.no_notification_with_current_filter_project:this.text.no_notification_for_filter:this.text.no_notification}static{this.ɵfac=function InAppNotificationCenterComponent_Factory(e){return new(e||InAppNotificationCenterComponent)(o.rXU(o.gRc),o.rXU(o.aKT),o.rXU(w.W),o.rXU(Li),o.rXU($i.n),o.rXU(qi.Z),o.rXU(ye.dw),o.rXU(O.n),o.rXU(B.B),o.rXU(zi.e))}}static{this.ɵcmp=o.VBU({type:InAppNotificationCenterComponent,selectors:[["ng-component"]],decls:11,vars:13,consts:[["loading",""],["noResults",""],[1,"op-ian-center"],[1,"op-ian-center--content"],[4,"ngIf","ngIfElse"],[1,"op-ian-center--footer"],["class","op-ian-center--max-warning",3,"textContent",4,"ngIf"],["itemSize","100",1,"op-ian-center--viewport"],["class","op-ian-item",3,"op-ian-item_expanded","op-ian-item_read","op-ian-item_selected","notification","aggregatedNotifications",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy","cdkVirtualForTemplateCacheSize"],[1,"op-ian-item",3,"notification","aggregatedNotifications"],[1,"op-ian-center--loading-indicator"],[1,"op-ian-center-loading-image",3,"src"],[1,"op-ian-center-loading-text"],[3,"textContent"],[3,"textContent",4,"ngIf"],[4,"ngIf"],[3,"innerHTML"],["data-test-selector","op-ian-center--loading-indicator",1,"op-ian-center-loading-image",3,"src"],[1,"op-ian-center--max-warning",3,"textContent"]],template:function InAppNotificationCenterComponent_Template(e,t){if(1&e&&(o.j41(0,"div",2)(1,"div",3),o.nI1(2,"async"),o.nI1(3,"async"),o.DNE(4,InAppNotificationCenterComponent_ng_container_4_Template,5,4,"ng-container",4),o.nI1(5,"async"),o.DNE(6,InAppNotificationCenterComponent_ng_template_6_Template,2,1,"ng-template",null,0,o.C5r),o.k0s(),o.j41(8,"div",5),o.DNE(9,InAppNotificationCenterComponent_p_9_Template,2,3,"p",6),o.nI1(10,"async"),o.k0s()()),2&e){const e=o.sdS(7);o.R7$(),o.AVh("op-ian-center--content_empty",!0===o.bMT(2,5,t.loading$)||!1===o.bMT(3,7,t.hasNotifications$)),o.R7$(3),o.Y8G("ngIf",!1===o.bMT(5,9,t.loading$))("ngIfElse",e),o.R7$(5),o.Y8G("ngIf",o.bMT(10,11,t.hasMoreThanPageSize$))}},dependencies:[P.bT,Ei.yg,Ei.E$,Ei.d6,InAppNotificationEntryComponent,P.Jj],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-ian-center[_ngcontent-%COMP%]{display:grid;grid-template-rows:1fr auto;height:100%}.op-ian-center--content[_ngcontent-%COMP%]{height:100%;border:1px solid var(--borderColor-muted);border-radius:var(--borderRadius-medium);border-bottom-left-radius:0;border-bottom-right-radius:0;overflow:hidden}.op-ian-center--content_empty[_ngcontent-%COMP%]{display:flex;align-items:center}.op-ian-center--viewport[_ngcontent-%COMP%]{height:100%;overflow-x:hidden;scrollbar-color:transparent transparent;scrollbar-width:thin}.op-ian-center--viewport[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.op-ian-center--viewport[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.op-ian-center--viewport[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.op-ian-center--viewport[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.op-ian-center--viewport[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.op-ian-center--max-warning[_ngcontent-%COMP%]{margin-bottom:0;text-align:center;font-style:italic}.op-ian-center--loading-indicator[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center;max-width:677px;margin:0 auto}.-browser-safari   .op-ian-center   [_nghost-%COMP%]{height:100%}.op-ian-center-loading-text[_ngcontent-%COMP%]{color:var(--fgColor-muted);font-size:18px}.op-ian-center-loading-image[_ngcontent-%COMP%]{max-height:130px;min-height:130px;margin-bottom:15px}"],changeDetection:0})}}var Ki=n(915),Ji=n(95393);class InAppNotificationsDateAlertsUpsaleComponent{constructor(e){this.I18n=e,this.video=(0,Ki.J)("notification-center/date-alert-notifications.mp4"),this.text={title:this.I18n.t("js.notifications.date_alerts.upsale.title"),description:this.I18n.t("js.notifications.date_alerts.upsale.description")}}static{this.ɵfac=function InAppNotificationsDateAlertsUpsaleComponent_Factory(e){return new(e||InAppNotificationsDateAlertsUpsaleComponent)(o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:InAppNotificationsDateAlertsUpsaleComponent,selectors:[["op-ian-date-alerts-upsale"]],decls:1,vars:4,consts:[[3,"feature_video","feature_title","feature_description","hide_breadcrumb"]],template:function InAppNotificationsDateAlertsUpsaleComponent_Template(e,t){1&e&&o.nrm(0,"op-enterprise-page",0),2&e&&o.Y8G("feature_video",t.video)("feature_title",t.text.title)("feature_description",t.text.description)("hide_breadcrumb",!0)},dependencies:[Ji.U],encapsulation:2,changeDetection:0})}}var Zi=n(83786),eo=n(54547);class OpenProjectInAppNotificationsModule{static{this.ɵfac=function OpenProjectInAppNotificationsModule_Factory(e){return new(e||OpenProjectInAppNotificationsModule)}}static{this.ɵmod=o.$C({type:OpenProjectInAppNotificationsModule})}static{this.ɵinj=o.G2t({providers:[$i.n,Li],imports:[d.d,f.oW,P.MD,et.o,eo.W,h.W,Zi.Q,Ei.E9]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenProjectInAppNotificationsModule,{declarations:[InAppNotificationBellComponent,InAppNotificationCenterComponent,InAppNotificationEntryComponent,InAppNotificationStatusComponent,InAppNotificationActorsLineComponent,InAppNotificationDateAlertComponent,InAppNotificationsDateAlertsUpsaleComponent,InAppNotificationRelativeTimeComponent,InAppNotificationReminderAlertComponent],imports:[d.d,f.oW,P.MD,et.o,eo.W,h.W,Zi.Q,Ei.E9]});class OpenProjectBackupService{constructor(e){this.apiV3Service=e}triggerBackup(e,t=!0){return this.apiV3Service.backups.post(e,t)}static{this.ɵfac=function OpenProjectBackupService_Factory(e){return new(e||OpenProjectBackupService)(o.KVO(O.n))}}static{this.ɵprov=o.jDH({token:OpenProjectBackupService,factory:OpenProjectBackupService.ɵfac,providedIn:"root"})}}var to=n(75716),no=n(24443),io=n(42032),oo=n(48940);class OpenProjectStateModule{static{this.ɵfac=function OpenProjectStateModule_Factory(e){return new(e||OpenProjectStateModule)}}static{this.ɵmod=o.$C({type:OpenProjectStateModule})}static{this.ɵinj=o.G2t({providers:[ui._,Yi.u,to.s,no.V,Sn.W,io.o,oo.c]})}}var ro=n(10304),so=n(3705);class FogUploadService extends bi.u{constructor(e){super(),this.http=e}upload(e,t){return t.map((t=>this.uploadSingle(e,t)))}uploadSingle(e,t){return this.prepareUpload(e,t).pipe((0,ae.n)((e=>this.performUpload(e.upload.href,e.upload.method,e.upload.form).pipe((0,ae.n)(this.finishUpload(e.finishUrl))))),(0,wn.u)())}prepareUpload(e,t){const n=t.file.name,i={fileName:n,contentType:t.file.type||n&&(0,so.getType)(n)||"",description:t.description,fileSize:t.file.size},o=new FormData;return o.append("metadata",JSON.stringify(i)),this.http.request("post",e,{body:o,withCredentials:!0,responseType:"json"}).pipe((0,G.T)((e=>{const n=new FormData,i=e._links.addAttachment.form_fields;return Object.entries(i).forEach((([e,t])=>{n.append(e,t)})),n.append("file",t.file,t.file.name),{upload:{href:e._links.addAttachment.href,method:e._links.addAttachment.method,form:n},finishUrl:e._links.completeUpload.href}})))}performUpload(e,t,n){return this.http.request(t,e,{body:n,observe:"events",headers:{[ro.e]:"true"},responseType:"text",reportProgress:!0})}finishUpload(e){return t=>t.type===s.hv.Response?this.http.get(e,{observe:"response"}):(0,je.of)(t)}}class LocalUploadService extends bi.u{constructor(e){super(),this.http=e}upload(e,t){return t.map((t=>this.uploadSingle(e,t)))}uploadSingle(e,t){const n=new FormData,i={description:t.description,fileName:t.file.name};return n.append("metadata",JSON.stringify(i)),n.append("file",t.file,i.fileName),this.http.request("post",e,{body:n,observe:"events",withCredentials:!0,responseType:"json",reportProgress:!0}).pipe((0,wn.u)())}}var ao=n(17573),lo=n(58192),co=n(17564),po=n(27834),uo=n(43487),ho=n(84878),mo=n(58945),go=n(80328),_o=n(66094),fo=n(34629),bo=n(6522),ko=n(43258),vo=n(57940),Co=n(56008);class OpenProjectJobStatusModule{static{this.ɵfac=function OpenProjectJobStatusModule_Factory(e){return new(e||OpenProjectJobStatusModule)}}static{this.ɵmod=o.$C({type:OpenProjectJobStatusModule})}static{this.ɵinj=o.G2t({providers:[Co._],imports:[P.MD,d.d]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenProjectJobStatusModule,{imports:[P.MD,d.d]});let yo=class UserPreferencesStore extends Pi.il{constructor(){super({autoHidePopups:!0,commentSortDescending:!1,timeZone:null,warnOnLeavingUnsaved:!0,notifications:[],dailyReminders:{enabled:!0,times:["08:00"]},workdays:[1,2,3,4,5],immediateReminders:{mentioned:!1,personalReminder:!1},pauseReminders:{enabled:!1}})}};yo=(0,U.Cg)([(0,Pi.g7)({name:"notification-settings"}),(0,U.Sn)("design:paramtypes",[])],yo);class UserPreferencesQuery extends Pi.XK{constructor(e){super(e),this.store=e,this.notificationSettings$=this.select("notifications"),this.notificationsGroupedByProject$=this.notificationSettings$.pipe((0,G.T)((e=>e.filter((e=>e._links.project.href)))),(0,G.T)((e=>_.groupBy(e,(e=>e._links.project.title))))),this.notificationsForGlobal$=this.notificationSettings$.pipe((0,G.T)((e=>e.find((e=>null===e._links.project.href))))),this.projectNotifications$=this.notificationSettings$.pipe((0,G.T)((e=>e.filter((e=>null!==e._links.project.href))))),this.globalNotification$=this.notificationSettings$.pipe((0,G.T)((e=>e.find((e=>!e._links.project.href)))),(0,Z.p)((e=>!!e))),this.selectedProjects$=this.notificationSettings$.pipe((0,G.T)((e=>new Set(e.map((e=>e._links.project?.href)))))),this.dailyReminders$=this.select("dailyReminders"),this.dailyRemindersEnabled$=this.dailyReminders$.pipe((0,G.T)((e=>e.enabled))),this.dailyRemindersTimes$=this.dailyReminders$.pipe((0,G.T)((e=>e.times))),this.preferences$=this.select()}}class UserPreferencesService{constructor(e,t,n){this.apiV3Service=e,this.toastService=t,this.I18n=n,this.store=new yo,this.query=new UserPreferencesQuery(this.store)}get(e){this.store.setLoading(!0),this.preferenceAPI(e).get().subscribe((e=>this.store.update(e)),(e=>this.toastService.addError(e))).add((()=>this.store.setLoading(!1)))}update(e,t){this.store.setLoading(!0),this.preferenceAPI(e).patch(t).subscribe((e=>{this.store.update(e),this.toastService.addSuccess(this.I18n.t("js.notice_successful_update"))}),(e=>this.toastService.addError(e))).add((()=>this.store.setLoading(!1)))}preferenceAPI(e){return this.apiV3Service.users.id(e).preferences}static{this.ɵfac=function UserPreferencesService_Factory(e){return new(e||UserPreferencesService)(o.KVO(O.n),o.KVO(R.fw),o.KVO(w.W))}}static{this.ɵprov=o.jDH({token:UserPreferencesService,factory:UserPreferencesService.ɵfac,providedIn:"root"})}}function reminderAvailableTimeframes(){return[{value:"PT0S",title:window.I18n.t("js.notifications.settings.reminders.timeframes.normal.PT0S")},{value:"P1D",title:window.I18n.t("js.notifications.settings.reminders.timeframes.normal.P1D")},{value:"P3D",title:window.I18n.t("js.notifications.settings.reminders.timeframes.normal.P3D")},{value:"P7D",title:window.I18n.t("js.notifications.settings.reminders.timeframes.normal.P7D")}]}function overDueReminderTimes(){return[{value:"P1D",title:window.I18n.t("js.notifications.settings.reminders.timeframes.overdue.P1D")},{value:"P3D",title:window.I18n.t("js.notifications.settings.reminders.timeframes.overdue.P3D")},{value:"P7D",title:window.I18n.t("js.notifications.settings.reminders.timeframes.overdue.P7D")}]}var wo=n(73704);function NotificationSettingInlineCreateComponent_button_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"button",3),o.bIt("click",(function NotificationSettingInlineCreateComponent_button_1_Template_button_click_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.active=!0)})),o.nrm(1,"span",4)(2,"span",5),o.k0s()}if(2&e){const e=o.XpG();o.R7$(2),o.Y8G("textContent",e.text.add_setting)}}function NotificationSettingInlineCreateComponent_op_project_autocompleter_2_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"op-project-autocompleter",6),o.bIt("change",(function NotificationSettingInlineCreateComponent_op_project_autocompleter_2_Template_op_project_autocompleter_change_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.selectProject(t))}))("keydown.escape",(function NotificationSettingInlineCreateComponent_op_project_autocompleter_2_Template_op_project_autocompleter_keydown_escape_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.active=!1)})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("filters",e.APIFilters)("mapResultsFn",e.mapProjectsFn.bind(e))("placeholder",e.text.please_select)}}class NotificationSettingInlineCreateComponent{get APIFilters(){return[{name:"visible",operator:"=",values:[this.userId]}]}constructor(e){this.I18n=e,this.selected=new o.bkB,this.active=!1,this.text={add_setting:this.I18n.t("js.notifications.settings.project_specific.add"),please_select:this.I18n.t("js.placeholders.selection"),already_selected:this.I18n.t("js.notifications.settings.project_specific.already_selected")}}selectProject(e){this.selected.emit({title:e.name,href:e.href}),this.active=!1}mapProjectsFn(e){return e.map((e=>({...e,disabled:!!this.settings.controls.find((t=>t.get("project").value.href===e.href)),disabledReason:this.text.already_selected})))}static{this.ɵfac=function NotificationSettingInlineCreateComponent_Factory(e){return new(e||NotificationSettingInlineCreateComponent)(o.rXU(w.W))}}static{this.ɵcmp=o.VBU({type:NotificationSettingInlineCreateComponent,selectors:[["op-notification-setting-inline-create"]],inputs:{userId:"userId",settings:"settings"},outputs:{selected:"selected"},decls:3,vars:2,consts:[[1,"inline-create-container"],["class","spot-link","type","button",3,"click",4,"ngIf"],["dropdownPosition","top",3,"filters","mapResultsFn","placeholder","change","keydown.escape",4,"ngIf"],["type","button",1,"spot-link",3,"click"],[1,"spot-icon","spot-icon_add"],[3,"textContent"],["dropdownPosition","top",3,"change","keydown.escape","filters","mapResultsFn","placeholder"]],template:function NotificationSettingInlineCreateComponent_Template(e,t){1&e&&(o.j41(0,"div",0),o.DNE(1,NotificationSettingInlineCreateComponent_button_1_Template,3,1,"button",1)(2,NotificationSettingInlineCreateComponent_op_project_autocompleter_2_Template,1,3,"op-project-autocompleter",2),o.k0s()),2&e&&(o.R7$(),o.Y8G("ngIf",!t.active),o.R7$(),o.Y8G("ngIf",t.active))},dependencies:[P.bT,fn.j],styles:[".inline-create-container[_ngcontent-%COMP%]{margin-top:1rem}"],changeDetection:0})}}function NotificationSettingsTableComponent_div_0_ng_container_6_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"th",4)(2,"a",8),o.EFF(3),o.k0s()(),o.bVm()),2&e){const e=t.$implicit,n=o.XpG(2);o.R7$(2),o.Y8G("href",n.projectLink(e.controls.project.value.href),o.B4B),o.R7$(),o.JRh(e.controls.project.value.title)}}function NotificationSettingsTableComponent_div_0_ng_container_14_Template(e,t){1&e&&(o.qex(0),o.nrm(1,"td",9),o.bVm())}function NotificationSettingsTableComponent_div_0_ng_container_18_Template(e,t){1&e&&(o.qex(0),o.j41(1,"td",9),o.nrm(2,"input",10),o.k0s(),o.bVm())}function NotificationSettingsTableComponent_div_0_ng_container_22_Template(e,t){1&e&&(o.qex(0),o.j41(1,"td",9),o.nrm(2,"input",10),o.k0s(),o.bVm())}function NotificationSettingsTableComponent_div_0_ng_container_26_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"td",11),o.nrm(2,"input",12),o.k0s(),o.bVm()),2&e){const e=t.$implicit;o.R7$(),o.Y8G("formGroup",e),o.R7$(),o.BMQ("data-qa-project",e.controls.project.value.title)}}function NotificationSettingsTableComponent_div_0_ng_container_30_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"td",11),o.nrm(2,"input",13),o.k0s(),o.bVm()),2&e){const e=t.$implicit;o.R7$(),o.Y8G("formGroup",e),o.R7$(),o.BMQ("data-qa-project",e.controls.project.value.title)}}function NotificationSettingsTableComponent_div_0_ng_container_34_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"td",11),o.nrm(2,"input",14),o.k0s(),o.bVm()),2&e){const e=t.$implicit;o.R7$(),o.Y8G("formGroup",e),o.R7$(),o.BMQ("data-qa-project",e.controls.project.value.title)}}function NotificationSettingsTableComponent_div_0_tr_35_ng_container_6_Template(e,t){1&e&&(o.qex(0),o.nrm(1,"td",9),o.bVm())}function NotificationSettingsTableComponent_div_0_tr_35_Template(e,t){if(1&e&&(o.j41(0,"tr")(1,"th",6)(2,"h5"),o.EFF(3),o.k0s(),o.j41(4,"p"),o.EFF(5),o.k0s()(),o.DNE(6,NotificationSettingsTableComponent_div_0_tr_35_ng_container_6_Template,2,0,"ng-container",5),o.k0s()),2&e){const e=o.XpG(2);o.R7$(3),o.JRh(e.text.dateAlerts.title),o.R7$(2),o.JRh(e.text.dateAlerts.description),o.R7$(),o.Y8G("ngForOf",e.settings.controls)}}function NotificationSettingsTableComponent_div_0_tr_36_ng_container_3_option_3_Template(e,t){if(1&e&&(o.j41(0,"option",18),o.EFF(1),o.k0s()),2&e){const e=t.$implicit;o.Y8G("ngValue",e.value),o.R7$(),o.SpI(" ",e.title," ")}}function NotificationSettingsTableComponent_div_0_tr_36_ng_container_3_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"td",15)(2,"select",16),o.DNE(3,NotificationSettingsTableComponent_div_0_tr_36_ng_container_3_option_3_Template,2,2,"option",17),o.k0s()(),o.bVm()),2&e){const e=t.$implicit,n=o.XpG(3);o.R7$(),o.Y8G("formGroup",e),o.R7$(),o.BMQ("data-qa-project",e.controls.project.value.title),o.R7$(),o.Y8G("ngForOf",n.availableTimes)}}function NotificationSettingsTableComponent_div_0_tr_36_Template(e,t){if(1&e&&(o.j41(0,"tr")(1,"th",6),o.EFF(2),o.k0s(),o.DNE(3,NotificationSettingsTableComponent_div_0_tr_36_ng_container_3_Template,4,3,"ng-container",5),o.k0s()),2&e){const e=o.XpG(2);o.R7$(2),o.SpI(" ",e.text.startDate," "),o.R7$(),o.Y8G("ngForOf",e.settings.controls)}}function NotificationSettingsTableComponent_div_0_tr_37_ng_container_3_option_3_Template(e,t){if(1&e&&(o.j41(0,"option",18),o.EFF(1),o.k0s()),2&e){const e=t.$implicit;o.Y8G("ngValue",e.value),o.R7$(),o.SpI(" ",e.title," ")}}function NotificationSettingsTableComponent_div_0_tr_37_ng_container_3_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"td",15)(2,"select",19),o.DNE(3,NotificationSettingsTableComponent_div_0_tr_37_ng_container_3_option_3_Template,2,2,"option",17),o.k0s()(),o.bVm()),2&e){const e=t.$implicit,n=o.XpG(3);o.R7$(),o.Y8G("formGroup",e),o.R7$(),o.BMQ("data-qa-project",e.controls.project.value.title),o.R7$(),o.Y8G("ngForOf",n.availableTimes)}}function NotificationSettingsTableComponent_div_0_tr_37_Template(e,t){if(1&e&&(o.j41(0,"tr")(1,"th",6),o.EFF(2),o.k0s(),o.DNE(3,NotificationSettingsTableComponent_div_0_tr_37_ng_container_3_Template,4,3,"ng-container",5),o.k0s()),2&e){const e=o.XpG(2);o.R7$(2),o.SpI(" ",e.text.dueDate," "),o.R7$(),o.Y8G("ngForOf",e.settings.controls)}}function NotificationSettingsTableComponent_div_0_tr_38_ng_container_3_option_3_Template(e,t){if(1&e&&(o.j41(0,"option",18),o.EFF(1),o.k0s()),2&e){const e=t.$implicit;o.Y8G("ngValue",e.value),o.R7$(),o.SpI(" ",e.title," ")}}function NotificationSettingsTableComponent_div_0_tr_38_ng_container_3_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"td",15)(2,"select",20),o.DNE(3,NotificationSettingsTableComponent_div_0_tr_38_ng_container_3_option_3_Template,2,2,"option",17),o.k0s()(),o.bVm()),2&e){const e=t.$implicit,n=o.XpG(3);o.R7$(),o.Y8G("formGroup",e),o.R7$(),o.BMQ("data-qa-project",e.controls.project.value.title),o.R7$(),o.Y8G("ngForOf",n.availableTimesOverdue)}}function NotificationSettingsTableComponent_div_0_tr_38_Template(e,t){if(1&e&&(o.j41(0,"tr")(1,"th",6),o.EFF(2),o.k0s(),o.DNE(3,NotificationSettingsTableComponent_div_0_tr_38_ng_container_3_Template,4,3,"ng-container",5),o.k0s()),2&e){const e=o.XpG(2);o.R7$(2),o.SpI(" ",e.text.overdue," "),o.R7$(),o.Y8G("ngForOf",e.settings.controls)}}function NotificationSettingsTableComponent_div_0_ng_container_45_Template(e,t){1&e&&(o.qex(0),o.nrm(1,"td",9),o.bVm())}function NotificationSettingsTableComponent_div_0_ng_container_49_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"td",11),o.nrm(2,"input",21),o.k0s(),o.bVm()),2&e){const e=t.$implicit;o.R7$(),o.Y8G("formGroup",e),o.R7$(),o.BMQ("data-qa-project",e.controls.project.value.title)}}function NotificationSettingsTableComponent_div_0_ng_container_53_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"td",11),o.nrm(2,"input",22),o.k0s(),o.bVm()),2&e){const e=t.$implicit;o.R7$(),o.Y8G("formGroup",e),o.R7$(),o.BMQ("data-qa-project",e.controls.project.value.title)}}function NotificationSettingsTableComponent_div_0_ng_container_57_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"td",11),o.nrm(2,"input",23),o.k0s(),o.bVm()),2&e){const e=t.$implicit;o.R7$(),o.Y8G("formGroup",e),o.R7$(),o.BMQ("data-qa-project",e.controls.project.value.title)}}function NotificationSettingsTableComponent_div_0_ng_container_61_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"td",11),o.nrm(2,"input",24),o.k0s(),o.bVm()),2&e){const e=t.$implicit;o.R7$(),o.Y8G("formGroup",e),o.R7$(),o.BMQ("data-qa-project",e.controls.project.value.title)}}function NotificationSettingsTableComponent_div_0_ng_container_65_Template(e,t){if(1&e&&(o.qex(0),o.j41(1,"td",11),o.nrm(2,"input",25),o.k0s(),o.bVm()),2&e){const e=t.$implicit;o.R7$(),o.Y8G("formGroup",e),o.R7$(),o.BMQ("data-qa-project",e.controls.project.value.title)}}function NotificationSettingsTableComponent_div_0_ng_container_68_Template(e,t){if(1&e){const e=o.RV6();o.qex(0),o.j41(1,"td",9)(2,"button",26),o.bIt("click",(function NotificationSettingsTableComponent_div_0_ng_container_68_Template_button_click_2_listener(){const t=o.eBV(e).index,n=o.XpG(2);return o.Njj(n.removeProjectSettings(t))})),o.EFF(3),o.k0s()(),o.bVm()}if(2&e){const e=o.XpG(2);o.R7$(3),o.SpI(" ",e.text.remove_project_settings," ")}}function NotificationSettingsTableComponent_div_0_Template(e,t){if(1&e&&(o.j41(0,"div",2)(1,"table",3)(2,"thead")(3,"tr")(4,"th",4),o.EFF(5),o.k0s(),o.DNE(6,NotificationSettingsTableComponent_div_0_ng_container_6_Template,4,2,"ng-container",5),o.k0s()(),o.j41(7,"tbody")(8,"tr")(9,"th",6)(10,"h5"),o.EFF(11),o.k0s(),o.j41(12,"p"),o.EFF(13),o.k0s()(),o.DNE(14,NotificationSettingsTableComponent_div_0_ng_container_14_Template,2,0,"ng-container",5),o.k0s(),o.j41(15,"tr")(16,"th",6),o.EFF(17),o.k0s(),o.DNE(18,NotificationSettingsTableComponent_div_0_ng_container_18_Template,3,0,"ng-container",5),o.k0s(),o.j41(19,"tr")(20,"th",6),o.EFF(21),o.k0s(),o.DNE(22,NotificationSettingsTableComponent_div_0_ng_container_22_Template,3,0,"ng-container",5),o.k0s(),o.j41(23,"tr")(24,"th",6),o.EFF(25),o.k0s(),o.DNE(26,NotificationSettingsTableComponent_div_0_ng_container_26_Template,3,2,"ng-container",5),o.k0s(),o.j41(27,"tr")(28,"th",6),o.EFF(29),o.k0s(),o.DNE(30,NotificationSettingsTableComponent_div_0_ng_container_30_Template,3,2,"ng-container",5),o.k0s(),o.j41(31,"tr")(32,"th",6),o.EFF(33),o.k0s(),o.DNE(34,NotificationSettingsTableComponent_div_0_ng_container_34_Template,3,2,"ng-container",5),o.k0s(),o.DNE(35,NotificationSettingsTableComponent_div_0_tr_35_Template,7,3,"tr",7)(36,NotificationSettingsTableComponent_div_0_tr_36_Template,4,2,"tr",7)(37,NotificationSettingsTableComponent_div_0_tr_37_Template,4,2,"tr",7)(38,NotificationSettingsTableComponent_div_0_tr_38_Template,4,2,"tr",7),o.j41(39,"tr")(40,"th",6)(41,"h5"),o.EFF(42),o.k0s(),o.j41(43,"p"),o.EFF(44),o.k0s()(),o.DNE(45,NotificationSettingsTableComponent_div_0_ng_container_45_Template,2,0,"ng-container",5),o.k0s(),o.j41(46,"tr")(47,"th",6),o.EFF(48),o.k0s(),o.DNE(49,NotificationSettingsTableComponent_div_0_ng_container_49_Template,3,2,"ng-container",5),o.k0s(),o.j41(50,"tr")(51,"th",6),o.EFF(52),o.k0s(),o.DNE(53,NotificationSettingsTableComponent_div_0_ng_container_53_Template,3,2,"ng-container",5),o.k0s(),o.j41(54,"tr")(55,"th",6),o.EFF(56),o.k0s(),o.DNE(57,NotificationSettingsTableComponent_div_0_ng_container_57_Template,3,2,"ng-container",5),o.k0s(),o.j41(58,"tr")(59,"th",6),o.EFF(60),o.k0s(),o.DNE(61,NotificationSettingsTableComponent_div_0_ng_container_61_Template,3,2,"ng-container",5),o.k0s(),o.j41(62,"tr")(63,"th",6),o.EFF(64),o.k0s(),o.DNE(65,NotificationSettingsTableComponent_div_0_ng_container_65_Template,3,2,"ng-container",5),o.k0s(),o.j41(66,"tr"),o.nrm(67,"th",6),o.DNE(68,NotificationSettingsTableComponent_div_0_ng_container_68_Template,4,1,"ng-container",5),o.k0s()()()()),2&e){const e=o.XpG();o.R7$(5),o.SpI(" ",e.text.notify_me," "),o.R7$(),o.Y8G("ngForOf",e.settings.controls),o.R7$(5),o.JRh(e.text.notifyImmediately.title),o.R7$(2),o.JRh(e.text.notifyImmediately.description),o.R7$(),o.Y8G("ngForOf",e.settings.controls),o.R7$(3),o.SpI(" ",e.text.mentioned_header.title," "),o.R7$(),o.Y8G("ngForOf",e.settings.controls),o.R7$(3),o.JRh(e.text.watched_header),o.R7$(),o.Y8G("ngForOf",e.settings.controls),o.R7$(3),o.SpI(" ",e.text.assignee," "),o.R7$(),o.Y8G("ngForOf",e.settings.controls),o.R7$(3),o.SpI(" ",e.text.responsible," "),o.R7$(),o.Y8G("ngForOf",e.settings.controls),o.R7$(3),o.SpI(" ",e.text.shared," "),o.R7$(),o.Y8G("ngForOf",e.settings.controls),o.R7$(),o.Y8G("ngIf",!e.eeShowBanners),o.R7$(),o.Y8G("ngIf",!e.eeShowBanners),o.R7$(),o.Y8G("ngIf",!e.eeShowBanners),o.R7$(),o.Y8G("ngIf",!e.eeShowBanners),o.R7$(4),o.JRh(e.text.alsoNotifyFor.title),o.R7$(2),o.JRh(e.text.alsoNotifyFor.description),o.R7$(),o.Y8G("ngForOf",e.settings.controls),o.R7$(3),o.JRh(e.text.work_package_created_header),o.R7$(),o.Y8G("ngForOf",e.settings.controls),o.R7$(3),o.JRh(e.text.work_package_processed_header),o.R7$(),o.Y8G("ngForOf",e.settings.controls),o.R7$(3),o.JRh(e.text.work_package_scheduled_header),o.R7$(),o.Y8G("ngForOf",e.settings.controls),o.R7$(3),o.JRh(e.text.work_package_prioritized_header),o.R7$(),o.Y8G("ngForOf",e.settings.controls),o.R7$(3),o.JRh(e.text.work_package_commented_header),o.R7$(),o.Y8G("ngForOf",e.settings.controls),o.R7$(3),o.Y8G("ngForOf",e.settings.controls)}}function NotificationSettingsTableComponent_op_notification_setting_inline_create_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"op-notification-setting-inline-create",27),o.bIt("selected",(function NotificationSettingsTableComponent_op_notification_setting_inline_create_1_Template_op_notification_setting_inline_create_selected_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.addProjectSettings(t))})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("userId",e.userId)("settings",e.settings)}}class NotificationSettingsTableComponent{constructor(e,t,n,i){this.I18n=e,this.pathHelper=t,this.bannersService=n,this.configurationService=i,this.eeShowBanners=!1,this.availableTimes=[{value:null,title:this.I18n.t("js.notifications.settings.reminders.no_notification")},...reminderAvailableTimeframes()],this.availableTimesOverdue=[{value:null,title:this.I18n.t("js.notifications.settings.reminders.no_notification")},...overDueReminderTimes()],this.text={notify_me:this.I18n.t("js.notifications.settings.notify_me"),save:this.I18n.t("js.button_save"),mentioned_header:{title:this.I18n.t("js.notifications.settings.reasons.mentioned.title"),description:this.I18n.t("js.notifications.settings.reasons.mentioned.description")},notifyImmediately:{title:this.I18n.t("js.notifications.settings.global.immediately.title"),description:this.I18n.t("js.notifications.settings.global.immediately.description")},alsoNotifyFor:{title:this.I18n.t("js.notifications.settings.global.delayed.title"),description:this.I18n.t("js.notifications.settings.global.delayed.description")},dateAlerts:{title:this.I18n.t("js.notifications.settings.global.date_alerts.title"),description:this.I18n.t("js.notifications.settings.global.date_alerts.description")},assignee:this.I18n.t("js.notifications.settings.reasons.assignee"),responsible:this.I18n.t("js.notifications.settings.reasons.responsible"),shared:this.I18n.t("js.notifications.settings.reasons.shared"),watched_header:this.I18n.t("js.notifications.settings.reasons.watched"),work_package_commented_header:this.I18n.t("js.notifications.settings.reasons.work_package_commented"),work_package_created_header:this.I18n.t("js.notifications.settings.reasons.work_package_created"),work_package_processed_header:this.I18n.t("js.notifications.settings.reasons.work_package_processed"),work_package_prioritized_header:this.I18n.t("js.notifications.settings.reasons.work_package_prioritized"),work_package_scheduled_header:this.I18n.t("js.notifications.settings.reasons.work_package_scheduled"),remove_project_settings:this.I18n.t("js.notifications.settings.project_specific.remove"),startDate:this.I18n.t("js.work_packages.properties.startDate"),dueDate:this.I18n.t("js.work_packages.properties.dueDate"),overdue:this.I18n.t("js.notifications.settings.global.overdue")}}ngOnInit(){this.eeShowBanners=this.bannersService.eeShowBanners}projectLink(e){return this.pathHelper.projectPath((0,be.A)(e))}addProjectSettings(e){this.settings.push(new a.J3({project:new a.hs(e),assignee:new a.hs(!1),responsible:new a.hs(!1),shared:new a.hs(!1),workPackageCreated:new a.hs(!1),workPackageProcessed:new a.hs(!1),workPackageScheduled:new a.hs(!1),workPackagePrioritized:new a.hs(!1),workPackageCommented:new a.hs(!1),startDate:new a.hs(this.availableTimes[2].value),dueDate:new a.hs(this.availableTimes[2].value),overdue:new a.hs(this.availableTimesOverdue[0].value)}))}removeProjectSettings(e){this.settings.removeAt(e)}static{this.ɵfac=function NotificationSettingsTableComponent_Factory(e){return new(e||NotificationSettingsTableComponent)(o.rXU(w.W),o.rXU(B.B),o.rXU(ee.b),o.rXU(q.s))}}static{this.ɵcmp=o.VBU({type:NotificationSettingsTableComponent,selectors:[["op-notification-settings-table"]],inputs:{userId:"userId",settings:"settings"},decls:2,vars:2,consts:[["class","op-scrollable-table",4,"ngIf"],["data-test-selector","notification-setting-inline-create",3,"userId","settings","selected",4,"ngIf"],[1,"op-scrollable-table"],[1,"op-table"],[1,"op-table--cell","op-table--cell_heading"],[4,"ngFor","ngForOf"],[1,"op-table--cell","op-table--cell_soft-heading"],[4,"ngIf"],[1,"spot-link",3,"href"],[1,"op-table--cell"],["type","checkbox","disabled","","checked",""],[1,"op-table--cell",3,"formGroup"],["type","checkbox","formControlName","assignee","data-qa-project-notification-type","assignee"],["type","checkbox","formControlName","responsible","data-qa-project-notification-type","responsible"],["type","checkbox","formControlName","shared","data-qa-project-notification-type","shared"],[1,"op-table--cell--date-alerts",3,"formGroup"],["formControlName","startDate","data-qa-project-notification-type","op-reminder-settings-start-date-alerts","required","true",1,"op-reminder-settings-table-date-alerts--time","form--select"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],["formControlName","dueDate","data-qa-project-notification-type","op-reminder-settings-due-date-alerts","required","true",1,"op-reminder-settings-table-date-alerts--time","form--select"],["formControlName","overdue","data-qa-project-notification-type","op-reminder-settings-overdue-alerts","required","true",1,"op-reminder-settings-table-date-alerts--time","form--select"],["type","checkbox","formControlName","workPackageCreated","data-qa-project-notification-type","work_package_created"],["type","checkbox","formControlName","workPackageProcessed","data-qa-project-notification-type","work_package_processed"],["type","checkbox","formControlName","workPackageScheduled","data-qa-project-notification-type","work_package_scheduled"],["type","checkbox","formControlName","workPackagePrioritized","data-qa-project-notification-type","work_package_prioritized"],["type","checkbox","formControlName","workPackageCommented","data-qa-project-notification-type","work_package_commented"],["type","button",1,"spot-link",3,"click"],["data-test-selector","notification-setting-inline-create",3,"selected","userId","settings"]],template:function NotificationSettingsTableComponent_Template(e,t){1&e&&o.DNE(0,NotificationSettingsTableComponent_div_0_Template,69,33,"div",0)(1,NotificationSettingsTableComponent_op_notification_setting_inline_create_1_Template,1,2,"op-notification-setting-inline-create",1),2&e&&(o.Y8G("ngIf",t.settings.length>0),o.R7$(),o.Y8G("ngIf",t.userId))},dependencies:[P.Sq,P.bT,a.xH,a.y7,a.Zm,a.wz,a.BC,a.cb,a.YS,a.j4,a.JD,NotificationSettingInlineCreateComponent],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}[_nghost-%COMP%]{max-width:100%;width:100%}.op-table[_ngcontent-%COMP%]{margin-bottom:1rem}.op-reminder-settings-table-date-alerts--time[_ngcontent-%COMP%]{height:2rem;width:auto;min-width:8rem;padding:.25rem 1.5rem .25rem .75rem;margin:auto}.op-table--cell--date-alerts[_ngcontent-%COMP%]{border:1px solid var(--borderColor-default);text-align:center;padding:.75rem 1rem}"],changeDetection:0})}}function NotificationsSettingsPageComponent_div_21_select_4_option_1_Template(e,t){if(1&e&&(o.j41(0,"option",33),o.EFF(1),o.k0s()),2&e){const e=t.$implicit;o.Y8G("value",e.value),o.R7$(),o.SpI(" ",e.title," ")}}function NotificationsSettingsPageComponent_div_21_select_4_Template(e,t){if(1&e&&(o.j41(0,"select",31),o.DNE(1,NotificationsSettingsPageComponent_div_21_select_4_option_1_Template,2,2,"option",32),o.k0s()),2&e){const e=o.XpG(2);o.R7$(),o.Y8G("ngForOf",e.availableTimes)}}function NotificationsSettingsPageComponent_div_21_select_8_option_1_Template(e,t){if(1&e&&(o.j41(0,"option",33),o.EFF(1),o.k0s()),2&e){const e=t.$implicit;o.Y8G("value",e.value),o.R7$(),o.SpI(" ",e.title," ")}}function NotificationsSettingsPageComponent_div_21_select_8_Template(e,t){if(1&e&&(o.j41(0,"select",34),o.DNE(1,NotificationsSettingsPageComponent_div_21_select_8_option_1_Template,2,2,"option",32),o.k0s()),2&e){const e=o.XpG(2);o.R7$(),o.Y8G("ngForOf",e.availableTimes)}}function NotificationsSettingsPageComponent_div_21_select_12_option_1_Template(e,t){if(1&e&&(o.j41(0,"option",33),o.EFF(1),o.k0s()),2&e){const e=t.$implicit;o.Y8G("value",e.value),o.R7$(),o.SpI(" ",e.title," ")}}function NotificationsSettingsPageComponent_div_21_select_12_Template(e,t){if(1&e&&(o.j41(0,"select",35),o.DNE(1,NotificationsSettingsPageComponent_div_21_select_12_option_1_Template,2,2,"option",32),o.k0s()),2&e){const e=o.XpG(2);o.R7$(),o.Y8G("ngForOf",e.availableTimesOverdue)}}function NotificationsSettingsPageComponent_div_21_Template(e,t){if(1&e&&(o.j41(0,"div")(1,"div",19),o.nrm(2,"input",20)(3,"label",21),o.DNE(4,NotificationsSettingsPageComponent_div_21_select_4_Template,2,1,"select",22),o.k0s(),o.j41(5,"div",23),o.nrm(6,"input",24)(7,"label",25),o.DNE(8,NotificationsSettingsPageComponent_div_21_select_8_Template,2,1,"select",26),o.k0s(),o.j41(9,"div",27),o.nrm(10,"input",28)(11,"label",29),o.DNE(12,NotificationsSettingsPageComponent_div_21_select_12_Template,2,1,"select",30),o.k0s()()),2&e){const e=o.XpG();o.R7$(3),o.Y8G("textContent",e.text.startDate),o.R7$(),o.Y8G("ngIf",e.dateAlertsStatuses.startDate),o.R7$(3),o.Y8G("textContent",e.text.dueDate),o.R7$(),o.Y8G("ngIf",e.dateAlertsStatuses.dueDate),o.R7$(3),o.Y8G("textContent",e.text.overdue),o.R7$(),o.Y8G("ngIf",e.dateAlertsStatuses.overdue)}}function NotificationsSettingsPageComponent_op_enterprise_banner_22_Template(e,t){if(1&e&&o.nrm(0,"op-enterprise-banner",36),2&e){const e=o.XpG();o.Y8G("moreInfoLink",e.text.more_info_link)("collapsible",!0)("textMessage",e.text.teaser_text)}}function NotificationsSettingsPageComponent_op_notification_settings_table_43_Template(e,t){if(1&e&&o.nrm(0,"op-notification-settings-table",37),2&e){const e=o.XpG();o.Y8G("userId",e.userId)("settings",e.form.controls.projectSettings)}}class NotificationsSettingsPageComponent extends $t.p{constructor(e,t,n,i,o,r,s){super(),this.elementRef=e,this.changeDetectorRef=t,this.I18n=n,this.storeService=i,this.currentUserService=o,this.bannersService=r,this.configurationService=s,this.availableTimes=reminderAvailableTimeframes(),this.availableTimesOverdue=overDueReminderTimes(),this.eeShowBanners=!1,this.form=new a.J3({assignee:new a.hs(!1),responsible:new a.hs(!1),shared:new a.hs(!1),workPackageCreated:new a.hs(!1),workPackageProcessed:new a.hs(!1),workPackageScheduled:new a.hs(!1),workPackagePrioritized:new a.hs(!1),workPackageCommented:new a.hs(!1),startDate:new a.J3({active:new a.hs(!1),time:new a.hs(this.availableTimes[1])}),dueDate:new a.J3({active:new a.hs(!1),time:new a.hs(this.availableTimes[1])}),overdue:new a.J3({active:new a.hs(!1),time:new a.hs(this.availableTimesOverdue[0])}),projectSettings:new a.Bm([])}),this.text={notifyImmediately:{title:this.I18n.t("js.notifications.settings.global.immediately.title"),description:this.I18n.t("js.notifications.settings.global.immediately.description")},alsoNotifyFor:{title:this.I18n.t("js.notifications.settings.global.delayed.title"),description:this.I18n.t("js.notifications.settings.global.delayed.description")},dateAlerts:{title:this.I18n.t("js.notifications.settings.global.date_alerts.title"),description:this.I18n.t("js.notifications.settings.global.date_alerts.description")},mentioned:{title:this.I18n.t("js.notifications.settings.reasons.mentioned.title"),description:this.I18n.t("js.notifications.settings.reasons.mentioned.description")},watched:this.I18n.t("js.notifications.settings.reasons.watched"),work_package_commented:this.I18n.t("js.notifications.settings.reasons.work_package_commented"),work_package_created:this.I18n.t("js.notifications.settings.reasons.work_package_created"),work_package_processed:this.I18n.t("js.notifications.settings.reasons.work_package_processed"),work_package_prioritized:this.I18n.t("js.notifications.settings.reasons.work_package_prioritized"),work_package_scheduled:this.I18n.t("js.notifications.settings.reasons.work_package_scheduled"),save:this.I18n.t("js.button_save"),projectSpecific:{title:this.I18n.t("js.notifications.settings.project_specific.title"),description:this.I18n.t("js.notifications.settings.project_specific.description")},assignee:this.I18n.t("js.notifications.settings.reasons.assignee"),responsible:this.I18n.t("js.notifications.settings.reasons.responsible"),shared:this.I18n.t("js.notifications.settings.reasons.shared"),startDate:this.I18n.t("js.work_packages.properties.startDate"),dueDate:this.I18n.t("js.work_packages.properties.dueDate"),overdue:this.I18n.t("js.notifications.settings.global.overdue"),teaser_text:this.I18n.t("js.notifications.settings.global.date_alerts.teaser_text"),upgrade_to_ee_text:this.I18n.t("js.boards.upsale.upgrade"),more_info_link:te.y$.website},this.dateAlertsStatuses={startDate:!1,dueDate:!1,overdue:!1},(0,Ot.w)(this)}ngOnInit(){this.form.disable(),this.eeShowBanners=this.bannersService.eeShowBanners,this.currentUserService.user$.pipe((0,ne.s)(1)).subscribe((e=>{this.userId=this.userId||e.id,this.storeService.get(this.userId)})),this.form.get("startDate.active")?.valueChanges.subscribe((e=>{this.dateAlertsStatuses.startDate=!!e})),this.form.get("dueDate.active")?.valueChanges.subscribe((e=>{this.dateAlertsStatuses.dueDate=!!e})),this.form.get("overdue.active")?.valueChanges.subscribe((e=>{this.dateAlertsStatuses.overdue=!!e})),this.storeService.query.notificationsForGlobal$.pipe(this.untilDestroyed()).subscribe((e=>{e&&(this.form.get("assignee")?.setValue(e.assignee),this.form.get("responsible")?.setValue(e.responsible),this.form.get("shared")?.setValue(e.shared),this.form.get("workPackageCreated")?.setValue(e.workPackageCreated),this.form.get("workPackageProcessed")?.setValue(e.workPackageProcessed),this.form.get("workPackageScheduled")?.setValue(e.workPackageScheduled),this.form.get("workPackagePrioritized")?.setValue(e.workPackagePrioritized),this.form.get("workPackageCommented")?.setValue(e.workPackageCommented),this.form.get("startDate.active")?.setValue(!!e.startDate),this.form.get("startDate.time")?.setValue(e.startDate||this.availableTimes[1].value),this.form.get("dueDate.active")?.setValue(!!e.dueDate),this.form.get("dueDate.time")?.setValue(e.dueDate||this.availableTimes[1].value),this.form.get("overdue.active")?.setValue(!!e.overdue),this.form.get("overdue.time")?.setValue(e.overdue||this.availableTimesOverdue[0].value))})),this.storeService.query.projectNotifications$.pipe(this.untilDestroyed()).subscribe((e=>{if(!e)return;const t=new a.Bm([]);t.clear(),e.sort(((e,t)=>e._links.project.title.localeCompare(t._links.project.title))).forEach((e=>t.push(new a.J3({project:new a.hs(e._links.project),assignee:new a.hs(e.assignee),responsible:new a.hs(e.responsible),shared:new a.hs(e.shared),workPackageCreated:new a.hs(e.workPackageCreated),workPackageProcessed:new a.hs(e.workPackageProcessed),workPackageScheduled:new a.hs(e.workPackageScheduled),workPackagePrioritized:new a.hs(e.workPackagePrioritized),workPackageCommented:new a.hs(e.workPackageCommented),startDate:new a.hs(e.startDate),dueDate:new a.hs(e.dueDate),overdue:new a.hs(e.overdue)})))),this.form.setControl("projectSettings",t),this.changeDetectorRef.detectChanges()})),this.form.enable()}saveChanges(){const e=this.storeService.store.getValue(),t=this.form.value,n={...e.notifications.find((e=>!e._links.project.href)),_links:{project:{href:null}},watched:!0,mentioned:!0,assignee:t.assignee,responsible:t.responsible,shared:t.shared,workPackageCreated:t.workPackageCreated,workPackageProcessed:t.workPackageProcessed,workPackageScheduled:t.workPackageScheduled,workPackagePrioritized:t.workPackagePrioritized,workPackageCommented:t.workPackageCommented,startDate:t.startDate.active?t.startDate.time:null,dueDate:t.dueDate.active?t.dueDate.time:null,overdue:t.overdue.active?t.overdue.time:null},i=t.projectSettings.map((e=>({_links:{project:{href:e.project.href}},watched:!0,mentioned:!0,assignee:e.assignee,responsible:e.responsible,shared:e.shared,workPackageCreated:e.workPackageCreated,workPackageProcessed:e.workPackageProcessed,workPackageScheduled:e.workPackageScheduled,workPackagePrioritized:e.workPackagePrioritized,workPackageCommented:e.workPackageCommented,newsAdded:!1,newsCommented:!1,documentAdded:!1,forumMessages:!1,wikiPageAdded:!1,wikiPageUpdated:!1,membershipAdded:!1,membershipUpdated:!1,startDate:e.startDate,dueDate:e.dueDate,overdue:e.overdue})));this.storeService.update(this.userId,{...e,notifications:[n,...i]})}static{this.ɵfac=function NotificationsSettingsPageComponent_Factory(e){return new(e||NotificationsSettingsPageComponent)(o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(w.W),o.rXU(UserPreferencesService),o.rXU(S.K),o.rXU(ee.b),o.rXU(q.s))}}static{this.ɵcmp=o.VBU({type:NotificationsSettingsPageComponent,selectors:[["ng-component"]],inputs:{userId:"userId"},features:[o.Vt3],decls:46,vars:32,consts:[[1,"op-form",3,"ngSubmit","formGroup"],[1,"op-form--section-header"],[1,"op-form--section-header-title"],[1,"op-notifications-settings--bold-label",3,"label"],["disabled","","checked","","type","checkbox","slot","input"],[3,"label","control"],["slot","input","type","checkbox","formControlName","assignee","data-qa-global-notification-type","assignee"],["slot","input","type","checkbox","formControlName","responsible","data-qa-global-notification-type","responsible"],["slot","input","type","checkbox","formControlName","shared","data-qa-global-notification-type","shared"],[4,"ngIf"],["opReferrer","notifications#date-alerts","class","op-date-alert-ee-banner",3,"moreInfoLink","collapsible","textMessage",4,"ngIf"],["slot","input","type","checkbox","formControlName","workPackageCreated","data-qa-global-notification-type","work_package_created"],["slot","input","type","checkbox","formControlName","workPackageProcessed","data-qa-global-notification-type","work_package_processed"],["slot","input","type","checkbox","formControlName","workPackageScheduled","data-qa-global-notification-type","work_package_scheduled"],["slot","input","type","checkbox","formControlName","workPackagePrioritized","data-qa-global-notification-type","work_package_prioritized"],["slot","input","type","checkbox","formControlName","workPackageCommented","data-qa-global-notification-type","work_package_commented"],["formArrayName","projectSettings","class","op-notification-settings-page--table",3,"userId","settings",4,"ngIf"],[1,"generic-table--action-buttons"],["type","submit",1,"button","-primary",3,"textContent"],["formGroupName","startDate",1,"op-reminder-settings-date-alerts--row"],["type","checkbox","formControlName","active","data-qa-global-notification-type","op-settings-start-date-active","id","op-settings-start-date",1,"op-reminder-settings-date-alerts--active"],["for","op-settings-start-date",1,"op-reminder-settings-date-alerts--label",3,"textContent"],["formControlName","time","class","op-reminder-settings-date-alerts--time form--select -narrow","data-qa-global-notification-type","op-reminder-settings-start-date-alerts","required","true",4,"ngIf"],["formGroupName","dueDate",1,"op-reminder-settings-date-alerts--row"],["type","checkbox","formControlName","active","data-qa-global-notification-type","op-settings-due-date-active","id","op-settings-due-date",1,"op-reminder-settings-date-alerts--active"],["for","op-settings-due-date",1,"op-reminder-settings-date-alerts--label",3,"textContent"],["formControlName","time","class","op-reminder-settings-date-alerts--time form--select -narrow","data-qa-global-notification-type","op-reminder-settings-due-date-alerts","required","true",4,"ngIf"],["formGroupName","overdue",1,"op-reminder-settings-date-alerts--row"],["formControlName","active","type","checkbox","data-qa-global-notification-type","op-settings-overdue-date-active","id","op-settings-overdue-date",1,"op-reminder-settings-date-alerts--active"],["for","op-settings-overdue-date",1,"op-reminder-settings-date-alerts--label",3,"textContent"],["formControlName","time","class","op-reminder-settings-date-alerts--time form--select -narrow","data-qa-global-notification-type","op-reminder-settings-overdue-alerts","required","true",4,"ngIf"],["formControlName","time","data-qa-global-notification-type","op-reminder-settings-start-date-alerts","required","true",1,"op-reminder-settings-date-alerts--time","form--select","-narrow"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","time","data-qa-global-notification-type","op-reminder-settings-due-date-alerts","required","true",1,"op-reminder-settings-date-alerts--time","form--select","-narrow"],["formControlName","time","data-qa-global-notification-type","op-reminder-settings-overdue-alerts","required","true",1,"op-reminder-settings-date-alerts--time","form--select","-narrow"],["opReferrer","notifications#date-alerts",1,"op-date-alert-ee-banner",3,"moreInfoLink","collapsible","textMessage"],["formArrayName","projectSettings",1,"op-notification-settings-page--table",3,"userId","settings"]],template:function NotificationsSettingsPageComponent_Template(e,t){1&e&&(o.j41(0,"form",0),o.bIt("ngSubmit",(function NotificationsSettingsPageComponent_Template_form_ngSubmit_0_listener(){return t.saveChanges()})),o.j41(1,"div",1)(2,"h3",2),o.EFF(3),o.k0s(),o.j41(4,"p"),o.EFF(5),o.k0s()(),o.j41(6,"spot-selector-field",3),o.nrm(7,"input",4),o.k0s(),o.j41(8,"spot-selector-field",5),o.nrm(9,"input",4),o.k0s(),o.j41(10,"spot-selector-field",5),o.nrm(11,"input",6),o.k0s(),o.j41(12,"spot-selector-field",5),o.nrm(13,"input",7),o.k0s(),o.j41(14,"spot-selector-field",5),o.nrm(15,"input",8),o.k0s(),o.j41(16,"div",1)(17,"h3",2),o.EFF(18),o.k0s(),o.j41(19,"p"),o.EFF(20),o.k0s()(),o.DNE(21,NotificationsSettingsPageComponent_div_21_Template,13,6,"div",9)(22,NotificationsSettingsPageComponent_op_enterprise_banner_22_Template,1,3,"op-enterprise-banner",10),o.j41(23,"div",1)(24,"h3",2),o.EFF(25),o.k0s(),o.j41(26,"p"),o.EFF(27),o.k0s()(),o.j41(28,"spot-selector-field",5),o.nrm(29,"input",11),o.k0s(),o.j41(30,"spot-selector-field",5),o.nrm(31,"input",12),o.k0s(),o.j41(32,"spot-selector-field",5),o.nrm(33,"input",13),o.k0s(),o.j41(34,"spot-selector-field",5),o.nrm(35,"input",14),o.k0s(),o.j41(36,"spot-selector-field",5),o.nrm(37,"input",15),o.k0s(),o.j41(38,"div",1)(39,"h3",2),o.EFF(40),o.k0s(),o.j41(41,"p"),o.EFF(42),o.k0s()(),o.DNE(43,NotificationsSettingsPageComponent_op_notification_settings_table_43_Template,1,2,"op-notification-settings-table",16),o.j41(44,"div",17),o.nrm(45,"button",18),o.k0s()()),2&e&&(o.Y8G("formGroup",t.form),o.R7$(3),o.JRh(t.text.notifyImmediately.title),o.R7$(2),o.JRh(t.text.notifyImmediately.description),o.R7$(),o.Y8G("label",t.text.mentioned.title),o.R7$(2),o.Y8G("label",t.text.watched)("control",t.form.get("watched")),o.R7$(2),o.Y8G("label",t.text.assignee)("control",t.form.get("assignee")),o.R7$(2),o.Y8G("label",t.text.responsible)("control",t.form.get("responsible")),o.R7$(2),o.Y8G("label",t.text.shared)("control",t.form.get("shared")),o.R7$(4),o.JRh(t.text.dateAlerts.title),o.R7$(2),o.JRh(t.text.dateAlerts.description),o.R7$(),o.Y8G("ngIf",!t.eeShowBanners),o.R7$(),o.Y8G("ngIf",t.eeShowBanners),o.R7$(3),o.JRh(t.text.alsoNotifyFor.title),o.R7$(2),o.JRh(t.text.alsoNotifyFor.description),o.R7$(),o.Y8G("label",t.text.work_package_created)("control",t.form.get("workPackageCreated")),o.R7$(2),o.Y8G("label",t.text.work_package_processed)("control",t.form.get("workPackageProcessed")),o.R7$(2),o.Y8G("label",t.text.work_package_scheduled)("control",t.form.get("workPackageScheduled")),o.R7$(2),o.Y8G("label",t.text.work_package_prioritized)("control",t.form.get("workPackagePrioritized")),o.R7$(2),o.Y8G("label",t.text.work_package_commented)("control",t.form.get("workPackageCommented")),o.R7$(4),o.JRh(t.text.projectSpecific.title),o.R7$(2),o.JRh(t.text.projectSpecific.description),o.R7$(),o.Y8G("ngIf",t.userId),o.R7$(2),o.Y8G("textContent",t.text.save))},dependencies:[P.Sq,P.bT,a.qT,a.xH,a.y7,a.Zm,a.wz,a.BC,a.cb,a.YS,wo.P,ie.l,a.j4,a.JD,a.$R,a.v8,NotificationSettingsTableComponent],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-reminder-settings-date-alerts--enable[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:2rem;margin-bottom:.75rem}.op-reminder-settings-date-alerts--row[_ngcontent-%COMP%]{line-height:45px;display:flex;align-items:center}.op-reminder-settings-date-alerts--active[_ngcontent-%COMP%]{margin-right:.5rem}.op-reminder-settings-date-alerts--label[_ngcontent-%COMP%]{flex:0 0 180px;margin-bottom:0;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}.op-reminder-settings-date-alerts--time[_ngcontent-%COMP%]{height:2rem;width:auto;min-width:8rem;padding:.25rem 1.5rem .25rem .75rem}.op-date-alert-ee-banner[_ngcontent-%COMP%]{width:100%}"],changeDetection:0})}}function EmailAlertsSettingsComponent_spot_selector_field_4_Template(e,t){if(1&e&&(o.j41(0,"spot-selector-field",5),o.nrm(1,"input",6),o.k0s()),2&e){const e=t.$implicit,n=o.XpG();o.Y8G("label",n.text[e])("control",n.form.get(e)),o.R7$(),o.Y8G("formControlName",e)}}const To=["newsAdded","newsCommented","documentAdded","forumMessages","wikiPageAdded","wikiPageUpdated","membershipAdded","membershipUpdated"];class EmailAlertsSettingsComponent{constructor(e,t,n){this.I18n=e,this.storeService=t,this.rootFormGroup=n,this.alerts=To,this.text={title:this.I18n.t("js.reminders.settings.alerts.title"),explanation:this.I18n.t("js.reminders.settings.alerts.explanation"),newsAdded:this.I18n.t("js.reminders.settings.alerts.news_added"),newsCommented:this.I18n.t("js.reminders.settings.alerts.news_commented"),documentAdded:this.I18n.t("js.reminders.settings.alerts.document_added"),forumMessages:this.I18n.t("js.reminders.settings.alerts.forum_messages"),wikiPageAdded:this.I18n.t("js.reminders.settings.alerts.wiki_page_added"),wikiPageUpdated:this.I18n.t("js.reminders.settings.alerts.wiki_page_updated"),membershipAdded:this.I18n.t("js.reminders.settings.alerts.membership_added"),membershipUpdated:this.I18n.t("js.reminders.settings.alerts.membership_updated")}}ngOnInit(){this.form=this.rootFormGroup.control.get("emailAlerts")}static{this.ɵfac=function EmailAlertsSettingsComponent_Factory(e){return new(e||EmailAlertsSettingsComponent)(o.rXU(w.W),o.rXU(UserPreferencesService),o.rXU(a.j4))}}static{this.ɵcmp=o.VBU({type:EmailAlertsSettingsComponent,selectors:[["op-email-alerts-settings"]],decls:5,vars:4,consts:[[3,"formGroup"],[1,"op-form--section-header"],[1,"op-form--section-header-title",3,"textContent"],[3,"textContent"],[3,"label","control",4,"ngFor","ngForOf"],[3,"label","control"],["slot","input","type","checkbox",3,"formControlName"]],template:function EmailAlertsSettingsComponent_Template(e,t){1&e&&(o.qex(0,0),o.j41(1,"div",1),o.nrm(2,"h3",2)(3,"p",3),o.k0s(),o.DNE(4,EmailAlertsSettingsComponent_spot_selector_field_4_Template,2,3,"spot-selector-field",4),o.bVm()),2&e&&(o.Y8G("formGroup",t.form),o.R7$(2),o.Y8G("textContent",t.text.title),o.R7$(),o.Y8G("textContent",t.text.explanation),o.R7$(),o.Y8G("ngForOf",t.alerts))},dependencies:[P.Sq,a.Zm,a.BC,a.cb,wo.P,a.j4,a.JD],encapsulation:2,changeDetection:0})}}var So=n(15842);var jo=n(79439);const reminder_settings_daily_time_component_c0=()=>({standalone:!0});function ReminderSettingsDailyTimeComponent_ng_container_0_div_6_input_1_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"input",17),o.bIt("ngModelChange",(function ReminderSettingsDailyTimeComponent_ng_container_0_div_6_input_1_Template_input_ngModelChange_0_listener(t){o.eBV(e);const n=o.XpG().index,i=o.XpG().ngIf,r=o.XpG();return o.Njj(r.toggleActive(t,n,i))})),o.k0s()}if(2&e){const e=t.ngIf,n=o.XpG(),i=n.$implicit,r=n.index,s=o.XpG(2);o.x72("data-test-selector","op-settings-daily-time--active-",r+1,""),o.Y8G("ngModel",s.isActive(i))("ngModelOptions",o.lJ4(5,reminder_settings_daily_time_component_c0))("disabled",s.isDisabled(i,e))}}function ReminderSettingsDailyTimeComponent_ng_container_0_div_6_option_6_Template(e,t){if(1&e&&(o.j41(0,"option",18),o.EFF(1),o.k0s()),2&e){const e=t.$implicit,n=o.XpG().$implicit,i=o.XpG().ngIf,r=o.XpG();o.Y8G("value",e)("disabled",n!==e&&i.includes(e)),o.R7$(),o.SpI(" ",r.timeLabel(e)," ")}}function ReminderSettingsDailyTimeComponent_ng_container_0_div_6_button_7_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"button",19),o.bIt("click",(function ReminderSettingsDailyTimeComponent_ng_container_0_div_6_button_7_Template_button_click_0_listener(){o.eBV(e);const t=o.XpG().index,n=o.XpG().ngIf,i=o.XpG();return o.Njj(i.removeTime(n,t))})),o.nrm(1,"op-icon",20),o.k0s()}if(2&e){const e=o.XpG().index;o.x72("data-test-selector","op-settings-daily-time--remove-",e+1,"")}}function ReminderSettingsDailyTimeComponent_ng_container_0_div_6_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"div",11),o.DNE(1,ReminderSettingsDailyTimeComponent_ng_container_0_div_6_input_1_Template,1,6,"input",12),o.nI1(2,"async"),o.nrm(3,"label",13),o.j41(4,"select",14),o.nI1(5,"async"),o.bIt("ngModelChange",(function ReminderSettingsDailyTimeComponent_ng_container_0_div_6_Template_select_ngModelChange_4_listener(t){const n=o.eBV(e).index,i=o.XpG().ngIf,r=o.XpG();return o.Njj(r.changeTime(t,i,n))})),o.DNE(6,ReminderSettingsDailyTimeComponent_ng_container_0_div_6_option_6_Template,2,3,"option",15),o.k0s(),o.DNE(7,ReminderSettingsDailyTimeComponent_ng_container_0_div_6_button_7_Template,2,2,"button",16),o.nI1(8,"async"),o.k0s()}if(2&e){const e=t.$implicit,n=t.index,i=o.XpG(2);o.R7$(),o.Y8G("ngIf",o.bMT(2,11,i.activeTimes$)),o.R7$(2),o.x72("for","op-reminder-settings-daily-time-",n+1,"--time"),o.Y8G("textContent",i.text.timeLabel(n+1)),o.R7$(),o.x72("id","op-reminder-settings-daily-time-",n+1,"--time"),o.Y8G("ngModel",e)("ngModelOptions",o.lJ4(17,reminder_settings_daily_time_component_c0))("disabled",!1===o.bMT(5,13,i.enabled$)),o.R7$(2),o.Y8G("ngForOf",i.availableTimes),o.R7$(),o.Y8G("ngIf",o.bMT(8,15,i.timeRemovable$))}}function ReminderSettingsDailyTimeComponent_ng_container_0_Template(e,t){if(1&e){const e=o.RV6();o.qex(0,1),o.j41(1,"div",2),o.nrm(2,"h3",3)(3,"p",4),o.k0s(),o.j41(4,"spot-selector-field",5),o.nrm(5,"input",6),o.k0s(),o.DNE(6,ReminderSettingsDailyTimeComponent_ng_container_0_div_6_Template,9,18,"div",7),o.j41(7,"button",8),o.nI1(8,"async"),o.bIt("click",(function ReminderSettingsDailyTimeComponent_ng_container_0_Template_button_click_7_listener(){const t=o.eBV(e).ngIf,n=o.XpG();return o.Njj(n.addTime(t))})),o.nrm(9,"i",9),o.j41(10,"span",10),o.EFF(11),o.k0s()(),o.bVm()}if(2&e){const e=t.ngIf,n=o.XpG();o.Y8G("formGroup",n.form),o.R7$(2),o.Y8G("textContent",n.text.title),o.R7$(),o.Y8G("textContent",n.text.explanation),o.R7$(),o.Y8G("label",n.text.enable)("control",n.form.get("enabled")),o.R7$(2),o.Y8G("ngForOf",e)("ngForTrackBy",n.index),o.R7$(),o.Y8G("disabled",o.bMT(8,9,n.nonAddable$)),o.R7$(4),o.JRh(n.text.addTime)}}class ReminderSettingsDailyTimeComponent{constructor(e,t,n,i){this.I18n=e,this.storeService=t,this.rootFormGroup=n,this.configurationService=i,this.availableTimes=ReminderSettingsDailyTimeComponent.setupAvailableTimes(),this.inactiveTimes=[],this.suggestedTimes=["08:00","12:00","15:00","18:00"],this.selectedTimes$=jo.t,this.activeTimes$=jo.t,this.timeRemovable$=jo.t,this.nonAddable$=jo.t,this.text={title:this.I18n.t("js.reminders.settings.daily.title"),explanation:this.I18n.t("js.reminders.settings.daily.explanation",{no_time_zone:this.configurationService.isTimezoneSet()?"":this.I18n.t("js.reminders.settings.daily.no_time_zone")}),timeLabel:e=>this.I18n.t("js.reminders.settings.daily.time_label",{counter:e}),addTime:this.I18n.t("js.reminders.settings.daily.add_time"),enable:this.I18n.t("js.reminders.settings.daily.enable")}}ngOnInit(){this.form=this.rootFormGroup.control.get("dailyReminders"),this.enabled$=this.form.valueChanges.pipe((0,Oi.Z)((()=>this.form.get("enabled")?.value)),(0,G.T)((()=>this.form.get("enabled")?.value)),(0,Tn.t)(1)),this.selectedTimes$=this.form.get("times").valueChanges.pipe((0,Oi.Z)((()=>this.form.get("times")?.value)),(0,G.T)((()=>{const e=this.form.get("times").controls.map((e=>e.value));return this.inactiveTimes.sort(((e,t)=>e.position-t.position)).forEach((t=>{e.splice(t.position,0,t.time)})),e})),(0,Tn.t)(1)),this.timeRemovable$=(0,Vt.z)([this.enabled$,this.selectedTimes$]).pipe((0,G.T)((([e,t])=>e&&t.length>1))),this.nonAddable$=(0,Vt.z)([this.enabled$,this.selectedTimes$]).pipe((0,G.T)((([e,t])=>!e||t.length===this.availableTimes.length))),this.activeTimes$=(0,Vt.z)([this.enabled$,this.selectedTimes$]).pipe((0,G.T)((([e,t])=>e?t:[])))}addTime(e){const t=this.firstAvailableSuggested(e)||this.firstAfterSelected(e);t&&this.storeTimes(e.concat(t))}changeTime(e,t,n){t.splice(n,1,e),this.storeTimes(t)}isActive(e){return!this.inactiveTimes.find((t=>t.time===e))}removeTime(e,t){this.inactiveTimes=this.inactiveTimes.filter((n=>n.time!==e[t])),this.inactiveTimes.forEach((e=>{e.position>t&&(e.position-=1)})),e.splice(t,1),1===e.length&&(this.inactiveTimes=[]),e.length===this.inactiveTimes.length&&this.inactiveTimes.shift(),this.storeTimes(e)}toggleActive(e,t,n){e?this.inactiveTimes=this.inactiveTimes.filter((e=>e.time!==n[t])):this.inactiveTimes.push({position:t,time:n[t]}),this.storeTimes(n)}timeLabel(e){return this.I18n.toTime("time.formats.time",ReminderSettingsDailyTimeComponent.dateForHour(parseInt(e.split(":")[0],10)))}isDisabled(e,t){return 0===t.length||1===t.length&&t[0]===e}storeTimes(e){const t=e.filter((e=>!this.inactiveTimes.map((e=>e.time)).includes(e))),n=this.form.get("times");n.clear({emitEvent:!1}),t.forEach((e=>{n.push(new a.hs(e),{emitEvent:!1})})),n.enable({emitEvent:!0})}firstAvailableSuggested(e){return this.availableTimes.find((t=>this.suggestedTimes.includes(t)&&!e.includes(t)))}firstAfterSelected(e){const t=this.availableTimes.indexOf(e[e.length-1]);for(let n=t;n<24+t;n++)if(!e.includes(this.availableTimes[n%24]))return this.availableTimes[n%24];return null}static setupAvailableTimes(){return Array.from({length:24},((e,t)=>ReminderSettingsDailyTimeComponent.dateForHour(t).toLocaleTimeString("en-US",{hour12:!1,hour:"numeric",minute:"numeric"})))}static dateForHour(e){const t=new Date;t.setTime(36e5*(e-1));return new Date(Qi(t).utc().hours(e).format("YYYY-MM-DDTHH:mm:ss"))}static{this.ɵfac=function ReminderSettingsDailyTimeComponent_Factory(e){return new(e||ReminderSettingsDailyTimeComponent)(o.rXU(w.W),o.rXU(UserPreferencesService),o.rXU(a.j4),o.rXU(q.s))}}static{this.ɵcmp=o.VBU({type:ReminderSettingsDailyTimeComponent,selectors:[["op-reminder-settings-daily-time"]],decls:2,vars:3,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"op-form--section-header"],[1,"op-form--section-header-title",3,"textContent"],[3,"textContent"],[3,"label","control"],["slot","input","type","checkbox","formControlName","enabled"],["class","op-reminder-settings-daily-time--row",4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"button","op-reminder-settings-daily-time--add",3,"click","disabled"],[1,"button--icon","icon-add"],[1,"button--text"],[1,"op-reminder-settings-daily-time--row"],["type","checkbox","class","op-reminder-settings-daily-time--active",3,"ngModel","ngModelOptions","disabled","ngModelChange",4,"ngIf"],[1,"op-reminder-settings-daily-time--label",3,"textContent"],["required","true",1,"op-reminder-settings-daily-time--time","form--select","-narrow",3,"ngModelChange","ngModel","ngModelOptions","disabled"],[3,"value","disabled",4,"ngFor","ngForOf"],["class","spot-link op-reminder-settings-daily-time--remove","type","button",3,"click",4,"ngIf"],["type","checkbox",1,"op-reminder-settings-daily-time--active",3,"ngModelChange","ngModel","ngModelOptions","disabled"],[3,"value","disabled"],["type","button",1,"spot-link","op-reminder-settings-daily-time--remove",3,"click"],["icon-classes","icon-small icon-remove icon4"]],template:function ReminderSettingsDailyTimeComponent_Template(e,t){1&e&&(o.DNE(0,ReminderSettingsDailyTimeComponent_ng_container_0_Template,12,11,"ng-container",0),o.nI1(1,"async")),2&e&&o.Y8G("ngIf",o.bMT(1,1,t.selectedTimes$))},dependencies:[P.Sq,P.bT,a.xH,a.y7,a.Zm,a.wz,a.BC,a.cb,a.YS,a.vS,Le.i,wo.P,a.j4,a.JD,P.Jj],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-reminder-settings-daily-time--enable[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:30px;margin-bottom:10px}.op-reminder-settings-daily-time--row[_ngcontent-%COMP%]{margin-left:40px;line-height:45px;display:flex;align-items:center}.op-reminder-settings-daily-time--row[_ngcontent-%COMP%]:nth-of-type(1){margin-top:10px}.op-reminder-settings-daily-time--active[_ngcontent-%COMP%]{flex:0 0 25px}.op-reminder-settings-daily-time--label[_ngcontent-%COMP%]{flex:0 0 80px;margin-bottom:0;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}.op-reminder-settings-daily-time--time[_ngcontent-%COMP%]{height:32px;width:150px}.op-reminder-settings-daily-time--remove[_ngcontent-%COMP%]{padding-left:10px}.op-reminder-settings-daily-time--add[_ngcontent-%COMP%]{margin-top:20px;margin-left:40px;width:auto}"],changeDetection:0})}}class ImmediateReminderSettingsComponent{constructor(e,t,n){this.I18n=e,this.storeService=t,this.rootFormGroup=n,this.text={title:this.I18n.t("js.reminders.settings.immediate.title"),explanation:this.I18n.t("js.reminders.settings.immediate.explanation"),mentioned:this.I18n.t("js.reminders.settings.immediate.mentioned"),personalReminder:this.I18n.t("js.reminders.settings.immediate.personal_reminder")}}ngOnInit(){this.form=this.rootFormGroup.control.get("immediateReminders")}static{this.ɵfac=function ImmediateReminderSettingsComponent_Factory(e){return new(e||ImmediateReminderSettingsComponent)(o.rXU(w.W),o.rXU(UserPreferencesService),o.rXU(a.j4))}}static{this.ɵcmp=o.VBU({type:ImmediateReminderSettingsComponent,selectors:[["op-immediate-reminder-settings"]],decls:7,vars:6,consts:[[3,"formGroup"],[1,"op-form--section-header"],[1,"op-form--section-header-title",3,"textContent"],[3,"label","control"],["slot","input","type","checkbox","formControlName","mentioned","data-qa-immediate-reminder","mentioned"],["slot","input","type","checkbox","formControlName","personalReminder","data-qa-immediate-reminder","personalReminder"]],template:function ImmediateReminderSettingsComponent_Template(e,t){1&e&&(o.qex(0,0),o.j41(1,"div",1),o.nrm(2,"h3",2),o.k0s(),o.j41(3,"spot-selector-field",3),o.nrm(4,"input",4),o.k0s(),o.j41(5,"spot-selector-field",3),o.nrm(6,"input",5),o.k0s(),o.bVm()),2&e&&(o.Y8G("formGroup",t.form),o.R7$(2),o.Y8G("textContent",t.text.title),o.R7$(),o.Y8G("label",t.text.mentioned)("control",t.form.get("mentioned")),o.R7$(2),o.Y8G("label",t.text.personalReminder)("control",t.form.get("personalReminder")))},dependencies:[a.Zm,a.BC,a.cb,wo.P,a.j4,a.JD],encapsulation:2,changeDetection:0})}}function PauseRemindersComponent_op_basic_range_date_picker_3_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"op-basic-range-date-picker",4),o.nI1(1,"async"),o.nI1(2,"async"),o.bIt("valueChange",(function PauseRemindersComponent_op_basic_range_date_picker_3_Template_op_basic_range_date_picker_valueChange_0_listener(t){o.eBV(e);const n=o.XpG();return o.Njj(n.setDates(t))})),o.k0s()}if(2&e){const e=o.XpG();o.Y8G("required",o.bMT(1,2,e.enabled$))("value",o.bMT(2,4,e.selectedDates$))}}class PauseRemindersComponent{constructor(e,t){this.I18n=e,this.rootFormGroup=t,this.text={label:this.I18n.t("js.reminders.settings.pause.label"),date_placeholder:this.I18n.t("js.placeholders.date"),first_day:this.I18n.t("js.reminders.settings.pause.first_day"),last_day:this.I18n.t("js.reminders.settings.pause.first_day")}}ngOnInit(){this.form=this.rootFormGroup.control.get("pauseReminders"),this.selectedDates$=this.form.valueChanges.pipe((0,Oi.Z)(this.form.value),(0,G.T)((e=>[e.firstDay,e.lastDay]))),this.enabled$=this.form.valueChanges.pipe((0,Oi.Z)(this.form.value),(0,G.T)((e=>e.enabled)))}setDates(e){const[t,n]=e;this.form.patchValue({firstDay:t,lastDay:n})}static{this.ɵfac=function PauseRemindersComponent_Factory(e){return new(e||PauseRemindersComponent)(o.rXU(w.W),o.rXU(a.j4))}}static{this.ɵcmp=o.VBU({type:PauseRemindersComponent,selectors:[["op-pause-reminders"]],decls:5,vars:6,consts:[[1,"op-pause-reminders",3,"formGroup"],[1,"op-pause-reminders--checkbox",3,"label","control"],["slot","input","type","checkbox","formControlName","enabled"],[3,"required","value","valueChange",4,"ngIf"],[3,"valueChange","required","value"]],template:function PauseRemindersComponent_Template(e,t){1&e&&(o.j41(0,"div",0)(1,"spot-selector-field",1),o.nrm(2,"input",2),o.k0s(),o.DNE(3,PauseRemindersComponent_op_basic_range_date_picker_3_Template,3,6,"op-basic-range-date-picker",3),o.nI1(4,"async"),o.k0s()),2&e&&(o.Y8G("formGroup",t.form),o.R7$(),o.Y8G("label",t.text.label)("control",t.form.get("enabled")),o.R7$(2),o.Y8G("ngIf",o.bMT(4,4,t.enabled$)))},dependencies:[P.bT,a.Zm,a.BC,a.cb,wo.P,co.s,a.j4,a.JD,P.Jj],styles:[".op-pause-reminders[_ngcontent-%COMP%]{display:flex;align-items:center}.op-pause-reminders--checkbox[_ngcontent-%COMP%]{margin-right:2rem}"],changeDetection:0})}}function WorkdaysSettingsComponent_spot_selector_field_3_Template(e,t){if(1&e&&(o.j41(0,"spot-selector-field",4),o.nrm(1,"input",5),o.k0s()),2&e){const e=t.$implicit,n=o.XpG();o.Y8G("label",e)("control",n.controlForLocalWorkday(e)),o.R7$(),o.Y8G("formControlName",n.indexOfLocalWorkday(e))}}class WorkdaysSettingsComponent{constructor(e,t){this.I18n=e,this.formGroup=t,this.localeWorkdays=Qi.weekdays(!0),this.isoWorkdays=WorkdaysSettingsComponent.buildISOWeekdays(),this.text={title:this.I18n.t("js.reminders.settings.workdays.title")}}ngOnInit(){this.control=this.formGroup.control.get("workdays")}indexOfLocalWorkday(e){return this.isoWorkdays.indexOf(e)}controlForLocalWorkday(e){const t=this.indexOfLocalWorkday(e);return this.control.at(t)}static buildISOWeekdays(){const e=Qi.weekdays(!1);return e.push(e.shift()),e}static{this.ɵfac=function WorkdaysSettingsComponent_Factory(e){return new(e||WorkdaysSettingsComponent)(o.rXU(w.W),o.rXU(a.j4))}}static{this.ɵcmp=o.VBU({type:WorkdaysSettingsComponent,selectors:[["op-workdays-settings"]],decls:5,vars:3,consts:[[3,"formGroup"],[1,"op-form--section-header"],[1,"op-form--section-header-title",3,"textContent"],["formArrayName","workdays",3,"label","control",4,"ngFor","ngForOf"],["formArrayName","workdays",3,"label","control"],["slot","input","type","checkbox",3,"formControlName"]],template:function WorkdaysSettingsComponent_Template(e,t){1&e&&(o.qex(0,0),o.j41(1,"div",1),o.nrm(2,"h3",2),o.k0s(),o.DNE(3,WorkdaysSettingsComponent_spot_selector_field_3_Template,2,3,"spot-selector-field",3),o.nrm(4,"op-pause-reminders"),o.bVm()),2&e&&(o.Y8G("formGroup",t.formGroup.control),o.R7$(2),o.Y8G("textContent",t.text.title),o.R7$(),o.Y8G("ngForOf",t.localeWorkdays))},dependencies:[P.Sq,a.Zm,a.BC,a.cb,wo.P,a.j4,a.JD,a.v8,PauseRemindersComponent],changeDetection:0})}}function ReminderSettingsPageComponent_form_0_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"form",1),o.bIt("ngSubmit",(function ReminderSettingsPageComponent_form_0_Template_form_ngSubmit_0_listener(){o.eBV(e);const t=o.XpG();return o.Njj(t.saveChanges())})),o.nrm(1,"op-immediate-reminder-settings",2)(2,"op-reminder-settings-daily-time",2)(3,"op-workdays-settings",2)(4,"op-email-alerts-settings",2),o.j41(5,"div",3),o.nrm(6,"button",4),o.k0s()()}if(2&e){const e=o.XpG();o.Y8G("formGroup",e.form),o.R7$(6),o.Y8G("textContent",e.text.save)}}class ReminderSettingsPageComponent extends $t.p{constructor(e,t,n,i,o,r){super(),this.elementRef=e,this.I18n=t,this.storeService=n,this.currentUserService=i,this.fb=o,this.cdRef=r,this.form=this.fb.group({immediateReminders:this.fb.group({mentioned:this.fb.control(!1),personalReminder:this.fb.control(!1)}),dailyReminders:this.fb.group({enabled:this.fb.control(!1),times:this.fb.array([])}),pauseReminders:this.fb.group({enabled:this.fb.control(!1),firstDay:this.fb.control(""),lastDay:this.fb.control("")}),workdays:this.fb.array([this.fb.control(!1),this.fb.control(!0),this.fb.control(!0),this.fb.control(!0),this.fb.control(!0),this.fb.control(!0),this.fb.control(!1)]),emailAlerts:this.fb.group({newsAdded:this.fb.control(!1),newsCommented:this.fb.control(!1),documentAdded:this.fb.control(!1),forumMessages:this.fb.control(!1),wikiPageAdded:this.fb.control(!1),wikiPageUpdated:this.fb.control(!1),membershipAdded:this.fb.control(!1),membershipUpdated:this.fb.control(!1)})}),this.text={title:this.I18n.t("js.reminders.settings.title"),save:this.I18n.t("js.button_save")},this.formInitialized=!1,(0,Ot.w)(this)}ngOnInit(){this.currentUserService.user$.pipe((0,ne.s)(1)).subscribe((e=>{this.userId=this.userId||e?.id,this.storeService.get(this.userId)})),this.storeService.query.select().pipe((0,Z.p)((e=>!!e)),(0,So.E)(this.storeService.query.globalNotification$),function filterObservable(e,t){return n=>n.pipe((0,So.E)(e),(0,Z.p)((([,e])=>t(e))),(0,G.T)((([e])=>e)))}(this.storeService.query.selectLoading(),(e=>!e))).subscribe((([e,t])=>{this.buildForm(e,t)}))}buildForm(e,t){this.form.get("immediateReminders.mentioned")?.setValue(e.immediateReminders.mentioned),this.form.get("immediateReminders.personalReminder")?.setValue(e.immediateReminders.personalReminder),this.form.get("dailyReminders.enabled")?.setValue(e.dailyReminders.enabled),this.form.get("pauseReminders")?.patchValue(e.pauseReminders);const n=this.form.get("dailyReminders.times");n.clear({emitEvent:!1}),[...e.dailyReminders.times].sort().forEach((e=>{n.push(this.fb.control(e),{emitEvent:!1})})),n.enable({emitEvent:!0});const i=this.form.get("workdays");for(let t=0;t<=6;t++){i.at(t).setValue(e.workdays.includes(t+1))}To.forEach((e=>{this.form.get(`emailAlerts.${e}`)?.setValue(t[e])})),this.formInitialized=!0,this.cdRef.detectChanges()}saveChanges(){const e=this.storeService.query.getValue(),t=e.notifications.filter((e=>!e._links.project.href)),n=e.notifications.filter((e=>!!e._links.project.href)),i=this.form.value,o=ReminderSettingsPageComponent.buildWorkdays(i.workdays),r=ReminderSettingsPageComponent.buildPauses(i.pauseReminders),{dailyReminders:s,immediateReminders:a}=i;this.storeService.update(this.userId,{...e,workdays:o,dailyReminders:s,immediateReminders:a,pauseReminders:r,notifications:[...t.map((e=>({...e,...i.emailAlerts}))),...n]})}static buildWorkdays(e){return e.reduce(((e,t,n)=>t?e.concat([n+1]):e),[])}static buildPauses(e){return e.enabled?e:{enabled:!1}}static{this.ɵfac=function ReminderSettingsPageComponent_Factory(e){return new(e||ReminderSettingsPageComponent)(o.rXU(o.aKT),o.rXU(w.W),o.rXU(UserPreferencesService),o.rXU(S.K),o.rXU(a.ze),o.rXU(o.gRc))}}static{this.ɵcmp=o.VBU({type:ReminderSettingsPageComponent,selectors:[["ng-component"]],inputs:{userId:"userId"},features:[o.Vt3],decls:1,vars:1,consts:[["class","op-form",3,"formGroup","ngSubmit",4,"ngIf"],[1,"op-form",3,"ngSubmit","formGroup"],[1,"op-form--fieldset"],[1,"op-form--submit"],["type","submit",1,"button","-primary",3,"textContent"]],template:function ReminderSettingsPageComponent_Template(e,t){1&e&&o.DNE(0,ReminderSettingsPageComponent_form_0_Template,7,2,"form",0),2&e&&o.Y8G("ngIf",t.formInitialized)},dependencies:[P.bT,a.qT,a.cb,a.j4,ReminderSettingsDailyTimeComponent,ImmediateReminderSettingsComponent,EmailAlertsSettingsComponent,WorkdaysSettingsComponent],styles:[".form--section-title[_ngcontent-%COMP%]{text-transform:initial;border-bottom:initial;margin-bottom:initial!important}"],changeDetection:0})}}class OpenProjectMyAccountModule{static{this.ɵfac=function OpenProjectMyAccountModule_Factory(e){return new(e||OpenProjectMyAccountModule)}}static{this.ɵmod=o.$C({type:OpenProjectMyAccountModule})}static{this.ɵinj=o.G2t({providers:[UserPreferencesService],imports:[P.MD,d.d,Nt.E,a.YN,a.X1]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenProjectMyAccountModule,{declarations:[NotificationsSettingsPageComponent,NotificationSettingInlineCreateComponent,NotificationSettingsTableComponent,ReminderSettingsPageComponent,ReminderSettingsDailyTimeComponent,ImmediateReminderSettingsComponent,EmailAlertsSettingsComponent,WorkdaysSettingsComponent,PauseRemindersComponent],imports:[P.MD,d.d,Nt.E,a.YN,a.X1]});var Po=n(10752),Io=n(4286),xo=n(46786),Ro=n(99286),Fo=n(83365),Mo=n(34342),Oo=n(21451),Do=n(3836);const Go=["backupTokenInput"];class BackupComponent{constructor(e,t,n,i,o,r){this.elementRef=e,this.injector=t,this.i18n=n,this.toastService=i,this.pathHelper=o,this.jobStatusModalService=r,this.text={info:this.i18n.t("js.backup.info"),note:this.i18n.t("js.backup.note"),title:this.i18n.t("js.backup.title"),lastBackup:this.i18n.t("js.backup.last_backup"),lastBackupFrom:this.i18n.t("js.backup.last_backup_from"),includeAttachments:this.i18n.t("js.backup.include_attachments"),options:this.i18n.t("js.backup.options"),downloadBackup:this.i18n.t("js.backup.download_backup"),requestBackup:this.i18n.t("js.backup.request_backup"),attachmentsDisabled:this.i18n.t("js.backup.attachments_disabled")},this.jobStatusId=this.elementRef.nativeElement.dataset.jobStatusId,this.lastBackupDate=this.elementRef.nativeElement.dataset.lastBackupDate,this.lastBackupAttachmentId=this.elementRef.nativeElement.dataset.lastBackupAttachmentId,this.mayIncludeAttachments="false"!==this.elementRef.nativeElement.dataset.mayIncludeAttachments,this.includeAttachments=!0,this.backupToken="",this.includeAttachments=this.mayIncludeAttachments}ngAfterViewInit(){this.backupTokenInput.nativeElement.focus()}isDownloadReady(){return void 0!==this.jobStatusId&&""!==this.jobStatusId&&void 0!==this.lastBackupAttachmentId&&""!==this.lastBackupAttachmentId}getDownloadUrl(){return this.pathHelper.attachmentDownloadPath(this.lastBackupAttachmentId,void 0)}includeAttachmentsTitle(){return this.mayIncludeAttachments?"":this.text.attachmentsDisabled}triggerBackup(e){e&&(e.stopPropagation(),e.preventDefault());const{backupToken:t}=this;this.backupToken="",this.opBackup.triggerBackup(t,this.includeAttachments).subscribe((e=>{this.jobStatusId=e.jobStatusId,this.jobStatusModalService.show(e.jobStatusId)}),(e=>{this.toastService.addError(e.message)}))}static{this.ɵfac=function BackupComponent_Factory(e){return new(e||BackupComponent)(o.rXU(o.aKT),o.rXU(o.zZn),o.rXU(w.W),o.rXU(R.fw),o.rXU(B.B),o.rXU(Co._))}}static{this.ɵcmp=o.VBU({type:BackupComponent,selectors:[["opce-backup"]],viewQuery:function BackupComponent_Query(e,t){if(1&e&&o.GBs(Go,5),2&e){let e;o.mGM(e=o.lsd())&&(t.backupTokenInput=e.first)}},decls:41,vars:17,consts:[["backupTokenInput",""],["method","get",1,"form","-bordered","-compressed",3,"action","hidden"],[1,"form--section"],[1,"form--section-title"],[1,"form--field"],[1,"form--label"],[1,"form--field-container"],[1,"form--text-field-container"],["name","button","type","submit",1,"button"],[1,"button--icon","icon-save"],[1,"button--text"],["action","#",1,"form","danger-zone"],[1,"wiki"],[1,"danger-zone--warning"],[1,"icon","icon-error"],[1,"form--fieldset"],[1,"form--fieldset-legend"],[1,"form--label-with-check-box",3,"title"],[1,"form--check-box-container"],["type","checkbox",1,"form--check-box",3,"change","checked","disabled"],[1,"danger-zone--verification"],["type","password","name","backupToken","placeholder","Backup token","required","required",3,"input","value"],["name","button","type","submit",1,"-primary","button",3,"click","disabled"],[1,"button--icon","icon-export"]],template:function BackupComponent_Template(e,t){if(1&e){const e=o.RV6();o.j41(0,"form",1)(1,"section",2)(2,"h3",3),o.EFF(3),o.k0s(),o.j41(4,"div",4)(5,"label",5),o.EFF(6),o.k0s(),o.j41(7,"div",6)(8,"div",7)(9,"em"),o.EFF(10),o.k0s()()()(),o.j41(11,"button",8),o.nrm(12,"i",9),o.j41(13,"span",10),o.EFF(14),o.k0s()()()(),o.j41(15,"form",11)(16,"div",12)(17,"section",2)(18,"h3",3),o.EFF(19),o.k0s(),o.j41(20,"p"),o.EFF(21),o.k0s(),o.j41(22,"p",13),o.nrm(23,"span",14),o.j41(24,"span"),o.EFF(25),o.k0s()(),o.j41(26,"div")(27,"fieldset",15)(28,"legend",16),o.EFF(29),o.k0s(),o.j41(30,"label",17)(31,"div",18)(32,"input",19),o.bIt("change",(function BackupComponent_Template_input_change_32_listener(){return o.eBV(e),o.Njj(t.includeAttachments=!t.includeAttachments)})),o.k0s()(),o.EFF(33),o.k0s()()(),o.j41(34,"div",20)(35,"input",21,0),o.bIt("input",(function BackupComponent_Template_input_input_35_listener(n){return o.eBV(e),o.Njj(t.backupToken=n.target.value)})),o.k0s(),o.j41(37,"button",22),o.bIt("click",(function BackupComponent_Template_button_click_37_listener(n){return o.eBV(e),o.Njj(t.triggerBackup(n))})),o.nrm(38,"i",23),o.j41(39,"span",10),o.EFF(40),o.k0s()()()()()()}2&e&&(o.Y8G("action",t.getDownloadUrl(),o.B4B)("hidden",!t.isDownloadReady()),o.R7$(3),o.SpI(" ",t.text.lastBackup," "),o.R7$(3),o.SpI("",t.text.lastBackupFrom,":"),o.R7$(4),o.JRh(t.lastBackupDate),o.R7$(4),o.JRh(t.text.downloadBackup),o.R7$(5),o.SpI(" ",t.text.title," "),o.R7$(2),o.SpI(" ",t.text.info," "),o.R7$(4),o.JRh(t.text.note),o.R7$(4),o.SpI(" ",t.text.options," "),o.R7$(),o.Y8G("title",t.includeAttachmentsTitle()),o.R7$(2),o.Y8G("checked",t.includeAttachments)("disabled",!t.mayIncludeAttachments),o.R7$(),o.SpI(" ",t.text.includeAttachments," "),o.R7$(2),o.Y8G("value",t.backupToken),o.R7$(2),o.Y8G("disabled",0===t.backupToken.length),o.R7$(3),o.JRh(t.text.requestBackup))},encapsulation:2,changeDetection:0})}}(0,U.Cg)([(0,Q.O)(),(0,U.Sn)("design:type",OpenProjectBackupService)],BackupComponent.prototype,"opBackup",void 0);var Eo=n(26533),Ao=n(74356),Vo=n(95695),$o=n(68481),Bo=n(86757),Wo=n(82724),No=n(67e3),Uo=n(88056),Yo=n(94221),Xo=n(82757),qo=n(5749),Lo=n(98157),Ho=n(24128),zo=n(29655),Qo=n(75636);function app_module_initializeServices(e){return()=>{const t=e.get(HoverCardTriggerService),n=e.get(En.k),i=e.get(KeyboardShortcutService),o=e.get(wi.V),r=e.get(T.c);return e.get(RevitAddInSettingsButtonService),n.register(),t.setupListener(),o.register(),document.addEventListener("turbo:load",(()=>{n.register(),t.setupListener(),o.register(),r.detect()})),i.register(),e.get(q.s).initialize()}}class OpenProjectModule{ngDoBootstrap(e){this.runBootstrap(e),document.addEventListener("turbo:load",(()=>{this.runBootstrap(e)})),this.registerCustomElements(e.injector)}runBootstrap(e){const t=document.querySelector(it);t&&e.bootstrap(ApplicationBaseComponent,t),document.body.classList.add("__ng2-bootstrap-has-run")}registerCustomElements(e){registerCustomElement("opce-macro-embedded-table",ao.F,{injector:e}),registerCustomElement("opce-principal",ke.f,{injector:e}),registerCustomElement("opce-single-date-picker",lo.r,{injector:e}),registerCustomElement("opce-range-date-picker",co.s,{injector:e}),registerCustomElement("opce-global-search",GlobalSearchInputComponent,{injector:e}),registerCustomElement("opce-autocompleter",Rt.T,{injector:e}),registerCustomElement("opce-project-autocompleter",fn.j,{injector:e}),registerCustomElement("opce-select-decoration",po.m,{injector:e}),registerCustomElement("opce-members-autocompleter",MembersAutocompleterComponent,{injector:e}),registerCustomElement("opce-user-autocompleter",on.P,{injector:e}),registerCustomElement("opce-macro-attribute-value",uo.T,{injector:e}),registerCustomElement("opce-macro-attribute-label",ho.I,{injector:e}),registerCustomElement("opce-macro-wp-quickinfo",mo.Q,{injector:e}),registerCustomElement("opce-ckeditor-augmented-textarea",go.J,{injector:e}),registerCustomElement("opce-draggable-autocompleter",_o.L,{injector:e}),registerCustomElement("opce-attribute-help-text",Ee.e,{injector:e}),registerCustomElement("opce-static-attribute-help-text",zo.I,{injector:e}),registerCustomElement("opce-exclusion-info",fo.B,{injector:e}),registerCustomElement("opce-attachments",Ne.r,{injector:e}),registerCustomElement("opce-storage-login-button",Io.q,{injector:e}),registerCustomElement("opce-custom-modal-overlay",xo.l,{injector:e}),registerCustomElement("opce-new-project",bo.x,{injector:e}),registerCustomElement("opce-project-settings",vo.E,{injector:e}),registerCustomElement("opce-copy-project",ko._,{injector:e}),registerCustomElement("opce-notification-settings",NotificationsSettingsPageComponent,{injector:e}),registerCustomElement("opce-reminder-settings",ReminderSettingsPageComponent,{injector:e}),registerCustomElement("opce-notification-center",InAppNotificationCenterComponent,{injector:e}),registerCustomElement("opce-ian-date-alerts-upsale",InAppNotificationsDateAlertsUpsaleComponent,{injector:e}),registerCustomElement("opce-share-upsale",ft.J,{injector:e}),registerCustomElement("opce-wp-split-view",Po.m,{injector:e}),registerCustomElement("opce-timer-account-menu",Ro.R,{injector:e}),registerCustomElement("opce-remote-field-updater",Fo.f,{injector:e}),registerCustomElement("opce-modal-single-date-picker",Mo.c,{injector:e}),registerCustomElement("opce-basic-single-date-picker",lo.r,{injector:e}),registerCustomElement("opce-spot-drop-modal-portal",Oo.Q,{injector:e}),registerCustomElement("opce-spot-switch",Qo.c,{injector:e}),registerCustomElement("opce-modal-overlay",Do.E,{injector:e}),registerCustomElement("opce-in-app-notification-bell",InAppNotificationBellComponent,{injector:e}),registerCustomElement("opce-backup",BackupComponent,{injector:e}),registerCustomElement("opce-editable-query-props",EditableQueryPropsComponent,{injector:e}),registerCustomElement("opce-time-entry-trigger-actions",Eo.z,{injector:e}),registerCustomElement("opce-wp-overview-graph",WorkPackageOverviewGraphComponent,{injector:e}),registerCustomElement("opce-header-project-select",OpHeaderProjectSelectComponent,{injector:e}),registerCustomElement("opce-enterprise-active-saved-trial",EEActiveSavedTrialComponent,{injector:e}),registerCustomElement("opce-free-trial-button",Ao.E,{injector:e}),registerCustomElement("opce-enterprise-base",EnterpriseBaseComponent,{injector:e}),registerCustomElement("opce-no-results",ce.h,{injector:e}),registerCustomElement("opce-non-working-days-list",Vo.k,{injector:e}),registerCustomElement("opce-enterprise-banner",ie.l,{injector:e}),registerCustomElement("opce-collapsible-section-augment",$o.x,{injector:e}),registerCustomElement("opce-main-menu-toggle",MainMenuToggleComponent,{injector:e}),registerCustomElement("opce-main-menu-resizer",MainMenuResizerComponent,{injector:e}),registerCustomElement("opce-copy-to-clipboard",Bo._,{injector:e}),registerCustomElement("opce-global-search-title",GlobalSearchTitleComponent,{injector:e}),registerCustomElement("opce-content-tabs",Wo.V,{injector:e}),registerCustomElement("opce-add-section-dropdown",No.L,{injector:e}),registerCustomElement("opce-hide-section-link",Uo.r,{injector:e}),registerCustomElement("opce-persistent-toggle",Yo.f,{injector:e}),registerCustomElement("opce-admin-type-form-configuration",TypeFormConfigurationComponent,{injector:e}),registerCustomElement("opce-toasts-container",Xo.j,{injector:e}),registerCustomElement("opce-global-search-work-packages",GlobalSearchWorkPackagesComponent,{injector:e}),registerCustomElement("opce-custom-date-action-admin",qo.C,{injector:e}),registerCustomElement("opce-homescreen-new-features-block",Lo.t,{injector:e}),registerCustomElement("opce-global-search-tabs",GlobalSearchTabsComponent,{injector:e}),registerCustomElement("opce-zen-mode-toggle-button",Xt.y,{injector:e}),registerCustomElement("opce-colors-autocompleter",Ho.w,{injector:e})}static{this.ɵfac=function OpenProjectModule_Factory(e){return new(e||OpenProjectModule)}}static{this.ɵmod=o.$C({type:OpenProjectModule})}static{this.ɵinj=o.G2t({providers:[{provide:c.D,useValue:new c.D},{provide:s.a7,useClass:ro.S,multi:!0},{provide:o.hnV,useFactory:app_module_initializeServices,deps:[o.zZn],multi:!0},{provide:bi.u,useFactory:(e,t)=>e.isDirectUploads()?new FogUploadService(t):new LocalUploadService(t),deps:[q.s,s.Qq]},Jn.m,OpenProjectBackupService,qe.g,RevitAddInSettingsButtonService,nn.g],imports:[i.Bb,r.Pd,d.d,u.m,OpenProjectStateModule,OpenprojectRouterModule,si.$,OpenProjectJobStatusModule,g.b,p.X,OpenprojectGridsModule,m._,Jt.K,h.W,OpenprojectWorkPackageRoutesModule,OpenprojectWorkPackageGraphsModule,v.OpenprojectCalendarModule,OpenprojectDashboardsModule,OpenprojectOverviewModule,OpenprojectMyPageModule,OpenprojectGlobalSearchModule,OpenprojectAdminModule,OpenprojectEnterpriseModule,OpenprojectPluginsModule,LinkedPluginsModule,OpenprojectMembersModule,a.X1,s.q1,OpenprojectAugmentingModule,k.p,OpenprojectInviteUserModalModule,De.q,OpenProjectInAppNotificationsModule,Zi.Q,OpenProjectMyAccountModule]})}}("undefined"==typeof ngJitMode||ngJitMode)&&o.Obh(OpenProjectModule,{declarations:[l.i,An.B,Vn.T,$n.l,HoverCardComponent,MainMenuResizerComponent,MainMenuToggleComponent,OpHeaderProjectSelectComponent,OpHeaderProjectSelectListComponent,OpDragScrollDirective],imports:[i.Bb,r.Pd,d.d,u.m,OpenProjectStateModule,OpenprojectRouterModule,si.$,OpenProjectJobStatusModule,g.b,p.X,OpenprojectGridsModule,m._,Jt.K,h.W,OpenprojectWorkPackageRoutesModule,OpenprojectWorkPackageGraphsModule,v.OpenprojectCalendarModule,OpenprojectDashboardsModule,OpenprojectOverviewModule,OpenprojectMyPageModule,OpenprojectGlobalSearchModule,OpenprojectAdminModule,OpenprojectEnterpriseModule,OpenprojectPluginsModule,LinkedPluginsModule,OpenprojectMembersModule,a.X1,s.q1,OpenprojectAugmentingModule,k.p,OpenprojectInviteUserModalModule,De.q,OpenProjectInAppNotificationsModule,Zi.Q,OpenProjectMyAccountModule]});var Ko=n(93224),Jo=n(29815);var Zo=n(45312);class ErrorReporterBase{constructor(){this.contextHooks=[]}addHook(...e){this.contextHooks.push(...e)}hookPromises(){const e=this.contextHooks.map((e=>Promise.resolve(e())));return Promise.all(e)}}class AppsignalReporter extends ErrorReporterBase{captureMessage(e,t="info"){console.warn("Logging message %O with severity %O",e,t)}captureException(e){if(!this.client||!e)return void(0,mi.cY)("Appsignal is not yet loaded, ignoring error %O",e);const t="string"==typeof e?new Error(e):e;this.client.sendError(t,(e=>this.setupContext(e)))}constructor(){super();const e=document.querySelector("meta[name=openproject_appsignal]");this.loadAppsignal(e)}loadAppsignal(e){const t=e.dataset.pushKey||"",i=e.dataset.version||"";n.e("src_app_core_errors_appsignal_appsignal-dependency_ts").then(n.bind(n,16626)).then((e=>{this.client=new e.Appsignal({namespace:"frontend",key:t,revision:i,ignoreErrors:[/getComputedStyle/,/Loading chunk/]}),this.client.use(e.networkPlugin())}))}setupContext(e){var t=this;return(0,x.A)((function*(){const n=yield t.hookPromises();let i={locale:window.I18n.locale,domain:window.location.hostname,url_path:window.location.pathname,url_query:window.location.search};return n.forEach((e=>{i={...i,...e}})),e.setTags(i),e}))()}}class LocalReporter extends ErrorReporterBase{captureMessage(e,t="info"){this.handleOfflineMessage("captureMessage",[e,t])}captureException(e){throw this.handleOfflineMessage("captureException",[e]),e}handleOfflineMessage(e,t){(0,mi.cY)("[ErrorReporter] Would queue message %O %O, but is not configured.",e,t)}}var er=n(94876);function performAnchorHijacking(e,t){const n=t.getAttribute("href")||"",i=n.indexOf("#");return(""===n||0===i)&&(-1!==i&&"#"!==n&&(window.location.hash=n),!0)}function openExternalLinksInNewTab(e,t){if((0,jt.R)(e))return!1;const n=t.href||"";if(""===n||t.download)return!1;const i=window.location.origin;try{if(i!==new URL(n,window.location.origin).origin)return window.open(n,"_blank","noopener,noreferrer"),!0}catch(e){return!1}return!1}window.global=window;window.appBasePath=Ko("meta[name=app_base_path]").attr("content")||"";const tr=document.querySelector('meta[name="openproject_initializer"]'),nr=tr?.dataset.assetHost?`//${tr.dataset.assetHost}`:"";n.p=nr+window.appBasePath+"/assets/frontend/",window.ErrorReporter=function configureErrorReporter(){return null!==document.querySelector("meta[name=openproject_appsignal]")?new AppsignalReporter:new LocalReporter}(),n(15532),n(9594),n(1130),n(75512),Zo.c.production&&(0,o.SmG)(),function initializeLocale(){const e=document.querySelector("meta[name=openproject_initializer]"),t=e?.dataset.locale||"en",i=e?.dataset.defaultlocale||"en",o=e?.dataset.instancelocale||"en",r=parseInt(e?.dataset.firstdayofweek||"",10),s=parseInt(e?.dataset.firstweekofyear||"",10);window.I18n=new Jo.F2,I18n.locale=t,I18n.defaultLocale=i,Qi.locale(t),Qi.updateLocale(Qi.locale(),{postformat:e=>e}),Number.isNaN(r)||Number.isNaN(s)||Qi.updateLocale(Qi.locale(),{week:{dow:r,doy:7+r-s}}),I18n.pluralization.register("default",((e,t)=>{switch(t){case 0:return["zero","other"];case 1:return["one","other"];default:return["other"]}}));const a=_.chain([t,o]).uniq().map((e=>n(72096)(`./${e}.json`).then((e=>{I18n.store(e.default)})))).value();return Promise.all(a)}().then((()=>{Ko((()=>{!function initializeGlobalListeners(){document.documentElement.addEventListener("click",(e=>{const t=e.target;if(!document.contains(t))return void e.preventDefault();const n=t.closest("a");if(!n)return;if(n.classList.contains("ck-link_selected"))return void e.preventDefault();const i=[openExternalLinksInNewTab,performAnchorHijacking];for(const t of i)if(t.call(n,e,n)){e.preventDefault();break}performAnchorHijacking(0,n)})),window.addEventListener("zenModeToggled",(e=>{document.body.classList.toggle("zen-mode",e.detail.active)}));const{hash:e}=window.location;if(e&&e.startsWith("#"))try{const t=document.querySelector(e);t&&t.scrollIntoView({behavior:"smooth",block:"start"})}catch(t){console.log(`Could not scroll to given location hash: ${e} ( ${t.message})`)}jQuery(document).on("submit","form",(()=>{window.OpenProject.pageIsSubmitted=!0})),jQuery(window).on("beforeunload",(e=>{const t=e.originalEvent;window.OpenProject.pageWasEdited&&!window.OpenProject.pageIsSubmitted&&(t.preventDefault(),t.returnValue=I18n.t("js.work_packages.confirm_edit_cancel"))})),jQuery(document.documentElement).on("dragover drop",(e=>(e.preventDefault(),!1))),(0,er.iX)()}(),i.sG().bootstrapModule(OpenProjectModule)}))}))},75173:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>MainMenuController});var i=n(8255),o=n(75797),r=n(51567),s=n(64334),a=n(68559);class MainMenuNavigationService{constructor(){this.navigationEvents$=new o.t("")}onActivate(...e){return this.navigationEvents$.pipe((0,r.p)((t=>-1!==e.indexOf(t))),(0,s.s)(1))}static{this.ɵfac=function MainMenuNavigationService_Factory(e){return new(e||MainMenuNavigationService)}}static{this.ɵprov=a.jDH({token:MainMenuNavigationService,factory:MainMenuNavigationService.ɵfac,providedIn:"root"})}}class MainMenuController extends i.xI{static{this.targets=["sidebar","root","item"]}initialize(){this.rootTarget.classList.contains("closed")&&this.sidebarTarget.classList.add("-hidden");const e=this.getActiveMenuName();e&&this.markActive(e)}descend(e){const t=e.target;this.sidebarTarget.classList.add("-hidden");const n=t.closest("li");this.toggleMenuState(this.rootTarget),this.toggleMenuState(n),n.querySelector("li > a, .tree-menu--title")?.focus(),this.markActive(n.dataset.name)}ascend(e){e.preventDefault();const t=e.target.closest("li");this.toggleMenuState(t),this.toggleMenuState(this.rootTarget),t.querySelector(".toggler")?.focus(),this.sidebarTarget.classList.remove("-hidden")}getActiveMenuName(){const e=this.itemTargets.find((e=>e.classList.contains("open"))),t=this.rootTarget.querySelector("li");return(e||t)?.dataset.name}markActive(e){window.OpenProject.getPluginContext().then((e=>e.injector.get(MainMenuNavigationService))).then((t=>t.navigationEvents$.next(e)))}toggleMenuState(e){e.classList.toggle("closed"),e.classList.toggle("open")}}},81437:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>OpProjectsZenModeController});var i=n(60388);class OpProjectsZenModeController extends i.nr{constructor(){super(...arguments),this.inZenMode=!1}static{this.targets=["button"]}connect(){document.addEventListener("fullscreenchange",this.fullscreenChangeEventHandler.bind(this))}disconnect(){super.disconnect(),document.removeEventListener("fullscreenchange",this.fullscreenChangeEventHandler.bind(this))}fullscreenChangeEventHandler(){this.inZenMode=!this.inZenMode,this.dispatchZenModeStatus()}dispatchZenModeStatus(){const e=new CustomEvent("zenModeToggled",{detail:{active:this.inZenMode}});window.dispatchEvent(e)}deactivateZenMode(){document.exitFullscreen&&document.exitFullscreen()}activateZenMode(){document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen()}performAction(){this.inZenMode?this.deactivateZenMode():this.activateZenMode()}}},1130:(e,t,n)=>{"use strict";var i=n(8255),o=n(45312),r=n(60388);class OpApplicationController extends r.nr{constructor(){super(...arguments),this.loaded=new Set}static{this.targets=["dynamic"]}dynamicTargetConnected(e){const t=e.dataset.controller.split(" "),i=this.application.controllers.map((e=>e.identifier));t.forEach((e=>{const t=this.derivePath(e);i.includes(e)||this.loaded.has(e)||(this.loaded.add(e),n(83637)(`./${t}.controller`).then((t=>this.application.register(e,t.default))).catch((t=>{console.error("Failed to load dynamic controller chunk %O: %O",e,t)})))}))}derivePath(e){return e.replace(/--/g,"/")}}var s=n(75173);class OpDisableWhenCheckedController extends r.nr{static{this.targets=["cause","effect"]}static{this.values={reversed:Boolean}}causeTargetConnected(e){e.addEventListener("change",this.toggleDisabled.bind(this))}causeTargetDisconnected(e){e.removeEventListener("change",this.toggleDisabled.bind(this))}toggleDisabled(e){const t=e.target.checked;this.effectTargets.forEach((e=>{e.disabled=this.hasReversedValue&&this.reversedValue?!t:t}))}}class PrintController extends r.nr{triggerPrint(e){e.preventDefault(),window.print()}}var a,l=n(89204),c=n(31749);class RefreshOnFormChangesController extends r.nr{static{this.targets=["form"]}static{this.values={refreshUrl:String,turboStreamUrl:String}}triggerReload(){window.location.href=`${this.refreshUrlValue}?${this.getSerializedFormData()}`}triggerTurboStream(){var e=this;return(0,l.A)((function*(){yield fetch(`${e.turboStreamUrlValue}?${e.getSerializedFormData()}`,{headers:{Accept:"text/vnd.turbo-stream.html"}}).then((e=>e.text())).then((e=>(0,c.aM)(e)))}))()}getSerializedFormData(){const e=new FormData(this.formTarget);return new URLSearchParams(e).toString()}}!function(e){e.showProgressBar=function showProgressBar(){c.dZ.adapter.formSubmissionStarted()},e.hideProgressBar=function hideProgressBar(){c.dZ.adapter.formSubmissionFinished()}}(a||(a={}));class AsyncDialogController extends r.nr{connect(){this.element.addEventListener("click",(e=>{e.preventDefault(),this.triggerTurboStream()}))}triggerTurboStream(){a.showProgressBar(),fetch(this.href,{method:this.method,headers:{Accept:"text/vnd.turbo-stream.html"}}).then((e=>e.text())).then((e=>{(0,c.aM)(e)})).finally((()=>{a.hideProgressBar()}))}get href(){return this.element.href}get method(){return this.element.dataset.turboMethod||"GET"}}class PollForChangesController extends r.nr{static{this.values={url:String,interval:Number,reference:String,autoscrollEnabled:Boolean}}static{this.targets=["reloadButton","reference"]}connect(){super.connect(),0!==this.intervalValue&&(this.interval=setInterval((()=>{this.triggerTurboStream()}),this.intervalValue||1e4)),this.autoscrollEnabledValue&&window.addEventListener("DOMContentLoaded",this.autoscrollToLastKnownPosition.bind(this))}disconnect(){super.disconnect(),clearInterval(this.interval)}buildReference(){return this.hasReferenceTarget?this.referenceTarget.dataset.referenceValue:this.referenceValue}reloadButtonTargetConnected(){this.reloadButtonTarget.addEventListener("click",this.rememberCurrentScrollPosition.bind(this))}triggerTurboStream(){var e=this;fetch(`${this.urlValue}?reference=${this.buildReference()}`,{headers:{Accept:"text/vnd.turbo-stream.html"}}).then(function(){var t=(0,l.A)((function*(t){if(200===t.status){clearInterval(e.interval);const n=yield t.text();(0,c.aM)(n)}}));return function(e){return t.apply(this,arguments)}}())}rememberCurrentScrollPosition(){const e=document.getElementById("content-body")?.scrollTop;void 0!==e&&sessionStorage.setItem(this.scrollPositionKey(),e.toString())}autoscrollToLastKnownPosition(){const e=sessionStorage.getItem(this.scrollPositionKey());if(e){const t=document.getElementById("content-body");t&&(t.scrollTop=parseInt(e,10))}sessionStorage.removeItem(this.scrollPositionKey())}scrollPositionKey(){return`${this.urlValue}/scrollPosition`}}class TableHighlightingController extends r.nr{constructor(){super(...arguments),this.hover=e=>{const t=this.getColumn(e.target);t?.classList.add("hover")},this.unhover=e=>{const t=this.getColumn(e.target);t?.classList.remove("hover")}}connect(){const e=this.element.querySelector("thead"),t=this.element.querySelector("colgroup");e&&t&&(this.thead=e,this.colgroup=t,this.thead.addEventListener("mouseover",this.hover),this.thead.addEventListener("mouseout",this.unhover))}disconnect(){super.disconnect(),this.thead&&this.colgroup&&(this.thead.removeEventListener("mouseover",this.hover),this.thead.removeEventListener("mouseout",this.unhover))}getColumn(e){const t=e.closest("th"),n=this.parentIndex(t);if(null===n)return null;const i=this.colgroup.children.item(n);return i&&"false"!==i.dataset.highlight?i:null}parentIndex(e){return e.parentElement?Array.from(e.parentElement.children).indexOf(e):null}}class OpShowWhenCheckedController extends r.nr{static{this.targets=["cause","effect"]}static{this.values={reversed:Boolean}}causeTargetConnected(e){e.addEventListener("change",this.toggleDisabled.bind(this))}causeTargetDisconnected(e){e.removeEventListener("change",this.toggleDisabled.bind(this))}toggleDisabled(e){const t=e.target.checked;this.effectTargets.forEach((e=>{e.hidden=this.hasReversedValue&&this.reversedValue?t:!t}))}}class OpShowWhenValueSelectedController extends r.nr{static{this.targets=["cause","effect"]}causeTargetConnected(e){e.addEventListener("change",this.toggleDisabled.bind(this))}causeTargetDisconnected(e){e.removeEventListener("change",this.toggleDisabled.bind(this))}toggleDisabled(e){const t=e.target,n=t.dataset.targetName;this.effectTargets.filter((e=>n===e.dataset.targetName)).forEach((e=>{const n=this.willDisable(e,t.value);e.disabled=n,"true"===e.dataset.setVisibility?e.style.setProperty("visibility",n?"hidden":"visible"):e.hidden=n}))}willDisable(e,t){return e.dataset.notValue?e.dataset.notValue===t:!(e.dataset.value===t)}}class FlashController extends r.nr{static{this.values={autohide:Boolean}}static{this.targets=["item","flash"]}reloadPage(){window.location.reload()}itemTargetConnected(e){const t="true"===e.dataset.autohide;this.autohideValue&&t&&setTimeout((()=>e.remove()),5e3)}flashTargetDisconnected(){this.itemTargets.forEach((e=>{""===e.innerHTML&&e.remove()}))}}var p=n(81437),d=n(78);class PasswordConfirmationDialogController extends r.nr{constructor(){super(...arguments),this.formListener=this.onFormSubmit.bind(this),this.activeDialog=!1}connect(){super.connect(),this.element.addEventListener("submit",this.formListener)}disconnect(){super.disconnect(),this.element.removeEventListener("submit",this.formListener)}onFormSubmit(e){var t=this;return(0,l.A)((function*(){const n=t.element;if(null!==t.element.querySelector("#hidden_password_confirmation"))return!0;e.preventDefault();const i=(yield window.OpenProject.getPluginContext()).services.opModalService;return t.activeDialog||(t.activeDialog=!0,i.show(d.l,"global").subscribe((i=>i.closingEvent.subscribe((()=>{if(t.activeDialog=!1,!i.confirmed)return;const o=document.createElement("input");o.type="hidden",o.id="hidden_password_confirmation",o.name="_password_confirmation",o.value=i.password_confirmation,n.append(o),n.requestSubmit(e?.submitter)}))))),!1}))()}}const u=i.lg.start();window.Stimulus=u,u.debug=!o.c.production,u.handleError=(e,t,n)=>{console.warn(e,t,n)},u.register("application",OpApplicationController),u.register("async-dialog",AsyncDialogController),u.register("disable-when-checked",OpDisableWhenCheckedController),u.register("flash",FlashController),u.register("menus--main",s.default),u.register("password-confirmation-dialog",PasswordConfirmationDialogController),u.register("poll-for-changes",PollForChangesController),u.register("print",PrintController),u.register("refresh-on-form-changes",RefreshOnFormChangesController),u.register("show-when-checked",OpShowWhenCheckedController),u.register("show-when-value-selected",OpShowWhenValueSelectedController),u.register("table-highlighting",TableHighlightingController),u.register("projects-zen-mode",p.default)},75512:(e,t,n)=>{"use strict";var i=n(31749),o=n(63200);var r=n(36652);var s=n(89204),a=n(52202),l=n(36819);function triggerTour(e){return _triggerTour.apply(this,arguments)}function _triggerTour(){return(_triggerTour=(0,s.A)((function*(e){(0,l.cY)(`Loading and triggering onboarding tour ${e}`),yield n.e("src_app_core_setup_globals_onboarding_onboarding_tour_ts").then(n.bind(n,77010)).then((t=>{t.start(e)}))}))).apply(this,arguments)}function createFieldsetToggleStateLabel(e,t){const n="fieldset-toggle-state-label";let i=e.find(`a span.${n}`);const o=e.children("a");0===i.length&&(i=jQuery("<span />").addClass(n).addClass("hidden-for-sighted"),o.append(i)),i.text(` ${t}`)}function setFieldsetToggleState(e){const t=e.children("legend");e.hasClass("collapsed")?createFieldsetToggleStateLabel(t,I18n.t("js.label_collapsed")):createFieldsetToggleStateLabel(t,I18n.t("js.label_expanded"))}function getFieldset(e){const t=jQuery(e);if(t.is("legend"))return jQuery(e).parent();if(t.is("fieldset"))return t;throw new Error("Cannot derive fieldset from element!")}function setupToggableFieldsets(){const e=jQuery("fieldset.form--fieldset.-collapsible");e.on("click",".form--fieldset-legend",(function(e){return function toggleFieldset(e){const t=getFieldset(e);t.attr("data-touched","true");const n=t.find("> div").not(".form--toolbar");t.toggleClass("collapsed"),n.slideToggle("fast"),setFieldsetToggleState(t)}(this),e.preventDefault(),e.stopPropagation(),!1})),e.each((function(){const e=getFieldset(this),t=e.find("> div");e.hasClass("collapsed")&&t.hide(),setFieldsetToggleState(e)}))}var c=n(66899);var p=n(94876);const d=["turbo:before-cache","turbo:before-fetch-request","turbo:before-fetch-response","turbo:before-frame-morph","turbo:before-frame-render","turbo:before-prefetch","turbo:before-render","turbo:before-stream-render","turbo:before-visit","turbo:click","turbo:fetch-request-error","turbo:frame-load","turbo:frame-render","turbo:load","turbo:morph","turbo:reload","turbo:render","turbo:submit-end","turbo:submit-start","turbo:visit"];i.dZ.drive=!0,i.Uz(100),i.ni(),(0,l.bw)((()=>{d.forEach((e=>{document.addEventListener(e,(t=>{(0,l.cY)(`[TURBO EVENT ${e}] %O`,t)}))}))})),function addTurboEventListeners(){document.addEventListener("turbo:submit-end",(e=>{const{detail:{success:t},target:n}=e;if(t&&n instanceof HTMLFormElement){const e=n.closest("dialog");e&&"true"!==e.dataset.keepOpenOnSubmit&&e.close()}})),document.addEventListener("turbo:before-fetch-request",(e=>{const t=e.detail.fetchOptions.headers;t["Turbo-Referrer"]=window.location.href,t["X-Turbo-Nonce"]=document.getElementsByName("csp-nonce")[0]?.getAttribute("content")||""}))}(),function addTurboGlobalListeners(){document.addEventListener("turbo:load",(()=>{if(document.querySelector(".warning-bar--item")){const e=document.querySelector("#content");e&&(e.style.marginBottom="100px")}(new r.g).isMobile&&function scrollHeaderOnMobile(){let e=window.scrollY;const t=document.getElementById("content-body");t&&t.addEventListener("scroll",(()=>{const n=t.scrollTop<0?0:t.scrollTop;!jQuery("#main").hasClass("hidden-navigation")||jQuery(".op-app-header").hasClass("op-app-header_search-open")||Math.abs(n-e)<=55||(void 0!==e&&void 0!==n&&e>n?jQuery("#wrapper").removeClass("_header-scrolled"):jQuery("#wrapper").addClass("_header-scrolled"),e=n)}))}(),function detectOnboardingTour(){const e=new URL(window.location.href),t=document.body.classList.contains("-browser-mobile"),n="true"===jQuery("meta[name=demo_projects_available]").attr("content");let i=sessionStorage.getItem(a.Y),o=!1;if(!t&&n){if(e.searchParams.get("first_time_user")&&(i="",sessionStorage.setItem(a.Y,"readyToStart"),(0,a.x)(".spot-modal-overlay_active","body",(()=>{const e=document.getElementsByClassName("spot-modal-overlay_active");Array.from(e).forEach((e=>{e.addEventListener("click",(t=>{t.target===e&&(o=!0,triggerTour("homescreen"))})),jQuery('[data-tour-selector="modal-close-button"]')[0].addEventListener("click",(()=>{o=!0,triggerTour("homescreen")}))}))})),document.addEventListener("keydown",(e=>{"Escape"!==e.key||o||(o=!0,triggerTour("homescreen"))}),{once:!0})),("readyToStart"===i||e.searchParams.get("start_home_onboarding_tour"))&&triggerTour("homescreen"),e.searchParams.get("start_onboarding_tour")&&triggerTour("workPackages"),"wpTourFinished"===i)return void triggerTour("gantt");if("ganttTourFinished"===i){if(e.pathname.includes("boards"))return void triggerTour("boards");if(e.pathname.includes("team_planner"))return void triggerTour("teamPlanner");triggerTour("final")}if("boardsTourFinished"===i){if(e.pathname.includes("team_planner"))return void triggerTour("teamPlanner");triggerTour("final")}"teamPlannerTourFinished"===i&&triggerTour("final")}}(),setupToggableFieldsets(),jQuery(".toolbar-items").each(((e,t)=>{(0,c.f)(jQuery(t))})),function listenToSettingChanges(){jQuery("#settings_session_ttl_enabled").on("change",(function(){jQuery("#settings_session_ttl_container").toggle(jQuery(this).is(":checked"))})).trigger("change"),jQuery('[name="settings[enabled_scm][]"]').change((function(){const e=!this.checked,t=this.value,n=jQuery("#settings_repositories_automatic_managed_vendor"),i=n.find(`option[value="${t}"]`);0!==i.length&&(i.prop("disabled",e),e&&i.prop("selected")&&n.val(""))}));const langSelectSwitchData=function(e){const t=jQuery(e),n=t.attr("id")||"",i=n.replace("lang-for-",""),o=t.val(),r=jQuery(`#settings-${i}`),s=r.siblings("opce-ckeditor-augmented-textarea").data("editor");return{id:n,settingName:i,newLang:o,textArea:r,editor:s}};jQuery(".lang-select-switch").focus((function(){const e=langSelectSwitchData(this);jQuery(`#${e.id}-${e.newLang}`).val(e.editor.getData())})).change((function(){const e=langSelectSwitchData(this),t=jQuery(`#${e.id}-${e.newLang}`).val();e.editor.setData(t),e.textArea.attr("name",`settings[${e.settingName}][${e.newLang}]`)})),jQuery("#email_delivery_method_switch").on("change",(function(){const e=jQuery(this).val();jQuery(".email_delivery_method_settings").hide(),jQuery(`#email_delivery_method_${e}`).show()})).trigger("change"),jQuery("#settings_smtp_authentication").on("change",(function(){const e="none"===jQuery(this).val();jQuery("#settings_smtp_user_name,#settings_smtp_password").closest(".form--field").toggle(!e)})),jQuery(".settings-repositories--checkout-toggle").change((function(){const e=this.checked;jQuery(this).closest("fieldset").find("input,select").filter(":not([type=checkbox])").filter(":not([type=hidden])").removeAttr("required").prop("required",e)})),jQuery(".settings--highlighting-mode select").change((function(){const e=jQuery(this).val();jQuery(".settings--highlighted-attributes").toggle("inline"===e)})),jQuery("#tab-content-work_packages form").submit((()=>{const e=jQuery(".settings--highlighted-attributes input[type='checkbox']");jQuery(".settings--highlighted-attributes input[type='checkbox']:checked").length===e.length&&e.prop("checked",!1)}))}(),function makeColorPreviews(){jQuery(".color--preview").each((function(){const e=jQuery(this);let t;const n=e.data("target");if(t=n?jQuery(n):e.next("input"),0===t.length)return;const func=function(){let n="";t.val()&&t.val().length>0?n=t.val():t.attr("placeholder")&&t.attr("placeholder").length>0&&(n=t.attr("placeholder")),e.css("background-color",n)};t.keyup(func).change(func).focus(func),func()}))}(),function dangerZoneValidation(){const e=jQuery(".danger-zone--verification"),t=jQuery(".danger-zone--expected-value");if(!t[0])return;const n=t.text();e.find("input").on("input",(()=>{const t=e.find("input").val();n.toLowerCase()===t.toLowerCase()?e.find("button").prop("disabled",!1):e.find("button").prop("disabled",!0)}))}(),function fixFragmentAnchors(){const e=document.location.href.replace(/#.*$/,"");Array.from(document.getElementsByTagName("A")).forEach((t=>{const n=t.getAttribute("href");n&&"#"!==n&&n.startsWith("#")&&t.setAttribute("href",e+n)}))}(),(0,p.p3)(),(0,p.VU)(),(0,p.ex)(),(0,p.e4)()})),document.addEventListener("turbo:before-morph-element",(e=>{e.target.tagName.toUpperCase().startsWith("OPCE-")&&e.preventDefault()}))}(),function registerDialogStreamAction(){i.K0.dialog=function dialogStreamAction(){const e=this.templateElement.content,t=e.querySelector("dialog");document.body.append(e),t.showModal(),t.addEventListener("close",(()=>{"DIALOG-HELPER"===t.parentElement?.tagName?t.parentElement.remove():t.remove()})),setTimeout((()=>{const e=t.offsetWidth;t.style.width=`${e+1}px`}),50)}}(),function registerFlashStreamAction(){i.K0.flash=function dialogStreamAction(){const e=this.templateElement.content.firstElementChild,t=document.getElementById("primerized-flash-messages");if(e.dataset.uniqueKey){const n=t.querySelector(`[data-unique-key="${e.dataset.uniqueKey}"]`);if(n)return void n.replaceWith(e)}t.append(e)}}(),function registerInputCaptionStreamAction(){i.K0.addInputCaption=function addInputCaptionAction(){const e=document.querySelector(this.target);if(e){const t=e.closest(".FormControl");"true"===this.getAttribute("clean_other_captions")&&t.querySelectorAll(".FormControl-caption").forEach((e=>e.remove()));const n=this.getAttribute("caption");if(n&&""!==n){const e=document.createElement("span");e.className="FormControl-caption",e.innerText=n,t.append(e)}}}}(),function applyTurboNavigationPatch(){i.wE.delegateConstructor.prototype.proposeVisitIfNavigatedWithAction=function(e,t=null){if(this.action=t,this.action){const t=i.s6.fromElement(e).clone(),{visitCachedSnapshot:n}=e.delegate;e.delegate.fetchResponseLoaded=o=>{if(e.src){const{statusCode:r,redirected:s}=o,a={response:{statusCode:r,redirected:s,responseHTML:e.ownerDocument.documentElement.outerHTML},visitCachedSnapshot:n,willRender:!1,updateHistory:!1,restorationIdentifier:this.restorationIdentifier,snapshot:t};this.action&&(a.action=this.action),i.dZ.visit(e.src,a)}}}}}(),o.Ay.initialize(i.K0),document.addEventListener("turbo:frame-missing",(e=>{const{detail:{response:t,visit:n}}=e;e.preventDefault(),n(t.url)}))},58327:(e,t,n)=>{"use strict";n.d(t,{Ui:()=>parseChronicDuration,YU:()=>outputChronicDuration});class DurationParseError extends Error{}const i=4,o=31557600,r=24,s=30,a=/[0-9]*\.?[0-9]+/g,l=["seconds","minutes","hours","days","weeks","months","years"],c={seconds:"seconds",second:"seconds",secs:"seconds",sec:"seconds",s:"seconds",minutes:"minutes",minute:"minutes",mins:"minutes",min:"minutes",m:"minutes",hours:"hours",hour:"hours",hrs:"hours",hr:"hours",h:"hours",days:"days",day:"days",dy:"days",d:"days",weeks:"weeks",week:"weeks",wks:"weeks",wk:"weeks",w:"weeks",months:"months",mo:"months",mos:"months",month:"months",years:"years",year:"years",yrs:"years",yr:"years",y:"years"},p=["and","with","plus"];function calculateFromWords(e,t){let n=0;const c=e.split(" ");return c.forEach(((e,p)=>{""!==e&&e.search(a)>=0&&(n+=function convertToNumber(e){const t=parseFloat(e);return t%1>0?t:parseInt(e,10)}(e)*function durationUnitsSecondsMultiplier(e,t){if(!l.includes(e))return 0;const n=t.hoursPerDay||r,a=t.daysPerMonth||s,c=Math.trunc(a/i);switch(e){case"years":return o;case"months":return 3600*n*a;case"weeks":return 3600*n*c;case"days":return 3600*n;case"hours":return 3600;case"minutes":return 60;case"seconds":return 1;default:return 0}}(c[parseInt(p,10)+1]||t.defaultUnit||"seconds",t))})),n}function cleanup(e,t){let n=e.toLowerCase();return n=function filterByType(e){const t=l.filter((e=>"weeks"!==e));if(e.replace(/ +/g,"").search(RegExp(`${a.source}(:${a.source})+`,"g"))>=0){const n=[];return e.replace(/ +/g,"").split(":").reverse().forEach(((e,i)=>{t[i]&&n.push(`${e} ${t[i]}`)})),n.reverse().join(" ")}return e}(n),n=n.replace(a,(e=>` ${e} `)).replace(/ +/g," ").trim(),function filterThroughWhiteList(e,t){const n=[];return e.split(" ").forEach((e=>{if(""===e)return;if(e.search(a)>=0)return void n.push(e.trim());const i=e.trim().replace(/^,/g,"").replace(/,$/g,"");if(void 0!==c[i])n.push(c[i]);else if(!p.includes(i)&&t.raiseExceptions)throw new DurationParseError(`An invalid word ${JSON.stringify(e)} was used in the string to be parsed.`)})),n.length>0&&c[n[0]]&&n.splice(0,0,1),n.join(" ")}(n,t)}function parseChronicDuration(e,t={}){const n=calculateFromWords(cleanup(e,t),t);return t.keepZero||0!==n?n:null}function outputChronicDuration(e,t={}){const n={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:e},a=t.hoursPerDay||r,l=t.daysPerMonth||s,c=Math.trunc(l/i),p=e%1!=0?e.toString().split(".").reverse()[0].length:null,d=3600,u=a*d,h=l*u,m=o;"hours_only"===t.format?(n.hours=e/3600,n.seconds=0):n.seconds>=o&&n.seconds%m<n.seconds%h?(n.years=Math.trunc(n.seconds/m),n.months=Math.trunc(n.seconds%m/h),n.days=Math.trunc(n.seconds%m%h/u),n.hours=Math.trunc(n.seconds%m%h%u/d),n.minutes=Math.trunc(n.seconds%m%h%u%d/60),n.seconds=Math.trunc(n.seconds%m%h%u%d%60)):e>=60&&(n.minutes=Math.trunc(e/60),n.seconds%=60,n.minutes>=60&&(n.hours=Math.trunc(n.minutes/60),n.minutes=Math.trunc(n.minutes%60),t.limitToHours||n.hours>=a&&(n.days=Math.trunc(n.hours/a),n.hours=Math.trunc(n.hours%a),t.weeks?n.days>=c&&(n.weeks=Math.trunc(n.days/c),n.days=Math.trunc(n.days%c),n.weeks>=i&&(n.months=Math.trunc(n.weeks/i),n.weeks=Math.trunc(n.weeks%i))):n.days>=l&&(n.months=Math.trunc(n.days/l),n.days=Math.trunc(n.days%l)))));let g,_=t.joiner||" ",f=null;switch(t.format){case"micro":g={years:"y",months:"mo",weeks:"w",days:"d",hours:"h",minutes:"m",seconds:"s"},_="";break;case"short":g={years:"y",months:"mo",weeks:"w",days:"d",hours:"h",minutes:"m",seconds:"s"};break;case"long":g={years:" year",months:" month",weeks:" week",days:" day",hours:" hour",minutes:" minute",seconds:" second",pluralize:!0};break;case"days_and_hours":g={hours:"h",keepZero:!0},n.days+=n.weeks*c,n.weeks=0,n.days+=n.months*l,n.months=0,n.days+=Math.floor(n.years*o/3600/24),n.years=0,n.days>0&&(g.days="d"),n.hours+=(60*n.minutes+n.seconds)/3600,n.hours=parseFloat(Math.round(100*n.hours))/100;break;case"hours_only":g={hours:"h",keepZero:!0},n.hours=parseFloat(Math.round(100*n.hours))/100;break;case"chrono":g={years:":",months:":",weeks:":",days:":",hours:":",minutes:":",seconds:":",keepZero:!0},f=e=>{const t=[];return e.split(":").forEach((e=>{""!==e&&(e.search("\\.")>=0?t.push(parseFloat(e).toFixed(p).padStart(3+p,"0")):t.push(e.padStart(2,"0")))})),t.join(":").replace(/^(00:)+/g,"").replace(/^0/g,"").replace(/:$/g,"")},_="";break;default:g={years:" yr",months:" mo",weeks:" wk",days:" day",hours:" hr",minutes:" min",seconds:" sec",pluralize:!0}}let b=[];return["years","months","weeks","days","hours","minutes","seconds"].forEach((e=>{if("weeks"===e&&!t.weeks)return;let i=n[e];i="seconds"===e&&i%0!=0?i.toFixed(p):i.toString();const o=g.keepZero||"seconds"!==e?g.keepZero:t.keepZero,r=function humanizeTimeUnit(e,t,n,i){if("0"===e&&!i)return null;if(void 0===t)return null;let o=e+t;return"1"!==e&&n&&(o+="s"),o}(i,g[e],g.pluralize,o);null!==r&&b.push(r)})),t.units&&(b=b.slice(0,t.units)),b=b.join(_),f&&(b=f(b)),0===b.length?null:b}},69497:(e,t,n)=>{var i={"./apl/apl.js":[23836,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_apl_apl_js"],"./asciiarmor/asciiarmor.js":[42894,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_asciiarmor_asciiarmor_js"],"./asn.1/asn.1.js":[83708,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_asn_1_asn_1_js"],"./asterisk/asterisk.js":[73606,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_asterisk_asterisk_js"],"./brainfuck/brainfuck.js":[68812,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_brainfuck_brainfuck_js"],"./clike/clike.js":[96500,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_clike_clike_js"],"./clojure/clojure.js":[58644,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_clojure_clojure_js"],"./cmake/cmake.js":[56460,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_cmake_cmake_js"],"./cobol/cobol.js":[43940,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_cobol_cobol_js"],"./coffeescript/coffeescript.js":[38220,"default-node_modules_codemirror_lib_codemirror_js","common"],"./commonlisp/commonlisp.js":[32444,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_commonlisp_commonlisp_js"],"./crystal/crystal.js":[31560,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_crystal_crystal_js"],"./css/css.js":[75772,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_css_css_js"],"./cypher/cypher.js":[73644,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_cypher_cypher_js"],"./d/d.js":[56276,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_d_d_js"],"./dart/dart.js":[91620,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_clike_clike_js","node_modules_codemirror_mode_dart_dart_js"],"./diff/diff.js":[17724,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_diff_diff_js"],"./django/django.js":[15300,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","default-node_modules_codemirror_mode_htmlmixed_htmlmixed_js","common","node_modules_codemirror_mode_django_django_js"],"./dockerfile/dockerfile.js":[81194,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_dockerfile_dockerfile_js"],"./dtd/dtd.js":[1260,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_dtd_dtd_js"],"./dylan/dylan.js":[7e3,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_dylan_dylan_js"],"./ebnf/ebnf.js":[69084,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_ebnf_ebnf_js"],"./ecl/ecl.js":[57116,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_ecl_ecl_js"],"./eiffel/eiffel.js":[40092,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_eiffel_eiffel_js"],"./elm/elm.js":[16972,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_elm_elm_js"],"./erlang/erlang.js":[57676,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_erlang_erlang_js"],"./factor/factor.js":[98972,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_factor_factor_js"],"./fcl/fcl.js":[91244,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_fcl_fcl_js"],"./forth/forth.js":[93668,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_forth_forth_js"],"./fortran/fortran.js":[47172,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_fortran_fortran_js"],"./gas/gas.js":[11452,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_gas_gas_js"],"./gfm/gfm.js":[42640,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_markdown_markdown_js","common","node_modules_codemirror_mode_gfm_gfm_js"],"./gherkin/gherkin.js":[18492,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_gherkin_gherkin_js"],"./go/go.js":[9682,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_go_go_js"],"./groovy/groovy.js":[61366,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_groovy_groovy_js"],"./haml/haml.js":[60894,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","default-node_modules_codemirror_mode_htmlmixed_htmlmixed_js","common","node_modules_codemirror_mode_haml_haml_js"],"./handlebars/handlebars.js":[78818,"default-node_modules_codemirror_lib_codemirror_js","common"],"./haskell-literate/haskell-literate.js":[26860,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_haskell-literate_haskell-literate_js"],"./haskell/haskell.js":[9136,"default-node_modules_codemirror_lib_codemirror_js","common"],"./haxe/haxe.js":[79654,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_haxe_haxe_js"],"./htmlembedded/htmlembedded.js":[10012,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","default-node_modules_codemirror_mode_htmlmixed_htmlmixed_js","common","node_modules_codemirror_mode_htmlembedded_htmlembedded_js"],"./htmlmixed/htmlmixed.js":[48708,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","default-node_modules_codemirror_mode_htmlmixed_htmlmixed_js"],"./http/http.js":[70830,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_http_http_js"],"./idl/idl.js":[41644,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_idl_idl_js"],"./javascript/javascript.js":[44388,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js"],"./jinja2/jinja2.js":[52574,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_jinja2_jinja2_js"],"./jsx/jsx.js":[68932,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","node_modules_codemirror_mode_jsx_jsx_js"],"./julia/julia.js":[42680,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_julia_julia_js"],"./livescript/livescript.js":[11024,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_livescript_livescript_js"],"./lua/lua.js":[40744,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_lua_lua_js"],"./markdown/markdown.js":[44540,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_markdown_markdown_js"],"./mathematica/mathematica.js":[75612,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_mathematica_mathematica_js"],"./mbox/mbox.js":[64010,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_mbox_mbox_js"],"./mirc/mirc.js":[46872,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_mirc_mirc_js"],"./mllike/mllike.js":[18142,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_mllike_mllike_js"],"./modelica/modelica.js":[59354,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_modelica_modelica_js"],"./mscgen/mscgen.js":[50688,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_mscgen_mscgen_js"],"./mumps/mumps.js":[27896,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_mumps_mumps_js"],"./nginx/nginx.js":[96296,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_nginx_nginx_js"],"./nsis/nsis.js":[57548,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_nsis_nsis_js"],"./ntriples/ntriples.js":[65884,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_ntriples_ntriples_js"],"./octave/octave.js":[60246,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_octave_octave_js"],"./oz/oz.js":[4208,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_oz_oz_js"],"./pascal/pascal.js":[17146,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_pascal_pascal_js"],"./pegjs/pegjs.js":[93452,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","node_modules_codemirror_mode_pegjs_pegjs_js"],"./perl/perl.js":[70876,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_perl_perl_js"],"./php/php.js":[73724,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","default-node_modules_codemirror_mode_htmlmixed_htmlmixed_js","default-node_modules_codemirror_mode_clike_clike_js","node_modules_codemirror_mode_php_php_js"],"./pig/pig.js":[40832,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_pig_pig_js"],"./powershell/powershell.js":[11128,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_powershell_powershell_js"],"./properties/properties.js":[69536,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_properties_properties_js"],"./protobuf/protobuf.js":[94748,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_protobuf_protobuf_js"],"./pug/pug.js":[97488,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","default-node_modules_codemirror_mode_htmlmixed_htmlmixed_js","common"],"./puppet/puppet.js":[34798,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_puppet_puppet_js"],"./python/python.js":[4434,"default-node_modules_codemirror_lib_codemirror_js","common"],"./q/q.js":[69404,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_q_q_js"],"./r/r.js":[60544,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_r_r_js"],"./rpm/rpm.js":[18368,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_rpm_rpm_js"],"./rst/rst.js":[71900,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_rst_rst_js"],"./ruby/ruby.js":[7630,"default-node_modules_codemirror_lib_codemirror_js","common"],"./rust/rust.js":[46054,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_rust_rust_js"],"./sas/sas.js":[77412,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_sas_sas_js"],"./sass/sass.js":[88314,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_css_css_js","common"],"./scheme/scheme.js":[62044,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_scheme_scheme_js"],"./shell/shell.js":[24816,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_shell_shell_js"],"./sieve/sieve.js":[84588,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_sieve_sieve_js"],"./slim/slim.js":[70100,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","default-node_modules_codemirror_mode_htmlmixed_htmlmixed_js","common","node_modules_codemirror_mode_slim_slim_js"],"./smalltalk/smalltalk.js":[70644,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_smalltalk_smalltalk_js"],"./smarty/smarty.js":[93514,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_smarty_smarty_js"],"./solr/solr.js":[67506,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_solr_solr_js"],"./soy/soy.js":[31308,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","default-node_modules_codemirror_mode_htmlmixed_htmlmixed_js","node_modules_codemirror_mode_soy_soy_js"],"./sparql/sparql.js":[40712,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_sparql_sparql_js"],"./spreadsheet/spreadsheet.js":[57584,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_spreadsheet_spreadsheet_js"],"./sql/sql.js":[12280,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_sql_sql_js"],"./stex/stex.js":[50102,"default-node_modules_codemirror_lib_codemirror_js","common"],"./stylus/stylus.js":[73818,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_stylus_stylus_js"],"./swift/swift.js":[93284,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_swift_swift_js"],"./tcl/tcl.js":[79772,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_tcl_tcl_js"],"./textile/textile.js":[15244,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_textile_textile_js"],"./tiddlywiki/tiddlywiki.js":[73046,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_tiddlywiki_tiddlywiki_js"],"./tiki/tiki.js":[50204,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_tiki_tiki_js"],"./toml/toml.js":[46126,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_toml_toml_js"],"./tornado/tornado.js":[79740,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","default-node_modules_codemirror_mode_htmlmixed_htmlmixed_js","common","node_modules_codemirror_mode_tornado_tornado_js"],"./troff/troff.js":[93308,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_troff_troff_js"],"./ttcn-cfg/ttcn-cfg.js":[62138,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_ttcn-cfg_ttcn-cfg_js"],"./ttcn/ttcn.js":[17080,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_ttcn_ttcn_js"],"./turtle/turtle.js":[51326,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_turtle_turtle_js"],"./twig/twig.js":[45104,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_twig_twig_js"],"./vb/vb.js":[84354,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_vb_vb_js"],"./vbscript/vbscript.js":[73220,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_vbscript_vbscript_js"],"./velocity/velocity.js":[15612,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_velocity_velocity_js"],"./verilog/verilog.js":[44300,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_verilog_verilog_js"],"./vhdl/vhdl.js":[59494,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_vhdl_vhdl_js"],"./vue/vue.js":[93696,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","default-node_modules_codemirror_mode_htmlmixed_htmlmixed_js","default-node_modules_codemirror_mode_stylus_stylus_js","common","node_modules_codemirror_mode_vue_vue_js"],"./wast/wast.js":[98260,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_wast_wast_js"],"./webidl/webidl.js":[68128,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_webidl_webidl_js"],"./xml/xml.js":[31548,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_xml_xml_js"],"./xquery/xquery.js":[77274,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_xquery_xquery_js"],"./yacas/yacas.js":[58076,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_yacas_yacas_js"],"./yaml-frontmatter/yaml-frontmatter.js":[24542,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_yaml-frontmatter_yaml-frontmatter_js"],"./yaml/yaml.js":[26300,"default-node_modules_codemirror_lib_codemirror_js","common"],"./z80/z80.js":[75384,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_z80_z80_js"]};function webpackAsyncContext(e){if(!n.o(i,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],o=t[0];return Promise.all(t.slice(1).map(n.e)).then((()=>n.t(o,23)))}webpackAsyncContext.keys=()=>Object.keys(i),webpackAsyncContext.id=69497,e.exports=webpackAsyncContext},72427:e=>{function webpackEmptyContext(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}webpackEmptyContext.keys=()=>[],webpackEmptyContext.resolve=webpackEmptyContext,webpackEmptyContext.id=72427,e.exports=webpackEmptyContext},35358:(e,t,n)=>{var i={"./af":85637,"./af.js":85637,"./ar":6777,"./ar-dz":74508,"./ar-dz.js":74508,"./ar-kw":67504,"./ar-kw.js":67504,"./ar-ly":95373,"./ar-ly.js":95373,"./ar-ma":92412,"./ar-ma.js":92412,"./ar-ps":78823,"./ar-ps.js":78823,"./ar-sa":36670,"./ar-sa.js":36670,"./ar-tn":36448,"./ar-tn.js":36448,"./ar.js":6777,"./az":23009,"./az.js":23009,"./be":28299,"./be.js":28299,"./bg":4685,"./bg.js":4685,"./bm":11171,"./bm.js":11171,"./bn":23590,"./bn-bd":5841,"./bn-bd.js":5841,"./bn.js":23590,"./bo":54309,"./bo.js":54309,"./br":54130,"./br.js":54130,"./bs":8033,"./bs.js":8033,"./ca":55294,"./ca.js":55294,"./cs":53028,"./cs.js":53028,"./cv":5807,"./cv.js":5807,"./cy":70342,"./cy.js":70342,"./da":38269,"./da.js":38269,"./de":11489,"./de-at":42123,"./de-at.js":42123,"./de-ch":17757,"./de-ch.js":17757,"./de.js":11489,"./dv":28152,"./dv.js":28152,"./el":7687,"./el.js":7687,"./en-au":46668,"./en-au.js":46668,"./en-ca":76798,"./en-ca.js":76798,"./en-gb":53615,"./en-gb.js":53615,"./en-ie":91364,"./en-ie.js":91364,"./en-il":79907,"./en-il.js":79907,"./en-in":70533,"./en-in.js":70533,"./en-nz":33190,"./en-nz.js":33190,"./en-sg":51096,"./en-sg.js":51096,"./eo":3962,"./eo.js":3962,"./es":37726,"./es-do":65010,"./es-do.js":65010,"./es-mx":63654,"./es-mx.js":63654,"./es-us":59043,"./es-us.js":59043,"./es.js":37726,"./et":25343,"./et.js":25343,"./eu":90728,"./eu.js":90728,"./fa":60787,"./fa.js":60787,"./fi":71771,"./fi.js":71771,"./fil":45335,"./fil.js":45335,"./fo":69761,"./fo.js":69761,"./fr":1670,"./fr-ca":28991,"./fr-ca.js":28991,"./fr-ch":97280,"./fr-ch.js":97280,"./fr.js":1670,"./fy":24203,"./fy.js":24203,"./ga":69858,"./ga.js":69858,"./gd":38605,"./gd.js":38605,"./gl":27365,"./gl.js":27365,"./gom-deva":33896,"./gom-deva.js":33896,"./gom-latn":95587,"./gom-latn.js":95587,"./gu":97950,"./gu.js":97950,"./he":92029,"./he.js":92029,"./hi":51897,"./hi.js":51897,"./hr":29816,"./hr.js":29816,"./hu":22253,"./hu.js":22253,"./hy-am":28196,"./hy-am.js":28196,"./id":51307,"./id.js":51307,"./is":95474,"./is.js":95474,"./it":23099,"./it-ch":45807,"./it-ch.js":45807,"./it.js":23099,"./ja":19127,"./ja.js":19127,"./jv":30182,"./jv.js":30182,"./ka":10758,"./ka.js":10758,"./kk":93444,"./kk.js":93444,"./km":72034,"./km.js":72034,"./kn":46223,"./kn.js":46223,"./ko":83064,"./ko.js":83064,"./ku":8714,"./ku-kmr":10961,"./ku-kmr.js":10961,"./ku.js":8714,"./ky":12062,"./ky.js":12062,"./lb":84796,"./lb.js":84796,"./lo":19279,"./lo.js":19279,"./lt":106,"./lt.js":106,"./lv":11840,"./lv.js":11840,"./me":42240,"./me.js":42240,"./mi":13588,"./mi.js":13588,"./mk":15518,"./mk.js":15518,"./ml":37823,"./ml.js":37823,"./mn":98657,"./mn.js":98657,"./mr":61285,"./mr.js":61285,"./ms":43014,"./ms-my":86253,"./ms-my.js":86253,"./ms.js":43014,"./mt":20167,"./mt.js":20167,"./my":47940,"./my.js":47940,"./nb":50014,"./nb.js":50014,"./ne":49023,"./ne.js":49023,"./nl":34208,"./nl-be":71412,"./nl-be.js":71412,"./nl.js":34208,"./nn":81354,"./nn.js":81354,"./oc-lnc":40870,"./oc-lnc.js":40870,"./pa-in":80389,"./pa-in.js":80389,"./pl":7342,"./pl.js":7342,"./pt":34774,"./pt-br":73003,"./pt-br.js":73003,"./pt.js":34774,"./ro":85333,"./ro.js":85333,"./ru":73451,"./ru.js":73451,"./sd":43921,"./sd.js":43921,"./se":59682,"./se.js":59682,"./si":80582,"./si.js":80582,"./sk":4348,"./sk.js":4348,"./sl":95337,"./sl.js":95337,"./sq":39358,"./sq.js":39358,"./sr":50683,"./sr-cyrl":69382,"./sr-cyrl.js":69382,"./sr.js":50683,"./ss":51156,"./ss.js":51156,"./sv":29855,"./sv.js":29855,"./sw":18536,"./sw.js":18536,"./ta":15373,"./ta.js":15373,"./te":37809,"./te.js":37809,"./tet":61297,"./tet.js":61297,"./tg":92527,"./tg.js":92527,"./th":85862,"./th.js":85862,"./tk":79331,"./tk.js":79331,"./tl-ph":44387,"./tl-ph.js":44387,"./tlh":3592,"./tlh.js":3592,"./tr":79732,"./tr.js":79732,"./tzl":99570,"./tzl.js":99570,"./tzm":83553,"./tzm-latn":7699,"./tzm-latn.js":7699,"./tzm.js":83553,"./ug-cn":25674,"./ug-cn.js":25674,"./uk":69974,"./uk.js":69974,"./ur":45773,"./ur.js":45773,"./uz":357,"./uz-latn":77135,"./uz-latn.js":77135,"./uz.js":357,"./vi":20043,"./vi.js":20043,"./x-pseudo":40767,"./x-pseudo.js":40767,"./yo":80150,"./yo.js":80150,"./zh-cn":21828,"./zh-cn.js":21828,"./zh-hk":86644,"./zh-hk.js":86644,"./zh-mo":79305,"./zh-mo.js":79305,"./zh-tw":31860,"./zh-tw.js":31860};function webpackContext(e){var t=webpackContextResolve(e);return n(t)}function webpackContextResolve(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}webpackContext.keys=function webpackContextKeys(){return Object.keys(i)},webpackContext.resolve=webpackContextResolve,e.exports=webpackContext,webpackContext.id=35358},72096:(e,t,n)=>{var i={"./af.json":[32914,"src_locales_af_json"],"./ar.json":[5310,"src_locales_ar_json"],"./az.json":[29686,"src_locales_az_json"],"./be.json":[95144,"src_locales_be_json"],"./bg.json":[44378,"src_locales_bg_json"],"./bn.json":[57581,"src_locales_bn_json"],"./bs.json":[2086,"src_locales_bs_json"],"./ca.json":[78109,"src_locales_ca_json"],"./ckb-IR.json":[60117,"src_locales_ckb-IR_json"],"./cs.json":[83571,"src_locales_cs_json"],"./cy.json":[38533,"src_locales_cy_json"],"./da.json":[49914,"src_locales_da_json"],"./de-AT.json":[16296,"src_locales_de-AT_json"],"./de-CH.json":[12274,"src_locales_de-CH_json"],"./de-DE.json":[65006,"src_locales_de-DE_json"],"./de.json":[95894,"src_locales_de_json"],"./dz.json":[86499,"src_locales_dz_json"],"./el-CY.json":[20579,"src_locales_el-CY_json"],"./el.json":[94524,"src_locales_el_json"],"./en-AU.json":[66499,"src_locales_en-AU_json"],"./en-CA.json":[78701,"src_locales_en-CA_json"],"./en-CY.json":[75285,"src_locales_en-CY_json"],"./en-GB.json":[63708,"src_locales_en-GB_json"],"./en-IE.json":[79451,"src_locales_en-IE_json"],"./en-IN.json":[82898,"src_locales_en-IN_json"],"./en-NZ.json":[8301,"src_locales_en-NZ_json"],"./en-TT.json":[44161,"src_locales_en-TT_json"],"./en-US.json":[25381,"src_locales_en-US_json"],"./en-ZA.json":[82316,"src_locales_en-ZA_json"],"./en.json":[44174,"src_locales_en_json"],"./eo.json":[30537,"src_locales_eo_json"],"./es-419.json":[21418,"src_locales_es-419_json"],"./es-AR.json":[35055,"src_locales_es-AR_json"],"./es-CL.json":[30291,"src_locales_es-CL_json"],"./es-CO.json":[96034,"src_locales_es-CO_json"],"./es-CR.json":[98881,"src_locales_es-CR_json"],"./es-EC.json":[85320,"src_locales_es-EC_json"],"./es-ES.json":[39480,"src_locales_es-ES_json"],"./es-MX.json":[18229,"src_locales_es-MX_json"],"./es-NI.json":[80118,"src_locales_es-NI_json"],"./es-PA.json":[57151,"src_locales_es-PA_json"],"./es-PE.json":[65427,"src_locales_es-PE_json"],"./es-US.json":[64776,"src_locales_es-US_json"],"./es-VE.json":[79069,"src_locales_es-VE_json"],"./es.json":[46725,"src_locales_es_json"],"./et.json":[16004,"src_locales_et_json"],"./eu.json":[96727,"src_locales_eu_json"],"./fa.json":[70867,"src_locales_fa_json"],"./fi.json":[46808,"src_locales_fi_json"],"./fil.json":[46356,"src_locales_fil_json"],"./fr-CA.json":[93804,"src_locales_fr-CA_json"],"./fr-CH.json":[74455,"src_locales_fr-CH_json"],"./fr-FR.json":[19044,"src_locales_fr-FR_json"],"./fr.json":[94605,"src_locales_fr_json"],"./fy.json":[23272,"src_locales_fy_json"],"./gd.json":[42210,"src_locales_gd_json"],"./gl.json":[4346,"src_locales_gl_json"],"./he.json":[26282,"src_locales_he_json"],"./hi-IN.json":[82450,"src_locales_hi-IN_json"],"./hi.json":[53134,"src_locales_hi_json"],"./hr.json":[36759,"src_locales_hr_json"],"./hu.json":[86938,"src_locales_hu_json"],"./id.json":[35176,"src_locales_id_json"],"./is.json":[90433,"src_locales_is_json"],"./it-CH.json":[14783,"src_locales_it-CH_json"],"./it.json":[83672,"src_locales_it_json"],"./ja.json":[87980,"src_locales_ja_json"],"./ka.json":[19173,"src_locales_ka_json"],"./kk.json":[27699,"src_locales_kk_json"],"./km.json":[60089,"src_locales_km_json"],"./kn.json":[10412,"src_locales_kn_json"],"./ko.json":[19423,"src_locales_ko_json"],"./lb.json":[82835,"src_locales_lb_json"],"./lo.json":[89540,"src_locales_lo_json"],"./lt.json":[65449,"src_locales_lt_json"],"./lv.json":[21103,"src_locales_lv_json"],"./mg.json":[61161,"src_locales_mg_json"],"./mk.json":[14165,"src_locales_mk_json"],"./ml.json":[68308,"src_locales_ml_json"],"./mn.json":[2982,"src_locales_mn_json"],"./mr-IN.json":[3262,"src_locales_mr-IN_json"],"./ms.json":[24525,"src_locales_ms_json"],"./nb.json":[49093,"src_locales_nb_json"],"./ne.json":[40484,"src_locales_ne_json"],"./nl.json":[34943,"src_locales_nl_json"],"./nn.json":[12025,"src_locales_nn_json"],"./no.json":[77086,"src_locales_no_json"],"./oc.json":[75495,"src_locales_oc_json"],"./or.json":[55204,"src_locales_or_json"],"./pa.json":[98190,"src_locales_pa_json"],"./pap-AW.json":[28329,"src_locales_pap-AW_json"],"./pap-CW.json":[81403,"src_locales_pap-CW_json"],"./pl.json":[11029,"src_locales_pl_json"],"./pt-BR.json":[46040,"src_locales_pt-BR_json"],"./pt-PT.json":[55496,"src_locales_pt-PT_json"],"./pt.json":[37741,"src_locales_pt_json"],"./rm.json":[44576,"src_locales_rm_json"],"./ro.json":[22354,"src_locales_ro_json"],"./ru.json":[74600,"src_locales_ru_json"],"./rw.json":[4986,"src_locales_rw_json"],"./sc.json":[79699,"src_locales_sc_json"],"./si.json":[13701,"src_locales_si_json"],"./sk.json":[10347,"src_locales_sk_json"],"./sl.json":[37110,"src_locales_sl_json"],"./sq.json":[98141,"src_locales_sq_json"],"./sr.json":[78912,"src_locales_sr_json"],"./st.json":[4206,"src_locales_st_json"],"./sv-FI.json":[84486,"src_locales_sv-FI_json"],"./sv-SE.json":[81831,"src_locales_sv-SE_json"],"./sv.json":[28252,"src_locales_sv_json"],"./sw.json":[34319,"src_locales_sw_json"],"./ta.json":[77610,"src_locales_ta_json"],"./te.json":[63718,"src_locales_te_json"],"./th.json":[67549,"src_locales_th_json"],"./tl.json":[21897,"src_locales_tl_json"],"./tr.json":[79755,"src_locales_tr_json"],"./tt.json":[49361,"src_locales_tt_json"],"./ug.json":[83697,"src_locales_ug_json"],"./uk.json":[92749,"src_locales_uk_json"],"./ur.json":[11946,"src_locales_ur_json"],"./uz.json":[17906,"src_locales_uz_json"],"./vi.json":[91496,"src_locales_vi_json"],"./wo.json":[8091,"src_locales_wo_json"],"./zh-CN.json":[731,"src_locales_zh-CN_json"],"./zh-HK.json":[20259,"src_locales_zh-HK_json"],"./zh-TW.json":[81507,"src_locales_zh-TW_json"],"./zh-YUE.json":[91143,"src_locales_zh-YUE_json"]};function webpackAsyncContext(e){if(!n.o(i,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],o=t[0];return n.e(t[1]).then((()=>n.t(o,19)))}webpackAsyncContext.keys=()=>Object.keys(i),webpackAsyncContext.id=72096,e.exports=webpackAsyncContext},83637:(e,t,n)=>{var i={"./admin/custom-fields.controller":[24296,"src_stimulus_controllers_dynamic_admin_custom-fields_controller_ts"],"./admin/hierarchy-item.controller":[50990,"src_stimulus_controllers_dynamic_admin_hierarchy-item_controller_ts"],"./admin/openid-connect-providers.controller":[70354,"src_stimulus_controllers_dynamic_admin_openid-connect-providers_controller_ts"],"./admin/progress-tracking.controller":[78224,"src_stimulus_controllers_dynamic_admin_progress-tracking_controller_ts"],"./admin/roles.controller":[45490,"src_stimulus_controllers_dynamic_admin_roles_controller_ts"],"./admin/statuses.controller":[45715,"src_stimulus_controllers_dynamic_admin_statuses_controller_ts"],"./admin/subject-configuration.controller":[31220,"src_stimulus_controllers_dynamic_admin_subject-configuration_controller_ts"],"./admin/users.controller":[17205,"src_stimulus_controllers_dynamic_admin_users_controller_ts"],"./attribute.controller":[64385,"src_stimulus_controllers_dynamic_attribute_controller_ts"],"./auto-show-dialog.controller":[43271,"src_stimulus_controllers_dynamic_auto-show-dialog_controller_ts"],"./backlogs.controller":[14757,"src_stimulus_controllers_dynamic_backlogs_controller_ts"],"./chronic-duration.controller":[19462,"src_stimulus_controllers_dynamic_chronic-duration_controller_ts"],"./costs/budget-subform.controller":[42832,"src_stimulus_controllers_dynamic_costs_budget-subform_controller_ts"],"./costs/export.controller":[48450,"src_stimulus_controllers_dynamic_costs_export_controller_ts"],"./expandable-list.controller":[89544,"src_stimulus_controllers_dynamic_expandable-list_controller_ts"],"./filter/filter-list.controller":[19665,"common"],"./filter/filters-form.controller":[27476,"src_stimulus_controllers_dynamic_filter_filters-form_controller_ts"],"./forum-messages.controller":[75593,"src_stimulus_controllers_dynamic_forum-messages_controller_ts"],"./generic-drag-and-drop.controller":[11565,"src_stimulus_controllers_dynamic_generic-drag-and-drop_controller_ts"],"./job-status-polling.controller":[93539,"src_stimulus_controllers_dynamic_job-status-polling_controller_ts"],"./journal-history.controller":[1411,"src_stimulus_controllers_dynamic_journal-history_controller_ts"],"./meeting-agenda-item-drag-and-drop.controller":[85470,"src_stimulus_controllers_dynamic_meeting-agenda-item-drag-and-drop_controller_ts"],"./meeting-agenda-item-form.controller":[94142,"src_stimulus_controllers_dynamic_meeting-agenda-item-form_controller_ts"],"./meeting-content.controller":[24286,"src_stimulus_controllers_dynamic_meeting-content_controller_ts"],"./meeting-section-form.controller":[4365,"src_stimulus_controllers_dynamic_meeting-section-form_controller_ts"],"./members-form.controller":[56665,"src_stimulus_controllers_dynamic_members-form_controller_ts"],"./menus/main.controller":[75173],"./menus/submenu.controller":[87351,"src_stimulus_controllers_dynamic_menus_submenu_controller_ts"],"./menus/subtree.controller":[43350,"src_stimulus_controllers_dynamic_menus_subtree_controller_ts"],"./my/timers.controller":[11246,"src_stimulus_controllers_dynamic_my_timers_controller_ts"],"./overview/project-life-cycles-form.controller":[28899,"src_stimulus_controllers_dynamic_overview_project-life-cycles-form_controller_ts"],"./primer-to-angular-modal.controller":[87189,"src_stimulus_controllers_dynamic_primer-to-angular-modal_controller_ts"],"./project-storage-form.controller":[52067,"common"],"./projects/settings/border-box-filter.controller":[42815,"common","src_stimulus_controllers_dynamic_projects_settings_border-box-filter_controller_ts"],"./projects/zen-mode.controller":[81437],"./recurring-meetings/form.controller":[57624,"src_stimulus_controllers_dynamic_recurring-meetings_form_controller_ts"],"./repository-navigation.controller":[11234,"src_stimulus_controllers_dynamic_repository-navigation_controller_ts"],"./repository-settings.controller":[98659,"src_stimulus_controllers_dynamic_repository-settings_controller_ts"],"./shares/bulk-selection.controller":[39895,"src_stimulus_controllers_dynamic_shares_bulk-selection_controller_ts"],"./shares/user-selected.controller":[11241,"src_stimulus_controllers_dynamic_shares_user-selected_controller_ts"],"./sort-by-config.controller":[30840,"src_stimulus_controllers_dynamic_sort-by-config_controller_ts"],"./storages/automatically-managed-project-folders-form.controller":[79922,"src_stimulus_controllers_dynamic_storages_automatically-managed-project-folders-form_controller_ts"],"./storages/oauth-access-grant-nudge-modal.controller":[22263,"src_stimulus_controllers_dynamic_storages_oauth-access-grant-nudge-modal_controller_ts"],"./storages/open-project-storage-modal.controller":[11412,"src_stimulus_controllers_dynamic_storages_open-project-storage-modal_controller_ts"],"./storages/project-folder-mode-form.controller":[97887,"common","src_stimulus_controllers_dynamic_storages_project-folder-mode-form_controller_ts"],"./storages/storage-form.controller":[77150,"src_stimulus_controllers_dynamic_storages_storage-form_controller_ts"],"./subform.controller":[27369,"src_stimulus_controllers_dynamic_subform_controller_ts"],"./table-action-menu.controller":[50268,"src_stimulus_controllers_dynamic_table-action-menu_controller_ts"],"./two-factor-authentication.controller":[90482,"src_stimulus_controllers_dynamic_two-factor-authentication_controller_ts"],"./user-limit.controller":[42786,"src_stimulus_controllers_dynamic_user-limit_controller_ts"],"./work-packages/activities-tab/index.controller":[73531,"src_stimulus_controllers_dynamic_work-packages_activities-tab_index_controller_ts"],"./work-packages/activities-tab/item.controller":[46490,"src_stimulus_controllers_dynamic_work-packages_activities-tab_item_controller_ts"],"./work-packages/details/tabs.controller":[55810,"src_stimulus_controllers_dynamic_work-packages_details_tabs_controller_ts"],"./work-packages/export/dialog.controller":[80958,"src_stimulus_controllers_dynamic_work-packages_export_dialog_controller_ts"],"./work-packages/export/form.controller":[91832,"src_stimulus_controllers_dynamic_work-packages_export_form_controller_ts"],"./work-packages/export/pdf/settings.controller":[90080,"src_stimulus_controllers_dynamic_work-packages_export_pdf_settings_controller_ts"],"./work-packages/progress/preview.controller":[73211,"src_stimulus_controllers_dynamic_work-packages_progress_preview_controller_ts"],"./work-packages/relations-tab/scroll.controller":[85416,"src_stimulus_controllers_dynamic_work-packages_relations-tab_scroll_controller_ts"]};function webpackAsyncContext(e){if(!n.o(i,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],o=t[0];return Promise.all(t.slice(1).map(n.e)).then((()=>n(o)))}webpackAsyncContext.keys=()=>Object.keys(i),webpackAsyncContext.id=83637,e.exports=webpackAsyncContext},98811:(e,t,n)=>{var i={"./af.js":[7965,"src_vendor_ckeditor_translations_af_js"],"./ar.js":[86257,"src_vendor_ckeditor_translations_ar_js"],"./ast.js":[42772,"src_vendor_ckeditor_translations_ast_js"],"./az.js":[54025,"src_vendor_ckeditor_translations_az_js"],"./bg.js":[69061,"src_vendor_ckeditor_translations_bg_js"],"./bn.js":[70126,"src_vendor_ckeditor_translations_bn_js"],"./bs.js":[44121,"src_vendor_ckeditor_translations_bs_js"],"./ca.js":[85430,"src_vendor_ckeditor_translations_ca_js"],"./cs.js":[69724,"src_vendor_ckeditor_translations_cs_js"],"./da.js":[90613,"src_vendor_ckeditor_translations_da_js"],"./de-ch.js":[64165,"src_vendor_ckeditor_translations_de-ch_js"],"./de.js":[84761,"src_vendor_ckeditor_translations_de_js"],"./el.js":[20815,"src_vendor_ckeditor_translations_el_js"],"./en-au.js":[2900,"src_vendor_ckeditor_translations_en-au_js"],"./en-gb.js":[58167,"src_vendor_ckeditor_translations_en-gb_js"],"./eo.js":[81858,"src_vendor_ckeditor_translations_eo_js"],"./es-co.js":[44357,"src_vendor_ckeditor_translations_es-co_js"],"./es.js":[51510,"src_vendor_ckeditor_translations_es_js"],"./et.js":[26391,"src_vendor_ckeditor_translations_et_js"],"./eu.js":[36672,"src_vendor_ckeditor_translations_eu_js"],"./fa.js":[67243,"src_vendor_ckeditor_translations_fa_js"],"./fi.js":[33219,"src_vendor_ckeditor_translations_fi_js"],"./fr.js":[35550,"src_vendor_ckeditor_translations_fr_js"],"./gl.js":[8365,"src_vendor_ckeditor_translations_gl_js"],"./gu.js":[25622,"src_vendor_ckeditor_translations_gu_js"],"./he.js":[47397,"src_vendor_ckeditor_translations_he_js"],"./hi.js":[57777,"src_vendor_ckeditor_translations_hi_js"],"./hr.js":[28352,"src_vendor_ckeditor_translations_hr_js"],"./hu.js":[68501,"src_vendor_ckeditor_translations_hu_js"],"./hy.js":[84769,"src_vendor_ckeditor_translations_hy_js"],"./id.js":[83411,"src_vendor_ckeditor_translations_id_js"],"./it.js":[46051,"src_vendor_ckeditor_translations_it_js"],"./ja.js":[81887,"src_vendor_ckeditor_translations_ja_js"],"./jv.js":[13358,"src_vendor_ckeditor_translations_jv_js"],"./km.js":[49594,"src_vendor_ckeditor_translations_km_js"],"./kn.js":[76615,"src_vendor_ckeditor_translations_kn_js"],"./ko.js":[69744,"src_vendor_ckeditor_translations_ko_js"],"./ku.js":[70066,"src_vendor_ckeditor_translations_ku_js"],"./lt.js":[41170,"src_vendor_ckeditor_translations_lt_js"],"./lv.js":[13352,"src_vendor_ckeditor_translations_lv_js"],"./ms.js":[26190,"src_vendor_ckeditor_translations_ms_js"],"./nb.js":[56454,"src_vendor_ckeditor_translations_nb_js"],"./ne.js":[27719,"src_vendor_ckeditor_translations_ne_js"],"./nl.js":[28760,"src_vendor_ckeditor_translations_nl_js"],"./no.js":[19793,"src_vendor_ckeditor_translations_no_js"],"./oc.js":[41160,"src_vendor_ckeditor_translations_oc_js"],"./pl.js":[64278,"src_vendor_ckeditor_translations_pl_js"],"./pt-br.js":[63267,"src_vendor_ckeditor_translations_pt-br_js"],"./pt.js":[37358,"src_vendor_ckeditor_translations_pt_js"],"./ro.js":[53725,"src_vendor_ckeditor_translations_ro_js"],"./ru.js":[25123,"src_vendor_ckeditor_translations_ru_js"],"./si.js":[90606,"src_vendor_ckeditor_translations_si_js"],"./sk.js":[34564,"src_vendor_ckeditor_translations_sk_js"],"./sl.js":[98865,"src_vendor_ckeditor_translations_sl_js"],"./sq.js":[17526,"src_vendor_ckeditor_translations_sq_js"],"./sr-latn.js":[5989,"src_vendor_ckeditor_translations_sr-latn_js"],"./sr.js":[53523,"src_vendor_ckeditor_translations_sr_js"],"./sv.js":[50391,"src_vendor_ckeditor_translations_sv_js"],"./th.js":[40366,"src_vendor_ckeditor_translations_th_js"],"./ti.js":[50541,"src_vendor_ckeditor_translations_ti_js"],"./tk.js":[41579,"src_vendor_ckeditor_translations_tk_js"],"./tr.js":[78828,"src_vendor_ckeditor_translations_tr_js"],"./tt.js":[41226,"src_vendor_ckeditor_translations_tt_js"],"./ug.js":[71626,"src_vendor_ckeditor_translations_ug_js"],"./uk.js":[56638,"src_vendor_ckeditor_translations_uk_js"],"./ur.js":[86053,"src_vendor_ckeditor_translations_ur_js"],"./uz.js":[97293,"src_vendor_ckeditor_translations_uz_js"],"./vi.js":[60339,"src_vendor_ckeditor_translations_vi_js"],"./zh-cn.js":[83308,"src_vendor_ckeditor_translations_zh-cn_js"],"./zh.js":[78576,"src_vendor_ckeditor_translations_zh_js"]};function webpackAsyncContext(e){if(!n.o(i,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],o=t[0];return n.e(t[1]).then((()=>n.t(o,23)))}webpackAsyncContext.keys=()=>Object.keys(i),webpackAsyncContext.id=98811,e.exports=webpackAsyncContext}},e=>{e.O(0,["vendor"],(()=>{return t=86449,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=main.d4480786264355d2.js.map
